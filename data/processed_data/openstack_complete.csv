project,change_id,target,1_references_bug_tracker,2_author_success_rate,3_churn_log_size,5_deletion_ratio,6_file_count,8_avg_sentence_length,9_msg_complexity,10_has_security_impact,11_nlp_change_type,12_is_test_change,13_is_revert,14_modifies_dependencies,15_author_submission_count,16_author_trust_score,17_historical_file_prob,18_is_documentation_only,19_author_file_confidence,20_risk_module_coupling,21_file_extension_entropy,22_relation_depth,23_project_acceptance_rate,24_change_entropy,25_directory_depth,26_msg_readability_ease,27_msg_gunning_fog,28_has_gerrit_topic,29_has_subject_tag,31_test_code_ratio,32_config_change,33_desc_density,34_is_weekend,35_bug_heat,36_bug_severity,37_bug_comments,38_is_bot,full_text_dl,40_sem_vec_0,40_sem_vec_1,40_sem_vec_2,40_sem_vec_3,40_sem_vec_4,40_sem_vec_5,40_sem_vec_6,40_sem_vec_7,40_sem_vec_8,40_sem_vec_9,40_sem_vec_10,40_sem_vec_11,40_sem_vec_12,40_sem_vec_13,40_sem_vec_14
openstack/openstack-ansible-os_nova,I7019b966b475c09a4e3218461941c1112ae28028,1,0,0,1.0986,0.5,1,13.5,233,0,Feature,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,14.53,24.66,1,0,0.0,0,77.6667,0,0,0,0,0,"Use SSL database connections with nova-manage

When Galera SSL is enabled, use SSL encrypted database connections with
nova-manage commands where a connection string is provided.
[SEP]
FILES CHANGED:
tasks/nova_db_setup.yml (+1, -1)
",1.360304,-0.539277,0.130297,1.194836,0.882469,-0.236346,0.161212,0.479124,0.10616,-0.349529,-0.459208,0.619708,0.150061,-0.267634,0.094113
openstack/openstack-ansible,Ifac591c2848c033ad4dfb473bce05860df2bb213,1,0,0,0.6931,0.0,1,18.75,514,0,CI,1,0,0,0,0.0,0.0,0,0.0,4,1,0,0,0.0,4.0,43.42,17.63,1,0,1.0,0,257.0,0,0,0,0,0,"Bootstrap lxc_net mtu for gate

Currently the gate assumes the upstream interface in the testing
machine is always running mtu 1500. We change this assumption by
using the facts collected from the host during bootstrap-host to
properly set MTU in the AIO user variables.

This is needed to prevent test failures while downloading internet
artifacts to containers during gate runs on nodepool providers
(such as recently added Limestone) which use a <1500 MTU.
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables.aio.yml.j2 (+1, -0)
",0.044183,-2.002467,0.479659,0.507987,-0.093043,-0.443041,0.718337,0.438112,0.234309,-0.075628,0.101745,-0.103936,0.03061,-0.127624,-0.008999
openstack/charm-rabbitmq-server,I92879445210bac6ee7d96a704cdf428ca738e3b6,1,1,0,3.8918,0.1458,4,5.88,368,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,2,0,0,1.4418,0.75,56.87,8.31,1,0,0.7292,1,7.5102,0,12,0,9,0,"Enforce a maximum of 1024 async threads.

The beam.smp process won't start if more than 1024 are configured, the
charm could make this by default on large systems (e.g. more than 42
CPUs). This change makes RabbitMQEnvContext.calculate_threads() never
return more than 1024 (MAX_NUM_THREADS).

Closes-Bug: #1768986
[SEP]
FILES CHANGED:
unit_tests/test_rabbitmq_server_relations.py (+4, -1)
unit_tests/test_rabbitmq_context.py (+27, -3)
tox.ini (+1, -1)
hooks/rabbitmq_context.py (+9, -2)
",-0.574129,-0.347949,-0.230332,0.427832,-0.19797,0.320813,0.043861,-0.113401,0.154144,0.132799,0.240195,-0.529522,0.007795,-0.018517,0.015481
openstack/ironic-python-agent,Icfaffd7c58c3c73c3fa28cfc2a6c954d2c93c16e,0,0,0,7.6779,0.0,6,55.67,1253,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,2,0,0,1.2665,3.5,-16.84,28.97,0,0,0.5405,1,0.5801,0,0,0,0,0,"update NVIDIA NIC firmware images and settings by ironic-python-agent

Add ""update_nvidia_nic_firmware_image"" and ""update_nvidia_nic_firmware_settings""
clean steps to MellanoxDeviceHardwareManager.

By adding those two steps, we can update the firmware image and
firmware settings of NVIDIA NICs by ironic-python-agent using
manual cleaning command
The clean steps require mstflint package installed on the image.
The ""update_nvidia_nic_firmware_image"" clean step requires to pass
""images"" parameter to the clean command
The ""images"" parameter is a json blob contains
a list of images, where each image contains a map of:
  * url: to firmware image (file://, http://)
  * checksum: checksum of the provided image
  * checksumType: md5/sha512/sha256
  * componentFlavor: PSID of the nic
  * version: version of the FW

The ""update_nvidia_nic_firmware_settings"" clean step requires to pass
""settings"" parameter to the clean command
The ""settings"" parameter is a json blob contains
a list of settings, where each settings contains a map of:
  * deviceID: device ID
  * globalConfig: global config
  * function0Config: function 0 config
  * function1Config: function 1 config

Story: 2010228
Task: 46016
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/hardware_managers/nvidia/__init__.py (+0, -0)
ironic_python_agent/tests/unit/hardware_managers/test_mlnx.py (+36, -0)
ironic_python_agent/hardware_managers/mlnx.py (+52, -0)
ironic_python_agent/hardware_managers/nvidia/nvidia_fw_update.py (+933, -0)
ironic_python_agent/tests/unit/hardware_managers/nvidia/test_nvidia_fw_update.py (+1131, -0)
releasenotes/notes/feature-2010228-cf3a59b88f07c3a7.yaml (+7, -0)
",-3.715922,1.17727,3.353212,-0.240079,0.662853,0.401403,-0.712631,0.029009,0.110774,-0.555817,-0.410591,0.08029,-0.214457,0.421935,-0.052796
openstack/octavia,I8181ed696b9ab556e7741c08839d79167aff8350,1,0,0,6.5352,0.0087,24,10.83,521,0,CI,0,0,1,0,0.0,0.0,0,0.0,5,7,0,0,3.5939,2.58,16.23,13.56,1,0,0.3576,1,0.7562,0,0,0,0,0,"Support create amphora instance from volume based.

In some deploy production, using volume based instead of localdisk
to protect data and live migrate can perform.

This patch adds:
 - creation a cinder volume for amphora
 - boot amphora with cinder volume
 - config options for cinder client
 - unit tests for cinder functionality

Story: 2001594
Co-authored-by: Vadim Ponomarev <velizarx@gmail.com>
Co-authored-by: Margarita Shakhova <shakhova.margarita@gmail.com>
[SEP]
FILES CHANGED:
releasenotes/notes/volume-based-amphora-9a1899634f5244b0.yaml (+14, -0)
octavia/common/config.py (+37, -0)
octavia/tests/unit/volume/__init__.py (+0, -0)
octavia/volume/__init__.py (+0, -0)
octavia/compute/drivers/nova_driver.py (+51, -2)
octavia/volume/drivers/__init__.py (+0, -0)
etc/octavia.conf (+42, -0)
devstack/settings (+1, -0)
requirements.txt (+1, -0)
octavia/common/constants.py (+10, -0)
octavia/volume/drivers/noop_driver/__init__.py (+0, -0)
octavia/volume/drivers/noop_driver/driver.py (+60, -0)
octavia/common/exceptions.py (+8, -0)
octavia/tests/unit/compute/drivers/test_nova_driver.py (+58, -4)
octavia/volume/drivers/cinder_driver.py (+123, -0)
octavia/tests/unit/volume/drivers/test_cinder_driver.py (+99, -0)
octavia/volume/volume_base.py (+46, -0)
devstack/plugin.sh (+1, -0)
lower-constraints.txt (+1, -0)
octavia/common/clients.py (+42, -0)
octavia/tests/unit/volume/drivers/__init__.py (+0, -0)
octavia/tests/unit/common/test_clients.py (+39, -0)
setup.cfg (+3, -0)
octavia/tests/unit/volume/drivers/test_volume_noop_driver.py (+46, -0)
",-2.058858,0.537971,0.00868,-0.021917,-0.148902,-0.312716,-0.020887,0.523436,-0.386383,-0.304013,0.62383,0.582149,0.382796,0.284994,-0.638892
openstack/octavia,I61c7d8d4df54710a92b8c055be84bba29bf3d7e6,0,0,0,6.4998,0.2922,20,6.62,395,0,Feature,0,0,0,0,0.0,0.0,0,0.0,7,4,0,1.0,3.7962,4.4,54.85,8.69,1,0,0.6386,1,0.594,0,0,0,0,0,"Support HTTP and TCP checks in UDP healthmonitor

This patch introduces 2 macros in lvs.

1. Support HTTP GET, allow users create HTTP healthmonitor for udp pool.
2. Support TCP check, allow users create TCP healthmonitor for udp pool.

Co-Authored-By: Adam Harwell <flux.adam@gmail.com>
Story: 2003200
Task: 23356
Story: 2003199
Task: 23355
[SEP]
FILES CHANGED:
octavia/common/utils.py (+21, -0)
octavia/tests/functional/api/v2/test_health_monitor.py (+60, -23)
releasenotes/notes/additional-udp-healthcheck-types-2414a5edee9f5110.yaml (+5, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+0, -29)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+14, -6)
octavia/api/v2/controllers/health_monitor.py (+20, -22)
octavia/tests/unit/common/test_utils.py (+29, -0)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+1, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+13, -5)
api-ref/source/v2/general.inc (+45, -4)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+1, -23)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+1, -23)
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+104, -0)
octavia/common/jinja/lvs/templates/macros.j2 (+32, -4)
octavia/api/v2/controllers/pool.py (+12, -3)
octavia/api/root_controller.py (+4, -2)
octavia/common/jinja/lvs/jinja_cfg.py (+15, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+91, -18)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+0, -29)
",-1.3652,-0.028872,-0.667435,0.095661,-0.203489,0.052113,-0.559017,0.586848,0.048945,0.201142,0.218757,0.103818,0.76423,0.663423,-0.301017
openstack/octavia,I09ee23dcb83f5f08a56e25cc05ff77caa3ad4230,0,0,0,7.3324,0.0308,33,9.75,307,0,Feature,0,0,0,0,0.0,1.0,0,0.0,7,6,0,0.5,3.2903,3.97,32.08,16.21,1,0,0.6643,1,0.2008,0,0,0,0,0,"Add quota support to octavia's l7policy and l7rule

Current octavia has no l7policy and l7rule quota definitions. But
they are necessary for some scenarios. For example, implement
product design compatible with Neutron Lbaas.

Story: 2003382
Task: 24457
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+28, -0)
octavia/common/config.py (+6, -0)
octavia/controller/worker/v1/flows/l7rule_flows.py (+2, -0)
octavia/tests/functional/api/v2/test_quotas.py (+49, -20)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
api-ref/source/v2/examples/quotas-defaults-response.json (+3, -1)
octavia/controller/worker/v2/flows/l7rule_flows.py (+2, -0)
etc/octavia.conf (+2, -0)
octavia/api/v2/types/quotas.py (+6, -0)
api-ref/source/v2/quota.inc (+10, -0)
octavia/controller/worker/v1/tasks/database_tasks.py (+136, -0)
octavia/tests/unit/common/test_data_models.py (+62, -0)
octavia/db/repositories.py (+81, -0)
api-ref/source/v2/examples/quotas-show-response.json (+3, -1)
octavia/api/v2/controllers/base.py (+7, -1)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks_quota.py (+93, -0)
api-ref/source/v2/examples/quota-update-curl (+1, -1)
octavia/controller/worker/v2/tasks/database_tasks.py (+136, -0)
api-ref/source/v2/examples/quotas-list-response.json (+3, -1)
octavia/db/models.py (+4, -0)
octavia/controller/worker/v1/flows/l7policy_flows.py (+2, -0)
api-ref/source/v2/examples/quota-update-response.json (+3, -1)
octavia/db/migration/alembic_migrations/versions/32e5c35b26a8_add_l7policy_and_l7rule_quota.py (+40, -0)
octavia/tests/functional/db/test_repositories.py (+582, -17)
octavia/common/data_models.py (+9, -1)
releasenotes/notes/add-l7policy-and-l7rule-to-quota-4b873c77f1e608e6.yaml (+3, -0)
api-ref/source/v2/examples/quota-update-request.json (+3, -1)
octavia/tests/functional/api/v2/test_l7rule.py (+10, -0)
octavia/api/root_controller.py (+4, -1)
octavia/api/v2/controllers/l7rule.py (+8, -0)
octavia/controller/worker/v2/flows/l7policy_flows.py (+2, -0)
octavia/tests/unit/api/v2/types/test_quotas.py (+87, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks_quota.py (+92, -0)
",-0.742169,-0.532632,-0.991084,0.524491,0.476336,0.20896,-0.725083,0.145563,-0.021509,0.149013,-0.050066,0.187588,0.201833,-0.301424,0.062018
openstack/python-octaviaclient,I1e3e60d5d326ff37a1ba53abd767c893748c2774,0,0,0.0,4.1744,0.1094,6,5.0,174,0,Feature,0,0,0,1,0.000654,0.0,0,0.0,5,2,0,0,1.8227,3.5,4.36,18.0,1,0,0.4531,1,2.6769,0,0,0,0,0,"Add l7policy and l7rule to octavia quota

Story: 2003382
Task: 24457

Depends-On: https://review.opendev.org/#/c/590620/
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/test_quota.py (+21, -6)
octaviaclient/osc/v2/quota.py (+25, -1)
octaviaclient/tests/unit/osc/v2/constants.py (+2, -0)
octaviaclient/osc/v2/constants.py (+4, -0)
octaviaclient/osc/v2/utils.py (+2, -0)
releasenotes/notes/add-l7policy-and-l7rule-quota-support-73098a090b252901.yaml (+3, -0)
",-0.043955,2.342077,-1.433136,-0.245311,-0.908125,0.729578,-0.486204,-0.298735,0.483356,-0.420054,-0.322445,-0.051031,0.170194,0.264729,-0.157191
openstack/kolla-ansible,I36119ccdeb264aa3de928ec2254d6ff4cc955bfb,0,0,0,5.4931,0.0165,58,9.0,397,0,Feature,0,0,0,0,0.0,1.0,0,0.0,4,5,0,0,5.4317,3.81,15.34,16.93,1,0,0.0083,1,1.6337,0,0,0,0,0,"Reintroduce kolla-ansible check

This allows operators quickly diagnose all containers across
all hosts by running kolla-ansible check. It returns a list
of containers that are missing, not running or in unhealthy
state for each OpenStack service.

Implements: blueprint check-containers
Co-Authored-By: Roman Krƒçek <roman.krcek@tietoevry.com>
[SEP]
FILES CHANGED:
ansible/roles/etcd/tasks/check.yml (+3, -0)
ansible/roles/common/tasks/check.yml (+3, -0)
ansible/roles/aodh/tasks/check.yml (+3, -0)
ansible/roles/multipathd/tasks/check.yml (+3, -0)
ansible/roles/skyline/tasks/check.yml (+3, -0)
ansible/roles/loadbalancer/tasks/check.yml (+3, -0)
ansible/roles/ovn-db/tasks/check.yml (+4, -0)
ansible/roles/cyborg/tasks/check.yml (+3, -0)
ansible/roles/redis/tasks/check.yml (+4, -0)
ansible/roles/blazar/tasks/check.yml (+3, -0)
ansible/roles/zun/tasks/check.yml (+3, -0)
ansible/roles/designate/tasks/check.yml (+3, -0)
ansible/roles/openvswitch/tasks/check.yml (+3, -0)
ansible/roles/prometheus/tasks/check.yml (+3, -0)
tests/deploy.sh (+2, -0)
ansible/roles/grafana/tasks/check.yml (+3, -0)
ansible/roles/masakari/tasks/check.yml (+3, -0)
ansible/roles/gnocchi/tasks/check.yml (+3, -0)
ansible/roles/rabbitmq/tasks/check.yml (+3, -0)
ansible/roles/ironic/tasks/check.yml (+3, -0)
ansible/roles/opensearch/tasks/check.yml (+3, -0)
ansible/roles/collectd/tasks/check.yml (+3, -0)
ansible/roles/manila/tasks/check.yml (+3, -0)
ansible/roles/venus/tasks/check.yml (+3, -0)
setup.cfg (+1, -1)
ansible/roles/ceilometer/tasks/check.yml (+3, -0)
ansible/roles/service-check/defaults/main.yml (+3, -0)
ansible/roles/neutron/tasks/check.yml (+3, -0)
ansible/roles/barbican/tasks/check.yml (+4, -0)
ansible/roles/heat/tasks/check.yml (+3, -0)
ansible/roles/kuryr/tasks/check.yml (+3, -0)
ansible/roles/cloudkitty/tasks/check.yml (+3, -0)
kolla_ansible/cli/commands.py (+14, -0)
ansible/roles/tacker/tasks/check.yml (+3, -0)
ansible/roles/horizon/tasks/check.yml (+3, -0)
ansible/roles/mariadb/tasks/check.yml (+4, -3)
ansible/roles/service-check/tasks/main.yml (+38, -0)
ansible/roles/memcached/tasks/check.yml (+3, -0)
releasenotes/notes/reintroduce-check-2a385b77e044c507.yaml (+9, -0)
ansible/roles/influxdb/tasks/check.yml (+3, -0)
ansible/roles/iscsi/tasks/check.yml (+3, -0)
ansible/roles/trove/tasks/check.yml (+3, -0)
ansible/roles/service-check/vars/main.yml (+9, -0)
ansible/roles/placement/tasks/check.yml (+3, -0)
ansible/roles/mistral/tasks/check.yml (+3, -0)
ansible/roles/ovs-dpdk/tasks/check.yml (+3, -0)
ansible/roles/watcher/tasks/check.yml (+3, -0)
ansible/roles/cinder/tasks/check.yml (+4, -0)
ansible/roles/magnum/tasks/check.yml (+3, -0)
ansible/roles/nova-cell/tasks/check.yml (+3, -0)
ansible/roles/letsencrypt/tasks/check.yml (+4, -0)
ansible/roles/glance/tasks/check.yml (+4, -0)
ansible/roles/nova/tasks/check.yml (+3, -0)
ansible/roles/hacluster/tasks/check.yml (+3, -0)
ansible/roles/keystone/tasks/check.yml (+4, -0)
ansible/roles/octavia/tasks/check.yml (+3, -0)
ansible/roles/telegraf/tasks/check.yml (+3, -0)
ansible/roles/ovn-controller/tasks/check.yml (+4, -0)
",-1.081888,-0.015668,-0.687387,0.36597,-0.318138,-0.409429,0.003144,0.288655,0.077505,-0.172912,0.556548,0.237218,0.409542,0.344611,-0.357588
openstack/octavia,I00703f86555cbb574b943794b14a36fbc644f1b2,0,0,0,6.5667,0.0592,28,10.5,204,0,Feature,0,0,0,0,0.0,1.0,0,0.0,7,7,0,0.3333,3.2195,3.68,22.95,13.72,1,0,0.1817,1,0.2869,0,0,0,0,0,"Amphora logging

Configure rsyslog to forward logs to a target host

Co-Authored-By: Michael Johnson <johnsomor@gmail.com>
Story: 1665069
Task: 33646
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/keepalived.py (+1, -1)
octavia/common/config.py (+45, -6)
doc/source/admin/index.rst (+1, -0)
octavia/common/jinja/logging/logging_jinja_cfg.py (+66, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_compute_tasks.py (+20, -6)
octavia/common/jinja/haproxy/jinja_cfg.py (+2, -2)
octavia/tests/unit/common/jinja/logging/__init__.py (+0, -0)
etc/octavia.conf (+53, -9)
devstack/settings (+3, -0)
devstack/files/rpms/octavia (+1, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_compute_tasks.py (+20, -6)
octavia/common/constants.py (+2, -0)
devstack/files/debs/octavia (+1, -0)
octavia/cmd/agent.py (+1, -1)
octavia/controller/worker/v1/tasks/compute_tasks.py (+7, -0)
octavia/tests/unit/common/jinja/logging/test_logging_jinja_cfg.py (+61, -0)
octavia/common/jinja/logging/templates/10-rsyslog.conf.template (+27, -0)
devstack/plugin.sh (+37, -1)
devstack/files/rpms-suse/octavia (+1, -0)
devstack/etc/rsyslog/10-octavia-log-offloading.conf (+11, -0)
octavia/amphorae/backends/agent/agent_jinja_cfg.py (+2, -2)
octavia/tests/unit/amphorae/backends/agent/test_agent_jinja_cfg.py (+6, -6)
releasenotes/notes/Add-log-offloading-233cd8612c0dd2b5.yaml (+12, -0)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+1, -1)
octavia/controller/worker/v2/tasks/compute_tasks.py (+7, -0)
octavia/common/jinja/logging/__init__.py (+0, -0)
zuul.d/jobs.yaml (+3, -1)
doc/source/admin/log-offloading.rst (+277, -0)
",-0.713936,0.662753,-1.616125,-0.121986,-0.294111,0.668376,-1.146319,-0.095235,0.206929,-0.492253,0.451767,0.524326,0.179514,0.332999,-0.672529
openstack/octavia,I92ee4e879e98e4718d2e9aba56486341223a9157,0,0,0,7.5401,0.3195,32,10.0,770,0,Feature,0,0,1,0,0.0,1.0,0,0.0,6,8,0,0.25,3.5219,2.91,25.79,13.2,1,0,0.3392,1,0.4091,0,0,0,0,0,"Jobboard based controller

Introduce TaskFlowServiceController which uses taskflow
jobboard feature and saves jobs info into persistence backend.

Jobboard could be operated via RedisTaskFlowDriver or
ZookeeperTaskFlowDriver, that could be set via the config.
RedisTaskFlowDriver is intoduced as default backend for jobboard.
Usage of jobboard allows to resume jobs in case of restart/stop
of Octavia controller services.

Persistence backend saves state of flow tasks that required in
case of resuming job. SQLAlchemy backend is used here.

Bump taskflow version to 3.7.1 and add dependency to
SQLAlchemy-Utils (required for taskflow sqlalchemy
backend support).

Story: 2005072
Task: 30806
Task: 30816
Task: 30817
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/flows/flow_utils.py (+158, -0)
doc/source/admin/providers/index.rst (+2, -0)
octavia/common/config.py (+42, -2)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+136, -296)
etc/octavia.conf (+43, -0)
devstack/settings (+2, -0)
requirements.txt (+2, -1)
octavia/common/constants.py (+1, -0)
octavia/tests/unit/controller/queue/v2/test_consumer.py (+2, -1)
octavia/controller/worker/v2/controller_worker.py (+204, -272)
octavia/controller/worker/v2/taskflow_jobboard_driver.py (+102, -0)
octavia/db/repositories.py (+13, -3)
octavia/controller/housekeeping/house_keeping.py (+14, -4)
doc/source/install/install-amphorav2.rst (+84, -0)
octavia/controller/healthmanager/health_manager.py (+6, -2)
octavia/controller/queue/v2/consumer.py (+4, -0)
octavia/tests/unit/controller/housekeeping/test_house_keeping.py (+70, -3)
octavia/db/migration/cli.py (+18, -0)
octavia/tests/unit/controller/healthmanager/test_health_manager.py (+22, -6)
devstack/plugin.sh (+47, -1)
lower-constraints.txt (+2, -1)
octavia/tests/functional/db/test_repositories.py (+15, -0)
octavia/api/common/types.py (+10, -2)
octavia/common/data_models.py (+6, -1)
doc/source/admin/providers/amphorav2.rst (+31, -0)
octavia/common/base_taskflow.py (+131, -2)
releasenotes/notes/add-jobboard-based-controller-599279c7cc172e955.yaml (+7, -0)
octavia/tests/unit/common/test_base_taskflow.py (+83, -0)
doc/source/install/install.rst (+1, -0)
octavia/api/v2/controllers/amphora.py (+15, -4)
setup.cfg (+3, -0)
zuul.d/jobs.yaml (+4, -0)
",-2.642679,-0.469312,1.376056,-0.020365,0.421804,0.153656,-0.380108,0.948875,0.090621,-0.466762,0.068358,0.506726,-0.008855,-0.275107,0.006651
openstack/python-octaviaclient,I7eac594b0e7f66fba2a571c152ede470ca61d530,0,0,0,4.7185,0.0,5,11.4,399,0,Feature,0,0,0,0,0.0,0.3333,0,0.0,5,3,0,0.0,1.422,2.8,42.39,10.88,1,0,0.5225,0,3.5625,0,0,0,0,0,"Adds ""unset"" action to the loadbalancer command

This patch adds ""openstack loadbalancer unset"" action to the octavia
client. This allows the user to unset the name, description, and/or
vip-qos-policy-id setings.

This is the first patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/load_balancer.py (+44, -0)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+58, -0)
doc/source/cli/index.rst (+3, -0)
octaviaclient/osc/v2/utils.py (+5, -0)
setup.cfg (+1, -0)
",-0.935493,-0.196384,-0.532777,1.387304,0.483011,-0.113796,0.527707,0.023709,0.842461,-0.146613,0.114273,0.606267,-0.010075,0.288104,-0.099551
openstack/python-octaviaclient,I153967b69a1766cf1fa5033bc77d580d05aaceac,0,0,0.0,5.3132,0.0,3,9.33,376,0,Feature,0,0,0,1,0.008929,0.25,0,0.0,5,2,0,0.0,1.0401,2.67,55.35,10.16,1,0,0.495,0,1.8522,0,0,0,0,0,"Adds ""unset"" action to the listener command

This patch adds ""openstack loadbalancer listener unset"" action to the
octavia client. This allows the user to unset the name, description,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/test_listener.py (+100, -0)
octaviaclient/osc/v2/listener.py (+101, -0)
setup.cfg (+1, -0)
",-0.509065,-0.7533,-0.496901,1.311384,0.329581,0.209637,0.655636,-0.070481,0.750115,-0.014155,0.13226,0.369544,-0.100077,0.342913,-0.208004
openstack/kolla-ansible,I73d483e01476e779a5155b2e18dd5ea25f514e93,0,0,0,5.7621,0.3943,49,16.43,1586,0,CI,0,0,0,0,0.0,0.0,0,0.0,6,2,0,0.0,4.8404,4.04,31.26,16.48,1,0,0.0,0,4.9874,0,0,0,0,0,"Standardize use and construction of endpoint URLs

The goal for this push request is to normalize the construction and use
 of internal, external, and admin URLs. While extending Kolla-ansible
 to enable a more flexible method to manage external URLs, we noticed
 that the same URL was constructed multiple times in different parts
 of the code. This can make it difficult for people that want to work
 with these URLs and create inconsistencies in a large code base with
 time. Therefore, we are proposing here the use of
 ""single Kolla-ansible variable"" per endpoint URL, which facilitates
 for people that are interested in overriding/extending these URLs.

As an example, we extended Kolla-ansible to facilitate the ""override""
of public (external) URLs with the following standard
""<component/serviceName>.<companyBaseUrl>"".
Therefore, the ""NAT/redirect"" in the SSL termination system (HAproxy,
HTTPD or some other) is done via the service name, and not by the port.
This allows operators to easily and automatically create more friendly
 URL names. To develop this feature, we first applied this patch that
 we are sending now to the community. We did that to reduce the surface
  of changes in Kolla-ansible.

Another example is the integration of Kolla-ansible and Consul, which
we also implemented internally, and also requires URLs changes.
Therefore, this PR is essential to reduce code duplicity, and to
facility users/developers to work/customize the services URLs.
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/keystone.conf.j2 (+1, -1)
ansible/roles/horizon/defaults/main.yml (+2, -2)
ansible/roles/elasticsearch/tasks/upgrade.yml (+2, -6)
ansible/roles/manila/templates/manila-share.conf.j2 (+1, -1)
ansible/roles/heat/defaults/main.yml (+4, -1)
ansible/roles/kibana/templates/kibana.yml.j2 (+1, -1)
ansible/roles/prometheus/templates/prometheus-alertmanager.yml.j2 (+1, -1)
ansible/roles/designate/templates/designate.conf.j2 (+1, -1)
ansible/roles/monasca/tasks/post_config.yml (+7, -7)
ansible/roles/murano/tasks/import_library_packages.yml (+3, -3)
ansible/roles/cinder/defaults/main.yml (+11, -6)
ansible/roles/ironic/templates/inspector.ipxe.j2 (+1, -1)
ansible/roles/nova/templates/nova.conf.j2 (+2, -1)
ansible/roles/grafana/tasks/post_config.yml (+3, -3)
ansible/roles/kuryr/defaults/main.yml (+5, -0)
ansible/roles/searchlight/defaults/main.yml (+1, -1)
ansible/roles/grafana/templates/prometheus.yaml.j2 (+1, -1)
ansible/roles/tempest/templates/tempest.conf.j2 (+2, -6)
ansible/roles/etcd/defaults/main.yml (+10, -4)
ansible/roles/grafana/defaults/main.yml (+7, -3)
ansible/roles/barbican/defaults/main.yml (+0, -4)
ansible/roles/kuryr/templates/kuryr.conf.j2 (+1, -1)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+2, -2)
ansible/roles/nova-cell/templates/nova.conf.j2 (+2, -2)
ansible/roles/prometheus/templates/clouds.yml.j2 (+1, -1)
ansible/roles/nova/defaults/main.yml (+9, -6)
ansible/roles/ironic/defaults/main.yml (+1, -5)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+1, -1)
ansible/roles/searchlight/templates/searchlight.conf.j2 (+1, -1)
ansible/roles/mistral/defaults/main.yml (+3, -1)
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
ansible/roles/freezer/defaults/main.yml (+3, -3)
ansible/roles/neutron/defaults/main.yml (+0, -4)
ansible/roles/cinder/templates/cinder.conf.j2 (+2, -2)
ansible/roles/heat/templates/heat.conf.j2 (+2, -3)
ansible/roles/manila/defaults/main.yml (+12, -6)
ansible/roles/ironic/templates/pxelinux.default.j2 (+2, -1)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+3, -3)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -1)
ansible/roles/monasca/defaults/main.yml (+6, -8)
ansible/roles/murano/templates/murano.conf.j2 (+1, -1)
ansible/roles/swift/defaults/main.yml (+0, -4)
ansible/roles/vitrage/defaults/main.yml (+0, -4)
ansible/roles/kuryr/templates/kuryr.spec.j2 (+1, -1)
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+1, -1)
ansible/roles/octavia/defaults/main.yml (+0, -4)
ansible/roles/neutron/templates/neutron.conf.j2 (+2, -2)
ansible/group_vars/all.yml (+66, -1)
ansible/roles/barbican/templates/barbican.conf.j2 (+2, -1)
",-3.012863,-0.224362,3.932227,-0.21485,-0.321846,0.358938,-0.004703,-0.213727,-0.14647,-0.11716,-0.667541,0.719638,0.121555,-0.52553,0.061664
openstack/kolla,If2f39736e2af34cd91d0976051ff66f06e96ab42,1,1,0,3.3322,0.1111,3,10.83,487,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,3,0,0,1.3801,2.33,33.15,16.03,1,0,0.0,1,17.3929,0,14,0,4,0,"Add exclude for permissions in kolla config.json file

When using recursive mode to set permissions for a directory as
defined in kolla config.json, all the subdirectories and files will
receive the same permissions. This change adds the option to exclude
specific files or directories - either a name or a regular expression
can be used.

Closes-Bug: #1931294
Closes-Bug: #1972168

Co-Authored-By: Jakub Darmach <jakub@stackhpc.com>
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+14, -2)
releasenotes/notes/permissions-exclude-e1138abb573956a7.yaml (+5, -0)
doc/source/admin/kolla_api.rst (+5, -1)
",-1.602856,0.314969,-0.122949,0.368501,-0.23282,0.085901,-0.141872,-0.152672,0.30436,0.094012,0.474961,0.054592,0.296829,0.266296,-0.555676
openstack/octavia,I0d2c332fa72e47e70d594579ab819a6ece094cdd,0,0,0,6.0162,0.0513,11,8.14,495,0,CI,0,0,1,0,0.0,0.5,0,0.0,5,5,0,0.2,2.3599,2.45,1.17,17.29,1,0,0.2616,1,1.2073,0,0,0,0,0,"Failover stop threshold / circuit breaker

Stop failovers if the count of simultaneously failed
amphora reaches the number configured in the new
failover_threshold option.
This may prevent large scale accidental failover events,
like in the case of network failures or read-only
database issues.

Story: 2005604
Task: 30837
Co-Authored-By: Tatsuma Matsuki <matsuki.tatsuma@jp.fujitsu.com>
Co-Authored-By: Tom Weininger <tweining@redhat.com>
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+105, -2)
octavia/common/config.py (+5, -0)
doc/source/admin/index.rst (+1, -0)
requirements.txt (+1, -1)
octavia/common/constants.py (+2, -7)
octavia/db/migration/alembic_migrations/versions/0995c26fc506_add_failover_stopped_to_provisioning_.py (+41, -0)
octavia/db/repositories.py (+85, -10)
octavia/controller/healthmanager/health_manager.py (+0, -1)
releasenotes/notes/failover-threshold-f5cdf2bbe8a64d6d.yaml (+12, -0)
doc/source/admin/failover-circuit-breaker.rst (+131, -0)
etc/octavia.conf (+5, -0)
",-2.507983,1.179212,-0.428827,0.348647,-0.112828,0.492432,-0.276665,0.034947,0.336431,-0.110037,0.932892,0.533982,0.347965,0.118951,-0.291202
openstack/python-octaviaclient,I90017c6c7acdd5bde129b4128c7d3044b9c1a578,0,0,0.0,4.8752,0.0,3,9.33,368,0,Feature,0,0,0,2,0.006369,0.2,0,0.0,5,2,0,0.0,1.0553,2.67,62.91,8.73,1,0,0.5231,0,2.8092,0,0,0,0,0,"Adds ""unset"" action to the pool command

This patch adds ""openstack loadbalancer pool unset"" action to the
octavia client. This allows the user to unset the name, description,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/test_pool.py (+68, -0)
setup.cfg (+1, -0)
octaviaclient/osc/v2/pool.py (+61, -0)
",-0.566385,-0.682875,-0.53035,1.365014,0.329848,0.237798,0.608882,-0.044796,0.741417,0.001299,0.141423,0.420328,-0.110189,0.346919,-0.21639
openstack/octavia,Id2b560df1cde9ce9403afbd593bbaa6cae5f06d6,0,0,0,6.3509,0.1294,38,13.86,640,0,CI,0,0,0,0,0.0,0.0,0,0.0,6,6,0,0.1667,4.3994,3.79,59.33,11.32,1,0,0.3549,1,1.1169,0,0,0,0,0,"Add VIP access control list

This patch extends the listener API to include the new parameter
'allowed_cidrs'. This parameter is a list of IPv4 or IPv6 CIDRs. Leaving
this list unset defaults to the traditional behavior of allowing all
ingress traffic to the listener. Setting it will deny all traffic but
all CIDRs set in the 'allowed_cidrs' list.

Note that the API will validate that all CIDRs match the same IP version
of the VIP. This may change later as part of work to allow multiple VIPs
per LB (Change-Id Id7153dbf33b9616d7af685fcf13ad9a79793c06b).

Task: 26210
Story: 2003686
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+15, -0)
api-ref/source/v2/examples/listener-update-curl (+1, -1)
octavia/common/utils.py (+6, -0)
api-ref/source/v2/examples/listener-update-request.json (+5, -1)
octavia/db/base_models.py (+2, -0)
octavia/tests/unit/network/drivers/neutron/test_base.py (+4, -2)
octavia/db/migration/alembic_migrations/versions/da371b422669_allowed_cidr_for_listeners.py (+40, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/common/sample_data_models.py (+3, -2)
octavia/db/repositories.py (+35, -0)
api-ref/source/v2/examples/listener-create-response.json (+5, -1)
octavia/tests/functional/db/test_models.py (+10, -0)
releasenotes/notes/add-vip-acl-4a7e20d167fe4a49.yaml (+5, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+41, -29)
octavia/tests/functional/api/v2/test_load_balancer.py (+22, -2)
api-ref/source/v2/examples/listener-update-response.json (+5, -1)
octavia/tests/unit/api/drivers/test_utils.py (+0, -17)
octavia/tests/functional/api/v2/test_listener.py (+95, -0)
api-ref/source/v2/examples/listener-show-response.json (+5, -1)
doc/source/user/guides/basic-cookbook.rst (+37, -0)
octavia/db/models.py (+20, -0)
doc/source/contributor/guides/providers.rst (+4, -0)
octavia/api/v2/types/listener.py (+6, -0)
api-ref/source/v2/examples/listener-create-request.json (+5, -1)
api-ref/source/v2/listener.inc (+6, -0)
api-ref/source/v2/examples/listener-create-curl (+1, -1)
api-ref/source/v2/examples/listeners-list-response.json (+5, -1)
octavia/api/drivers/utils.py (+8, -0)
octavia/tests/functional/db/test_repositories.py (+2, -1)
octavia/api/common/types.py (+15, -0)
octavia/common/data_models.py (+18, -1)
octavia/controller/worker/v1/flows/listener_flows.py (+2, -0)
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+31, -8)
octavia/network/drivers/neutron/base.py (+4, -1)
octavia/api/root_controller.py (+4, -1)
octavia/tests/functional/api/drivers/driver_agent/test_driver_agent.py (+0, -1)
octavia/api/v2/controllers/listener.py (+27, -0)
octavia/controller/worker/v2/flows/listener_flows.py (+2, -0)
",-1.917766,-0.544188,0.904543,-0.169205,0.580202,0.338517,0.205343,0.199675,0.635696,0.06743,0.060156,0.226513,-0.165636,-0.266852,-0.362037
openstack/octavia,Id7153dbf33b9616d7af685fcf13ad9a79793c06b,0,0,0.0,8.2223,0.1956,90,10.91,853,0,Bug Fix,0,0,0,1,0.002439,0.25,0,0.0,7,8,0,0.1429,5.2231,4.71,48.42,11.7,1,0,0.63,1,0.2291,0,0,0,0,0,"Allow multiple VIPs per LB

User can specify additional subnet_id/ip_address pairs to bring up on
the VIP port. This will allow for situations like having an LB with both
IPv4+IPv6 or being exposed on both public and a private network.

For UDP/SCTP loadbalancers, mixing IPv4 VIP and IPv6 members is not
supported (IPv6 VIP and IPv4 members as well). It's still possible to
use IPv4 and IPv6 VIPs at the same time in the same loadbalancer but an
IPv4 VIP can only communicate with IPv4 members.

Thanks Michael for help with validating/fixing the templates!
Thanks Gregory for help with the centos networking!

Co-Authored-By: Michael Johnson <johnsomor@gmail.com>
Co-Authored-By: Gregory Thiemonge <gthiemon@redhat.com>
Co-Authored-By: Brian Haley <haleyb.dev@gmail.com>
Story: 2005608
Task: 30847
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+13, -2)
octavia/common/utils.py (+5, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+41, -0)
octavia/db/base_models.py (+3, -0)
octavia/tests/unit/controller/worker/v2/flows/test_amphora_flows.py (+2, -2)
octavia/tests/unit/network/drivers/neutron/test_base.py (+5, -3)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/unit/amphorae/drivers/keepalived/test_vrrp_rest_driver.py (+9, -2)
octavia/amphorae/backends/utils/interface_file.py (+64, -52)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+57, -44)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+14, -0)
octavia/common/constants.py (+1, -0)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+5, -0)
octavia/controller/worker/v2/controller_worker.py (+6, -1)
octavia/tests/unit/api/drivers/noop_driver/test_driver.py (+5, -3)
api-ref/source/v2/examples/loadbalancer-create-response.json (+4, -0)
api-ref/source/v2/examples/loadbalancers-list-response.json (+1, -0)
octavia/network/base.py (+2, -1)
octavia/network/data_models.py (+9, -1)
octavia/network/drivers/noop_driver/driver.py (+114, -32)
octavia/network/drivers/neutron/allowed_address_pairs.py (+58, -19)
octavia/amphorae/backends/agent/api_server/osutils.py (+4, -10)
octavia/controller/worker/v2/flows/amphora_flows.py (+2, -1)
octavia/tests/unit/api/drivers/test_utils.py (+37, -0)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+4, -1)
octavia/amphorae/drivers/driver_base.py (+7, -1)
octavia/db/models.py (+25, -0)
api-ref/source/v2/examples/loadbalancer-full-create-response.json (+1, -0)
octavia/amphorae/drivers/keepalived/vrrp_rest_driver.py (+1, -8)
octavia/tests/unit/api/v2/types/test_load_balancer.py (+11, -0)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+12, -6)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+11, -2)
api-ref/source/v2/examples/loadbalancer-update-response.json (+1, -0)
octavia/api/drivers/utils.py (+38, -1)
octavia/tests/functional/db/test_repositories.py (+7, -2)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+10, -6)
octavia/common/data_models.py (+15, -1)
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+135, -12)
elements/haproxy-octavia/post-install.d/20-haproxy-tune-kernel (+3, -3)
api-ref/source/v2/loadbalancer.inc (+10, -0)
octavia/api/drivers/noop_driver/driver.py (+19, -7)
octavia/common/jinja/lvs/templates/keepalivedlvs.cfg.j2 (+1, -1)
octavia/common/jinja/lvs/templates/macros.j2 (+23, -3)
octavia/network/drivers/neutron/base.py (+31, -17)
octavia/amphorae/drivers/keepalived/jinja/jinja_cfg.py (+59, -17)
octavia/common/jinja/haproxy/split_listeners/templates/haproxy.cfg.j2 (+1, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+18, -0)
octavia/tests/common/constants.py (+2, -0)
octavia/tests/unit/common/jinja/lvs/test_jinja_cfg.py (+56, -14)
octavia/amphorae/drivers/noop_driver/driver.py (+6, -3)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+128, -10)
api-ref/source/v2/examples/loadbalancer-create-request.json (+4, -0)
octavia/api/v2/controllers/load_balancer.py (+54, -6)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+8, -5)
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+24, -13)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+75, -7)
octavia/amphorae/backends/agent/api_server/server.py (+2, -1)
octavia/tests/common/data_model_helpers.py (+16, -3)
octavia/tests/common/sample_data_models.py (+20, -1)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+17, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_osutils.py (+35, -25)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+16, -2)
octavia/common/jinja/haproxy/combined_listeners/templates/haproxy.cfg.j2 (+2, -1)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+454, -27)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+21, -6)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+79, -3)
octavia/tests/unit/network/drivers/noop_driver/test_driver.py (+31, -8)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+3, -0)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+17, -1)
octavia/db/repositories.py (+30, -2)
octavia/amphorae/drivers/keepalived/jinja/templates/keepalived_base.template (+51, -33)
octavia/api/drivers/amphora_driver/v2/driver.py (+24, -7)
octavia/common/jinja/lvs/jinja_cfg.py (+12, -2)
octavia/tests/unit/amphorae/backends/utils/test_interface_file.py (+68, -39)
octavia/tests/functional/api/v2/test_load_balancer.py (+221, -54)
octavia/amphorae/backends/agent/api_server/plug.py (+75, -57)
octavia/controller/worker/v2/tasks/database_tasks.py (+28, -0)
releasenotes/notes/support-additional-vips-on-lb-creation-efe0dfa517c667a0.yaml (+12, -0)
api-ref/source/v2/examples/loadbalancer-create-curl (+1, -1)
octavia/api/drivers/amphora_driver/v1/driver.py (+7, -1)
octavia/tests/unit/amphorae/drivers/keepalived/jinja/test_jinja_cfg.py (+282, -85)
octavia/api/v2/types/load_balancer.py (+11, -0)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+4, -1)
octavia/tests/unit/amphorae/backends/agent/api_server/test_plug.py (+86, -37)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+2, -1)
octavia/api/root_controller.py (+4, -1)
octavia/controller/worker/v2/tasks/network_tasks.py (+19, -7)
octavia/db/migration/alembic_migrations/versions/31f7653ded67_allow_multiple_vips_per_loadbalancer.py (+44, -0)
api-ref/source/v2/examples/loadbalancer-show-response.json (+1, -0)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+36, -1)
",-3.735082,0.721636,2.020167,-0.124139,0.073729,0.331937,-0.46802,0.248272,-0.060289,-0.110253,0.25868,0.40504,0.392288,-0.06412,-0.362212
openstack/octavia,I75cde3ff820f085aebbdffd1e40c5ff40f16835d,1,0,0,4.9972,0.1293,4,12.5,208,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,3,0,0.125,1.3893,4.25,41.87,11.4,1,0,0.5918,1,1.4054,0,0,0,0,0,"Fixed pool and members status with UDP loadbalancers

This commit fixes pool and members status when using UDP loadbalancers.

Story: 2005736
Task: 33394
[SEP]
FILES CHANGED:
releasenotes/notes/fix-udp-members-status-ef3202849bfda29b.yaml (+6, -0)
octavia/common/jinja/lvs/templates/macros.j2 (+6, -2)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+40, -6)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+76, -11)
",-0.242207,0.048362,-1.222914,0.835219,0.754587,0.683343,-1.176393,-0.061268,0.044009,-0.146681,0.037213,0.387084,0.680273,0.028593,-0.208039
openstack/octavia,Idaacfa60a1909d3f5e0f94371a405c8ce8ae9efa,1,0,1.0,4.7274,0.0714,6,9.0,308,0,Feature,0,0,0,1,0.006757,0.3333,0,0.3333,6,3,0,0.2222,1.924,4.5,14.4,12.49,1,0,0.8929,1,2.7257,0,0,0,0,0,"Add support for monitor_{address,port} in UDP members

UDP members didn't support monitor_address and monitor_port parameters.
Setting those values didn't have any effects.

This commit enables the support of both parameters.

Story: 2005775
Task: 33492
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+56, -0)
octavia/common/jinja/lvs/templates/macros.j2 (+1, -1)
releasenotes/notes/fix-support-for-monitoring-address-and-port-in-udp-members-ff83395544f228cf.yaml (+6, -0)
octavia/common/jinja/lvs/jinja_cfg.py (+3, -1)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+19, -3)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+19, -3)
",-0.79474,-0.162857,-0.866631,0.870813,0.095566,1.061719,-1.097878,-0.469419,0.154355,0.291543,-0.057628,-0.134513,0.288878,0.183015,-0.261715
openstack/octavia,Id7543ae82703386fcd0f98428c340be4570b0b2f,0,0,0,3.8501,0.5,1,6.5,1175,0,CI,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.3,0.0,1.0,-13.79,15.93,1,0,0.0,0,25.0,0,0,0,0,0,"Replace AMP_BASEOS with DISTRO_NAME for diskimage-builder RHEL8 img-defaults

When diskimage-builder gets invoked by diskimage-create.sh, $DIB_RELEASE
is set whereas $DISTRO_NAME is not.

This[1] change to diskimage-builder adds support for RHEL8 and also
changes the default file-system specifically for it to 'xfs', which
means that diskimage-builder needs to be aware of the DISTRO_NAME before
it gets to load the specific elements provided to it.

The above makes it difficult to leverage img-defaults[2], the
environment variable $DISTRO_NAME is not set when img-defaults is called
but $AMP_BASEOS, which is used exclusively[3] in Octavia
diskimage-create.sh, is.

This patch replaces $AMP_BASEOS with $DISTRO_NAME, which is a variable
name used in diskimage-builder[4].

[1] https://review.opendev.org/#/c/643731/
[2] https://opendev.org/openstack/diskimage-builder/src/branch/master/diskimage_builder/lib/img-defaults
[3] http://codesearch.openstack.org/?q=AMP_BASEOS&i=nope&files=&repos=
[4] http://codesearch.openstack.org/?q=DISTRO_NAME&i=nope&files=&repos=

Depends-On: https://review.openstack.org/#/c/643731/
[SEP]
FILES CHANGED:
diskimage-create/diskimage-create.sh (+23, -23)
",-4.43521,3.137775,3.216829,-0.340269,0.239707,0.5001,-1.078207,-0.565046,-0.56335,-0.315232,-0.533346,0.129547,-0.2382,0.18395,-0.141423
openstack/python-octaviaclient,I418f8040364942425f396dfc85ae10984d93fae4,0,0,0.0,4.8752,0.0,3,9.33,367,0,Feature,0,0,0,3,0.006757,0.1667,0,0.0,5,2,0,0.0,1.0573,2.67,62.91,8.02,1,0,0.4923,0,2.8015,0,0,0,0,0,"Adds ""unset"" action to the member command

This patch adds ""openstack loadbalancer member unset"" action to the
octavia client. This allows the user to unset the name, backup,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/member.py (+65, -0)
setup.cfg (+1, -0)
octaviaclient/tests/unit/osc/v2/test_member.py (+64, -0)
",-0.559569,-0.72586,-0.518693,1.290579,0.33316,0.223885,0.569502,-0.064798,0.710397,-0.061355,0.124339,0.410464,-0.103319,0.410821,-0.204818
openstack/python-octaviaclient,Id04b740567fec5ca4b27daafffc6c4759ea520db,0,0,0.0,4.9628,0.0141,3,9.33,386,0,Feature,0,0,0,4,0.006969,0.1429,0,0.0,5,2,0,0.0,1.0534,2.67,50.82,10.16,1,0,0.5,0,2.6993,0,0,0,0,0,"Adds ""unset"" action to the healthmonitor command

This patch adds ""openstack loadbalancer healthmonitor unset"" action to the
octavia client. This allows the user to unset the name, domain_name,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/health_monitor.py (+68, -2)
octaviaclient/tests/unit/osc/v2/test_health_monitor.py (+71, -0)
setup.cfg (+1, -0)
",-0.683424,-0.678247,-0.466834,1.267173,0.45539,0.118426,0.429823,-0.006487,0.723842,-0.032694,0.084004,0.378404,-0.121555,0.35591,-0.1798
openstack/octavia,I5253c48871a8bb3bf91f82aa7791585cc4a6d529,1,0,0.0,4.0254,0.1455,4,11.5,348,0,Bug Fix,0,0,0,5,0.006983,0.2,0,0.0,5,2,0,0.2727,1.5639,3.25,37.0,13.3,0,0,0.3818,1,6.2143,0,0,0,0,0,"Fix flavor profile API handling of None updates

The current flavor profile API does not properly handle
clearing/reseting values on update. Some mandatory fields would
return a database ""cannot be Null"" error. This patch raises the
proper invalid option execption.

Story: 2005374
Task: 33542
[SEP]
FILES CHANGED:
octavia/common/constants.py (+2, -0)
releasenotes/notes/Fix-API-update-null-None-1b400962017a3d56.yaml (+6, -0)
octavia/api/v2/controllers/flavor_profiles.py (+19, -7)
octavia/tests/functional/api/v2/test_flavor_profiles.py (+20, -1)
",-0.28745,-1.865012,-0.410331,0.263129,-0.026793,0.441585,-0.613011,-0.25434,0.58738,0.139326,-0.085384,-0.003907,0.173882,-0.134256,0.015035
openstack/python-octaviaclient,Ie56cd94e345f27fe99b8669b56c319f1f15290ab,0,0,0.1667,4.4773,0.0,3,10.6,352,0,Feature,0,0,0,6,0.007782,0.125,0,0.0208,5,2,0,0.0,1.0542,2.67,58.8,9.52,1,0,0.5862,0,4.0,0,0,0,0,0,"Adds ""unset"" action to the flavor command

This patch adds ""openstack loadbalancer flavor unset"" action to the
octavia client. This allows the user to unset the description.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/flavor.py (+35, -0)
octaviaclient/tests/unit/osc/v2/test_flavor.py (+51, -0)
setup.cfg (+1, -0)
",-0.315679,-0.603343,-0.657902,1.347898,0.286554,0.255301,0.661539,-0.05906,0.699065,-0.050589,0.103977,0.582529,-0.218322,0.337936,-0.093917
openstack/python-octaviaclient,Ieb24ce5ed94f305a7a76d033ea5b7a7a1872c3ed,0,0,0.1429,4.654,0.0,3,9.33,376,0,Feature,0,0,0,7,0.008159,0.1111,0,0.0159,5,2,0,0.0,1.0572,2.67,49.31,10.16,1,0,0.5577,0,3.581,0,0,0,0,0,"Adds ""unset"" action to the l7policy command

This patch adds ""openstack loadbalancer l7policy unset"" action to the
octavia client. This allows the user to unset the name, description,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/l7policy.py (+45, -0)
octaviaclient/tests/unit/osc/v2/test_l7policy.py (+58, -0)
setup.cfg (+1, -0)
",-0.783626,-0.58397,-0.510326,1.252519,0.524387,0.1089,0.403328,-0.014656,0.718553,0.063161,0.116121,0.397196,-0.143515,0.322977,-0.155339
openstack/python-octaviaclient,I4931c024392889e75c9f428a0c7a6053e8a1abf4,0,0,0.125,4.625,0.0,3,9.33,366,0,Feature,0,0,0,8,0.008316,0.1,0,0.0125,5,2,0,0.0,1.0631,2.67,61.4,8.02,1,0,0.5446,0,3.5882,0,0,0,0,0,"Adds ""unset"" action to the l7rule command

This patch adds ""openstack loadbalancer l7rule unset"" action to the
octavia client. This allows the user to unset the invert, key,
etc. setings.

This is a patch in a chain adding ""unset"" to all of the octavia
commands. A follow on patch will include the release note.
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/test_l7rule.py (+55, -0)
octaviaclient/osc/v2/l7rule.py (+45, -0)
setup.cfg (+1, -0)
",-0.723838,-0.661393,-0.382496,1.082688,0.487518,0.066261,0.33639,-0.037073,0.6391,0.048671,0.090801,0.357635,-0.113069,0.295481,-0.108623
openstack/octavia,I4e8007ff98f585ce6622f7128ecdd53cdfa926a7,1,0,0.1111,2.9957,0.0,3,12.67,301,0,Bug Fix,0,0,0,9,0.008467,0.0,0,0.0,5,1,0,0.3333,1.2674,3.67,31.46,15.59,1,0,0.6316,0,15.05,0,0,0,0,0,"Fix l7rule API handling of None updates

The current l7rule API does not properly handle
clearing/reseting values on update.

This patch corrects this to appropriately handle None/null updates
to the l7rule parameters.

Story: 2005374
Task: 36023
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_l7rule.py (+12, -0)
octavia/api/v2/controllers/l7rule.py (+5, -0)
octavia/common/validate.py (+2, -0)
",-0.29925,-1.34274,-0.357897,0.453839,0.195272,0.267857,-0.984827,-0.055492,0.188477,0.22724,-0.397449,-0.147961,0.342342,-0.166672,0.072616
openstack/python-octaviaclient,If95cc0c91df4c6831d91995ca0cf849986be951e,0,0,0.2,4.8675,0.0,4,11.0,241,0,Feature,0,0,0,10,0.009242,0.0909,0,0.0182,5,3,0,0.0,1.2755,2.5,49.54,10.46,1,0,0.5194,1,1.8538,0,0,0,0,0,"Adds ""unset"" action to the quota command

This patch adds ""openstack loadbalancer quota unset"" action to the
octavia client. This allows the user to reset the quota to the default
value.
[SEP]
FILES CHANGED:
releasenotes/notes/Add-unset-commands-15490df414a70df0.yaml (+6, -0)
octaviaclient/tests/unit/osc/v2/test_quota.py (+67, -0)
octaviaclient/osc/v2/quota.py (+55, -0)
setup.cfg (+1, -0)
",0.837988,-0.762696,-0.23118,1.266763,0.39145,0.178258,0.795673,0.351468,0.846576,-0.28125,0.02853,0.729488,-0.494059,0.102264,-0.119094
openstack/octavia,I2cf241ea965ad56ed70ebde83632ab855f5d859e,0,0,0.0,4.8203,0.3008,10,7.38,467,0,Doc,0,0,0,1,0.000531,0.3333,0,0.0,7,1,0,0.3846,2.8119,4.3,27.28,9.73,1,0,0.1138,0,3.7661,0,0,0,0,0,"Use retry for AmphoraComputeConnectivityWait

Use taskflow retry for connectivity wait. [1]

This reqired for redis jobboard implementation as each retry expand
claim for job on worker. This means that worker is proccesing job and
it should not be released for other workers to work on it.

Adopted for v2 flows.

[1] - https://docs.openstack.org/taskflow/latest/user/atoms.html#retry

Story: 2005072
Task: 33477
[SEP]
FILES CHANGED:
octavia/amphorae/driver_exceptions/exceptions.py (+6, -0)
octavia/common/constants.py (+1, -0)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+24, -2)
octavia/tests/unit/controller/queue/v2/test_endpoints.py (+3, -5)
octavia/controller/queue/v2/endpoints.py (+2, -6)
octavia/controller/worker/v2/flows/amphora_flows.py (+15, -5)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+24, -13)
octavia/amphorae/drivers/noop_driver/driver.py (+4, -3)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+4, -2)
octavia/amphorae/drivers/driver_base.py (+3, -1)
",-0.694411,-0.55081,0.232946,-0.084511,-0.687467,-0.115442,0.306266,0.396161,0.251047,-0.10815,0.122729,-0.219829,0.008659,0.120814,-0.336388
openstack/octavia,I4230feae5b6f0778b738bddbc69c5a0cd3e6930c,1,0,0,2.1972,0.0,2,8.4,375,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,1,0,0.3571,1.0,5.0,25.08,12.88,1,0,0.0,0,41.6667,0,0,0,0,0,"worker: Re-add FailoverPreparationForAmphora

This tasks removes the dns_name option from ports, so that they can be
plugged into a new amphora, which has a different name. This was lost in
change I04d267bd3cdedca11f0350c5255086233cba14ec.

Story: 2006205
Task: 35791
[SEP]
FILES CHANGED:
octavia/controller/worker/v1/flows/amphora_flows.py (+4, -0)
octavia/controller/worker/v2/flows/amphora_flows.py (+4, -0)
",-0.757419,-1.125656,-1.297941,-0.975467,0.385604,0.164152,0.253878,-0.041123,0.173162,0.095451,0.207504,-0.105249,0.08723,0.279023,-0.202444
openstack/octavia-lib,I224acdf4a1a946ef6e5ecb49a3a54938a6c961a7,0,0,0.1818,3.4965,0.1875,2,11.67,243,0,CI,0,0,0,11,0.009083,0.0,0,0.0,5,1,0,0,0.9544,4.0,37.88,11.52,0,0,0.375,0,7.3636,0,0,0,0,0,"Add project_id to all of the data model objects

This patch adds a project_id field to all of the data model objects.

This is useful for drivers to track/associate objects on the backend.
[SEP]
FILES CHANGED:
octavia_lib/tests/unit/api/drivers/test_data_models.py (+12, -0)
octavia_lib/api/drivers/data_models.py (+14, -6)
",0.188089,-0.29319,-0.534106,1.750498,0.699257,0.465598,0.357523,-0.358423,0.437246,0.166176,-0.374137,0.230464,-0.131364,-0.190015,-0.430403
openstack/octavia,I8f509677da463bc5d0a7649f2f609045cf9b2dd7,0,0,0.1667,4.2767,0.2394,6,12.0,257,0,CI,0,0,1,12,0.009654,0.5,0,0.0833,5,3,0,0.4,2.2139,2.83,51.31,13.69,1,0,0.5352,0,3.5694,0,0,0,0,0,"Add project_id to all of the provider objects

This patch adds a project_id field to all of the provider driver data
model objects.

This is useful for drivers to track/associate objects on the backend.
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
doc/source/contributor/guides/providers.rst (+13, -0)
octavia/tests/functional/api/v2/test_member.py (+16, -8)
octavia/tests/unit/api/drivers/sample_data_models.py (+13, -1)
lower-constraints.txt (+1, -1)
octavia/api/drivers/utils.py (+10, -6)
",0.354758,-0.894302,-0.407814,1.392037,0.599675,0.166323,0.174773,-0.121305,0.458554,-0.00493,-0.648236,0.053698,-0.111605,-0.150966,-0.422986
openstack/octavia,I018e36f69a9c0b48a6651a01cc9a64abfc04d4de,1,0,0.1538,2.3979,0.5,3,14.0,367,0,Feature,0,0,0,13,0.009893,0.0,0,0.0,4,3,0,0.375,1.5219,4.0,53.64,11.31,0,0,0.0,1,33.3636,0,0,0,0,0,"Limit cryptsetup key RAM usage

This patch limits cryptsetup to 256MB of RAM during the amphora
startup. Recent distros have changed to LUKS2 with Argon2
key derivation which defaults to using up to 1GB of RAM.
Typically our amphora are built with only 1GB of RAM for the whole
system.

Story: 2005837
Task: 33606
[SEP]
FILES CHANGED:
elements/certs-ramfs/init-scripts/sysv/certs-ramfs (+2, -2)
elements/certs-ramfs/init-scripts/upstart/certs-ramfs.conf (+2, -2)
elements/certs-ramfs/init-scripts/systemd/certs-ramfs.service (+1, -1)
",-0.456582,-1.480646,-0.190528,0.25281,-0.036549,0.280735,0.039802,0.489239,-0.141148,0.121208,-0.085283,0.031893,0.103163,-0.088939,0.025916
openstack/octavia,Ifda91e0310e812e34f1e398dd3176af8a9c58f89,0,0,0.2143,5.3519,0.219,17,11.0,398,0,CI,0,0,0,14,0.010574,0.2,0,0.0429,7,4,0,0.4118,3.3763,4.71,32.62,16.76,1,0,0.5667,1,1.8863,1,0,0,0,0,"Align logging in the amphora

This patch configures the primary components of the amphora to log
to syslog using consistent logging facilities.
By default, user traffic logs will go to LOG_LOCAL0 and the amphora
processes (haproxy, keepalived, etc.) will log to LOG_LOCAL1.

This is a patch supporting log offloading.

Story: 1665069
Task: 5486
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/keepalived.py (+5, -1)
octavia/common/config.py (+10, -0)
octavia/tests/unit/common/sample_configs/sample_configs.py (+13, -3)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+3, -1)
octavia/amphorae/backends/agent/api_server/templates/keepalived.systemd.j2 (+2, -2)
octavia/common/jinja/haproxy/jinja_cfg.py (+14, -3)
octavia/amphorae/backends/agent/templates/amphora_agent_conf.template (+4, -0)
octavia/common/jinja/haproxy/templates/base.j2 (+2, -2)
octavia/common/jinja/haproxy/templates/macros.j2 (+1, -8)
etc/octavia.conf (+13, -0)
octavia/amphorae/backends/agent/api_server/templates/keepalived.sysvinit.j2 (+2, -2)
octavia/tests/unit/common/jinja/haproxy/test_jinja_cfg.py (+52, -14)
octavia/amphorae/backends/agent/api_server/templates/keepalived.upstart.j2 (+2, -2)
octavia/amphorae/backends/agent/agent_jinja_cfg.py (+4, -1)
octavia/tests/unit/amphorae/backends/agent/test_agent_jinja_cfg.py (+27, -6)
octavia/cmd/agent.py (+5, -0)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+5, -1)
",-1.057285,-0.818843,-0.54589,0.723637,0.286124,0.192692,-0.255434,0.077106,0.212214,-0.019531,0.2152,-0.012045,0.191791,0.089011,-0.356873
openstack/octavia,I4cf0ad5d14c4378e33423a4d639ec4d0fcc2a614,0,0,0,2.7726,0.4667,3,4.44,383,0,Feature,0,0,1,0,0.0,1.0,0,0.0,0,2,0,0.3889,1.1033,0.0,14.09,12.78,1,0,0.0,1,23.9375,0,0,0,0,0,"Update tox.ini for new upper constraints strategy

The requirements team has defined a new strategy for handling
upper constraints[1]. This patch applies those strategies to
Octavia.
This also corrects a lower constraint for oslo.messaging.

[1] http://lists.openstack.org/pipermail/openstack-discuss/ \
    2019-May/006478.html
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
lower-constraints.txt (+1, -1)
tox.ini (+6, -5)
",-0.692913,0.285961,-0.56933,0.284811,-0.938968,-0.391433,0.331884,0.676812,0.525169,0.58574,-0.025665,-0.236199,0.072282,0.113189,-0.220166
openstack/octavia-lib,I29db66a282886ced2bd1bc1176f279728e5137e5,0,0,0.0,3.2189,0.25,2,18.5,264,0,Feature,0,0,0,2,0.000484,0.0,0,0.0,5,1,0,0.0,0.4138,4.0,48.58,14.97,0,0,0.0833,0,10.56,0,0,0,0,0,"Additional VIPs is also relevant in provider_base

Though this is just an abstract class so it doesn't break functionality,
it should be kept up to date for the sake of implementers.

Story: 2005608
Task: 33612
[SEP]
FILES CHANGED:
octavia_lib/api/drivers/provider_base.py (+17, -5)
octavia_lib/tests/unit/api/drivers/test_provider_base.py (+1, -1)
",1.158512,-1.123225,-0.115967,0.083621,-0.922515,0.832482,0.292142,-0.797581,-0.046221,0.23588,-0.210103,0.316796,-0.401346,-0.140949,0.115482
openstack/octavia-lib,Ia69d1f61571a1a65dee585037affb317999d7ade,0,0,0.2,5.7961,0.0244,8,18.75,477,0,Bug Fix,0,0,1,15,0.009778,0.25,0,0.05,5,3,0,0.0,1.7145,2.25,52.44,12.3,0,0,0.3415,1,1.4498,0,0,0,0,0,"Add get methods to the driver-lib

This patch adds get methods to the driver-lib which allows provider
drivers to query for objects by ID.
In support of the get methods, this patch fixes a bug in the data
model to_dict() where it may not properly recurse the objects.
It also improves connecting to the driver agent sockets and adds a
timeout while waiting to receive data from the driver-agent.

Story: 2005870
Task: 33682
[SEP]
FILES CHANGED:
octavia_lib/api/drivers/driver_lib.py (+152, -1)
octavia_lib/tests/unit/api/drivers/test_driver_lib.py (+110, -2)
requirements.txt (+1, -0)
octavia_lib/common/constants.py (+1, -0)
lower-constraints.txt (+1, -0)
octavia_lib/api/drivers/exceptions.py (+43, -5)
releasenotes/notes/Add-get-methods-to-driver-lib-dae3c217e7ac9e82.yaml (+11, -0)
octavia_lib/api/drivers/data_models.py (+1, -0)
",-0.277956,-1.481945,0.358968,0.499066,-0.40194,-0.182666,0.643026,0.105127,0.260456,0.071726,-0.181835,-0.176577,0.320288,-0.065641,0.049443
openstack/octavia,I20572505e448f9b7ff6314b5167cc4c519c445fb,1,0,0.1875,1.7918,0.0,2,9.33,230,0,Bug Fix,0,0,0,16,0.008593,0.0,0,0.0,2,2,0,0.3684,0.7219,2.0,37.23,8.02,0,0,0.0,1,38.3333,0,0,0,0,0,"Fix allocate_and_associate DB deadlock

In testing we saw a DB deadlock in allocate_and_associate.
This patch corrects that with a DB retry wrapper.

Story: 2005893
Task: 33751
[SEP]
FILES CHANGED:
octavia/db/repositories.py (+1, -0)
releasenotes/notes/Fix-allocate_and_associate-deadlock-3ff1464421c1d464.yaml (+4, -0)
",0.557369,-0.163347,-0.807469,-0.035121,-0.0245,1.125201,-0.336525,-0.734201,0.1925,-0.350743,0.753153,-0.164988,-0.055605,-0.102762,0.544445
openstack/octavia,I2eb8a0b5de46ee56321bc0009b6ca2b3ad4caebf,0,0,0.2353,3.4965,0.25,3,10.67,230,0,Bug Fix,0,0,0,17,0.009106,0.2857,0,0.0672,6,1,0,0.4,1.3356,4.0,45.31,13.02,1,0,0.375,0,6.9697,0,0,0,0,0,"Fix TCP listener logging bug

HAProxy is not handling two of the HTTP log format variables correct
when the load balancer has a TCP listener.
This patch corrects that problem.
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/haproxy/test_jinja_cfg.py (+6, -6)
octavia/common/constants.py (+3, -0)
octavia/common/jinja/haproxy/jinja_cfg.py (+15, -2)
",1.247391,-2.181398,0.361242,0.379534,-0.372605,0.272009,-0.05978,-0.015448,0.179076,0.013124,-0.208728,0.046772,-0.225578,-0.333561,0.184208
openstack/octavia,I6f5d95c5f875edda530f54ae72386d6495235ca6,1,0,0.2222,5.0626,0.0382,3,14.0,308,0,Bug Fix,0,0,0,18,0.009479,0.0,0,0.0,7,1,0,0.381,0.4392,6.33,43.57,14.17,1,0,0.9873,0,1.9494,1,0,0,0,0,"Fix a python3 issue in the amphora-agent

An exception handler in the amphora-agent has a python3 string
comparison bug that will cause a TypeError.
This patch fixes that bug and adds test coverage for the
start_stop_listener.

Story: 2005898
Task: 33760
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/backends/agent/api_server/test_listener.py (+145, -0)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+5, -5)
octavia/amphorae/backends/agent/api_server/listener.py (+1, -1)
",0.067723,-1.201674,-0.516577,-0.157397,-0.538333,0.054224,0.166575,-0.033542,0.612613,0.105884,0.380742,0.1985,-0.061632,-0.091121,0.485615
openstack/octavia,Ice4071e1f872c8c0d0595427cff6f02ffbcf7968,0,0,0.2632,4.4188,0.3537,3,14.4,493,0,Doc,0,0,0,19,0.009241,0.0,1,0.0,3,1,0,0.4091,1.0696,2.33,41.82,14.09,1,0,0.0,0,5.9398,0,0,0,0,0,"Add the Amphora image building guide to the docs

This patch adds the Amphora image building guide from the
diskimage-create README.rst to the Administration documentation.
It also re-organizes the Adminstration guides to be broken down
by category as the old page was becoming a long list of guides.
(I like that kind of problem)
The diskimage-create README has a few formating corrections to make
it render better for the documentation.
[SEP]
FILES CHANGED:
diskimage-create/README.rst (+22, -13)
doc/source/admin/index.rst (+30, -16)
doc/source/admin/amphora-image-build.rst (+1, -0)
",-0.657231,-1.363095,0.117645,0.597894,-0.545101,-0.033114,0.527613,-0.018053,-0.068875,0.004312,0.129666,0.251087,0.075354,0.41594,-0.110484
openstack/octavia,I4103bcbaab65ed5d7683d35aaf04955e59ed2471,0,0,0.25,3.2958,0.1538,3,8.2,380,0,CI,0,0,0,20,0.009355,0.0,0,0.0,2,3,0,0.3913,1.4979,1.33,-16.08,16.94,0,0,0.0,1,14.0741,0,0,0,0,0,"Specify the linux-image-kvm kernel for ubuntu

This patch switches to using the linux-image-kvm kernel by default.
It produces images that are about 200MB smaller than ubuntu-minimal with
linux-image-generic by using the linux-image-kvm instead of the
linux-image-generic kernel.

Depends-On: https://review.opendev.org/666063
[SEP]
FILES CHANGED:
releasenotes/notes/Use-Ubuntu-KVM-kernel-for-Amphora-a1e8af8bc7893011.yaml (+7, -0)
diskimage-create/README.rst (+4, -2)
diskimage-create/diskimage-create.sh (+11, -2)
",-1.880847,1.379066,-1.13571,1.127331,0.013774,-0.444017,0.386875,0.091859,-0.031266,-0.150417,0.428027,0.420143,0.497772,0.253237,0.442445
openstack/octavia,I44919db35570fda7cc81a194c8c26e22c145855c,0,0,0.0,5.7991,0.4924,13,11.0,117,0,Feature,0,0,0,2,0.000998,0.25,0,0.0,7,1,0,0.375,3.0003,5.38,34.16,18.95,1,0,0.3587,0,0.3545,0,0,0,0,0,"Transition l7policy flows to dicts

Story: 2005072
Task: 30812
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+12, -6)
octavia/controller/worker/v2/tasks/database_tasks.py (+44, -30)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+34, -26)
octavia/tests/unit/controller/queue/v2/test_endpoints.py (+6, -6)
octavia/tests/unit/controller/worker/v2/flows/test_l7policy_flows.py (+4, -6)
octavia/common/constants.py (+2, -0)
octavia/controller/worker/v2/controller_worker.py (+30, -57)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+4, -4)
octavia/controller/worker/v2/tasks/lifecycle_tasks.py (+5, -5)
octavia/api/drivers/amphora_driver/v2/driver.py (+5, -6)
octavia/controller/worker/v2/flows/l7policy_flows.py (+3, -3)
octavia/controller/queue/v2/endpoints.py (+12, -9)
octavia/tests/unit/controller/worker/v2/tasks/test_lifecycle_tasks.py (+6, -4)
",1.874016,0.414099,-0.294912,-0.880638,0.175232,0.90065,-0.777847,0.119729,0.430589,-0.063609,0.274868,0.042802,0.100975,0.659235,-0.042675
openstack/octavia-lib,I00f0307784137e5f7555105f992a0ccc5bc16838,0,0,0.2381,2.1972,0.0,1,10.0,167,0,CI,0,0,0,21,0.009704,0.5,0,0.119,0,1,0,0.0,0.0,0.0,48.64,14.0,0,0,0.0,1,18.5556,0,0,0,0,0,"Add tox ""requirements"" env

This patch adds the ""requirements"" env to tox to allow local
requirements test runs.
[SEP]
FILES CHANGED:
tox.ini (+8, -0)
",-0.326564,0.437767,-1.14941,1.399329,1.430185,0.288267,-0.852331,-0.443861,-0.404375,0.196151,-0.14541,0.234173,0.187495,0.405081,0.125551
openstack/octavia,I8acde313e7e295cdecaa593dbeb41e8ee49afed5,0,0,0,1.3863,0.6667,1,4.11,299,0,CI,1,0,0,0,0.0,0.0,0,0.0,1,1,0,0.36,0.0,1.0,35.75,4.89,0,0,1.0,1,74.75,0,0,0,0,0,"Switch python3 versions of test jobs to match Train PTI

In Train, we will use python 3.6 and 3.7 for python3 runtime
in our gate jobs [1]. This commit also adds python 3.7.

[1] https://governance.openstack.org/tc/reference/runtimes/train.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -2)
",-0.498504,0.729373,-0.707709,0.624701,-0.521719,-0.173633,0.092657,0.731328,-0.286556,1.104594,-0.492281,-0.148725,-0.23651,-0.071955,-0.226672
openstack/octavia,I48e82f39e3980d6d50e3b710326b8e437eddb08b,1,0,0.2273,1.0986,0.0,1,7.17,306,0,Feature,0,0,1,22,0.010129,0.0,1,0.0,0,1,0,0.3462,0.0,0.0,50.04,11.24,0,0,0.0,0,102.0,0,0,0,0,0,"Add bindep.txt for Octavia

Some base packages are no longer automatically included in zuul
job runs. This is good as we need to call out our platform package
requirements.
This patch adds a bindep.txt to Octavia to capture those
package requirements.
[SEP]
FILES CHANGED:
bindep.txt (+2, -0)
",0.793061,-1.163041,-0.399865,0.575914,-0.079501,-0.07975,0.345198,-0.266656,-0.620632,-0.151042,-0.192203,-0.089742,-0.223811,0.064521,0.143862
openstack/octavia,I076335d08d5411fd629c3e8860f14980b0dbcb5a,0,0,0.2609,5.3375,0.2222,12,9.0,165,0,Doc,0,0,1,23,0.01058,1.0,0,0.2609,4,4,0,0.3704,3.1224,1.83,28.5,19.16,1,0,0.0,1,0.7933,0,0,0,0,0,"Generate PDF documentation

This patch sets up PDF document generation for Octavia.

Story: 2006101
Task: 35146
[SEP]
FILES CHANGED:
doc/source/admin/index.rst (+5, -3)
doc/source/reference/index.rst (+7, -5)
doc/source/user/index.rst (+6, -4)
doc/source/conf.py (+45, -11)
lower-constraints.txt (+1, -0)
doc/source/contributor/devref/erd.rst (+11, -4)
tools/create_flow_docs.py (+25, -7)
doc/source/index.rst (+6, -4)
bindep.txt (+25, -0)
doc/source/contributor/index.rst (+16, -8)
doc/requirements.txt (+3, -0)
tox.ini (+11, -0)
",0.685475,-0.851834,-0.640911,-0.424856,-0.489203,0.996518,-1.094729,0.429976,0.237138,-0.209288,0.161877,0.556164,-0.04425,0.659456,-0.234689
openstack/octavia,I5e47d64243667cfaa10430e12229099b508de40e,0,0,0.0,5.0106,0.1477,7,16.33,351,0,Feature,0,0,0,3,0.000722,0.0,0,0.0,5,3,0,0.3571,1.8778,3.14,33.14,13.06,0,0,0.5503,1,2.34,0,0,0,0,0,"Add `additive_only` parameter to Batch Member call

If `additive_only` is set, don't do a complete delta -- skip delete and
only update and create members (making the call additive rather than a
full replacement). This will allow for adding members in batches without
wiping out existing members.
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+6, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/api/root_controller.py (+4, -1)
octavia/api/v2/controllers/member.py (+30, -12)
octavia/tests/functional/api/v2/test_member.py (+71, -8)
releasenotes/notes/make-batch-member-call-additive-4785163e625fed1a.yaml (+6, -0)
api-ref/source/v2/member.inc (+8, -0)
",-0.220415,-0.322946,-0.196113,1.177747,0.650151,0.273443,-0.10749,-0.902451,0.230338,0.179706,-0.431596,-0.029002,0.385006,-0.391717,-0.234067
openstack/octavia,I728a9aa82986edef8128907a48c9df87d119fa8f,1,0,0,3.3322,0.037,3,17.0,135,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,2,0,0.3448,1.2487,3.33,40.29,13.86,1,0,0.6667,1,4.8214,0,0,0,0,0,"only rollback DB when we have a connection to the DB

Story: 2006062
Task: 34775
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/healthmanager/test_health_manager.py (+18, -0)
releasenotes/notes/Fix-HM-DB-Rollback-no-connection-2664c4f7823ecaec.yaml (+5, -0)
octavia/controller/healthmanager/health_manager.py (+3, -1)
",1.917607,-0.460626,-0.516739,-0.382546,-0.258098,1.286822,0.07777,-0.424927,0.222877,-0.233618,0.613026,0.302993,-0.011339,0.601316,-0.167566
openstack/octavia,Idaccbcfa0126f1e26fbb3ad770c65c9266cfad5b,1,0,0.25,8.8663,0.4213,81,9.67,458,0,Bug Fix,0,0,0,24,0.01008,1.0,0,0.25,7,4,0,0.3667,4.7575,5.28,19.07,16.97,1,0,0.5824,1,0.0646,0,0,0,0,0,"Fix multi-listener load balancers

Load balancers with multiple listeners, running on an amphora image
with HAProxy 1.8 or newer can experience excessive memory usage that
may lead to an ERROR provisioning_status.
This patch resolves this issue by consolidating the listeners into
a single haproxy process inside the amphora.

Story: 2005412
Task: 34744
Co-Authored-By: Adam Harwell <flux.adam@gmail.com>
[SEP]
FILES CHANGED:
octavia/amphorae/backends/health_daemon/health_daemon.py (+47, -30)
octavia/controller/worker/v1/flows/l7rule_flows.py (+3, -3)
octavia/controller/worker/v1/flows/load_balancer_flows.py (+1, -1)
octavia/tests/unit/amphorae/backends/agent/api_server/test_loadbalancer.py (+279, -0)
octavia/tests/unit/amphorae/drivers/keepalived/test_vrrp_rest_driver.py (+16, -6)
octavia/controller/worker/v2/flows/l7rule_flows.py (+3, -3)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+0, -0)
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+28, -27)
octavia/controller/worker/v2/controller_worker.py (+2, -1)
octavia/tests/unit/common/tls_utils/test_cert_parser.py (+6, -6)
octavia/controller/worker/v1/flows/health_monitor_flows.py (+3, -3)
octavia/tests/functional/amphorae/backend/agent/api_server/test_keepalivedlvs.py (+0, -62)
octavia/controller/worker/v2/flows/amphora_flows.py (+2, -3)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+370, -0)
octavia/tests/unit/amphorae/drivers/test_noop_amphoraloadbalancer_driver.py (+12, -17)
octavia/amphorae/drivers/driver_base.py (+27, -45)
octavia/common/jinja/haproxy/split_listeners/templates/base.j2 (+0, -0)
octavia/cmd/health_manager.py (+3, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+33, -10)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+7, -7)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_db.py (+121, -6)
octavia/amphorae/drivers/keepalived/vrrp_rest_driver.py (+10, -5)
octavia/tests/unit/amphorae/backends/utils/test_haproxy_query.py (+29, -20)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+51, -7)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+1, -1)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+38, -73)
octavia/controller/healthmanager/health_drivers/update_db.py (+92, -6)
octavia/amphorae/backends/utils/haproxy_query.py (+3, -1)
octavia/tests/functional/db/test_repositories.py (+2, -1)
octavia/controller/worker/v1/controller_worker.py (+2, -1)
octavia/controller/worker/v1/flows/amphora_flows.py (+2, -3)
octavia/controller/worker/v2/flows/health_monitor_flows.py (+3, -3)
octavia/common/jinja/haproxy/split_listeners/templates/haproxy.cfg.j2 (+0, -0)
octavia/controller/worker/v2/flows/l7policy_flows.py (+3, -3)
octavia/common/jinja/haproxy/combined_listeners/templates/base.j2 (+52, -0)
octavia/tests/unit/controller/worker/v1/flows/test_load_balancer_flows.py (+2, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+233, -214)
octavia/amphorae/drivers/noop_driver/driver.py (+31, -39)
octavia/controller/worker/v2/flows/listener_flows.py (+4, -4)
octavia/amphorae/backends/agent/api_server/keepalived.py (+2, -2)
octavia/tests/unit/amphorae/backends/agent/api_server/test_listener.py (+0, -337)
octavia/controller/worker/v2/flows/pool_flows.py (+3, -3)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+2, -1)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+2, -1)
octavia/amphorae/backends/agent/api_server/server.py (+35, -39)
octavia/cmd/octavia_worker.py (+3, -0)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+151, -147)
octavia/tests/unit/certificates/manager/test_barbican.py (+2, -1)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+426, -148)
octavia/common/jinja/haproxy/combined_listeners/templates/haproxy.cfg.j2 (+40, -0)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+123, -177)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+91, -65)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+38, -73)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+499, -0)
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+88, -159)
octavia/amphorae/backends/agent/api_server/amphora_info.py (+6, -6)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+13, -46)
octavia/db/repositories.py (+3, -1)
octavia/controller/worker/v1/flows/pool_flows.py (+3, -3)
releasenotes/notes/haproxy-single-process-b17a3af3a97accea.yaml (+11, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_keepalivedlvs.py (+0, -8)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+11, -39)
octavia/common/jinja/haproxy/split_listeners/__init__.py (+0, -0)
octavia/amphorae/backends/agent/api_server/util.py (+86, -20)
octavia/controller/worker/v1/flows/member_flows.py (+4, -4)
octavia/controller/worker/v1/flows/l7policy_flows.py (+3, -3)
octavia/controller/worker/v2/flows/member_flows.py (+4, -4)
doc/source/contributor/api/haproxy-amphora-api.rst (+67, -283)
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+13, -46)
octavia/tests/unit/common/jinja/haproxy/split_listeners/__init__.py (+0, -0)
octavia/controller/worker/v1/flows/listener_flows.py (+4, -4)
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+2, -1)
octavia/amphorae/backends/agent/api_server/udp_listener_base.py (+0, -11)
octavia/common/jinja/haproxy/combined_listeners/__init__.py (+0, -0)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+0, -0)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+330, -317)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+100, -4)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+2, -42)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/__init__.py (+0, -0)
octavia/amphorae/backends/agent/api_server/__init__.py (+1, -1)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+413, -378)
",-0.791967,-0.24319,-0.064568,0.318628,-0.423823,0.30915,0.405545,0.338235,0.323784,-0.115771,0.583002,0.371844,0.302194,0.046866,-0.285607
openstack/octavia,Id94a293a88d27546c0fe7b45367922fa4cca260a,0,0,0.0,5.8693,0.5014,13,11.0,114,0,Feature,0,0,0,3,0.001285,0.5,0,0.0,7,1,0,0.3871,3.0077,5.38,26.47,15.31,1,0,0.4051,0,0.322,0,0,0,0,0,"Transition l7rule flows to dicts

Story: 2005072
Task: 30813
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+10, -7)
octavia/controller/worker/v2/tasks/database_tasks.py (+40, -28)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+40, -42)
octavia/tests/unit/controller/queue/v2/test_endpoints.py (+6, -6)
octavia/controller/worker/v2/flows/l7rule_flows.py (+6, -3)
octavia/common/constants.py (+1, -0)
octavia/controller/worker/v2/controller_worker.py (+30, -58)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+6, -5)
octavia/tests/unit/controller/worker/v2/flows/test_l7rule_flows.py (+7, -3)
octavia/controller/worker/v2/tasks/lifecycle_tasks.py (+7, -5)
octavia/api/drivers/amphora_driver/v2/driver.py (+6, -7)
octavia/controller/queue/v2/endpoints.py (+10, -9)
octavia/tests/unit/controller/worker/v2/tasks/test_lifecycle_tasks.py (+7, -4)
",1.907081,0.368581,-0.332524,-0.926767,0.219004,1.010168,-0.79363,0.006695,0.409219,-0.108823,0.252912,0.08296,0.148388,0.689942,-0.040713
openstack/octavia,If85b59bddb8d6dc9916c3fef5155e838f1af63b6,0,0,1.0,4.7707,0.0342,7,11.67,295,0,Feature,0,0,0,2,0.007692,1.0,0,1.0,5,2,0,0.375,2.327,3.14,23.38,18.38,1,0,0.188,1,2.5,0,0,0,0,0,"Allow listeners for different protocols on the same port

Added 'protocol' name in the unique constraint list for listeners,
updated conflicting/duplicate entries detection in API.
Added alembic migration script.

Story: 2005070
Task: 29643
[SEP]
FILES CHANGED:
octavia/db/migration/alembic_migrations/versions/a5762a99609a_add_protocol_in_listener_keys.py (+35, -0)
octavia/common/constants.py (+10, -0)
octavia/db/models.py (+3, -2)
releasenotes/notes/same-port-listeners-41198368d470e821.yaml (+5, -0)
octavia/tests/functional/api/v2/test_listener.py (+22, -0)
octavia/api/v2/controllers/listener.py (+36, -1)
octavia/common/exceptions.py (+2, -1)
",0.306561,-1.676838,-0.395525,-0.062387,-0.023558,0.193777,-0.368071,0.160571,0.416102,-0.201427,-0.33834,-0.091123,-0.011699,0.400781,-0.25895
openstack/octavia,I9e0debcbfe6ceeff0012c827d70d80d938b5a2fb,1,0,0.28,3.7136,0.425,5,9.5,443,0,Bug Fix,0,0,0,25,0.00264,1.0,0,0.28,6,3,0,0.3636,1.8277,4.0,44.32,12.92,0,0,0.0,1,10.8049,0,0,0,0,0,"Fix cryptsetup --pbkdf-memory failures

A recent patch[1] added --pbkdf-memory to the cryptsetup command line
to limit the memory cryptsetup is using. However, some distros use
an older version of cryptsetup that does not need this setting.
This patch adds logic to detect this and run the commands without
--pbkdf-memory.

[1] https://review.opendev.org/663784

Story: 2006066
Task: 34782
[SEP]
FILES CHANGED:
elements/certs-ramfs/element-deps (+1, -0)
elements/certs-ramfs/static/usr/local/bin/certfs-ramfs (+19, -0)
elements/certs-ramfs/init-scripts/sysv/certs-ramfs (+1, -8)
elements/certs-ramfs/init-scripts/upstart/certs-ramfs.conf (+1, -8)
elements/certs-ramfs/init-scripts/systemd/certs-ramfs.service (+1, -1)
",-1.126596,1.079138,-0.185218,0.70611,-0.271759,0.271897,0.536658,-0.170839,0.06007,0.18377,0.610258,-0.054856,0.221791,0.072697,0.227217
openstack/octavia-dashboard,I9b0591734b8fa8125096748ff5dd739588b12172,0,0,0.3077,1.9459,0.5,1,4.71,335,0,Feature,0,0,0,26,0.002734,0.25,0,0.0769,0,1,0,0,0.0,0.0,20.03,12.79,1,0,0.0,1,47.8571,0,0,0,0,0,"Update tox.ini for new upper constraints strategy

The requirements team has defined a new strategy for handling
upper constraints[1]. This patch applies those strategies to
Octavia dashboard.

[1] http://lists.openstack.org/pipermail/openstack-discuss/ \
    2019-May/006478.html
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-0.651283,0.80449,-0.991715,0.487856,-0.907826,-0.234774,0.092926,0.483889,0.450488,0.473746,-0.247501,-0.235018,0.141675,0.186211,-0.25285
openstack/octavia,If6fb3fde9b43ac82af46eaddc48ec7a3a5b95602,1,0,0.6667,5.7366,0.0065,5,23.33,463,0,Feature,0,0,0,3,0.007958,0.0,0,0.0,7,2,0,0.3824,1.7811,5.2,39.33,17.33,1,0,0.8091,1,1.4935,0,0,0,0,0,"Prevent UDP LBs to use different IP protocol versions in amphora driver

The amphora doesn't support mixing IPv4 and IPv6 addresses for its
members and its VIP when using UDP load balancers.
This commit adds a validation step in the member_create and th e
member_batch_update functions of the amphora driver to ensure that IP
protocol versions are the same in a UDP load balancer.

Story: 2005876
Task: 33689
[SEP]
FILES CHANGED:
releasenotes/notes/validate-same-ip-protocol-in-udp-lb-2813b545131097ec.yaml (+7, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_amphora_driver.py (+124, -1)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+124, -1)
octavia/api/drivers/amphora_driver/v2/driver.py (+26, -0)
octavia/api/drivers/amphora_driver/v1/driver.py (+26, -0)
",-0.4118,-0.832821,0.058706,0.755157,0.313534,0.082791,0.56953,0.534606,0.59308,-0.282508,0.177292,0.128787,0.164077,-0.350778,0.068683
openstack/octavia,I477d2d12c64c1e38e3917333e5d47f612cab93b0,1,0,0,1.0986,0.5,1,12.0,124,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.4,0.0,1.0,11.36,18.13,1,0,0.0,1,41.3333,0,0,0,0,0,"Fix user permission for WSGI configuration
Task: 35692
Story: 2006172
[SEP]
FILES CHANGED:
httpd/octavia-api.conf (+1, -1)
",2.391123,-0.759317,0.077706,-1.123761,-0.621817,0.534274,-0.669459,0.73189,0.522847,-0.151849,0.352751,-0.144298,0.261571,0.60031,-0.280992
openstack/octavia,I7793d7a9113b23ac88e7c53d5dc292a70b9453b5,1,0,0.2963,2.3979,0.1,2,14.33,575,0,Feature,0,0,0,27,0.002838,0.0,0,0.0,4,1,0,0.4167,0.971,3.0,49.65,12.24,0,0,0.0,0,52.2727,0,0,0,0,0,"Add warning log if auth_strategy is not keystone

A user came to the IRC channel with CLI errors:
""Client-side error: Validation failure: Missing project ID in
request where one is required.""

The root cause was the [api_settings] auth_strategy was set to
""noauth"" instead of ""keystone"".

This patch adds a warning log message to the API process that
warns users that typically the auth_strategy should be set to
keystone.
It also points the user to have an administrator check the keystone
settings in the octavia.conf.
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/load_balancer.py (+3, -1)
octavia/cmd/api.py (+6, -0)
",-1.466183,-0.972788,0.343609,0.468536,-0.034177,0.002987,0.029053,0.097206,0.552678,-0.032594,0.536216,0.015745,-0.271758,0.220054,-0.061528
openstack/octavia,I334364d4654491bc0d289472ca9ab5fe462d5139,1,1,0.0,3.5835,0.0571,3,7.11,628,0,Bug Fix,0,0,0,1,0.021277,0.0,0,0.0,4,2,0,0.4324,1.2704,3.0,13.23,14.09,1,0,0.6571,1,17.4444,1,6,0,33,0,"Validate server_certs_key_passphrase is 32 chars

Fernet checks[1] for 32 characters long key, so Octavia should validate
the value provided for server_certs_key_passphrase, to reject an invalid
passphrase as early as possible.

This[2] Red Hat Bug showed a case in which an invalid passphrase got
configured, and as a result, Octavia was unable to create any
load balancers.

Related-bug: #1833942

[1] https://github.com/pyca/cryptography/blob/784676de3381f039f95f998505d45fb9d56bd300/src/cryptography/fernet.py#L36
[2] https://bugzilla.redhat.com/show_bug.cgi?id=1723051
[SEP]
FILES CHANGED:
octavia/tests/unit/common/test_config.py (+23, -0)
releasenotes/notes/input-validation-server_certs_key_passphrase-6a9dfc190c9deba8.yaml (+6, -0)
octavia/certificates/common/local.py (+4, -2)
",-3.317004,1.765607,0.707438,-0.570505,0.037958,0.357696,0.005147,-0.232879,0.269126,-0.020404,0.169133,-0.225537,-0.298388,-0.200069,-0.042071
openstack/octavia,I9f1b6e58004d7c2024f8d60d50ac998240abb6ee,1,0,0,0.6931,0.0,1,9.5,194,0,Feature,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.4474,0.0,2.0,32.45,16.43,1,0,0.0,1,97.0,0,0,0,0,0,"elements: add arch property for ``open-vm-tools``

The ``open-vm-tools`` package only exists for x86-platforms.

Task: 35814
Story: 2006219
[SEP]
FILES CHANGED:
elements/amphora-agent/package-installs.yaml (+1, -0)
",-0.220197,0.689994,-1.029096,0.201468,-0.030038,-0.347056,-1.169582,0.25384,-0.08046,-0.119555,-0.155175,0.428438,0.109807,0.425445,-0.046417
openstack/octavia-dashboard,I3c25a1a69ef2e5ce0a994744a6a3a4fb5a3c3312,0,0,0.75,3.8501,0.2391,7,27.0,222,0,Feature,0,0,0,4,0.005831,0.0,0,0.0,7,3,0,0.0,2.6115,6.0,-5.44,22.65,0,0,0.0,1,4.7234,0,0,0,0,0,"Added UDP support for listener and health-monitor

- Added UDP protocol for listener and pool
- Added UDP-CONNECT method for health-monitor

Story: 1657091
Task: 23225
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.html (+2, -2)
releasenotes/notes/add-udp-support-acb1a22fb605d3a8.yaml (+5, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.html (+5, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.controller.spec.js (+13, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+6, -4)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+3, -3)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.help.html (+1, -1)
",0.639243,-0.031962,-0.478684,0.071164,0.150518,0.148259,-1.380726,0.367101,0.228084,-0.275544,-0.518318,0.41557,0.940443,0.59266,0.223714
openstack/python-octaviaclient,If5c61fd9b215c5f60d527ab1667e576807bac1ed,0,0,0,2.0794,0.1429,2,5.0,229,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.0,0.9852,2.5,7.18,18.0,1,0,0.0,1,28.625,0,0,0,0,0,"Add support for SOURCE_IP_PORT algorithm

This patch adds support for SOURCE_IP_PORT algorithm.

Story: 2006264
Task: 35969

Depends-On: https://review.opendev.org/#/c/672463/
[SEP]
FILES CHANGED:
releasenotes/notes/add-lb-algorithm-source-ip-port-3e2d4b60f6916259.yaml (+4, -0)
octaviaclient/osc/v2/pool.py (+2, -1)
",-0.385756,1.240486,-0.96764,-0.161294,-0.762916,0.621226,-0.893076,0.097047,0.47075,-0.108257,-0.151067,-0.332709,0.310226,0.28002,0.013108
openstack/octavia,I436a6e553065d1755d465d20ad36f7ba2cbb8eba,0,0,0.0,4.7362,0.0708,8,6.4,327,0,Feature,0,0,0,1,0.125,0.0,0,0.0,5,5,0,0.4615,1.9974,3.25,17.92,15.06,1,0,0.0265,1,2.8684,0,0,0,0,0,"Add new algorithm SOURCE_IP_PORT

LB_ALGORITHM_SOURCE_IP_PORT is an algorithm used by OVN
Load Balancer [0]. This patch adds its support to the API.

[0] https://review.opendev.org/#/c/660369
Depends-On: I605f44f0f50219aa003df477de9bae4062f3c308

Task: 35952
Story: 2006264
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+1, -1)
doc/source/user/feature-classification/feature-matrix-pool.ini (+8, -1)
releasenotes/notes/add-lb-algorithm-source-ip-port-ff86433143e43136.yaml (+16, -0)
api-ref/source/v2/pool.inc (+5, -2)
doc/source/contributor/guides/providers.rst (+2, -2)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/api/root_controller.py (+4, -1)
octavia/db/migration/alembic_migrations/versions/dcf88e59aae4_add_lb_algorithm_source_ip_port.py (+67, -0)
",-1.058344,0.869456,-1.104751,-0.57498,0.13601,0.344401,0.017744,0.66706,0.713991,0.259445,0.191675,-0.305417,-0.038339,0.098076,-0.262946
openstack/octavia-lib,Ie04d6358b9651dfc98ad4533e68ba3aed5398eb2,0,0,0,3.5553,0.8824,3,7.5,255,0,Doc,0,0,1,0,0.0,0.0,0,0.0,2,2,0,0.0,1.1295,1.67,10.28,16.33,1,0,0.0,0,7.2857,0,0,0,0,0,"Bump the openstackdocstheme extension to 1.20

Some options are now automatically configured by the version 1.20:
- project
- html_last_updated_fmt
- latex_engine
- latex_elements
- version
- release.
[SEP]
FILES CHANGED:
doc/source/conf.py (+3, -6)
doc/requirements.txt (+1, -1)
releasenotes/source/conf.py (+0, -23)
",0.017793,-0.622102,-0.817517,0.062614,0.141786,-0.454813,-0.59356,0.421034,0.293611,-0.039318,-0.675264,0.225765,-0.706249,0.593215,0.317104
openstack/octavia,I4380605bdb346eee824b2ce05fa25175c4cc3034,1,0,0.3214,3.2958,0.0,2,17.75,483,0,Bug Fix,0,0,0,28,0.00294,0.2857,0,0.0918,4,1,0,0.45,0.8905,3.0,39.88,15.55,1,0,0.6923,0,17.8889,1,0,0,0,0,"Fix L7 repository create methods

SQLAlchemy can get confused if the parent database objects are not
linked when creating new records using the repository.
For example, when creating an L7 policy, even if you specify the
listener_id, sqlalchemy will drop the ID from the final SQL INSERT
parameter.
This patch corrects the L7 policy and rule create methods to have
the required parent objects linked.

Story: 2006305
Task: 36021
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+18, -0)
octavia/db/repositories.py (+8, -0)
",-0.743601,-1.816726,0.000333,0.694384,-0.014133,-0.028035,0.067135,0.190558,0.528897,0.102148,0.121109,0.129379,0.047921,0.133189,-0.130225
openstack/octavia,Ia2570b929be1c9d89ca971fb37f036f104fb32f2,1,0,0.3448,5.4848,0.2792,5,17.5,512,0,Bug Fix,0,0,0,29,0.003036,0.0,0,0.0,5,2,0,0.4634,1.3389,4.0,31.96,18.43,1,0,0.7958,1,2.1245,1,0,0,0,0,"Fix provider driver utils

The provider driver utils module converts Octavia data model objects
to provider driver objects.
This module had some bugs in the conversion that led to errors and
incomplete data.
Specifically the following conversions were fixed:
flavor_id in load balancer conversion
sni_refs and L7 policies in listener conversion
health monitors in pool conversion

This patch corrects those and updates the tests.

Story: 2006306
Task: 36022
[SEP]
FILES CHANGED:
releasenotes/notes/fix-provider-driver-utils-b75485785dcd6462.yaml (+6, -0)
octavia/tests/functional/api/v2/test_member.py (+1, -1)
octavia/tests/unit/api/drivers/sample_data_models.py (+112, -53)
octavia/tests/unit/api/drivers/test_utils.py (+18, -6)
octavia/api/drivers/utils.py (+36, -7)
",-0.954642,-2.037928,0.048266,0.083056,0.05904,-0.22994,-0.067688,0.551005,0.346207,0.018657,-0.157997,-0.175246,0.344132,0.007003,-0.197863
openstack/octavia,I5bc21d5abdeb67a3a8ae88456735643463f15694,1,0,0.3667,5.273,0.5,3,15.0,413,0,Feature,0,0,0,30,0.003064,0.6667,0,0.2444,7,1,0,0.4762,1.3826,6.33,36.51,16.0,1,0,0.866,0,2.1179,0,0,0,0,0,"Lookup interfaces by MAC directly

Currently the amphora agent will lookup interfaces using the
interface name determined earlier in the plug method. This can
lead to a race condition with the udev interface renaming rule.
This patch changes the interface lookup to use the MAC address
directly and not rely on the interface name.

Story: 2006300
Task: 36013
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/plug.py (+15, -11)
octavia/tests/unit/amphorae/backends/agent/api_server/test_plug.py (+44, -16)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+38, -70)
",-0.021552,-1.736326,-0.115971,0.668056,-0.356028,0.143379,0.252655,-0.200496,0.593703,-0.020022,-0.044864,0.132879,0.051714,0.045341,-0.127155
openstack/octavia,I6be0a593b1deb43f8aba982043ebf427be57d937,0,0,0,1.0986,0.5,1,4.5,289,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.4884,0.0,4.0,-10.8,12.17,1,0,0.0,1,96.3333,0,0,0,0,0,"Correcting typo in healthmonitors-list-response.json - http_vesion to http_version.

There is a typographical error in healthmonitors-list-response.json.
Correcting spelling from http_vesion to http_version.

Task: 36020
Story: 2006304
[SEP]
FILES CHANGED:
api-ref/source/v2/examples/healthmonitors-list-response.json (+1, -1)
",-0.947051,1.142624,-1.183482,0.771915,0.504175,-0.338304,-0.281298,-0.037524,0.179494,-0.21541,0.148982,0.027382,-0.012397,0.791164,0.264764
openstack/octavia,Ife93834654385430d6a333d3d6ee67b719b6c37e,0,0,0.3871,2.7081,0.3571,3,9.6,367,0,Bug Fix,0,0,1,31,0.003105,0.1667,0,0.0645,5,2,0,0.4773,1.5567,1.67,43.75,13.01,1,0,0.4286,0,24.4667,0,0,0,0,0,"Fix a unit test for new octavia-lib

A patch[1] introduced a startup check for the socket paths that
impacted a unit test checking debtcollector is finding the new
octavia-lib location of the DriverLibrary.
This patch correctly mocks out this check for this unit test.

[1] https://review.opendev.org/#/c/665027/
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/test_driver_lib.py (+5, -1)
requirements.txt (+2, -2)
lower-constraints.txt (+2, -2)
",0.055212,-0.078568,0.043945,0.349161,-1.038787,0.082128,0.849562,0.194904,0.450598,0.148342,0.166881,0.119552,0.023176,-0.13876,0.356166
openstack/octavia,I90c2fa386fab75742d07e89edd3fba8b56bb6aff,0,0,0.375,6.7639,0.4682,4,6.8,297,0,CI,0,0,0,32,0.0032,0.3333,0,0.125,6,1,0,0.4667,1.0551,4.0,35.71,10.96,1,0,0.874,0,0.343,0,0,0,0,0,"Move to using octavia-lib constants

Previously the samlple data models and driver agent tests used
strings for some of the tests. This patch corrects those to use
constants from octavia-lib.

Depends-On: https://review.opendev.org/#/c/673681/
[SEP]
FILES CHANGED:
octavia/common/constants.py (+63, -46)
octavia/tests/common/sample_data_models.py (+341, -317)
octavia/tests/functional/api/drivers/driver_agent/test_driver_agent.py (+53, -42)
octavia/tests/unit/api/drivers/test_utils.py (+3, -0)
",-0.544295,0.926746,-0.944214,0.497652,-0.798802,-0.154469,0.336175,-0.000183,-0.14231,-0.03969,-0.093802,-0.171449,0.205227,-0.134588,0.035024
openstack/octavia,Ib7042bcc48b1dd5b37b671dd5e64728b71ab9542,0,0,0.3636,6.0981,0.0968,13,13.0,296,0,Feature,0,0,1,33,0.003038,0.1667,0,0.0606,6,7,0,0.4565,2.6572,2.62,41.79,15.46,1,0,0.4505,1,0.6652,0,0,0,0,0,"Add long-running provider agent support

This patch adds support for long-running provider driver agents to
the Octavia driver-agent.
It will fork a process for all of the enabled provider driver
agents at startup.

Story: 2006250
Task: 35863
[SEP]
FILES CHANGED:
octavia/api/drivers/noop_driver/agent.py (+26, -0)
octavia/common/config.py (+7, -0)
.pylintrc (+1, -0)
doc/source/contributor/guides/providers.rst (+90, -0)
octavia/tests/unit/cmd/test_driver_agent.py (+143, -7)
etc/octavia.conf (+6, -0)
octavia/api/drivers/driver_agent/driver_listener.py (+0, -14)
octavia/tests/unit/api/drivers/test_provider_noop_agent.py (+33, -0)
requirements.txt (+1, -0)
releasenotes/notes/Add-provider-agent-support-a735806c4da4c470.yaml (+6, -0)
octavia/cmd/driver_agent.py (+83, -8)
octavia/tests/unit/api/drivers/driver_agent/test_driver_listener.py (+3, -14)
setup.cfg (+2, -0)
",-0.001359,-1.259396,-0.548408,0.571486,-0.314538,0.1451,-0.306542,0.349788,0.315356,-0.032423,-0.101535,0.636327,0.25578,0.38512,0.01585
openstack/octavia,I426255f587f36b415eb999a9eb28cf0f91de94b0,1,0,0.6,4.4543,0.0118,2,15.25,452,0,Bug Fix,0,0,0,5,0.006831,0.5,0,0.3,6,1,0,0.4468,0.3228,5.0,20.77,21.84,0,0,0.9412,0,5.2558,0,0,0,0,0,"Fix listener deletion in ACTIVE/STANDBY topology

When removing listeners, listeners are removed from the load balancer's
listener list just before reconfiguring each amphora.
In case of ACTIVE/STANDBY topology, the code is performed on both
amphorae, so the listener is removed twice from the list.
This commit ensures that we don't remove an already removed listener.

Story: 2006329
Task: 36065
[SEP]
FILES CHANGED:
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+4, -1)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+80, -0)
",-0.334679,-0.695618,0.087778,0.81441,-0.207771,0.436462,0.660902,-0.125107,0.196624,-0.18696,0.398565,0.193038,0.142927,0.161991,-0.166324
openstack/octavia,I842c02a8ff18b640951dca2e1d766ee08e0e16fc,1,0,0.6667,4.5109,0.0,2,20.5,311,0,Bug Fix,1,0,0,6,0.007344,1.0,0,0.6667,6,1,0,0.4583,1.0,6.0,35.4,16.98,0,0,1.0,0,3.4176,0,0,0,0,0,"Add unit test for failover of spare amphorae

Add unit test that ensures that the failover of a spare amphora doesn't
trigger any error. This is a follow-up to the fix provided in commit
I9c9002486a9a547a215514c24ccb95f039b23ec2

Story: 2005470
Task: 36092
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+45, -0)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+45, -0)
",-1.042447,-0.820742,-1.396741,-0.983088,0.746177,0.386966,0.500119,-0.486353,0.529376,0.382112,0.089639,0.246795,0.361603,0.177714,0.303552
openstack/python-octaviaclient,If2565df22c2677bbad09f3eafacc148c740c0124,1,0,0,3.6109,0.1944,1,11.75,381,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0.0,0.0,3.0,25.71,14.91,1,0,0.0,0,10.2973,0,0,0,0,0,"Wrap several show api calls with correct_return_codes

Loadbalancer show API call can also raise 'incorrect' exception, so it
would be nice to wrap it with a helper decorator.

Also, this patch extends correct_return_codes decorator to cover
wrong usage of NotFound exception at osc-lib
(see https://review.opendev.org/675328)
[SEP]
FILES CHANGED:
octaviaclient/api/v2/octavia.py (+29, -7)
",-1.394189,-0.142605,-0.476049,0.504892,-0.193186,0.20644,0.015791,-0.865383,0.056034,0.016989,0.250565,-0.509807,0.059198,-0.269821,0.047337
openstack/octavia,Iae839b6e59c43bc4be1e12702b3e2197b038b4c2,1,0,0.3529,2.7726,0.0,1,7.5,243,0,Feature,0,0,0,34,0.003007,0.3333,0,0.1176,1,1,0,0.4694,0.0,1.0,38.48,11.0,0,0,0.0,0,15.1875,0,0,0,0,0,"Use the infra pypi mirror for DIB

This patch changes the devstack plugin to use the infra pypi
mirror if one is declared in the environment.

Depends-On: https://review.opendev.org/675468
[SEP]
FILES CHANGED:
devstack/plugin.sh (+15, -0)
",-0.173681,0.877959,-1.018225,0.864645,-0.539146,0.018404,0.178687,0.113617,0.100455,-0.289198,0.129071,0.22019,-0.095962,-0.16533,0.069037
openstack/octavia-lib,I4ddcb51fcfb976e825cd204d5f4f561d60ee0455,0,0,0.3714,4.382,0.3291,15,5.75,200,0,Doc,0,0,1,35,0.003091,0.2,0,0.0743,3,4,0,0.0,3.4995,2.2,20.76,19.69,0,0,0.0,1,2.5,0,0,0,0,0,"Clean up octavia-lib docs and remove oslo.log

This patch cleans up the octavia-lib documentation and removes an
unused requirement for oslo.log.
[SEP]
FILES CHANGED:
doc/source/admin/index.rst (+6, -1)
doc/source/reference/index.rst (+15, -1)
doc/source/user/index.rst (+3, -1)
doc/source/library/index.rst (+7, -2)
doc/source/conf.py (+3, -1)
lower-constraints.txt (+0, -1)
doc/source/configuration/index.rst (+1, -1)
doc/source/contributor/contributing.rst (+0, -4)
doc/source/index.rst (+6, -4)
requirements.txt (+0, -1)
doc/source/contributor/index.rst (+7, -2)
doc/source/cli/index.rst (+1, -1)
doc/source/readme.rst (+0, -1)
tox.ini (+4, -1)
octavia_lib/api/drivers/data_models.py (+0, -4)
",-0.068708,0.531024,-0.750385,1.056635,0.513268,-0.152801,-0.008955,-0.217055,-0.552314,-0.367349,0.291684,0.363781,-0.04665,-0.134041,0.320691
openstack/octavia,I932ad625595333e97b0ead074ce64a7341af338d,1,0,0.3611,1.3863,0.0,1,4.36,517,0,Bug Fix,0,0,0,36,0.003157,0.0,0,0.0,2,1,0,0.48,0.0,2.0,19.11,9.25,0,0,0.0,0,129.25,1,0,0,0,0,"Work around strptime threading issue

There is an open bug[1] in python strptime when used in multi-threaded
applications. We have seen this occur in the Octavia test jobs[2].
This patch works around the bug by loading strptime early.

[1] https://bugs.python.org/issue7980
[2] https://logs.opendev.org/37/673337/12/check/ \
    octavia-v2-act-stdby-iptables-dsvm-py2-scenario/440c965/controller/logs \
    /screen-o-cw.txt.gz?level=ERROR#_Aug_09_23_54_29_426364
[SEP]
FILES CHANGED:
octavia/common/base_taskflow.py (+3, -0)
",-2.843447,1.857324,0.399823,-0.754074,-0.558402,-0.164865,0.238103,0.130953,0.225089,-0.027731,0.258417,-0.22736,-0.154191,-0.098003,0.220247
openstack/kolla,I472af9ec8cee3462beb5aca04ea6171b79933abe,1,0,0,3.0445,0.0,2,6.5,153,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,2,0,1.0,0.8113,2.5,-53.56,21.06,1,0,0.0,1,7.2857,0,0,0,0,0,"Install Monasca plugin for Grafana by default

Co-Authored-By: Bartosz Bezak <bartosz@stackhpc.com>
[SEP]
FILES CHANGED:
releasenotes/notes/add-monasca-grafana-app-ea24f8ca43fa9c7d.yaml (+5, -0)
docker/monasca/monasca-grafana/Dockerfile.j2 (+15, -0)
",0.625196,2.827945,-1.316915,-0.026776,-0.732848,0.756738,0.37788,0.109407,-0.237165,-0.850093,0.953756,0.895257,-0.365803,-0.08587,-0.722859
openstack/octavia,I108b7f629d39c40b60ddf4a1878631f32e37b357,0,0,0.0,3.5264,0.1515,5,13.5,423,0,Feature,0,0,0,1,0.001745,0.1667,0,0.0,4,3,0,0.4902,2.2191,2.2,19.23,18.73,0,0,0.1515,1,12.4412,0,0,0,0,0,"Switch TaskFlow engine to parallel

The default TaskFlow engine is now set to 'parallel' instead of
'serial'. The parallel engine schedules tasks onto different threads to
allow for running non-dependent tasks simultaneously. This has the
benefit of accelerating the execution of some Octavia Amphora flows such
as provisioning of active-standby amphora loadbalancers.
[SEP]
FILES CHANGED:
octavia/common/config.py (+6, -2)
octavia/common/constants.py (+3, -0)
octavia/tests/unit/common/test_base_taskflow.py (+3, -2)
releasenotes/notes/switch-taskflow-engine-parallel-8bf743eca15a0253.yaml (+10, -0)
etc/octavia.conf (+6, -1)
",-1.440152,-0.653227,-0.516906,1.507922,0.61978,0.161063,-0.1913,0.130253,0.21084,-0.07221,-0.137212,0.716348,0.182491,-0.398941,-0.004581
openstack/octavia,Icddd2873abeb56a389a35356995df6dde70872b2,1,0,0,1.0986,0.5,1,16.67,443,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.4808,0.0,6.0,24.1,13.87,1,0,0.0,0,147.6667,0,0,0,0,0,"Fix template that generates vrrp check script

Correct the inline comment to not include an empty new line at the start
of generated /var/lib/octavia/vrrp/check_script.sh that leads to this
kind of error:

>  Aug 26 11:49:32 amphora-12184e15-1ec3-4d80-98a7-c7d1ddb6716f
> Keepalived_vrrp[15265]: Error exec-ing command
> '/var/lib/octavia/vrrp/check_script.sh', error 8: Exec format error
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/keepalived_check_script.conf.j2 (+1, -1)
",-2.104414,0.954442,-0.34224,-0.640866,0.377625,-0.387014,0.306668,0.139255,0.208569,0.326118,0.19148,-0.547946,0.146656,0.48284,0.058739
openstack/octavia,I3ec135766c9a1ddb7ac6655c0ee1ccb1e78ead5c,0,0,0.3784,6.4568,0.2626,12,11.8,440,1,CI,0,0,0,37,0.003244,0.5,0,0.1892,4,4,0,0.4906,2.6524,2.42,27.09,17.6,0,0,0.0,0,0.6907,0,0,0,0,0,"Use dual intermediate CAs for devstack

This patch updates the devstack plugin to use a dual Certificate
Authority (CA) with intermediate CAs for the Octavia controller
deployment.
This is a more realistic deployment model for testing.
Note: This change uses weak security to save gate resources. Please
refer to the Octavia Certificate Configuration Guide for production
instructions.
[SEP]
FILES CHANGED:
devstack/pregenerated/certs/server_ca.cert.pem (+0, -0)
devstack/pregenerated/certs/private/cakey.pem (+0, -30)
bin/create_dual_intermediate_CA.sh (+161, -0)
devstack/pregenerated/certs/private/client.cert-and-key.pem (+0, -0)
bin/create_single_CA_intermediate_CA.sh (+116, -0)
devstack/plugin.sh (+18, -6)
bin/create_certificates.sh (+0, -103)
devstack/pregenerated/certs/client.key (+0, -28)
devstack/pregenerated/certs/private/server_ca.key.pem (+30, -0)
bin/openssl.cnf (+144, -0)
devstack/pregenerated/certs/server_ca-chain.cert.pem (+0, -0)
devstack/pregenerated/certs/client_ca.cert.pem (+0, -0)
",-0.475497,-1.257814,-0.399971,0.91804,-0.168403,-0.010388,0.224523,0.835141,0.470824,0.147787,-0.122565,0.486982,0.237196,-0.432909,-0.21918
openstack/octavia,I9299084402a0b09104e81f48e998b77a195745a0,0,0,0.3684,2.1972,0.625,1,10.67,246,0,Bug Fix,0,0,0,38,0.003156,0.0,1,0.0,4,1,0,0.4815,0.0,4.0,53.25,11.77,0,0,0.0,0,27.3333,0,0,0,0,0,"Update the load balancing cookbook

The ""basic load balancing cookbook"" still had a reference to
neutron-lbaas and an old DVR bug.
This patch corrects those issues.

Story: 2006470
Task: 36401
[SEP]
FILES CHANGED:
doc/source/user/guides/basic-cookbook.rst (+3, -5)
",0.057966,-0.885361,-0.98857,-0.176774,-0.261261,0.469583,-0.555606,-0.099304,0.065041,-0.188253,0.136984,0.318041,-0.13452,0.121277,0.283824
openstack/octavia,Ieab13c1152fed64da7390891b315b5e67513ce3e,1,0,0.359,4.0943,0.0,3,22.0,404,0,Bug Fix,0,0,0,39,0.003237,0.0,0,0.0,6,2,0,0.4727,1.2412,4.0,67.86,12.44,0,0,0.6271,1,6.7333,0,0,0,0,0,"Fix base (VRRP) port abandoned on revert

If the base (VRRP) port fails to attach to the amphora instance, the
port would not be deleted as part of the revert cleanup.
This patch splits the two plug VIP phases and attempts to clean up the
base (VRRP) port, that was created in the first phase, should the port
attach fail.

Story: 2006468
Task: 36399
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+37, -0)
releasenotes/notes/Fix-plug-vip-revert-abandoned-vrrp-port-efff14edce62ad75.yaml (+5, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+17, -0)
",-0.141816,-0.630575,-0.359604,0.685134,-0.202843,0.689256,0.826408,-0.182116,0.280027,-0.266433,0.804841,0.42456,0.097408,0.479794,-0.239796
openstack/octavia,I826c5f753f159b2d5dee97d4e2922826444ea6da,1,0,0.375,2.8332,0.25,2,9.7,646,0,Bug Fix,0,0,0,40,0.003304,0.0,0,0.0,1,2,0,0.4821,0.896,1.0,53.95,11.72,0,0,0.0,1,38.0,0,0,0,0,0,"Fix the diskimage-create tox ""build"" environment

The recently added tox ""build"" environment had a few problems:
1. It was not honoring the DIB_* environment variables which meant
in always built a master branch image.
2. It also failed to run repeatedly due to a cache directory path issue.
3. The built images were stored in a hidden folder "".amp_tox_test"".

This patch fixes those issues, resolves a confusing
""dpkg Broken pipe"" message, and adds a ""Successfully built"" message
at the end of the built that highlights which branch the image was
built against (master, stable/stein, etc.).
[SEP]
FILES CHANGED:
diskimage-create/diskimage-create.sh (+10, -1)
diskimage-create/tox.ini (+2, -3)
",-0.913289,-1.256945,0.758607,-0.151382,-0.279883,0.088784,0.265409,0.124919,-0.033196,0.220398,0.335572,-0.045239,0.113748,0.337089,0.025564
openstack/octavia,Ifab50d30dbaf197dd2ba3b5e11b94732eb2e0aaf,0,0,0.0,5.743,0.418,14,13.0,133,0,Feature,0,0,0,4,0.001489,1.0,0,0.0,7,1,0,0.4912,2.8711,5.5,-1.59,17.51,1,0,0.3183,0,0.4263,0,0,0,0,0,"Convert health_monitor flows to use provider models

Story: 2005072
Task: 30811
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+22, -8)
octavia/controller/worker/v2/tasks/database_tasks.py (+69, -45)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+21, -12)
octavia/tests/unit/controller/queue/v2/test_endpoints.py (+6, -6)
octavia/common/constants.py (+2, -0)
octavia/controller/worker/v2/flows/health_monitor_flows.py (+1, -1)
octavia/controller/worker/v2/controller_worker.py (+26, -32)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+4, -4)
octavia/controller/worker/v2/tasks/lifecycle_tasks.py (+4, -2)
octavia/api/drivers/amphora_driver/v2/driver.py (+4, -5)
octavia/tests/unit/controller/worker/v2/flows/test_health_monitor_flows.py (+2, -1)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks_quota.py (+2, -1)
octavia/controller/queue/v2/endpoints.py (+12, -9)
octavia/tests/unit/controller/worker/v2/tasks/test_lifecycle_tasks.py (+6, -4)
",2.192113,0.095826,-0.203349,-0.592728,-0.073193,0.833014,-0.587256,0.370308,0.502178,-0.261797,0.065836,0.006256,0.067758,0.456627,-0.133236
openstack/octavia-lib,I0518c2a4d16c08c2ede505d7bba88c02675557d6,0,0,0,0.6931,0.0,1,3.0,89,0,Feature,0,0,0,0,0.0,0.0,0,0.0,0,1,0,0.0,0.0,0.0,-35.91,27.87,1,0,0.0,0,44.5,0,0,0,0,0,"Update .gitreview for stable/train
[SEP]
FILES CHANGED:
.gitreview (+1, -0)
",3.485905,1.836064,1.397754,-0.135642,0.349769,0.147624,0.686521,0.142796,-0.015175,-0.18145,-0.52323,-0.714766,-0.151198,0.676893,0.270989
openstack/octavia-lib,Ie6bb1c24979fbbcf6e41b3789377c4a4f6689f4a,0,0,0.0,1.0986,0.5,1,11.8,480,0,CI,0,0,0,1,0.5,0.1667,0,0.0,0,1,0,0.0,0.0,0.0,25.66,14.89,1,0,0.0,1,160.0,0,0,0,0,0,"Update TOX/UPPER_CONSTRAINTS_FILE for stable/train

Update the URL to the upper-constraints file to point to the redirect
rule on releases.openstack.org so that anyone working on this branch
will switch to the correct upper-constraints list automatically when
the requirements repository branches.

Until the requirements repository has as stable/train branch, tests will
continue to use the upper-constraints list on master.
[SEP]
FILES CHANGED:
tox.ini (+1, -1)
",-0.885088,-0.150027,0.090869,1.338788,0.390317,-0.301644,0.404257,0.322082,0.286696,-0.105247,-0.037266,-0.058855,-0.032024,0.425069,0.060556
openstack/octavia-lib,I8663088d1b912cfdecfdde33585594862f76b9d1,0,0,0.0,2.0794,0.0,2,14.0,327,0,Doc,0,0,0,2,0.5,0.0,1,0.0,2,1,0,0.0,0.5917,2.0,33.5,14.17,1,0,0.0,0,40.875,0,0,0,0,0,"Update master for stable/train

Add file to the reno documentation build to show release notes for
stable/train.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/train.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/train.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",0.144826,-1.771476,-0.164575,0.194248,0.099437,-0.395146,-0.541392,0.328196,0.073486,0.088624,-0.733605,-0.087107,-0.006143,0.653859,-0.053373
openstack/octavia,I0ce2eabfd4dd41210312ea3b7f6274c9a6d50e44,1,0,0.7143,3.8067,0.25,3,15.75,475,0,Bug Fix,0,0,0,7,0.007718,0.375,0,0.2679,4,2,0,0.4828,0.7694,2.67,22.99,17.73,0,0,0.8409,1,10.5556,0,0,0,0,0,"Fix cleanup of expired load balancer entries

Fix a bad query filter, deleted load balancers have a DELETED
provisioning_status (instead of operating_status).

Add a functional test that checks that deleted and expired load
balancers are correctly selected by get_all_deleted_expiring function.

Fix a similar test for amphorae that was buggy and not enabled (because
of missing test_ prefix).

Story: 2006496
Task: 36458
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+27, -10)
releasenotes/notes/fix-loadbalancer-db-cleanup-61ee81a4fd597067.yaml (+5, -0)
octavia/db/repositories.py (+1, -1)
",-0.95283,-1.558755,-0.041212,0.038152,0.181391,-0.021783,-0.406647,0.047369,0.429731,-0.170485,0.047285,-0.274405,0.187458,0.110408,-0.139619
openstack/octavia,If0ff2a855ad5b9d9ef3742ad0596c97a6dbf81ed,0,0,0.3902,1.9459,0.5,3,7.14,404,0,Bug Fix,0,0,1,41,0.003382,0.125,1,0.0488,1,1,0,0.4915,1.585,0.33,28.69,12.46,0,0,0.0,0,57.7143,1,0,0,0,0,"Bump diskimage-builder minimum to 2.24.0

There was a bug[1] in diskimage-builder when using pypi mirrors
if the host doesn't have ""python"" available DIB will fail.
So, I am going to bump the requirements minimum in Octavia for
diskimage-builder to be the minimum version with this fix.

[1] https://bugs.launchpad.net/diskimage-builder/+bug/1577105
[SEP]
FILES CHANGED:
diskimage-create/requirements.txt (+1, -1)
requirements.txt (+1, -1)
lower-constraints.txt (+1, -1)
",-1.31376,0.468638,-0.279537,0.427935,-0.654589,-0.1933,0.26082,-0.173961,-0.282918,0.583326,0.275535,-0.080745,0.000849,0.149792,0.083415
openstack/octavia,I5f9ce36c878973f4ed96527af6f1024a362421d8,1,0,0.381,3.989,0.4151,18,5.8,232,0,Bug Fix,0,0,0,42,0.003462,1.0,0,0.381,7,2,0,0.4833,3.661,3.94,37.58,10.6,1,0,0.2453,1,4.2963,0,0,0,0,0,"Fix a few nits from the main volume-based patch

I had a few minor nits on the volume-based patch. This patch
corrects those.

Co-Authored-By: Adam Harwell <flux.adam@gmail.com>
[SEP]
FILES CHANGED:
octavia/cmd/health_manager.py (+1, -0)
octavia/common/config.py (+1, -1)
octavia/controller/worker/v2/tasks/database_tasks.py (+3, -3)
octavia/tests/unit/controller/worker/v1/tasks/test_compute_tasks.py (+1, -0)
octavia/tests/functional/api/v2/test_quotas.py (+1, -1)
octavia/cmd/octavia_worker.py (+1, -0)
octavia/compute/drivers/nova_driver.py (+6, -6)
tools/create_flow_docs.py (+1, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+1, -1)
octavia/controller/worker/v1/tasks/database_tasks.py (+3, -3)
octavia/tests/unit/controller/worker/v2/tasks/test_compute_tasks.py (+1, -0)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+1, -1)
octavia/tests/functional/api/v2/test_l7rule.py (+1, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+1, -1)
octavia/db/migration/alembic_migrations/env.py (+1, -0)
octavia/tests/common/constants.py (+1, -0)
octavia/tests/functional/api/v2/test_listener.py (+2, -2)
tox.ini (+4, -2)
",-0.263042,0.310456,-1.05413,0.34975,-0.461347,0.457281,-0.155078,-0.482485,-0.350171,0.082667,0.528866,0.351786,0.50998,0.384815,-0.26336
openstack/octavia,Iad3b55e5add4283256f7836c3d4a501aa57ffc2f,1,0,0.0,4.4886,0.4545,5,12.5,383,0,Bug Fix,0,0,0,5,0.001668,1.0,0,0.0,7,1,0,0.4918,2.2169,6.0,43.56,13.0,0,0,0.625,0,4.3034,0,0,0,0,0,"Fix building configs for multiple listeners

Currently jinja_combo.build_config method expect to use single
tls cert, though with multiple listeners there could be multiple
certs. Also in case of HTTP and TERMINATED_HTTPS listeners on the
same loadbalancer - creation of the second listener will fail.

Story: 2006513
Task: 36510
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+11, -11)
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+5, -4)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+11, -9)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+14, -12)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+7, -4)
",-1.151482,-1.151693,-0.365282,-0.964505,0.437635,-0.07903,0.412935,0.049921,0.253851,-0.130903,0.330182,-0.321134,0.132754,0.166877,-0.297526
openstack/octavia,I1a566353b7fb125184849b3a0f864d3ef6896d94,1,0,0.3953,3.9512,0.1569,3,19.0,344,0,Bug Fix,0,0,0,43,0.00353,0.25,0,0.0988,5,2,0,0.5,1.3155,3.33,13.9,18.13,1,0,0.4902,1,6.6154,0,0,0,0,0,"Fix catching driver exceptions

octavia_lib driver exceptions were not cought by call_provider
This patch add those exceptions, and also handles the native NotImplementedError
which does nto have all the expected fields.

(cherry picked from commit e2defa6dd238d82ce4ee457e21ca047888d27106)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-driver-errors-81d33948288bf8cf.yaml (+4, -0)
octavia/tests/unit/api/drivers/test_utils.py (+22, -3)
octavia/api/drivers/utils.py (+17, -5)
",-0.106815,-1.820194,-0.941335,-1.259556,0.169232,0.025297,0.758352,-0.177888,-0.067134,0.252723,0.089552,-0.454284,0.117055,-0.196682,0.015764
openstack/octavia-lib,I71a0820f2322be7f84ab6555b534368d76bb0359,0,0,0.4091,5.3471,0.1531,8,9.0,108,0,Doc,0,0,1,44,0.003597,0.25,0,0.1023,3,4,0,0.0,2.3523,1.5,0.3,21.38,1,0,0.0,1,0.5143,0,0,0,0,0,"Generate PDF documentation

Story: 2006101
Task: 35148
[SEP]
FILES CHANGED:
doc/source/index.rst (+35, -9)
doc/source/reference/index.rst (+15, -8)
doc/source/library/index.rst (+7, -5)
doc/source/conf.py (+73, -10)
lower-constraints.txt (+1, -0)
doc/requirements.txt (+3, -0)
octavia_lib/version.py (+32, -0)
tox.ini (+11, -0)
",1.125428,0.246347,-0.883355,-0.744917,-0.25059,1.370896,-1.130297,0.298923,0.502857,-0.078517,0.496956,0.435042,0.344983,1.17965,-0.396104
openstack/python-octaviaclient,I309806b47fe7ae388f4372716953713d8b3b8f5e,0,0,0.4,5.112,0.1576,7,9.0,108,0,Doc,0,0,1,45,0.003616,0.2222,0,0.0889,3,4,0,0.0833,1.8733,1.29,9.7,21.38,1,0,0.0,1,0.6506,0,0,0,0,0,"Generate PDF documentation

Story: 2006101
Task: 35150
[SEP]
FILES CHANGED:
doc/source/index.rst (+10, -6)
octaviaclient/version.py (+32, -0)
README.rst (+0, -2)
doc/source/conf.py (+78, -15)
doc/requirements.txt (+5, -0)
tox.ini (+13, -2)
octaviaclient/osc/v2/pool.py (+1, -1)
",1.21578,0.041491,-0.822536,-0.662677,-0.166028,1.18695,-1.143694,0.269396,0.394503,-0.034802,0.291714,0.415181,0.309085,1.272425,-0.586657
openstack/octavia,Iacee63120a0d60e312cc85c7fcb8e7351688af3d,1,0,0.3913,2.3026,0.3333,2,13.0,344,0,Bug Fix,0,0,0,46,0.003648,0.2222,0,0.087,2,1,0,0.5079,0.7642,2.0,56.98,11.35,0,0,0.0,0,34.4,0,0,0,0,0,"Set neutron client logging to INFO

The neutron client will post debug messages with the word ""Error""
which is misleading. In reality it is a simple 404 that an extension
is not enabled.
This patch raises the default logging level for the neutron client to
INFO to suppress these messages.
[SEP]
FILES CHANGED:
octavia/common/config.py (+6, -1)
octavia/common/service.py (+0, -2)
",-0.103984,-1.697202,-0.468693,1.094698,-0.144553,0.439317,0.023982,-0.323904,0.645454,0.514617,0.024414,0.488884,-0.013873,-0.079859,-0.025324
openstack/python-octaviaclient,Idf44807e5595d13a8744931e32332106a9f201cc,0,0,0.0,0.6931,0.0,1,3.0,89,0,Feature,0,0,0,3,0.272727,0.0,0,0.0,0,1,0,0.0769,0.0,0.0,-35.91,27.87,1,0,0.0,0,44.5,0,0,0,0,0,"Update .gitreview for stable/train
[SEP]
FILES CHANGED:
.gitreview (+1, -0)
",3.485902,1.836063,1.397754,-0.135642,0.34977,0.147624,0.68652,0.142796,-0.015175,-0.181449,-0.52323,-0.714766,-0.151198,0.676893,0.270989
openstack/python-octaviaclient,I743ee243dd43e50be9bd5779270dcb2892ce66fd,0,0,0.0,1.9459,0.5,1,11.8,480,0,CI,0,0,0,4,0.333333,0.2,0,0.0,0,1,0,0.0714,0.0,0.0,24.22,14.89,1,0,0.0,1,68.5714,0,0,0,0,0,"Update TOX/UPPER_CONSTRAINTS_FILE for stable/train

Update the URL to the upper-constraints file to point to the redirect
rule on releases.openstack.org so that anyone working on this branch
will switch to the correct upper-constraints list automatically when
the requirements repository branches.

Until the requirements repository has as stable/train branch, tests will
continue to use the upper-constraints list on master.
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-0.885088,-0.150027,0.090869,1.338788,0.390317,-0.301644,0.404257,0.322082,0.286696,-0.105247,-0.037266,-0.058855,-0.032024,0.425069,0.060556
openstack/python-octaviaclient,If7ea05ca56fb29371a550c346191d4b9f4daad8e,0,0,0.0,2.0794,0.0,2,14.0,327,0,Doc,0,0,0,5,0.277778,0.0,1,0.0,2,1,0,0.0667,0.5917,2.0,29.47,14.17,1,0,0.0,0,40.875,0,0,0,0,0,"Update master for stable/train

Add file to the reno documentation build to show release notes for
stable/train.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/train.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/train.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",0.144826,-1.771476,-0.164575,0.194248,0.099437,-0.395146,-0.541392,0.328196,0.073486,0.088624,-0.733605,-0.087107,-0.006143,0.653859,-0.053373
openstack/octavia-dashboard,Iae628e8fdebc3ac8075def9f9188f57b55c25427,0,0,0,2.0794,0.8571,1,12.33,249,0,CI,1,0,0,0,0.0,0.0,0,0.0,1,1,0,0.0,0.0,1.0,68.56,9.26,1,0,1.0,1,31.125,1,0,0,0,0,"Use lower-constraints template

Use a template so that we can change jobs in a central place if needed
instead of single jobs.

This does not change any testing, the same jobs are run as before.
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -6)
",1.026309,-2.276758,0.388771,0.497021,-0.407363,-0.108472,0.27186,-0.830086,-0.294166,0.218888,-0.725162,0.142409,0.087162,0.375541,-0.335291
openstack/octavia,I93e5eb5bc69fe4de4c450c09367b319769ef07db,1,0,0.75,3.434,0.5,2,21.0,503,0,Bug Fix,0,0,0,8,0.008412,1.0,0,0.75,6,1,0,0.5156,0.9183,5.0,16.32,19.19,0,0,0.6667,0,16.2258,0,0,0,0,0,"Fix healthmonitor message v2 for UDP listeners

Multi-listener LB commit (Idaccbcfa0126f1e26fbb3ad770c65c9266cfad5b)
introduced a v2 message for octavia healthmonitor.

This commit fixes an issue with healthmonitor messages for UDP
listeners, they didn't follow the v2 message specification: pools
dictionaries were stored in listener objects (v1 format) instead of
being stored as in the root dictionary of the message.

Story: 2005736
Task: 33394
[SEP]
FILES CHANGED:
octavia/amphorae/backends/health_daemon/health_daemon.py (+5, -5)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+10, -10)
",-1.109038,-1.364479,-0.249341,-0.761394,0.547383,-0.351691,0.043566,0.212067,0.450658,0.196595,-0.263013,0.142486,0.077826,0.123237,-0.060238
openstack/octavia,Ib1b0df3b7227d8a8dd68276e279cae1c4974ded2,1,0,0.4043,2.8332,0.4375,3,8.33,217,0,Bug Fix,0,0,0,47,0.003725,1.0,0,0.4043,5,1,0,0.5231,1.4056,4.0,15.64,12.93,0,0,0.375,0,12.7647,0,0,0,0,0,"Fix the amphora no-op driver

The amphora no-op driver had the wrong method signature for the
update_amphora_agent_config method.

This patch corrects that issue.
[SEP]
FILES CHANGED:
octavia/amphorae/drivers/noop_driver/driver.py (+4, -4)
octavia/tests/unit/amphorae/drivers/test_noop_amphoraloadbalancer_driver.py (+4, -2)
octavia/amphorae/drivers/driver_base.py (+1, -1)
",0.47384,0.359248,-0.528364,1.037037,0.301266,0.798689,-0.142911,-0.57589,-0.03703,-0.534406,0.635041,0.477218,-0.38203,-0.12066,0.545834
openstack/octavia,I6ad0349dba62b1141be07bfb0e40171e9f7a91b9,1,0,0.4167,3.5553,0.0294,5,20.75,512,0,Feature,0,0,0,48,0.0038,1.0,0,0.4167,5,1,0,0.5303,1.8919,3.4,55.31,13.6,0,0,0.5,0,14.6286,0,0,0,0,0,"Improve the error message for bad pkcs12 bundles

When a user loads a bad pkcs12 bundle or one with a pass phrase into
barbican and then uses it for a TLS-TERMINATED listener, the error
we return the user is misleading[1].
This patch improves the error message to point out that we got the
bundle from barbican, but that it is unreadable and/or protected
with a pass phrase.

[1] Could not retrieve certificate: [ ... ] (HTTP 400)

Story: 2006587
Task: 36713
[SEP]
FILES CHANGED:
octavia/certificates/common/pkcs12.py (+5, -1)
octavia/certificates/manager/barbican.py (+2, -0)
octavia/tests/unit/certificates/manager/test_barbican.py (+17, -0)
octavia/api/v2/controllers/base.py (+2, -0)
octavia/common/exceptions.py (+7, -0)
",-0.977604,-1.550649,0.373072,-0.100296,-0.184811,0.069895,0.102759,0.007239,0.118293,0.435375,0.497584,-0.051701,0.092341,0.326324,-0.40413
openstack/octavia,Iad3b55e5add4283256f7836c3d4a501aa57ffc2f,0,0,0.1667,4.4886,0.4545,5,13.75,452,0,Bug Fix,0,0,0,6,0.001944,1.0,0,0.1667,7,1,0,0.5373,2.2169,6.0,40.6,13.5,0,0,0.625,0,5.0787,0,0,0,0,0,"Fix building configs for multiple listeners

Currently jinja_combo.build_config method expect to use single
tls cert, though with multiple listeners there could be multiple
certs. Also in case of HTTP and TERMINATED_HTTPS listeners on the
same loadbalancer - creation of the second listener will fail.

Story: 2006513
Task: 36510
(cherry picked from commit 42df031e89629cc8394e577949e3b2b4c465d756)
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+11, -11)
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+5, -4)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+11, -9)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+14, -12)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+7, -4)
",-1.151482,-1.151693,-0.365282,-0.964505,0.437635,-0.07903,0.412935,0.049921,0.253851,-0.130903,0.330182,-0.321134,0.132754,0.166877,-0.297526
openstack/octavia-dashboard,I83687ed1476a9e413ca6a8a880dd31783450df67,1,0,0.4286,3.4012,0.1379,2,13.67,338,0,Bug Fix,0,0,0,49,0.003868,0.0,0,0.0,6,1,0,0.0,0.9784,6.0,29.95,14.25,0,0,0.0,0,11.2667,1,0,0,0,0,"Fix dashboard certificates skipping pkcs12 bundles

Octavia dashboard was skipping pkcs12 bundles when presenting
certificate options for TERMINATED_TLS listeners.
This patch corrects that so that users can select pkcs12 bundles
for use on their listeners.

Story: 2005436
Task: 30476
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+8, -4)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+17, -0)
",-0.990294,-1.205918,-0.76532,0.411909,0.541326,0.163562,-1.056468,0.08734,-0.047661,0.025044,0.124944,-0.420722,0.267084,0.033086,0.14935
openstack/octavia,Ic07629adb9419c74d5ed957a0640fb1dc8253521,0,0,0.0,2.5649,1.0,2,11.62,588,0,Bug Fix,1,0,0,2,0.0033,0.0,0,0.0,1,1,0,0.5294,0.65,1.0,59.49,11.96,0,0,1.0,1,45.2308,0,0,0,0,0,"Delete the periodic Fedora 28 amphora image job

The job broke around mid June and has not been fixed since that time.
Plus, Fedora 28 is no longer supported by the Fedora project and is not
tested by any of our dsvm scenario jobs. It is time to delete the job
from the periodic queue.

The community is more than welcome to help restore Fedora-based amphora
image builds. One might be interested in picking help change
https://review.opendev.org/#/c/673173/ where the build was successful
but was did not pass the dsvm scenario job.
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+0, -2)
zuul.d/jobs.yaml (+0, -10)
",-0.942905,-0.858603,0.278945,0.292833,-0.894346,0.123044,0.977649,0.049579,-0.268026,0.066634,0.525232,0.264197,-0.223918,0.090457,0.137769
openstack/octavia,I3f776bd018246897c9a889699a2d0ecbbfbb7098,1,0,0.7778,4.1589,0.5238,9,9.29,1005,0,Bug Fix,0,0,0,9,0.009174,0.4,0,0.3111,6,6,0,0.5217,2.9266,3.0,25.61,12.95,0,0,0.3492,1,15.7031,0,0,0,0,0,"Fix controller worker graceful shutdown

Fix an issue that prevents graceful shutdown of controller workers.

cotyledon.Service.terminate function is by definition the graceful
termination function and doesn't have any 'graceful' optional boolean
argument (https://cotyledon.readthedocs.io/en/latest/api.html).

Because of this error, message_listener.wait() was never called in the
consumers' termination functions, so flows could be interrupted before
completion and could leave resources such as load balancer in a
PENDING_* provisioning state.

By default cotyledon.Service terminates the server after a timeout if
the worker could not shutdown itself gracefully. The default value
for the timeout is 300 seconds (set in devstack plugin) and can be
overriden using the graceful_shutdown_timeout setting in octavia.conf
The default value will be updated to a lower value when work on
persistant taskflow will be merged.

Story: 2006603
Task: 36770
[SEP]
FILES CHANGED:
octavia/controller/queue/v1/consumer.py (+5, -5)
octavia/tests/unit/controller/queue/v1/test_consumer.py (+0, -11)
octavia/tests/unit/controller/queue/v2/test_consumer.py (+0, -11)
devstack/plugin.sh (+5, -0)
doc/source/configuration/configref.rst (+1, -0)
releasenotes/notes/fix-worker-graceful-shutdown-c44b6797637aa1b3.yaml (+9, -0)
octavia/controller/queue/v2/consumer.py (+5, -5)
tox.ini (+2, -1)
etc/octavia.conf (+3, -0)
",-3.768278,0.784285,3.381342,-1.817342,0.268807,0.644311,-0.361208,-0.48603,0.023294,-0.26846,-0.585224,0.30189,-0.172482,0.001903,-0.057103
openstack/octavia,I5619f5e40d7c9a2ee7741bf4664c0d2d08963992,1,0,0.0,2.7081,0.0714,3,11.67,301,1,Bug Fix,0,0,0,4,0.000929,0.0,0,0.0,4,2,0,0.5286,1.4316,2.67,37.88,13.81,1,0,0.5,1,20.0667,0,0,0,0,0,"Fix urgent amphora two-way auth security bug

The value of gunicorn's option 'cert_reqs` for client-cert requirement
does not take a boolean, but rather `ssl.CERT_REQUIRED` which is `2`.

Story: 2006660
Task: 36916

SecurityImpact: CVE-2019-17134
[SEP]
FILES CHANGED:
octavia/cmd/agent.py (+1, -1)
releasenotes/notes/correct-amp-client-auth-vulnerability-6803f4bac2508e4c.yaml (+5, -0)
octavia/tests/unit/cmd/test_agent.py (+7, -0)
",-0.14054,-0.394869,-0.661667,-0.087647,-0.341869,0.256982,-0.466285,0.213796,0.728983,-0.019748,0.011882,-0.518741,0.069363,0.187666,-0.021355
openstack/octavia,Ia30435b3bb19acd1d2f9fe217251c393d4f7480e,0,0,0,4.3694,0.8462,8,9.0,149,0,CI,0,0,1,0,0.0,0.25,0,0.0,2,5,0,0.5352,2.2444,0.5,66.1,10.27,1,0,0.4231,1,1.8861,0,0,0,0,0,"Stop testing python 2

Since it's no longer supported past Train, lets stop
running the tests.
[SEP]
FILES CHANGED:
requirements.txt (+1, -3)
test-requirements.txt (+0, -2)
zuul.d/projects.yaml (+0, -27)
doc/requirements.txt (+0, -2)
setup.cfg (+0, -4)
TESTING.rst (+2, -2)
tox.ini (+4, -26)
releasenotes/notes/drop-python-2-7-a6b3f456bf6a3da7.yaml (+5, -0)
",1.795117,-1.701166,0.124419,0.021077,-0.851486,0.436684,-0.413665,-0.567776,-1.111839,0.607164,-0.176328,0.295642,-0.512591,0.154765,0.146039
openstack/octavia,I8a0cdf7ee912d39d9ac24244728094a1d1e15c63,1,0,0.0,5.6348,0.5663,9,13.0,260,0,CI,0,0,0,1,0.012658,0.5,0,0.0,7,2,0,0.5278,2.0549,5.89,54.81,13.41,0,0,0.9355,0,0.9286,0,0,0,0,0,"Do not set log format when 'no log' is set

Re-factored code to not insert a log-format line in haproxy
config when 'no log' is set in the template. Adjusted tests
as necessary.

Story: 2006181
Task: 35706
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+3, -2)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+3, -2)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+5, -4)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+3, -1)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+44, -67)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+8, -7)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+44, -67)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+3, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+8, -7)
",0.920249,-0.673676,-0.271132,0.332103,-0.492172,0.12328,0.104995,-0.589722,0.277308,-0.004447,0.181799,-0.206342,0.087007,0.297424,-0.113999
openstack/octavia,I5962e335acff79152fa49c27c883aef2879593db,1,0,0.44,1.7918,0.0,1,15.8,512,0,Bug Fix,0,0,0,50,0.003938,0.0,0,0.0,3,1,0,0.5342,0.0,3.0,56.94,11.38,0,0,0.0,1,85.3333,0,0,0,0,0,"Fix log offload file permissions in CentOS devstack

CentOS sets a restrictive umask by default that will override the
rsyslog file permissions settings. This can cause our tempest tests
to no be able to read the log offload files in our CentOS gate jobs.
This patch clears this umask override in the devstack rsyslog
configuration.

Note: This is a global setting for rsyslog and you probably do not
      want to set this outside of a testing environment.
[SEP]
FILES CHANGED:
devstack/etc/rsyslog/10-octavia-log-offloading.conf (+5, -0)
",-0.36977,-0.971376,0.505854,0.930542,0.194735,-0.302602,0.755271,-0.102419,-0.012297,0.043841,0.389949,-0.283748,0.114577,-0.218463,0.088658
openstack/octavia,I43b60e7dcf53acf259c8a52b248fbb8c63d3c8d4,0,0,0.5,5.037,0.4379,8,9.6,328,0,Bug Fix,0,0,1,2,0.005587,0.5,0,0.25,3,3,0,0.5405,1.3951,1.12,59.62,8.84,1,0,0.0065,1,2.1299,0,0,0,0,0,"Add bash script style checker to pep8 check

Added the bashate script style checker to the pep8
check target in tox.ini. It actually found two valid
issues - a bad function declaration and a local variable
issue, but mostly just indentation noise. Fixed all the
complaints.
[SEP]
FILES CHANGED:
devstack/samples/singlenode/local.sh (+5, -5)
test-requirements.txt (+1, -0)
devstack/plugin.sh (+57, -57)
devstack/upgrade/vm_user_data.sh (+3, -1)
lower-constraints.txt (+1, -0)
tools/misc-sanity-checks.sh (+2, -2)
tox.ini (+16, -0)
devstack/upgrade/resources.sh (+1, -2)
",1.004127,-1.504306,0.189888,0.326279,-0.071189,-0.489253,0.697981,-0.20179,-0.141999,0.092485,0.204093,-0.207955,0.134031,0.089556,0.134054
openstack/octavia,Id0bf1c6b1633ffb4143c7628b722434faf433d7d,0,0,0.3333,1.9459,0.5,2,6.29,286,0,CI,0,0,1,3,0.005871,0.2143,0,0.0714,0,2,0,0.5333,0.9183,0.0,77.4,6.15,1,0,0.3333,1,40.8571,0,0,0,0,0,"Use bandit block in tox.ini

Use the bandit testenv block in tox.ini instead of inlining
it. Also changed the call back to '-x tests' since that is
correct syntax, it was just broken in version 1.6.0, which
is now in the blacklist.
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
tox.ini (+2, -2)
",0.615644,-1.245057,0.040731,0.482519,-0.521856,-0.230064,0.609987,-0.385423,-0.651812,0.278561,0.107251,-0.153615,-0.486204,0.329308,0.268367
openstack/octavia,I97bd1b2a97a44d0a0566ae56167fa4f2e503ee2d,1,0,0.451,5.6733,0.1241,9,15.67,339,0,Bug Fix,0,0,0,51,0.004015,1.0,0,0.451,5,1,0,0.5263,2.5705,4.22,36.13,14.78,0,0,0.5828,0,1.1649,0,0,0,0,0,"Fix issues with unavailable secrets

Previously, if a secret became unavailable in barbican, the user saw
a generic error raised from the barbican client and was unable to delete
load balancer resources. This patch corrects both of those issues.

Story: 2006676
Task: 37012
Task: 37077
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_pool.py (+32, -0)
octavia/api/v2/controllers/load_balancer.py (+2, -1)
octavia/common/tls_utils/cert_parser.py (+22, -9)
octavia/api/v2/controllers/pool.py (+2, -1)
octavia/tests/unit/common/tls_utils/test_cert_parser.py (+23, -0)
octavia/tests/unit/api/drivers/test_utils.py (+82, -0)
octavia/tests/functional/api/v2/test_listener.py (+32, -0)
octavia/api/v2/controllers/listener.py (+2, -1)
octavia/api/drivers/utils.py (+57, -24)
",-0.670086,-1.05992,-0.97813,0.351763,-0.479035,0.856117,-0.411411,-0.46911,0.259986,-0.034198,0.432142,0.424642,0.238983,0.316798,0.168453
openstack/octavia-dashboard,I1b0a7da8a076bf495d6289a75718637a7c41d94d,0,0,0,1.0986,0.5,1,7.0,85,0,CI,1,0,0,0,0.0,0.0,0,0.0,1,1,0,0.25,0.0,1.0,-17.81,25.66,0,0,1.0,1,28.3333,0,0,0,0,0,"Switch to official Ussuri jobs
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",3.424313,0.604917,1.87396,0.244849,0.319038,0.118233,0.792428,1.048398,-0.147293,-0.049212,-0.042383,-0.071407,0.057312,-0.40197,-0.05244
openstack/octavia,I8a0cdf7ee912d39d9ac24244728094a1d1e15c63,0,0,0.2,5.6348,0.5663,9,13.0,260,0,CI,0,0,0,5,0.001158,0.6667,0,0.1333,7,2,0,0.5325,2.0549,5.89,54.81,13.41,0,0,0.9355,0,0.9286,0,0,0,0,0,"Do not set log format when 'no log' is set

Re-factored code to not insert a log-format line in haproxy
config when 'no log' is set in the template. Adjusted tests
as necessary.

Story: 2006181
Task: 35706
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+3, -2)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+3, -2)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+5, -4)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+3, -1)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+44, -67)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+8, -7)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+44, -67)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+3, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+8, -7)
",0.920249,-0.673676,-0.271132,0.332103,-0.492172,0.12328,0.104995,-0.589722,0.277308,-0.004447,0.181799,-0.206342,0.087007,0.297424,-0.113999
openstack/octavia,I4941df3894148482c597d30f3a8db70659fd1b7a,0,0,0.4615,1.6094,0.0,1,5.17,280,0,Feature,0,1,0,52,0.004003,0.2,0,0.0923,0,1,0,0.5256,0.0,0.0,37.85,11.1,1,0,0.0,1,56.0,0,0,0,0,0,"Revert ""Clean up requirements.txt from tox.ini""

It appears that these are required to have the upper constraints properly applied. We need to revert this change.

This reverts commit 7b8e6de1b8230e5d31ca36624e7fdfba25e3e077.
[SEP]
FILES CHANGED:
tox.ini (+4, -0)
",-0.370052,-0.482636,-1.936965,-0.964544,0.725158,0.409714,1.131898,-0.411236,0.179651,0.649524,-0.291259,-0.157998,-0.103797,0.333855,0.026745
openstack/kolla-ansible,Ic745300b27e50132d80d03787fa4abfada2d0173,1,1,0,3.2958,0.0385,3,8.0,710,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.0,1.1416,2.67,11.54,11.7,1,1,0.0,1,26.2963,0,6,0,13,0,"[docker] Added a new flag to disable default network

Docker is using 172.17.0.0/16 by default for bridge networking on
docker0, and this might cause routing problems for operator networks.

This change introduces docker_disable_default_network to disable the
bridge networking by putting ""bridge: none""[1] to daemon.json

Bridge networking does not work without iptables, so we set the default
for docker_disable_default_network to
docker_disable_default_iptables_rules.

For better defaults, this feature will be enabled by default in
Wallaby.

[1] https://docs.docker.com/engine/reference/commandline/dockerd/

Closes-Bug: #1848249
Related-Bug: #1849275
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -0)
releasenotes/notes/docker-disable-bridge-14df8b7fddbd5000.yaml (+9, -0)
ansible/roles/baremetal/tasks/post-install.yml (+15, -1)
",-2.129226,0.180254,1.028301,-0.201381,-0.243077,0.056776,-0.472715,0.285658,0.089539,0.024509,0.075668,-0.409294,-0.189024,-0.273577,-0.056278
openstack/octavia,I2f3c7ab4137dbd84d77a6a6b675975af406249d0,1,0,0.4528,5.6733,0.5517,12,16.0,441,0,Bug Fix,0,0,0,53,0.004078,1.0,0,0.4528,7,3,0,0.519,3.0889,5.5,39.9,17.03,1,0,0.5207,1,1.5155,0,0,0,0,0,"Fix listeners with SNI certificates

The single process patch changed the way listeners and load balancers
are deployed inside the amphora. This caused listeners with SNI
enabled to load all of the certificates for all of the TLS enabled
listeners on a load balancer.
This patch corrects that by configuring each listener with a
specific list of certificates.

Story: 2006758
Task: 37252
[SEP]
FILES CHANGED:
releasenotes/notes/fix-SNI-single-process-879ffce5eaa6c1c3.yaml (+6, -0)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+27, -25)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+14, -7)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+15, -24)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+17, -28)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+4, -9)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+2, -2)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+11, -24)
octavia/amphorae/backends/agent/api_server/util.py (+1, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+27, -29)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+4, -9)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+2, -2)
",-0.68965,-1.63177,-0.065083,0.827476,0.121015,0.067099,-0.087673,0.058256,0.14275,0.145704,-0.131136,0.081137,0.297041,0.344462,-0.023526
openstack/octavia-lib,I43572045ea3d054c2993b523ee9ea8a6a71faa61,0,0,0.0,1.0986,0.5,1,6.0,76,0,Feature,1,0,0,1,0.028571,0.0,0,0.0,1,1,0,0.0,0.0,1.0,-24.85,22.4,1,0,1.0,1,25.3333,0,0,0,0,0,"Switch to Ussuri jobs
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",3.676626,1.340475,2.153725,0.340563,0.488051,0.386223,0.609359,0.802806,-0.127512,-0.005595,0.121377,-0.303513,0.166387,0.000722,0.057594
openstack/python-octaviaclient,Ia8e451d7f806fac7d36b2860f256eb34f9f7400e,0,0,0.1667,7.3245,0.0495,22,5.0,81,0,Feature,0,0,0,6,0.001305,1.0,0,0.1667,5,2,0,0.0625,4.192,3.68,-35.12,26.0,0,0,0.6306,1,0.0534,0,0,0,0,0,"Add ""--wait"" functionality
[SEP]
FILES CHANGED:
octaviaclient/api/exceptions.py (+26, -0)
octaviaclient/osc/v2/l7policy.py (+55, -0)
octaviaclient/osc/v2/load_balancer.py (+67, -1)
octaviaclient/tests/unit/osc/v2/test_listener.py (+94, -0)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+126, -1)
releasenotes/notes/add-wait-option-to-CUD-commands-97375387e7762b83.yaml (+6, -0)
octaviaclient/osc/v2/constants.py (+2, -0)
octaviaclient/osc/v2/l7rule.py (+68, -0)
octaviaclient/osc/v2/utils.py (+45, -6)
octaviaclient/tests/unit/api/test_octavia.py (+33, -32)
octaviaclient/tests/unit/osc/v2/test_member.py (+145, -13)
octaviaclient/osc/v2/member.py (+64, -0)
octaviaclient/tests/unit/osc/v2/test_l7rule.py (+140, -0)
octaviaclient/osc/v2/health_monitor.py (+55, -0)
octaviaclient/api/v2/octavia.py (+2, -15)
octaviaclient/tests/unit/osc/v2/test_amphora.py (+72, -3)
octaviaclient/tests/unit/osc/v2/test_health_monitor.py (+103, -0)
octaviaclient/osc/v2/amphora.py (+42, -4)
octaviaclient/tests/unit/osc/v2/test_l7policy.py (+103, -0)
octaviaclient/osc/v2/listener.py (+51, -0)
octaviaclient/tests/unit/osc/v2/test_pool.py (+91, -0)
octaviaclient/osc/v2/pool.py (+51, -0)
",2.175742,1.893546,1.445529,0.546199,0.853397,0.792548,-0.208836,-0.818009,0.171696,0.127364,-0.260122,-0.192788,0.530343,0.501319,0.490091
openstack/octavia,I96908e6cbdb523f95298aff463a749d15e98e1ad,1,0,0.463,4.1109,0.0833,5,16.0,343,0,Bug Fix,0,0,0,54,0.004065,1.0,0,0.463,5,1,0,0.525,1.7827,4.4,31.97,15.57,1,0,0.8,0,5.623,0,0,0,0,0,"Fix update API when barbican secret is missing

API update calls were blocked if the load balancer had a TLS
terminated listener that the secret has been removed from barbican.
This patch corrects this problem allowing users to update the
certificate reference.

Story: 2006676
Task: 37322
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_pool.py (+28, -0)
octavia/api/v2/controllers/load_balancer.py (+2, -1)
octavia/api/v2/controllers/pool.py (+1, -1)
octavia/tests/functional/api/v2/test_listener.py (+20, -0)
octavia/api/v2/controllers/listener.py (+4, -3)
",0.072235,-1.786515,-0.680763,0.214476,-0.409149,0.548424,0.198067,0.13272,0.572277,-0.283689,0.409197,0.108812,-0.048189,0.118657,-0.008114
openstack/octavia,Ifc33eef511216325022614ddcc92f7d3c0169911,0,0,0.0,3.3673,0.7857,7,3.5,437,0,Feature,0,0,1,1,0.25,0.1875,0,0.0,2,4,0,0.5309,2.0855,0.57,5.88,10.92,0,0,0.1071,1,15.069,0,0,0,0,0,"OpenStack is dropping the py2.7 support in ussuri cycle.

octavia is ready with python 3 and ok to drop the
python 2.7 support.

Complete discussion & schedule can be found in
- http://lists.openstack.org/pipermail/openstack-discuss/2019-October/010142.html
- https://etherpad.openstack.org/p/drop-python2-support

Ussuri Communtiy-wide goal - https://review.opendev.org/#/c/691178/
[SEP]
FILES CHANGED:
requirements.txt (+0, -2)
test-requirements.txt (+0, -2)
zuul.d/projects.yaml (+0, -1)
doc/requirements.txt (+0, -2)
releasenotes/notes/drop-py-2-7-63cd7c819aa2ebdd.yaml (+5, -0)
setup.cfg (+0, -1)
tox.ini (+1, -14)
",-1.687455,1.990502,-0.526083,-0.054636,-1.078462,-0.259457,0.289686,0.167729,-0.138146,0.204425,-0.072983,0.016343,0.068567,0.239728,0.123034
openstack/octavia-dashboard,I1a7a75ddb132c8e2f41f1e47d3ebca15cb86f461,0,0,0.0,3.3322,0.6296,7,3.5,447,0,Feature,0,0,1,2,0.0625,0.1765,0,0.0,2,6,0,0.2,2.1765,0.86,-8.22,11.88,1,0,0.037,1,15.9643,0,0,0,0,0,"OpenStack is dropping the py2.7 support in ussuri cycle.

octavia-dashboard is ready with python 3 and ok to drop the
python 2.7 support.

Complete discussion & schedule can be found in
- http://lists.openstack.org/pipermail/openstack-discuss/2019-October/010142.html
- https://etherpad.openstack.org/p/drop-python2-support

Ussuri Communtiy-wide goal - https://review.opendev.org/#/c/691178/
[SEP]
FILES CHANGED:
octavia_dashboard/karma.conf.js (+1, -1)
zuul.d/projects.yaml (+0, -1)
doc/requirements.txt (+0, -1)
releasenotes/notes/drop-py-2-7-f3372b5c26171513.yaml (+6, -0)
setup.cfg (+0, -2)
octavia_dashboard/post_install.sh (+1, -1)
tox.ini (+2, -11)
",-1.631391,2.012764,-0.40812,-0.097928,-1.084726,-0.333444,0.28199,0.211029,-0.134814,0.132431,-0.100592,0.034617,0.026449,0.228217,0.13747
openstack/kolla-ansible,Ib631e2211682862296cce9ea179f2661c90fa585,1,0,0,5.2679,0.4974,17,13.5,1002,0,CI,0,0,0,0,0.0,0.5,0,0.0,4,5,0,0.3333,2.6133,3.53,20.17,14.29,1,0,0.0,1,5.1649,0,0,0,0,0,"Transition Keystone admin user to system scope

A system-scoped token implies the user has authorization to act on the
deployment system. These tokens are useful for interacting with
resources that affect the deployment as a whole, or exposes resources
that may otherwise violate project or domain isolation.

Since Queens, the keystone-manage bootstrap command assigns the admin
role to the admin user with system scope, as well as in the admin
project. This patch transitions the Keystone admin user from
authenticating using project scoped tokens to system scoped tokens.
This is a necessary step towards being able to enable the updated oslo
policies in services that allow finer grained access to system-level
resources and APIs.

An etherpad with discussion about the transition to the new oslo
service policies is:

https://etherpad.opendev.org/p/enabling-system-scope-in-kolla-ansible
[SEP]
FILES CHANGED:
ansible/roles/skydive/templates/skydive-agent.conf.j2 (+2, -1)
ansible/roles/barbican/tasks/check.yml (+3, -3)
ansible/roles/ironic/templates/ironic.conf.j2 (+7, -7)
ansible/roles/skydive/defaults/main.yml (+1, -1)
ansible/roles/nova-cell/tasks/discover_computes.yml (+5, -6)
ansible/roles/freezer/templates/freezer.conf.j2 (+3, -1)
ansible/roles/vitrage/templates/vitrage.conf.j2 (+1, -1)
doc/source/user/multi-regions.rst (+4, -4)
ansible/roles/skydive/templates/skydive-analyzer.conf.j2 (+1, -0)
ansible/roles/heat/defaults/main.yml (+1, -1)
tools/init-runonce (+0, -1)
ansible/roles/keystone/tasks/register_identity_providers.yml (+48, -57)
ansible/roles/murano/tasks/import_library_packages.yml (+8, -8)
releasenotes/notes/move-keystone-user-auth-to-system-scope-900db3265861ebde.yaml (+8, -0)
ansible/roles/heat/tasks/bootstrap_service.yml (+2, -1)
ansible/roles/keystone/tasks/register.yml (+1, -1)
ansible/group_vars/all.yml (+2, -3)
",-2.699786,-0.271025,1.885713,0.611606,0.025725,-0.271139,0.476438,0.548181,0.660426,-0.316143,-0.144211,0.750887,-0.036936,-0.306516,-0.051976
openstack/octavia,I300839fe7cf88763e1e0b8c484029662beb64f0a,1,0,0.4727,5.9687,0.5436,10,15.25,433,0,Bug Fix,0,0,0,55,0.004121,1.0,0,0.4727,7,1,0,0.5244,3.1041,5.0,34.64,16.59,1,0,0.5051,0,1.1074,0,0,0,0,0,"Fix multi-listener LB with missing certificate

This patch allows listeners on a load balancer to continue to
operate should one listener fail to access secret content in
barbican. Previously if one listener failed to access barbican
content, all of the listeners would be impacted.
This patch also cleans up some unused code and unnecessary comments.

Story: 2006676
Task: 36951
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+38, -3)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+6, -45)
octavia/controller/worker/v1/tasks/database_tasks.py (+3, -32)
octavia/controller/worker/v2/tasks/database_tasks.py (+4, -35)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+4, -40)
octavia/db/repositories.py (+10, -0)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+20, -10)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+62, -33)
octavia/controller/healthmanager/health_drivers/update_db.py (+10, -4)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+21, -10)
",-0.812138,-1.595687,-0.34032,0.312677,-0.140247,0.059456,0.006847,-0.240258,0.191413,0.040636,0.2288,0.012126,0.376721,0.117057,-0.171924
openstack/octavia,Ie6d4f74e36c2fb7cee4e0ff1e198602c5d8394cc,0,0,0.4821,5.5645,0.0269,9,16.0,414,0,Feature,0,0,0,56,0.004077,1.0,0,0.4821,5,1,0,0.5301,2.6884,3.89,43.87,15.15,0,0,0.35,0,1.5862,0,0,0,0,0,"Stop allowing the deletion of an in-use flavor

Currently the API allows an operator to delete a flavor even when it
is in use by a load balancer. This patch corrects this by blocking
the deletion of a flavor that is currently in use by a load balancer.
It also correctly handles load balancers in the ""DELETED""
provisioning_status.

Story: 2006782
Task: 37307
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+5, -2)
octavia/common/constants.py (+3, -0)
octavia/db/repositories.py (+52, -2)
octavia/db/migration/alembic_migrations/versions/e37941b010db_add_lb_flavor_constraint.py (+78, -0)
octavia/tests/functional/db/base.py (+12, -0)
octavia/api/v2/controllers/flavors.py (+21, -2)
octavia/tests/functional/api/v2/test_flavors.py (+46, -0)
octavia/api/v2/controllers/flavor_profiles.py (+10, -1)
octavia/tests/functional/api/v2/test_flavor_profiles.py (+26, -0)
",-1.039559,-0.819758,-0.239134,0.964115,0.149803,0.454323,0.245106,-0.284287,0.834236,0.237724,0.222141,0.526329,0.188689,0.016875,0.175615
openstack/octavia-lib,If81d0a45c423c173aa3c40dd2cfce37462dbf900,0,0,0.25,3.2189,0.7083,5,4.4,201,0,CI,0,0,1,4,0.007737,0.1667,0,0.0417,2,4,0,0.0,1.825,0.8,33.17,10.85,1,0,0.0417,1,8.04,0,0,0,0,0,"Stop testing python 2

Since it's no longer supported past Train, let's stop
running the tests.

Co-authored-by: Ajay Kumar <ajay.k@india.nec.com>
[SEP]
FILES CHANGED:
releasenotes/notes/drop-python-2-7-f17da6245b0ebc13.yaml (+5, -0)
zuul.d/projects.yaml (+0, -1)
doc/requirements.txt (+0, -1)
setup.cfg (+0, -5)
tox.ini (+2, -10)
",0.026027,0.523543,-1.169775,-0.078699,-1.204693,0.42477,-0.519088,-0.519731,-0.718498,0.064608,0.224358,0.560044,-0.262428,0.524664,-0.515433
openstack/octavia,I2e8c0be2221c0c23b752fdf2cdff065cddf830a5,1,0,0,1.3863,0.3333,1,26.0,697,0,Bug Fix,0,0,0,0,0.0,0.3333,0,0.0,4,1,0,0.5238,0.0,4.0,33.21,17.71,1,0,0.0,0,174.25,0,0,0,0,0,"ipvsadm '--exact' arg to ensure outputs are ints

Currently the keepalivedlvs_query script calls ipvsadm -Ln --stats
to query the local lvs for connection information. If any of these
values grow large enough they will be abbreviated with human-
friendly suffixes (K, M, G) and cause the get_ipvsadm_info func
to raise an exception when it receives a non-integer value from
its command output. By using the --exact argument in addition to
the existing arguments, we can ensure the output is always expanded
numbers, per the ipvsadm man page, and will only ever offer integer
outputs to the get_ipvsadm_info command.

Story: 2006791
Task: 37331
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+2, -1)
",-2.269619,-0.57417,1.016287,0.229073,0.310322,-0.300395,-0.097735,-0.180179,0.245798,-0.105138,0.185265,0.053798,-0.278069,-0.008479,-0.12619
openstack/octavia,Ib7b083e1dfbfd7afcca870ed6f60a871b2e19253,1,0,0.4737,5.0173,0.44,4,15.0,269,0,Bug Fix,0,0,0,57,0.004073,0.625,0,0.2961,7,2,0,0.5294,1.6593,4.5,8.31,16.67,1,0,0.2133,1,1.7815,0,0,0,0,0,"Fix multi-listener LB client auth/re-encryption

This patch corrects a bug with mutli-listener load balancers that
are using either TLS client authentication and/or backend
re-encryption.

Story: 2006822
Task: 37394
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+35, -40)
releasenotes/notes/fix-client-auth-single-process-749af7791454ff03.yaml (+6, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+24, -8)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+19, -18)
",0.067976,-0.733588,-0.375956,0.450606,0.181789,-0.117196,-0.349678,0.294852,0.453029,-0.095865,-0.152695,0.37142,0.546609,-0.229858,0.363314
openstack/octavia,I8e449b19af72d72f6effd52e0a2debb5754a19b3,1,0,0.4828,3.1355,0.1364,5,13.33,304,0,Bug Fix,0,0,0,58,0.0041,1.0,0,0.4828,4,4,0,0.5349,1.6386,3.6,32.56,16.33,0,0,0.0,1,13.2174,0,0,0,0,0,"Fix a potential race condition with certs-ramfs

There is a potential race condition in the start order for the
amphora-agent service and the certs-ramfs service.
This patch configures an explict ordering for the services.

Story: 2006823
Task: 37396
[SEP]
FILES CHANGED:
elements/amphora-agent/install.d/amphora-agent-source-install/amphora-agent.service (+2, -1)
elements/amphora-agent/install.d/amphora-agent-source-install/amphora-agent.init (+1, -1)
elements/amphora-agent/install.d/amphora-agent-source-install/amphora-agent.conf (+1, -1)
releasenotes/notes/fix-certs-ramfs-race-561f355d13fc6d14.yaml (+14, -0)
elements/certs-ramfs/init-scripts/systemd/certs-ramfs.service (+1, -0)
",0.644268,-0.755584,-0.475685,0.215616,-0.393919,0.330321,0.477436,-0.097884,0.488738,-0.343102,0.134852,0.263267,0.364319,0.114222,0.46214
openstack/octavia,I9a2aa4ed5b4ef60545c60a6d5bd06066ef361a56,1,0,0.4915,4.1744,0.0,4,13.33,318,0,Bug Fix,0,0,0,59,0.004165,0.1333,0,0.0655,5,2,0,0.5402,1.3619,3.25,13.53,17.33,0,0,0.6094,1,4.8923,0,0,0,0,0,"Fix filtering for provider capabilities list API

The ""Show Provider Flavor Capabilities"" would silently ignore
filtering parameters passed into the API. This patch corrects this
such that you can filter the providers capabilities list.

Story: 2006817
Task: 37377
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/provider.py (+19, -0)
octavia/common/constants.py (+2, -0)
releasenotes/notes/fix-provider-capabilities-filtering-8bd12b2cf7b37a84.yaml (+4, -0)
octavia/tests/functional/api/v2/test_provider.py (+39, -0)
",0.205728,-1.361493,-0.674545,0.443391,-0.079581,0.4785,-0.676425,-0.033847,0.397441,-0.061502,-0.139751,0.019978,0.255554,0.018952,-0.262092
openstack/octavia,I468d9fdf8c9d0898f9e30f04ac233510a10a53fc,0,0,0.1429,8.2626,0.015,77,5.2,268,0,Feature,0,0,0,7,0.001145,1.0,0,0.1429,7,6,0,0.5455,4.6655,3.78,-22.96,19.0,1,0,0.4454,1,0.0691,0,0,0,0,0,"Availability Zone admin API

Adds the ability for admins to create/manage availability_zones
and profiles for use with upcoming functionality. Works like flavors.

Depends-On: https://review.opendev.org/#/c/694057/
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+72, -0)
api-ref/source/v2/examples/provider-availability-zone-capability-show-curl (+1, -0)
octavia/db/base_models.py (+4, -1)
api-ref/source/v2/examples/availabilityzone-show-response.json (+8, -0)
api-ref/source/v2/availabilityzone.inc (+290, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
api-ref/source/v2/examples/availabilityzone-list-response.json (+10, -0)
api-ref/source/v2/examples/availabilityzoneprofile-update-response.json (+9, -0)
api-ref/source/v2/examples/availabilityzoneprofile-update-request.json (+8, -0)
api-ref/source/v2/examples/provider-availability-zone-capability-show-response.json (+8, -0)
octavia/common/constants.py (+10, -1)
octavia/policies/availability_zone_profile.py (+70, -0)
octavia/tests/functional/api/v2/test_availability_zones.py (+581, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_amphora_driver.py (+42, -0)
api-ref/source/v2/examples/availabilityzone-update-response.json (+8, -0)
api-ref/source/v2/examples/availabilityzoneprofile-create-curl (+1, -0)
api-ref/source/v2/examples/availabilityzone-create-response.json (+8, -0)
octavia/api/v2/controllers/base.py (+17, -0)
octavia/api/drivers/amphora_driver/availability_zone_schema.py (+47, -0)
octavia/compute/drivers/noop_driver/driver.py (+9, -0)
octavia/db/migration/alembic_migrations/versions/c761c8a71579_add_availability_zone_table.py (+71, -0)
octavia/policies/flavor.py (+1, -1)
octavia/api/v2/types/availability_zone_profile.py (+71, -0)
octavia/compute/compute_base.py (+10, -0)
octavia/db/models.py (+37, -0)
api-ref/source/v2/examples/availabilityzoneprofile-create-response.json (+9, -0)
api-ref/source/v2/examples/availabilityzoneprofile-update-curl (+1, -0)
api-ref/source/v2/examples/availabilityzone-show-curl (+1, -0)
api-ref/source/v2/index.rst (+10, -0)
octavia/tests/functional/api/v2/test_flavors.py (+0, -5)
api-ref/source/v2/examples/availabilityzone-list-curl (+1, -0)
octavia/api/v2/types/provider.py (+4, -0)
api-ref/source/v2/examples/availabilityzoneprofile-create-request.json (+8, -0)
api-ref/source/v2/examples/availabilityzoneprofile-show-response.json (+9, -0)
api-ref/source/v2/flavor.inc (+1, -1)
octavia/tests/functional/db/test_repositories.py (+2, -1)
api-ref/source/v2/flavorprofile.inc (+1, -1)
octavia/common/data_models.py (+20, -0)
octavia/tests/unit/api/v2/types/test_availability_zone_profiles.py (+70, -0)
octavia/api/drivers/noop_driver/driver.py (+24, -0)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+42, -0)
api-ref/source/v2/availabilityzoneprofile.inc (+297, -0)
octavia/policies/provider_availability_zone.py (+33, -0)
octavia/policies/provider_flavor.py (+1, -1)
api-ref/source/v2/examples/availabilityzone-delete-curl (+1, -0)
octavia/api/v2/controllers/availability_zones.py (+176, -0)
api-ref/source/v2/examples/availabilityzoneprofile-list-curl (+1, -0)
api-ref/source/v2/examples/availabilityzoneprofile-show-curl (+1, -0)
octavia/api/v2/controllers/__init__.py (+6, -0)
octavia/compute/drivers/nova_driver.py (+22, -0)
octavia/tests/functional/api/v2/base.py (+32, -4)
api-ref/source/v2/examples/availabilityzone-update-curl (+1, -0)
octavia/api/v2/types/availability_zones.py (+69, -0)
octavia/tests/functional/api/v2/test_flavor_profiles.py (+37, -31)
api-ref/source/v2/examples/availabilityzone-create-request.json (+8, -0)
api-ref/source/v2/examples/availabilityzoneprofile-delete-curl (+1, -0)
octavia/policies/flavor_profile.py (+5, -5)
octavia/db/repositories.py (+72, -1)
octavia/tests/unit/compute/drivers/test_compute_noop_driver.py (+13, -0)
octavia/api/drivers/amphora_driver/v2/driver.py (+68, -0)
octavia/policies/__init__.py (+6, -0)
api-ref/source/v2/examples/availabilityzone-update-request.json (+6, -0)
octavia/policies/availability_zone.py (+62, -0)
releasenotes/notes/availability-zone-api-a28ff5e00bdcc69a.yaml (+6, -0)
octavia/tests/functional/api/v2/test_provider.py (+141, -0)
octavia/tests/functional/api/v2/test_availability_zone_profiles.py (+589, -0)
octavia/tests/unit/compute/drivers/test_nova_driver.py (+16, -1)
api-ref/source/v2/examples/availabilityzone-create-curl (+1, -0)
octavia/api/v2/controllers/provider.py (+59, -2)
octavia/api/v2/controllers/availability_zone_profiles.py (+237, -0)
octavia/tests/unit/api/v2/types/test_availability_zones.py (+87, -0)
octavia/api/drivers/amphora_driver/v1/driver.py (+68, -0)
api-ref/source/v2/examples/availabilityzoneprofile-list-response.json (+10, -0)
octavia/tests/functional/db/base.py (+12, -0)
octavia/api/root_controller.py (+4, -1)
api-ref/source/v2/provider.inc (+54, -0)
octavia/tests/unit/api/drivers/test_provider_noop_driver.py (+17, -0)
",-0.45165,0.911856,-0.833004,0.439612,-0.816857,0.103406,-0.452145,0.101882,0.193364,-0.217883,-0.96447,-0.184878,0.305671,-0.251902,-0.169298
openstack/octavia,I7153ed9a6214ce352b2ac115001f7f6134d95b39,1,0,0.5,4.8675,0.1473,2,18.0,469,0,Bug Fix,0,0,0,60,0.004216,0.25,0,0.125,5,1,0,0.5393,0.9769,4.0,49.92,14.42,0,0,0.5891,0,3.6077,0,0,0,0,0,"Fix filtering with API tags

When filtering API calls using tags along with other filter parameters
the API could fail with an ""Entity has no property"" errors.
Also when filtering with tags that contain a comma separated list,
the API would mis-interpret the list of tags as a single string.
This patch resolves both of these issues and adds functional test
coverage for these use cases.

Story: 2006914
Task: 37559
[SEP]
FILES CHANGED:
octavia/api/common/pagination.py (+34, -19)
octavia/tests/functional/api/v2/test_load_balancer.py (+76, -0)
",-0.88164,-1.681646,-0.044521,0.613992,-0.225371,0.271091,-0.124113,-0.367877,0.436752,0.421373,-0.124516,-0.007402,0.597523,-0.068147,-0.2712
openstack/octavia,I3f776bd018246897c9a889699a2d0ecbbfbb7098,1,0,0.8,3.7377,0.4146,7,9.8,1244,0,Bug Fix,0,0,0,10,0.009579,1.0,0,0.8,5,6,0,0.5444,2.4963,2.14,24.23,12.9,0,0,0.2683,1,29.619,0,0,0,0,0,"Fix controller worker graceful shutdown

Fix an issue that prevents graceful shutdown of controller workers.

cotyledon.Service.terminate function is by definition the graceful
termination function and doesn't have any 'graceful' optional boolean
argument (https://cotyledon.readthedocs.io/en/latest/api.html).

Because of this error, message_listener.wait() was never called in the
consumers' termination functions, so flows could be interrupted before
completion and could leave resources such as load balancer in a
PENDING_* provisioning state.

By default cotyledon.Service terminates the server after a timeout if
the worker could not shutdown itself gracefully. The default value
for the timeout is 300 seconds (set in devstack plugin) and can be
overriden using the graceful_shutdown_timeout setting in octavia.conf
The default value will be updated to a lower value when work on
persistant taskflow will be merged.

Story: 2006603
Task: 36770

Conflicts:
	devstack/plugin.sh

(cherry picked from commit 215c4c2284209ff46dc62f7cc04432cb2c9bf39e)
(cherry picked from commit 0fc1ea4789eaf743e04db31d366b64a34172df15)
(cherry picked from commit 6fe5df6fd8b80e3022120f2bd74098a8e71152f7)
[SEP]
FILES CHANGED:
devstack/plugin.sh (+4, -0)
doc/source/configuration/configref.rst (+1, -0)
octavia/tests/unit/controller/queue/test_consumer.py (+0, -11)
releasenotes/notes/fix-worker-graceful-shutdown-c44b6797637aa1b3.yaml (+9, -0)
tox.ini (+2, -1)
etc/octavia.conf (+3, -0)
octavia/controller/queue/consumer.py (+5, -5)
",-3.768278,0.784285,3.381342,-1.817342,0.268807,0.644311,-0.361208,-0.48603,0.023294,-0.26846,-0.585224,0.30189,-0.172482,0.001903,-0.057103
openstack/octavia,I6d5d39c4cf87ac687355f80ca591c1a611f46f41,1,0,0.8182,3.4965,0.75,2,13.67,332,1,Bug Fix,0,0,0,11,0.010138,0.0,0,0.0,1,1,0,0.5495,0.9544,1.0,29.95,16.2,0,0,0.0,0,10.0606,0,0,0,0,0,"Use 2048-bits keys for devstack certificates

RHEL8 and Centos8 refuse to load certificates generated with a 1024-bits
key because of new security policies. Increasing key size to 2048-bits
fixes certificate generation scripts for these distributions.

Story 2006944
Task 37623
[SEP]
FILES CHANGED:
bin/create_dual_intermediate_CA.sh (+5, -15)
bin/create_single_CA_intermediate_CA.sh (+3, -9)
",-0.288006,-1.396455,-0.4941,0.148777,0.315951,0.275677,-0.658146,0.285111,-0.090509,0.024973,-0.431585,0.116131,0.581533,-0.306723,-0.154892
openstack/octavia,I3f0c47e72978103bb4dd83fe6f3cdd2c0e8e3210,0,0,0.125,1.7918,0.4,3,3.33,145,0,Feature,0,0,1,8,0.000801,0.0909,0,0.0114,3,2,0,0.5543,1.5219,1.0,-41.89,25.33,0,0,0.2,0,24.1667,0,0,0,0,0,"Adjust for new octavia-lib LB signature

Depends-On: https://review.opendev.org/#/c/697359/
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
octavia/tests/common/sample_data_models.py (+1, -0)
lower-constraints.txt (+1, -1)
",0.760098,3.921932,-1.095841,0.196227,-1.437175,0.768151,0.118025,-0.514545,0.157455,-0.630919,-0.492911,0.367059,-0.014808,-0.375118,0.114347
openstack/octavia,I1bc0a37f35839a5f9a95650af7c82239f6544c50,0,0,0.5082,2.7081,0.8571,4,7.0,309,0,CI,0,0,0,61,0.004248,0.3333,0,0.1694,1,3,0,0.5484,1.6645,1.0,18.44,17.66,0,0,0.7143,1,20.6,0,0,0,0,0,"Stop supporting xenial amphora images

OpenStack is dropping support for xenial[1].

This patch removes references to support for xenial amphora images
and stops the nightly build of xenial amphora test images.

[1] https://review.opendev.org/#/c/695114/
[SEP]
FILES CHANGED:
diskimage-create/README.rst (+1, -1)
diskimage-create/diskimage-create.sh (+1, -1)
zuul.d/projects.yaml (+0, -2)
zuul.d/jobs.yaml (+0, -8)
",-1.215526,0.593842,-0.815028,0.667627,-0.416579,-0.196208,-0.394558,0.454829,-0.229593,0.424037,-0.287351,0.170524,0.176195,-0.335939,-0.239209
openstack/octavia,I81f76afc7e3fa6f190c30f33198197cb627cce26,0,0,0.0,1.3863,0.3333,1,6.17,348,0,Bug Fix,1,0,0,3,0.004854,0.0,0,0.0,7,1,0,0.5426,0.0,7.0,10.8,12.2,0,0,1.0,0,87.0,0,0,0,0,0,"Fix unit test when run on CentOS 7

Fix unit test test_cmd_get_version_of_installed_package_mapped when run
on a CentOS 7 system.

   testtools.matchers._impl.MismatchError: !=:
   reference = 'rpm -q --queryformat %{VERSION} haproxy'
   actual    = 'rpm -q --queryformat %{VERSION} haproxy18'
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/backends/agent/api_server/test_osutils.py (+2, -1)
",-0.395575,-0.374599,0.405975,-0.157515,0.527694,-0.434899,-0.656406,0.003774,0.153543,0.0459,-0.105673,-0.915145,-0.151888,0.461755,0.095221
openstack/octavia,I865445af34bc63b90d965ef5e2c8f9f49aa9c2f3,1,0,0.1111,4.3175,0.1351,8,21.25,599,0,Bug Fix,0,0,0,9,0.000901,1.0,0,0.1111,7,2,0,0.5368,1.3985,5.38,17.06,17.91,0,0,0.7703,1,7.9867,0,0,0,0,0,"Update the lb_id on an amp earlier if we know it

When we create amphora for specific loadbalancer it would be
good to get info about mapping pair loadbalancer-amphora as
soon as possible.

For example, if admin needs to debug connectivity issues with amphora
VMs - loadbalancer_id won't be set until AmphoraComputeConnectivityWait
task succeeds (which is never for such case) so they have to go to worker
logs to understand which amphora is related to a currently creating
loadbalancer.

Co-Authored-By: Ann Taraday <akamyshnikova@mirantis.com>
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+1, -0)
octavia/tests/unit/controller/worker/v2/flows/test_amphora_flows.py (+47, -8)
octavia/controller/worker/v1/flows/amphora_flows.py (+1, -0)
octavia/controller/worker/v1/tasks/database_tasks.py (+2, -1)
octavia/controller/worker/v2/tasks/database_tasks.py (+2, -1)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+1, -0)
releasenotes/notes/link-amphora-to-loadbalancer-earlier-ab3dddec48b8da96.yaml (+9, -0)
octavia/controller/worker/v2/flows/amphora_flows.py (+1, -0)
",-1.468099,-1.260237,0.812944,-0.250279,-0.223223,-0.492892,0.374874,-0.059913,-0.222763,-0.351921,0.367262,-0.149506,-0.239506,0.031313,-0.191723
openstack/octavia,I819d44a37cba3ef952d109a675ae6d55e3eb4aa1,0,0,0.5,4.7185,0.6306,13,14.67,304,0,CI,0,0,0,62,0.004313,1.0,0,0.5,7,1,0,0.5417,3.0454,5.46,34.28,15.87,1,0,0.4865,0,2.7143,0,0,0,0,0,"Update ListenersUpdate for lb/listener dicts

This patch updates the ListersUpdate task to accept a load balancer
ID instead of a load balancer database object as part of the job board
work.
It also removes a duplicate test that is no longer needed.
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/flows/pool_flows.py (+3, -3)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+1, -1)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+2, -2)
octavia/tests/unit/controller/worker/v2/flows/test_listener_flows.py (+2, -4)
octavia/controller/worker/v2/flows/member_flows.py (+4, -4)
octavia/controller/worker/v2/flows/l7rule_flows.py (+3, -3)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+1, -1)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+4, -38)
octavia/controller/worker/v2/flows/health_monitor_flows.py (+3, -3)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+11, -4)
octavia/controller/worker/v2/controller_worker.py (+1, -1)
octavia/controller/worker/v2/flows/l7policy_flows.py (+3, -3)
octavia/controller/worker/v2/flows/listener_flows.py (+3, -3)
",0.720684,-1.518143,0.035556,0.661395,0.015734,-0.005921,0.7528,0.074164,0.400605,-0.358066,-0.118789,0.096827,-0.360218,0.017268,-0.319107
openstack/octavia,Ib3d6aa0f2fd550c3a8756c41e0159c5ae8127c7c,1,0,0.8333,3.912,0.4082,3,20.5,319,0,Bug Fix,0,0,0,12,0.010743,0.0,0,0.0,4,2,0,0.5361,1.4108,2.67,35.4,16.98,0,0,0.4082,1,6.38,0,0,0,0,0,"Fix house keeping graceful shutdown

SIGTERM was not caught by house keeping service, threads were not
correctly terminated and spare amphora creation may have been killed
when restarting the service, leaving amphorae in BOOTING status.

Story: 2007008
Task: 37788
[SEP]
FILES CHANGED:
octavia/cmd/house_keeping.py (+15, -8)
octavia/tests/unit/cmd/test_house_keeping.py (+8, -12)
releasenotes/notes/fix-house-keeping-shutdown-17b04417a2c4849f.yaml (+6, -0)
",0.016583,-2.033018,-0.477678,-0.108484,-0.423139,0.408242,-0.521395,-0.305401,-0.158274,-0.301517,0.366382,0.134656,0.159828,0.470618,-0.09079
openstack/octavia,I5cdc0a9ccc01548f195eed80f2ee2848a1a93e17,1,0,0.8462,2.8904,0.5882,1,17.4,563,0,Feature,0,0,0,13,0.011149,1.0,0,0.8462,6,1,0,0.5408,0.0,6.0,44.28,14.78,1,0,0.0,0,31.2778,0,0,0,0,0,"Use LUKS1 for certfs-ramfs for all distributions

This commit forces the use of LUKS1 in cryptsetup.

Centos uses LUKS2 by default in cryptsetup, ubuntu uses LUKS1.
Formating a LUKS2 block device is way longer than formating a LUKS1
device (15 sec vs 8 sec in my env) and LUKS2 doesn't provide any
significant features for octavia (it only improves recovery and
metadata).

The commit aslo limits the creation of more than 1 block ram device
(amphora doesn't need 16 ram devices), which reduces startup time.
[SEP]
FILES CHANGED:
elements/certs-ramfs/static/usr/local/bin/certfs-ramfs (+7, -10)
",-1.774337,-0.590167,0.486351,0.418199,0.41219,-0.067599,0.060459,0.343513,-0.547967,0.211117,0.37511,0.037393,0.184852,-0.314941,-0.049963
openstack/python-octaviaclient,I7ca43b55064e04e6d214a88eef5ed853090fbc34,0,0,0.8571,4.9127,0.0,7,14.0,313,0,CI,0,0,0,14,0.011834,0.5,0,0.4286,5,3,0,0.0588,1.9308,2.71,27.45,18.93,0,0,0.5037,1,2.3015,0,0,0,0,0,"Add amphora stats show API and CLI

Added amphora_stats_show in the OctaviaAPI class.

Added ""amphora stats show"" command in the CLI, with an optional
""--listener <listener>"" argument to display the statistics of a specific
listener that runs in the amphora.
[SEP]
FILES CHANGED:
octaviaclient/api/v2/octavia.py (+13, -0)
octaviaclient/tests/unit/osc/v2/test_amphora.py (+57, -0)
octaviaclient/osc/v2/amphora.py (+48, -0)
octaviaclient/api/constants.py (+1, -0)
setup.cfg (+1, -0)
releasenotes/notes/add-amphora-stats-show-48bc0fadf08f1057.yaml (+4, -0)
octaviaclient/tests/unit/api/test_octavia.py (+11, -0)
",-0.106814,-0.724023,-0.235025,0.849319,0.334561,-0.343792,0.381736,0.41405,0.248752,-0.51601,0.036637,0.102785,-0.282806,0.317343,0.135186
openstack/octavia,I7169b34d93bc8a265fc74fedcbba67e980285a7e,0,0,0.2,4.1109,0.1667,9,8.5,159,0,Feature,0,0,0,10,0.000993,1.0,0,0.2,7,3,0,0.5455,2.9513,3.67,9.1,17.52,1,0,0.15,1,2.6066,0,0,0,0,0,"Allow AZ to override valid_vip_networks config

Different AZs may have access to different vip networks.
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/load_balancer.py (+4, -1)
doc/source/admin/flavors.rst (+4, -4)
octavia/common/constants.py (+1, -0)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+9, -0)
doc/source/contributor/guides/providers.rst (+2, -1)
octavia/api/drivers/amphora_driver/v2/driver.py (+13, -0)
octavia/api/drivers/amphora_driver/availability_zone_schema.py (+6, -0)
octavia/common/validate.py (+6, -4)
releasenotes/notes/availability-zones-can-override-valid-vip-networks-5566aa4769c158dc.yaml (+5, -0)
",0.201268,0.000914,-0.602803,1.301447,1.367046,0.229722,-0.617942,-0.307621,0.127829,-0.331919,-0.177628,-0.127358,-0.222015,-0.396116,-0.530087
openstack/octavia,I335287da66524d026f0c42086d885b478c568bbd,0,0,1.0,5.4596,0.0641,3,18.67,391,0,Bug Fix,0,0,0,1,0.333333,0.0,0,0.0,7,2,0,0.54,0.9665,4.67,41.35,13.9,1,0,0.7436,1,1.6638,0,0,0,0,0,"Fix the interface filenames for Red Hat amphora images

Code was not using the correct filenames for the 'route',
'route6', 'rule' and 'rule6' files on Red Hat images.
Changed to use config option 'agent_server_network_file'
if it's specified, else the file of the correct name, and
added unit tests for each.

Task: 37881
Story: 2007051
[SEP]
FILES CHANGED:
releasenotes/notes/fix-redhat-amphora-images-interface-files-5ba1be40c65940d9.yaml (+8, -0)
octavia/amphorae/backends/agent/api_server/osutils.py (+38, -14)
octavia/tests/unit/amphorae/backends/agent/api_server/test_osutils.py (+173, -1)
",-0.74554,-1.134691,-0.131396,0.539284,-0.074328,-0.10757,-0.222811,0.092321,0.232825,-0.117383,-0.056776,-0.476096,0.1492,0.510048,-0.065614
openstack/octavia-dashboard,I71c629b5ac3ff0978c832c4d25ff09f8c2a2ea11,0,0,0,2.7726,1.0,2,11.38,615,0,Feature,0,0,0,0,0.0,0.0,0,0.0,0,1,0,0.1667,0.7219,0.0,49.33,14.66,1,0,0.0,0,38.4375,0,0,0,0,0,"translation: drop babel extractor definitions

babel extractors are now registered via python entry points,
so there is no need to declare babel extractors in babel configs.

This change is important to make translation work in Django 2.2.
django-babel does not work with Django 2.2 and looks unmaintained
for over two years. The horizon team is thinking to switch the extractor
to enmerkar (a fork of django-babel) to make extraction of translation
string work again near future. It is important to drop the extractor
definition to make the transition smooth.
[SEP]
FILES CHANGED:
babel-django.cfg (+0, -3)
babel-djangojs.cfg (+0, -12)
",-1.250396,-0.864711,0.217072,0.54512,0.056679,-0.258207,0.581174,-0.159876,-0.472737,0.572444,0.250027,0.090802,-0.302368,-0.290683,0.099475
openstack/octavia-dashboard,If7c7ce79594449637655c4832db50c2c243ce1c0,0,0,0.0,2.8332,0.5625,3,3.85,655,0,CI,0,0,1,1,0.333333,0.2,0,0.0,0,2,0,0.1429,1.5,0.0,24.94,11.93,1,0,0.0,1,38.5294,0,0,0,0,0,"Drop Django 1.11 support

Django 1.11 ends its extended support in April 2020 (which is before
Ussuri release), so horizon drops Django 1.11 support in Ussuri.

tox envs for non-primary Django versions are no longer needed in tox.ini
as testing environments for non-primary Django versions are setup in
the zuul jobs now.

horizon>=17.1.0 is required to use Django 2.2. requirements.txt and
lower-constraints.txt are updated accordingly. for more info. please
refer [1].
Depends-On: https://review.opendev.org/#/c/700733/
[1] https://etherpad.openstack.org/p/Enable_Django22_support_in_Horizon_Plugin
[SEP]
FILES CHANGED:
requirements.txt (+2, -2)
lower-constraints.txt (+4, -4)
tox.ini (+1, -3)
",-2.431288,0.65769,1.338993,-0.352556,-0.516057,0.000855,-0.114699,0.458517,-0.258416,0.222431,-0.240922,-0.130794,-0.521143,-0.13849,0.020872
openstack/octavia,If92988150479a7daf465af5f8df22818664a0fce,0,0,0.2,5.3936,0.9635,15,9.2,365,0,Feature,0,0,1,5,0.009242,0.6667,0,0.1333,5,2,0,0.5347,2.7453,3.47,22.78,14.98,1,0,0.4247,0,1.6591,0,0,0,0,0,"Remove all deprecated driver code that moved to octavia-lib

In https://review.opendev.org/#/c/613709/ octavia was
changed to use octavia-lib for a lot of API driver-related
code and deprecation warnings put in place. Now that
we're in Victoria remove all the deprecation shims and
use octavia-lib exclusively.
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/load_balancer.py (+1, -1)
octavia/tests/unit/api/drivers/test_driver_lib.py (+0, -47)
octavia/api/drivers/data_models.py (+0, -58)
lower-constraints.txt (+0, -1)
octavia/api/drivers/driver_lib.py (+0, -26)
octavia/api/v2/controllers/health_monitor.py (+1, -1)
octavia/tests/unit/api/drivers/test_provider_base.py (+0, -44)
requirements.txt (+0, -1)
octavia/api/v2/controllers/pool.py (+1, -1)
octavia/api/v2/controllers/l7policy.py (+1, -1)
octavia/api/v2/controllers/l7rule.py (+1, -1)
octavia/api/v2/controllers/member.py (+1, -1)
octavia/api/drivers/provider_base.py (+0, -26)
octavia/api/v2/controllers/listener.py (+1, -1)
octavia/tests/unit/api/drivers/test_provider_noop_driver.py (+1, -1)
",-0.446415,0.571739,-0.467317,0.712005,-0.538792,-0.288202,0.883294,-0.312048,-0.478676,-0.03325,0.000676,-0.037772,-0.01228,-0.522302,0.627527
openstack/octavia,I5baf7d18105494259361be1f0f411412071f1d36,0,0,0.8,2.4849,0.0909,2,6.33,185,0,Bug Fix,0,0,0,15,0.011381,0.5,0,0.4,7,1,0,0.5294,0.684,6.0,13.4,15.16,0,0,0.8182,0,15.4167,0,0,0,0,0,"Support haproxy development snapshot version parsing

Fix haproxy version parser in amphora-agent for beta versions (i.e
2.2-dev0)
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+9, -0)
octavia/amphorae/backends/agent/api_server/haproxy_compatibility.py (+1, -1)
",1.012081,-0.074034,-0.506837,-0.142082,0.185002,-0.538482,-0.045671,0.503933,-0.575244,0.139008,-0.533298,0.507935,-0.125872,0.131169,0.097319
openstack/octavia-lib,I32d9f261a219ab4dc95a697d9ab1ff5d9298aee8,0,0,0.1667,4.0943,0.9492,5,7.33,165,0,Feature,0,0,1,6,0.007895,0.0667,0,0.0111,5,2,0,0.0,1.5237,2.8,45.57,10.21,1,0,0.3559,0,2.75,0,0,0,0,0,"Remove all usage of six library

Convert all code to not require six library and instead
use python 3.x logic.
[SEP]
FILES CHANGED:
octavia_lib/tests/unit/api/drivers/test_driver_lib.py (+1, -1)
requirements.txt (+0, -1)
octavia_lib/hacking/checks.py (+1, -32)
octavia_lib/tests/unit/hacking/test_checks.py (+1, -18)
octavia_lib/api/drivers/data_models.py (+0, -4)
",1.624347,-1.013582,0.638658,0.419237,-0.292355,0.175244,0.039421,-0.320991,-0.760935,0.571225,-0.465808,0.193581,-0.232436,-0.066406,-0.016817
openstack/octavia-lib,Ia4e3519f99d9d1bc68d70b1f21173b0b2ec187c1,0,0,0.1429,0.6931,0.0,1,9.33,208,0,Feature,0,0,0,7,0.008547,0.0556,0,0.0079,0,1,0,0.0,0.0,0.0,64.42,6.59,1,0,0.0,0,104.0,0,0,0,0,0,"Complete dropping py27 support goal

This takes care of the last details for dropping py27
support by adding a proper min version of python in setup.cfg.
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",0.996344,-0.89861,-0.033846,0.386245,0.029156,0.514859,-0.011672,-0.31185,-0.28815,-0.106486,-0.310241,0.102984,-0.579579,-0.045734,0.625831
openstack/octavia,I8e03858e32b6c220ce08fe418a613a6c32fe064c,0,0,0.1429,1.6094,0.5,1,14.5,237,0,Feature,0,0,0,7,0.002205,0.3333,0,0.0476,3,1,0,0.5243,0.0,3.0,31.67,12.7,0,0,0.0,0,47.4,0,0,0,0,0,"Increase sleep in health_check in case of DBConnectionError

To avoid false failover of amphorae by healthmanager during db
outage increase time of sleep.

Story: 2007197
Task: 38360
[SEP]
FILES CHANGED:
octavia/controller/healthmanager/health_manager.py (+2, -2)
",1.113417,-1.10975,-0.21401,-0.486554,-0.277246,0.482407,0.155237,-0.040348,0.529149,-0.592977,0.127291,0.111632,-0.149889,-0.014872,0.039086
openstack/python-octaviaclient,I4cb32bcc4681bd99f178d31547af37a7c582d210,1,0,0.4921,5.0106,0.0604,6,10.83,477,0,Bug Fix,0,0,0,63,0.004349,0.0,0,0.0,5,1,0,0.0556,1.9016,3.67,43.56,11.72,0,0,0.5772,0,3.18,0,0,0,0,0,"Fix long CLI error messages

The python-octaviaclient plugin was using ""choices"" for validating
port numbers and weights. The cliff ""choices"" parameter will output
an error that includes every valid ""choice"". For port numbers, this
is 65,000+ valid options.
This patch changes this to produce a more user friendly error
message.

This patch also fixes the listener protocol-port type validation.

Story: 2007218
Task: 38470
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/member.py (+7, -5)
octaviaclient/tests/unit/osc/v2/test_validations.py (+78, -0)
octaviaclient/tests/unit/osc/v2/test_listener.py (+4, -4)
octaviaclient/osc/v2/constants.py (+8, -0)
octaviaclient/osc/v2/validate.py (+38, -0)
octaviaclient/osc/v2/listener.py (+5, -0)
",-0.600054,-1.61078,-0.001205,0.176611,-0.404251,-0.165407,-0.046774,0.160465,0.591982,0.366663,0.066688,0.027906,0.098337,0.201153,-0.053209
openstack/octavia,I04cb2f1f10ec566298834f81df0cf8b100ca916c,0,0,0.5,8.9526,0.1751,73,15.86,714,0,CI,0,0,0,64,0.004373,1.0,0,0.5,7,4,0,0.5192,5.1156,4.58,51.26,14.99,1,0,0.5074,1,0.0924,1,0,0,0,0,"Refactor the failover flows

This patch refactors the failover flows to improve the performance
and reliability of failovers in Octavia.

Specific improvements are:
* More tasks and flows will retry when other OpenStack services are
  failing.
* Failover can now succeed even when all of the amphora are missing
  for a given load balancer.
* It will check and repair the load balancer VIP should the VIP
  port(s) become corrupted in neutron.
* It will cleanup extra resources that may be associated with a
  load balancer in the event of a cloud service failure.

This patch also removes some dead code.

Story: 2003084
Task: 23166
Story: 2004440
Task: 28108
[SEP]
FILES CHANGED:
octavia/common/utils.py (+23, -0)
octavia/controller/worker/v1/flows/load_balancer_flows.py (+399, -51)
octavia/tests/unit/amphorae/backends/agent/api_server/test_loadbalancer.py (+13, -35)
octavia/amphorae/backends/utils/ip_advertisement.py (+183, -0)
octavia/tests/unit/amphorae/drivers/keepalived/test_vrrp_rest_driver.py (+44, -4)
octavia/amphorae/backends/utils/network_utils.py (+83, -0)
etc/octavia.conf (+37, -0)
octavia/controller/worker/v1/tasks/database_tasks.py (+34, -17)
octavia/common/constants.py (+51, -3)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+31, -3)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_common.py (+83, -0)
octavia/network/base.py (+52, -0)
octavia/network/data_models.py (+15, -1)
octavia/network/drivers/noop_driver/driver.py (+69, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+225, -55)
octavia/tests/functional/amphorae/backend/agent/api_server/test_keepalivedlvs.py (+9, -3)
octavia/common/exceptions.py (+19, -1)
octavia/controller/worker/v1/tasks/compute_tasks.py (+73, -11)
octavia/tests/unit/amphorae/drivers/test_noop_amphoraloadbalancer_driver.py (+10, -1)
octavia/amphorae/drivers/driver_base.py (+30, -11)
octavia/compute/drivers/noop_driver/driver.py (+4, -4)
releasenotes/notes/refactor_failover_flow-9efcd854240f71ad.yaml (+11, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_retry_tasks.py (+47, -0)
tools/flow-list.txt (+2, -1)
octavia/amphorae/drivers/keepalived/vrrp_rest_driver.py (+41, -36)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+214, -49)
tools/create_flow_docs.py (+11, -3)
octavia/api/drivers/utils.py (+6, -0)
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+421, -18)
octavia/controller/worker/v1/controller_worker.py (+269, -164)
octavia/controller/worker/v1/flows/amphora_flows.py (+423, -347)
octavia/network/drivers/neutron/base.py (+13, -4)
octavia/tests/unit/controller/worker/v1/tasks/test_network_tasks.py (+379, -37)
octavia/tests/unit/controller/worker/v1/flows/test_load_balancer_flows.py (+231, -5)
octavia/tests/unit/network/drivers/neutron/test_utils.py (+1, -0)
octavia/tests/common/constants.py (+46, -0)
octavia/tests/unit/amphorae/backends/utils/test_network_utils.py (+140, -0)
octavia/amphorae/drivers/noop_driver/driver.py (+14, -5)
octavia/amphorae/backends/agent/api_server/keepalived.py (+4, -0)
octavia/common/config.py (+43, -1)
octavia/network/drivers/neutron/utils.py (+32, -13)
octavia/api/v2/controllers/load_balancer.py (+39, -17)
octavia/tests/unit/controller/worker/v1/tasks/test_compute_tasks.py (+69, -1)
octavia/tests/common/data_model_helpers.py (+3, -1)
octavia/tests/common/sample_data_models.py (+4, -2)
octavia/tests/unit/amphorae/backends/utils/test_ip_advertisement.py (+212, -0)
octavia/tests/unit/amphorae/drivers/haproxy/test_exceptions.py (+52, -0)
octavia/compute/drivers/nova_driver.py (+33, -7)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+42, -18)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+15, -7)
octavia/tests/unit/controller/worker/v1/flows/test_amphora_flows.py (+165, -66)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+3, -2)
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+13, -22)
octavia/amphorae/backends/agent/api_server/amphora_info.py (+12, -62)
octavia/controller/worker/v1/tasks/retry_tasks.py (+74, -0)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+2, -2)
octavia/tests/unit/amphorae/backends/utils/test_network_namespace.py (+116, -0)
octavia/controller/worker/v1/tasks/network_tasks.py (+180, -39)
octavia/opts.py (+1, -0)
octavia/amphorae/backends/agent/api_server/util.py (+71, -1)
octavia/tests/unit/compute/drivers/test_nova_driver.py (+64, -2)
octavia/amphorae/drivers/haproxy/exceptions.py (+4, -3)
octavia/amphorae/backends/utils/network_namespace.py (+50, -0)
octavia/tests/unit/common/test_utils.py (+31, -0)
octavia/api/drivers/amphora_driver/v1/driver.py (+5, -2)
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+148, -59)
octavia/tests/unit/network/drivers/test_network_noop_driver.py (+56, -0)
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+692, -140)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+26, -8)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+128, -0)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+5, -1)
octavia/tests/common/sample_network_data.py (+198, -0)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+26, -8)
",-1.80181,-1.265668,1.235639,-0.045451,-0.001558,0.257469,-0.063977,0.039708,0.322376,-0.054477,-0.017968,0.366189,0.389056,-0.160948,-0.01423
openstack/kolla,I9790cd6c9d142a4a3ced6d5c9a9af621c3892eb0,1,0,0,1.9459,0.0,2,10.12,580,0,Doc,0,0,0,0,0.0,0.0,0,0.0,2,2,0,1.0,0.65,2.0,41.98,11.46,0,0,0.0,1,82.8571,0,0,0,0,0,"Install Fluentd Prometheus plugin out of the box

This plugin [1,2] supports a number of use cases which are likely
to be useful out of the box to users enabling either Monasca or
Prometheus:

1. As a system admin I want to monitor the status of Fluentd
   to ensure that it is functioning normally.
2. As a system admin I want to know the time to response for
   calls made to endpoints defined in HAProxy.

[1] https://docs.fluentd.org/deployment/monitoring-prometheus
[2] https://github.com/fluent/fluent-plugin-prometheus
[SEP]
FILES CHANGED:
releasenotes/notes/add-fluentd-prometheus-plugin-b5c626db667c5675.yaml (+5, -0)
docker/fluentd/Dockerfile.j2 (+1, -0)
",-1.738288,1.046042,0.571148,0.809504,-0.328018,0.004847,0.806499,0.108953,-0.153722,0.117544,0.272522,0.231918,-0.058896,-0.096684,-0.117553
openstack/octavia,I2f00e9402d1e7763ff59de1aa366fb2917d44326,0,0,0.4923,5.0173,0.4467,2,6.0,80,0,Bug Fix,1,0,0,65,0.002907,0.0,0,0.0,1,1,0,0.5143,0.469,1.0,3.34,22.4,0,0,1.0,1,0.5298,0,0,0,0,0,"DNM: debugging zuul issue
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+68, -67)
zuul.d/jobs.yaml (+15, -0)
",3.630887,1.146599,1.401337,-0.85719,-0.127381,0.97547,0.089843,-0.045609,-0.066286,-0.400682,0.425066,-0.12401,0.188841,0.046498,0.040643
openstack/octavia,I6794144b2ba66f3bbd2bc948d95d1019286c9889,0,0,0.4848,2.1972,0.5,1,4.0,462,0,Bug Fix,1,0,0,66,0.002932,0.0,0,0.0,5,1,0,0.5094,0.0,5.0,48.22,9.29,0,0,1.0,0,51.3333,0,0,0,0,0,"Fix a ValueError with mock 4.0.1

Mock version 4.0.1 raises a ValueError with the current mock ""spec""
for the secrets.Secret[1]. This patch resolves this issue by running
""dir(secrets.Secret)"" for mock. This is what mock should be doing
automatically, but this object appears to be confusing it.

[1] https://zuul.opendev.org/t/openstack/build/ \
    c5fd6cadc9bf4b3b9ea81372ef047246/log/job-output.txt#4605
[SEP]
FILES CHANGED:
octavia/tests/unit/certificates/manager/test_barbican_legacy.py (+4, -4)
",-1.312407,0.930906,0.100824,-0.548912,-0.450465,0.087276,0.961723,0.011493,0.421695,0.447772,0.336689,-0.199147,-0.122593,0.129179,-0.054913
openstack/octavia,I5d3c4d5280916916e95120cfba6fc076a1650cf4,0,0,0.125,3.5264,0.2424,4,8.0,174,0,Bug Fix,0,0,0,8,0.002517,0.4,0,0.05,5,1,0,0.5047,1.9569,4.0,3.08,18.2,1,1,0.0,0,5.1176,0,0,0,0,0,"[Amphorav2] Fix noop driver case

Fix amphora creation with amphora_noop_driver
and network_noop_driver.

Story: 2005072
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+7, -3)
octavia/network/drivers/noop_driver/driver.py (+4, -1)
octavia/amphorae/drivers/noop_driver/driver.py (+6, -3)
octavia/amphorae/drivers/driver_base.py (+8, -1)
",0.465956,0.425665,-0.782407,-0.042723,0.866531,0.249712,-0.904704,0.030538,-0.285058,-0.509854,0.351232,-0.073305,-0.377395,0.062916,-0.088846
openstack/octavia,I2fd51664336dca51f134b3fccd3e8c936b809839,0,0,0,2.9957,0.0526,2,16.0,171,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,1,0,0.5,0.6292,4.5,31.97,16.4,0,0,0.8421,0,8.55,0,0,0,0,0,"HTTPS HMs need the same validation path as HTTP

(cherry picked from commit 7dd6f8b846015e6fbe75af09ee3a5108741b1626)
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+16, -0)
octavia/api/v2/controllers/health_monitor.py (+2, -1)
",0.26049,0.178508,-1.830328,-1.981242,1.845714,0.623677,0.29776,-0.559532,-0.009744,0.116605,-0.871785,0.436112,-0.053055,-0.537058,-0.470934
openstack/octavia,I10db6226750f7b7c703067d2ab82eea3a9875112,0,0,0,7.1229,0.0952,29,6.0,398,0,Doc,0,0,1,0,0.0,0.5,0,0.0,4,6,0,0.4954,2.8559,2.97,-29.55,14.62,1,0,0.2107,1,0.321,0,0,0,0,0,"Add oslo middleware healthcheck to Octavia API

healthcheck middleware adds a /healthcheck url that allows
unauthenticated access to provide a simple check when running
octavia-api behind a load balancer

https://docs.openstack.org/oslo.middleware/latest/reference/healthcheck_plugins.html

Co-authored-by: Michael Johnson <johnsomor@gmail.com>
[SEP]
FILES CHANGED:
octavia/common/config.py (+3, -0)
doc/source/admin/index.rst (+1, -0)
octavia/api/v2/controllers/availability_zones.py (+6, -6)
octavia/api/v2/controllers/load_balancer.py (+11, -10)
octavia/tests/functional/api/test_healthcheck.py (+261, -0)
etc/octavia.conf (+21, -0)
requirements.txt (+3, -3)
octavia/common/keystone.py (+2, -1)
octavia/api/app.py (+5, -4)
octavia/api/v2/controllers/flavors.py (+6, -6)
doc/source/admin/healthcheck.rst (+599, -0)
octavia/api/v2/controllers/base.py (+5, -4)
octavia/api/v2/controllers/provider.py (+8, -7)
octavia/api/v2/controllers/quotas.py (+8, -7)
lower-constraints.txt (+3, -3)
octavia/api/v2/controllers/availability_zone_profiles.py (+6, -6)
octavia/api/v2/controllers/health_monitor.py (+6, -6)
octavia/db/healthcheck.py (+37, -0)
octavia/api/v2/controllers/pool.py (+9, -8)
releasenotes/notes/add-healthcheck-middleware-6c09150bddd3113f.yaml (+6, -0)
octavia/api/healthcheck/healthcheck_plugins.py (+47, -0)
octavia/api/root_controller.py (+20, -4)
octavia/api/v2/controllers/l7policy.py (+9, -8)
octavia/api/v2/controllers/l7rule.py (+6, -6)
octavia/api/v2/controllers/member.py (+7, -7)
octavia/api/v2/controllers/amphora.py (+8, -7)
setup.cfg (+2, -0)
octavia/api/v2/controllers/listener.py (+10, -9)
octavia/api/v2/controllers/flavor_profiles.py (+6, -6)
",-1.123019,0.939958,-0.909617,0.505829,-0.315196,-0.618725,0.275516,0.383384,0.21708,-0.400028,-0.171413,-0.094804,0.109774,-0.023669,0.023802
openstack/python-octaviaclient,I229392b5b324e92909ea417696a3652492274613,0,0,0.1818,3.7842,0.0233,5,17.0,348,0,Feature,0,0,0,11,0.001086,0.3333,0,0.0606,5,2,0,0.1053,2.004,3.6,41.94,13.07,0,0,0.3953,1,7.9091,0,0,0,0,0,"Add --long to amphora-list to show more columns

Often when looking at lists of amphorae, I really need to quickly browse
them based on image/zone/compute_id, and this makes it much easier and
fewer API-roundtrips to get that data. The API already returns it, we
can just show it (optionally)!
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/constants.py (+1, -0)
octaviaclient/tests/unit/osc/v2/test_amphora.py (+15, -1)
octaviaclient/osc/v2/amphora.py (+9, -0)
octaviaclient/osc/v2/constants.py (+12, -0)
releasenotes/notes/amphora-list-long-option-55390b5abef5b82e.yaml (+5, -0)
",1.055758,-1.655872,0.435563,0.205713,-0.732338,-0.538012,0.999245,-0.765924,-0.566244,0.01082,-0.537952,-0.482154,0.284421,-0.125516,-0.016832
openstack/octavia,I77da6f14063877af0077f2c12df1aab5d5ead187,0,0,0,5.624,0.1051,31,20.0,463,0,CI,0,0,1,0,0.0,0.6667,0,0.0,7,8,0,0.4909,4.0066,3.42,34.26,17.33,1,0,0.4855,1,1.6715,0,0,0,0,0,"Add ability to set TLS cipher list for listeners

Listeners will now be able to each be assigned their own OpenSSL
cipher string with a new field: tls_ciphers.  There is also a new
configuration option, default_listener_ciphers, which specifies the
cipher string to assign to new listeners when one is not explicitly
specified.

Depends-On: Id5f4c20abd40dd092558a711987953012d4ae67f
Story: 2006627
Task: 36839
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+16, -0)
api-ref/source/v2/examples/listener-update-curl (+1, -1)
api-ref/source/v2/examples/listener-update-request.json (+2, -1)
octavia/common/config.py (+4, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/common/sample_data_models.py (+8, -3)
etc/octavia.conf (+6, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+7, -2)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+4, -0)
requirements.txt (+1, -1)
octavia/common/constants.py (+9, -0)
api-ref/source/v2/examples/listener-create-response.json (+2, -1)
releasenotes/notes/add-default-ciphers-2eb70b34290711be.yaml (+7, -0)
octavia/tests/functional/api/v2/test_load_balancer.py (+4, -1)
api-ref/source/v2/examples/listener-update-response.json (+2, -1)
octavia/amphorae/backends/agent/api_server/util.py (+1, -1)
octavia/tests/unit/api/drivers/test_utils.py (+42, -4)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+6, -1)
api-ref/source/v2/examples/listener-show-response.json (+2, -1)
octavia/db/models.py (+1, -0)
octavia/api/v2/types/listener.py (+4, -0)
api-ref/source/v2/examples/listener-create-request.json (+2, -1)
api-ref/source/v2/listener.inc (+6, -0)
lower-constraints.txt (+1, -1)
api-ref/source/v2/examples/listener-create-curl (+1, -1)
octavia/db/prepare.py (+6, -0)
api-ref/source/v2/examples/listeners-list-response.json (+2, -1)
octavia/common/data_models.py (+2, -1)
octavia/api/root_controller.py (+5, -1)
octavia/db/migration/alembic_migrations/versions/7c36b277bfb0_add_listener_ciphers_column.py (+35, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+56, -4)
",-1.720999,-0.32668,-0.498915,-0.033153,0.998779,0.139531,0.213319,-0.087723,0.84561,0.245002,0.15221,-0.013827,0.082695,0.057214,-0.001438
openstack/octavia,I5dec631d3e66e1dfb6b8741caea89938ee18a7d8,1,0,0.4776,3.4657,0.0,4,23.33,456,0,Feature,0,0,0,67,0.002975,0.25,0,0.1194,3,4,0,0.4865,1.5936,2.0,38.12,17.9,0,0,0.0,0,14.25,0,0,0,0,0,"Stop ""dnf makecache"" in the amphora images

On base operating systems that use DNF there can be a systemd timer
that attempts to call out and update the dnf cache every hour.
This patch adds an diskimage-builder element that disables this
timer as most amphora will not be successful in updating this cache
because they do not have network access or DNS services avaialable.

Story: 2007408
Task: 39019
[SEP]
FILES CHANGED:
elements/disable-makecache/post-install.d/80-disable-makecache (+18, -0)
diskimage-create/diskimage-create.sh (+5, -0)
elements/disable-makecache/README.rst (+6, -0)
elements/disable-makecache/svc-map (+2, -0)
",-0.477516,-1.586768,-0.096623,0.517398,-0.313755,-0.422565,0.714677,-0.018674,0.189288,0.045336,0.209387,0.018808,0.429384,0.086431,-0.107535
openstack/python-octaviaclient,Id881071803e580c10ca3ff33689d01b8b305b3e8,0,0,0.4853,3.9703,0.6923,18,15.5,399,0,CI,0,0,1,68,0.003016,0.3333,0,0.1618,5,2,0,0.1,4.1365,4.28,58.74,11.36,0,0,0.9615,0,7.5283,0,0,0,0,0,"Remove the dependency on the ""mock"" package

Now that we are python3 only, we should move to using the built
in version of mock that supports all of our testing needs and
remove the dependency on the ""mock"" package.

This patch moves all references to ""import mock"" to
""from unittest import mock"". It also cleans up some new line
inconsistency.
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/fakes.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_flavorprofile.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_quota.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_provider.py (+1, -2)
test-requirements.txt (+0, -1)
octaviaclient/tests/unit/osc/v2/test_listener.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+1, -2)
octaviaclient/tests/fakes.py (+1, -2)
lower-constraints.txt (+0, -2)
octaviaclient/tests/unit/osc/v2/test_availabilityzoneprofile.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_member.py (+1, -3)
octaviaclient/tests/unit/osc/v2/test_l7rule.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_availabilityzone.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_amphora.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_health_monitor.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_flavor.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_l7policy.py (+1, -2)
octaviaclient/tests/unit/osc/v2/test_pool.py (+1, -2)
",0.072593,-0.897564,-0.094457,0.78133,-0.311395,0.020305,0.700673,-0.334902,-0.406264,0.281132,0.08186,0.195083,-0.082347,0.176123,0.450593
openstack/python-octaviaclient,I505b3e139217ff7d4952880dec304eb5667ae310,0,0,0.4783,5.8377,0.2076,33,20.33,450,0,CI,0,0,1,69,0.003053,1.0,0,0.4783,5,5,0,0.0952,3.5692,3.09,30.87,16.0,0,0,0.1637,1,1.312,0,0,0,0,0,"Align python-octaviaclient to octavia coding style

When removing the ""mock"" module from python-octaviaclient, it was
clear that python-octaviaclient did not follow the same coding
style guides as the main octavia project.

This patch corrects that by updating the code style checks in
python-octaviaclient to those of the octavia repository and
corrects any style issues found by the new tests.
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/flavor.py (+1, -1)
octaviaclient/tests/unit/osc/v2/test_quota.py (+2, -2)
octaviaclient/tests/unit/osc/v2/test_validations.py (+2, -4)
.pylintrc (+99, -0)
octaviaclient/tests/functional/base.py (+1, -1)
test-requirements.txt (+6, -2)
octaviaclient/osc/v2/load_balancer.py (+1, -1)
octaviaclient/hacking/checks.py (+1, -1)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+3, -3)
octaviaclient/osc/v2/utils.py (+15, -20)
octaviaclient/tests/unit/osc/v2/test_member.py (+2, -2)
octaviaclient/tests/unit/osc/v2/test_l7rule.py (+2, -2)
octaviaclient/osc/plugin.py (+2, -3)
octaviaclient/tests/unit/test_hacking.py (+1, -1)
octaviaclient/api/v2/octavia.py (+2, -3)
octaviaclient/tests/unit/osc/v2/test_health_monitor.py (+2, -2)
octaviaclient/osc/v2/amphora.py (+1, -2)
octaviaclient/api/exceptions.py (+1, -0)
octaviaclient/osc/v2/l7policy.py (+1, -1)
tools/coding-checks.sh (+66, -0)
octaviaclient/tests/unit/osc/v2/test_listener.py (+2, -2)
lower-constraints.txt (+6, -2)
octaviaclient/osc/v2/l7rule.py (+1, -1)
octaviaclient/osc/v2/availabilityzone.py (+1, -1)
octaviaclient/osc/v2/member.py (+1, -1)
octaviaclient/osc/v2/health_monitor.py (+1, -1)
octaviaclient/osc/v2/quota.py (+1, -1)
octaviaclient/tests/unit/osc/v2/test_flavor.py (+2, -2)
octaviaclient/tests/unit/osc/v2/test_l7policy.py (+2, -2)
octaviaclient/osc/v2/listener.py (+1, -1)
octaviaclient/tests/unit/osc/v2/test_pool.py (+2, -2)
tox.ini (+39, -3)
octaviaclient/osc/v2/pool.py (+1, -1)
",-1.761636,-0.281002,-0.320342,1.239111,0.598866,-0.689784,0.183842,0.162351,-0.402899,0.054826,0.331102,0.287996,-0.130946,-0.007622,0.544996
openstack/octavia-lib,Ie7567134a7c0ffae525d0282773e4c90a3f2d62b,0,0,0.4714,2.1972,0.75,4,15.5,399,0,CI,0,0,1,70,0.003051,0.0556,0,0.0262,5,2,0,0.0,1.8113,2.0,57.38,11.36,0,0,0.875,0,44.3333,0,0,0,0,0,"Remove the dependency on the ""mock"" package

Now that we are python3 only, we should move to using the built
in version of mock that supports all of our testing needs and
remove the dependency on the ""mock"" package.

This patch moves all references to ""import mock"" to
""from unittest import mock"". It also cleans up some new line
inconsistency.
[SEP]
FILES CHANGED:
octavia_lib/tests/unit/api/drivers/test_driver_lib.py (+1, -2)
test-requirements.txt (+0, -1)
octavia_lib/tests/unit/base.py (+1, -2)
lower-constraints.txt (+0, -1)
",0.072593,-0.897564,-0.094457,0.78133,-0.311395,0.020305,0.700673,-0.334902,-0.406264,0.281132,0.08186,0.195083,-0.082347,0.176123,0.450593
openstack/octavia,Ia9fec4e72c00f7086489b245d9dc50ed9c27f12a,1,0,0.1667,1.0986,0.5,1,5.08,417,0,Bug Fix,0,0,0,12,0.00118,0.5,0,0.0833,4,1,0,0.4911,0.0,4.0,74.08,7.28,0,0,0.0,0,139.0,0,0,0,0,0,"Fix padding logic for UDP health daemon

Should have done ""pad to 8 characters"" on the hex conversion, but it was
instead hardcoded to pad a single `0`, which is right in a lot of cases
but not all.

For example:
>>> ip1 = ipaddress.ip_address('98.136.140.23')
>>> ip2 = ipaddress.ip_address('10.1.1.1')
>>> ""%X"" % ip1._ip
'62888C17'
>>> ""%X"" % ip2._ip
'A010101'
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+1, -1)
",-2.086844,-0.444667,0.355271,-0.71334,0.187399,0.309271,-0.900795,-0.296592,-0.150242,0.643074,-0.145637,-0.46475,0.048446,0.647343,-0.017784
openstack/octavia-dashboard,Id4457d164e6899ffe4b9e4a0332b771d0ee33770,0,0,0.0,5.6348,0.0896,11,5.75,212,0,CI,0,0,0,1,0.000806,0.5,0,0.0,7,4,0,0.125,3.0226,5.55,9.73,17.95,0,0,0.0,1,0.7571,0,0,0,0,0,"Availability zone support

Ability to create a LB in a specific AZ and see AZ attribute
of load balancers.

Depends-On: https://review.opendev.org/#/c/714345/
[SEP]
FILES CHANGED:
releasenotes/notes/add-az-support-efdd4e7c5dccef21.yaml (+4, -0)
octavia_dashboard/static/app/core/openstack-service-api/lbaasv2.service.js (+20, -0)
octavia_dashboard/api/rest/lbaasv2.py (+35, -20)
octavia_dashboard/static/dashboard/project/lbaasv2/loadbalancers/loadbalancers.module.js (+8, -0)
octavia_dashboard/static/app/core/openstack-service-api/lbaasv2.service.spec.js (+8, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/loadbalancer/loadbalancer.controller.spec.js (+69, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/loadbalancers/details/detail.html (+5, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/loadbalancer/loadbalancer.controller.js (+32, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+33, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+18, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/loadbalancer/loadbalancer.html (+22, -0)
",0.197246,1.76771,-0.871656,0.431681,-1.070725,0.394786,0.256375,-0.146785,0.506736,-0.267375,-0.632521,0.056751,0.11494,-0.206218,-0.291002
openstack/kolla-ansible,Ia5198e4f2c12290546be7204e94d6bc72c7868a6,0,1,1.0,4.4543,0.1059,7,13.4,485,0,Bug Fix,0,0,0,1,0.005155,0.6667,0,0.6667,4,4,0,0.5,2.2149,2.71,45.5,12.52,1,0,0.0353,1,5.6395,0,6,0,11,0,"Glance Cinder backend

Implement proper support for the Glance's Cinder backend on demand
instead of enabling a broken support by default.

There were several bits missing from the original logic that kept
the Cinder backend kind of available but broken in multiple ways.
For details, please see the bug reports and the attached release
note.

Docs included as well.

Closes-Bug: #1928669
Closes-Bug: #1831002
Related-Bug: #1854194
[SEP]
FILES CHANGED:
releasenotes/notes/glance-cinder-backend-9bc36a50166801f4.yaml (+31, -0)
ansible/group_vars/all.yml (+2, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+9, -2)
tests/templates/globals-default.j2 (+1, -0)
zuul.d/base.yaml (+1, -1)
doc/source/reference/shared-services/glance-guide.rst (+24, -0)
ansible/roles/glance/defaults/main.yml (+8, -5)
",-1.395088,-1.698365,0.167548,-0.104002,-0.68313,0.306004,-0.557521,0.57285,0.161231,0.360098,0.117154,-0.001678,0.348073,0.101007,0.232468
openstack/octavia-lib,Ie54640201a0f4905d19841af5913972646b317bf,0,0,0,3.8067,0.0455,4,9.75,373,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,2,0,0.0,1.7415,3.0,29.91,13.13,1,0,0.5227,1,8.2889,0,0,0,0,0,"Add TLS protocols for listener and pool model

Parameter added to the listener and pool model for TLS protocols.
Constants TLS_VERSIONS, SSL_VERSION_3, TLS_VERSION_1,
TLS_VERSION_1_1, TLS_VERSION_1_2, and TLS_VERSION_1_3 were added.

Co-authored-by: Steven Glasford <stevenglasford@gmail.com>
Story: 2006733
Task: 37186
[SEP]
FILES CHANGED:
octavia_lib/common/constants.py (+6, -0)
octavia_lib/tests/unit/api/drivers/test_data_models.py (+23, -0)
releasenotes/notes/add-tls-protocols-for-listener-and-pool-model-e9083b85afc62ef0.yaml (+9, -0)
octavia_lib/api/drivers/data_models.py (+4, -2)
",-2.184903,0.725644,-1.248372,0.798942,0.484491,0.658612,-1.109374,0.570894,0.708466,0.411511,0.188014,-0.061434,0.09128,0.552319,-0.078064
openstack/octavia-lib,If11b38493aacc7b888a6b64bf50c1a2782efd9ae,0,0,0.0,4.4886,0.4773,5,6.4,232,0,Bug Fix,0,0,1,1,0.125,0.1818,0,0.0,5,3,0,0.0,1.9611,2.2,60.22,5.06,1,0,0.3182,1,2.6067,1,0,0,0,0,"Update hacking for Python3

The repo is Python 3 now, so update hacking to version 3.0 which
supports Python 3.

Fix problems found.

Update local hacking checks for new flake8.
[SEP]
FILES CHANGED:
octavia_lib/hacking/checks.py (+19, -19)
test-requirements.txt (+1, -1)
octavia_lib/tests/unit/hacking/test_checks.py (+0, -14)
octavia_lib/tests/unit/api/drivers/test_data_models.py (+6, -6)
tox.ini (+20, -2)
",1.093932,-1.996094,0.419637,-0.292738,-0.531082,0.089522,-0.426921,0.523183,-0.635497,0.70058,-0.675657,-0.031452,-0.260131,0.208148,0.317954
openstack/python-octaviaclient,Ibe75f412a077325e926366897dc505b6ab34dd6f,0,0,0.0,4.5643,0.6526,4,7.0,310,0,Bug Fix,0,0,1,2,0.020833,0.1739,0,0.0,3,3,0,0.0909,1.5552,1.25,50.67,5.66,1,0,0.2737,1,3.2292,1,0,0,0,0,"Update hacking for Python3

The repo is Python 3 now, so update hacking to version 3.0 which
supports Python 3.

Fix problems found.

Update local hacking checks for new flake8.

Remove check check_python3_no_iteritems since this repo is now python3
only.
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
octaviaclient/tests/unit/test_hacking.py (+0, -24)
octaviaclient/hacking/checks.py (+16, -35)
tox.ini (+16, -2)
",0.356644,-1.976431,0.198479,-0.181343,-0.38873,-0.157996,-0.355597,0.330796,-0.460978,0.351998,-0.53492,-0.395285,-0.205945,0.351701,0.277371
openstack/octavia,I8626c0338d4ad7d11bf5d56b022136cb4513d37e,0,0,0.2308,3.8501,0.2609,10,8.0,104,0,Doc,0,0,0,13,0.001278,0.0,0,0.0,4,4,0,0.4956,2.1919,3.6,-23.36,18.2,0,0,0.0,1,2.2128,0,0,0,0,0,"Add availability-zone to loadbalancer object docs
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+18, -6)
api-ref/source/v2/examples/loadbalancer-create-request.json (+1, -0)
api-ref/source/v2/loadbalancer.inc (+4, -0)
api-ref/source/v2/availabilityzone.inc (+5, -5)
api-ref/source/v2/examples/loadbalancer-create-curl (+1, -1)
api-ref/source/v2/examples/loadbalancer-create-response.json (+1, -0)
api-ref/source/v2/examples/loadbalancer-full-create-response.json (+1, -0)
api-ref/source/v2/examples/loadbalancers-list-response.json (+1, -0)
api-ref/source/v2/examples/loadbalancer-full-create-request.json (+1, -0)
api-ref/source/v2/examples/loadbalancer-show-response.json (+1, -0)
",2.817509,0.954487,0.911492,1.173768,0.862686,-0.228706,0.869993,0.739578,0.951873,-0.530466,-0.403105,0.003668,-0.262692,0.253453,-0.193432
openstack/octavia-dashboard,Ie05e0d9989b26369aaa35ef32ce6140e5228902a,0,0,0.0,1.0986,0.5,1,3.25,364,0,Bug Fix,0,0,0,2,0.105263,0.0526,1,0.0,0,1,0,0.1111,0.0,0.0,36.51,11.56,1,0,0.0,0,121.3333,0,0,0,0,0,"Fix pyScss version in lower-constraints.txt

Horizon requires  pyScss>=1.3.7 [1] but lower-constraints.txt
in octavia-dashboard uses pyScss 1.3.4 which can cause the
failure in future. So this patch update pyScss version in
lower-constraints.txt to sync the change.

[1] https://review.opendev.org/#/c/715241/
[SEP]
FILES CHANGED:
lower-constraints.txt (+1, -1)
",-1.253357,1.649721,-0.355267,0.456684,-0.198389,-0.241787,0.267416,0.237839,-0.096204,0.472636,0.216242,-0.1934,-0.349807,0.11577,0.228832
openstack/octavia,Iedb7774bfb8d70ea307d6a513248e1fe2389fa34,0,0,0.0,5.204,0.1713,24,19.0,441,0,CI,0,0,0,1,0.00361,0.5455,0,0.0,7,7,0,0.4912,3.8195,3.75,36.16,16.72,1,0,0.442,1,2.4231,0,0,0,0,0,"Add ability to specify TLS cipher list for pools

Pools can now be each be assigned an OpenSSL cipher string with the
field tls_ciphers.  A new configuration option, default_pool_ciphers,
specifies what cipher string to use for new tls-enabled pools
if one is not explicitly specified at time of creation.

Depends-On: I77da6f14063877af0077f2c12df1aab5d5ead187
Story: 2006627
Task: 37172
[SEP]
FILES CHANGED:
api-ref/source/v2/examples/pools-list-response.json (+2, -1)
octavia/api/v2/types/pool.py (+4, -0)
api-ref/source/v2/examples/pool-update-curl (+1, -1)
octavia/common/config.py (+4, -0)
octavia/tests/common/sample_data_models.py (+2, -1)
releasenotes/notes/pool-ciphers-73a347942e31788b.yaml (+7, -0)
etc/octavia.conf (+6, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+15, -6)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+2, -0)
api-ref/source/v2/examples/pool-show-response.json (+2, -1)
api-ref/source/v2/examples/pool-create-curl (+1, -1)
octavia/tests/unit/api/drivers/test_utils.py (+0, -8)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+7, -2)
api-ref/source/v2/pool.inc (+6, -0)
octavia/db/models.py (+1, -0)
octavia/db/prepare.py (+2, -0)
api-ref/source/v2/examples/pool-update-request.json (+2, -1)
api-ref/source/v2/examples/pool-create-request.json (+2, -1)
octavia/tests/functional/db/test_repositories.py (+7, -5)
octavia/common/data_models.py (+2, -1)
api-ref/source/v2/examples/pool-update-response.json (+2, -1)
api-ref/source/v2/examples/pool-create-response.json (+2, -1)
octavia/db/migration/alembic_migrations/versions/fbd705961c3a_add_pool_ciphers_column.py (+35, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+36, -0)
",-1.631849,-0.397267,-0.438167,0.023569,0.947769,0.000171,-0.006326,0.022164,0.928173,0.522929,-0.017579,-0.087561,0.171532,0.211897,-0.061537
openstack/octavia-dashboard,I3668f3dc5d3eb6a288994386294cc018035540c8,1,0,0.75,1.6094,0.5,2,13.67,297,0,Feature,0,0,0,16,0.012039,0.3333,0,0.25,7,2,0,0.1,1.0,6.5,65.03,12.3,0,0,0.0,0,59.4,0,0,0,0,0,"Add missing fields for HTTPS health monitors

Some fields (http method, expected codes, url path) are missing in
health monitor form when type is HTTPS.
These are valid parameters for HTTP and HTTPS health monitors.

Story: 2007512
Task: 39292
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/monitor/monitor.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+1, -1)
",0.009273,-1.03484,-0.652308,0.570709,0.217427,0.350125,-0.667803,-0.023369,0.449068,0.120378,-0.344274,-0.138548,0.693219,0.296909,-0.550144
openstack/python-octaviaclient,I2f4d7644588316c30e639dcb093c5638b5b5526c,0,0,0.0,3.4012,0.8621,3,8.5,353,0,Feature,0,0,1,3,0.015707,0.05,0,0.0,1,3,0,0.087,1.3142,0.33,52.23,10.46,1,0,0.0,0,11.7667,1,0,0,0,0,"Cleanup py27 support

Make a few cleanups:
- Remove python 2.7 stanza from setup.py
- Add requires on python >= 3.6 to setup.cfg so that pypi and pip
  know about the requirement
- Remove obsolete section from setup.cfg
- Update classifiers
- Update requirements, no need for python_version anymore
[SEP]
FILES CHANGED:
setup.py (+0, -9)
doc/requirements.txt (+1, -2)
setup.cfg (+3, -14)
",-0.49991,-0.724149,-0.02535,0.351497,0.299946,-0.285204,-0.295182,-0.02598,-0.67276,0.437744,-0.5782,-0.292251,0.32006,0.79429,0.32263
openstack/python-octaviaclient,Ida05b7a07c5a9adf81c95be1fe44e32b82793303,0,0,0,3.6889,0.1282,6,33.0,254,0,CI,0,0,0,0,0.0,0.25,0,0.0,5,2,0,0.0833,2.0217,3.5,6.7,24.11,0,0,0.4359,1,6.35,0,0,0,0,0,"Add the ability to specify the cipher list for a listener

Added an optional argument --tls-ciphers for passing
an OpenSSL cipher string into the octavia commandline
client

Story: 2006627
Task: 37176
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/constants.py (+1, -0)
octaviaclient/tests/unit/osc/v2/test_listener.py (+12, -4)
octaviaclient/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/listener.py (+12, -0)
octaviaclient/osc/v2/utils.py (+1, -0)
releasenotes/notes/add-ability-set-listener-cipher-list-fe379d0d0821ed42.yaml (+6, -0)
",0.534155,-1.598496,-0.618653,0.009687,-0.104682,-0.18806,-0.604584,0.297723,0.766825,-0.059934,-0.254471,0.22674,0.031174,0.233499,0.149495
openstack/python-octaviaclient,Ifd2964b17e8b5704e79a9ef0d8cd3000f637a154,0,0,0.0,3.7136,0.175,6,39.0,283,0,CI,0,0,0,1,0.025,0.2,0,0.0,5,2,0,0.08,2.1559,3.5,15.4,24.83,0,0,0.45,1,6.9024,0,0,0,0,0,"Add the ability to specify the cipher list for a pool

Added an optional argument --tls-ciphers for passing
an OpenSSL cipher string into the octavia commandline
client when creating or updating a pool

Story: 2006627
Task: 37178
[SEP]
FILES CHANGED:
releasenotes/notes/add-ability-set-pool-cipher-list-70128f983506fbdb.yaml (+6, -0)
octaviaclient/tests/unit/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/utils.py (+1, -0)
octaviaclient/tests/unit/osc/v2/test_pool.py (+10, -5)
octaviaclient/osc/v2/pool.py (+12, -0)
",0.357978,-1.517924,-0.569045,0.242562,0.031887,-0.088077,-0.472824,0.27506,0.777906,-0.11252,-0.335973,0.282362,0.082718,0.195503,0.139094
openstack/oslo.cache,Ib84b3db83e8c50c7929874c63177c94f459a1a2c,0,0,0,3.7136,0.0,3,9.2,382,0,CI,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0,0.7219,2.67,20.94,15.85,1,0,0.8,0,9.3171,0,0,0,0,0,"Adding functional tests for memcache_pool backend

Introducing the needed changes to functional tests to run
them against the memcache_pool backend.

These changes introduced a new zuul job related to memcache
to isolate this part during CI and get clear outputs.

Co-authored-by: Rados≈Çaw Piliszek <radoslaw.piliszek@gmail.com>
[SEP]
FILES CHANGED:
oslo_cache/tests/functional/memcache_pool/__init__.py (+0, -0)
oslo_cache/tests/functional/memcache_pool/test_cache_backend.py (+32, -0)
.zuul.yaml (+8, -0)
",-0.995879,-0.374046,-0.638862,0.571372,-0.326667,-0.099095,0.266601,0.298655,-0.15422,-0.223589,0.459461,0.181524,0.156255,0.114227,-0.164126
openstack/octavia,I32b6561c78c153a4b7e73b1a4b83e045fbe97fb6,0,0,0.4648,5.6664,0.0104,14,14.75,387,0,Feature,0,0,0,71,0.003093,0.6667,0,0.3099,6,4,0,0.487,3.0274,3.71,47.04,14.71,1,0,0.5382,1,1.3391,0,0,0,0,0,"Add amphora delete API

This patch adds an amphora delete API. It can be used to delete
extra ""spare"" amphora after the feature has been disabled.

A followup patch will be required for the amphorav2 path as the
amphorav2 failover patch, which is required for the amphora delete
flow, has not yet merged.

Story: 2008014
Task: 40666
[SEP]
FILES CHANGED:
api-ref/source/v2/examples/amphora-delete-curl (+1, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/functional/api/v2/test_amphora.py (+96, -0)
octavia/tests/functional/db/test_repositories.py (+23, -0)
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+28, -0)
releasenotes/notes/add-amphora-delete-69badba140f7b228.yaml (+4, -0)
octavia/controller/worker/v1/controller_worker.py (+20, -0)
octavia/db/repositories.py (+21, -0)
api-ref/source/v2/amphora.inc (+43, -0)
octavia/api/root_controller.py (+4, -1)
octavia/api/v2/controllers/amphora.py (+27, -1)
octavia/policies/amphora.py (+7, -0)
octavia/controller/queue/v1/endpoints.py (+4, -0)
octavia/tests/unit/controller/queue/v1/test_endpoints.py (+5, -0)
",-0.598737,-1.749478,-0.330892,0.15032,-0.125867,-0.079295,-0.12356,0.351916,0.143221,-0.027387,0.052311,0.505652,-0.128311,0.403669,0.034656
openstack/python-octaviaclient,I415d2438ddfe994631ef02637c216f4579dd81a1,0,0,0.4583,4.625,0.0198,8,4.25,197,0,Feature,0,0,0,72,0.003098,0.25,0,0.1146,5,3,0,0.0769,2.2905,2.88,-11.47,22.88,0,0,0.4455,1,1.9314,0,0,0,0,0,"Add amphora delete command

This patch adds the ""openstack loadbalancer amphora delete"" command.

Depends-On: https://review.opendev.org/718293
[SEP]
FILES CHANGED:
releasenotes/notes/add-amphora-delete-0fe5f2097da92b5c.yaml (+4, -0)
octaviaclient/api/v2/octavia.py (+14, -0)
octaviaclient/tests/unit/osc/v2/test_amphora.py (+36, -0)
octaviaclient/osc/v2/amphora.py (+31, -0)
octaviaclient/osc/v2/constants.py (+1, -0)
octaviaclient/osc/v2/utils.py (+3, -2)
setup.cfg (+1, -0)
octaviaclient/tests/unit/api/test_octavia.py (+9, -0)
",-0.228843,1.905641,-1.36574,0.339556,-0.614195,0.567691,-0.232382,-0.103048,0.408857,-0.558922,-0.021518,0.452236,-0.105511,-0.037765,0.060354
openstack/octavia-dashboard,Icead9106b06ae7610301a121e51dc5fe1a0e4056,0,0,0.0,5.2364,0.0695,15,9.75,308,0,CI,0,0,0,1,0.022222,0.5,0,0.0,7,4,0,0.1818,3.2418,6.13,32.08,12.11,1,0,0.0,1,1.6383,0,0,0,0,0,"Add ciphers options for listeners and pools

Added an option to specify the TLS ciphers used by listeners
and pools. It is specifed through a string in OpenSSL syntax.

Co-authored-by: Steven Glasford <stevenglasford@gmail.com>
Story: 2006627
Task: 37193
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.html (+17, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.controller.js (+45, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.controller.spec.js (+40, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/pools/details/detail.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/listeners/listeners.module.js (+2, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.controller.js (+1, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+2, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/listeners/details/detail.html (+2, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+7, -2)
releasenotes/notes/add-ciphers-options-for-listeners-and-pools-8440eaf5a551c44c.yaml (+5, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.html (+18, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/pools/pools.module.js (+2, -1)
octavia_dashboard/api/rest/lbaasv2.py (+12, -4)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.help.html (+10, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.help.html (+10, -0)
",-0.943718,0.407868,-1.31497,0.751215,-0.179936,0.45354,-0.469677,-0.088808,0.412218,0.169164,0.22284,0.28173,0.513862,0.201312,-0.391596
openstack/python-octaviaclient,Iecc1ba5dc5f27bc160bf39fc0c6fa91f89405093,0,0,0.0,1.0986,0.5,1,6.33,332,0,CI,1,0,0,6,0.24,0.0,0,0.0,1,1,0,0.0741,0.0,1.0,13.4,12.01,1,0,1.0,1,110.6667,0,0,0,0,0,"Add Python3 victoria unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for victoria.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.94391,0.369599,-0.731212,0.704677,-0.889466,0.12589,-0.305646,0.182486,0.2805,0.466785,-0.418959,0.216836,-0.147541,0.033533,-0.093632
openstack/oslo.utils,I6f3456802fd432580dd27d9c03bde21759c4a3ae,1,0,0.0,1.0986,0.5,1,6.33,332,0,CI,0,0,0,7,0.259259,0.0,0,0.0,0,1,0,0,0.0,0.0,13.4,12.01,1,0,0.0,0,110.6667,0,0,0,0,0,"Add Python3 victoria unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for victoria.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
.zuul.yaml (+1, -1)
",-0.943911,0.369599,-0.731211,0.704677,-0.889466,0.12589,-0.305646,0.182486,0.2805,0.466785,-0.418959,0.216836,-0.147541,0.033533,-0.093632
openstack/octavia,I831b0b48d719397c14d80f8ebcbad997c50c7795,1,0,0.2143,2.6391,0.0769,2,16.25,440,0,Bug Fix,0,0,0,14,0.00137,0.0,0,0.0,5,2,0,0.4828,0.6194,3.5,49.78,13.27,1,0,0.0,1,31.4286,0,0,0,0,0,"Fix py3 amphora-agent cert-rotation type bug

Flask's stream always returns bytes, file write always takes string.
This causes py3 amps to return 500 on cert rotation AND wipe out the
certificate, so the amphora are no longer controllable and go to ERROR
state. Anyone running py3 amps prior to this patch will experience
amphorae breaking on a timer due to housekeeping cert rotation!
[SEP]
FILES CHANGED:
releasenotes/notes/amp-agent-py3-cert-upload-binary-74e0ab35c5a85c68.yaml (+11, -0)
octavia/amphorae/backends/agent/api_server/certificate_update.py (+1, -1)
",-0.560967,-1.887059,0.115616,0.232779,0.071563,-0.411698,0.353885,-0.102653,-0.338331,0.253221,0.189776,-0.277846,0.531089,-0.240185,0.126672
openstack/octavia,I49b587cf748996658859667485400307205d209b,0,0,0.1111,2.9957,0.3684,2,6.0,233,0,Bug Fix,0,0,0,9,0.002803,0.5,0,0.0556,4,2,0,0.4872,0.9819,2.5,10.4,19.07,0,0,0.0,0,11.65,0,0,0,0,0,"Run taskflow jobboard conductor conditionally

Run taskflow jobboard conductor only if amphorav2 provider is
enabled.

Fixes devstack plugin.sh conditions for amphorav2 provider.
[SEP]
FILES CHANGED:
devstack/plugin.sh (+4, -4)
octavia/controller/queue/v2/consumer.py (+8, -3)
",0.259149,-0.519077,-0.201892,0.705188,0.718921,-0.384181,-0.003412,0.677622,0.138378,-0.297328,0.040931,0.48572,-0.184724,-0.334401,0.133738
openstack/octavia,Ib4944fb44fea53c8dd1908b7f264d45a84884639,0,0,0.4521,1.3863,1.0,3,4.17,267,0,Feature,0,0,1,73,0.003128,0.0556,1,0.0251,1,1,0,0.4831,1.585,0.33,2.95,11.27,1,0,0.0,0,66.75,0,0,0,0,0,"Remove Babel requirement

Babel is no longer a requirement for OpenStack projects.
Let's remove it and save some disk space.

See also
http://lists.openstack.org/pipermail/openstack-discuss/2020-April/014227.html
[SEP]
FILES CHANGED:
diskimage-create/requirements.txt (+0, -1)
requirements.txt (+0, -1)
lower-constraints.txt (+0, -1)
",-1.307863,2.584545,-1.753914,0.96205,-0.986117,0.411865,0.079975,-0.649417,-0.321467,0.108333,-0.308731,-0.162987,0.245248,0.074283,-0.031816
openstack/octavia,Ic33d9b9a256490ae1b048cdfd2475d6340509fdb,0,0,0.0,5.9135,0.1192,32,6.82,559,0,CI,0,0,0,2,0.004367,0.5,0,0.0,7,7,0,0.479,3.9805,3.66,52.15,11.26,1,0,0.4309,1,1.5108,0,0,0,0,0,"Add TLS version configuration for listeners

Add field tls_versions to listeners for restricting TLS versions used.
This is a list of versions to be used.
Available values (as defined in octavia-lib):
SSLv3, TLSv1, TLSv1.1, TLSv1.2, TLSv1.3

Add default_listener_tls_versions in octavia.conf.

Note that at this time TLS 1.3 ciphersuites are not impelemented,
so any TLS 1.3 connections will use haproxy's default ciphers
instead of what's specified by tls_ciphers.

Story: 2006733
Task: 37170
Task: 37169
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+16, -0)
api-ref/source/v2/examples/listener-update-curl (+1, -1)
api-ref/source/v2/examples/listener-update-request.json (+2, -1)
octavia/common/config.py (+5, -1)
octavia/tests/unit/common/test_validations.py (+14, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/common/sample_data_models.py (+3, -2)
octavia/common/jinja/haproxy/combined_listeners/templates/haproxy.cfg.j2 (+1, -1)
etc/octavia.conf (+5, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+6, -3)
octavia/common/validate.py (+12, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+7, -4)
octavia/common/constants.py (+11, -0)
api-ref/source/v2/examples/listener-create-response.json (+2, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+4, -1)
api-ref/source/v2/examples/listener-update-response.json (+2, -1)
octavia/tests/unit/api/drivers/test_utils.py (+0, -7)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+22, -4)
api-ref/source/v2/examples/listener-show-response.json (+2, -1)
octavia/db/migration/alembic_migrations/versions/e5493ae5f9a7_add_listener_tls_versions_column.py (+35, -0)
octavia/db/models.py (+2, -0)
octavia/api/v2/types/listener.py (+9, -0)
api-ref/source/v2/examples/listener-create-request.json (+2, -1)
api-ref/source/v2/listener.inc (+6, -0)
api-ref/source/v2/examples/listener-create-curl (+1, -1)
octavia/db/prepare.py (+10, -5)
api-ref/source/v2/examples/listeners-list-response.json (+2, -1)
octavia/common/data_models.py (+2, -1)
octavia/api/root_controller.py (+5, -2)
releasenotes/notes/tls-versions-listeners-59cecde77e0238a0.yaml (+14, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+112, -4)
octavia/api/v2/controllers/listener.py (+8, -0)
",-2.618389,0.04262,0.383556,0.611442,0.557856,-0.086,-0.679374,0.443273,0.314814,0.491344,0.007305,-0.075465,-0.190001,0.191391,-0.022566
openstack/octavia,Ia6d3f40ae1b9b352492162513c9262748ee67e6f,1,0,0,3.4657,0.0968,3,36.0,284,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,2,0,0.475,1.1357,4.0,15.2,25.51,0,0,0.7097,1,8.875,0,0,0,0,0,"Fix healthmanager not update amphora health when LB disable

When disable a loadbalancer have listener, the Heath Manager not update
amphora heath make it keep failover after heartbeat_timeout end time

Story: 2007587
Task: 39521
[SEP]
FILES CHANGED:
releasenotes/notes/Fix-healthmanager-not-update-amphora-health-when-LB-disabled-46a4fb295c6d0850.yaml (+6, -0)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_db.py (+20, -2)
octavia/controller/healthmanager/health_drivers/update_db.py (+2, -1)
",1.537047,-1.832219,-0.415607,-0.557156,-0.198228,-0.048444,0.443892,-0.064331,-0.007108,-0.837696,0.343034,-0.425657,-0.08647,-0.151776,-0.056054
openstack/python-octaviaclient,Icb3171a7722e3b3028a108345506e907132bb856,0,0,0.0,3.9703,0.1154,6,35.0,307,0,CI,0,0,0,2,0.025,0.2,0,0.0,5,2,0,0.0714,2.002,3.5,4.53,28.86,0,0,0.4615,1,5.7925,0,0,0,0,0,"Add the ability to specify TLS protocols for a listener

Updated the listener create and set parameters to add
an argumet ""--tls-version"" for passing TLS protocol versions

Story: 2006733
Task: 37174
Depends-On: Ic33d9b9a256490ae1b048cdfd2475d6340509fdb
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/constants.py (+2, -1)
octaviaclient/tests/unit/osc/v2/test_listener.py (+17, -4)
releasenotes/notes/add-tls-version-support-for-listeners-4a6a661af5f9de9a.yaml (+6, -0)
octaviaclient/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/listener.py (+18, -0)
octaviaclient/osc/v2/utils.py (+1, -0)
",-0.620285,-0.846806,-1.290111,-0.953501,0.7914,-0.29563,0.278726,0.129763,0.767467,0.248192,-0.356471,-0.126162,0.362116,0.433115,-0.007058
openstack/octavia,I6f53ea5d012ab64b985d981ecd1b1967e18e4e81,0,0,0.4459,3.4965,0.25,5,4.33,362,0,Bug Fix,0,0,0,74,0.00317,1.0,0,0.4459,4,5,0,0.4793,2.0981,2.4,-3.64,15.07,1,0,0.0,1,10.9697,0,0,0,0,0,"Fix building Ubuntu 20.04 focal amphorae

Ubuntu 20.04 is a ""Tested Runtime"" for the Victoria release[1].
This patch updated our diskimage-create script and elements to
support building a amphora image that uses Ubuntu 20.04 (focal).

[1] https://governance.openstack.org/tc/reference/runtimes/victoria.html
[SEP]
FILES CHANGED:
elements/amphora-agent/package-installs.yaml (+7, -1)
elements/amphora-agent/pkg-map (+11, -2)
diskimage-create/diskimage-create.sh (+1, -3)
elements/amphora-agent/post-install.d/10-enable-network-scripts (+4, -0)
elements/amphora-agent/install.d/amphora-agent-source-install/75-amphora-agent-install (+1, -2)
",-0.612158,0.684666,-0.858811,0.492899,-0.444857,0.003412,0.557838,0.775968,0.074369,0.350659,0.139172,0.257799,0.098833,0.07963,-0.211072
openstack/octavia,I3c1e65466fa22747e66b25ea09dd518fcc311723,0,0,0,0.6931,0.0,1,7.8,298,0,CI,0,0,0,0,0.0,0.0455,0,0.0,0,1,0,0.4754,0.0,0.0,42.73,11.33,1,0,0.0,0,149.0,0,0,0,0,0,"Add py38 package metadata

Now that we are running the Victoria tests that include a
voting py38, we can now add the Python 3.8 metadata to the
package information to reflect that support.
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",0.988832,-1.319162,0.099929,0.960144,0.011964,0.109736,0.244804,0.139285,-0.042443,0.562931,-0.801735,0.660798,-0.457272,-0.127504,0.387303
openstack/octavia,I2372178351e961eeed5a819f39e75d54ba148798,0,0,0.0,2.3979,0.1,1,16.5,646,0,CI,0,0,0,1,0.5,0.1667,0,0.0,0,1,0,0.4715,0.0,0.0,55.07,11.45,1,0,0.0,1,58.7273,0,0,0,0,0,"Change default tox envs from python37 to python3

Python versions supported by OpenStack change over time, and for minor
versions of Python 3 it is tedious to keep this file updated.

Since this does not impact zuul jobs in any way, nor prevent local
tests against py37, it should be safe to simply make this more easily
compatible for users that don't care about the specific Python versions
and just need basic tests to run.

The *only* thing this does is changes the default versions tested if none
are explicitly provided with `-e`.
[SEP]
FILES CHANGED:
tox.ini (+9, -1)
",-0.75715,-1.951323,0.622109,0.418801,-0.422801,-0.340067,0.248548,-0.214914,-0.54223,0.673422,-0.322551,0.021223,0.158726,-0.144078,-0.027434
openstack/oslo.policy,Ifcfc88a67b038528f03756d550e1ddf8726cb37a,1,0,0,6.3953,0.311,11,7.5,154,0,Doc,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0,2.8479,3.27,13.1,19.0,1,0,0.0,0,0.2571,0,0,0,0,0,"docs: Add separate man page for each CLI tool
[SEP]
FILES CHANGED:
doc/source/cli/oslopolicy-list-redundant.rst (+52, -0)
doc/source/cli/common/default-opts.rst (+19, -0)
doc/source/cli/common/generator-opts.rst (+3, -0)
doc/source/cli/index.rst (+7, -185)
doc/source/cli/oslopolicy-checker.rst (+94, -0)
doc/source/cli/common/rule-opts.rst (+8, -0)
doc/source/conf.py (+32, -1)
doc/source/cli/oslopolicy-policy-generator.rst (+67, -0)
doc/source/cli/oslopolicy-sample-generator.rst (+68, -0)
doc/source/cli/common/enforcer-opts.rst (+4, -0)
doc/source/cli/oslopolicy-validator.rst (+58, -0)
",3.1942,-0.296771,2.014753,0.360655,-0.023248,0.238801,0.375452,0.327529,0.3098,0.167324,-0.766984,0.163976,0.100042,-0.100663,-0.247043
openstack/python-octaviaclient,Ia7a5ebbfc32f354ba733cc404539239fd6009e7a,0,0,0.0,3.9318,0.14,6,35.0,302,0,CI,0,0,0,3,0.022727,0.125,0,0.0,5,2,0,0.069,2.0281,3.5,6.94,27.71,1,0,0.42,1,5.9216,0,0,0,0,0,"Add the ability to specify TLS protocols for a pool

Updated the pool create and set parameters to add
a repeatable  argumet ""--tls-version"" for passing TLS
Protocols

Story: 2006733
Task: 37175
Depends-On: I480b7fb9756d98ba9dbcdfd1d4b193ce6868e291
[SEP]
FILES CHANGED:
releasenotes/notes/add-tls-version-support-to-pools-852f02b034f436f9.yaml (+6, -0)
octaviaclient/tests/unit/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/utils.py (+1, -0)
octaviaclient/tests/unit/osc/v2/test_pool.py (+13, -5)
octaviaclient/osc/v2/pool.py (+19, -0)
",-0.632746,-1.117827,-1.029264,-1.121375,0.654938,-0.347509,0.054464,0.317152,0.670187,0.161762,-0.346717,-0.292824,0.356857,0.447685,0.018555
openstack/octavia,Ib82014f92eecbcfd96a4219f2de307e5631486cb,0,0,0.125,3.5553,0.8235,3,7.5,148,0,Feature,0,0,0,8,0.009756,0.2,0,0.025,2,3,0,0.4677,1.1596,1.67,1.82,16.33,1,0,0.0,1,4.2286,0,0,0,0,0,"Remove deprecated status_update_threads option

It was marked for removal in the Stein cycle.
[SEP]
FILES CHANGED:
octavia/common/config.py (+0, -24)
etc/octavia.conf (+0, -4)
releasenotes/notes/remove-status_update_threads-85a8b0307a04c164.yaml (+6, -0)
",2.526986,-0.280909,0.290188,0.262957,-0.475129,0.795173,0.225818,-0.276251,0.428841,-0.078019,0.534747,0.025288,-0.940414,0.119783,0.287149
openstack/octavia-dashboard,If9c80e3d51e06e78231ed0dad595a45101e05580,0,0,0.0,0.6931,0.0,1,7.8,298,0,CI,0,0,0,2,0.166667,0.0435,0,0.0,0,1,0,0.1667,0.0,0.0,36.23,11.33,1,0,0.0,0,149.0,1,0,0,0,0,"Add py38 package metadata

Now that we are running the Victoria tests that include a
voting py38, we can now add the Python 3.8 metadata to the
package information to reflect that support.
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",0.988832,-1.319162,0.099929,0.960144,0.011964,0.109736,0.244804,0.139284,-0.042444,0.562931,-0.801735,0.660799,-0.457273,-0.127504,0.387304
openstack/octavia,I05a541a77f254a77ad5036e1062b61c8ce93b754,0,0,0,3.4657,0.5484,1,12.0,194,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,0.464,0.0,2.0,39.56,9.8,1,0,0.0,0,6.0625,0,0,0,0,0,"Fix getting user neutron client

Use token and endpoint URL to initialize neutron client for the
request user.

Story: 2007619
Task:  39641
[SEP]
FILES CHANGED:
octavia/common/clients.py (+14, -17)
",1.270866,-1.659736,-0.199891,-0.40964,-0.350905,0.50297,-1.031259,0.378512,0.59886,-0.596712,-0.388358,0.131237,0.263326,0.638808,-0.169999
openstack/octavia,Ie71db27dc383c93496c1dfd69f486a4fd02b597e,1,1,0,2.3026,0.1111,2,12.0,253,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.4603,0.9911,3.0,63.06,12.58,1,0,0.0,1,25.3,1,6,0,1,0,"add the verify for the session

We run the octavia scenario test failed when the OpenStack env
enable TLS. So we need add the verify for the session.

Story: 2007662
Task:  39754
Closes-Bug: #1877818
[SEP]
FILES CHANGED:
octavia/certificates/common/auth/barbican_acl.py (+3, -1)
releasenotes/notes/fix-barbican-client-verfiy-689be1b9389bd1d8.yaml (+5, -0)
",0.964856,-1.947749,-0.500381,-0.787434,-0.906689,0.368068,-0.623441,0.182486,0.236109,-0.292375,0.055035,0.008396,0.186875,0.616747,0.094145
openstack/octavia,Idd176e40ccf2a79832a5c99140bd30e5e1f9c0d8,1,0,0.1111,5.1299,0.4643,22,10.75,307,0,Bug Fix,0,0,0,9,0.010539,1.0,0,0.1111,5,1,0,0.4646,3.8638,4.45,48.37,12.67,1,0,0.506,0,1.8166,0,0,0,0,0,"Fix E741 pep8 errors

E741 ambiguous variable name 'l'

Change 'l' to another variable in affected code.

Also had to set the latex_engine to 'xelatex' in doc/source/conf.py
in order to get past an openstackdocstheme change the broke the pdf
doc build.
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+2, -1)
octavia/api/v2/controllers/load_balancer.py (+10, -10)
octavia/controller/worker/v2/tasks/database_tasks.py (+4, -2)
octavia/tests/functional/api/v2/test_quotas.py (+16, -15)
octavia/db/models.py (+5, -5)
octavia/tests/functional/api/v2/test_amphora.py (+2, -1)
octavia/api/v2/controllers/health_monitor.py (+1, -1)
octavia/tests/functional/api/v2/test_l7policy.py (+2, -1)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+2, -2)
octavia/tests/functional/api/v2/test_pool.py (+2, -1)
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+2, -2)
octavia/controller/worker/v1/tasks/database_tasks.py (+3, -2)
octavia/controller/worker/v2/controller_worker.py (+2, -2)
octavia/api/v2/controllers/pool.py (+1, -1)
octavia/tests/functional/api/v2/test_l7rule.py (+2, -1)
octavia/tests/functional/db/test_models.py (+4, -4)
octavia/api/v2/controllers/member.py (+2, -2)
octavia/tests/functional/api/v2/test_member.py (+2, -1)
octavia/network/drivers/neutron/allowed_address_pairs.py (+9, -9)
octavia/tests/functional/api/v2/test_load_balancer.py (+2, -1)
octavia/tests/functional/api/v2/test_listener.py (+13, -12)
octavia/amphorae/drivers/noop_driver/driver.py (+2, -2)
",-0.210243,-1.140351,-0.50564,-0.131703,-0.030564,-0.327755,0.173438,-0.293335,-0.167752,-0.003461,0.14294,-0.727144,-0.28139,0.291141,-0.021385
openstack/kolla-ansible,I1efd0154ebaee69373ae5bccd391ee9c68d09b30,1,1,0,3.6889,0.1026,4,15.21,1452,1,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,3,0,0.4,1.5927,3.5,40.07,13.97,1,0,0.0,1,36.3,0,6,0,10,0,"Switch octavia to use service project in service_auth

Recently a patch [1] was merged to stop adding the octavia user to the
admin project, and remove it on upgrade. However, the octavia
configuration was not updated to use the service project, causing load
balancer creation to fail.

There is also an issue for existing deployments in simply switching to
the service project. While existing load balancers appear to continue to
work, creating new load balancers fails due to the security group
belonging to the admin project. At a minimum, the deployer needs to
create a security group in the service project, and update
'octavia_amp_secgroup_list' to match its ID. Ideally the flavor and
network would also be recreated in the service project, although this
does not seem to impact operation and will result in downtime for
existing Amphorae.

This change adds a new variable, 'octavia_service_auth_project', that
can be used to set the project. The default in Ussuri is 'service',
switching to the new behaviour. For backports of this patch it should be
switched to 'admin' to maintain compatibility.

If a deployer sets 'octavia_service_auth_project' to 'admin', the
octavia user will be assigned the admin role in the admin project, as
was done previously.

Closes-Bug: #1882643
Related-Bug: #1873176

[1] https://review.opendev.org/720243/

Co-Authored-By: Mark Goddard <mark@stackhpc.com>
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+4, -0)
ansible/roles/octavia/tasks/register.yml (+14, -0)
releasenotes/notes/remove-octavia-user-in-admin-project-action-95c87ca45a1188d6.yaml (+16, -3)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
",-3.436848,0.562703,3.738842,-0.497459,-0.487758,0.46547,-0.597233,-0.229652,0.022408,-0.282371,-0.22546,0.62451,-0.386088,-0.15635,0.065596
openstack/octavia-lib,I861f3305af18d112d51a1dc368a00e5fe763b788,0,0,0,1.3863,0.6667,2,5.38,741,0,Bug Fix,0,0,1,0,0.0,0.0476,1,0.0,0,1,0,0.0,0.9183,0.0,68.86,5.69,0,0,0.6667,0,185.25,0,0,0,0,0,"Fix hacking min version to 3.0.1

flake8 new release 3.8.0 added new checks and gate pep8
job start failing. hacking 3.0.1 fix the pinning of flake8 to
avoid bringing in a new version with new checks.

Though it is fixed in latest hacking but 2.0 and 3.0 has cap for
flake8 as <4.0.0 which mean flake8 new version 3.9.0 can also
break the pep8 job if new check are added.

To avoid similar gate break in future, we need to bump the hacking min
version.

Also removing the hacking and other related dep from lower-constraints file
as theose are blacklisted requirements and does not need to be present
there.

- http://lists.openstack.org/pipermail/openstack-discuss/2020-May/014828.html
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
lower-constraints.txt (+0, -1)
",-1.630726,-0.093579,2.024107,-0.45996,-0.480503,-0.276455,0.718674,0.257155,-0.272692,0.367572,-0.28301,0.067981,-0.233609,0.172007,0.342526
openstack/octavia,Id52745f4751a62c53afbde94038b18b614f9b2dd,0,0,0,2.8332,1.0,2,7.0,200,0,Feature,0,0,0,0,0.0,0.0417,0,0.0,0,1,0,0.4688,0.5436,0.0,18.44,16.13,0,0,0.0,0,11.7647,0,0,0,0,0,"Remove translation sections from setup.cfg

These translation sections are not needed anymore, Babel can
generate translation files without them.
[SEP]
FILES CHANGED:
babel.cfg (+0, -2)
setup.cfg (+0, -14)
",0.936382,-0.59221,-0.075966,0.882598,0.114239,0.298181,-0.433129,-0.80244,-0.668409,-0.035333,-0.09584,-0.00542,-0.242871,0.523707,-0.708947
openstack/octavia-dashboard,I96fc5ca23010958d68cf261793489580b57f3a4f,0,0,0.0,2.4849,0.6364,4,4.17,439,0,Feature,0,0,1,3,0.142857,0.16,0,0.0,3,3,0,0.1538,1.9363,0.75,28.33,10.47,0,0,0.1818,1,36.5833,0,0,0,0,0,"Switch to hacking 3.0

This patch update hacking version to 3.0.0[1]. In order to make code compatible
with new hacking rules line break before/after binary operator I have added
W504 into ignore list in tox.ini. It also drop flake8, hacking, django-babel,
and mox3 packages from lower-requirements.txt.

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-May/014828.html
[SEP]
FILES CHANGED:
octavia_dashboard/api/rest/lbaasv2.py (+1, -1)
test-requirements.txt (+1, -1)
lower-constraints.txt (+0, -4)
tox.ini (+2, -1)
",-1.231951,0.780372,-0.410559,0.009367,-0.642893,-0.59247,0.659035,0.402272,-0.295272,0.600247,0.210693,-0.273108,0.088922,0.18508,-0.086944
openstack/octavia,I0100aaa428477f011bd39a90dd4ec98199b4bebc,1,0,0.7647,2.7081,0.0714,1,15.4,519,0,Bug Fix,0,0,0,17,0.012753,0.0,0,0.0,4,1,0,0.4651,0.0,4.0,49.47,11.87,0,0,0.0,0,34.6,0,0,0,0,0,"Fix netcat option in udp_check.sh for CentOS/RHEL

-w (timeout) option doesn't do anything in nmap-ncat (default netcat in
CentOS/RHEL) for UDP datagrams, and nmap-ncat has a default idle timeout
set to 2 seconds.
We can get the same behavior as netcap-openbsd (Debian/Ubuntu) by
setting that idle timeout (-i) option to 1 second.

This commit detects the flavor of the netcat binary (nmap vs other) and
uses it to adapt the parameters.

Story: 2007688
Task: 39800
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/udp_check.sh (+13, -1)
",-1.596897,-0.324569,0.307611,-0.000941,0.035507,-0.273897,0.054938,0.005661,-0.56407,-0.044031,0.382615,0.044106,0.40544,0.216843,-0.167019
openstack/octavia,Ida3acd6f3ba81facc929a4a2c3bd75c6971059c7,1,0,0.44,1.6094,0.0,1,13.5,214,0,Feature,0,0,0,75,0.003208,1.0,0,0.44,2,1,0,0.4692,0.0,2.0,36.47,12.81,0,0,0.0,0,42.8,0,0,0,0,0,"Add warning when running simple_server

This patch adds a warning log message that the Octavia API is being
run under simple_server.

Story: 2007702
Task: 39818
[SEP]
FILES CHANGED:
octavia/cmd/api.py (+4, -0)
",0.619648,-1.318226,-0.63917,-0.222936,-0.56019,0.502811,-1.084978,-0.078399,0.442895,-0.345143,0.103758,0.426101,-0.137092,0.525323,0.019803
openstack/kolla,I79af6c37950e156018a9204fbcc7417cd7d41012,1,0,0,1.6094,0.0,2,9.67,207,0,CI,1,0,0,0,0.0,0.0,0,0.0,2,2,0,1.0,0.8113,2.0,74.5,9.38,0,0,1.0,0,41.4,0,0,0,0,0,"CI: use wheels from infra mirror

If they are available then we do not need to build them. Especially
AArch64 jobs will speedup (once wheels are built).
[SEP]
FILES CHANGED:
tests/vars/zuul.yml (+3, -0)
tests/templates/template_overrides.j2 (+1, -0)
",2.1934,-1.224722,0.348748,-0.059403,-0.317088,0.231606,0.233213,-0.633996,-1.144361,-0.02663,-0.465521,-0.1136,0.249867,-0.010594,-0.434149
openstack/octavia,Ib0fc26877710dea423a5ebcf1f71077665404377,1,0,0.0,3.4012,0.0345,3,16.94,1736,0,Bug Fix,0,0,0,4,0.006441,0.0,0,0.0,4,2,0,0.4733,1.4158,2.67,43.54,14.75,1,0,0.5172,1,57.8667,0,0,0,0,0,"Workaround peer name starting with hyphen

The base64_sha_string method is used to set a base64-encoded peer name
in HAProxy. There are cases where the peer name can start with
an hypen which is troublesome when used in HAProxy CLI. Specifically,
HAProxy fails to reload when local peer name starts with '-x' [1]. When
this is the case, an amphora goes to provisioning status ERROR and later
is scheduled for failover by the Octavia Health Manager service. A new
amphora UUUID is assigned and base64 encoded, hopefully not starting
with '-x' again. However, this is far from being ideal -- we incur in a
dataplane disruption (single topology) or reduce HA capabilities
(active-standby topology) for some time.

Four possible options:

a) add prefix to peer name
b) change b64encode altchars
c) quote peer name in haproxy CLI command
d) substitute first character if hyphen

Option a) and b) are not backward compatible with running amphorae. Peer
names of existing amphorae that do not start with hypen but contain
hyphen at any other position would get different peer names.

Option c) would nonetheless still require an amphora image update to add
quotes in the HAProxy init service file. Continuing to generate peer
names with hyphens at begininng of the string is avoidable and
recommended.

Option d), while also requiring an amphora image update, it would get
rid of hyphens in begining of the peer names. It is also backward
compatible with all running amphorae, except for those starting with
hyphen but are broken anyways.

This patch takes option d). It substitutes hyphen with 'x' character.

[1] https://github.com/haproxy/haproxy/issues/644

Task: 39850
Story: 2007714
[SEP]
FILES CHANGED:
octavia/common/utils.py (+3, -1)
releasenotes/notes/fix-peer-name-prefix-hypen-e74a87e9a01b4f4c.yaml (+10, -0)
octavia/tests/unit/common/test_utils.py (+15, -0)
",-2.802595,-0.182551,3.968408,-1.032728,-0.128125,0.437316,-0.79861,-0.47258,-0.313464,0.011978,-0.702217,0.531245,-0.049235,-0.149565,-0.097772
openstack/octavia,I2816360b59f82c996038929ed6e90b744feb3f75,0,0,0.0,1.6094,0.5,2,3.8,524,0,Feature,0,0,1,1,0.02439,0.0526,1,0.0,0,1,0,0.4773,1.0,0.0,10.03,11.34,1,0,0.0,0,104.8,0,0,0,0,0,"Cap jsonschema 3.2.0 as the minimal version

Previous versions of jsonschema (<3.2.0) doesn't support python 3.8 [1].
Python 3.8 is part of the victoria supported runtimes [2] so we now force
to use jsonschema version 3.2.0 to avoid issues, remove ambiguity and ensure
that everything works with python 3 in general.

[1] https://github.com/Julian/jsonschema/pull/627
[2] https://governance.openstack.org/tc/reference/runtimes/victoria.html#python-runtimes-for-victoria
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
lower-constraints.txt (+1, -1)
",-2.476829,1.946271,0.123365,0.459826,-0.047234,-0.076944,0.41218,0.17733,-0.517022,0.59032,-0.017907,0.240445,-0.307658,-0.17263,0.161627
openstack/octavia,I6543fe5caf539c9b1167a7c58984b3474879e1de,1,0,0,1.0986,0.5,1,11.0,120,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,2,1,0,0.4737,0.0,2.0,26.47,11.67,1,0,0.0,0,40.0,0,0,0,0,0,"Fixed a bug: replace 'startwith' with 'startswith'

story: 2007734
[SEP]
FILES CHANGED:
octavia/common/clients.py (+1, -1)
",1.508813,1.093473,-0.334305,-0.366261,0.329028,0.918284,-0.565732,-1.071282,0.185157,-0.033147,0.250664,-0.492081,-0.093878,0.091976,0.147613
openstack/octavia,I59d94bc9743b04674caca3ffcb8fc91ba803298c,0,0,0,2.1972,0.5,2,4.0,66,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,5,1,0,0.4776,1.0,5.0,-8.72,21.6,1,0,0.0,0,7.3333,0,0,0,0,0,"trivial fix
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+2, -2)
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+2, -2)
",3.218612,1.921313,2.323696,-0.520868,-0.312024,1.942817,0.519424,-1.220744,0.609644,1.07846,0.35584,0.457493,0.082681,-0.450616,0.604503
openstack/octavia,I925cc05981e677c0552b18f845fdbc512d2af22c,0,0,0.4474,4.0775,0.4138,8,6.0,531,0,Doc,0,0,0,76,0.003251,0.4444,0,0.1988,3,5,0,0.4741,2.6742,1.75,16.16,13.31,0,0,0.0,1,9.0,0,0,0,0,0,"Switch oslo.policy over to yaml

Oslo.policy is moving away from using json format policy files[1].

This patch updates the Octavia documentation, policy configuration file, and
legacy admin-or-owner policy file to be in yaml format.

Octavia will continue to honor and support the json format file as long
as oslo.policy does, but this patch will encourage new deployments
to use the yaml format.

[1] https://docs.openstack.org/oslo.policy/latest/admin/policy-json-file.html
[SEP]
FILES CHANGED:
etc/policy/README.rst (+3, -3)
etc/policy/octavia-policy-generator.conf (+2, -2)
specs/template.rst (+1, -1)
devstack/plugin.sh (+1, -1)
etc/policy/admin_or_owner-policy.json (+0, -11)
doc/source/configuration/policy.rst (+6, -3)
tools/misc-sanity-checks.sh (+3, -3)
etc/policy/admin_or_owner-policy.yaml (+18, -0)
",-1.418112,0.577236,0.396393,0.821936,-0.361269,-0.486505,0.53834,0.404841,0.12107,0.172661,0.142763,0.111555,-0.206405,0.124335,-0.214112
openstack/python-octaviaclient,I8d1d62e00e90e6f295d4985f6973d49394e6f851,1,0,0.0,0.6931,0.0,1,12.0,127,0,Feature,0,0,0,1,0.03125,0.1111,0,0.0,3,1,0,0.0667,0.0,3.0,11.36,14.8,1,0,0.0,0,63.5,0,0,0,0,0,"Show operating_status in listing LB output

Story: #2007746
Task: #39924
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/constants.py (+1, -0)
",1.942059,0.412754,-0.565938,-0.679287,-0.108125,1.198196,-0.752085,0.069732,0.783873,-0.489739,0.348162,0.011799,0.139181,0.486938,0.009127
openstack/octavia,I193ba2193f24e6deac473423310b81a029e15e22,0,0,0.0,1.0986,1.0,1,5.62,988,0,Doc,0,0,0,2,0.044444,1.0,0,0.0,4,1,0,0.4706,0.0,4.0,28.35,11.06,1,0,0.0,0,329.3333,0,0,0,0,0,"Stop to use the __future__ module.

The __future__ module [1] was used in this context to ensure compatibility
between python 2 and python 3.

We previously dropped the support of python 2.7 [2] and now we only support
python 3 so we don't need to continue to use this module and the imports
listed below.

Imports commonly used and their related PEPs:
- `division` is related to PEP 238 [3]
- `print_function` is related to PEP 3105 [4]
- `unicode_literals` is related to PEP 3112 [5]
- `with_statement` is related to PEP 343 [6]
- `absolute_import` is related to PEP 328 [7]

[1] https://docs.python.org/3/library/__future__.html
[2] https://governance.openstack.org/tc/goals/selected/ussuri/drop-py27.html
[3] https://www.python.org/dev/peps/pep-0238
[4] https://www.python.org/dev/peps/pep-3105
[5] https://www.python.org/dev/peps/pep-3112
[6] https://www.python.org/dev/peps/pep-0343
[7] https://www.python.org/dev/peps/pep-0328
[SEP]
FILES CHANGED:
octavia/db/migration/alembic_migrations/env.py (+0, -2)
",-4.156206,4.417057,2.768824,-0.05113,-0.228029,0.843409,-0.585699,-0.438101,-0.632631,0.310033,-0.454838,0.051598,0.116099,0.223155,-0.222877
openstack/oslo.messaging,I68dde630571b5c1aca1cd942c1a4fe4a16c8129e,0,0,0.0,1.6094,0.75,1,5.0,821,0,Bug Fix,0,0,0,3,0.06383,0.0,0,0.0,2,1,0,0,0.0,2.0,9.3,9.5,1,0,0.0,0,164.2,0,0,0,0,0,"Stop to define `TCP_USER_TIMEOUT` and socket constant

TCP_USER_TIMEOUT was introduced [1] few years ago to ensure that
timeouts are respected and also because our code supported python 2.7
where the socket module don't defined few constants.

This constant is now supported since python 3.6 [2][3] so prefer to use this
module constant.

At the begining this constant were used all the time [4] but now we
don't need her anymore.

[1] https://github.com/openstack/oslo.messaging/commit/98bc5fc2fadce089b6f47421929651606e5e9ab6
[2] https://bugs.python.org/issue26273
[3] https://docs.python.org/3.8/library/socket.html#constants
[4] https://github.com/openstack/oslo.messaging/commit/98bc5fc2fadce089b6f47421929651606e5e9ab6#diff-0dabf284596ae79f183fc9eee20b4d9cR870
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/impl_rabbit.py (+1, -3)
",-4.444123,2.75363,2.176086,-1.195199,0.343618,0.591582,-0.207597,-0.412028,-0.274468,0.516951,-0.313371,-0.001066,-0.189926,-0.119266,0.035084
openstack/kolla,Ieca15bdb315d52e9547d798df11641ef36485b26,1,0,0,2.0794,0.4286,1,10.0,1022,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,-30.89,21.2,0,0,0.0,0,127.75,0,0,0,0,0,"Fix horizon debian binary docker image

Debian packages are different from ubuntu packages.
Differencies in /etc/openstack-dashboard:
  - Symlinking {{ python_path }}/openstack_dashboard/local/enabled/ -> /etc/openstack-dashboard/enabled
  - Symlinking {{ python_path }}/openstack_dashboard/local_settings.d/ -> /etc/openstack-dashboard/local_settings.d
  - Symlinking {{ python_path }}/openstack_dashboard/conf/ -> /etc/openstack-dashboard/policy

Every dashboard-plugin debian package is copying his policy files, local_settings, enabled to above locations.
Every dashboard-plugin is triggering dpkg and collect-static, compress is done by openstack-dashboard package.
Kolla has to remove all these debian package's configs and provide kolla configs.
Move also /etc/openstack-dashboard/policy to standard location and delete symlink as kolla-ansible is overriding
default policy files path to /etc/openstack-dashboard/.

Depends-On: https://review.opendev.org/733612
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+4, -3)
",-4.47347,2.892757,1.982175,0.298417,0.805258,-0.323586,-0.424144,0.144437,-0.737102,-0.64003,-0.147181,-0.03556,0.14747,0.413354,0.015241
openstack/kolla-ansible,I9862ac7ab462ca9018b684d63f26458ddda9f73a,1,0,1.0,1.3863,0.0,1,7.75,779,0,Bug Fix,0,0,0,1,0.125,0.0,0,0.0,4,1,0,0.5,0.0,4.0,13.39,14.71,0,0,0.0,0,194.75,0,0,0,0,0,"Fix STATIC_ROOT for Debian, Ubuntu

STATIC_ROOT in local_settings.py should be configured
to path which is also configured in apache's config.

For debian, ubuntu binary setup it is
/var/lib/openstack-dashboard/static.

Reason why it is ""accidentaly"" working is:

For debian package:
Package is overriding STATIC_ROOT in
/etc/openstack-dashboard/local_settings.d/_0003_debian_static_root.py.
But this is going to be removed from settings in
https://review.opendev.org/733607.

For ubuntu package:
Ubuntu package is adding patch to package which is including
PYTHON_PATH do /usr/share/openstack-dashboard/
And also they are creating several dirty symlinks to get it working.

This patch is fixing this behaviour more clearly.
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/local_settings.j2 (+3, -0)
",-2.748422,0.698566,1.769258,-0.401764,-0.108298,-0.162449,0.085897,0.123787,-0.346617,-0.442958,-0.057253,-0.453486,-0.149519,0.357338,0.011875
openstack/octavia-dashboard,I4807e406cf6238767ceb02590c713f738686fa1f,0,0,0.0,3.8918,0.875,3,8.75,480,0,CI,0,0,1,4,0.018182,0.1538,0,0.0,0,3,0,0.1429,1.3635,0.0,50.51,10.36,1,0,0.0,1,9.7959,0,0,0,0,0,"Cleanup py27 support

This repo is now testing only with Python 3, so let's make
a few cleanups:
- Remove python 2.7 stanza from setup.py
- Add requires on python >= 3.6 to setup.cfg so that pypi and pip
  know about the requirement
- Remove obsolete sections from setup.cfg
- Update classifiers
- Remove install_command from tox.ini, the default is fine
- Use TOX_CONSTRAINTS_FILE instead of obsolete UPPER_CONSTRAINTS_FILE.
[SEP]
FILES CHANGED:
setup.py (+0, -9)
setup.cfg (+3, -26)
tox.ini (+3, -7)
",-1.711959,-0.263606,0.566139,0.326848,0.530352,-0.285669,-0.164168,0.260652,-0.676264,0.369465,0.158742,-0.519999,-0.106114,0.507115,0.194365
openstack/octavia,Ia3476ab7b24dc3fd6e29ff2abe6eb6bacd9908ed,1,0,0.4416,2.9444,0.1111,2,15.4,597,0,Bug Fix,0,0,0,77,0.003285,0.5,0,0.2208,6,1,0,0.4672,0.65,5.0,32.99,11.87,0,0,0.1667,0,31.4211,0,0,0,0,0,"Fix batch member create for v1 amphora driver

A previous patch[1] missed batch_member_update when adding database
repository ""get"" method retries for new object creation actions.
This patch fixes batch member create to retry the database get call
when new members are being created via batch member update.
This issue only impacts the v1 amphora driver as the v2 driver
does not need to get these objects from the database.

Story: 2007581
Task: 39503

[1] https://github.com/openstack/octavia/commit/48e85569f7e43e3dd5f09fd1ef4cb165526a92cd
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+3, -0)
octavia/controller/worker/v1/controller_worker.py (+13, -2)
",-1.628708,0.284676,0.296928,-0.448109,0.483939,0.06434,0.715083,0.233585,0.418043,-0.104747,0.178183,0.19235,-0.127902,-0.110139,0.052429
openstack/octavia,I057f9a8353de471d605a5a5c2860d7caa9d3bd28,0,0,0.2,3.6109,0.3889,4,5.0,631,0,Feature,0,0,0,5,0.007692,0.4,0,0.08,1,3,0,0.471,1.6984,1.0,15.64,10.67,0,0,0.6944,1,17.0541,0,0,0,0,0,"Do not install diskimage-builder from Git

Diskimage-builder recently dropped Python 2 support (>= 3.0.0).
Installing DIB from Git pulls Python 3-only DIB which breaks Python 2
devstack environments.

This patch drops the option to install DIB from Git. DIB will now
install what is set in stable/stein upper-constraints.txt [1].

[1] https://opendev.org/openstack/requirements/src/commit/91f0aa3eca667c12b2c8ac9282486ddd27d7b323/upper-constraints.txt#L511

Depends-On: https://review.opendev.org/#/c/733778/
(cherry picked from commit 4a95b354901c81f135b61d39754e1419dd134f0e)
[SEP]
FILES CHANGED:
devstack/plugin.sh (+1, -7)
zuul.d/projects.yaml (+17, -2)
zuul.d/jobs.yaml (+4, -2)
devstack/settings (+0, -3)
",-2.918979,1.787874,0.915204,-1.280383,0.263143,-0.104403,0.762619,0.383818,0.106016,0.056236,0.050239,-0.039229,0.018097,-0.08405,-0.10884
openstack/oslo.limit,I0b21dbe85358bd7308f244bbc7599a34cd69083a,0,0,0,3.4012,0.3448,4,16.12,829,0,Doc,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0,1.7906,1.5,52.09,12.65,1,0,0.1379,1,27.6333,0,0,0,0,0,"Move keystoneauth options to oslo_limit_keystoneauth

While implementing support for configuring via service and region
name we discovered that keystoneauth already registers opts for
those values in the oslo_limit group. We don't want to use those
opts in oslo.limit because they're not owned by us and if they were
to ever change we would be broken. Also, it's possible that for some
authentication types those opts may not exist, which would also break
us.

To address this, we can move the ksa opts to a separate group. This
will result in duplicate names in two groups, but that problem
already exists in some service projects that also need keystone
configuration in multiple places. We will need to be careful with
our documentation to ensure the difference is clear.
[SEP]
FILES CHANGED:
oslo_limit/tests/test_limit.py (+2, -2)
oslo_limit/limit.py (+2, -2)
releasenotes/notes/ksa-opt-group-name-2289685f19198a1b.yaml (+7, -0)
oslo_limit/opts.py (+8, -6)
",-1.924434,-1.418651,1.56151,0.147828,-0.299865,-0.306553,0.442767,-0.588375,-0.44023,-0.042462,0.186475,-0.232708,-0.12299,-0.334678,0.14146
openstack/kolla-ansible,I8b82ca74a02dbd803479b5486514f53a6eaf7768,0,0,0,0.6931,0.0,1,2.67,124,0,CI,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.5714,0.0,4.0,-17.95,21.07,0,1,0.0,0,62.0,1,0,0,0,0,"[DNM] Test Zun job

Depends-On: https://review.opendev.org/#/c/737198/
[SEP]
FILES CHANGED:
ansible/roles/zun/tasks/config.yml (+1, -0)
",0.816875,4.937572,-1.242129,0.290997,-1.55721,1.40473,0.370021,-0.624291,0.255604,-0.645996,-0.220324,0.166913,0.021133,-0.235825,-0.360374
openstack/kayobe,Ib6ab41a3ba320a1fe15d0d23561fad2fab7861e6,0,0,0.0,4.3307,0.4667,5,17.15,1458,0,Bug Fix,0,0,0,1,0.004115,0.0,0,0.0,3,3,0,0,1.8156,1.6,42.99,14.93,1,0,0.0,1,19.1842,0,0,0,0,0,"Fix seed VM interface ordering

Currently the ordering of network interfaces in the seed VM is
non-deterministic. This happens because we apply the 'unique' filter to
the network_interfaces list, which does not guarantee a deterministic
ordering. This list is then transformed and passed to the
stackhpc.libvirt-vm role.

There are two consequences of this:

* it is not possible to determine which interface names should be used
  prior to creating a seed VM
* if a seed VM is recreated, the interface ordering may change

This change fixes the issue by sorting the network_interfaces list
alphabetically before it is transformed and passed to the
stackhpc.libvirt-vm.

A new 'seed_vm_interfaces' variable is also added, which allows for
customisation of the VM's interfaces - potentially allowing for more
complex setups such as trunked VLANs.

Story: 2007259
Task: 38621

There is a second issue, which is that if the seed VM has a
network interface not configured with a gateway, cloud-init will fail to
configure the network interfaces on the host. This has been observed on
CentOS 8, but is probably more tied to the version of cloud-init, and
may affect CentOS 7. The following error is seen in the cloud-init logs:

    KeyError: 'gateway'

This change has been addressed in the jriguera.configdrive role, and
this change updates the version used in requirements.yml.

Story: 2007769
Task: 39993
[SEP]
FILES CHANGED:
ansible/group_vars/all/seed-vm (+3, -0)
ansible/seed-vm-provision.yml (+1, -34)
releasenotes/notes/fix-seed-multiple-networks-458915b085a9478c.yaml (+19, -0)
requirements.yml (+1, -1)
etc/kayobe/seed-vm.yml (+16, -0)
",-2.993217,0.01399,4.104041,-0.726431,-0.516393,0.456934,-0.419811,-0.312026,0.131134,-0.290361,-0.279309,0.596223,-0.144685,0.094413,0.000132
openstack/kayobe,I0e3be19eed371853d80c401d6a46770a7d6dcbc5,1,0,0,4.7958,0.1833,4,6.2,281,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,3,0,0.0,1.524,2.5,9.51,12.8,1,0,0.0,0,2.3223,0,0,0,0,0,"Update feature flags

The flags in etc/kayobe/kolla.yml were out of sync with
ansible/roles/kolla-ansible/vars/main.yml.

This commit sorts them all alphabetically and adds a script to simplify
generating the list.

TrivialFix
[SEP]
FILES CHANGED:
ansible/group_vars/all/kolla (+2, -2)
etc/kayobe/kolla.yml (+64, -4)
tools/feature-flags.py (+16, -0)
ansible/roles/kolla-ansible/vars/main.yml (+16, -16)
",-0.604693,-0.330043,-1.207122,0.01227,-0.246979,-0.535652,-0.238543,-0.083234,-0.378355,-0.367534,-0.485891,-0.422667,-0.428875,0.447718,-0.071601
openstack/octavia,Idb10f84fd32c50db24f844352cb85de452181439,0,0,0.0,3.2581,0.16,4,8.17,332,0,CI,0,0,0,4,0.078431,0.1481,0,0.0,6,3,0,0.4676,1.244,2.0,65.6,8.16,1,0,0.24,1,12.7692,0,0,0,0,0,"Use unittest.mock instead of mock

The mock third party library was needed for mock support in py2
runtimes. Since we now only support py36 and later, we can use the
standard lib unittest.mock module instead.

Also added and enabled a hacking check that would have caught this.
[SEP]
FILES CHANGED:
lower-constraints.txt (+0, -1)
octavia/tests/unit/api/drivers/driver_agent/test_driver_updater.py (+3, -3)
octavia/hacking/checks.py (+17, -0)
tox.ini (+1, -0)
",0.307831,-0.886138,-0.266213,0.703661,-0.413456,-0.194017,0.326117,-0.146023,-0.602484,0.381754,0.000922,0.017633,-0.204407,-0.26053,0.466541
openstack/kolla,I3e307efc43f934a944a91d5d131a11f607411df2,1,1,0.0,1.0986,0.0,2,9.33,238,0,Bug Fix,0,0,0,1,0.111111,0.0,0,0.0,3,1,0,1.0,1.0,3.0,22.12,18.02,1,0,0.0,0,79.3333,0,6,0,8,0,"add libibverbs package for openvswitch

ovs images which based on centos miss libibverbs package.
this ps add the package to neutron-ovs-agent and ovs-base
images.
Closes-Bug: 1882863
[SEP]
FILES CHANGED:
docker/neutron/neutron-openvswitch-agent/Dockerfile.j2 (+1, -0)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+1, -0)
",0.166382,-0.502712,-1.069578,-0.001875,0.474555,-1.009472,-0.245846,0.512185,-0.386861,-0.778898,-0.208943,0.095137,0.206016,0.308038,0.228154
openstack/kayobe,Id397e1aa7323212aad86a9d848904ec72d22bd26,1,0,0.125,0.6931,0.0,1,3.0,90,0,Feature,0,0,0,8,0.275862,0.0,0,0.0,0,1,0,0.5,0.0,0.0,-78.21,27.87,1,0,0.0,0,45.0,0,0,0,0,0,"Update .gitreview for stable/ussuri
[SEP]
FILES CHANGED:
.gitreview (+1, -0)
",3.317756,0.952928,1.496923,-0.354405,0.448875,-0.187414,0.310184,0.476539,0.234819,-0.254894,-0.787965,-0.75549,-0.211795,0.394155,0.161041
openstack/kayobe,I2b19e51b7b319b0243edab77065bba20820bebbf,1,0,0.2222,2.5649,0.5,1,11.8,476,0,CI,0,0,0,9,0.3,0.1429,0,0.0317,0,1,0,0.6667,0.0,0.0,19.92,14.89,1,0,0.0,1,36.6154,0,0,0,0,0,"Update TOX_CONSTRAINTS_FILE for stable/ussuri

Update the URL to the upper-constraints file to point to the redirect
rule on releases.openstack.org so that anyone working on this branch
will switch to the correct upper-constraints list automatically when
the requirements repository branches.

Until the requirements repository has as stable/ussuri branch, tests will
continue to use the upper-constraints list on master.
[SEP]
FILES CHANGED:
tox.ini (+6, -6)
",-1.352025,-0.588077,-0.046261,1.185104,0.47236,-0.416653,-0.059645,0.318306,0.195246,-0.021478,-0.184487,-0.063599,-0.064409,0.429264,0.013391
openstack/kayobe,I2b376303a9fef8fb3c1ada0c168bbb494216aa94,1,0,1.0,1.6094,0.0,1,21.0,207,0,Bug Fix,0,0,0,1,0.008264,0.0,0,0.0,1,1,0,0.75,0.0,1.0,-11.88,23.64,0,0,0.0,0,41.4,0,0,0,0,0,"Disable broken linting of literalinclude sphinx directive

Previously we were seeing:

AttributeError: 'Values' object has no attribute 'env'

TrivialFix
[SEP]
FILES CHANGED:
tools/sphinx8 (+4, -0)
",0.997412,-1.051913,-0.273275,-0.156372,-0.154224,0.205118,-1.012156,-0.392998,0.281228,0.082486,-0.072152,-0.444799,0.06016,-0.14299,-0.188245
openstack/kayobe,I6f065073feee42b2a0921a4aea98f7004fe5f7bf,1,0,0.0,5.1417,0.0059,12,17.0,192,0,Feature,0,0,0,2,0.006289,0.0,0,0.0,4,5,0,0.8,2.8698,2.83,-19.43,20.92,0,0,0.0471,1,1.1228,0,0,0,0,0,"Add framework to deploy user-defined containers on seed

Task: 39811

(cherry picked from commit aefd6e5a56ba9b172a8111f09c621afd09041a47)
[SEP]
FILES CHANGED:
kayobe/tests/unit/cli/test_commands.py (+8, -0)
doc/source/configuration/seed-custom-containers.rst (+61, -0)
etc/kayobe/seed.yml (+14, -0)
releasenotes/notes/deploy_containers-4199127a91f29be0.yaml (+5, -0)
ansible/roles/deploy-containers/tasks/deploy.yml (+36, -0)
ansible/group_vars/all/seed (+6, -0)
ansible/roles/deploy-containers/tasks/main.yml (+7, -0)
doc/source/deployment.rst (+3, -1)
ansible/roles/deploy-containers/defaults/main.yml (+13, -0)
ansible/seed-deploy-containers.yml (+7, -0)
doc/source/configuration/index.rst (+1, -0)
kayobe/cli/commands.py (+8, -0)
",0.104773,-0.437137,-2.122974,-2.055071,1.386029,0.400144,0.337122,-0.457257,0.050136,0.095404,-0.635067,0.579047,0.055153,0.080551,-0.340604
openstack/kayobe,I82fc455f41f48dacb453e135870dd776895d7c99,1,0,0.3333,5.0434,0.2922,13,13.5,357,0,Feature,0,0,0,3,0.006148,0.0,0,0.0,4,5,0,0.8333,2.9072,2.08,52.13,9.84,0,0,0.0,1,2.3032,0,0,0,0,0,"IPA: Switch to IPA builder and CentOS 8

Switches to use the IPA builder project for building IPA images.

Switches the IPA images used by default to CentOS 8 based image.

Changes the file extension of the IPA kernel image from vmlinuz to
kernel.

Story: 2007070
Task: 37953

Story: 2006574
Task: 39485
[SEP]
FILES CHANGED:
releasenotes/notes/ipa-builder-ea6308b6691ae71e.yaml (+24, -0)
doc/source/configuration/bifrost.rst (+1, -1)
ansible/seed-service-upgrade-prep.yml (+2, -2)
dev/tenks-deploy-config-compute.yml (+1, -1)
ansible/group_vars/all/ipa (+32, -10)
ansible/overcloud-ipa-images.yml (+1, -1)
ansible/roles/kolla-bifrost/templates/bifrost.yml.j2 (+0, -15)
ansible/kolla-openstack.yml (+1, -1)
playbooks/kayobe-overcloud-upgrade-base/run.yml (+2, -3)
doc/source/configuration/ironic-python-agent.rst (+22, -6)
ansible/group_vars/all/bifrost (+1, -1)
ansible/seed-ipa-build.yml (+1, -1)
etc/kayobe/ipa.yml (+21, -3)
",-1.143258,-1.560567,-0.916595,0.113334,-0.038411,-0.044111,-0.77378,1.321505,0.172682,0.207888,0.055259,0.116528,0.541954,0.646631,-0.073603
openstack/octavia,Ibc525d9a046a5ab7f090a942459d80a2df66ae2e,1,0,0.7778,5.4072,0.3378,10,11.78,814,0,Bug Fix,0,0,0,18,0.013363,0.4615,0,0.359,7,3,0,0.4643,1.7965,3.8,18.5,16.41,0,0,0.8063,1,3.6502,0,0,0,0,0,"Fix memory consumption issues with default connection_limit

With 1.8.x releases, haproxy consumes a lot of memory when
using 1,000,000 as default connection_limit.

This commit introduces a new configuration option for the Amphora
provider: [haproxy_amphora].default_connection_limit (defaulted to
50,000). This value is used when creating a listener with -1 (which is
the default) as connection_limit, or when unsetting connection_limit in
a listener.
Updating an existing listener by setting connection_limit to -1 also
sets it to default_connection_limit.

The global connection_limit for a load balancer is the sum of the
connection_limit of the listeners, but it cannot be over
HAPROXY_MAX_MAXCONN (which is still 1,000,000).

Story: 2007794
Task: 40046
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+4, -2)
octavia/common/config.py (+5, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+4, -3)
octavia/common/constants.py (+3, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+3, -3)
releasenotes/notes/new-default_connection_limit-config-option-3ed9f0ed6ec2b514.yaml (+18, -0)
octavia/tests/functional/api/v2/test_load_balancer.py (+1, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+95, -56)
etc/octavia.conf (+4, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+10, -10)
",-3.01014,0.134482,1.663871,0.362477,0.545219,0.609564,-0.495079,-0.070692,0.535229,0.022971,0.206079,0.129301,-0.334821,-0.043326,-0.05811
openstack/kayobe,Ideada0f299f34d16d1286633b6e21404b736918b,1,0,0.5,1.7918,0.6,1,17.0,524,0,Bug Fix,0,0,0,4,0.006231,1.0,0,0.5,1,1,0,0.8571,0.0,1.0,26.6,17.39,0,0,0.0,0,87.3333,0,0,0,0,0,"Fix ironic inspector store endpoint configuration

When performing inspection on baremetal compute nodes, inspector
currently has the following failure when storing inspection data to the
introspection store:

    No 'keystoneauth1.plugin' driver found, looking for 'token_endpoint'

This happens because the token_endpoint auth type is no longer
available. The new way to do this is to set auth_type = none and provide
an endpoint override.

Story: 2007795
Task: 40049
[SEP]
FILES CHANGED:
ansible/kolla-openstack.yml (+2, -3)
",-0.82872,-1.500198,-0.114275,0.309142,-0.034233,-0.189807,0.044697,0.210536,0.29903,-0.22127,0.270832,-0.3395,0.065673,0.059615,-0.02159
openstack/castellan,I1c0d00675a479cf05d92cec7b69fd720a88023d3,1,0,0,4.4427,0.9524,3,6.4,322,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0,1.0258,3.33,20.56,13.81,1,0,0.6429,0,3.7882,0,0,0,0,0,"Removes context ""validation"".

The Vault backend doesn't really care about context. Even an empty
string would suffice these checks.

(cherry picked from commit 8e88919f02781d699a73e815cf8f7be72d4db352)
[SEP]
FILES CHANGED:
castellan/key_manager/vault_key_manager.py (+0, -30)
castellan/tests/functional/key_manager/test_vault_key_manager.py (+3, -50)
castellan/tests/functional/key_manager/test_key_manager.py (+1, -0)
",-0.11312,-0.655117,-1.739953,-1.23293,0.881114,0.594639,0.424158,-0.872832,0.109912,0.225602,-0.580105,-0.073866,0.225401,-0.080402,-0.273542
openstack/kayobe,Ie2a0a6bf75dc88458796a9691891e76f578d87ad,1,0,0.6,3.091,0.2381,5,8.22,582,0,Bug Fix,0,0,0,5,0.007728,0.0,0,0.0,2,2,0,0.875,1.9136,1.0,30.43,10.86,0,0,0.0,1,26.4545,0,0,0,0,0,"Fix kayobe baremetal compute commands

Since adding support for Python 3, the following commands fail:

* kayobe baremetal compute inspect
* kayobe baremetal compute manage
* kayobe baremetal compute provide

There are two issues:

1. There is a missing /bin from the ansible_python_interpreter path used.

2. The stackhpc.os-ironic-nodes role fails with an undefined variable:

    name 'openstack_cloud_from_module' is not defined

This is fixed in the stackhpc.os-ironic-nodes role version 1.3.1.

Story: 2007797
Task: 40051
[SEP]
FILES CHANGED:
ansible/baremetal-compute-inspect.yml (+1, -1)
ansible/baremetal-compute-provide.yml (+1, -1)
releasenotes/notes/fix-baremetal-compute-commands-b72862a53f88c5ef.yaml (+11, -0)
requirements.yml (+1, -1)
ansible/baremetal-compute-manage.yml (+2, -2)
",-2.076971,-0.557742,0.742124,-0.355335,0.109576,-0.433591,-0.423249,0.559953,-0.126668,-0.053295,0.340641,-0.076958,-0.242281,0.354392,0.034761
openstack/kolla,I9f4a21bbf1c8383e21e59350206aba3424602270,1,1,0,3.2958,0.5,1,8.0,159,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,18.94,15.7,1,0,0.0,0,5.8889,0,6,0,8,0,"Change lang package block order

Fix offline installation of language pack packages.
Closes-bug: #1883233
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+13, -13)
",1.458971,-0.989538,-0.199106,-0.625835,-0.152493,0.17371,-0.77983,0.609412,0.231065,-0.298621,-0.103509,0.001282,0.129393,-0.108476,0.206776
openstack/oslo.messaging,I51cf67e060f240e6eb82260e70a057fe599f9063,0,0,0,4.4067,0.0,5,13.0,955,0,CI,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.0,1.737,1.8,45.74,11.91,1,0,0.3457,1,11.6463,0,0,0,0,0,"Add a ping endpoint to RPC dispatcher

The purpose of this patch is to add an endpoint directly in RPC
dispatcher, so this endpoint will always be available, in a cross
project manner, without the need for projects to manage it by themself.

This endpoint stay disabled by default, so this change is harmless
without a specific configuration option.

To enable this ping endpoint, an operator will just have to add a new
parameter in the [DEFAULT] section, alongside with rpc_response_timeout
[DEFAULT]
rpc_ping_enabled=true  # default is false

The purpose of this new endpoint is to help operators do a RPC call (a
ping) toward a specific RPC callback (e.g. a nova-compute, or a
neutron-agent).
This is helping a lot for monitoring agents (for example, if agents are
deployed in a kubernetes pod).

The endpoint is named oslo_rpc_server_ping.
[SEP]
FILES CHANGED:
oslo_messaging/tests/rpc/test_dispatcher.py (+28, -0)
oslo_messaging/rpc/dispatcher.py (+36, -0)
oslo_messaging/opts.py (+2, -0)
oslo_messaging/conffixture.py (+2, -0)
releasenotes/notes/add-ping-endpoint.yaml (+13, -0)
",-2.600139,-0.920234,2.410814,-0.237129,-0.075259,0.024064,-0.017947,-0.088381,0.104413,-0.254301,0.11423,0.201896,-0.307795,-0.155367,-0.287763
openstack/kolla-ansible,I6db4af4c6e3364838bdae510f300038b0c1560b0,1,1,0.5,3.091,0.2381,1,12.5,376,0,Bug Fix,0,0,0,2,0.007168,0.0,0,0.0,4,1,0,0.5,0.0,4.0,35.1,15.4,1,0,0.0,0,17.0909,0,8,0,6,0,"Fix issues with Prometheus config generation

related to newly introduced merge mechanism.
1) Per-host overrides cannot be run_once.
2) Since merge_yaml is silent about missing files, it ignored
   the fact that no proper file was given due to wrong variable
   being referenced (see the closed bug).

Closes-Bug: #1882460
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/config.yml (+16, -5)
",-0.033221,-1.700078,-0.217039,0.156835,-0.619851,0.195098,-0.152052,-0.182197,0.365343,0.256501,0.008773,-0.315551,0.124656,0.162218,-0.018704
openstack/kolla-ansible,Ic175ebdb1da6ef66047309ff07bcbba98fc67008,1,1,0.6667,2.3026,0.2222,3,8.0,200,0,Bug Fix,0,0,0,3,0.01,0.0,0,0.0,4,2,0,0.5556,1.4355,3.33,40.09,13.2,0,0,0.0,1,20.0,0,6,0,11,0,"Fix Grafana datasource update

Grafana changed the error message wording.
Match on the shortest sane string to play it safe.

Closes-Bug: #1881890
[SEP]
FILES CHANGED:
ansible/roles/grafana/tasks/post_config.yml (+1, -1)
releasenotes/notes/bug-1881890-72c76f5fc065588b.yaml (+5, -0)
ansible/roles/monasca/tasks/post_config.yml (+1, -1)
",1.27665,-1.252865,-0.643844,-0.648696,-0.699236,0.717975,-0.381954,-0.106015,0.028313,-0.409712,0.404445,0.084832,-0.206601,-0.261332,-0.00386
openstack/kayobe,Ia81e70e45c3e8a68720535b4f4d117f9951ed360,1,0,0.6667,1.6094,0.5,1,13.25,478,0,Bug Fix,0,0,0,6,0.008982,0.0,0,0.0,1,1,0,0.8889,0.0,1.0,6.63,15.11,1,0,0.0,0,95.6,0,0,0,0,0,"Fix kolla-ansible config when a network is named 'external'

Since I2172a74f4719605f6ec81fadec46ce49f8310a96, kolla-ansible.yml fails
if there is a network named external:

    recursive loop detected in template string: {{ item in
    (network_interfaces | net_select_bridges | map('net_interface')) }}

Rename the task variable 'external_interface' to avoid this conflict.

Affects master only.

Story: 2007814
Task: 40087
[SEP]
FILES CHANGED:
ansible/kolla-ansible.yml (+2, -2)
",-1.387925,-0.360368,0.032329,-0.96276,0.654065,-0.036163,-0.369422,-0.240684,0.390168,-0.106856,0.095946,-0.315844,-0.119511,0.131344,-0.217851
openstack/kolla,Icc9d65c4ce22c959145a8d95fc6b823252659ddd,1,0,1.0,1.0986,0.5,1,8.0,97,0,Feature,0,0,0,1,0.2,0.0,0,0.0,3,1,0,1.0,0.0,3.0,8.37,18.2,0,0,0.0,0,32.3333,0,0,0,0,0,"cyborg-api: install proper WSGI for CentOS
[SEP]
FILES CHANGED:
docker/cyborg/cyborg-api/Dockerfile.j2 (+1, -1)
",2.251957,0.524544,1.339509,-0.464192,0.095274,-0.468331,-0.241731,0.651247,-0.174665,-0.236226,-0.212367,0.078445,0.055982,-0.157585,0.339478
openstack/kolla-ansible,Id89c4ec6ff8b80feace01a3dee7dd30dd4cc5ec5,1,0,0.75,4.3438,0.5658,2,7.67,183,0,Bug Fix,0,0,0,4,0.012945,0.0,1,0.0,3,1,0,0.6,0.7668,3.0,37.21,11.76,1,1,0.0,0,2.3766,0,0,0,0,0,"[docs] Update quickstart for Ussuri+

Mostly due to move to Python3-only.

Also fix the other venv docs to avoid virtualenv. :-)
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+28, -31)
doc/source/user/virtual-environments.rst (+5, -12)
",0.121986,-1.524276,-1.120659,-1.722321,0.159321,-0.093291,0.468739,0.149867,-0.081403,0.361487,-0.668398,-0.3942,0.176248,-0.03047,-0.134526
openstack/kolla,I81e5b7abf4571fece13a029e25911e9e4dece673,1,1,0,2.3979,0.1,2,10.24,2124,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,2,0,1.0,0.8813,2.0,38.48,11.6,1,0,0.0,1,193.0909,0,6,0,16,0,"Drop systemd support from nsswitch.conf on RHEL-based distros

A bit like we did for I3e0e86026f5a4a78473bed824cd1682d3a020cd5 we
should remove the nss-systemd lookup from containers. The reasons for
this are as follows:
1) Just like for I3e0e86026f5a4a78473bed824cd1682d3a020cd5
when this nss module is triggered it tries to talk to dbus.
It triggers a bunch of selinux denials and it makes little sense
to open all containers to talk to dbus.
In particular, if a container is run as non-privileged and bind-mounts
/run from the host, we will hit selinux denials like the following:

  type=USER_AVC msg=audit(1592337775.860:74119): pid=1284 uid=81 auid=4294967295 ses=4294967295 subj=system_u:system_r:system_dbusd_t:s0-s0:c0.c1023 msg='avc:  denied  { send_msg } for msgtype=method_call interface=org.freedesktop.DBus member=Hello dest=org.freedesktop.DBus spid=406228 scontext=system_u:system_r:container_t:s0:c162,c886 tcontext=system_u:system_r:system_dbusd_t:s0-s0:c0.c1023 tclass=dbus permissive=0  exe=""/usr/bin/dbus-daemon"" sauid=81 hostname=? addr=? terminal=?'UID=""dbus"" AUID=""unset"" SAUID=""dbus""

2) It just makes little sense in a kolla-world to have containers
talk to dbus/systemd and it saves us some time when a lookup triggers
the systemd module for whatever reason. Especially because the
nss-systemd module does a few things which are not useful in a container
(ensures that the root and nobody users and groups remain resolvable,
SystemD's DynamicUser= feature, provide Lookup API via Varlink)

The sed regex gives us the wanted results:
$ diff -u /etc/nsswitch.conf.orig /etc/nsswitch.conf
--- /etc/nsswitch.conf.orig     2020-06-19 07:18:10.974580755 +0000
+++ /etc/nsswitch.conf  2020-06-19 07:20:12.260230103 +0000
@@ -53,9 +53,9 @@
 # group:     db files

 # In order of likelihood of use to accelerate lookup.
-passwd:      sss files systemd
+passwd:      sss files
 shadow:     files sss
-group:       sss files systemd
+group:       sss files
 hosts:      files dns myhostname
 services:   files sss
 netgroup:   sss

Related-Bug: #1883849
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+2, -1)
releasenotes/notes/disable-systemd-nss-on-rhel-based-distros-5d586fcdb9a82da7.yaml (+7, -0)
",-3.381873,0.542708,3.416834,-1.71942,0.490961,0.470071,-0.895214,-0.659822,-0.738874,-0.107829,-0.546903,0.20809,0.047396,0.18672,0.053436
openstack/kayobe,I28d88f2f28f5ff8fbd0f2df98bac3740d05f224b,1,0,1.0,1.0986,0.5,1,9.0,99,0,Feature,0,0,0,2,0.016,0.0,1,0.0,3,1,0,0.9,0.0,3.0,56.7,8.04,0,0,0.0,0,33.0,0,0,0,0,0,"Add missing colon

Story: 2007818
Task: 40096
[SEP]
FILES CHANGED:
doc/source/configuration/network.rst (+1, -1)
",1.140944,0.730574,-1.11655,-0.721456,0.119153,1.669073,-1.315452,-0.361242,0.401771,-0.130295,0.477122,0.57878,0.614793,1.408607,-0.22871
openstack/kolla-ansible,I4d6e4f43bcf3dc31cad0675f94724dbc4fcb466f,1,0,0,1.0986,0.0,1,7.0,79,0,CI,1,0,0,0,0.0,0.0,0,0.0,1,1,0,0.6364,0.0,1.0,54.7,14.23,0,0,1.0,0,26.3333,0,0,0,0,0,"CI: Make ARA rsync quiet
[SEP]
FILES CHANGED:
tests/post.yml (+2, -0)
",2.752853,1.241642,0.638851,-0.240789,0.716966,0.556732,-0.755346,0.0364,-0.924457,0.377888,0.255453,-0.715888,0.554462,-0.047675,-0.486308
openstack/kolla,If6663b2f6dfadfd6a6db5e4aaca4eb782b87161f,1,1,1.0,2.5649,0.0,2,12.67,254,0,Bug Fix,0,0,0,1,0.142857,0.0,0,0.0,2,2,0,1.0,0.9799,2.0,60.4,10.33,1,0,0.0,1,19.5385,0,0,0,0,0,"Fix loading of Storm on Centos8 / Python 3

In the Centos8 images, Storm fails to start since it cannot find
Python. This patch ensures that it can by setting the PYTHON env
var.

Closes-Bug: #1876461
[SEP]
FILES CHANGED:
releasenotes/notes/fix-loading-of-storm-in-centos8-containers-86b38c9166ceb0dd.yaml (+5, -0)
docker/storm/Dockerfile.j2 (+7, -0)
",0.32763,-1.245577,-0.446733,-0.20214,-0.522805,0.281204,-0.55458,0.498872,-0.532551,0.277246,0.162776,-0.077787,0.171405,-0.279901,0.120932
openstack/kolla-ansible,I5d0384b38ddb38133e5e11df85d8cf76f4044a64,1,0,1.0,0.0,0,1,13.67,318,0,Bug Fix,0,1,0,2,0.105263,0.0,0,0.0,5,1,0,0.6667,0.0,5.0,36.14,14.25,0,0,0,0,318.0,0,0,0,0,0,"Revert rename of Monasca API config file

I9b6bf5b6690f4b4b3445e7d15a40e45dd42d2e84 was updated to use the original
config file name during review, but the config file was not renamed
accordingly. The result is that an empty config file is written out.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/monasca/templates/monasca-api/api.conf.j2 (+0, -0)
",-0.186669,-0.928108,-1.241883,-0.71266,0.662995,0.501525,1.043261,-0.364676,0.44298,0.278618,-0.111847,0.469724,-0.468877,0.146025,0.021541
openstack/octavia,I6f372a3f82fdf4f41e661e640e4a983cf484ed6d,1,0,0.7895,1.6094,0.5,1,14.33,336,0,Bug Fix,1,0,0,19,0.01211,0.6667,0,0.5263,5,1,0,0.4681,0.0,5.0,23.09,18.76,0,0,1.0,0,67.2,0,0,0,0,0,"Fix listener API's test_create* assertions

Assertions were using the same expressions on both side: optionals and
lb_listener are both parameters to the API (and the lb_listener dict
contains all optionals items).
Those assertions should compare the parameters to the API results.
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_listener.py (+2, -2)
",-0.142516,-1.60877,-0.176056,0.650335,0.392839,-0.157144,-0.408682,-0.389867,0.022904,-0.243431,-0.501515,-0.358283,-0.183328,0.113666,-0.490576
openstack/kolla,I1579e762bcfb07f0baa73507eb9955ae2f83c4ec,1,1,1.0,4.3175,0.6622,4,7.2,316,0,Bug Fix,0,0,0,3,0.157895,1.0,0,1.0,2,2,0,1.0,1.0875,2.0,9.18,11.77,1,0,0.0,1,4.2133,0,16,0,17,0,"Upgrade to Logstash 6

Elasticsearch and Kibana 6 are used on all distros, but Logstash
is still pinned at 2 which is not compatible. See the product
compatibility matrix [1].

[1] https://www.elastic.co/support/matrix#matrix_compatibility

Partial-Bug: #1884090
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -4)
releasenotes/notes/add-logstash6-everywhere-7f9027ff17c6022d.yaml (+4, -0)
kolla/template/repos.yaml (+7, -0)
docker/logstash/Dockerfile.j2 (+13, -45)
",-1.489496,-0.282104,-0.587786,-1.196394,-0.029702,-0.08577,0.403844,0.590622,0.069682,0.717226,0.149387,-0.166303,0.024587,-0.153871,-0.456106
openstack/octavia,Id9e19375ebca6a720e6a85006f5e8948d3aed760,1,0,0.8,4.4067,0.0494,5,24.75,634,0,Bug Fix,0,0,0,20,0.012715,1.0,0,0.8,6,2,0,0.4718,1.7569,3.6,38.15,16.77,0,0,0.5309,1,7.7317,0,0,0,0,0,"Fix invalid DOWN status when updating a UDP pool

When adding a new UDP member or a UDP-CONNECT health-monitor to a UDP
pool, there can be a race condition in the first heartbeat message
sent to the health-manager service.
This message might contain a DOWN status for a working member that
hasn't been checked yet.

This commit introduces a new member status between the amphora-agent and
the health-manager: it indicates that the UDP pool has been updated and
that the status of a member is a transitional state, preventing an
incorrect ERROR status.

Story: 2007792
Task: 40042
[SEP]
FILES CHANGED:
releasenotes/notes/fixed-unstable-UDP-health-status-ba32690b83a9641b.yaml (+7, -0)
octavia/common/constants.py (+2, -0)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+19, -2)
octavia/controller/healthmanager/health_drivers/update_db.py (+8, -0)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+41, -2)
",-1.222302,-1.785142,0.66379,0.460791,-0.229254,0.121689,0.328476,0.092014,0.84795,-0.028879,0.232412,0.761426,0.129137,0.42921,0.128552
openstack/octavia,I0213424eaafe079e7f9a9aaee8e29514c7e840f4,1,0,0.1667,3.5264,0.9394,6,6.67,271,0,Feature,0,0,0,6,0.008746,0.3636,0,0.0606,3,2,0,0.4755,1.7984,2.0,58.36,7.67,1,0,0.7273,1,7.9706,0,0,0,0,0,"Remove install DIB from Git option

DIB no longer supports Python 2 and is upper constrainted to 2.30.0.
Allowing to install DIB from Git would cause nothing but trouble. Just
rely on pip to a functional DIB version.
[SEP]
FILES CHANGED:
playbooks/legacy/octavia-v1-dsvm-scenario/run.yaml (+0, -1)
octavia/tests/contrib/gate_hook.sh (+0, -3)
devstack/plugin.sh (+0, -7)
playbooks/legacy/octavia-v1-dsvm-py3x-scenario/run.yaml (+0, -1)
zuul.d/projects.yaml (+2, -17)
zuul.d/jobs.yaml (+0, -2)
",0.190014,-0.732709,-0.670382,0.844405,-0.056896,0.295313,0.220794,0.013937,-0.781639,0.907937,-0.276669,0.275881,-0.340036,-0.280252,0.18833
openstack/octavia,Ia0dddac00155e11098fcbd3e95bcae12f2fc63d4,1,0,0,4.7958,0.4917,1,3.0,189,0,Feature,0,0,0,0,0.0,0.3333,0,0.0,1,1,0,0.4792,0.0,1.0,0.75,17.2,1,0,0.0,0,1.562,0,0,0,0,0,"diskimage-create compatible with ShellCheck.

Update diskimage-create script to pass in
ShellCheck (https://www.shellcheck.net/) tool.
[SEP]
FILES CHANGED:
diskimage-create/diskimage-create.sh (+61, -59)
",0.645049,0.992403,-0.317072,0.446424,-0.098938,0.213958,-0.187895,0.058114,-0.338666,-0.547525,-0.39277,0.248602,0.335694,0.596032,-0.560533
openstack/kayobe,I0aae6eaa8a2351c15a29b45427e6971e60b9e1a8,1,0,0,1.3863,1.0,2,7.0,97,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.9091,0.9183,4.0,-78.24,25.66,1,0,0.6667,0,24.25,0,0,0,0,0,"Remove remaining mentions of neutron-lbaas
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/tests/test-extras.yml (+0, -2)
ansible/roles/kolla-ansible/defaults/main.yml (+0, -1)
",2.650833,0.729243,0.851229,0.06321,0.857374,-0.418775,0.414478,0.293628,0.137597,-0.836982,-0.352702,0.340877,-0.137827,0.295312,-0.104186
openstack/kayobe,Ib27deac4ddf4976a571b192ee5d1b8ca57701916,1,0,0.7143,3.4012,0.1724,4,10.33,474,0,CI,0,0,0,7,0.010417,1.0,0,0.7143,3,4,0,0.9167,1.208,1.75,38.06,9.29,1,0,0.0,1,15.8,0,0,0,0,0,"Add support for custom options in static routes

Currently it is possible to set the CIDR, gateway and route table for
static routes. Other options cannot be set. This change adds support for
setting arbitrary options via an 'options' attribute in the route, which
should be a list of additional options to apply.

Depends on
https://github.com/michaelrigart/ansible-role-interfaces/pull/74.

Story: 2007835
Task: 40122
[SEP]
FILES CHANGED:
ansible/filter_plugins/networks.py (+1, -0)
releasenotes/notes/custom-route-options-2ed446961262a34a.yaml (+5, -0)
requirements.yml (+1, -1)
doc/source/configuration/network.rst (+17, -4)
",-0.90422,-0.043923,-0.115269,0.666953,-0.553393,-0.132049,0.148151,0.049449,0.627979,0.433637,-0.247928,-0.109961,0.374171,0.096925,-0.229921
openstack/kolla,I61711a878b2bda9f0d2e88966f13121dfcddfda7,1,0,1.0,2.1972,0.5,1,8.25,260,0,Feature,0,0,0,2,0.285714,0.0,0,0.0,2,1,0,1.0,0.0,2.0,42.08,15.42,0,0,0.0,0,28.8889,0,0,0,0,0,"kolla-toolbox: use u-c while installing virtualenv

We need to be sure that we use exact same version every time. So fetch
upper-constraints.txt file earlier and use it while installing
virtualenv package.
[SEP]
FILES CHANGED:
docker/kolla-toolbox/Dockerfile.j2 (+4, -4)
",0.804729,-0.98791,-0.398111,0.472075,0.005724,-0.551432,0.364855,-0.337644,-0.53134,-0.061869,-0.119025,-0.070378,-0.129953,0.241161,0.049788
openstack/octavia,I3a013aebd1eb89cd4f983fbf4f8ae8d6639548cd,0,0,0,8.5297,0.5004,33,8.78,623,0,Feature,0,0,0,0,0.0,1.0,0,0.0,6,4,0,0.4828,2.9391,3.52,25.51,16.17,1,0,0.6727,1,0.123,1,0,0,0,0,"Refactoring amphora stats driver interface

Previously the stats driver was responsible for parsing the health
message, which should have been done prior to passing the stats to the
driver interface.

Removed the driver interface for the health updater because it is core
Octavia functionality.

Stats drivers is now a singleton and can load multiple drivers.

Both the amphora health manager AND provider statistics should use the
new driver interface.

Co-Authored-By: Stephanie Djajadi <stephanie.djajadi@gmail.com>
Co-Authored-By: Adam Harwell <flux.adam@gmail.com>
[SEP]
FILES CHANGED:
octavia/common/config.py (+12, -6)
octavia/tests/unit/statistics/test_stats_base.py (+97, -0)
octavia/tests/unit/statistics/drivers/__init__.py (+0, -0)
octavia/statistics/drivers/__init__.py (+0, -0)
octavia/tests/unit/api/drivers/driver_agent/test_driver_updater.py (+43, -27)
etc/octavia.conf (+6, -6)
octavia/statistics/stats_base.py (+60, -0)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_base.py (+0, -38)
octavia/common/stats.py (+7, -1)
octavia/db/repositories.py (+23, -11)
octavia/api/drivers/driver_agent/driver_updater.py (+27, -13)
octavia/tests/unit/amphorae/drivers/health/test_heartbeat_udp.py (+1439, -33)
octavia/tests/unit/statistics/drivers/test_update_db.py (+78, -0)
octavia/opts.py (+1, -1)
octavia/tests/unit/statistics/__init__.py (+0, -0)
octavia/tests/unit/amphorae/drivers/test_noop_amphoraloadbalancer_driver.py (+0, -14)
octavia/amphorae/drivers/driver_base.py (+0, -58)
octavia/controller/healthmanager/health_drivers/update_logging.py (+0, -29)
octavia/statistics/__init__.py (+0, -0)
octavia/tests/unit/statistics/drivers/test_logger.py (+34, -0)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_db.py (+0, -1476)
octavia/db/models.py (+0, -1)
octavia/controller/healthmanager/health_drivers/update_db.py (+0, -606)
octavia/statistics/drivers/update_db.py (+43, -0)
octavia/tests/functional/db/test_repositories.py (+68, -14)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_logging.py (+0, -44)
octavia/common/data_models.py (+7, -2)
releasenotes/notes/stats-update-drivers-interface-changes-c8f2bf3b02eec767.yaml (+17, -0)
octavia/statistics/drivers/logger.py (+29, -0)
octavia/controller/healthmanager/health_drivers/update_base.py (+0, -27)
setup.cfg (+3, -6)
octavia/amphorae/drivers/health/heartbeat_udp.py (+535, -108)
octavia/amphorae/drivers/noop_driver/driver.py (+0, -12)
",-2.184184,0.307862,0.371123,0.528577,-0.281381,0.23748,-0.102843,0.382887,-0.124287,-0.204963,0.492967,0.705325,0.06566,0.159285,-0.28687
openstack/kayobe,I2e45876f89121d66cf03b50824bd8258517b88cb,1,0,1.0,3.8286,0.0444,8,12.0,129,0,Feature,0,0,0,1,0.25,1.0,0,1.0,3,4,0,0.9231,2.6939,2.12,32.5,14.8,1,0,0.0,1,2.8043,0,0,0,0,0,"Allow to customise hardware inspection timeouts

Story: 2007844
Task: 40135
[SEP]
FILES CHANGED:
ansible/overcloud-hardware-inspect.yml (+1, -1)
ansible/baremetal-compute-inspect.yml (+1, -1)
doc/source/configuration/bifrost.rst (+4, -0)
ansible/group_vars/all/inspector (+7, -0)
etc/kayobe/bifrost.yml (+4, -0)
releasenotes/notes/hardware-inspection-timeouts-777f3bb569929f0f.yaml (+15, -0)
etc/kayobe/inspector.yml (+7, -0)
ansible/group_vars/all/bifrost (+4, -0)
",0.957972,0.224739,-1.139606,-0.455569,0.146792,1.174387,-1.135478,-0.454052,0.324925,-0.309622,0.545568,0.225597,0.586635,0.304626,-0.265061
openstack/kolla,I2559267d120081f2e5eabc9d966b019517a5ad5d,1,0,1.0,2.7726,0.6667,4,6.0,251,0,Feature,0,0,0,3,0.2,1.0,0,1.0,2,4,0,1.0,1.8323,2.0,42.83,10.4,0,0,0.0,1,15.6875,0,0,0,0,0,"CentOS/AArch64: RabbitMQ is back!

CentOS 8.2 has Erlang and RabbitMQ available in 'messaging/rabbitmq-38'
repository. We use it to grab Erlang while RabbitMQ comes from upstream
(like on x86-64).
[SEP]
FILES CHANGED:
kolla/image/build.py (+0, -2)
docker/base/Dockerfile.j2 (+4, -1)
kolla/template/repos.yaml (+1, -1)
docker/base/rabbitmq_rabbitmq-erlang-aarch64.repo (+0, -6)
",0.867798,0.213407,-0.591311,-0.1176,-0.380205,-0.165203,0.162855,0.673782,-1.055854,0.000877,-0.18279,-0.028434,-0.143669,0.005929,-0.015985
openstack/octavia,I293a30ddef77c09808a204c87a594a91bb6992da,0,0,0.4487,3.7842,0.0,2,6.71,368,0,Feature,0,0,0,78,0.003325,0.0,0,0.0,4,1,0,0.4795,0.9682,3.0,36.22,12.9,1,0,0.3953,0,8.3636,0,0,0,0,0,"Add an upgrade check for YAML oslo policy file

Oslo policy is deprecating[1] the JSON file format for oslo policy
files.
This patch adds an upgrade check that includes a warning if a JSON
policy file is being used with Octavia.

[1] https://review.opendev.org/733650

Depends-On: https://review.opendev.org/733650
[SEP]
FILES CHANGED:
octavia/cmd/status.py (+26, -0)
octavia/tests/unit/cmd/test_status.py (+17, -0)
",-0.701385,1.216092,-0.024878,0.740304,-0.873616,-0.019623,0.573197,0.449835,0.382454,0.326228,0.249356,0.04198,0.040611,-0.135051,-0.16164
openstack/kayobe,I238aeefefa88dd584ce61ac9eb52d50552336ed0,1,0,1.0,1.0986,0.5,1,11.0,172,0,Bug Fix,0,0,0,2,0.040816,1.0,0,1.0,3,1,0,0.9286,0.0,3.0,26.47,17.13,1,0,0.0,0,57.3333,0,0,0,0,0,"Fix condition of placement image build

This should fix placement image build if nova is disabled but zun is
enabled.
[SEP]
FILES CHANGED:
ansible/group_vars/all/kolla (+1, -1)
",-0.085563,-0.425368,-2.045661,-1.228997,1.054778,0.190519,0.692741,-0.607751,0.014256,-0.172959,-0.12474,0.087943,0.273421,-0.147388,-0.3818
openstack/kolla-ansible,I7214ef38ea529f7585d7a0c75b8b0498ea4c58a2,1,1,1.0,1.7918,0.0,2,11.0,126,0,Bug Fix,0,0,0,3,0.058824,0.0,0,0.0,4,2,0,0.6923,0.7219,3.0,-11.98,22.58,1,0,0.0,1,21.0,0,6,0,9,0,"Fix Magnum trust operations in multi-region clouds

Closes-Bug: #1885078
[SEP]
FILES CHANGED:
releasenotes/notes/magnum-trustee-keystone-region-name-002162a45f855faf.yaml (+4, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -0)
",2.296123,0.270256,0.143187,-1.168015,-0.524201,0.806945,-0.773053,0.349873,0.312631,-0.384688,0.266587,0.103718,0.563805,-0.296398,0.594549
openstack/kolla-ansible,Id22eb3e74867230da02543abd93234a5fb12b31d,1,1,1.0,2.7081,0.1429,3,14.17,593,0,Bug Fix,0,0,0,1,0.333333,0.0,0,0.0,4,2,0,0.7143,1.1488,2.33,40.18,14.14,0,0,0.1429,1,39.5333,0,6,0,11,0,"openvswitch: Use ansible_hostname for system-id

Currently openvswitch sets system-id based on inventory_hostname, but when
Ansible inventory contains ip addresses - then it will only take first ip
octet - resulting in multiple OVN chassis being named i.e. ""10"".
Then Neutron and OVN have problems functioning, because a chassis named ""10""
will be created and deleted multiple times per second - this ends up in
ovsdb and neutron-server processes using up to 100% CPU.

Adding openvswitch role to ovn CI job triggers.

Closes-Bug: #1884734
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/defaults/main.yml (+1, -1)
zuul.d/base.yaml (+1, -1)
releasenotes/notes/bug-1884734-ec054799d3300778.yaml (+10, -0)
",-1.618012,-1.19768,0.715612,-0.141564,0.027654,-0.573029,-0.253372,0.298752,-0.32357,-0.242818,0.182471,-0.165342,0.150938,0.068908,-0.057293
openstack/kolla-ansible,Ie4fa8e3a60d69cf5c4bdd975030c92be8113ffb1,1,1,0.75,2.1972,0.125,2,7.57,470,1,Bug Fix,0,0,0,8,0.011412,0.0,0,0.0,4,2,0,0.7333,0.8113,3.0,-5.17,17.37,1,0,0.0,1,52.2222,0,6,0,7,0,"Verify TLS by default for Kibana to Elasticsearch

Currently, if internal TLS communication is enabled, Kibana to
Elasticsearch communication is unverified. This is because we set
elasticsearch.ssl.verificationMode to 'none' by default (via
kibana_elasticsearch_ssl_verify). This is poor a security
posture.

This change changes the default value of
'kibana_elasticsearch_ssl_verify' to 'true'.

Closes-Bug: #1885110
[SEP]
FILES CHANGED:
releasenotes/notes/kibana-tls-verify-8bfcb822268ad0d8.yaml (+6, -0)
ansible/roles/kibana/defaults/main.yml (+1, -1)
",-2.14893,0.657899,-0.497273,0.910682,0.637377,0.34553,-0.544622,-0.070492,0.127595,-0.03549,0.60936,-0.181862,-0.282671,-0.176325,0.167496
openstack/kolla-ansible,I5bbf55a4dd4ccce9fa2635cee720139c088268e3,1,1,0.7778,2.9444,0.0,4,15.0,364,0,Bug Fix,0,0,0,9,0.012694,0.0,0,0.0,6,3,0,0.75,1.7108,4.5,26.17,17.56,1,0,0.0,1,19.1579,0,6,0,7,0,"Support CA certificate for fluentd & Elasticsearch

Currently there is no way to configure a CA certificate bundle file for
fluentd to Elasticsearch communication. This change adds a new variable,
'fluentd_elasticsearch_cacert' with a default value set to the value of
'openstack_cacert.

Closes-Bug: #1885109
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/01-es.conf.j2 (+3, -0)
releasenotes/notes/fluentd-elasticsearch-cacert-0e8824dd57052913.yaml (+8, -0)
ansible/roles/common/defaults/main.yml (+1, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+6, -0)
",-0.928632,-0.353361,-0.92433,0.786632,0.429494,0.099691,-0.175652,0.450805,0.892536,0.17137,-0.014947,-0.099837,-0.300294,-0.365817,0.20288
openstack/kolla-ansible,I820dea961e270de9eabb9cc3c75303f5170ce737,0,1,1.0,4.5433,0.043,8,6.57,437,0,Bug Fix,0,0,0,4,0.043011,0.0,0,0.0,5,3,0,0.7647,2.5411,4.5,5.22,11.32,1,0,0.0,1,4.6489,0,16,0,17,0,"Support using Logstash 6 image with Centos8

When using Centos8 with the Train release only Elasticsearch 6 is provided.
Whilst the Logstash 2 image builds for Centos8, we upgrade it inline with
Elasticsearch to avoid compatibility problems [1].

[1] https://www.elastic.co/support/matrix#matrix_compatibility

Depends-On: https://review.opendev.org/#/c/736745/
Partial-Bug: #1884090
[SEP]
FILES CHANGED:
ansible/roles/monasca/templates/monasca-log-transformer/monasca-log-transformer.json.j2 (+2, -1)
releasenotes/notes/support-logstash-6-d64bb51217b79a77.yaml (+12, -0)
ansible/roles/monasca/templates/monasca-log-metrics/log-metrics.conf.j2 (+29, -0)
ansible/roles/monasca/templates/monasca-log-metrics/monasca-log-metrics.json.j2 (+2, -1)
ansible/roles/monasca/templates/monasca-log-persister/log-persister.conf.j2 (+13, -0)
ansible/roles/monasca/defaults/main.yml (+5, -1)
ansible/roles/monasca/templates/monasca-log-persister/monasca-log-persister.json.j2 (+2, -1)
ansible/roles/monasca/templates/monasca-log-transformer/log-transformer.conf.j2 (+24, -0)
",-1.576623,0.676826,-0.262454,-0.025389,-0.73593,0.19829,-0.169528,0.787423,-0.052102,0.331943,0.099371,0.062486,0.024775,-0.507209,-0.20153
openstack/oslo.utils,I48720d38649104f9f2f0a8fd208f2aac7548644e,1,0,0,4.2195,0.0,3,8.25,320,0,Feature,0,0,0,0,0.0,0.0,0,0.0,2,2,0,1.0,1.3056,1.67,8.75,17.85,1,0,0.4925,1,4.7059,0,0,0,0,0,"New method in netutils: get_mac_addr_by_ipv6

This method is practically the reverse of get_ipv6_addr_by_EUI64(),
so we can extract the MAC address from IPv6 addresses that were
generated from interface identifiers.

Related-Change: https://review.opendev.org/718729
[SEP]
FILES CHANGED:
oslo_utils/tests/test_netutils.py (+33, -0)
releasenotes/notes/netutils-get_mac_addr_by_ipv6-c3ce6a35a69f7c2b.yaml (+5, -0)
oslo_utils/netutils.py (+29, -0)
",-0.752582,0.560621,-0.983832,0.36488,-0.277569,0.520893,-0.327118,-0.201328,0.449752,-0.204653,-0.08449,-0.467181,-0.342942,0.184856,-0.121334
openstack/octavia,I7b8f7c7d653b37395f9a660be67f954a3a6f26d9,1,0,0.443,1.6094,0.25,1,14.0,633,0,Bug Fix,0,0,0,79,0.003362,0.6667,0,0.2954,2,1,0,0.4762,0.0,2.0,36.52,12.74,0,0,0.0,0,126.6,0,0,0,0,0,"Fix neutron subnet lookup ignoring endpoint_type

The recent patch[1] that adds a neutron subnet lookup using the user
context is not honoring the interface/endpoint_type or region_name
settings for neutron in the octavia configuration file.
This is causing problems for deployments that use the ""internal""
endpoint for neutron and the current code will always return
the ""public"" endpoint.
This patch corrects this problem by including those filter
parameters when the neutron endpoint is looked up in keystone.

[1] https://review.opendev.org/726042

Story: 2007863
Task: 40173
[SEP]
FILES CHANGED:
octavia/common/clients.py (+3, -1)
",-0.985826,-0.990709,0.818136,0.002128,-0.319206,-0.086943,0.098781,0.313036,0.508202,-0.207733,-0.053029,0.032521,-0.111434,0.061928,-0.002735
openstack/octavia-lib,Ie201f5b2574e5e11aeca9c08859977a1b8a3c1d8,1,0,0.2,1.0986,0.0,1,11.0,194,0,CI,1,0,0,10,0.009785,0.0,0,0.0,5,1,0,0.0,0.0,5.0,26.47,11.67,1,0,1.0,0,64.6667,0,0,0,0,0,"Add missing assertIsInstance checks

Two tests were missing assertIsInstance() checks, this
makes them like the tests above and below them.
[SEP]
FILES CHANGED:
octavia_lib/tests/unit/api/drivers/test_exceptions.py (+2, -0)
",0.786516,-1.285768,0.050515,0.109146,0.411778,0.664746,-1.218496,-0.958449,-0.688393,0.235931,-0.251013,-0.260778,0.154795,0.557593,-0.289767
openstack/kayobe,I238aeefefa88dd584ce61ac9eb52d50552336ed0,1,0,0.8,1.0986,0.5,1,13.5,241,0,Bug Fix,0,0,0,10,0.013755,1.0,0,0.8,3,1,0,0.9333,0.0,3.0,23.93,17.25,1,0,0.0,0,80.3333,0,0,0,0,0,"Fix condition of placement image build

This should fix placement image build if nova is disabled but zun is
enabled.

(cherry picked from commit 931fa4830d681281ff189bed15fbc9e0554428c0)
[SEP]
FILES CHANGED:
ansible/group_vars/all/kolla (+1, -1)
",-0.085563,-0.425368,-2.045661,-1.228997,1.054778,0.190519,0.692741,-0.607751,0.014256,-0.172959,-0.12474,0.087943,0.273421,-0.147388,-0.3818
openstack/kolla-ansible,I74359cec7147a80db24eb4aa4156c35d31a026bf,1,1,0,2.3979,0.5,2,25.5,390,1,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.7222,0.8813,3.0,33.32,19.61,1,0,0.0,1,35.4545,1,14,0,8,0,"Use public interface for Magnum client and trustee Keystone interface

While all other clients should use internalURL, the Magnum client itself
and Keystone interface for trustee credentials should be publicly
accessible (upstream default when no config is specified) since
instances need to be able to reach them.

Closes-Bug: #1885420
[SEP]
FILES CHANGED:
releasenotes/notes/clients-in-magnum-use-internalURL-af3ad82af71a88c6.yaml (+3, -4)
ansible/roles/magnum/templates/magnum.conf.j2 (+2, -1)
",0.295326,-1.757663,-0.2393,0.473174,-0.269439,-0.048326,-0.101613,0.259387,-0.066166,-0.024703,-0.378296,-0.090555,0.318709,-0.208172,-0.194923
openstack/octavia,I57a3c528a20943724bdcd36422c689f496068330,0,0,0.8095,6.1821,0.2029,21,11.0,184,0,Feature,0,0,0,21,0.012696,1.0,0,0.8095,5,5,0,0.4797,3.3663,3.57,49.54,13.49,1,0,0.3913,1,0.3802,0,0,0,0,0,"Add SCTP support in API

Add SCTP support in the API for listeners, pools, health-monitors
resources.

Story: 2007884
Task: 40255
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+11, -11)
octavia/tests/functional/api/v2/test_health_monitor.py (+152, -1)
octavia/db/migration/alembic_migrations/versions/8b47b2546312_sctp_support.py (+46, -0)
api-ref/source/v2/l7policy.inc (+3, -1)
doc/source/user/guides/basic-cookbook.rst (+9, -2)
releasenotes/notes/add-support-for-sctp-protocol-152444b211ab2188.yaml (+5, -0)
api-ref/source/v2/pool.inc (+1, -1)
doc/source/contributor/guides/providers.rst (+1, -1)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/api/v2/controllers/health_monitor.py (+21, -11)
api-ref/source/v2/general.inc (+38, -33)
doc/source/user/feature-classification/feature-matrix-pool.ini (+10, -2)
octavia/tests/functional/api/v2/test_pool.py (+24, -9)
octavia/common/constants.py (+3, -1)
octavia/api/v2/controllers/pool.py (+22, -13)
api-ref/source/v2/healthmonitor.inc (+1, -1)
octavia/api/root_controller.py (+4, -1)
doc/source/user/feature-classification/feature-matrix-healthmonitor.ini (+8, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+5, -1)
doc/source/user/feature-classification/feature-matrix-listener.ini (+8, -0)
octavia/api/v2/controllers/listener.py (+11, -8)
",0.368895,-0.881953,-0.420554,0.02997,0.040728,-0.054995,-1.473229,0.762753,0.042941,-0.220405,-0.594895,0.469615,0.472384,0.617485,-0.500185
openstack/castellan,I83bafe5b7e0c4cca67f773858007fb59d98a93a5,1,1,1.0,3.5835,0.1429,4,17.5,301,0,Bug Fix,0,0,0,1,0.1,0.0,0,0.0,3,2,0,1.0,1.8649,2.0,31.96,17.29,1,0,0.2571,1,8.3611,0,12,0,12,0,"add ""verify_ssl_path"" config for barbican key manager

Now we cann't use the verify_ssl if we set True, so we
add the ""verify_ssl_path"" config to solve it.

Closes-Bug: #1876102
(cherry picked from commit 89f311dfbd264a5d4309ea1ca4283f2746d6fa24)
[SEP]
FILES CHANGED:
castellan/key_manager/barbican_key_manager.py (+12, -3)
releasenotes/notes/bug-1876102-7c7288fb6e90b11d.yaml (+6, -0)
castellan/options.py (+5, -0)
castellan/tests/unit/test_options.py (+7, -2)
",-1.027065,-0.087377,-1.282365,-0.903062,0.803183,0.130387,0.539371,-0.589278,0.121146,0.149516,0.340339,-0.727081,0.175562,-0.005159,0.202108
openstack/castellan,I83bafe5b7e0c4cca67f773858007fb59d98a93a5,1,1,1.0,3.5835,0.1429,4,17.5,301,0,Bug Fix,0,0,0,2,0.044444,1.0,0,1.0,3,2,0,1.0,1.8649,2.0,31.96,17.29,1,0,0.2571,1,8.3611,0,12,0,12,0,"add ""verify_ssl_path"" config for barbican key manager

Now we cann't use the verify_ssl if we set True, so we
add the ""verify_ssl_path"" config to solve it.

Closes-Bug: #1876102
(cherry picked from commit 89f311dfbd264a5d4309ea1ca4283f2746d6fa24)
[SEP]
FILES CHANGED:
castellan/key_manager/barbican_key_manager.py (+12, -3)
releasenotes/notes/bug-1876102-7c7288fb6e90b11d.yaml (+6, -0)
castellan/options.py (+5, -0)
castellan/tests/unit/test_options.py (+7, -2)
",-1.027065,-0.087377,-1.282365,-0.903062,0.803183,0.130387,0.539371,-0.589278,0.121146,0.149516,0.340339,-0.727081,0.175562,-0.005159,0.202108
openstack/octavia,If69b5973e2a82c8e8d323a89eefb426a3986cd8f,1,0,0.1,4.0073,0.3148,4,21.5,321,0,Bug Fix,0,0,0,10,0.003096,0.4286,0,0.0429,7,1,0,0.4765,1.5542,4.25,21.71,16.97,0,0,0.4444,0,5.8364,0,0,0,0,0,"Fix amphorav2 bytes error

Fix Object of type 'bytes' is not JSON serializable
error while writing barbican tls data to persistence database.
Also fix _encrypt_listener_dict to encrypt dicts properly:
error - data must be bytes (HTTP 500)

Story: 2007877
Task: 40245
[SEP]
FILES CHANGED:
octavia/common/data_models.py (+3, -0)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+12, -12)
octavia/api/drivers/amphora_driver/v2/driver.py (+18, -5)
octavia/api/drivers/utils.py (+4, -0)
",0.013657,-1.477517,-0.620107,-0.285978,-0.082881,-0.18037,-0.065889,0.044598,0.259169,-0.096044,0.119499,-0.772152,0.040696,0.219969,-0.354388
openstack/oslo.messaging,I5c468d10230f05438df780e045f1e92662edf070,1,1,0,1.6094,0.25,1,7.75,287,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.0,0.0,2.0,-0.25,19.87,1,0,0.0,0,57.4,0,26,0,30,0,"Catch ConnectionForced Exception

Occasionally I saw large number of connectionforced exceptions.
such exceptions cannot be healed automatically and requires a reboot.
catch it and ensure connection established.

Closes-Bug: #1883038
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/impl_rabbit.py (+3, -1)
",-0.445066,-1.228695,-0.718156,0.066197,-0.391208,0.95594,-0.747143,-0.697952,0.036878,0.193246,0.271115,0.092753,0.439491,0.067486,0.15027
openstack/kolla-ansible,Id89c4ec6ff8b80feace01a3dee7dd30dd4cc5ec5,0,0,0.8,4.3438,0.5658,2,9.33,252,0,Bug Fix,0,0,0,5,0.012987,1.0,1,0.8,3,1,0,0.7368,0.7668,3.0,31.18,12.3,1,1,0.0,0,3.2727,0,0,0,0,0,"[docs] Update quickstart for Ussuri+

Mostly due to move to Python3-only.

Also fix the other venv docs to avoid virtualenv. :-)

(cherry picked from commit 271df7befcb3bb809e3968c2f97a1008c56272a1)
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+28, -31)
doc/source/user/virtual-environments.rst (+5, -12)
",0.121986,-1.524276,-1.120659,-1.722321,0.159321,-0.093291,0.468739,0.149867,-0.081403,0.361487,-0.668398,-0.3942,0.176248,-0.03047,-0.134526
openstack/taskflow,I10dacfe8fa425a1b1dfd4b8862a7460caa5c579f,0,0,0.0,1.6094,0.5,1,5.57,351,0,CI,1,0,0,3,0.230769,0.0,0,0.0,1,1,0,0,0.0,1.0,23.3,14.54,1,0,1.0,0,70.2,0,0,0,0,0,"Make test-setup.sh compatible with mysql8

Starting from mysql version 8 it's not possible to create a user
implictly when using GRANT.

This patch makes the behavior compatible with that.

Co-written-by: Riccardo Pittau <elfosardo@gmail.com>
[SEP]
FILES CHANGED:
tools/test-setup.sh (+2, -2)
",-0.471986,-0.760104,-0.654507,-0.013188,-1.008485,0.303531,-0.119659,0.029115,-0.137813,0.303195,0.283968,0.252902,0.051745,0.26822,-0.170078
openstack/kolla-ansible,Ib54b261e12c409d66b792648807646015826e83c,1,1,0.6667,2.5649,0.1667,3,9.75,289,0,Bug Fix,0,0,0,6,0.013015,0.0,0,0.0,4,2,0,0.7,1.4834,3.33,55.94,12.11,1,0,0.0,1,22.2308,0,6,0,7,0,"Fix the Elasticsearch Curator cron schedule run

There were two issues with it. Lack of /usr/local/bin in PATH
for CentOS and wrong crontab path for Ubuntu/Debian.
This patch mirrors how it is handled in keystone.

Closes-Bug: #1885732
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1885732-10803d46f9c73444.yaml (+5, -0)
ansible/roles/elasticsearch/templates/elasticsearch-curator.crontab.j2 (+2, -0)
ansible/roles/elasticsearch/templates/elasticsearch-curator.json.j2 (+3, -2)
",0.83394,-0.81343,-0.452277,-0.292338,-0.845757,0.326352,0.293906,0.451193,-0.365127,-0.199753,0.371644,-0.245625,0.155561,0.080749,0.120275
openstack/kolla-ansible,I20b37bb83a76bfabb1126925a1b4f1f59767b7a3,1,1,0,1.0986,0.5,1,5.2,261,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.7143,0.0,6.0,-13.2,15.93,1,0,0.0,0,87.0,0,6,0,15,0,"Syntax error in Fluentd Monasca output config

Resolve trivial syntax error in Fluentd output config for Monasca.

Co-Authored-By: Sebastian Luna Valero <sebastian.luna.valero@gmail.com>
Closes-Bug: #1885873
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+1, -1)
",-1.123482,1.291734,-1.720628,0.308578,-0.129826,0.364196,-0.425685,0.37527,0.173933,-0.245168,0.7209,0.484817,0.323097,0.10418,-0.342905
openstack/kolla-ansible,I9d6758c8550308d13d936de1a14afbe4124e593b,1,0,0.7143,2.8332,0.25,1,19.17,752,0,CI,0,0,0,7,0.014799,0.0,0,0.0,4,1,0,0.7273,0.0,4.0,38.78,16.36,1,0,0.0,0,44.2353,0,0,0,0,0,"Make ES Curator schedule multinode-friendly

In the spirit of Kolla-Ansible, we generally try to provide
workable defaults.
The default for Elasticsearch curator schedule was fine except for
multinode deploys where it would cause all nodes to run at the
same time producing broken runs (race condition in the get-delete
cycle).
It is easy to improve this situation by embracing poor-man's
reimplementation of keystone's fernet key rotation schedule.
ES Curator does not need all the complexity of the former so it
can be handled very well by shifting by as many hours as the
instance's index dictates. It should rarely if ever need more time
(most likely still in minutes range rather than hours).
[SEP]
FILES CHANGED:
ansible/roles/elasticsearch/defaults/main.yml (+12, -4)
",-0.956863,-1.532091,1.504894,-0.120737,-0.478563,-0.121636,0.825777,-0.028158,-0.039711,-0.117665,0.300212,0.383911,-0.030249,-0.475124,0.097494
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,1,1,1.0,2.7726,0.4,1,3.42,466,0,Bug Fix,1,0,0,1,0.001669,0.0,0,0.0,3,1,0,0.3333,0.0,3.0,-25.67,14.05,1,0,1.0,0,29.125,0,6,0,26,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -6)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/kolla-ansible,I9c495773db726a3c5cd94b819dff4141737a1d6e,1,1,1.0,3.0445,0.0,3,7.4,492,0,Bug Fix,0,0,0,1,0.333333,0.5,0,0.5,6,2,0,0.7391,1.4577,4.67,60.99,9.99,1,0,0.0,1,23.4286,0,6,0,6,0,"Set a chunk size for Fluentd bulk log upload to Monasca

In Fluentd v0.12, both the in memory and file buffer chunk size default
to 8MB. In v1.0 the file buffer defaults to 256MB. This can exceed the
Monasca Log or Unified API maximum chunk size which is set to 10MB.
This can result in logs being rejected and filling the local buffer
on disk.

Closes-Bug: #1885885
Co-Authored-By: Sebastian Luna Valero <sebastian.luna.valero@gmail.com>
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+3, -0)
releasenotes/notes/fix-fluentd-buffer-chunk-size-for-monasca-output-882338103d2e1f13.yaml (+8, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+9, -0)
",-2.532223,0.618312,0.413194,-0.615972,0.408731,0.516271,0.417799,0.262194,0.155093,0.108152,0.544108,0.662424,-0.10528,0.016083,-0.345496
openstack/kolla-ansible,Iabfa9afdcad505106a5580eb2d058273ee5f7c1f,1,1,0,1.0986,0.5,1,13.0,284,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.75,0.0,6.0,50.47,12.38,1,0,0.0,0,94.6667,0,6,0,5,0,"Fix Fluentd date format for MariaDB xinetd

Time format in Ruby Time.strptime is not accepting padding flags,
therefore we need to remove them for the Fluentd to be able
to parse MariaDB xinetd logs properly.

Closes-Bug: #1886002
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/input/02-mariadb.conf.j2 (+1, -1)
",-1.353852,-1.215546,-0.882112,-1.011139,0.493985,-0.210719,0.633758,0.329503,-0.183848,0.504441,0.309014,-0.301775,0.303172,-0.183169,0.003543
openstack/kolla-ansible,Iabfa9afdcad505106a5580eb2d058273ee5f7c1f,1,1,1.0,1.0986,0.5,1,14.67,353,0,Bug Fix,0,0,0,1,0.333333,1.0,0,1.0,6,1,0,0.76,0.0,6.0,43.9,13.14,1,0,0.0,0,117.6667,0,6,0,5,0,"Fix Fluentd date format for MariaDB xinetd

Time format in Ruby Time.strptime is not accepting padding flags,
therefore we need to remove them for the Fluentd to be able
to parse MariaDB xinetd logs properly.

Closes-Bug: #1886002
(cherry picked from commit dda5269ce75526b90a2d8e3b7983d876d4193588)
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/input/02-mariadb.conf.j2 (+1, -1)
",-1.353852,-1.215546,-0.882112,-1.011139,0.493985,-0.210719,0.633758,0.329503,-0.183848,0.504441,0.309014,-0.301775,0.303172,-0.183169,0.003543
openstack/kolla-ansible,I9c495773db726a3c5cd94b819dff4141737a1d6e,0,1,0.8,3.0445,0.0,3,7.9,561,0,Bug Fix,0,0,0,5,0.026882,1.0,0,0.8,6,2,0,0.7692,1.4577,4.67,56.39,10.25,1,0,0.0,1,26.7143,0,6,0,6,0,"Set a chunk size for Fluentd bulk log upload to Monasca

In Fluentd v0.12, both the in memory and file buffer chunk size default
to 8MB. In v1.0 the file buffer defaults to 256MB. This can exceed the
Monasca Log or Unified API maximum chunk size which is set to 10MB.
This can result in logs being rejected and filling the local buffer
on disk.

Closes-Bug: #1885885
Co-Authored-By: Sebastian Luna Valero <sebastian.luna.valero@gmail.com>
(cherry picked from commit 2c919bc61ca7a903e93372604fa0e770f95b0d52)
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+3, -0)
releasenotes/notes/fix-fluentd-buffer-chunk-size-for-monasca-output-882338103d2e1f13.yaml (+8, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+9, -0)
",-2.532223,0.618312,0.413194,-0.615972,0.408731,0.516271,0.417799,0.262194,0.155093,0.108152,0.544108,0.662424,-0.10528,0.016083,-0.345496
openstack/kolla-ansible,I023d96d25edd9d2fafd4415743e298af72a861a1,1,0,0.8182,2.0794,0.1429,1,17.5,307,0,Feature,0,0,0,11,0.015089,0.0,0,0.0,1,1,0,0.7407,0.0,1.0,0.54,19.57,0,0,0.0,0,38.375,0,0,0,0,0,"Support editable virtualenv installation for development

An editable installation allows changes to be made to the source code
directly, and have those changes applied immediately without having to
reinstall.

    pip install -e /path/to/kolla-ansible
[SEP]
FILES CHANGED:
tools/kolla-ansible (+6, -1)
",-0.15138,-0.491304,-0.371356,0.694863,0.113072,-0.462039,-0.066238,-0.290696,-0.327189,0.285735,-0.698232,0.160787,0.169412,0.180678,-0.210926
openstack/kolla-ansible,I17256b182d207aeba3f92c65a6d7cf3611180558,1,1,1.0,2.7726,0.4667,2,12.12,756,0,Bug Fix,0,0,0,4,0.071429,0.0,0,0.0,4,2,0,0.75,0.9968,3.0,21.84,17.22,1,0,0.0,1,47.25,0,6,0,10,0,"Remove policy file from nova-conductor config.json template

Change I810aad7d49db3f5a7fd9a2f0f746fd912fe03917 for supporting multiple
Nova cells updated the list of containers that require a policy file to
only include nova-api, nova-compute, and nova-compute-ironic.

The nova-conductor config.json template was left unchanged and fails to
copy the nova policy file into its container. This can be seen on a
fresh deployment, but might be missed on an upgrade if an older policy
file is still available in /etc/kolla/nova-conductor.

This commit removes the nova_policy_file block from the nova-conductor
config.json template, as it shouldn't be required.

Backport: ussuri, train
Closes-Bug: #1886170
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1886170-f76d9d3520ab86ec.yaml (+7, -0)
ansible/roles/nova-cell/templates/nova-conductor.json.j2 (+1, -7)
",-2.800003,0.396992,1.047388,-0.438217,0.438232,-0.35304,0.360867,0.145874,0.056544,-0.433426,0.111588,0.298894,-0.146891,0.223679,0.048592
openstack/oslo.messaging,Ic3a9e2c873619670edfbf71022d593f3cb5f70f2,1,1,0,4.0254,0.6364,3,6.88,1080,0,Bug Fix,0,0,1,0,0.0,0.5,0,0.0,1,3,0,0.5,1.1888,0.33,27.76,13.01,0,0,0.4727,0,19.2857,0,6,0,26,0,"Simplify tools/test-setup.sh

test-setup.sh is called after bindep is run in CI, and tox is not setup.

Simplify the script so that it only does what's needed - install
qdrouterd for Ubuntu from qpid/testing.

Install the other packages using bindep, add test to amqp1 profile.

Add amqp1 to bindep_profiles where needed for scenario tests, previously
test-setup.sh added it everywhere.

Conflicts:
    .zuul.yaml
    bindep.txt
Modified:
    tools/test-setup.sh

NOTE(elod.illes): conflicts are due to the following patches are
missing from Stein:
* .zuul.yaml: I1874f96f78cb403e6f3a56a49cb83df40d531f8d
  (dropping py35 testing)
* bindep.txt: I9fb56450346fca84bc1573fa5e9b6fe81c14e33a
  (messaging intermediaries update; the lack of this patch also
  requires the modification of test-setup.sh)

Related-Bug: #1885923
(cherry picked from commit 7e406c312a6514e7ae377edb52b9e02b5bf37a7d)
(cherry picked from commit dfcc4b0010d39d1f16be413bb1c3a4808718cd19)
(cherry picked from commit 88cf5aebef790ff40ab8ca7219d537ccfc54d12e)
[SEP]
FILES CHANGED:
bindep.txt (+14, -13)
.zuul.yaml (+2, -0)
tools/test-setup.sh (+4, -22)
",-3.100786,1.222122,3.652496,-2.765774,0.517759,0.311293,0.1928,-0.30624,-0.382471,-0.286473,-0.509253,0.159593,0.006396,0.362315,0.067232
openstack/octavia,I3e8725eb77ea947e71d85ea406a60ed94c7bf971,0,0,0.0,3.0445,0.5,9,8.0,656,0,Bug Fix,1,0,0,1,0.058824,1.0,0,0.0,5,1,0,0.48,3.1219,5.0,32.69,11.7,0,0,1.0,0,31.2381,0,0,0,0,0,"Switch from unittest2 compat methods to Python 3.x methods

With the removal of Python 2.x we can remove the unittest2 compat
wrappers and switch to assertCountEqual instead of assertItemsEqual

We have been able to use them since then, because
testtools required unittest2, which still included it. With testtools
removing Python 2.7 support [3][4], we will lose support for
assertItemsEqual, so we should switch to use assertCountEqual.

[1] - https://bugs.python.org/issue17866
[2] - https://hg.python.org/cpython/rev/d9921cb6e3cd
[3] - testing-cabal/testtools#286
[4] - testing-cabal/testtools#277
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+1, -1)
octavia/tests/functional/api/v2/test_pool.py (+1, -1)
octavia/tests/functional/api/v2/test_quotas.py (+1, -1)
octavia/tests/functional/api/v2/test_amphora.py (+1, -1)
octavia/tests/functional/api/v2/test_l7rule.py (+1, -1)
octavia/tests/functional/api/v2/test_member.py (+1, -1)
octavia/tests/functional/api/v2/test_l7policy.py (+1, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+1, -1)
octavia/tests/functional/api/v2/test_listener.py (+2, -2)
",-3.07231,1.436558,0.868805,-0.140828,-0.01328,0.071712,-0.276746,-0.0909,-0.540479,0.475982,0.09176,-0.086132,-0.262993,-0.250142,0.065469
openstack/taskflow,Ice3633075a3ac58d05b8535b9bc8340f36130524,0,0,0.1818,2.0794,0.0,1,8.33,232,0,CI,0,0,1,11,0.00335,0.05,1,0.0091,0,1,0,0.0,0.0,0.0,8.87,16.13,0,0,0.0,0,29.0,0,0,0,0,0,"Add requirements for jobboard backends

Requirements for python libraries were added only in
test-requirements.yaml although redis/kazoo should be installed
if jobboard is used.
[SEP]
FILES CHANGED:
requirements.txt (+7, -0)
",0.011716,-0.677254,-0.613031,0.43485,0.226126,-0.809538,-0.298186,0.071945,-0.737,-0.394404,-0.531832,0.077537,-0.5244,0.000494,0.086298
openstack/kayobe,I908dc3320cb1dce7a040a1dbfeac414ace22d6e3,1,0,1.0,3.2189,0.25,2,2.5,303,0,Feature,0,0,0,5,0.070423,1.0,0,1.0,2,2,0,0.9375,0.8113,2.0,18.18,10.33,1,0,0.0,1,12.12,0,0,0,0,0,"Avoid setting IPADDR=0.0.0.0

Configuring network interfaces with IPADDR=0.0.0.0 may fail with:
Error, some other host (FF:FF:FF:FF:FF:FF) already uses address 0.0.0.0.

Co-Authored-By: Bartosz Bezak <bartosz@stackhpc.com>
Story: 2007900
Task: 40289
[SEP]
FILES CHANGED:
ansible/filter_plugins/networks.py (+12, -6)
releasenotes/notes/fix-no-ip-addr-on-nic-38d6f8e8078f534d.yaml (+6, -0)
",-2.13657,1.375591,-0.865045,-0.036187,0.028734,0.751565,-0.976858,-0.106825,0.092588,0.724003,0.717069,-0.168079,0.497527,0.624217,-0.526101
openstack/kolla-ansible,If2d0dd1739e484b14e3c15a185a236918737b0ab,1,1,0,3.8712,0.3617,8,3.25,194,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,5,3,0,0.7586,2.6638,4.5,-43.76,22.84,1,0,0.0,1,4.0417,0,16,0,17,0,"Logstash 6 support

Co-Authored-By: Doug Szumski <doug@stackhpc.com>
Closes-Bug: #1884090
Depends-On: https://review.opendev.org/#/c/736768
[SEP]
FILES CHANGED:
ansible/roles/monasca/templates/monasca-log-transformer/monasca-log-transformer.json.j2 (+1, -1)
releasenotes/notes/bug-1884090-c40ff140d5514108.yaml (+12, -0)
ansible/roles/monasca/templates/monasca-log-metrics/log-metrics.conf.j2 (+5, -6)
ansible/roles/monasca/templates/monasca-log-metrics/monasca-log-metrics.json.j2 (+1, -1)
ansible/roles/monasca/templates/monasca-log-persister/log-persister.conf.j2 (+3, -3)
ansible/roles/monasca/defaults/main.yml (+3, -0)
ansible/roles/monasca/templates/monasca-log-persister/monasca-log-persister.json.j2 (+1, -1)
ansible/roles/monasca/templates/monasca-log-transformer/log-transformer.conf.j2 (+4, -5)
",-0.425104,2.643718,-1.621926,-0.624472,-1.437962,0.677242,-0.482597,0.000357,0.247143,-0.396732,0.291764,0.188882,0.26816,-0.033208,-0.216485
openstack/kolla,I989a1dd30d1656b5c1fda7a46abbf5f265fbb72c,1,1,0.75,2.1972,0.125,2,21.33,494,0,Bug Fix,0,0,0,8,0.01636,0.0,0,0.0,3,2,0,1.0,0.8113,2.5,26.56,17.28,1,0,0.0,1,54.8889,0,18,0,7,0,"Fix ceilometer-upgrade params

It seems [1] has introduced a slight regression in that it tries
by default to pass an empty string to ceilometer-upgrade which
makes it fail:

ceilometer-upgrade: error: unrecognized arguments:

(note there is nothing more on that line)

This patch fixes that by allowing the params to be of any number,
including zero.

Backport to Ussuri.

[1] 3d587409ee068843cfa28710f09f65af48b69367

Closes-Bug: #1884919
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1884919-6be7e60872c5eb86.yaml (+6, -0)
docker/ceilometer/ceilometer-notification/extend_start.sh (+1, -1)
",-1.509129,-1.1515,0.3302,-0.99361,0.18738,-0.013044,-0.229843,-0.391816,0.109929,0.492568,0.445997,-0.126944,0.179148,0.165885,-0.096102
openstack/oslo.policy,I34eace9806e6ed7c9c6206a34f55debc0c20bac6,1,1,0.0,2.3026,0.6667,1,9.71,555,0,Bug Fix,0,0,0,1,0.033333,0.0,0,0.0,1,1,0,1.0,0.0,1.0,25.29,12.71,1,0,0.0,0,55.5,0,6,0,2,0,"Don't deepcopy objects before mask_dict_password

As far as I can tell, mask_dict_password does not modify the object
passed in to it[0]. As such, this deepcopy only adds an unnecessary
requirement on the policy objects that makes it possible for a call
to fail in a different way when debug logging is enabled. Since this
is pretty terrible, let's get rid of it.

Closes-Bug: 1886984
0: https://github.com/openstack/oslo.utils/blob/4fe75b7e1bd3144282f107ce7cb61880257c7c1e/oslo_utils/strutils.py#L349
[SEP]
FILES CHANGED:
oslo_policy/policy.py (+3, -6)
",-2.031397,0.774772,0.322665,-0.554975,-0.061142,0.199447,0.66696,-0.620681,0.078435,0.304461,0.259939,-0.198935,-0.227791,-0.391745,0.091123
openstack/kolla-ansible,I6913756ff85b7cc626d50ce16d55085d3683db17,0,0,0.8333,5.7714,0.3125,22,14.89,1088,0,Doc,0,0,0,12,0.016304,0.0,0,0.0,4,3,0,0.7667,3.5601,3.77,13.05,18.79,1,0,0.0,1,3.3894,0,0,0,0,0,"Performance: Split out prometheus node exporter and cadvisor

Executing tasks has a performance penalty, even if they are skipped [1].
The prometheus role deploys a few types of services:

* core prometheus server and alert manager services
* centralised service-based exporters (mysql, memcached, OpenStack,
  etc.)
* distributed node-based exporters (node exporter, cadvisor) that are
  deployed to all hosts

There is a significant overhead in executing the tasks associated with
the core services and centralised exporters against all hosts, even
though they are skipped.

This change extracts the node exporter and cadvisor deployment into a
new prometheus-node-exporters role, to avoid executing the prometheus
role against all hosts. The new role is lightweight, and has a small
number of tasks, which should significantly improve performance.

[1]
https://github.com/stackhpc/ansible-scaling/blob/master/doc/skip.md

Partially-Implements: blueprint performance-improvements
[SEP]
FILES CHANGED:
ansible/roles/prometheus-node-exporters/handlers/main.yml (+27, -0)
ansible/roles/prometheus-node-exporters/templates/prometheus-node-exporter.json.j2 (+0, -0)
ansible/roles/prometheus-node-exporters/templates/prometheus-cadvisor.json.j2 (+0, -0)
ansible/roles/prometheus-node-exporters/tasks/upgrade.yml (+7, -0)
ansible/roles/prometheus-node-exporters/tasks/reconfigure.yml (+2, -0)
ansible/site.yml (+16, -2)
ansible/roles/prometheus-node-exporters/tasks/check-containers.yml (+3, -0)
releasenotes/notes/split-prometheus-role-d363716375b14143.yaml (+6, -0)
ansible/roles/prometheus-node-exporters/tasks/config_validate.yml (+1, -0)
ansible/roles/prometheus-node-exporters/tasks/deploy.yml (+7, -0)
ansible/roles/prometheus-node-exporters/tasks/copy-certs.yml (+6, -0)
ansible/roles/prometheus-node-exporters/tasks/precheck.yml (+41, -0)
ansible/roles/prometheus-node-exporters/tasks/config.yml (+30, -0)
ansible/roles/prometheus-node-exporters/tasks/deploy-containers.yml (+2, -0)
ansible/roles/prometheus-node-exporters/tasks/check.yml (+1, -0)
ansible/roles/prometheus-node-exporters/tasks/pull.yml (+3, -0)
ansible/roles/prometheus-node-exporters/defaults/main.yml (+60, -0)
ansible/roles/prometheus-node-exporters/tasks/main.yml (+2, -0)
ansible/roles/prometheus-node-exporters/tasks/stop.yml (+6, -0)
ansible/roles/prometheus/defaults/main.yml (+0, -45)
ansible/roles/prometheus/tasks/precheck.yml (+0, -26)
ansible/roles/prometheus/handlers/main.yml (+0, -27)
",-2.948418,-0.061581,2.619764,-0.063569,0.004032,-0.346271,-0.15491,0.350682,-0.207747,-0.180495,-0.291668,0.326553,0.381756,-0.091192,-0.406042
openstack/kolla-ansible,I67009d046925cfc02c1e0073c80085c1471975f6,1,0,0.5,5.8493,0.0347,9,12.4,572,1,Bug Fix,0,0,0,2,0.181818,1.0,0,0.5,4,3,0,0.7419,2.2363,3.11,-11.79,19.15,1,0,0.0,0,1.6484,0,0,0,0,0,"Implement automatic deploy of octavia

this patchset has implemented:
  - network (lb-mgmt-net)
  - security groups and rules (used by amphora and health manager)
  - amphora flavor (used by amphora)
  - nova keypair (used by amphora at the time of debugging)

Add a octavia_amp_listen_port variable which used by amphora
Add amp_image_owner_id in octavia.conf

Implements: blueprint implement-automatic-deploy-of-octavia
Co-Authored-By: zhangchun <zhangchun@yovole.com>

Depends-On: https://review.opendev.org/652030
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+84, -0)
ansible/roles/octavia/tasks/deploy.yml (+3, -0)
ansible/roles/octavia/tasks/prepare.yml (+131, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+21, -2)
ansible/group_vars/all.yml (+0, -9)
ansible/roles/octavia/tasks/config.yml (+10, -0)
etc/kolla/passwords.yml (+4, -0)
kolla_ansible/cmd/genpwd.py (+1, -1)
etc/kolla/globals.yml (+80, -0)
",-2.102818,1.133762,0.686294,-0.221261,0.055555,-0.32915,-0.198851,0.22797,0.006339,-0.729545,0.355504,0.177298,0.081529,0.178923,-0.437641
openstack/kolla,I1579e762bcfb07f0baa73507eb9955ae2f83c4ec,0,1,0.7778,4.3175,0.6622,4,8.2,385,0,Bug Fix,0,0,0,9,0.018109,1.0,0,0.7778,2,2,0,1.0,1.0875,2.0,6.61,12.06,1,0,0.0,1,5.1333,0,16,0,17,0,"Upgrade to Logstash 6

Elasticsearch and Kibana 6 are used on all distros, but Logstash
is still pinned at 2 which is not compatible. See the product
compatibility matrix [1].

[1] https://www.elastic.co/support/matrix#matrix_compatibility

Partial-Bug: #1884090
(cherry picked from commit 25f74fb943d76f46d5b166ba8c0506a4a2ce06ca)
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -4)
releasenotes/notes/add-logstash6-everywhere-7f9027ff17c6022d.yaml (+4, -0)
kolla/template/repos.yaml (+7, -0)
docker/logstash/Dockerfile.j2 (+13, -45)
",-1.489496,-0.282104,-0.587786,-1.196394,-0.029702,-0.08577,0.403844,0.590622,0.069682,0.717226,0.149387,-0.166303,0.024587,-0.153871,-0.456106
openstack/kolla,Ib44f493aad0813a8aba916c7c353b60cab954b5f,1,1,1.0,2.9444,0.0,2,21.33,440,0,Bug Fix,0,0,0,1,0.020833,0.5,0,0.5,2,2,0,0.9333,1.0,2.0,29.2,17.91,1,0,0.0,1,23.1579,0,6,0,7,0,"Fix Logstash 6 log rotation - Stable/Ussuri

Logstash 6 introduced in Centos 8 in Train release comes with log4j2
configuration that does not remove old compressed logs after rotation
Log rotation config backported from Logstash 7 - Combination of Size
Based and Time Based policies. Deletion occurs after 30 days or
3000 MB log files size - whichever comes first.

Closes-Bug: #1886975
[SEP]
FILES CHANGED:
docker/logstash/Dockerfile.j2 (+9, -0)
releasenotes/notes/bug-1886975-454ac12be3d8e1d3.yaml (+9, -0)
",0.138455,-1.439806,0.239605,-0.439868,-0.217641,-0.04751,0.016026,1.196543,-0.045756,-0.144943,0.108621,-0.072681,0.330941,-0.135032,0.019895
openstack/castellan,I4b8075429218a494f75f5e3611f48927d18f1700,1,1,0,2.8332,0.0,2,12.0,357,0,Bug Fix,0,0,1,0,0.0,0.6667,0,0.0,0,2,0,1.0,0.8113,0.0,60.71,10.63,0,0,0.0,1,21.0,0,6,0,7,0,"Add bindep.txt

The Vault functional tests are currently failing in the gate, and it
appears to be because the unzip binary is not present. We need to
add it to bindep so it will be installed before running tests.

Closes-Bug: 1840061
(cherry picked from commit 2547c8c9f8fa76b01aa133c53bc321bc2625668b)
[SEP]
FILES CHANGED:
bindep.txt (+4, -0)
tox.ini (+12, -0)
",-0.80016,-1.200153,-1.19123,-0.999202,0.083456,0.068197,0.805406,-0.265432,0.020356,0.404,0.395676,-0.251366,0.201835,0.196412,-0.020689
openstack/octavia,I5cf6f1f20f2c6f1da39982b2d88e036eefe48b2f,0,0,0.2667,6.8742,0.2764,9,4.14,315,0,Feature,0,0,0,15,0.001466,1.0,0,0.2667,6,1,0,0.4768,2.4345,3.78,-27.83,20.97,0,0,0.7184,0,0.3257,0,0,0,0,0,"Change amphora statistics to use deltas

Amphora statistics packets should report deltas instead of absolutes for
all relevant metrics.

Co-Authored-By: Anushka Singh <anushka.singh.2511@gmail.com>
Co-Authored-By: Stephanie Djajadi <stephanie.djajadi@gmail.com>
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+213, -156)
octavia/common/data_models.py (+4, -0)
octavia/amphorae/backends/health_daemon/health_daemon.py (+122, -40)
octavia/tests/unit/common/test_data_models.py (+54, -0)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_db.py (+45, -3)
octavia/db/models.py (+15, -0)
octavia/db/repositories.py (+32, -1)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+162, -61)
octavia/controller/healthmanager/health_drivers/update_db.py (+52, -6)
",-1.871884,2.800036,-1.693855,0.992872,0.133399,0.602712,-0.08125,-0.223206,-0.182076,-0.084687,0.946526,0.650477,0.267989,0.285683,-0.605438
openstack/octavia,I7236326948ce152242c1aea7a6ffd5f4848dc52f,0,0,0,1.6094,0.0,1,7.0,86,0,CI,1,0,1,0,0.0,0.0,1,0.0,0,1,0,0.4737,0.0,0.0,-5.73,19.94,0,0,1.0,0,17.2,0,0,0,0,0,"migrate testing to ubuntu focal
[SEP]
FILES CHANGED:
test-requirements.txt (+4, -0)
",2.773992,1.39319,1.444738,0.275379,1.236806,0.821371,0.90598,0.141676,-0.637821,0.159628,0.51072,0.283809,-0.211679,0.045947,0.406343
openstack/oslo.utils,Ie44a17a898934c5cc1a1db5fe2c3422ebd2ec766,0,0,0.0,1.6094,0.0,1,7.0,86,0,CI,1,0,1,1,0.2,0.0,1,0.0,0,1,0,1.0,0.0,0.0,-41.98,19.94,0,0,1.0,0,17.2,0,0,0,0,0,"migrate testing to ubuntu focal
[SEP]
FILES CHANGED:
test-requirements.txt (+4, -0)
",2.773992,1.39319,1.444738,0.275379,1.236806,0.821372,0.905981,0.141676,-0.637821,0.159628,0.51072,0.283809,-0.211679,0.045947,0.406343
openstack/kolla-ansible,Ifbab7b673ba87925e52bb01c0996479eb1b76c44,1,1,1.0,2.8904,0.0,5,13.33,347,0,Bug Fix,0,0,0,2,0.030303,1.0,0,1.0,4,3,0,0.75,1.8499,3.6,15.64,18.33,1,0,0.0,1,19.2778,0,10,0,10,0,"Fix Logstash 2.4 log rotation

Logstash 2.4 uses integrated in container logrotate configuration
which tries to rotate logs in /var/log/logstash and Kolla's Logstash
logs are in /var/log/kolla/logstash/
This patch adds kolla-ansible internal logrotate config for Logstash

Closes-Bug: #1886787
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron.json.j2 (+1, -0)
releasenotes/notes/bug-1886787-013164ffc2f67264.yaml (+9, -0)
ansible/roles/common/defaults/main.yml (+3, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
ansible/roles/common/templates/cron-logrotate-logstash.conf.j2 (+3, -0)
",-0.867859,0.466803,-0.78727,0.427025,0.516611,-0.637976,0.144881,0.722587,-0.370252,-0.166758,0.131994,-0.359786,0.08433,-0.036096,0.184485
openstack/octavia,I04bb38c657c87ace941eb6e332f58f7218980ad1,1,0,0.45,1.9459,0.8333,1,10.67,247,0,Feature,0,0,0,80,0.003404,0.3333,0,0.15,2,1,0,0.4706,0.0,2.0,26.81,16.77,0,0,0.0,0,35.2857,0,0,0,0,0,"Remove unnecessary joinedload

This patch removes an unnecessary joinedload when looking up a
load balancer from an amphora ID. This should reduce the database
load when this method is called.
[SEP]
FILES CHANGED:
octavia/db/repositories.py (+1, -5)
",1.414319,-1.595309,0.403063,0.568821,0.095811,0.606058,0.360536,-0.519259,0.516347,-0.480078,-0.427453,0.504806,-0.340976,-0.034741,-0.020055
openstack/kayobe,I7f757098211745671ec891fdd4e0b52dc1fe7602,1,0,0.6667,0.6931,0.0,1,6.0,80,0,Feature,0,0,0,3,0.008403,0.037,0,0.0247,0,1,0,0.9412,0.0,0.0,-10.75,22.4,0,0,0.0,0,40.0,0,0,0,0,0,"Add py38 package metadata
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",4.562718,1.250356,2.344317,0.269884,0.567828,0.347922,0.979105,0.959525,0.449317,-0.135031,-0.667922,-0.128075,0.164872,0.300063,0.267923
openstack/kolla,Ic5b9a58d212711a4d6c13822548c92013a6bae50,0,1,0.7,2.1972,1.0,1,5.86,335,0,Bug Fix,0,0,0,10,0.017513,0.0,0,0.0,3,1,0,0.9375,0.0,3.0,39.94,12.1,1,0,0.0,0,37.2222,0,50,0,44,0,"Remove TODO in libvirt script

This is no longer required when Kolla-Ansible is patched.

Note this is *not* safe to backport as it requires the user to
have Kolla-Ansible patched, i.e. would normally break most.

Related-Bug: #1681461
Depends-On: https://review.opendev.org/735441
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/extend_start.sh (+0, -8)
",-1.02069,0.368105,-0.781694,0.187094,-1.078287,0.307697,-0.064207,-0.365916,-0.40743,0.276722,0.53153,-0.231975,0.182786,-0.264678,-0.028454
openstack/octavia,I7375e9758c7ae80e2370189117e8e63c79446490,0,0,0.25,3.434,0.0,5,28.33,614,0,CI,0,0,0,16,0.001429,0.2222,0,0.0556,4,4,0,0.474,2.1181,2.6,11.86,22.63,1,0,0.0,1,19.8065,0,0,0,0,0,"Deprecate the Spares Pool feature for removal in X

Use of the spares pool was originally recommended to increase provisioning
speed, but since Nova's server groups do not support adding existing VMs,
Octavia cannot support use of the spares pool with the Active-Standby
topology. Since this is our recommended topology for production deployments,
and speed is less essential in development/testing environments (the
only place we could recommend the use of Single topology), the overhead of
maintaining spares pool support exceeds its theoretical usefulness.
[SEP]
FILES CHANGED:
octavia/common/config.py (+8, -0)
doc/source/contributor/guides/dev-quick-start.rst (+5, -0)
releasenotes/notes/deprecating-spares-pool-9f92787ec9809a78.yaml (+11, -0)
doc/source/admin/guides/operator-maintenance.rst (+4, -0)
etc/octavia.conf (+2, -0)
",-1.238725,-1.42278,0.412943,1.092041,-0.083406,-0.107714,0.086774,0.501056,0.086297,0.136623,0.02885,0.58683,0.0222,-0.823604,0.019529
openstack/tooz,I5ea06ebd2b976465ff82f10a74e140f30e9e803f,0,0,0,3.1355,0.4091,2,8.2,279,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0,0.684,2.0,58.2,10.11,1,0,0.0,1,12.1304,0,0,0,0,0,"Fix breakage with PyMySQL 0.10.0

In this version a Connection is no longer a context manager. Fix
it by simply getting a Cursor out of it (locks don't seem to
interact with transactions, at least according to MariaDB docs).
[SEP]
FILES CHANGED:
tooz/drivers/mysql.py (+9, -9)
releasenotes/notes/mysql-0.10.0-7660f75a1c57a920.yaml (+4, -0)
",0.210278,-0.92221,-0.095151,0.209022,-0.39737,0.43139,0.006687,-0.513071,-0.432605,0.615342,-0.147371,0.112769,-0.015609,-0.22076,0.154546
openstack/octavia,I612ea1c583090897bd44453b867d75929a01b7fc,1,0,0,0.6931,1.0,1,8.8,377,0,CI,0,0,1,0,0.0,0.0476,1,0.0,0,1,0,0.471,0.0,0.0,15.24,15.34,1,0,0.0,0,188.5,0,0,0,0,0,"Drop diskimage-builder from root requirements.txt

diskimage-builder is already listed in diskimage-create/requirements.txt,
and it isn't really a run-time dependency for octavia so it tends to be
confusing downstream as we generally add run-time dependencies based on
the root requirements.txt.

Story: 2007934
Task: 40389
[SEP]
FILES CHANGED:
requirements.txt (+0, -1)
",-0.07481,-0.011973,-0.570934,0.721838,-0.26656,-0.234592,0.424291,-0.51202,-0.277413,-0.172329,0.046073,-0.064032,0.103345,0.52941,0.259646
openstack/octavia,I054fd5505e5ccc2ff66ff5f0c94e8c8ee7afb2fa,0,0,0.0,5.8377,0.1491,28,2.57,253,0,Feature,0,0,0,1,0.000198,0.6667,0,0.0,6,4,0,0.4744,3.7607,3.61,-73.07,21.03,0,0,0.5673,1,0.7376,0,0,0,0,0,"Added new metric - response time

Co-Authored-By: Adam Harwell <flux.adam@gmail.com>
Co-Authored-By: Stephanie Djajadi <stephanie.djajadi@gmail.com>
Depends-On: https://review.opendev.org/#/c/742716/
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+7, -0)
octavia/amphorae/backends/health_daemon/health_daemon.py (+8, -2)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/functional/api/v2/test_amphora.py (+14, -10)
api-ref/source/v2/examples/listener-stats-response.json (+2, -1)
octavia/tests/functional/api/v2/base.py (+6, -4)
octavia/common/constants.py (+1, -0)
octavia/common/stats.py (+12, -0)
octavia/db/repositories.py (+3, -1)
octavia/tests/unit/amphorae/drivers/health/test_heartbeat_udp.py (+44, -11)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+5, -5)
octavia/tests/functional/api/v2/test_listener.py (+72, -4)
releasenotes/notes/Add-member-response-time-metric-83c4e71889c2c7a5.yaml (+5, -0)
api-ref/source/v2/examples/loadbalancer-stats-response.json (+2, -1)
octavia/db/models.py (+2, -1)
octavia/api/v2/types/listener.py (+1, -0)
api-ref/source/v2/listener.inc (+1, -0)
octavia/db/migration/alembic_migrations/versions/3e9c04c8bc58_add_response_time_metric.py (+35, -0)
octavia/tests/functional/db/test_repositories.py (+9, -2)
octavia/api/v2/types/load_balancer.py (+1, -0)
octavia/common/data_models.py (+8, -2)
octavia/tests/unit/common/test_stats.py (+4, -1)
api-ref/source/v2/loadbalancer.inc (+1, -0)
octavia/api/v2/types/amphora.py (+1, -0)
api-ref/source/v2/examples/amphora-show-stats-response.json (+4, -2)
api-ref/source/v2/amphora.inc (+1, -0)
octavia/api/root_controller.py (+4, -1)
octavia/amphorae/drivers/health/heartbeat_udp.py (+36, -2)
",-1.66171,3.964718,-1.951502,0.631842,-0.9804,0.892833,-0.012169,-0.265066,0.000913,-0.237286,0.664898,0.533933,0.474009,0.312761,-0.55686
openstack/octavia,I757d84e4624f488382ec4ff9af3f489cd9a85ed3,1,1,0.2857,3.8918,0.125,3,13.33,331,0,Bug Fix,0,0,0,7,0.009736,0.6,0,0.1714,6,2,0,0.4713,1.0562,4.0,13.53,18.33,1,0,0.75,1,6.7551,0,14,0,2,0,"Fix missing dependency in amphora create flow

Task CertComputeCreate requires SERVER_GROUP_ID but this dependency is
missing when nova anti-affinity is enabled and load balancer topology is
SINGLE. This patch fixes this issue.

Task: 40408
Story: 2007943
Closes-Bug: #1888397
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+33, -3)
octavia/controller/worker/v1/controller_worker.py (+4, -3)
releasenotes/notes/fix-missing-amphora-create-dependency-a954ded0d260d462.yaml (+5, -0)
",-2.370441,-0.6471,-0.517878,-1.805836,0.958132,0.172072,0.1097,0.234381,0.249073,0.049135,0.557148,0.035988,0.212203,-0.096928,-0.028917
openstack/octavia,I757d84e4624f488382ec4ff9af3f489cd9a85ed3,1,1,0.375,3.8918,0.125,3,15.0,400,0,Bug Fix,0,0,0,8,0.01043,1.0,0,0.375,6,2,0,0.4747,1.0562,4.0,13.01,18.44,1,0,0.75,1,8.1633,0,14,0,2,0,"Fix missing dependency in amphora create flow

Task CertComputeCreate requires SERVER_GROUP_ID but this dependency is
missing when nova anti-affinity is enabled and load balancer topology is
SINGLE. This patch fixes this issue.

Task: 40408
Story: 2007943
Closes-Bug: #1888397

(cherry picked from commit ae6f3443594390fd543a007d67b78132e697fb29)
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+33, -3)
octavia/controller/worker/v1/controller_worker.py (+4, -3)
releasenotes/notes/fix-missing-amphora-create-dependency-a954ded0d260d462.yaml (+5, -0)
",-2.370441,-0.6471,-0.517878,-1.805836,0.958132,0.172072,0.1097,0.234381,0.249073,0.049135,0.557148,0.035988,0.212203,-0.096928,-0.028917
openstack/octavia,I757d84e4624f488382ec4ff9af3f489cd9a85ed3,1,1,0.4444,3.8918,0.125,3,16.67,469,0,Bug Fix,0,0,0,9,0.011043,1.0,0,0.4444,6,2,0,0.478,1.0562,4.0,5.49,18.67,1,0,0.75,1,9.5714,0,14,0,2,0,"Fix missing dependency in amphora create flow

Task CertComputeCreate requires SERVER_GROUP_ID but this dependency is
missing when nova anti-affinity is enabled and load balancer topology is
SINGLE. This patch fixes this issue.

Task: 40408
Story: 2007943
Closes-Bug: #1888397

(cherry picked from commit ae6f3443594390fd543a007d67b78132e697fb29)
(cherry picked from commit 2da18070a642323ad48c981961284a9534ece4be)
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/test_controller_worker.py (+33, -3)
octavia/controller/worker/v1/controller_worker.py (+4, -3)
releasenotes/notes/fix-missing-amphora-create-dependency-a954ded0d260d462.yaml (+5, -0)
",-2.370441,-0.6471,-0.517878,-1.805836,0.958132,0.172072,0.1097,0.234381,0.249073,0.049135,0.557148,0.035988,0.212203,-0.096928,-0.028917
openstack/oslo.context,Ie5ab9eedfc89654ac3aa635f4a3ad24409ad23b6,1,0,1.0,5.3753,0.4372,6,7.17,323,0,Feature,0,0,1,2,0.003257,0.2,0,0.2,1,4,0,0,0.8473,0.5,34.3,13.1,1,0,0.0047,1,1.4954,0,0,0,0,0,"Integrate mypy

oslo.context is pretty small and therefore easy to introduce mypy for.
Minimal type hints are added, along with tox targets to validate things.
We can build on these in the future if we'd like to.
[SEP]
FILES CHANGED:
oslo_context/fixture.py (+2, -2)
test-requirements.txt (+1, -0)
oslo_context/context.py (+95, -89)
oslo_context/version.py (+0, -1)
setup.cfg (+11, -0)
tox.ini (+12, -2)
",0.769149,-1.834453,0.041729,0.256509,-0.60359,-0.106309,0.123653,-0.806723,-0.865661,0.260182,-0.56666,-0.338485,-0.073083,-0.214739,-0.003658
openstack/kolla-ansible,I8fe0e54cb764a26d26c6196cef68aadc6fd57b90,1,1,1.0,2.8332,0.0625,4,11.67,273,0,Bug Fix,0,0,0,2,0.117647,1.0,0,1.0,4,3,0,0.7576,1.749,3.5,57.22,11.52,1,0,0.0,1,16.0588,0,6,0,10,0,"fluentd: log to a file instead of stdout

fluentd logs currently to stdout, which is known to produce big docker logs
in /var/lib/docker. This change makes fluentd to log to /var/log/kolla/fluentd.

Closes-Bug: #1888852
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1888852-8735ee29f69f77b5.yaml (+5, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
ansible/roles/common/templates/fluentd.json.j2 (+6, -1)
ansible/roles/common/templates/cron-logrotate-fluentd.conf.j2 (+3, -0)
",-0.568061,0.004364,-0.911703,0.098604,-0.139678,-0.514899,0.059539,-0.208515,-0.495852,0.019829,-0.238746,-0.642495,0.084838,0.119417,-0.040144
openstack/octavia,Ia9d9d844b325296401577f5617d2b89cf1a017a7,1,0,0.7727,1.3863,0.3333,1,8.5,189,0,Feature,0,0,0,22,0.010295,0.2105,0,0.1627,2,1,0,0.4813,0.0,2.0,-50.62,17.52,0,0,0.0,0,47.25,0,0,0,0,0,"Add some details on enable_anti_affinity option

Explain that ""enable_anti_affinity"" affects only amphorae in
ACTIVE_STANDBY topology.
[SEP]
FILES CHANGED:
octavia/common/config.py (+2, -1)
",-0.412928,0.353558,-0.789593,0.883207,1.000279,0.327143,-0.634434,-0.238697,0.119536,-0.422992,0.080432,-0.011855,-0.462267,-0.451076,0.16712
openstack/kolla-ansible,I32fe980845df3c84d2050f56446b6292e406c770,0,0,0,3.4012,0.0,4,3.0,204,0,Doc,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.7647,1.6093,3.0,-106.41,17.87,1,0,0.0,0,6.8,0,0,0,0,0,"Add enable_manila_backend_lvm support

add lvm support for manila-share

ref:
https://docs.openstack.org/manila/latest/install/install-share-rdo.html
[SEP]
FILES CHANGED:
ansible/roles/manila/defaults/main.yml (+15, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+8, -0)
etc/kolla/globals.yml (+5, -0)
",-0.385897,2.555646,-1.470324,0.403814,-0.134918,-0.62952,-0.292184,0.040443,0.197299,-0.706868,-0.764428,-0.034814,-0.245693,-0.081992,0.183014
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,0,1,0,2.4849,0.1818,1,3.83,535,0,Bug Fix,1,0,0,0,0.0,1.0,0,0.0,3,1,0,0.6,0.0,3.0,-17.75,12.84,1,0,1.0,0,44.5833,0,6,0,26,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
(cherry picked from commit afb035d97185fa9c622bdb9b4c31c71f01160370)
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -2)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,0,1,0.0,2.4849,0.1818,1,3.83,535,0,Bug Fix,1,0,0,1,0.083333,0.5,0,0.0,3,1,0,0.5,0.0,3.0,-17.75,12.84,1,0,1.0,0,44.5833,0,0,0,0,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
(cherry picked from commit afb035d97185fa9c622bdb9b4c31c71f01160370)
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -2)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,0,1,0.0,2.4849,0.1818,1,3.83,535,0,Bug Fix,1,0,0,2,0.086957,0.3333,0,0.0,3,1,0,0.4286,0.0,3.0,-17.75,12.84,1,0,1.0,0,44.5833,0,6,0,26,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
(cherry picked from commit afb035d97185fa9c622bdb9b4c31c71f01160370)
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -2)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,0,1,0.0,2.4849,0.1818,1,3.83,535,0,Bug Fix,1,0,0,3,0.088235,0.25,0,0.0,3,1,0,0.375,0.0,3.0,-17.75,12.84,1,0,1.0,0,44.5833,0,6,0,26,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
(cherry picked from commit afb035d97185fa9c622bdb9b4c31c71f01160370)
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -2)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/oslo.messaging,Ibbcf21a57ab1e3f90c21901296e5c088b645127c,0,1,0.0,2.4849,0.1818,1,3.83,535,0,Bug Fix,1,0,0,4,0.088889,0.2,0,0.0,3,1,0,0.3333,0.0,3.0,-17.75,12.84,1,0,1.0,0,44.5833,0,6,0,26,0,"tests: Resolves issues with kombu > 4.6.8

The 'kombu.connection.Connection.ensure_connection' method has changed
from calling 'retry_over_time' on 'self.connect' to calling it on
'self._connection_factory' [1], meaning our mocks are outdated. Address
this change.

[1] https://github.com/celery/kombu/pull/1193/commits/398aa5b8cd1fe1fc

Closes-Bug: #1885923
(cherry picked from commit afb035d97185fa9c622bdb9b4c31c71f01160370)
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+9, -2)
",-2.070615,1.074847,0.112235,-1.23675,0.148733,0.096683,0.548402,-0.030413,0.025992,0.086012,0.150635,-0.490245,-0.501972,-0.155895,0.000368
openstack/oslo.concurrency,I358b62b45096cfbcafe0e665d92e6b05fb36b153,0,0,0,1.0986,0.5,1,4.0,283,0,Feature,1,0,1,0,0.0,0.0714,1,0.0,0,1,0,0,0.0,0.0,9.4,14.46,1,0,1.0,0,94.3333,0,0,0,0,0,"Bump bandit version

This patch bumps bandit allowed version to >=1.6.0,<1.7.0 in order to
avoid the errors detailed here https://github.com/PyCQA/bandit/pull/393
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",-0.601501,1.939336,-0.833803,0.882872,-0.213853,0.618148,-0.352272,-0.041202,-0.174899,0.944226,-0.635638,0.068759,-0.303144,0.060673,0.544783
openstack/octavia,Ifdc24033db288ec615391e576c1c77e6b35aba1f,1,0,0.5,2.6391,0.4615,3,10.86,532,0,Bug Fix,0,0,0,10,0.011587,0.5714,0,0.2857,5,1,0,0.4845,1.5766,4.0,41.09,12.76,1,0,0.0,0,38.0,1,0,0,0,0,"Fix haproxy user flow log format substitution

The user log format string has two special parameters: {{ project_id }}
and {{ lb_id }}. These parameters are documented as being wrapped around
double curly brackets and a whitespace, and are being used as so by
operators/installers. However, the actual substitution is single curly
bracket with no whitespace, i.e. {project_id} and {lb_id}. Fix this
issue by aligning the code with the documentation.

Task: 40444
Story: 2007958
[SEP]
FILES CHANGED:
octavia/common/config.py (+3, -2)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+2, -2)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+2, -2)
",-1.107728,-0.896057,0.048067,0.418419,0.426619,0.01141,0.049394,-0.065822,0.404184,0.222443,0.187791,-0.17384,0.085839,0.145041,-0.388304
openstack/kolla-ansible,Ib8b70ee40ec2d19509cc84c0f530612f81907721,0,1,1.0,4.0254,0.4364,7,6.33,755,0,Bug Fix,0,0,0,4,0.133333,0.5,0,0.5,4,3,0,0.7429,1.8238,2.14,35.66,13.06,1,0,0.8727,1,13.4821,0,6,0,16,0,"ubuntu: move to 20.04 Focal

There is a time once every 2 years when ubuntu team releases new LTS
release. And then UCA joins with binary packages for current OpenStack
development cycle.

It is this time for Ubuntu 20.04 'focal'.

Includes CI fix to pass:

[CI] Temporarily block new Ansible

The proper fix [1] needs fixing older branches before newer.
This one allows to fix CI first, in the usual order.

To revert after [1] gets merged in all relevant branches.

[1] https://review.opendev.org/745648

Old-Change-Id: Ifbd37d8addd4322773118e2e9d46494741a8ae66
Related-Bug: #1891145

Depends-on: https://review.opendev.org/#/c/738994/
Co-Authored-By: Rados≈Çaw Piliszek <radoslaw.piliszek@gmail.com>
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
tests/run.yml (+1, -1)
doc/source/user/quickstart.rst (+1, -1)
doc/source/user/support-matrix.rst (+1, -1)
zuul.d/nodesets.yaml (+12, -6)
zuul.d/jobs.yaml (+14, -14)
ansible/roles/prechecks/vars/main.yml (+1, -0)
",-3.01145,0.490671,2.332904,-1.678355,-0.627478,0.227368,-0.093467,0.351929,-0.268385,-0.107819,0.097059,0.154364,-0.009374,0.249622,-0.305187
openstack/octavia,I4ec2299b64b180f8b2d8f0b8485a6be9fe32d2eb,1,0,0.4568,4.5539,0.117,4,15.5,270,0,Bug Fix,0,0,0,81,0.003445,0.5556,0,0.2538,5,2,0,0.4877,1.0958,3.25,8.26,21.68,0,0,0.7766,1,2.8421,0,0,0,0,0,"Fix accepting 'insert_headers' when unsupported

This patch fixes the Octavia listener API from accepting the
'insert_headers' parameter for protocols that do not support header
insertion.

Story: 2007967
Task: 40464
[SEP]
FILES CHANGED:
octavia/common/constants.py (+5, -0)
octavia/tests/functional/api/v2/test_listener.py (+65, -8)
releasenotes/notes/fix-protocol-header-insertion-mismatch-e3aeb5f5fee0348b.yaml (+5, -0)
octavia/api/v2/controllers/listener.py (+8, -3)
",0.741835,-0.469611,-0.548397,0.197927,-0.080688,0.364333,-0.573631,-0.132626,0.479571,-0.150039,0.009205,-0.10156,0.026193,-0.219852,0.085423
openstack/octavia,I2f64a44c566f138c58ea4be53b1ff90a52012950,1,0,0.5455,3.3322,0.0,2,5.0,289,0,CI,0,0,0,11,0.012557,0.0,0,0.0,3,2,0,0.4908,0.7642,2.5,22.89,13.43,1,0,0.0,1,10.3214,0,0,0,0,0,"Install HAProxy 2.x in CentOS amphora images

The CentOS NFV SIG [1] maintains a RPM repository with extra and newer
packages. This includes HAProxy 2.2 as of this time of writing.

[1] https://wiki.centos.org/SpecialInterestGroup/NFV
[SEP]
FILES CHANGED:
elements/haproxy-octavia/pre-install.d/01-repositories (+21, -0)
releasenotes/notes/add-haproxy2-centos-063beb304409d141.yaml (+6, -0)
",-0.816099,0.506511,-0.715198,0.679781,-0.640668,0.38373,-0.132125,0.937242,-0.182578,0.663023,-0.135143,0.095969,-0.052138,-0.098671,-0.288582
openstack/kolla,I8f60cce4d7a8abcfd2e03c8eb4a153c37e2287bd,0,0,0.8,1.9459,0.0,1,1.71,810,0,Bug Fix,0,0,1,5,0.058824,0.0909,1,0.0727,0,1,0,0.8824,0.0,0.0,18.32,9.0,1,0,0.0,0,115.7143,0,0,0,0,0,"requirements.txt: pin gitdb(2) versions

""pip install -r requirements.txt"" ended with:

ERROR: Could not find a version that satisfies the requirement gitdb>=4.0.1 (from gitdb2>=2.0.0->GitPython<2.1.12,>=1.0.1->-r /home/hrw/devel/linaro/kolla/requirements.txt (line 7)) (from versions: 0.5.0, 0.5.1, 0.5.2, 0.5.3, 0.5.4, 0.6.0, 0.6.1, 0.6.2, 0.6.3, 0.6.4)
ERROR: No matching distribution found for gitdb>=4.0.1 (from gitdb2>=2.0.0->GitPython<2.1.12,>=1.0.1->-r /home/hrw/devel/linaro/kolla/requirements.txt (line 7))

The issue is due to gitdb/gitdb2 projects merge/rename -
https://github.com/gitpython-developers/gitdb/issues/61 for more info.

This fix is based on change from stable/ussuri requirements project - https://review.opendev.org/#/c/710138/
[SEP]
FILES CHANGED:
requirements.txt (+6, -0)
",-4.331403,3.974018,2.328367,-0.054888,0.308026,0.837036,-0.26827,-0.108638,-0.619144,0.702413,-0.34814,0.107532,-0.205651,0.484928,0.076042
openstack/octavia-lib,Iea9fdbfaee7c7965adcc65825fe6422f87b06de0,0,0,0.5833,3.3673,0.1071,4,9.0,100,0,Feature,0,0,0,12,0.013289,0.0,0,0.0,5,2,0,0.0526,1.9068,3.0,-9.1,21.38,1,0,0.3929,1,3.4483,0,0,0,0,0,"Add alpn_protocols to the listener data model
[SEP]
FILES CHANGED:
releasenotes/notes/add-listener-alpn-protocols-ecb49db86b956c71.yaml (+7, -0)
octavia_lib/common/constants.py (+6, -0)
octavia_lib/tests/unit/api/drivers/test_data_models.py (+9, -2)
octavia_lib/api/drivers/data_models.py (+3, -1)
",2.10062,-0.108479,1.385443,1.121506,1.368117,-0.438671,0.546103,0.920618,0.976544,-0.46077,-0.651184,-0.217963,-1.02303,-0.309893,-0.270056
openstack/octavia,If08a8169498cdfaa75440e8971ba0caff45ac4c4,0,0,0.5385,6.3386,0.0655,40,7.0,577,0,Feature,0,0,1,13,0.013963,0.6,0,0.3231,7,9,0,0.4939,4.1746,3.7,41.52,13.71,1,0,0.6124,1,1.0194,0,0,0,0,0,"Add ALPN support for TLS-terminated HTTPS LBs

ALPN is a TLS extension for application-layer protocol negotiation
within the TLS handshake [1].

This patch extends the Listener API to include a new 'alpn_protocols'
parameter. With this parameter, users can set an ALPN preference list
(descending order of preference).

Presently, the amphora provider driver is limited to http/1.0 and
http/1.1 ALPN protocol IDs. Support for ""h2"" (HTTP/2 over TLS) depends
on HAProxy 2.0 or newer.

[1] https://tools.ietf.org/html/rfc7301
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+16, -0)
api-ref/source/v2/examples/listener-update-curl (+1, -1)
api-ref/source/v2/examples/listener-update-request.json (+2, -1)
octavia/common/config.py (+6, -1)
octavia/tests/unit/common/test_validations.py (+14, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/common/sample_data_models.py (+7, -2)
octavia/tests/unit/api/v2/types/test_listeners.py (+12, -0)
etc/octavia.conf (+5, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+7, -3)
octavia/common/validate.py (+18, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+2, -0)
requirements.txt (+1, -1)
octavia/common/constants.py (+7, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_amphora_driver.py (+28, -1)
api-ref/source/v2/examples/listener-create-response.json (+2, -1)
octavia/api/drivers/amphora_driver/v2/driver.py (+15, -0)
octavia/tests/functional/api/v2/test_load_balancer.py (+6, -1)
api-ref/source/v2/examples/listener-update-response.json (+2, -1)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+7, -1)
octavia/tests/functional/api/v2/test_listener.py (+95, -2)
api-ref/source/v2/examples/listener-show-response.json (+2, -1)
releasenotes/notes/add-listener-tls-alpn-support-3056fb01b418c88f.yaml (+9, -0)
octavia/db/models.py (+1, -0)
octavia/api/v2/types/listener.py (+5, -0)
api-ref/source/v2/examples/listener-create-request.json (+2, -1)
api-ref/source/v2/listener.inc (+6, -0)
lower-constraints.txt (+1, -1)
api-ref/source/v2/examples/listener-create-curl (+1, -1)
octavia/api/drivers/amphora_driver/v1/driver.py (+15, -0)
octavia/db/prepare.py (+4, -0)
api-ref/source/v2/examples/listeners-list-response.json (+2, -1)
octavia/api/common/types.py (+14, -0)
octavia/common/data_models.py (+3, -1)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+28, -1)
octavia/api/root_controller.py (+4, -1)
octavia/db/migration/alembic_migrations/versions/2ab994dd3ec2_add_listener_alpn_protocols_column.py (+35, -0)
doc/source/user/feature-classification/feature-matrix-listener.ini (+8, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+124, -12)
octavia/api/v2/controllers/listener.py (+9, -0)
",-1.926244,0.019459,0.833933,0.556578,-0.130564,0.051281,-0.277126,0.778776,0.532464,0.552188,-0.222887,0.247989,-0.26784,-0.29038,-0.281344
openstack/octavia,I2fc51596434e97d6f4ca2522ceabab8d1f65194e,0,0,0.1667,4.6151,0.36,2,10.0,225,0,Bug Fix,0,0,0,12,0.003646,0.4444,0,0.0741,7,1,0,0.4909,0.9815,6.0,-23.27,22.0,0,1,0.42,0,2.2277,0,0,0,0,0,"[AmphoraV2] Fix l7policy/l7rule quota decrement

Fix ""AttributeError: 'dict' object has no attribute 'project_id'""
job octavia-v2-dsvm-scenario-amphora-v2 hit this issue.
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/tasks/database_tasks.py (+28, -30)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks_quota.py (+36, -6)
",-0.401466,0.39335,-1.447606,-0.095373,0.423686,-0.542955,-0.488176,0.040432,0.219176,-0.445899,0.026453,0.093488,-0.203297,-0.012147,-0.148254
openstack/octavia,Id29d0d2cd5ab1ae3c7d26194a235af25c2271d62,0,0,0.5,3.091,0.4286,4,7.62,432,0,CI,0,0,0,14,0.009358,0.3333,0,0.1667,7,2,0,0.488,1.9502,4.5,40.99,14.85,1,0,0.5714,1,19.6364,0,0,0,0,0,"Add HTTP/2 over TLS support to amphora provider

HTTP/2 requires HAProxy 2.0 or newer in amphora images. The operating
system versions in test as of today (Ubuntu Bionic and CentOS 8) do not
provide HAProxy 2.x in their official repositories. For this reason, the
default listener ALPN protocol list remains unchanged, defaulting to
ALPN protocol IDs ""http/1.1"" and ""http/1.0"".
[SEP]
FILES CHANGED:
octavia/common/constants.py (+2, -1)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_amphora_driver.py (+2, -4)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+2, -4)
releasenotes/notes/add-amphora-alpn-h2-support-dfa9a86b2c06f354.yaml (+6, -0)
",-0.94271,-0.669746,0.240408,0.731994,0.275906,-0.167796,0.251442,1.06752,-0.040532,0.717581,-0.327451,0.007451,0.046188,-0.335651,0.268645
openstack/octavia,I400dde533f78bc14ee568bfd9714eafac97e8a39,1,0,0.7826,4.3694,0.0385,5,15.8,564,0,Bug Fix,0,0,0,23,0.010748,0.6667,0,0.5217,6,3,0,0.485,2.0059,4.6,24.81,17.97,0,0,0.5897,1,7.1392,0,0,0,0,0,"Fix operational status for disabled UDP listeners

Disabled UDP listeners appeared as ONLINE, as the heartbeat message
always showed listeners as OPEN, even if disabled.

This commit fixes the configuration file for UDP listeners, previously
enabling or disabling a UDP listener created the same config file. Now
disabling a UDP listener explicitly adds a comment in the file.

Based on this comment, the heartbeat message doesn't include status
updates for disabled UDP listeners.

Story: 2007979
Task: 40605
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+15, -0)
octavia/common/jinja/lvs/templates/base.j2 (+4, -0)
releasenotes/notes/fix-disable-udp-listener-status-3d34a5596e62da1c.yaml (+6, -0)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+19, -3)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+31, -0)
",-1.194571,-1.434208,0.141701,0.691962,-0.212838,0.336829,-0.250139,-0.237838,0.32,0.073844,0.296684,-0.140211,0.474956,0.335005,-0.114967
openstack/kolla,I12efbaae9c0795f29c2f68158127509fd1b543b0,1,0,0,0.6931,0.0,1,8.17,468,0,CI,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.8333,0.0,2.0,5.17,17.14,1,0,0.0,0,234.0,0,0,0,0,0,"Add collectd-libpod-stats to image

This patch adds the installation of collectd-libpod-stats as part of the
collectd image. The package is available in the centos-opstools repo.

Collectd-libpod-stats monitors resource usage of running containers on a
host, specifically those managed by the libpod library.

Upstream: https://github.com/pleimer/collectd-libpod-stats
[SEP]
FILES CHANGED:
docker/collectd/Dockerfile.j2 (+1, -0)
",-1.776301,1.162102,-0.749028,1.288846,0.118034,-0.797182,0.414449,0.70456,0.026259,-0.286285,0.224729,0.236208,0.063168,0.310287,0.144953
openstack/python-octaviaclient,Iab8b8339cf096ee1f5c56a828629f0ebf94484a9,0,0,0.4667,3.7612,0.0714,5,20.0,170,0,CI,0,0,0,15,0.009888,0.1667,0,0.0778,5,2,0,0.0968,2.2438,3.6,55.41,12.0,0,0,0.381,1,3.9535,0,0,0,0,0,"Add TLS versions and ciphers unsets

Task: 40617
Task: 40618
Story: 2006627

Task: 40615
Task: 40616
Story: 2006733
[SEP]
FILES CHANGED:
releasenotes/notes/add-tls-versions-ciphers-unsets-8d06a502c8ad38ff.yaml (+4, -0)
octaviaclient/tests/unit/osc/v2/test_listener.py (+7, -1)
octaviaclient/osc/v2/listener.py (+11, -1)
octaviaclient/tests/unit/osc/v2/test_pool.py (+7, -1)
octaviaclient/osc/v2/pool.py (+10, -0)
",-0.960344,0.110681,-1.385151,-0.519221,0.739656,1.417412,-2.676141,0.198081,0.353244,0.385156,-0.198154,0.361306,0.686784,1.152639,0.04735
openstack/kolla-ansible,I0ce24043ae5486b2b55489ba40abe2b96b0991a6,0,0,0.6364,6.7765,0.9646,104,20.5,1722,0,Bug Fix,0,0,0,11,0.018998,1.0,0,0.6364,4,2,0,0.7222,6.2458,3.98,27.49,16.49,1,0,0.0,1,1.9635,0,0,0,0,0,"Performance: Don't notify handlers during config

This patch builds upon genconfig optimisation and it takes it
further by not having genconfig ever touch the handlers!
Calling the handlers and skipping them created an unnecessary slow down
if only config was ran. It also depends on the config checking fix.

This gets us closer to the single responsibility principle -
config only generates the config, container checks only validate
whether container restart is needed.

And this also means that we will have single place were containers
are restarted, were we can fix the ansible quirk of it restarting
the whole group even when one container changed in the following patches.

The only exception is the loadbalance role. As the loadbalancer services
have their config altered by other roles registering their services
using loadbalancer-config. This is in contrast to typical roles,
which do config in one step and can then run check-containers in
the next step.

Fixes some handlers that were missing the necessary guard,
making genconfig actually able to restart some containers.

Future work:
- optimise config by doing local generation and mass rsync
- support for reloads
- unconditional restart/reload (separate action)
- make 'reconfigure' act like 'genconfig' + 'deploy-containers'
  - this would avoid calling bootstrapping each time but might
    be tricky as it would break current compatibility
  - could call this 'reconfigure-containers' and deprecate
    'reconfigure'
- fix the ansible quirk that notifies more handlers then intended

Partially-Implements: blueprint performance-improvements
Co-Authored-By: Roman Krƒçek <roman.krcek@tietoevry.com>
[SEP]
FILES CHANGED:
ansible/roles/manila/handlers/main.yml (+0, -8)
ansible/roles/skyline/handlers/main.yml (+0, -4)
ansible/roles/mistral/handlers/main.yml (+0, -8)
ansible/roles/cloudkitty/tasks/config.yml (+0, -10)
ansible/roles/barbican/tasks/config.yml (+0, -10)
ansible/roles/cyborg/handlers/main.yml (+0, -6)
ansible/roles/neutron/handlers/main.yml (+0, -37)
ansible/roles/skyline/tasks/config.yml (+0, -10)
ansible/roles/horizon/tasks/config.yml (+0, -12)
ansible/roles/letsencrypt/tasks/config.yml (+0, -6)
ansible/roles/magnum/tasks/config.yml (+0, -8)
ansible/roles/keystone/tasks/config.yml (+0, -18)
ansible/roles/ironic/tasks/config.yml (+3, -30)
ansible/roles/watcher/handlers/main.yml (+0, -6)
ansible/roles/opensearch/handlers/main.yml (+0, -4)
ansible/roles/opensearch/tasks/config.yml (+0, -6)
ansible/roles/influxdb/handlers/main.yml (+0, -2)
ansible/roles/etcd/tasks/config.yml (+0, -2)
ansible/roles/octavia/handlers/main.yml (+0, -10)
ansible/roles/masakari/handlers/main.yml (+0, -8)
ansible/roles/rabbitmq/handlers/main.yml (+0, -2)
ansible/roles/watcher/tasks/config.yml (+0, -6)
ansible/roles/tacker/tasks/config.yml (+0, -6)
ansible/roles/mariadb/handlers/main.yml (+0, -3)
ansible/roles/gnocchi/tasks/config.yml (+0, -8)
ansible/roles/telegraf/tasks/config.yml (+0, -6)
ansible/roles/common/handlers/main.yml (+0, -6)
ansible/roles/openvswitch/tasks/config.yml (+0, -2)
ansible/roles/gnocchi/handlers/main.yml (+0, -6)
ansible/roles/nova-cell/handlers/main.yml (+0, -14)
ansible/roles/trove/tasks/config.yml (+0, -10)
ansible/roles/ovs-dpdk/tasks/config.yml (+0, -2)
ansible/roles/prometheus/tasks/config.yml (+0, -20)
ansible/roles/barbican/handlers/main.yml (+0, -6)
ansible/roles/cyborg/tasks/config.yml (+0, -8)
ansible/roles/grafana/tasks/config.yml (+0, -12)
ansible/roles/heat/tasks/config.yml (+0, -10)
ansible/roles/ironic/handlers/main.yml (+0, -14)
ansible/roles/letsencrypt/handlers/main.yml (+0, -4)
ansible/roles/ceilometer/handlers/main.yml (+0, -8)
ansible/roles/iscsi/tasks/config.yml (+0, -2)
ansible/roles/cloudkitty/handlers/main.yml (+0, -4)
ansible/roles/neutron/tasks/config.yml (+0, -50)
ansible/roles/cinder/handlers/main.yml (+0, -8)
ansible/roles/etcd/handlers/main.yml (+0, -4)
ansible/roles/cinder/tasks/config.yml (+0, -12)
ansible/roles/grafana/handlers/main.yml (+0, -3)
ansible/roles/glance/tasks/config.yml (+0, -16)
ansible/roles/masakari/tasks/config.yml (+0, -14)
ansible/roles/placement/handlers/main.yml (+0, -2)
ansible/roles/multipathd/handlers/main.yml (+0, -2)
ansible/roles/ovn-db/handlers/main.yml (+0, -6)
ansible/roles/blazar/tasks/config.yml (+0, -6)
ansible/roles/prometheus/handlers/main.yml (+0, -20)
ansible/roles/zun/tasks/config.yml (+0, -8)
ansible/roles/ceilometer/tasks/config.yml (+0, -26)
ansible/roles/ovn-controller/tasks/config.yml (+0, -2)
ansible/roles/magnum/handlers/main.yml (+0, -4)
ansible/roles/memcached/handlers/main.yml (+0, -2)
ansible/roles/multipathd/tasks/config.yml (+0, -4)
ansible/roles/loadbalancer/tasks/copy-certs.yml (+0, -8)
ansible/roles/rabbitmq/tasks/config.yml (+0, -14)
ansible/roles/telegraf/handlers/main.yml (+0, -2)
ansible/roles/octavia/tasks/config.yml (+0, -14)
ansible/roles/common/tasks/config.yml (+0, -8)
ansible/roles/collectd/handlers/main.yml (+0, -2)
ansible/roles/ovs-dpdk/handlers/main.yml (+0, -4)
ansible/roles/placement/tasks/config.yml (+0, -10)
ansible/roles/designate/tasks/config.yml (+0, -14)
ansible/roles/hacluster/handlers/main.yml (+0, -6)
ansible/roles/loadbalancer/tasks/config.yml (+0, -24)
ansible/roles/kuryr/handlers/main.yml (+0, -2)
ansible/roles/venus/tasks/config.yml (+0, -6)
ansible/roles/iscsi/handlers/main.yml (+0, -4)
ansible/roles/blazar/handlers/main.yml (+0, -4)
ansible/roles/influxdb/tasks/config.yml (+0, -4)
ansible/roles/mariadb/tasks/config.yml (+0, -4)
ansible/roles/mistral/tasks/config.yml (+0, -8)
ansible/roles/heat/handlers/main.yml (+0, -6)
ansible/roles/venus/handlers/main.yml (+0, -4)
ansible/roles/kuryr/tasks/config.yml (+0, -8)
ansible/roles/ovn-controller/handlers/main.yml (+0, -2)
ansible/roles/redis/tasks/config.yml (+0, -4)
ansible/roles/horizon/handlers/main.yml (+0, -2)
ansible/roles/nova-cell/tasks/config-libvirt-tls.yml (+0, -2)
ansible/roles/aodh/handlers/main.yml (+0, -8)
ansible/roles/hacluster/tasks/config.yml (+0, -10)
ansible/roles/nova/handlers/main.yml (+0, -3)
ansible/roles/zun/handlers/main.yml (+0, -8)
ansible/roles/tacker/handlers/main.yml (+0, -4)
ansible/roles/collectd/tasks/config.yml (+0, -4)
ansible/roles/manila/tasks/config.yml (+0, -8)
ansible/roles/keystone/handlers/main.yml (+0, -6)
ansible/roles/aodh/tasks/config.yml (+0, -8)
ansible/roles/designate/handlers/main.yml (+0, -14)
ansible/roles/trove/handlers/main.yml (+0, -6)
ansible/roles/nova/tasks/config.yml (+0, -10)
ansible/roles/nova-cell/tasks/config.yml (+0, -22)
ansible/roles/glance/handlers/main.yml (+0, -4)
ansible/roles/memcached/tasks/config.yml (+0, -1)
releasenotes/notes/config-handlers-fba9b642c84fc2d7.yaml (+28, -0)
ansible/roles/openvswitch/handlers/main.yml (+0, -4)
ansible/roles/ovn-db/tasks/config.yml (+0, -2)
ansible/roles/redis/handlers/main.yml (+0, -4)
",-2.910645,-0.611892,4.359078,-1.234955,-0.372167,0.081044,-0.794158,-0.742805,-0.859522,-0.34577,-0.759533,0.470968,0.243144,0.140667,0.001011
openstack/octavia,I0c124e80fec2ac9ad813e78df6ad25da6b8e9668,1,0,0.4634,4.8203,0.0163,6,14.25,377,0,Bug Fix,0,0,0,82,0.003474,1.0,0,0.4634,5,2,0,0.4881,1.9384,3.67,46.92,9.91,1,0,0.7561,1,3.0403,0,0,0,0,0,"Fix API sort key for complex columns

The Octavia API sort function was not working correctly for some
columns that have different names in the API vs the data model.
This patch also handles the case where a column may be a compound
object in the data model, such as vip_address->vip.ip_address.

Story: 2007991
Task: 40626
[SEP]
FILES CHANGED:
octavia/api/common/pagination.py (+14, -1)
octavia/api/common/types.py (+8, -0)
octavia/tests/functional/api/v2/test_health_monitor.py (+58, -0)
releasenotes/notes/fix-api-sort-key-337f342d5cdce432.yaml (+5, -0)
octavia/api/v2/controllers/pool.py (+1, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+35, -0)
",-0.190004,-1.310146,-0.220409,0.542474,-0.148542,0.283322,0.478543,0.00781,0.539863,-0.143956,0.088295,0.03633,0.052208,0.013747,-0.20895
openstack/kolla,I017d7a6a5d2b1ae6c04556dcf172453a36de5be7,1,0,0.5833,3.5835,0.8571,12,11.44,694,0,Doc,0,0,0,12,0.008247,0.0,0,0.0,3,1,0,0.8421,3.2996,2.92,52.3,11.57,1,0,0.0,0,19.2778,0,0,0,0,0,"Remove weird deps

This is a follow-up on ""Refactor httpd install to base image""
[1].

It seems a copy-paste algorithm was used to craft Dockerfiles
for some httpd-enabled services which resulted in an abundance of
ldappool packages getting installed, even in the 'source' case.
This seems to have also kept ldappool at a lower version because
it did not get updated via pip later.
This patch deals with that and also moves ldap deps for Keystone
to their proper place in 'source' case (extras).
Note Keystone client gets installed in openstack-base.

Cinder does not need to include Keystone either.

[1] https://review.opendev.org/744037
[SEP]
FILES CHANGED:
docker/masakari/masakari-base/Dockerfile.j2 (+0, -2)
docker/panko/panko-base/Dockerfile.j2 (+0, -3)
docker/vitrage/vitrage-base/Dockerfile.j2 (+0, -2)
docker/openstack-base/Dockerfile.j2 (+0, -1)
docker/aodh/aodh-base/Dockerfile.j2 (+0, -3)
docker/vitrage/vitrage-api/Dockerfile.j2 (+0, -2)
docker/cinder/cinder-api/Dockerfile.j2 (+0, -1)
docker/zun/zun-base/Dockerfile.j2 (+0, -2)
docker/keystone/keystone-base/Dockerfile.j2 (+5, -4)
docker/qinling/qinling-base/Dockerfile.j2 (+0, -2)
docker/zaqar/zaqar-base/Dockerfile.j2 (+0, -4)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+0, -4)
",-1.779278,-0.699999,1.05699,-0.348792,-0.600921,-0.176796,0.205303,0.007943,-0.466968,0.066571,0.138924,0.021756,0.074519,-0.14039,0.005907
openstack/kolla,I5365c813bab5e3205fd34eb64dc3337f192d67d4,1,0,0.6154,1.0986,0.5,1,8.5,148,0,Bug Fix,1,0,0,13,0.008725,1.0,0,0.6154,2,1,0,0.85,0.0,2.0,48.91,10.46,1,1,1.0,0,49.3333,0,0,0,0,0,"[CI] Fix wheel url for CentOS

CentOS wheels do not differentiate between minor versions atm.
[SEP]
FILES CHANGED:
tests/vars/zuul.yml (+1, -1)
",2.391708,0.593714,0.454368,0.334155,-0.075031,0.747377,0.295241,0.294698,-0.602261,0.374586,-0.046908,0.066577,0.20369,-0.216798,-0.662424
openstack/octavia,I0154b83cb64952844a28895721694d3e2ff82be2,1,0,0,2.3979,0.8,3,16.5,461,0,Bug Fix,0,0,0,0,0.0,0.4167,0,0.0,1,3,0,0.4911,1.371,1.0,40.11,12.05,1,0,0.0,0,41.9091,0,0,0,0,0,"Update devstack plugin

There is no reason to create internal and admin endpoints in DevStack,
most other services have stopped doing so a long time ago.

Also use the global SERVICE_PROTOCOL variable as default for
OCTAVIA_PROTOCOL instead of ""http"", this will make us automatically
use the secure API access when the tls-proxy service is enabled.

Fix the instructions for using the devstack plugin, too.
[SEP]
FILES CHANGED:
devstack/plugin.sh (+0, -6)
devstack/README.md (+1, -1)
devstack/settings (+1, -1)
",-0.629272,-1.587987,0.045139,0.72524,-0.414522,-0.39973,0.340891,0.311364,-0.190446,0.086145,0.167569,-0.496166,0.009477,-0.101076,-0.044465
openstack/kolla-ansible,I0f81214b4f95fe8a378844745ebc77f3c43027ab,1,1,0.6429,1.9459,0.0,2,7.75,289,0,Bug Fix,0,0,0,14,0.009383,0.0,0,0.0,2,2,0,0.7027,0.65,1.5,27.04,12.13,1,0,0.0,1,41.2857,0,6,0,16,0,"Fix post-deploy mode

Ansible changed the default mode for files, even in stable
releases. [1]

This change restores the previous default (with the common
umask).

[1] https://github.com/ansible/ansible/pull/70221

Closes-Bug: #1891145
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1891145-95e3943e8e030962.yaml (+5, -0)
ansible/post-deploy.yml (+1, -0)
",-0.657106,0.137127,-0.769358,0.061356,-0.808123,0.288726,-0.534902,0.120422,-0.072427,0.333019,0.005055,-0.25811,0.423673,0.052699,-0.245757
openstack/kolla-ansible,Ifbd37d8addd4322773118e2e9d46494741a8ae66,0,1,0.6667,1.0986,0.5,1,7.0,324,0,Bug Fix,1,0,0,15,0.010013,0.0,0,0.0,1,1,0,0.7105,0.0,1.0,44.63,8.51,1,1,1.0,0,108.0,0,6,0,16,0,"[CI] Temporarily block new Ansible

The proper fix [1] needs fixing older branches before newer.
This one allows to fix CI first, in the usual order.

To revert after [1] gets merged in all relevant branches.

[1] https://review.opendev.org/745648

Related-Bug: #1891145
[SEP]
FILES CHANGED:
tests/run.yml (+1, -1)
",0.472031,-0.652858,-0.042674,-0.26905,-1.288014,0.238641,0.232566,0.295815,-0.119493,0.472847,0.103484,-0.588646,0.143195,0.224765,-0.326763
openstack/kolla-ansible,Ifbd37d8addd4322773118e2e9d46494741a8ae66,1,1,0.625,1.0986,0.5,1,7.0,324,0,Bug Fix,1,0,0,16,0.010667,0.0,0,0.0,1,1,0,0.6923,0.0,1.0,44.63,8.51,1,1,1.0,0,108.0,0,6,0,16,0,"[CI] Temporarily block new Ansible

The proper fix [1] needs fixing older branches before newer.
This one allows to fix CI first, in the usual order.

To revert after [1] gets merged in all relevant branches.

[1] https://review.opendev.org/745648

Related-Bug: #1891145
[SEP]
FILES CHANGED:
tests/run.yml (+1, -1)
",0.472031,-0.652858,-0.042674,-0.26905,-1.288014,0.238641,0.232566,0.295815,-0.119493,0.472847,0.103484,-0.588646,0.143195,0.224765,-0.326763
openstack/kolla-ansible,Ib53d00fa4a6ee59b8a0b2245f83786a6af0cbf53,1,0,0.75,3.3322,0.037,4,29.0,244,0,Feature,0,0,0,4,0.011173,1.0,0,0.75,4,3,0,0.7,1.7848,2.5,-18.06,22.63,1,0,0.0741,0,8.7143,0,0,0,0,0,"add octavia openrc file

we use octavia user to upload image currently, so it is better to
create a octavia openrc file for user

Implements: blueprint implement-automatic-deploy-of-octavia
[SEP]
FILES CHANGED:
tests/check-config.sh (+1, -1)
ansible/post-deploy.yml (+5, -0)
ansible/roles/octavia/templates/octavia-openrc.sh.j2 (+11, -0)
ansible/roles/octavia/tasks/openrc.yml (+9, -0)
",-0.162044,-0.282699,-0.7998,0.618968,0.240338,-0.422946,-0.213368,-0.588094,-0.30186,-0.745972,-0.279241,0.508554,0.129154,0.56937,0.143474
openstack/kolla-ansible,I4b0ac001b38bee81d983dd68534b9d0e78b4f6d7,0,0,0.8,4.2905,0.0139,3,10.0,321,0,Feature,0,0,0,5,0.012987,1.0,0,0.8,4,2,0,0.7073,0.4313,4.0,21.14,16.0,1,0,0.0,0,4.3973,0,0,0,0,0,"Register resources info for octavia upgrading

kolla-ansible upgrade failed when octavia_auto_configure set
to true. because upgrade action don't register the resources
info.
this change adds some tasks to query the resources info
for upgrade action in octavia role.
[SEP]
FILES CHANGED:
ansible/roles/octavia/tasks/get_resources_info.yml (+67, -0)
ansible/roles/octavia/tasks/upgrade.yml (+3, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
",0.979166,-1.466182,0.013539,0.31299,0.282391,-0.447183,0.159224,-0.103037,-0.082267,-0.465336,-0.332442,-0.202623,-0.268878,0.000449,0.062641
openstack/kolla-ansible,If0c0e038b77fc010a3a017f9841a674d53b16457,1,1,0.7692,3.2581,0.0,2,21.2,744,0,Bug Fix,0,0,0,13,0.012311,0.0,0,0.0,4,2,0,0.6905,0.8555,3.0,32.08,17.91,0,0,0.0,1,28.6154,0,6,0,10,0,"Prevent overwriting existing Keystone Fernet keys

Steps to reproduce:

* Deploy a cloud
* Add another controller to the inventory
* Deploy to the new controller using --limit:

kolla-ansible deploy --limit new-controller

Expected results:

The new controller uses the cluster's existing fernet keys.

Actual results:

New fernet keys are generated on the new controller, and pushed out to
the existing controllers. This invalidates tokens created from those
keys.

This change prevents the above scenario from happening, by failing the
deployment if there are no hosts with existing Ferney keys to
distribute, and not all Keystone hosts are in the target host list.

Closes-Bug: #1891364
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/bootstrap_service.yml (+18, -0)
releasenotes/notes/prevent-keystone-bootstrap-limit-f0250725633c16de.yaml (+7, -0)
",-2.11212,-1.512396,1.502667,0.01218,-0.106054,-0.017611,-0.338552,0.315421,0.399524,-0.372256,-0.034586,0.175513,0.27132,0.375715,-0.317577
openstack/kayobe,If435e9025f3d78364b229bbe4458f5f1e1ab49aa,1,0,1.0,2.1972,0.0,2,12.33,292,0,Feature,0,0,0,3,0.036145,0.0,0,0.0,4,2,0,0.9444,0.9544,3.0,27.4,15.74,1,0,0.0,1,32.4444,0,0,0,0,0,"Make pip_index_url variable conditional

Setting pip's proxy variable, operator needs to set also pip_index_url,
even when one wants to use default value of index_url.
This patch sets pip's index_url only when pip_index_url is not empty.
[SEP]
FILES CHANGED:
releasenotes/notes/pip-index-url-conditional-3f9c5b3c5c808500.yaml (+5, -0)
ansible/roles/pip/tasks/pip_conf.yml (+3, -0)
",-1.599298,0.130114,-0.936539,1.567626,1.145394,0.345338,-0.607789,-1.020311,-0.199712,-0.134522,0.283118,-0.442954,-0.194763,0.167954,-0.151918
openstack/kolla,I1fa10cd7a0ee78613d2763c804ecefb2e5e8e75e,1,1,0,1.0986,0.5,1,10.0,105,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.8571,0.0,2.0,-14.81,20.0,1,0,0.0,0,35.0,0,6,0,9,0,"Updated TGTD to N for centos8

closes-bug: #1891685
[SEP]
FILES CHANGED:
doc/source/matrix_x86.csv (+1, -1)
",2.161232,0.098736,0.124113,-1.377087,0.109428,0.662393,-0.896184,0.006184,-0.011644,0.089524,0.085131,-0.163585,0.043431,0.075143,0.475802
openstack/kolla-ansible,I7fdb121b5bf9850d62246a24f9b17d226028c2ca,1,0,0,4.8978,0.0,6,12.0,458,0,Feature,0,0,0,0,0.0,0.5,0,0.0,4,4,0,0.6977,1.9492,3.0,40.97,12.8,1,0,0.0,1,3.4179,1,0,0,0,0,"Add support for GlusterFS NFS Manila backend

Follows existing backends patterns to add support for the GlusterFS
NFS driver.
NFS server type used by the GlusterFS backend, Gluster or Ganesha,
currently supports Gluster.
The GlusterFS NFS driver needs to install the glusterfs-fuse package
in the kolla images manila share container in advance, which has been merged
in https://review.opendev.org/747510
[SEP]
FILES CHANGED:
ansible/roles/manila/defaults/main.yml (+13, -0)
releasenotes/notes/add-support-GlusterFS-NFS-Manila-backend-fa8a54e06adb0714.yaml (+4, -0)
doc/source/reference/storage/manila-guide.rst (+63, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+20, -0)
etc/kolla/globals.yml (+32, -0)
",-0.53404,-0.244319,-0.116181,0.596984,-0.237563,-0.349548,0.637724,1.258081,0.136795,-0.261518,0.282954,0.24782,0.076045,-0.319653,0.100909
openstack/kayobe,I19ef5a46dccacc00db495993cc744938921996a1,0,0,1.0,3.8286,0.0667,10,12.0,123,0,Feature,0,0,0,6,0.063158,1.0,0,1.0,6,5,0,0.9474,3.039,3.9,18.41,14.8,1,0,0.2,1,2.6739,0,0,0,0,0,"Add support for custom Aodh configuration

Story: 2008019
Task: 40671
[SEP]
FILES CHANGED:
ansible/roles/kolla-openstack/vars/main.yml (+5, -0)
ansible/roles/kolla-openstack/tasks/config.yml (+1, -0)
releasenotes/notes/add-support-for-custom-aodh-conf-81a5a623f771d1c2.yaml (+3, -0)
ansible/roles/kolla-openstack/templates/aodh.conf.j2 (+10, -0)
doc/source/configuration/kolla-ansible.rst (+2, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/tests/test_default.py (+4, -2)
ansible/roles/kolla-openstack/molecule/default/tests/test_default.py (+2, -1)
ansible/roles/kolla-openstack/molecule/enable-everything/molecule.yml (+4, -0)
ansible/roles/kolla-openstack/defaults/main.yml (+9, -0)
ansible/kolla-openstack.yml (+2, -0)
",1.815654,-0.669452,-0.288479,-1.038722,-0.474679,0.80952,-0.925784,0.509208,0.306009,-0.200652,0.02049,0.414086,0.141097,0.482483,-0.400231
openstack/oslo.versionedobjects,Ia209311d57f607b2ddfcab8518264cd7f670dc8f,1,0,1.0,4.4188,0.9512,3,14.5,624,0,CI,0,0,0,1,0.058824,0.6667,0,0.6667,3,2,0,0,1.2906,2.0,49.17,12.24,1,0,0.0,1,7.5181,0,0,0,0,0,"zuul: port the legacy multinode grenade job

Make it a native Zuul v3 job.
It is a simple variant of the base 'grenade-multinode' job
where oslo.versionedobjects is installed from source instead of pip.

Also use a slightly more common name by dropping the ""-devstack""
component from the name (all grenade jobs are also devstack jobs).

Finally, remove the hardcoded xenial nodeset, thus inheriting the
default testing definition for it, and probably unbreaking
the job which has been failing so far.

(cherry picked from commit 9d67d0ff95d572d2a27cd50774b81b3eec4882df)
[SEP]
FILES CHANGED:
playbooks/legacy/oslo.versionedobjects-src-grenade-devstack-multinode/post.yaml (+0, -15)
.zuul.yaml (+4, -10)
playbooks/legacy/oslo.versionedobjects-src-grenade-devstack-multinode/run.yaml (+0, -53)
",-1.213754,-1.048978,0.77323,-0.936429,0.220187,-0.037034,0.848646,0.099294,-0.082407,-0.337542,0.146516,0.44682,-0.281569,-0.001436,-0.03108
openstack/castellan,I49e042ed89bc49736d82de7744952663415d6e02,1,0,1.0,1.6094,0.5,1,15.5,200,0,Feature,0,0,0,2,0.020202,0.75,0,0.75,0,1,0,1.0,0.0,0.0,62.84,12.65,1,0,0.0,0,40.0,0,0,0,0,0,"zuul: use the new barbican simple-crypto job

The old job name is still available as an alias for a while,
but it is time to switch away from it.
[SEP]
FILES CHANGED:
.zuul.yaml (+2, -2)
",0.864993,-1.715214,-0.116084,0.198058,-0.803092,0.391907,0.475826,-0.987531,-0.682388,0.096733,0.111817,0.661897,-0.432014,-0.000293,0.096426
openstack/kolla-ansible,I5ac8f20a2157d880b63a4c70bf6c782d06014f41,1,0,0.6471,1.0986,0.5,1,3.0,145,0,Feature,1,0,1,17,0.011318,0.0667,1,0.0431,0,1,0,0.7045,0.0,0.0,-68.81,18.98,1,0,1.0,0,48.3333,0,0,0,0,0,"Skip broken ansible-lint

See [1].

[1] https://github.com/ansible/ansible-lint/issues/969
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",-0.611998,4.406709,-1.59019,1.094348,-0.727028,0.107582,-0.473587,-0.643417,-0.223254,0.567241,-0.12498,0.149273,0.055732,-0.083554,-0.413098
openstack/kolla-ansible,Ifbbc2022839cbc575848d830600241c61603c80b,1,1,0.8571,2.4849,0.0,2,11.0,622,0,Bug Fix,0,0,0,7,0.05,0.0,0,0.0,4,2,0,0.7111,0.8454,3.0,23.17,15.83,1,0,0.0,1,51.8333,0,22,0,12,0,"Add workaround for keystonemiddleware/neutron memcached issue

There is an issue where keystonemiddleware connections to memcached from
neutron-server grow beyond configured values [1], eventually reaching
the maximum number of connections accepted by memcached servers. Other
services do not appear to be affected by this issue.

A workaround is to use the advanced memcached pool. Despite its
documentation claiming to only work with Python 2, it appears to work
fine on Python 3.

[1] https://bugs.launchpad.net/keystonemiddleware/+bug/1883659

Closes-Bug: #1892210
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron.conf.j2 (+3, -0)
releasenotes/notes/fix-neutron-memcached-connection-issue-84f5affa217b4612.yaml (+8, -0)
",-2.19394,-0.441716,0.491582,0.040154,-0.030597,-0.055189,-0.399486,0.234912,-0.01531,0.332808,0.13691,0.089904,-0.093667,-0.542921,0.096266
openstack/kolla-ansible,Iadf43383a7f2bf377d4666a55a38d92bd70711aa,1,1,0.6667,3.2581,0.08,2,8.11,601,0,Bug Fix,0,0,0,18,0.011968,1.0,0,0.6667,2,2,0,0.7174,0.795,1.5,31.72,15.85,1,0,0.0,1,23.1154,0,264,0,11,0,"Fix ownership and permissions of admin-openrc.sh

Previously the post-deploy.yml playbook was executed with become: true,
and the admin-openrc.sh file templated without an owner or mode
specified. This resulted in admin-openrc.sh being owned by root with 644
permissions.

This change creates the file without become: true, and explicitly sets
the owner to the user executing Ansible, and the mode to 600.

Co-Authored-By: Mark Goddard <mark@stackhpc.com>

Closes-Bug: #1891704

(cherry picked from commit 16f97867a3f7050ac42fbb921310ca884e974a11)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-admin-openrc-ownership-mode-310d89a6f50a9640.yaml (+19, -0)
ansible/post-deploy.yml (+4, -2)
",-2.094183,0.223332,0.534508,-0.798348,0.204484,0.172099,0.096539,0.066715,0.105782,-0.217332,0.485817,0.35244,-0.127184,0.38559,-0.281648
openstack/octavia,I9cbf9c4cdf8d8b8bf8d896b2d59d45d0ee1d4fc5,0,0,0,1.0986,0.5,1,8.0,85,0,Doc,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0.4941,0.0,3.0,40.09,13.2,0,0,0.0,0,28.3333,0,0,0,0,0,"Correct a typo in the document
[SEP]
FILES CHANGED:
api-ref/source/v2/general.inc (+1, -1)
",3.034974,1.761224,2.527774,0.906983,-0.005366,1.196228,1.784402,-0.810275,1.294498,-0.129509,0.500399,0.346351,-0.082334,0.706021,0.58298
openstack/octavia-lib,Ic51131defb8d687185a7887b7ca578c4f1babaad,0,0,0.4699,2.1972,0.375,1,12.0,193,0,Feature,0,0,0,83,0.003498,0.0,0,0.0,2,1,0,0.05,0.0,2.0,36.03,13.13,0,0,0.0,0,21.4444,0,0,0,0,0,"Add Proxy protocol version 2 support

This patch adds the required changes to support Proxy protocol
version 2.

Story: 2005611
Task: 30858
[SEP]
FILES CHANGED:
octavia_lib/common/constants.py (+5, -3)
",0.507764,-0.747789,-0.473048,-0.103251,-0.222934,0.923033,-1.230894,0.427835,0.386484,0.73663,-0.381125,0.55971,0.132464,0.679641,0.183373
openstack/oslo.messaging,I32a6c4ad0a456282ec02b5e4c8309489b3c17553,0,0,0.0,3.2958,0.2692,2,14.5,394,0,Feature,0,0,0,5,0.065789,0.5,0,0.0,2,2,0,0.3,0.9612,2.0,46.26,11.32,1,0,0.0,1,14.5926,0,0,0,0,0,"Run rabbitmq heartbeat in python thread by default

Removing the experimental nature of this feature and activating it by default.
Now to run heartbeat in a green thread users should set this option to False.

Also deprecating this option to prepare future removal and force to always run
heartbeat in a python thread whatever the context.
[SEP]
FILES CHANGED:
releasenotes/notes/run-heartbeat-in-pthread-by-default-28637b41ebf500dc.yaml (+10, -0)
oslo_messaging/_drivers/impl_rabbit.py (+9, -7)
",0.059041,-1.715906,0.158117,1.071819,-0.442293,0.333246,0.501553,-0.303356,-0.209157,0.233378,-0.050105,0.122951,-0.092575,-0.2049,-0.059607
openstack/kolla-ansible,Ia9445a651fd7a082835a858964bcb9e8e325338d,1,1,0,2.3026,0.1111,2,7.33,424,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7234,0.5033,3.0,10.96,17.48,1,0,0.0,1,42.4,0,6,0,6,0,"Disable arp_responder option for LinuxBridge agent

Enabling both l2_population and arp_responder for LinuxBridge can cause
problems in some configurations [0].  This commit removes the explicit
'true', reverting it to the default which is 'False'.

Closes-Bug: #1892776

[0] https://bugs.launchpad.net/neutron/+bug/1661717
[SEP]
FILES CHANGED:
releasenotes/notes/fix-linuxbridge-arp_responder-28068f7fe41e4e4d.yaml (+8, -0)
ansible/roles/neutron/templates/linuxbridge_agent.ini.j2 (+0, -1)
",-1.542938,-0.342693,-0.631962,-0.100684,-0.225503,0.044223,-0.557447,0.354459,0.136194,0.420848,0.197921,-0.476363,-0.082173,-0.234612,-0.018006
openstack/octavia,Ic112c5e71ee9b6433b307fdf27059f217ba4136e,0,0,0.4643,5.7746,0.2804,17,6.0,218,0,Feature,0,0,0,84,0.003539,0.6,0,0.2786,7,5,0,0.4912,3.2977,4.06,42.12,12.4,1,0,0.6355,1,0.677,0,0,0,0,0,"Add proxy v2 protocol support

This patch adds support for the proxy protocol v2 on pools.

Depends-On: https://review.opendev.org/747296
Story: 2005611
Task: 30858
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+1, -1)
octavia/api/v2/types/pool.py (+6, -3)
api-ref/source/v2/pool.inc (+2, -1)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/db/migration/alembic_migrations/versions/e6ee84f0abf3_add_proxy_v2_pool_protocol.py (+43, -0)
octavia/tests/functional/api/v2/test_l7policy.py (+44, -32)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+4, -2)
doc/source/user/feature-classification/feature-matrix-pool.ini (+8, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+15, -6)
octavia/tests/functional/api/v2/test_pool.py (+31, -1)
octavia/common/constants.py (+8, -4)
releasenotes/notes/Add-proxy-protocol-v2-90e4f5bf76138c69.yaml (+4, -0)
octavia/api/root_controller.py (+4, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+8, -8)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+8, -2)
octavia/tests/common/constants.py (+3, -1)
octavia/tests/functional/api/v2/test_listener.py (+40, -27)
",-0.364456,1.164906,-1.296999,-0.033695,-0.941063,0.783181,-0.823391,-0.043805,0.50998,-0.058022,-0.294622,0.203412,0.29321,0.108893,0.084842
openstack/octavia-dashboard,Id60c7a5edc5039c51399feda8643b714d58cf29a,0,0,0.4588,2.1972,0.25,3,7.0,250,0,Feature,0,0,0,85,0.003534,0.4,0,0.1835,7,3,0,0.1333,1.5,5.0,33.55,12.8,1,0,0.0,1,27.7778,0,0,0,0,0,"Add proxy protocol v2 support to dashboard

This patch adds support for proxy protocol v2 pools in the Octavia
dashboard.

Depends-On: https://review.opendev.org/747801

Story: 2005611
Task: 30858
[SEP]
FILES CHANGED:
releasenotes/notes/Add-ProxyV2-b5537c092737fe41.yaml (+4, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.help.html (+1, -1)
",-0.570466,0.503651,-1.129378,-0.154352,-0.826046,0.441446,-0.868812,0.299639,0.400747,-0.162422,-0.30304,0.264919,0.263617,0.171956,-0.02512
openstack/oslo.privsep,I422125b137a3beadb0a79f5944a19fce62f093d6,1,1,0.0,4.3567,0.0,3,20.67,533,0,Bug Fix,0,0,0,6,0.058824,0.0,0,0.0,2,2,0,0,1.4437,1.67,27.57,16.01,1,0,0.3896,1,6.8333,0,14,0,7,0,"Undo the eventlet monkey patch for the privileged daemon

Backport Notes:

- We want to avoid requirements bump on stable branch
  so we don't backport requirements and lower-constraints changes.
- Tests are skipped because SSL on Python2 with monkey patch
  work differently than with Python3 (tests are uncompatible).

Closes-Bug: #1887506
(cherry picked from commit 1dc378c76fe14c0a8ce149088f469c0eae981194)
(cherry picked from commit 6d41ef9f91b297091aa37721ba10456142fc5107)
[SEP]
FILES CHANGED:
oslo_privsep/daemon.py (+36, -0)
oslo_privsep/tests/test_daemon.py (+30, -0)
releasenotes/notes/un-monkey-patch-privileged-daemon-160e00296549df3d.yaml (+11, -0)
",-1.943908,-1.066906,0.042355,-1.567999,0.971595,-0.065657,0.466107,0.108591,0.039169,0.286725,0.136538,0.115696,0.385272,-0.128333,-0.059746
openstack/kayobe,I93f29ec4334829bfec107ba7aa6df05a47d2ab96,1,0,1.0,3.6376,0.4054,4,4.5,342,0,Feature,0,0,0,3,0.090909,1.0,0,1.0,4,3,0,0.9,1.4484,2.25,23.67,12.91,1,0,0.1622,1,9.0,0,0,0,0,0,"Move dnf.yml earlier in host configure workflow

Since kayobe is installing python3-pip in pip.yml - and dnf proxy is set
later, it fails on no-direct-internet systems.

Story: 2008067
Task: 40750
Depends-On: https://review.opendev.org/748587
Depends-On: https://review.opendev.org/750804
[SEP]
FILES CHANGED:
kayobe/tests/unit/cli/test_commands.py (+3, -3)
releasenotes/notes/bugfix-dnf-proxy-cd934867c3d64388.yaml (+5, -0)
kayobe/cli/commands.py (+12, -12)
ansible/dnf.yml (+2, -0)
",-1.320388,1.380069,-0.644319,0.109116,-0.579821,-0.165196,-0.013566,0.004427,-0.21289,-0.140932,0.251712,-0.230265,0.25025,0.324807,0.159567
openstack/octavia,I1e4e3c4f0e4142fa0d0d1ac895b10e2349d79c20,0,0,0.4375,3.912,0.3469,6,11.6,442,0,Bug Fix,0,0,0,16,0.010263,0.5,0,0.2188,7,3,0,0.4884,2.3368,4.17,33.15,13.61,1,0,0.6122,1,8.84,0,0,0,0,0,"Switch to live from noop drivers

The switch to live drivers ease greenfield deployments by not requiring
deployers to explicitly set live drivers. The switch also helps
deployers identify production-ready from experimental drivers.
Experimental features like volume and distributor remain defaulted to
their noop drivers.

This patch also fixes some tests that were not mocked properly.
[SEP]
FILES CHANGED:
octavia/common/config.py (+3, -3)
releasenotes/notes/switch-to-live-drivers-cbae7c60eafa0f3e.yaml (+6, -0)
octavia/tests/unit/controller/healthmanager/health_drivers/test_update_db.py (+3, -1)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_amphora_driver.py (+4, -2)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_amphora_driver.py (+12, -8)
etc/octavia.conf (+4, -3)
",-0.810194,-1.450235,-0.364563,1.185324,0.439306,-0.083535,0.122894,0.0637,-0.197154,0.164259,-0.251218,0.091254,0.434392,-0.482054,-0.008653
openstack/octavia,Iaac4449b5c6757feb61b983ab5a1a1d92ccd7f3d,1,0,0.0,1.0986,0.5,1,8.0,85,0,Doc,0,0,0,1,0.333333,0.0,1,0.0,3,1,0,0.4855,0.0,3.0,8.37,18.2,0,0,0.0,0,28.3333,0,0,0,0,0,"Correct a typo in the document
[SEP]
FILES CHANGED:
doc/source/admin/log-offloading.rst (+1, -1)
",3.034975,1.761224,2.527774,0.906983,-0.005366,1.196228,1.784402,-0.810275,1.294498,-0.129509,0.500399,0.346351,-0.082334,0.70602,0.58298
openstack/python-octaviaclient,Ib92c9896b6bd397c7fda2658a0e710f1014877fb,0,0,0.7917,3.5553,0.4118,6,5.0,221,0,Feature,0,0,0,24,0.010821,1.0,0,0.7917,5,2,0,0.0938,2.1309,3.17,19.87,16.0,0,0,0.4118,1,6.3143,0,0,0,0,0,"Add SCTP support

Listener, pool and health-monitor objects now support SCTP protocol.

Depends-On: https://review.opendev.org/#/c/738381/

Story: 2007884
Task: 40257
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/test_validations.py (+7, -7)
octaviaclient/osc/v2/health_monitor.py (+1, -1)
octaviaclient/osc/v2/validate.py (+6, -4)
octaviaclient/osc/v2/listener.py (+1, -1)
releasenotes/notes/add-support-for-sctp-protocol-f23b58db8522cc4b.yaml (+4, -0)
octaviaclient/osc/v2/pool.py (+1, -1)
",-0.392327,1.330907,-1.278775,-0.026101,-1.003666,0.376522,-0.924609,0.15175,0.374611,-0.410088,-0.478569,0.059549,0.252321,0.237033,-0.09874
openstack/octavia-dashboard,If84d6644b2c2f9c2ff0f77099f52ef48f20bcf71,0,0,0.76,3.6889,0.2821,7,5.75,231,0,Feature,0,0,0,25,0.011101,0.3333,0,0.2533,7,3,0,0.125,2.526,6.0,35.48,12.73,0,0,0.0,1,5.775,0,0,0,0,0,"Add support for SCTP

Add SCTP option in listener protocol and health-monitor type select
boxes.

Depends-On: https://review.opendev.org/#/c/738381/

Story: 2007884
Task: 40258
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.html (+2, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.controller.spec.js (+13, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+4, -4)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+3, -3)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.help.html (+1, -1)
releasenotes/notes/add-sctp-support-a1ea956b7630f47d.yaml (+4, -0)
",-0.237604,0.85333,-0.975432,-0.210325,-1.029721,0.14102,-0.872775,0.279393,0.505161,-0.343992,-0.552464,-0.056218,0.329862,0.315457,-0.043843
openstack/ironic,I11b92612d6686b7133ddef67068664c9b81df30e,1,0,0,6.0379,0.0694,6,16.27,1232,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,0,1.5239,3.67,39.55,13.88,1,0,0.5407,1,2.9403,0,0,0,0,0,"Fix idrac-wsman BIOS factory_reset result finding

This change fixes the idrac-wsman BIOS hardware interface
implementation's determination of the result of its factory_reset
cleaning/deploy step, and, on success, updating of the cached BIOS
settings to their defaults. It uses a deterministic means of identifying
when the reset has successfully completed and the default BIOS settings
are available to be read.

The time when the iDRAC last performed a system inventory is referred to
as Collect System Inventory on Restart (CSIOR). CSIOR updates the values
of BIOS settings that can be read from the iDRAC. The interface reads
the CSIOR and records it on the ironic bare metal node before requesting
the factory reset and rebooting the system to process the request.
Following the system reboot, the CSIOR is periodically read until its
value changes from its recorded value. If that occurs before the
configured amount of time has passed, the step succeeds and the cached
BIOS settings are updated. Otherwise, the step fails and the node is
placed in the failed state.

Story: 2008058
Task: 40739
Depends-On: https://review.opendev.org/c/openstack/python-dracclient/+/748571
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/drac/test_bios.py (+198, -6)
ironic/tests/unit/drivers/third_party_driver_mock_specs.py (+12, -1)
ironic/drivers/modules/drac/bios.py (+155, -21)
ironic/conf/drac.py (+7, -1)
ironic/tests/unit/drivers/third_party_driver_mocks.py (+9, -0)
releasenotes/notes/bug-2008058-fix-factory-reset-status.yaml-52a6119b46e33b37.yaml (+8, -0)
",-3.101159,-0.263727,3.200348,-0.269361,-0.38032,0.495041,-0.145283,0.178583,0.569369,-0.412441,-0.083519,0.85348,-0.351121,0.017997,-0.134131
openstack/octavia,Ie6ccc4bf0017587df8e8e29d8ee3bf5c19e6d615,1,0,0.7308,2.3979,0.1,3,11.5,576,0,Bug Fix,0,0,0,26,0.011349,0.0,0,0.0,6,3,0,0.4885,1.361,3.67,24.74,15.61,0,0,0.0,1,52.3636,0,0,0,0,0,"Fix nf_conntrack_buckets sysctl in Amphora

Setting nf_conntrack_buckets in the amphora namespace fails because this
sysctl can only be set in the initial namespace (cf kernel doc at
https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.txt)

This commit allows to set nf_conntrack_buckets in the initial namespace,
the value is then inherited by other namespaces.

Conntrack is not enabled in the main namespace, the new default value
doesn't affect this namespace behavior.

Story: 2008028
Task: 40682
[SEP]
FILES CHANGED:
releasenotes/notes/fix-nf_conntrack_buckets-sysctl-75ae6dbb9d052863.yaml (+5, -0)
elements/haproxy-octavia/post-install.d/20-haproxy-tune-kernel (+0, -1)
octavia/amphorae/backends/agent/api_server/templates/amphora-netns.systemd.j2 (+4, -0)
",-2.456815,0.721692,0.190347,0.538302,0.580666,0.064618,-0.416584,-0.329397,0.055391,-0.309417,0.295776,-0.15284,-0.086115,0.118177,-0.082837
openstack/oslo.messaging,I2ae53340783e4044dab58035bc0992dc08145b53,0,1,0.1429,4.5747,0.3229,3,10.93,1332,0,Bug Fix,0,0,0,7,0.039106,0.3333,0,0.0476,3,2,0,0.2727,0.7069,2.33,31.52,10.91,1,0,0.0729,1,13.732,0,30,0,105,0,"Cancel consumer if queue down

Previously, we have switched to use default exchanges
to avoid excessive amounts of exchange not found messages.
But it does not actually solve the problem because
reply_* queue is already gone and agent will not receive callbacks.

after some debugging, I found under some circumstances
seems rabbitmq consumer does not receive basic cancel
signal when queue is already gone. This might due to
rabbitmq try to restart consumer when queue is down
(for example when split brain). In such cases,
it might be better to fail early.

by reading the code, seems like x-cancel-on-ha-failover
is not dedicated to mirror queues only, https://github.com/rabbitmq/rabbitmq-server/blob/master/src/rabbit_channel.erl#L1894,
https://github.com/rabbitmq/rabbitmq-server/blob/master/src/rabbit_channel.erl#L1926.

By failing early, in my own test setup,
I could solve a certain case of exchange not found problem.

Related-bug: #1789177
Depends-On: https://review.opendev.org/#/c/749193/
(cherry picked from commit 196fa877a90d7eb0f82ec9e1c194eef3f98fc0b1)
(cherry picked from commit 0a432c7fb107d04f7a41199fe9a8c4fbd344d009)
(cherry picked from commit 5de11fa752ab8e37b95b1785f4c71210bf473f0c)
(cherry picked from commit 56bab1deab167e621d0a263f3fcf95b75c7d1bad)
[SEP]
FILES CHANGED:
oslo_messaging/tests/functional/test_rabbitmq.py (+7, -0)
releasenotes/notes/add-enable_cancel_on_failover-22ac472b93dd3a23.yaml (+6, -0)
oslo_messaging/_drivers/impl_rabbit.py (+52, -31)
",-3.614878,1.824562,3.012043,-1.934582,0.248228,0.815773,-0.349289,-1.054068,-0.57445,-0.089932,-0.862495,0.531138,0.028922,0.039927,0.167321
openstack/kolla-ansible,I96017c17e68ca7a00a2d5ac41f2f43ef87694514,1,0,0.875,2.4849,0.5455,3,14.0,355,0,Doc,0,0,0,8,0.05298,0.0,0,0.0,4,3,0,0.7292,1.3486,3.33,-0.75,21.79,1,0,0.0,1,29.5833,0,0,0,0,0,"Remove unused configuration for prometheus-openstack-exporter

The Prometheus OpenStack exporter was needlessly configured to use the
prometheus Docker volume and change permissions of /data, which does
not exist in the container image.

This must have been copy-pasted from existing Prometheus code.
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus-openstack-exporter.json.j2 (+0, -5)
releasenotes/notes/remove-prometheus-volume-from-openstack-exporter-f6bb5da3093abef8.yaml (+5, -0)
ansible/roles/prometheus/defaults/main.yml (+0, -1)
",0.815354,-0.641495,-0.4553,0.899559,-0.538835,-0.097484,0.772961,0.263805,0.045721,-0.421954,0.138333,0.279454,-0.04557,0.13652,-0.069256
openstack/kolla,Idf401536b482b4088f5fb66408917752fd71726c,1,0,1.0,0.6931,0.0,1,4.25,184,0,Bug Fix,0,0,0,4,0.057143,0.0,0,0.0,3,1,0,0.8636,0.0,3.0,38.3,8.76,1,0,0.0,0,92.0,0,0,0,0,0,"Fix bifrost network config

Set bifrost internal_ip variable to adapt to change [1].

[1]: https://review.opendev.org/#/c/748230/
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/build_arg.yml (+1, -0)
",-0.151633,1.66242,-0.970476,0.231515,-0.872035,0.24898,-0.299641,-0.06642,0.465626,0.039035,-0.382583,-0.208596,-0.48445,-0.204967,-0.522552
openstack/kolla,I71ba982339d5dd4306b2166d346e3e6b1f3af60e,0,1,1.0,1.0986,0.5,1,7.0,418,0,Bug Fix,0,0,0,5,0.070423,1.0,0,1.0,2,1,0,0.8696,0.0,2.0,14.99,16.68,1,0,0.0,0,139.3333,0,10,0,7,0,"Install newer virtualenv with relaxed importlib

After setuptools 50.x release - virtualenv dictated by Ussuri constraints
cause an error when using --system-site-packages, installing newer virtualenv
solves the issue.
Virtualenv 2.0.22 (and later) introduced a change to relax importlib.resources
requirements which seems to solve the issue.

Closes-Bug: #1893920
[SEP]
FILES CHANGED:
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",-0.438792,-1.484781,-0.038215,-0.122711,-0.263798,-0.416637,-0.345594,0.453194,-0.02114,0.296679,-0.224986,-0.059678,0.137364,0.040209,0.497694
openstack/kolla-ansible,Ib6a62d4428db9b95569314084090472870417f3d,1,1,0.8889,4.5109,0.0444,39,18.5,1027,0,Bug Fix,0,0,0,9,0.055556,1.0,0,0.8889,5,3,0,0.7347,5.2003,3.92,40.01,15.24,1,0,0.0,1,11.2857,0,16,0,12,0,"Reduce the use of SQLAlchemy connection pooling

When the internal VIP is moved in the event of a failure of the active
controller, OpenStack services can become unresponsive as they try to
talk with MariaDB using connections from the SQLAlchemy pool.

It has been argued that OpenStack doesn't really need to use connection
pooling with MariaDB [1]. This commit reduces the use of connection
pooling via two configuration options:

- max_pool_size is set to 1 to allow only a single connection in the
  pool (it is not possible to disable connection pooling entirely via
  oslo.db, and max_pool_size = 0 means unlimited pool size)
- lower connection_recycle_time from the default of one hour to 10
  seconds, which means the single connection in the pool will be
  recreated regularly

These settings have shown better reactivity of the system in the event
of a failover.

[1] http://lists.openstack.org/pipermail/openstack-dev/2015-April/061808.html

Closes-Bug: #1896635
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+2, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+2, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+2, -0)
ansible/roles/freezer/templates/freezer.conf.j2 (+2, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+2, -0)
ansible/roles/sahara/templates/sahara.conf.j2 (+2, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+2, -0)
ansible/roles/heat/templates/heat.conf.j2 (+2, -0)
ansible/roles/trove/templates/trove-taskmanager.conf.j2 (+2, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+2, -0)
ansible/roles/placement/templates/placement.conf.j2 (+2, -1)
ansible/roles/qinling/templates/qinling.conf.j2 (+2, -0)
ansible/roles/solum/templates/solum.conf.j2 (+2, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+2, -0)
ansible/roles/nova/templates/nova.conf.j2 (+4, -1)
ansible/roles/senlin/templates/senlin.conf.j2 (+2, -0)
ansible/roles/trove/templates/trove-conductor.conf.j2 (+2, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+2, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+2, -0)
ansible/roles/rally/templates/rally.conf.j2 (+2, -0)
ansible/roles/panko/templates/panko.conf.j2 (+2, -0)
ansible/roles/monasca/templates/monasca-api/api.conf.j2 (+2, -0)
ansible/roles/zun/templates/zun.conf.j2 (+2, -0)
ansible/roles/murano/templates/murano.conf.j2 (+2, -0)
ansible/roles/karbor/templates/karbor.conf.j2 (+2, -0)
ansible/roles/vitrage/templates/vitrage.conf.j2 (+2, -0)
releasenotes/notes/reduce-db-connection-pooling-b44da77eaa390f22.yaml (+6, -0)
ansible/roles/watcher/templates/watcher.conf.j2 (+2, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+2, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+2, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+2, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+2, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+4, -1)
ansible/roles/trove/templates/trove.conf.j2 (+2, -0)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+2, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+2, -0)
ansible/group_vars/all.yml (+2, -0)
ansible/roles/manila/templates/manila.conf.j2 (+2, -0)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+2, -1)
",-2.86199,0.23691,2.793117,-0.194682,-0.389381,0.12283,0.183814,0.116216,0.161278,0.037956,-0.008332,0.263251,-0.060735,-0.263564,0.01133
openstack/kolla-ansible,I09694b38420ea67896bb8cf4ffd7ce6f131af10e,1,1,0.8333,1.0986,0.5,1,12.5,518,0,Bug Fix,0,0,0,6,0.082192,0.5556,0,0.463,2,1,0,0.74,0.0,2.0,-19.04,17.8,1,0,0.0,0,172.6667,0,10,0,19,0,"Add default value for kolla_internal_address variable

The ""kolla_internal_address"" variable is not documented or defined
anywhere. When ""kolla_internal_vip_address"" is undefined, the error
message is about ""kolla_internal_address"", which will confuse operators.

This change adds a default value for ""kolla_internal_vip_address"" when
""kolla_internal_address"" is undefined.

Closes-Bug: #1864206
(cherry picked from commit b4603d927152f95848e56f6cf3ed4acd88baa377)
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",-2.620187,0.706957,-0.327327,-0.299421,1.186347,0.47113,-0.013994,-0.307492,0.628334,-0.196469,0.626566,-0.054477,-0.523589,-0.159413,0.084765
openstack/kolla-ansible,I2e56e3ff23036f6cd7109235cca70ca045a8015a,0,1,0.6842,1.0986,0.5,1,10.67,306,0,Bug Fix,0,1,0,19,0.012426,0.6,0,0.4105,2,1,0,0.7451,0.0,2.0,-10.2,15.52,1,0,0.0,0,102.0,0,6,0,8,0,"Revert the default for kolla_internal_vip_address

To detect our reliance on kolla_internal_vip_address early, let's
not switch the default.
We will simply undefine kolla_internal_vip_address in Wallaby to
keep current behaviour.

Related-Bug: #1894199
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",-1.092312,-0.105846,-1.137419,0.689926,0.547377,0.264279,-0.493361,-0.656892,-0.125766,-0.348527,0.588913,-0.280643,-0.418092,-0.401788,0.465211
openstack/octavia,Ibfb754d57c5c09c2358050160c6d98f09223f6db,0,0,0.4535,4.0073,0.1111,4,9.5,302,0,Feature,0,0,0,86,0.003574,0.25,0,0.1134,6,1,0,0.4914,1.6243,5.0,45.8,12.22,0,0,0.5926,0,5.4909,1,0,0,0,0,"Add amphora delete support to amphorav2 driver

This is the follow on patch to the amphora delete patch[1] that
updates the amphorav2 driver to also support the amphora delete
API.

Story: 2008014
Task: 40824

[1] https://review.opendev.org/718293
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+27, -0)
octavia/controller/worker/v2/controller_worker.py (+12, -6)
octavia/tests/unit/controller/queue/v2/test_endpoints.py (+5, -0)
octavia/controller/queue/v2/endpoints.py (+4, -0)
",-0.659148,0.180558,-0.660598,-0.00552,-0.53654,-0.159459,-0.260448,0.466362,0.00394,0.312038,-0.053521,0.09474,-0.026485,0.305247,-0.090243
openstack/octavia,I84025c5d1d3091c408416fb78b92ae0a7a89b74e,0,0,0.4483,1.6094,0.0,1,6.0,278,0,Feature,0,0,0,87,0.003607,0.0,0,0.0,3,1,0,0.4886,0.0,3.0,20.27,15.73,0,0,0.0,0,55.6,0,0,0,0,0,"Update protocol combination api-ref for PROXYV2

A previous patch[1] forgot to update the api-ref protocol combination
tables for the PROXYV2 pools.
This patch corrects that oversight.

[1] https://review.opendev.org/747801
[SEP]
FILES CHANGED:
api-ref/source/v2/general.inc (+4, -0)
",-0.068674,1.081437,-0.349127,0.693733,-0.47379,0.3859,0.089732,0.14588,0.270426,0.359238,-0.043913,-0.034002,0.052744,-0.107324,0.051269
openstack/octavia-lib,Id9281a4b8d319da5c0a049937c927ebf03439703,0,0,0.3,2.0794,0.0,2,14.0,336,0,Doc,0,0,0,10,0.238095,0.0,1,0.0,2,1,0,0.0476,0.5917,2.0,17.38,14.17,1,0,0.0,0,42.0,0,0,0,0,0,"Update master for stable/victoria

Add file to the reno documentation build to show release notes for
stable/victoria.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/victoria.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/victoria.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.059357,-1.627751,-0.208751,0.201988,0.209494,-0.410243,-0.589158,0.380944,0.0347,0.015067,-0.641515,-0.049327,-0.0688,0.558132,0.002698
openstack/octavia-lib,I6162fe3fcb5abd9a07f487e1a29455592ae679fe,0,0,0.2727,1.0986,0.5,1,6.33,330,0,CI,1,0,0,11,0.22449,0.0714,0,0.0195,1,1,0,0.0455,0.0,1.0,4.49,12.01,1,0,1.0,1,110.0,0,0,0,0,0,"Add Python3 wallaby unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for wallaby.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.953496,0.433803,-0.752743,0.727367,-0.910784,0.135195,-0.301858,0.174274,0.295315,0.497174,-0.403818,0.234317,-0.130292,-0.004431,-0.095868
openstack/octavia,I5a33b7db29bd818e2b3a94a632c5babde50c879b,0,0,0.4432,1.9459,0.0,1,7.75,229,0,Feature,0,0,0,88,0.003648,0.0,0,0.0,2,1,0,0.4859,0.0,2.0,40.68,13.42,0,0,0.0,1,32.7143,0,0,0,0,0,"Add a release note about HAProxy 2.0

This patch adds a release notes that recommend using HAProxy version
2.0 or newer for amphora that will be supporting HTTP/2 listeners.
[SEP]
FILES CHANGED:
releasenotes/notes/recommend-haproxy-2.x-for-http2-697416c486e36840.yaml (+6, -0)
",1.097445,-0.371453,0.013082,0.791493,-0.140201,0.536954,0.303275,0.539327,-0.019116,0.850989,-0.586456,0.328334,-0.269725,-0.144167,0.632636
openstack/oslo.config,I46c7903b159f99c68896a4c3c4d20daef848f9c2,1,1,1.0,2.3026,0.0,1,5.82,593,0,Bug Fix,0,0,0,3,0.003619,0.0,0,0.0,1,1,0,0,0.0,1.0,5.29,14.83,1,0,0.0,0,59.3,0,6,0,6,0,"sphinxext: Add 'merge_domaindata'

This is necessary to enable parallel builds. As noted in the Sphinx docs
[1], this method has the following function:

  Merge in data regarding docnames from a different domaindata inventory
  (coming from a subprocess in parallel builds).

Given how simple the datatypes we're storing are, this is pretty easy to
implement.

[1] https://www.sphinx-doc.org/en/master/extdev/domainapi.html#sphinx.domains.Domain.merge_domaindata

Closes-Bug: #1895162
[SEP]
FILES CHANGED:
oslo_config/sphinxext.py (+9, -0)
",-1.393629,0.369847,0.417843,0.033646,-0.645615,0.100229,0.024696,0.209355,0.123776,0.170121,0.033991,-0.335013,-0.316525,-0.064743,-0.282396
openstack/stevedore,Ic483ac68027505402ba32d7f612631e15a678d09,1,0,0,4.4886,0.0909,3,11.2,384,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0,1.2213,1.67,44.4,13.05,0,0,0.6364,1,4.3146,0,0,0,0,0,"Fix cache dir flooding when running from /tmp

Ansible invokes modules with executable placed under /tmp. This
causes stevedore caching to create bazillions of useless cache files.
When we can identify we run with executable under /tmp or if in the
target cache directory an empty file '.disable' is present - skip
writing cache.
[SEP]
FILES CHANGED:
stevedore/tests/test_cache.py (+56, -0)
releasenotes/notes/add-skip-caching-aa13be0299cc8b8c.yaml (+7, -0)
stevedore/_cache.py (+17, -8)
",0.284377,-1.506032,0.054729,0.315173,0.093245,-0.383824,0.567668,-0.344206,-0.350144,-0.29446,-0.159733,-0.317118,0.462607,0.121842,-0.067736
openstack/python-octaviaclient,Ib27906d5f81fc5114963c4035d173d4c35743096,0,0,0.25,2.0794,0.0,2,14.0,336,0,Doc,0,0,0,12,0.235294,0.0,1,0.0,2,1,0,0.0909,0.5917,2.0,25.44,13.22,1,0,0.0,0,42.0,0,0,0,0,0,"Update master for stable/victoria

Add file to the reno documentation build to show release notes for
stable/victoria.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/victoria.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/victoria.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.059357,-1.627751,-0.208751,0.201988,0.209494,-0.410243,-0.589158,0.380945,0.0347,0.015067,-0.641515,-0.049327,-0.0688,0.558131,0.002698
openstack/python-octaviaclient,I039d6e657a8dbeda5a9a762e177dd695f2728654,0,0,0.2308,1.0986,0.5,1,6.33,330,0,CI,1,0,0,13,0.224138,0.0667,0,0.0154,1,1,0,0.0882,0.0,1.0,2.26,12.01,1,0,1.0,1,110.0,0,0,0,0,0,"Add Python3 wallaby unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for wallaby.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.953496,0.433803,-0.752743,0.727367,-0.910784,0.135195,-0.301858,0.174274,0.295315,0.497175,-0.403819,0.234317,-0.130292,-0.004431,-0.095868
openstack/octavia,I806d220236ad741b638ad9315537334f2d923031,1,0,0.4382,5.1761,0.2273,7,23.67,455,0,Bug Fix,0,0,0,89,0.003689,0.5,0,0.2191,7,2,0,0.4831,2.5934,5.14,43.4,17.92,0,0,0.517,1,2.5706,0,0,0,0,0,"Fix amphora failover when VRRP port is missing

In an amphora failover situation, if the VRRP port of the other
amphora in an active/standby pair is missing from neutron, the amphora
failover may fail with a ""port not found"" error.
This patch corrects this issue by allowing the amphora failover in
progress to complete even if the other amphora is also in a failed
state.

Story: 2008127
Task: 40851
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+37, -2)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+21, -16)
releasenotes/notes/fix-amp-failover-missing-vrrp-port-9b5f13b9951b7edb.yaml (+5, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+7, -2)
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+22, -12)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+22, -4)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+22, -4)
",-0.658974,-0.905001,-0.062871,0.708631,0.070106,0.245598,0.513331,-0.279886,0.612392,-0.194368,0.716418,0.44749,0.19463,0.048272,0.315031
openstack/octavia,Ib2a80afb9223da2c0af6f6add250ffaaa20a316f,1,0,0.2353,2.5649,0.0,2,21.0,296,0,Feature,0,0,0,17,0.001514,0.5,0,0.1176,5,2,0,0.486,0.9799,3.5,36.46,17.92,1,0,0.0,1,22.7692,0,0,0,0,0,"Remove haproxy_check_script for UDP-only LBs

This file is created when no HAProxy listeners exist so VRRP will fail,
but needs to be removed when a UDP listener is added so that VRRP can
actually correctly start.

Story: 2008133
Task: 40859
[SEP]
FILES CHANGED:
releasenotes/notes/fix-udp-only-lbs-c4ca42106fc1e2bb.yaml (+5, -0)
octavia/amphorae/backends/agent/api_server/util.py (+7, -0)
",-0.123022,-1.643733,-0.457759,0.177179,-0.284001,0.287048,-0.781891,-0.276569,-0.055881,-0.00296,-0.025092,-0.259422,0.196938,0.060832,-0.165591
openstack/python-octaviaclient,I9b32be11ff6a66015f648ac151fb22cf3ebfd520,1,0,0,1.0986,1.0,1,5.25,213,0,Doc,0,0,0,0,0.0,0.2258,0,0.0,0,1,0,0.0857,0.0,0.0,-7.98,19.24,0,0,0.0,1,71.0,0,0,0,0,0,"Remove install unnecessary packages

The docs and releasenotes requirements migrated to doc/requirements.txt
we need not install things from requirements.txt.
[SEP]
FILES CHANGED:
tox.ini (+0, -2)
",1.460952,-0.567416,-0.255667,0.203539,0.226626,-0.372399,0.368608,-0.01649,-1.208625,-0.501478,-0.589337,-0.398867,-0.390552,0.677211,-0.341335
openstack/kolla,Id0e738044a1931f9d611a7281a48ea4a593f1cf1,1,1,0,3.4012,0.7586,7,19.5,341,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,3,1,0,0.8333,2.3716,2.29,9.17,17.03,0,0,0.0,0,11.3667,0,6,0,20,0,"Improve pip install process for offline deployment.

    * ""Use distribution-provided pip""
    * ""Use python's pip module invocation method""
    * ""Install pip earlier in order to avoid multiple installation""
    * ""Remove pip_version variable requirement and call""

Closes-bug: #1893204
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -4)
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+1, -1)
docker/openvswitch/openvswitch-netcontrold/Dockerfile.j2 (+1, -1)
docker/base/Dockerfile.j2 (+2, -0)
docker/macros.j2 (+2, -11)
docker/kolla-toolbox/Dockerfile.j2 (+0, -4)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+1, -1)
",-3.221442,1.613112,1.614187,-1.202418,-0.220695,0.114464,0.086463,0.220177,-0.186252,-0.361551,0.339457,0.242259,0.247901,0.246316,-0.052978
openstack/octavia,Id1eadc19dd283caeb9f6a31dc69e5bc734daf784,1,0,0.4444,1.0986,0.5,1,15.0,217,0,CI,1,0,0,90,0.003703,0.125,0,0.0556,1,1,0,0.4889,0.0,1.0,47.79,12.67,0,0,1.0,1,72.3333,0,0,0,0,0,"Switch grenade to run the octavia smoke tests

This patch updates the tempest plugin regex for the grenade job
to run the tests tagged with the ""smoke"" attribute.
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+1, -1)
",1.11167,-0.972582,-0.491613,0.587759,0.042112,0.033686,0.418297,0.049789,0.270351,-0.509823,0.263872,0.393944,-0.499907,0.338337,0.001803
openstack/octavia,Id8c44821455644576cf055cccaa38c9ab2f49ec6,1,0,0.4505,3.9703,0.0192,3,6.25,203,0,Feature,0,0,0,91,0.003744,0.25,0,0.1126,1,2,0,0.4917,1.5579,0.67,51.6,12.1,0,0,0.5769,1,3.8302,0,0,0,0,0,"Add a requirements.txt check job

This patch adds a new tox environment and gate job that checks
requirements.txt for missing or extra requirements.
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+16, -0)
tox.ini (+21, -1)
zuul.d/jobs.yaml (+14, -0)
",0.669347,-0.069402,-0.520067,1.219027,0.483098,0.412084,0.123279,-0.114554,0.228164,0.130371,-0.045354,-0.145732,-0.177044,0.665676,-0.120121
openstack/octavia,I91924486bab22601c15c538c8a5282ad8bc54700,0,0,0.4118,6.0568,0.1408,37,14.14,720,0,Feature,0,0,1,17,0.010572,0.5,0,0.2059,7,9,0,0.4945,4.3734,3.76,36.1,16.57,1,0,0.5634,1,1.6862,0,0,0,0,0,"Add ALPN support for TLS-enabled pools

ALPN is a TLS extension for application-layer protocol negotiation
within the TLS handshake [1].

This patch extends the Pool API to include a new 'alpn_protocols'
parameter. With this parameter, users can set an ALPN preference list
(descending order of preference) to be advertised by load balancer to
members.

This patch also adds HTTP/2 over TLS support to TLS-enabled pools to the
Amphora provider driver, although default the pool ALPN protocol list
configuration setting has HTTP/2 disabled similarly to the default
listener ALPN protocol list value added in Victoria release.

[1] https://tools.ietf.org/html/rfc7301
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+18, -2)
api-ref/source/v2/examples/pools-list-response.json (+2, -1)
octavia/api/v2/types/pool.py (+5, -0)
api-ref/source/v2/examples/pool-update-curl (+1, -1)
octavia/common/config.py (+5, -0)
octavia/tests/functional/api/test_root_controller.py (+2, -1)
octavia/tests/common/sample_data_models.py (+5, -1)
octavia/db/migration/alembic_migrations/versions/be9fdc039b51_add_pool_alpn_protocols_column.py (+35, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+24, -1)
etc/octavia.conf (+4, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+16, -7)
octavia/tests/unit/api/v2/types/test_pool.py (+12, -0)
doc/source/user/feature-classification/feature-matrix-pool.ini (+8, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+2, -0)
requirements.txt (+1, -1)
octavia/api/drivers/amphora_driver/v2/driver.py (+5, -3)
api-ref/source/v2/examples/pool-show-response.json (+2, -1)
api-ref/source/v2/examples/pool-create-curl (+1, -1)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+8, -2)
releasenotes/notes/add-pool-tls-alpn-support-68cb94b828c9ba37.yaml (+16, -0)
api-ref/source/v2/pool.inc (+6, -0)
octavia/db/models.py (+1, -0)
api-ref/source/v2/listener.inc (+6, -6)
lower-constraints.txt (+1, -1)
octavia/api/drivers/amphora_driver/v1/driver.py (+5, -3)
octavia/db/prepare.py (+3, -0)
api-ref/source/v2/examples/pool-update-request.json (+2, -1)
api-ref/source/v2/examples/pool-create-request.json (+2, -1)
octavia/tests/functional/db/test_repositories.py (+10, -5)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+25, -2)
octavia/common/data_models.py (+3, -1)
octavia/tests/functional/api/v2/test_pool.py (+70, -0)
api-ref/source/v2/examples/pool-update-response.json (+2, -1)
octavia/api/v2/controllers/pool.py (+6, -0)
octavia/api/root_controller.py (+5, -2)
api-ref/source/v2/examples/pool-create-response.json (+2, -1)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+45, -14)
",-1.607308,-0.353376,1.361441,0.764405,0.053194,-0.120714,0.07872,0.886752,0.777787,0.173205,-0.179072,0.234053,-0.23097,-0.333954,-0.304453
openstack/python-octaviaclient,I6afbbf40949b6ad5fbe5ffaff01034c1cf8b16c9,0,0,0.3889,4.0073,0.1296,6,8.0,280,0,Feature,0,0,0,18,0.00885,0.2,0,0.0778,5,2,0,0.1111,1.8752,3.5,57.01,10.2,1,0,0.3519,1,5.0909,0,0,0,0,0,"Add ALPN support for pools

Users can define a list of application layer protocols to be negotiated
over a secure connection with members. For example, users can limit to
HTTP/2 or to HTTP/2 and HTTP/1.1 but exclude HTTP/1.0.
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/constants.py (+1, -0)
octaviaclient/osc/v2/constants.py (+2, -1)
octaviaclient/osc/v2/utils.py (+1, -0)
octaviaclient/tests/unit/osc/v2/test_pool.py (+13, -5)
releasenotes/notes/add-pool-tls-alpn-support-59758ea78c78952e.yaml (+7, -0)
octaviaclient/osc/v2/pool.py (+23, -1)
",-0.067987,-1.157171,-0.070164,0.96447,0.181286,-0.183892,-0.345128,0.521103,0.260863,0.976294,-1.275526,0.103454,-0.14456,-0.010537,0.08378
openstack/octavia,If165e995a8b61d8a8ed6bc0c4dd036af0c55c6e0,1,0,0.3684,3.6889,0.3846,4,14.5,253,0,Bug Fix,0,0,0,19,0.0091,0.6667,0,0.2456,6,2,0,0.4918,1.8984,4.5,8.33,19.59,1,0,0.6154,1,6.325,0,0,0,0,0,"Fix AttributeError on TLS-enabled pool provisioning

This patch fixes an hidden AttributeError exception in the HAProxy
driver when adding TLS-enabled pools to listeners.

Task: 40895
Story: 2008150
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+7, -5)
releasenotes/notes/fix-tls-enabled-pool-provisioning-e3adb987244a025a.yaml (+4, -0)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+6, -5)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+7, -5)
",0.3923,-0.837281,-0.493577,0.174191,-0.202024,0.741658,-1.174057,0.054052,0.527348,0.300181,0.103938,0.013338,0.459844,-0.363285,-0.15085
openstack/oslo.reports,Ia71dc29dedb6786c4df4546bb4e7df6956966ec0,0,0,0,1.0986,0.5,1,4.45,586,0,Bug Fix,1,0,1,0,0.0,0.125,1,0.0,0,1,0,0,0.0,0.0,74.94,4.03,0,0,1.0,0,195.3333,0,0,0,0,0,"Fix hacking min version to 3.0.1

flake8 new release 3.8.0 added new checks and gate pep8
job start failing. hacking 3.0.1 fix the pinning of flake8 to
avoid bringing in a new version with new checks.

Though it is fixed in latest hacking but 2.0 and 3.0 has cap for
flake8 as <4.0.0 which mean flake8 new version 3.9.0 can also
break the pep8 job if new check are added.

To avoid similar gate break in future, we need to bump the hacking min
version.

- http://lists.openstack.org/pipermail/openstack-discuss/2020-May/014828.html
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",-1.423426,0.307352,1.07214,-0.232191,-0.330756,-0.212415,0.684991,0.21602,-0.271284,0.503796,-0.190403,0.171352,-0.310656,0.115905,0.462203
openstack/octavia,I6f2871e41512be67b941d4bd1967a1abeb0c72f6,0,0,0.4565,1.9459,0.0,1,14.0,295,0,Feature,0,0,0,92,0.003777,0.0,0,0.0,2,1,0,0.4946,0.0,2.0,43.57,16.08,0,0,0.0,1,42.1429,0,0,0,0,0,"Add a release note that focal amphora do not work

This patch adds a release note entry for Victoria highlighting that
Ubuntu 20.04 (focal) based amphora images do not bring up the lb-mgmt-net
network interface and are unusable as amphorae.
[SEP]
FILES CHANGED:
releasenotes/notes/no-focal-amphora-image-242852063f865c73.yaml (+6, -0)
",-0.089278,-1.251439,-0.631626,0.225712,0.188713,-0.511197,-0.067221,0.168582,-0.312238,0.066254,-0.35734,0.402859,0.359009,-0.097133,0.006939
openstack/kayobe,I3014983f481a5dca7c93e140b3e10caa5d537669,1,0,0.8571,3.3673,0.0,8,5.0,116,0,Feature,0,0,0,7,0.093333,0.6667,0,0.5714,6,5,0,0.9048,2.6361,3.75,7.18,14.0,1,0,0.0714,1,4.0,0,0,0,0,0,"Add missing barbican.conf support

Story: 2008170
Task: 40925
[SEP]
FILES CHANGED:
ansible/roles/kolla-openstack/tasks/config.yml (+1, -0)
releasenotes/notes/add-support-for-barbican-conf-c15f0ab4294281cf.yaml (+6, -0)
ansible/roles/kolla-openstack/templates/barbican.conf.j2 (+9, -0)
doc/source/configuration/reference/kolla-ansible.rst (+1, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/tests/test_default.py (+2, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/molecule.yml (+4, -0)
ansible/roles/kolla-openstack/defaults/main.yml (+3, -0)
ansible/kolla-openstack.yml (+2, -0)
",1.617941,-0.109801,-0.781254,-0.915361,-0.536655,0.536854,-0.814132,0.35412,0.159106,-0.078809,0.528643,0.284759,0.082969,0.986521,-0.382952
openstack/octavia,I88e64fd5e8a4c709f735be85b85139dbb52e4acd,1,0,0.4516,5.7557,0.0032,10,10.33,430,0,Bug Fix,0,0,0,93,0.003817,0.6,0,0.271,5,2,0,0.4919,3.0049,4.6,32.6,11.88,0,0,0.9556,1,1.3608,0,0,0,0,0,"Fixes API list handling of unscoped tokens

The API list methods were not handling unscoped tokens correctly.
If the API is using the admin_or_owner-policy.yaml policy override file,
and a user used an unscoped token, the API will list objects for all
projects. This patch corrects that issue.
If you are using the default policies, the API handles unscoped tokens
correctly.
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+52, -0)
octavia/tests/functional/api/v2/test_pool.py (+44, -0)
releasenotes/notes/get-all-unscoped-token-61da95856bc662e0.yaml (+10, -0)
octavia/tests/functional/api/v2/test_l7rule.py (+36, -0)
octavia/tests/functional/api/v2/test_member.py (+39, -0)
octavia/tests/functional/api/v2/test_flavors.py (+1, -1)
octavia/tests/functional/api/v2/test_l7policy.py (+52, -0)
octavia/tests/functional/api/v2/test_load_balancer.py (+35, -0)
octavia/tests/functional/api/v2/test_listener.py (+41, -0)
octavia/api/v2/controllers/base.py (+4, -0)
",-0.824167,-1.337635,-0.101728,1.142739,0.033243,-0.03434,-0.133785,-0.120695,0.228227,0.139189,0.008053,0.070158,0.134123,0.101354,-0.155828
openstack/octavia,I30997ae6cc6b8ec724f0e9dcfdfe49356b320ff4,0,0,0.7407,7.4922,0.2231,45,9.33,252,0,Feature,0,0,0,27,0.011734,1.0,0,0.7407,7,8,0,0.4946,4.0837,4.84,22.12,15.16,0,0,0.5499,1,0.1405,0,0,0,0,0,"Add SCTP support in Amphora

Add SCTP support in the Amphora (with keepalived).
Add amphora-health-checker script for customized SCTP health checks
(INIT/INIT-ACK/ABORT).

Story: 2007884
Task: 40932
[SEP]
FILES CHANGED:
octavia/common/config.py (+5, -1)
octavia/amphorae/backends/health_daemon/health_daemon.py (+10, -9)
octavia/amphorae/backends/agent/api_server/server.py (+24, -19)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+18, -14)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+14, -13)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+25, -25)
etc/octavia.conf (+1, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+93, -13)
doc/source/user/feature-classification/feature-matrix-pool.ini (+1, -1)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+2, -2)
octavia/amphorae/backends/agent/api_server/amphora_info.py (+20, -19)
octavia/common/constants.py (+6, -0)
octavia/api/drivers/amphora_driver/v2/driver.py (+5, -4)
octavia/common/jinja/lvs/jinja_cfg.py (+14, -9)
octavia/tests/unit/amphorae/backends/agent/api_server/test_keepalivedlvs.py (+5, -4)
octavia/amphorae/backends/agent/api_server/templates/plug_port_ethX.conf.j2 (+2, -2)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+6, -6)
doc/source/user/feature-classification/feature-matrix-healthmonitor.ini (+1, -1)
octavia/amphorae/backends/agent/api_server/lvs_listener_base.py (+90, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+3, -1)
octavia/tests/functional/amphorae/backend/agent/api_server/test_keepalivedlvs.py (+27, -25)
octavia/amphorae/backends/agent/api_server/util.py (+11, -11)
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+21, -20)
octavia/cmd/health_checker.py (+268, -0)
elements/amphora-agent/static/usr/local/bin/lvs-masquerade.sh (+12, -0)
octavia/amphorae/backends/agent/api_server/templates/plug_vip_ethX.conf.j2 (+2, -2)
octavia/api/drivers/amphora_driver/v1/driver.py (+5, -4)
octavia/tests/unit/cmd/test_health_checker.py (+152, -0)
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+45, -0)
octavia/amphorae/backends/agent/api_server/templates/rh_plug_port_eth_ifup_local.conf.j2 (+2, -2)
octavia/amphorae/backends/agent/api_server/udp_listener_base.py (+0, -103)
octavia/common/jinja/lvs/templates/keepalivedlvs.cfg.j2 (+2, -1)
octavia/common/jinja/lvs/templates/macros.j2 (+15, -6)
octavia/tests/unit/amphorae/backends/agent/api_server/test_plug.py (+6, -6)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+2, -2)
releasenotes/notes/add-sctp-support-in-amphora-driver-d6e60731029badf5.yaml (+7, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+6, -6)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+16, -16)
doc/source/user/feature-classification/feature-matrix-listener.ini (+1, -1)
octavia/amphorae/backends/agent/api_server/templates/rh_plug_port_eth_ifdown_local.conf.j2 (+2, -2)
setup.cfg (+1, -0)
octavia/tests/unit/common/jinja/lvs/test_jinja_cfg.py (+414, -21)
elements/amphora-agent/install.d/amphora-agent-source-install/75-amphora-agent-install (+3, -0)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+26, -26)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+2, -2)
",-0.137585,-0.531995,-0.922042,0.055879,0.159803,0.014009,-0.925248,0.460865,-0.212727,-0.367787,-0.028514,0.17124,0.488539,0.337874,-0.205636
openstack/magnum,Ia6a848eae11bc38ff71ef4575247010a8ffaa47b,1,0,1.0,1.6094,0.5,2,13.67,323,0,Bug Fix,0,0,0,1,0.090909,0.0,0,0.0,6,1,0,0,1.0,5.5,27.89,19.13,1,1,0.0,0,64.6,0,0,0,0,0,"[fix] Detect virtio-scsi volumes correctly

When the Cinder volume is presented as a virtio-scsi volume, the
device_name detection fails. This change allows the device name to be
retrieved correctly for both virtio-pci and virtio-scsi cases.

Story: 2008618
Task: 41808
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/fragments/configure-docker-storage.sh (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/configure-etcd.sh (+1, -1)
",-1.727233,-0.379382,-0.890663,-0.651122,0.782438,-0.266087,0.672599,0.153264,0.125937,0.166292,0.531476,0.048616,0.363368,-0.023197,-0.332886
openstack/octavia,Ie2c748ff69c8fd736e9c67d686068a33d803222e,1,0,0.5,3.1355,0.1364,2,10.67,295,0,Feature,0,0,0,2,0.060606,0.3529,0,0.1765,4,1,0,0.492,0.994,3.0,5.66,21.77,1,0,0.5455,0,12.8261,0,0,0,0,0,"Ignore DELETED amphorae when performing certificate rotation

Deleted amphorae should not be included when housekeeping service is
performing certificate rotation. Otherwise, deleted amphorae will
become ERROR.

Story: #2007635
Task: #39681
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+12, -0)
octavia/db/repositories.py (+7, -3)
",-1.666725,-0.506626,-1.33433,-0.700602,1.013467,0.400862,0.19142,-0.215516,0.285482,0.107262,0.354799,-0.142559,0.604782,0.06389,-0.139848
openstack/octavia,Ie2c748ff69c8fd736e9c67d686068a33d803222e,1,0,0.6667,3.1355,0.1364,2,12.33,364,0,Feature,0,0,0,3,0.054545,0.3889,0,0.2593,4,1,0,0.4947,0.994,3.0,2.25,21.15,1,0,0.5455,0,15.8261,0,0,0,0,0,"Ignore DELETED amphorae when performing certificate rotation

Deleted amphorae should not be included when housekeeping service is
performing certificate rotation. Otherwise, deleted amphorae will
become ERROR.

Story: #2007635
Task: #39681

(cherry picked from commit f3eff29ce17e5d27867b6e6f4049ae6d51d2751c)
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+12, -0)
octavia/db/repositories.py (+7, -3)
",-1.666725,-0.506626,-1.33433,-0.700602,1.013467,0.400862,0.19142,-0.215516,0.285482,0.107262,0.354799,-0.142559,0.604782,0.06389,-0.139848
openstack/octavia,Ie2c748ff69c8fd736e9c67d686068a33d803222e,1,0,0.75,3.1355,0.1364,2,12.33,364,0,Feature,0,0,0,4,0.051948,0.4211,0,0.3158,4,1,0,0.4974,0.994,3.0,2.25,21.15,1,0,0.5455,0,15.8261,0,0,0,0,0,"Ignore DELETED amphorae when performing certificate rotation

Deleted amphorae should not be included when housekeeping service is
performing certificate rotation. Otherwise, deleted amphorae will
become ERROR.

Story: #2007635
Task: #39681

(cherry picked from commit f3eff29ce17e5d27867b6e6f4049ae6d51d2751c)
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+12, -0)
octavia/db/repositories.py (+7, -3)
",-1.666725,-0.506626,-1.33433,-0.700602,1.013467,0.400862,0.19142,-0.215516,0.285482,0.107262,0.354799,-0.142559,0.604782,0.06389,-0.139848
openstack/octavia,Id535d2d5ea6c23c9646c568a17d7695f82c0c1a9,1,0,0.4,1.0986,0.0,1,4.78,468,0,Feature,0,0,0,20,0.009403,0.4615,0,0.1846,1,1,0,0.5,0.0,1.0,-6.56,16.79,0,0,0.0,0,156.0,0,0,0,0,0,"Ensure install of diskimage-create.sh requirements

Change I612ea1c583090897bd44453b867d75929a01b7fc [1] removed
diskimage-builder from the root requirements.txt file. Devstack
deployments not setting LIBS_FROM_GIT+=diskimage-builder will not
install diskimage-builder. This means our diskimage-create.sh tool will
fail to build amphora images and abort the deployment.

[1] https://review.opendev.org/#/c/741960/
[SEP]
FILES CHANGED:
devstack/plugin.sh (+2, -0)
",-1.318864,0.75151,-0.500899,-0.310425,0.31715,-0.157436,0.572385,0.174858,0.177532,-0.231335,0.323813,-0.027617,-0.122014,0.28784,-0.408019
openstack/octavia,Ie2c748ff69c8fd736e9c67d686068a33d803222e,1,0,0.4286,3.1355,0.1364,2,12.33,364,0,Feature,0,0,0,21,0.009864,0.45,0,0.1929,4,1,0,0.5026,0.994,3.0,2.25,21.15,1,0,0.5455,0,15.8261,0,0,0,0,0,"Ignore DELETED amphorae when performing certificate rotation

Deleted amphorae should not be included when housekeeping service is
performing certificate rotation. Otherwise, deleted amphorae will
become ERROR.

Story: #2007635
Task: #39681

(cherry picked from commit f3eff29ce17e5d27867b6e6f4049ae6d51d2751c)
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+12, -0)
octavia/db/repositories.py (+7, -3)
",-1.666725,-0.506626,-1.33433,-0.700602,1.013467,0.400862,0.19142,-0.215516,0.285482,0.107262,0.354799,-0.142559,0.604782,0.06389,-0.139848
openstack/kolla-ansible,Ifff77af3d25d9dc659fff34f2ae3c6f2670df0f4,1,1,0.875,2.3979,0.2,2,7.0,278,0,Bug Fix,0,0,0,8,0.07767,0.0,0,0.0,4,2,0,0.7308,0.971,3.0,0.32,15.66,1,0,0.0,1,25.2727,0,32,0,36,0,"Fix keystone-startup.sh

keystone-startup.sh is using fernet_token_expiry instead of
fernet_key_rotation_interval - which effects in restart loop of keystone
containers - when restarted after 2-3 days.

Closes-Bug: #1895723
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1895723-910de90908de260a.yaml (+6, -0)
ansible/roles/keystone/templates/keystone-startup.sh.j2 (+2, -2)
",0.055698,-0.131321,-0.705578,0.089274,0.341947,-0.424863,-0.304066,0.051661,0.186206,-0.471124,0.083172,-0.602492,-0.403998,0.330936,0.442437
openstack/octavia,I55420694117bcefae53e7d5f724b72a1b77938d1,0,0,0.2143,1.0986,0.5,1,6.33,330,0,CI,1,0,0,14,0.233333,0.1176,0,0.0252,1,1,0,0.5052,0.0,1.0,8.94,12.01,1,0,1.0,1,110.0,0,0,0,0,0,"Add Python3 wallaby unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for wallaby.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.953496,0.433803,-0.752743,0.727367,-0.910784,0.135195,-0.301858,0.174274,0.295315,0.497174,-0.403818,0.234317,-0.130292,-0.004431,-0.095868
openstack/octavia-dashboard,Ibd3d097c2d6ccd80a669be89a5b0bce988ffe9cc,0,0,0.2,2.0794,0.0,2,14.0,336,0,Doc,0,0,0,15,0.241935,0.0,1,0.0,2,1,0,0.1176,0.5917,2.0,15.37,14.17,1,0,0.0,0,42.0,0,0,0,0,0,"Update master for stable/victoria

Add file to the reno documentation build to show release notes for
stable/victoria.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/victoria.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/victoria.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.059357,-1.627751,-0.208751,0.201988,0.209494,-0.410243,-0.589158,0.380945,0.0347,0.015067,-0.641515,-0.049327,-0.0688,0.558131,0.002698
openstack/octavia-dashboard,Id16e7f3289369dcd880120cd41e547d291302b09,0,0,0.1875,1.0986,0.5,1,6.33,330,0,CI,1,0,0,16,0.231884,0.1111,0,0.0208,1,1,0,0.1111,0.0,1.0,13.4,12.01,1,0,1.0,1,110.0,0,0,0,0,0,"Add Python3 wallaby unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for wallaby.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.953496,0.433803,-0.752743,0.727367,-0.910784,0.135195,-0.301858,0.174274,0.295315,0.497175,-0.403819,0.234317,-0.130292,-0.004431,-0.095868
openstack/oslo.concurrency,I0a2c1e0d8a8cad99d68100d25e88e0d3a2eb8f5c,0,1,0,2.0794,0.0,1,10.67,320,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.0,0.0,1.0,-23.42,20.52,1,0,0.0,0,40.0,0,14,0,152,0,"Monkey patch original current_thread _active in processutils

Monkey patch the original current_thread to use the up-to-date _active
global variable. This solution is based on that documented at:
https://github.com/eventlet/eventlet/issues/592

Related-Bug: #1863021
[SEP]
FILES CHANGED:
oslo_concurrency/processutils.py (+7, -0)
",-1.441562,0.447729,-0.966761,-0.729638,0.261333,-0.011906,0.538773,-0.206067,0.196212,0.282697,0.166832,-0.40657,0.362192,0.188417,0.260741
openstack/octavia-dashboard,I5af4b0735bafca3e541558974140502454ce39db,0,0,0,3.6636,0.1053,9,11.0,111,0,CI,0,0,0,0,0.0,0.2857,0,0.0,7,4,0,0.1053,2.8873,5.67,-4.29,22.58,1,0,0.0,1,2.8462,0,0,0,0,0,"Add textarea field for allowed_cidrs in the listener api
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/listeners/details/drawer.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.html (+11, -0)
octavia_dashboard/api/rest/lbaasv2.py (+2, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/listeners/listeners.module.js (+4, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.help.html (+7, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/listeners/details/detail.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+3, -1)
releasenotes/notes/add-allowed-cidrs-ad205b1524da3d2c.yaml (+4, -0)
",2.336788,-0.180161,0.835935,0.276403,1.027316,-0.525184,0.586505,0.505603,0.899035,-0.252931,-0.52672,-0.308281,-0.624651,-0.30115,-0.323182
openstack/octavia,I0e7119d5a379f8662c4913d7232ef28535a29b32,1,0,0.7143,2.3026,0.0,2,17.2,607,0,Bug Fix,0,0,0,28,0.006839,0.5,0,0.3571,2,2,0,0.5026,0.9183,2.0,48.7,12.46,0,0,0.0,1,60.7,0,0,0,0,0,"Fix python2 AttributeError with strptime

Fix a potential python2 error when calling strptime, the first call to
strptime is not thread safe and might trigger an exception.
A workaround was added by calling strptime before creating a thread but
the caller is itself within a thread, so it may fail.

The workaround is now to explicitly import _strptime as described in the
upstream python issue https://bugs.python.org/issue7980

Note: This commit only applies to branches that support python2 (initial
commit in stable/train)

Story 2008211
Task 40997
[SEP]
FILES CHANGED:
releasenotes/notes/fix-python2-attributeerror-strptime-89a7350c55ac8818.yaml (+6, -0)
octavia/common/base_taskflow.py (+3, -0)
",-1.267817,-1.29972,0.583802,-0.158646,-0.528964,0.257241,0.011573,-0.330264,0.107112,0.462403,0.414972,-0.221496,-0.12187,0.033569,0.247529
openstack/octavia,I78d0aff8a187ad1dfeac463d1f0a7dea7caf76bf,0,0,1.0,1.6094,0.0,1,21.5,354,0,Bug Fix,0,0,0,1,0.090909,0.4,0,0.4,1,1,0,0.5052,0.0,1.0,17.78,17.9,1,0,0.0,0,70.8,0,0,0,0,0,"Fix setting OCTAVIA_PROTOCOL when tls-proxy is enabled

The fix in [0] was incomplete, the global SERVICE_PROTOCOL variable isn't
actually set to ""https"" when needed, we need to check whether the tls-proxy
service is enabled like all other services do.

[0] I0154b83cb64952844a28895721694d3e2ff82be2
[SEP]
FILES CHANGED:
devstack/settings (+4, -0)
",-0.994457,-0.463753,-0.491307,-0.245848,0.602381,-0.072884,0.595876,-0.099947,0.155757,0.514837,0.364215,-0.520917,0.158408,0.047076,0.046759
openstack/kolla-ansible,I8ac30dea6c8402d97189c6b05032c608936b0ff2,0,0,0.7857,5.2417,0.0372,10,9.75,369,0,CI,0,0,0,14,0.012951,1.0,0,0.7857,4,2,0,0.7358,2.3293,3.8,-13.48,17.23,1,0,0.0,0,1.9524,0,0,0,0,0,"octavia: support tenant management network

- bind health manager port to ovs
- create a octavia-interface.service (used for creating health manager
  interface after reboot)
- used for ci, test or poc

Implements: blueprint implement-automatic-deploy-of-octavia

Co-Authored-By: wu.chunyang <wuchunyang@yovole.com>
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+10, -5)
ansible/roles/destroy/tasks/cleanup_host.yml (+23, -0)
ansible/roles/octavia/tasks/config-host.yml (+6, -0)
ansible/roles/octavia/tasks/deploy.yml (+2, -0)
ansible/roles/octavia/tasks/precheck.yml (+11, -0)
ansible/roles/octavia/tasks/prepare.yml (+2, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
ansible/group_vars/all.yml (+14, -1)
ansible/roles/octavia/tasks/hm-interface.yml (+98, -0)
ansible/roles/octavia/templates/octavia-interface.service.j2 (+14, -0)
",-1.117759,-0.188569,-0.56218,-0.029355,-0.214405,-0.964805,-0.246557,0.459462,-0.172525,-0.445319,0.19346,0.255408,0.526595,0.737207,-0.297718
openstack/octavia-dashboard,I8f90ba4f1a21e407a4a19da29d88be0fe6f7f2b1,0,0,0,7.3311,0.9921,12,3.75,216,0,Doc,0,0,0,0,0.0,0.0,0,0.0,5,1,0,0.1,2.727,4.5,-101.53,22.83,1,0,0.0,0,0.1415,0,0,0,0,0,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html
[SEP]
FILES CHANGED:
octavia_dashboard/locale/ja/LC_MESSAGES/djangojs.po (+2, -9)
releasenotes/source/locale/id/LC_MESSAGES/releasenotes.po (+0, -318)
releasenotes/source/locale/zh_TW/LC_MESSAGES/releasenotes.po (+0, -197)
octavia_dashboard/locale/en_GB/LC_MESSAGES/djangojs.po (+1, -8)
octavia_dashboard/locale/zh_CN/LC_MESSAGES/djangojs.po (+2, -7)
releasenotes/source/locale/ko_KR/LC_MESSAGES/releasenotes.po (+0, -307)
releasenotes/source/locale/en_GB/LC_MESSAGES/releasenotes.po (+0, -344)
releasenotes/source/locale/de/LC_MESSAGES/releasenotes.po (+0, -105)
octavia_dashboard/locale/de/LC_MESSAGES/djangojs.po (+4, -5)
releasenotes/source/locale/zh_CN/LC_MESSAGES/releasenotes.po (+0, -197)
octavia_dashboard/locale/id/LC_MESSAGES/djangojs.po (+2, -9)
octavia_dashboard/locale/ko_KR/LC_MESSAGES/djangojs.po (+1, -8)
",-0.801902,3.149072,-1.483006,1.013018,-0.707281,0.457268,-0.409607,-0.452539,-0.017266,-0.120098,-1.100088,0.33791,-0.026385,0.030705,-0.277609
openstack/oslo.versionedobjects,Idf36897d690a20d23123950618643d0b9e085f6c,0,0,0,2.7726,0.3333,4,8.16,1067,1,Bug Fix,0,0,1,0,0.0,0.08,0,0.0,2,3,0,1.0,1.7968,0.75,49.55,10.75,1,0,0.0,1,66.6875,0,0,0,0,0,"Replace md5 with oslo version

md5 is not an approved algorithm in FIPS mode, and trying to
instantiate a hashlib.md5() will fail when the system is running in
FIPS mode.

md5 is allowed when in a non-security context.  There is a plan to
add a keyword parameter (usedforsecurity) to hashlib.md5() to annotate
whether or not the instance is being used in a security context.

In the case where it is not, the instantiation of md5 will be allowed.
See https://bugs.python.org/issue9216 for more details.

Some downstream python versions already support this parameter.  To
support these versions, a new encapsulation of md5() has been added to
oslo_utils.  See https://review.opendev.org/#/c/750031/

This patch is to replace the instances of hashlib.md5() with this new
encapsulation, adding an annotation indicating whether the usage is
a security context or not.

In this case, md5 is computed as one of the object hashes for the
purposes of object versioning.

Depends-On: https://review.opendev.org/#/c/760160
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
oslo_versionedobjects/fixture.py (+4, -3)
lower-constraints.txt (+1, -1)
releasenotes/notes/update_md5_for_fips-e5a8f8f438ac81fb.yaml (+4, -0)
",-2.91704,0.465575,3.135946,-0.482283,-0.583391,0.447771,-0.274059,-0.336889,0.194256,-0.04583,-0.425291,0.334869,-0.305073,-0.305906,0.127745
openstack/tooz,Idbef0f0896753765372c8dfac8ab15e6be49922f,0,0,0.0,3.7842,0.2558,5,8.05,1085,1,Bug Fix,0,0,1,1,0.0625,0.0769,0,0.0,2,2,0,0.0,1.9386,1.4,41.63,11.59,1,0,0.3256,0,24.6591,0,0,0,0,0,"Replace md5 with oslo version

md5 is not an approved algorithm in FIPS mode, and trying to
instantiate a hashlib.md5() will fail when the system is running in
FIPS mode.

md5 is allowed when in a non-security context.  There is a plan to
add a keyword parameter (usedforsecurity) to hashlib.md5() to annotate
whether or not the instance is being used in a security context.

In the case where it is not, the instantiation of md5 will be allowed.
See https://bugs.python.org/issue9216 for more details.

Some downstream python versions already support this parameter.  To
support these versions, a new encapsulation of md5() has been added to
oslo_utils.  See https://review.opendev.org/#/c/750031/

This patch is to replace the instances of hashlib.md5() with this new
encapsulation, adding an annotation indicating whether the usage is
a security context or not.

Reviewers need to pay particular attention as to whether the keyword
parameter (usedforsecurity) is set correctly.

Depends-On: https://review.opendev.org/#/c/760160
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
tooz/drivers/ipc.py (+3, -2)
tooz/hashring.py (+15, -3)
tooz/drivers/pgsql.py (+2, -2)
tooz/tests/test_hashring.py (+11, -3)
",-2.943908,0.551402,3.11446,-0.457542,-0.619233,0.45614,-0.206807,-0.407375,0.182141,-0.03124,-0.340264,0.27719,-0.269026,-0.337638,0.086162
openstack/kayobe,I80f9d95f02e11fda5916f9a9dd257b688a9db7e2,1,0,0.9,3.3322,0.0,4,15.0,566,0,Doc,0,0,0,10,0.039683,1.0,0,0.9,4,4,0,0.9091,1.6158,2.75,30.31,15.6,1,0,0.0,1,20.2143,0,0,0,0,0,"Configure bifrost to use firewalld trusted zone

Without this setting, bifrost creates a bifrost firewalld zone only
allowing network traffic for Ironic services and assigns the
provisioning network interface to it, potentially causing loss of
connectivity.

Using the public zone is suggested as a workaround [1] but is not
sufficient: it allows SSH traffic, but blocks other services deployed on
the seed, such as Docker registry traffic.

[1] https://review.opendev.org/#/c/754406/

Story: 2008153
Task: 40899
[SEP]
FILES CHANGED:
releasenotes/notes/bifrost-firewalld-zone-09a29651a058531a.yaml (+16, -0)
etc/kayobe/bifrost.yml (+4, -0)
ansible/roles/kolla-bifrost/templates/bifrost.yml.j2 (+3, -0)
ansible/group_vars/all/bifrost (+4, -0)
",-1.08178,-1.000281,0.460952,0.257547,-0.396771,-0.166189,0.194582,0.463464,0.23117,0.075593,0.122558,0.081406,0.018634,-0.280008,-0.273561
openstack/octavia,Ia46a05ab9fdc97ed9be699e5b2ae90daca3ab9a2,1,0,0.4574,2.6391,0.0769,3,23.5,332,0,Bug Fix,0,0,0,94,0.003809,0.6667,0,0.305,7,2,0,0.5026,1.5486,4.67,24.58,20.46,0,0,0.3846,1,23.7143,0,0,0,0,0,"Fix load balancers with failed amphora failover

There was a bug in the load balancer failover code for the amphora
v1 driver where if there were multiple failed amphora, with session
persistence, could cause a load balancer failover to not complete.

Story: 2008099
Task: 40802
[SEP]
FILES CHANGED:
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+3, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+4, -1)
releasenotes/notes/fix-dual-error-amp-failover-69e323892bad8254.yaml (+5, -0)
",-0.01138,-1.114876,-0.662556,0.542093,0.260391,0.193568,0.319766,-0.062184,0.301358,-0.180085,0.171333,0.317863,0.246239,-0.28963,0.308756
openstack/oslo.concurrency,I0a2c1e0d8a8cad99d68100d25e88e0d3a2eb8f5c,1,1,0,2.0794,0.0,1,12.33,389,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.0,0.0,1.0,-20.61,20.07,1,0,0.0,0,48.625,0,14,0,152,0,"Monkey patch original current_thread _active in processutils

Monkey patch the original current_thread to use the up-to-date _active
global variable. This solution is based on that documented at:
https://github.com/eventlet/eventlet/issues/592

Related-Bug: #1863021
(cherry picked from commit 6533958f5fcec8b1577f56834ea2dc75a4f211e3)
[SEP]
FILES CHANGED:
oslo_concurrency/processutils.py (+7, -0)
",-1.441562,0.447729,-0.966761,-0.729638,0.261333,-0.011906,0.538773,-0.206067,0.196212,0.282697,0.166832,-0.40657,0.362192,0.188417,0.260741
openstack/python-octaviaclient,Ib690ad83bb35a70f8a435a61b61aeef817130aa5,0,0,0.4632,1.9459,0.1667,2,7.0,87,0,Feature,0,0,0,95,0.003848,0.0,0,0.0,3,2,0,0.1081,0.9183,2.5,-29.9,19.94,0,0,0.0,1,12.4286,0,0,0,0,0,"Add support for PROXYV2 protocol
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/pool.py (+1, -1)
releasenotes/notes/Add-proxyv2-7a540796c60241c3.yaml (+4, -0)
",1.866622,1.082928,1.312693,0.71771,0.626364,0.809598,-0.232054,1.378425,0.509405,0.841183,-0.331262,0.00613,-0.006906,-0.218933,0.412026
openstack/octavia,Ia6649ba95bdaa5d4c48f766bc8c1a87bab4f07b3,1,0,0.0,0.6931,1.0,1,8.0,235,0,Doc,0,0,0,1,0.033333,0.2727,0,0.0,0,1,0,0.5051,0.0,0.0,-23.36,21.53,1,0,0.0,1,117.5,0,0,0,0,0,"Stop install unnecessary packages when run tox -ereleasenotes

requirements.txt is unnecessary when run tox -e releasenotes,
releasenotes relative stuffs is in doc/requirements.txt
[SEP]
FILES CHANGED:
tox.ini (+0, -1)
",0.070988,-0.033899,-0.338864,0.616802,1.368536,-0.534267,-0.535381,-0.553594,-0.934864,-0.369451,-0.400536,-0.818759,-0.276511,0.268199,0.165098
openstack/kolla-ansible,I19c7f05b538a7abc9253194bf041c037b1998378,1,0,0.7333,5.5094,0.0,4,9.5,152,0,Doc,0,0,0,15,0.01182,0.1667,0,0.1222,3,2,0,0.7222,0.482,2.75,41.35,16.43,1,0,0.0,0,0.6154,0,0,0,0,0,"docs: more info on migrating from CentOS 7 to 8

Includes generic adding and removing hosts page.
[SEP]
FILES CHANGED:
doc/source/user/index.rst (+1, -0)
doc/source/conf.py (+1, -0)
doc/source/user/adding-and-removing-hosts.rst (+224, -0)
doc/source/user/centos8.rst (+20, -0)
",2.223472,-0.836542,0.180499,0.189608,-0.572602,0.594604,0.20668,0.32694,-0.049552,0.383884,-0.305855,0.171446,0.045408,0.008097,-0.32457
openstack/octavia,I98b31be1b1c0f61157831145ef9d19d481e2e0b0,0,0,0.1538,2.6391,0.0,2,15.5,233,0,Feature,0,0,0,13,0.003834,0.0,0,0.0,4,2,0,0.5076,0.9612,3.0,35.55,13.94,0,0,0.0,1,16.6429,0,0,0,0,0,"Update amphora status on health update

When update amphora health, if amphora status is not ACTIVE -
update status to ACTIVE to align amphora's state.

Story: 2008248
Task: 41095
[SEP]
FILES CHANGED:
releasenotes/notes/set-amphora-active-on-health-update-f9966e5eff9f4316.yaml (+5, -0)
octavia/amphorae/drivers/health/heartbeat_udp.py (+8, -0)
",0.484332,-0.981213,-0.470894,0.276186,0.295138,0.181533,-0.63603,-0.291933,-0.015211,-0.276043,0.006442,0.286423,0.13196,0.282469,-0.150882
openstack/octavia,I9283d9804feb83a1d5a160da48da6146b19da88c,1,0,0.4545,2.3026,0.1111,1,21.0,549,0,Bug Fix,0,0,0,22,0.010228,0.0714,0,0.0325,2,1,0,0.5051,0.0,2.0,45.53,16.02,1,0,0.0,0,54.9,0,0,0,0,0,"Fix pool delete race on load balancer cascade delete

In what appears to be a race condition, load balancer cascade delete can
fail while deleting numerous pools. The load balancer can still be
deleted with one or more follow-up cascade delete API calls but this is
suboptimal.

Per local testing, the ValueError exception is harmless so we can just
ignore it and continue the pool delete flow, with no orphan resources
left behind resulting from the exception skip.

Task: 41096
Story: 2008249
[SEP]
FILES CHANGED:
octavia/common/data_models.py (+8, -1)
",-0.830992,-1.724898,0.230213,0.557974,-0.272953,0.218063,0.349949,-0.487513,0.357376,0.180256,0.340554,0.270451,0.374452,-0.091218,0.175468
openstack/oslo.messaging,I2ad4b9f1d012c9f0586a932ac27d96da1bcc4e4c,1,1,0,3.1355,0.0455,3,23.5,411,0,Bug Fix,0,0,0,0,0.0,0.25,0,0.0,3,1,0,0.25,1.2159,2.33,11.98,17.06,1,0,0.6818,0,17.8696,0,6,0,9,0,"add min of 1 to rpc_conn_pool_size

This change add a min value of 1 to
[oslo_messaging_rabbit]/rpc_conn_pool_size
such that there is always at least 1 connection avaiable.

This change add a runtime check to ensure that
[oslo_messaging_rabbit]/rpc_conn_pool_size is greater than
or equal too [oslo_messaging_rabbit]/conn_pool_min_size

Closes-Bug: #1899533
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/base.py (+2, -1)
oslo_messaging/tests/drivers/test_impl_rabbit.py (+15, -0)
oslo_messaging/_drivers/impl_rabbit.py (+4, -0)
",-3.741538,1.006991,0.815016,-1.139786,1.693321,0.485477,-0.120055,-0.239644,0.14276,-0.01585,0.194006,-0.10022,-0.408804,-0.318409,-0.038035
openstack/tooz,I22b955419014dd34c63e406c488e0636ffe9013b,1,1,1.0,1.0986,0.5,1,5.33,494,0,Bug Fix,0,0,0,1,0.017857,0.1,0,0.1,0,1,0,0.0,0.0,0.0,33.98,10.47,1,0,0.0,0,164.6667,0,0,0,0,0,"Blacklist etcd3gw 0.2.6

etcd3gw 0.2.6 was blacklisted in openstack/requirements [0], because
that version has a bug [1].

tooz does not use openstack/requirements' upper constraints, so the
same blacklisting needs to be introduced here in setup.cfg.

[0] Icb6873d8c5d3a3624c0ac3d76fc9125c5d8134b2
[1] https://github.com/dims/etcd3-gateway/issues/41

Closes-Bug: #1891314
(cherry picked from commit 3f0759091c9fddf4d1486188015fc526e66cd73e)
[SEP]
FILES CHANGED:
setup.cfg (+1, -1)
",-2.313208,0.986541,0.313995,-1.67741,0.465108,-0.003297,0.718509,0.111965,-0.125833,0.16699,0.175945,-0.197305,-0.071637,-0.145932,0.023777
openstack/kolla,Id0e738044a1931f9d611a7281a48ea4a593f1cf1,0,1,0.75,3.912,0.7143,7,7.78,742,0,Bug Fix,0,0,0,16,0.010561,1.0,0,0.75,3,1,0,0.84,2.3765,2.14,-19.81,16.25,1,0,0.0,0,14.84,0,6,0,20,0,"Improve pip install process for offline deployment.

    * ""Use distribution-provided pip""
    * ""Use python's pip module invocation method""
    * ""Install pip earlier in order to avoid multiple installation""
    * ""Remove pip_version variable requirement and call""

(cherry picked from commit b93c40a3635fbce72e48dc29120e50484cba36ca)

- fixed source type builds.
- in openstack-base: install virtualenv using upper-constraints
  (just like in kolla-toolbox)

Co-authored-by: Marcin Juszkiewicz <marcin.juszkiewicz@linaro.org>
Co-authored-by: Rados≈Çaw Piliszek <radoslaw.piliszek@gmail.com>

Depends-on: https://review.opendev.org/c/openstack/kolla-ansible/+/772198

Closes-bug: #1893204
[SEP]
FILES CHANGED:
docker/helm-repository/Dockerfile.j2 (+0, -4)
docker/openstack-base/Dockerfile.j2 (+1, -5)
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+1, -1)
docker/base/Dockerfile.j2 (+9, -4)
docker/macros.j2 (+2, -16)
docker/kolla-toolbox/Dockerfile.j2 (+0, -4)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+1, -1)
",-3.221442,1.613112,1.614187,-1.202418,-0.220695,0.114464,0.086463,0.220177,-0.186252,-0.361551,0.339457,0.242259,0.247901,0.246316,-0.052978
openstack/kolla-ansible,Iff699b6dd9417e2e72618263641cbfa6ccb6e585,1,1,0.7059,1.0986,0.5,1,16.0,197,0,Bug Fix,0,0,0,17,0.01087,0.0,0,0.0,1,1,0,0.7273,0.0,1.0,-15.62,21.4,1,0,0.0,0,65.6667,0,6,0,9,0,"Delete the /var/log/kolla directory should use sudo

Related-Bug: #1892341
(cherry picked from commit 8d458e95a4f0fc6299bf685f0554a54271dc4a56)
[SEP]
FILES CHANGED:
tools/cleanup-containers (+1, -1)
",-0.067286,-0.622263,-2.231723,-2.192392,0.711217,0.184329,0.321679,-0.332686,-0.031347,-0.049312,-0.338719,-0.019719,0.219604,0.175992,-0.162496
openstack/oslo.messaging,I2ad4b9f1d012c9f0586a932ac27d96da1bcc4e4c,0,1,1.0,3.1355,0.0455,3,26.0,480,0,Bug Fix,0,0,0,1,0.125,1.0,0,1.0,3,1,0,0.3077,1.2159,2.33,3.11,18.09,1,0,0.6818,0,20.8696,0,6,0,9,0,"add min of 1 to rpc_conn_pool_size

This change add a min value of 1 to
[oslo_messaging_rabbit]/rpc_conn_pool_size
such that there is always at least 1 connection avaiable.

This change add a runtime check to ensure that
[oslo_messaging_rabbit]/rpc_conn_pool_size is greater than
or equal too [oslo_messaging_rabbit]/conn_pool_min_size

Closes-Bug: #1899533
(cherry picked from commit 00d15eaeaba0ded0330cdcec7b19eee3adbfb1e1)
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/base.py (+2, -1)
oslo_messaging/tests/drivers/test_impl_rabbit.py (+15, -0)
oslo_messaging/_drivers/impl_rabbit.py (+4, -0)
",-3.741538,1.006991,0.815016,-1.139786,1.693321,0.485477,-0.120055,-0.239644,0.14276,-0.01585,0.194006,-0.10022,-0.408804,-0.318409,-0.038035
openstack/kolla,I4172b814d5d95ae3debbc1cf3feaeee2e2bec9bd,1,1,0,3.5553,0.1765,3,10.75,395,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.8077,1.4958,2.67,12.95,14.53,1,0,0.0,1,11.2857,0,6,0,21,0,"mariadb: Fixes incremental backup failure when full not created today

backup_full() saves the history name in $BACKUP_DIR/last_full_date.
backup_incremental() attempts to read from $BACKUP_DIR/last_full_date
into $LAST_FULL_DATE. After the read attempt; if $LAST_FULL_DATE is zero
length then $(date +%d-%m-%Y) is used.

Closes-bug: 1897948
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1897948-a0eb6d890eea8061.yaml (+6, -0)
docker/mariadb/mariadb/backup.sh (+11, -3)
docker/mariadb/mariadb-server/backup.sh (+11, -3)
",-2.095078,1.752086,-0.789537,0.749838,0.798714,0.93913,-0.213101,-0.462304,0.279417,-0.180922,0.787232,-0.515699,-0.120035,0.520571,0.244906
openstack/kolla-ansible,I6f00396495853e117429c17fadfafe809e322a31,1,1,0,4.2195,0.0448,6,7.5,292,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,4,0,0.7321,2.387,3.0,1.82,20.33,1,0,0.1343,1,4.2941,0,0,0,0,0,"re-add rabbitmq config for clustering interface

this adds back the ability to configure
the rabbitmq/erlang kernel network interface
which was removed in https://review.opendev.org/#/c/584427/
seemingly by accident.

Closes-Bug: 1900160
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/templates/rabbitmq.json.j2 (+6, -0)
releasenotes/notes/fix-rabbitmq-interface-configuration-b39c954fb8763d9c.yaml (+6, -0)
ansible/roles/rabbitmq/tasks/config.yml (+18, -0)
ansible/roles/rabbitmq/templates/advanced.config.j2 (+7, -0)
kolla_ansible/tests/unit/test_address_filters.py (+9, -0)
kolla_ansible/put_address_in_context.py (+18, -3)
",0.301098,0.041086,-0.647758,-0.266221,-0.942268,0.035815,-0.026397,-0.100362,0.037655,-0.124128,-0.457161,-0.213724,-0.283579,-0.208462,0.275373
openstack/oslo.messaging,I2ad4b9f1d012c9f0586a932ac27d96da1bcc4e4c,1,1,0.5,3.1355,0.0455,3,28.5,549,0,Bug Fix,0,0,0,2,0.066667,0.5,0,0.25,3,1,0,0.2857,1.2159,2.33,-0.2,19.12,1,0,0.6818,0,23.8696,0,6,0,9,0,"add min of 1 to rpc_conn_pool_size

This change add a min value of 1 to
[oslo_messaging_rabbit]/rpc_conn_pool_size
such that there is always at least 1 connection avaiable.

This change add a runtime check to ensure that
[oslo_messaging_rabbit]/rpc_conn_pool_size is greater than
or equal too [oslo_messaging_rabbit]/conn_pool_min_size

Closes-Bug: #1899533
(cherry picked from commit 00d15eaeaba0ded0330cdcec7b19eee3adbfb1e1)
(cherry picked from commit 8f5847dcbe5144272ff7295fce2b50a9f544e5b0)
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/base.py (+2, -1)
oslo_messaging/tests/drivers/test_impl_rabbit.py (+15, -0)
oslo_messaging/_drivers/impl_rabbit.py (+4, -0)
",-3.741538,1.006991,0.815016,-1.139786,1.693321,0.485477,-0.120055,-0.239644,0.14276,-0.01585,0.194006,-0.10022,-0.408804,-0.318409,-0.038035
openstack/kayobe,Ie8fdaf95fc6fa54430e5f3acb97ae2f0474437e7,1,0,0.7222,2.1972,0.375,1,12.0,107,0,Doc,0,0,0,18,0.011494,0.0,1,0.0,2,1,0,0.913,0.0,2.0,32.5,14.8,0,0,0.0,0,11.8889,0,0,0,0,0,"docs: Add link back to Train CentOS 8 migration page
[SEP]
FILES CHANGED:
doc/source/support-matrix.rst (+5, -3)
",2.844859,0.232502,1.269356,-0.4035,-0.379641,0.471449,0.31706,0.729669,-0.042182,0.249126,0.032646,0.098411,0.110661,-0.24122,-0.519854
openstack/kolla-ansible,I8e3e0268faae871a197dc01d1c9447d00ef5d1e0,1,0,0.7368,1.7918,0.2,1,12.0,107,0,Doc,0,0,0,19,0.012071,0.0,1,0.0,3,1,0,0.7368,0.0,3.0,32.5,14.8,0,0,0.0,0,17.8333,0,0,0,0,0,"docs: Add link back to Train CentOS 8 migration page
[SEP]
FILES CHANGED:
doc/source/user/support-matrix.rst (+4, -1)
",2.844859,0.232502,1.269356,-0.4035,-0.379641,0.471449,0.31706,0.729669,-0.042182,0.249126,0.032646,0.098411,0.110661,-0.24122,-0.519854
openstack/octavia,I7d705c9f4f0217c6fbe332f45b15892bf1d4a90b,1,0,0.4583,4.7449,0.0614,3,16.0,356,0,Bug Fix,0,0,0,96,0.003887,0.0,0,0.0,6,2,0,0.5075,1.1849,4.0,31.97,16.4,0,0,0.5789,1,3.0957,0,0,0,0,0,"Fix provider driver quota handling

When provider drivers registered a load balancer object delete,
the driver agent was not decrementing the project quota.
This patch corrects that by decrementing the proper quota
when a DELETED status is received from the provider driver.

Story: 2008268
Task: 41133
[SEP]
FILES CHANGED:
octavia/api/drivers/driver_agent/driver_updater.py (+37, -6)
octavia/tests/unit/api/drivers/driver_agent/test_driver_updater.py (+65, -1)
releasenotes/notes/fix-driver-agent-decrement-quota-27486d9fa0bdeb89.yaml (+5, -0)
",-0.04849,-1.65528,-0.134756,0.667264,-0.052859,0.424502,-0.130172,0.14228,0.630182,0.08373,-0.068616,0.078721,0.092616,0.239455,0.147826
openstack/kolla-ansible,I2c35f59ae9449cb1646e402e0a9f28ad61f918a8,1,1,0.75,3.5264,0.5455,2,17.78,963,0,Bug Fix,0,0,0,20,0.012666,1.0,0,0.75,4,2,0,0.7414,0.799,3.0,55.02,14.11,1,0,0.0,1,28.3235,0,32,0,36,0,"Fix keystone-startup.sh - remove Fernet key age check

Currently we check the age of the primary Fernet key on Keystone
startup, and fail if it is older than the rotation interval. While this
may seem sensible, there are various reasons why the key may be older
than this:

* if the rotation interval is not a factor of the number of seconds in a
  week, the rotation schedule will be lumpy, with the last rotation
  being up to twice the nominal rotation interval
* if a keystone host is unavailable at its scheduled rotation time,
  rotation will not happen. This may happen multiple times

We could do several things to avoid this issue:

1. remove the check on the age of the key
2. multiply the rotation interval by some factor to determine the
   allowed key age

This change goes for the more simple option 1. It also cleans up some
terminology in the keystone-startup.sh script.

Closes-Bug: #1895723
[SEP]
FILES CHANGED:
releasenotes/notes/fix-keystone-startup-66c5aa11a464a562.yaml (+8, -0)
ansible/roles/keystone/templates/keystone-startup.sh.j2 (+7, -18)
",-2.539145,-0.714753,3.1068,-1.080014,-0.166626,0.312065,0.51439,-0.281396,0.151514,0.063882,0.193282,0.4469,-0.06065,0.070582,0.046441
openstack/kolla-ansible,I55fd1bf451d2bdae696ab32d1faffaba72701229,1,0,1.0,2.1972,0.5,1,11.67,280,0,Bug Fix,0,0,0,1,0.007463,0.3333,1,0.3333,3,1,0,0.7458,0.0,3.0,25.79,14.95,0,0,0.0,0,31.1111,0,0,0,0,0,"Fix the centos8 default path error in the quickstart.rst document

The openstack Ussuri and Victoria versions no longer support the
Centos7 and pyrhon2 environment packages. Correct the missing
problems in the latest document
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+4, -4)
",1.086804,-1.399626,-0.387242,-0.0353,-0.32058,-0.215552,0.384806,0.805242,-0.294024,-0.284495,0.094428,0.397539,-0.554376,-0.27698,0.062476
openstack/castellan,Idf4061fe3e35e3c47a993a56b23c0257c92e5cc3,1,0,0.7619,2.3026,0.1111,2,11.8,504,0,Feature,0,0,0,21,0.013027,1.0,0,0.7619,2,2,0,1.0,0.9183,2.0,11.32,11.5,1,0,0.0,1,50.4,0,0,0,0,0,"Use 'barbican_endpoint_type'config option to get endpoint from catalog

_get_barbican_endpoint now uses barbican_endpoint_type config option to
retrieve a correct endpoint from catalog.

This config option is set to 'public' by default and it's a default
value for ServiceCatalog.endpoint_data_for method. It means that the
default behaviour will be the same as before this patch.

(cherry picked from commit e63d813a70eb4b841937a4e8a06a55e85d3ea97d)
[SEP]
FILES CHANGED:
releasenotes/notes/use-barbican-endpoint-type-config-option-e583d30930cc22ba.yaml (+6, -0)
castellan/key_manager/barbican_key_manager.py (+2, -1)
",-1.975039,-0.149264,-0.091384,-0.274351,1.053411,0.082749,0.592159,-0.194487,0.494501,-0.04304,0.5822,-0.165592,-0.543239,0.005238,-0.108686
openstack/castellan,Idf4061fe3e35e3c47a993a56b23c0257c92e5cc3,1,0,0.7727,2.3026,0.1111,2,11.8,504,0,Feature,0,0,0,22,0.013572,1.0,0,0.7727,2,2,0,1.0,0.9183,2.0,11.32,11.5,1,0,0.0,1,50.4,0,0,0,0,0,"Use 'barbican_endpoint_type'config option to get endpoint from catalog

_get_barbican_endpoint now uses barbican_endpoint_type config option to
retrieve a correct endpoint from catalog.

This config option is set to 'public' by default and it's a default
value for ServiceCatalog.endpoint_data_for method. It means that the
default behaviour will be the same as before this patch.

(cherry picked from commit e63d813a70eb4b841937a4e8a06a55e85d3ea97d)
[SEP]
FILES CHANGED:
releasenotes/notes/use-barbican-endpoint-type-config-option-e583d30930cc22ba.yaml (+6, -0)
castellan/key_manager/barbican_key_manager.py (+2, -1)
",-1.975039,-0.149264,-0.091384,-0.274351,1.053411,0.082749,0.592159,-0.194487,0.494501,-0.04304,0.5822,-0.165592,-0.543239,0.005238,-0.108686
openstack/kolla-ansible,I2c35f59ae9449cb1646e402e0a9f28ad61f918a8,1,1,0.65,3.5264,0.5455,2,18.33,1032,0,Bug Fix,0,0,0,20,0.013063,1.0,0,0.65,4,2,0,0.75,0.799,3.0,52.87,14.36,1,0,0.0,1,30.3529,1,32,0,36,0,"Fix keystone-startup.sh - remove Fernet key age check

Currently we check the age of the primary Fernet key on Keystone
startup, and fail if it is older than the rotation interval. While this
may seem sensible, there are various reasons why the key may be older
than this:

* if the rotation interval is not a factor of the number of seconds in a
  week, the rotation schedule will be lumpy, with the last rotation
  being up to twice the nominal rotation interval
* if a keystone host is unavailable at its scheduled rotation time,
  rotation will not happen. This may happen multiple times

We could do several things to avoid this issue:

1. remove the check on the age of the key
2. multiply the rotation interval by some factor to determine the
   allowed key age

This change goes for the more simple option 1. It also cleans up some
terminology in the keystone-startup.sh script.

Closes-Bug: #1895723

(cherry picked from commit ba8c27f554682e1f2720fad1bff5cfa1b35017f2)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-keystone-startup-66c5aa11a464a562.yaml (+8, -0)
ansible/roles/keystone/templates/keystone-startup.sh.j2 (+7, -18)
",-2.539145,-0.714753,3.1068,-1.080014,-0.166626,0.312065,0.51439,-0.281396,0.151514,0.063882,0.193282,0.4469,-0.06065,0.070582,0.046441
openstack/kolla-ansible,I8bfdfa3102e126563ded04a0c0ed4284436701d8,1,0,0.7826,0.6931,0.0,1,4.5,128,0,Bug Fix,1,0,0,23,0.01411,0.5,0,0.3913,1,1,0,0.7541,0.0,1.0,-51.53,24.02,0,0,1.0,1,64.0,0,0,0,0,0,"CI: prometheus-efk: add tests/test-prometheus-efk.sh to files

TrivialFix
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
",-0.460046,2.64459,-2.39987,0.6705,0.951162,0.127074,-0.942766,-0.659964,-0.701318,-0.3322,0.504301,-0.139285,-0.098302,0.422667,0.102737
openstack/oslo.policy,I138e5cf6deb82ad29a2bf70392c1859354b84800,1,0,0,3.6376,0.4865,5,5.0,73,0,Bug Fix,0,0,0,0,0.0,0.5,1,0.0,3,1,0,1.0,1.8108,2.4,-18.2,18.0,1,0,0.0,0,1.9211,0,0,0,0,0,"Fix grammar issues
[SEP]
FILES CHANGED:
doc/source/configuration/index.rst (+2, -2)
CONTRIBUTING.rst (+2, -2)
doc/source/user/usage.rst (+11, -10)
doc/source/user/plugins.rst (+1, -1)
doc/source/user/sphinxpolicygen.rst (+3, -3)
",3.82732,2.859762,2.989614,0.398819,0.319216,1.594271,0.478463,-0.518372,0.837469,0.32299,-0.022153,-0.708971,1.050847,-0.194106,0.804718
openstack/kolla-ansible,I8a08f1c411c243c4d1cb6efd0e82de67a5151197,1,0,0.7917,4.7362,1.0,2,5.2,191,0,Feature,0,0,0,24,0.014715,0.0,0,0.0,4,1,0,0.7581,0.1283,4.0,42.12,14.39,0,0,0.0,0,1.6754,0,0,0,0,0,"kibana: Remove 6.x migration from upgrade

This was required in Train and Ussuri for the 5.x to 6.x upgrade, but is
no longer necessary.
[SEP]
FILES CHANGED:
ansible/roles/kibana/tasks/migrate-kibana-index.yml (+0, -111)
ansible/roles/kibana/tasks/upgrade.yml (+0, -2)
",1.557216,-0.03376,-0.067828,0.20544,-0.72651,0.772377,0.096908,-0.11305,-0.772491,0.869391,0.328856,0.61619,-0.642977,0.162968,0.199257
openstack/octavia,I736816247131715f5c385b4680614ec3218a2ad7,1,0,0.4639,4.0254,0.2545,5,20.5,259,0,Bug Fix,0,0,0,97,0.00391,0.1818,0,0.0843,7,2,0,0.51,2.2313,5.2,64.29,13.08,0,0,0.5455,1,4.625,0,0,0,0,0,"Fix pools going into ERROR when updating the pool

There was a bug that would cause a pool to go into ERROR if you attempted
to update the CRL or client certificate on the pool.

Story: 2008295
Task: 41180
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+13, -2)
releasenotes/notes/fix-pool-crl-2cc6f2705f5b2009.yaml (+5, -0)
octavia/api/drivers/amphora_driver/v2/driver.py (+5, -5)
octavia/api/drivers/amphora_driver/v1/driver.py (+5, -5)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+13, -2)
",0.419168,-1.536209,-0.413042,0.311539,-0.347504,0.889803,-0.249057,-0.565457,0.300008,0.21323,0.208259,0.067412,0.129705,0.146183,0.159839
openstack/octavia,I82d482bba3e4c40913583fb26f692824c56e6ac1,0,0,0.5,2.1972,0.5,1,3.86,384,0,Doc,0,0,0,2,0.064516,0.2941,0,0.1471,0,1,0,0.5124,0.0,0.0,-50.88,14.88,1,0,0.0,1,42.6667,1,0,0,0,0,"Use TOX_CONSTRAINTS_FILE

UPPER_CONSTRAINTS_FILE is old name and deprecated
-https://zuul-ci.org/docs/zuul-jobs/python-roles.html#rolevar-tox.tox_constraints_file
This allows to use lower-constraints file as more
readable way instead of UPPER_CONSTRAINTS_FILE=<lower-constraints file>.

[1] https://review.opendev.org/#/c/722814/
[SEP]
FILES CHANGED:
tox.ini (+4, -4)
",-2.360244,3.259406,-0.813924,0.731208,0.317979,-0.087418,-0.176741,0.053647,0.225115,-0.3445,0.310699,-0.226295,-0.294635,0.272023,-0.022712
openstack/kolla,I151420d3036410dd5ce6d90907d72dd3c20643b5,1,1,0.8889,2.9957,0.2632,2,9.0,118,0,Bug Fix,0,0,0,9,0.079646,0.0,0,0.0,3,2,0,0.8148,0.7425,3.0,-18.5,16.93,1,0,0.0,0,5.9,0,6,0,11,0,"neutron: Fix update-alternatives on CentOS

Closes-Bug: #1884778
[SEP]
FILES CHANGED:
docker/neutron/neutron-base/neutron_sudoers (+4, -0)
docker/neutron/neutron-base/extend_start.sh (+10, -5)
",2.35437,0.277778,-0.214613,-1.14189,-0.879148,0.626845,-0.767418,0.177484,-0.122973,-0.33717,0.501869,-0.002387,0.208136,-0.064371,0.355138
openstack/kolla-ansible,I575942c8d90441145de78dcb16a2b4c1f172773b,1,0,0.8,2.0794,0.2857,1,9.67,265,0,CI,1,1,0,25,0.014335,0.0,0,0.0,2,1,0,0.7619,0.0,2.0,33.66,14.9,1,0,1.0,0,33.125,0,0,0,0,0,"Revert ""CI: Temporarily disable rabbitmq internal tls""

This reverts commit ff441c1c0ceb8fc06a17f5db8e460ad00e8db365.

Since RabbitMQ TLS is still not functional in Victoria, it is
not enabled for upgrade jobs.
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+5, -2)
",0.203905,-1.046367,-1.484924,-1.000899,0.56015,0.272141,0.692571,0.098973,0.365606,0.353287,-0.164468,0.31779,-0.36351,-0.409262,0.028584
openstack/oslo.utils,I856e3cf32c409debdfb15aa96415c3309fe2f516,1,1,0,1.7918,0.8,2,14.5,425,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.6667,0.971,1.5,52.09,12.7,1,0,0.6,0,70.8333,0,6,0,3,0,"strutils: Stop masking encryption_key_id

As the name suggests this is simply an id referring to a key and not the
actual key itself. As such we should stop masking this in an effort to
ease debugging and troubleshooting when it is logged.

This was previously incorrectly masked by
I9e684cd8bab85728ff0117f95a30eb7dbb5bf51c as part of bug #1814365.

Closes-Bug: #1905264
[SEP]
FILES CHANGED:
oslo_utils/tests/test_strutils.py (+0, -3)
oslo_utils/strutils.py (+1, -1)
",-1.229082,-1.144938,-0.597015,-0.886782,0.333172,0.33861,0.533709,-0.408775,0.598812,0.554247,0.29657,-0.130894,0.145968,-0.32791,0.11997
openstack/octavia,I923accd73e0c9cadc91c115157c576432f428622,1,0,0,3.0445,0.25,2,12.67,567,0,Bug Fix,0,0,0,0,0.0,0.75,0,0.0,7,1,0,0.5099,0.6098,6.0,39.25,14.01,0,0,0.85,0,27.0,1,0,0,0,0,"Fix load balancers with failed amphora failover

This patch is a complement of [1] which we ensure
a fresh lb object, but only for AmpListenersUpdate
class.

It was observed, at least on train and ussuri
deployments that multiple failed amphoras were still
happening when using session persistence.

That is fixed and failover works flawless with session
persistence when we also ensure a fresh lb object on
AmphoraIndexListenerUpdate class.

[1] https://review.opendev.org/#/c/756597/

Story: 2008099
Task: 40802
[SEP]
FILES CHANGED:
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+3, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+12, -5)
",-0.787158,-1.008563,0.821127,-0.479133,-0.747231,-0.120884,0.313582,0.322834,0.200819,-0.149422,0.292921,-0.189878,-0.114549,-0.050349,0.062779
openstack/kolla-ansible,I58af7a09b5ae09a10b9efc33c1f30c2efc6613f7,1,0,0.6667,3.1781,0.5652,3,10.0,209,0,Bug Fix,0,0,0,21,0.013427,0.3,0,0.2,4,2,0,0.7656,1.1626,2.0,61.33,9.33,1,0,0.3913,1,8.7083,1,0,0,0,0,"Remove a CentOS IPv6 FIXME meant for Ussuri

CentOS 8 should work fine without the workaround.

This change adds the missing CentOS 8 IPv6 CI job as well.
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+1, -13)
zuul.d/project.yaml (+1, -0)
zuul.d/jobs.yaml (+8, -0)
",1.263318,-2.059784,0.427147,-0.214746,-0.519278,0.314355,-0.412883,0.358872,-0.524878,0.2823,0.002407,-0.043851,-0.023047,-0.190764,0.048061
openstack/kolla-ansible,If6c50606fa3da353728ae4d916df20fcc95b8927,1,0,1.0,2.4849,0.0,2,9.0,106,0,CI,0,0,0,1,0.047619,0.0,0,0.0,4,2,0,0.7692,0.684,3.0,-18.5,25.82,1,0,0.0,1,8.8333,0,0,0,0,0,"Add service specific custom haproxy config override
[SEP]
FILES CHANGED:
ansible/roles/haproxy-config/tasks/main.yml (+2, -0)
releasenotes/notes/support-haproxy-service-override-85bcc4d3c0af6cf2.yaml (+9, -0)
",3.749896,0.498604,2.070091,0.800481,0.927285,-0.138917,1.229808,0.607837,0.641675,-0.463866,-0.354724,-0.577872,0.428773,-0.377996,0.315753
openstack/oslo.config,I0a0670207f96a987996d329e5efa9a5eb2ce000c,0,1,0.6667,4.3944,0.05,3,6.31,1501,0,Bug Fix,0,0,0,3,0.057692,0.0,0,0.0,2,2,0,1.0,1.3265,1.67,12.66,12.28,1,0,0.3,1,18.5309,0,6,0,10,0,"Add a new type HostDomain.

HostDomain is like HostAddress with the support of
_ character - RFC1033

openstack services are failing to start when a hostname with underscore
_ is provided.

Example:

```
overcloud-novacompute_edge1-0.internalapi.localdomain
overcloud-novacompute_edge1-0.internalapi
```

Nova use `HostAddressOpt` to define `live_migration_inbound_addr`,
and if a hostname with underscore is present in the config file
then the service fail to start.

Example:

```
/etc/nova/nova.conf
live_migration_inbound_addr =
overcloud-novacompute_edge1-0.internalapi.localdomain
```

FQDN is a domain name that specifies its exact
location in the tree hierarchy of the Domain Name System (DNS).

Underscore are allowed by RFC1033 [1][2][3]. Indeed, while a hostname may not
contain other characters, such as the underscore character (_), other
DNS names may contain the underscore.[1][2].
Systems such as DomainKeys and service records use the underscore.

These changes allow us to use underscore with the `HostDomain`.

[1] https://www.ietf.org/rfc/rfc1912.txt
[2] https://www.ietf.org/rfc/rfc1033.txt
[3] http://domainkeys.sourceforge.net/underscore.html

Co-authored-by: Daniel Bengtsson <dbengt@redhat.com>
Closes-Bug: #1892044
(cherry picked from commit 6480356928c9ae6169ea1e5a5b5f1df3d6e0dc75)
(cherry picked from commit f37bcc779347c9e0d1e37258a6d072b718edf7f7)
(cherry picked from commit 1fcb3e8acd3c229c74c87d80fd183cfc2432bace)
[SEP]
FILES CHANGED:
oslo_config/tests/test_types.py (+23, -1)
oslo_config/types.py (+44, -3)
releasenotes/notes/add-HostDomain-implement-rfc1033-c985a3054f824e9d.yaml (+9, -0)
",-3.427028,1.287918,2.768391,-1.690308,0.332277,0.661282,-1.38613,-0.394216,-0.199242,0.087807,-1.150217,0.6381,-0.127624,0.221518,-0.391507
openstack/python-octaviaclient,I1d5119cb5ce9da0fd6c7a39aeb371a507607b9d7,0,0,0.7241,7.362,0.0388,18,15.2,542,0,Bug Fix,0,0,0,29,0.007068,0.25,0,0.181,5,2,0,0.1053,3.6302,3.83,42.24,15.55,0,0,0.7973,1,0.3441,0,0,0,0,0,"Add tag support for Octavia resources

Add tag support for load balancers, listeners, pools, health monitors,
members, l7policies and l7rules.
Tags can be set when creating a resource, and can be modified using
set/unset CLI calls.
Filtering by tags is also supported when listing resources.

This commit also fixes some errors when using set/unset l7rule CLI with
the --wait flag (l7rule_id and l7policy_id parameters were swapped in
partial function calls).

Story: 2008347
Task: 41249
[SEP]
FILES CHANGED:
octaviaclient/osc/v2/l7policy.py (+24, -3)
octaviaclient/osc/v2/load_balancer.py (+24, -3)
octaviaclient/tests/unit/osc/v2/test_listener.py (+153, -0)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+190, -0)
releasenotes/notes/add-tag-support-01087c4b3c4360dc.yaml (+12, -0)
octaviaclient/osc/v2/constants.py (+13, -8)
octaviaclient/osc/v2/l7rule.py (+39, -16)
octaviaclient/osc/v2/utils.py (+44, -3)
octaviaclient/tests/unit/osc/v2/test_member.py (+196, -1)
octaviaclient/osc/v2/member.py (+35, -13)
octaviaclient/tests/unit/osc/v2/test_l7rule.py (+227, -3)
octaviaclient/osc/v2/health_monitor.py (+24, -3)
octaviaclient/tests/unit/osc/v2/constants.py (+5, -2)
octaviaclient/tests/unit/osc/v2/test_health_monitor.py (+157, -0)
octaviaclient/tests/unit/osc/v2/test_l7policy.py (+168, -0)
octaviaclient/osc/v2/listener.py (+25, -3)
octaviaclient/tests/unit/osc/v2/test_pool.py (+153, -0)
octaviaclient/osc/v2/pool.py (+24, -3)
",-2.197497,-0.729868,0.001437,0.761275,0.707873,-0.335541,-0.852003,0.24686,0.325023,0.216623,-0.197767,-0.171719,0.501871,-0.101075,-0.390154
openstack/kolla-ansible,Ibd06726ac6edcb63a1d5d4f4148851876316dc5b,1,0,0.8077,1.7918,0.4,2,9.0,94,0,CI,0,0,0,26,0.014849,1.0,0,0.8077,1,2,0,0.7727,0.971,1.0,37.9,16.93,0,0,0.6,0,15.6667,0,0,0,0,0,"CI: add missing --fail argument to curl
[SEP]
FILES CHANGED:
tools/init-runonce (+1, -1)
tests/test-ironic.sh (+2, -1)
",2.494322,0.4833,1.019317,0.647689,0.767461,0.156346,-0.018401,-0.575046,0.331347,0.732029,0.156993,-0.508897,0.704838,-0.000209,0.275156
openstack/octavia,I2e86378e20190e0ba987a255f18d675895197541,0,0,0.7,7.1577,0.9026,28,11.0,116,0,Feature,0,0,0,30,0.005284,1.0,0,0.7,7,11,0,0.5123,3.8942,4.64,11.09,15.31,1,0,0.2759,1,0.0903,0,0,0,0,0,"Remove upstart and sysvinit support

Story 2008357
Task 41262
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/keepalived.py (+18, -37)
octavia/common/config.py (+10, -2)
elements/amphora-agent/post-install.d/11-enable-amphora-agent-systemd (+1, -3)
elements/certs-ramfs/init-scripts/sysv/certs-ramfs (+0, -39)
elements/certs-ramfs/init-scripts/upstart/certs-ramfs.conf (+0, -14)
octavia/amphorae/backends/agent/templates/amphora_agent_conf.template (+0, -3)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+43, -199)
etc/octavia.conf (+0, -5)
octavia/amphorae/backends/agent/api_server/templates/keepalived.upstart.j2 (+0, -29)
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+14, -78)
octavia/common/constants.py (+0, -13)
octavia/amphorae/backends/agent/api_server/templates/upstart.conf.j2 (+0, -71)
octavia/tests/unit/amphorae/backends/agent/api_server/test_keepalivedlvs.py (+0, -18)
octavia/tests/functional/amphorae/backend/agent/api_server/test_keepalivedlvs.py (+7, -53)
octavia/amphorae/backends/agent/api_server/util.py (+9, -56)
doc/source/contributor/guides/dev-quick-start.rst (+1, -1)
elements/amphora-agent/install.d/amphora-agent-source-install/amphora-agent.conf (+0, -18)
octavia/amphorae/backends/agent/api_server/templates/keepalived_lvs_check_script.sh.j2 (+0, -4)
elements/certs-ramfs/post-install.d/30-enable-certs-ramfs-service (+1, -13)
octavia/amphorae/backends/agent/api_server/templates/keepalived.sysvinit.j2 (+0, -87)
octavia/amphorae/backends/agent/agent_jinja_cfg.py (+0, -3)
octavia/tests/unit/amphorae/backends/agent/test_agent_jinja_cfg.py (+0, -13)
releasenotes/notes/remove-sysvinit-upstart-support-a95e2deeb8953668.yaml (+6, -0)
elements/amphora-agent/install.d/amphora-agent-source-install/amphora-agent.init (+0, -67)
octavia/amphorae/backends/agent/api_server/templates/sysvinit.conf.j2 (+0, -232)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+1, -20)
octavia/amphorae/backends/agent/api_server/keepalivedlvs.py (+13, -65)
elements/amphora-agent/install.d/amphora-agent-source-install/75-amphora-agent-install (+1, -15)
",2.968839,-0.745387,0.640496,-1.513178,-0.592214,0.547561,-0.557589,0.774099,-0.040904,-0.293189,0.246845,0.115751,-0.122153,0.3506,0.101574
openstack/octavia,I6fb7889de90e8e5354c1e6ce2c95ec0199ce90e3,1,0,0,1.9459,0.1667,2,12.0,333,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0.5098,0.9183,2.0,51.89,12.3,1,0,0.0,1,47.5714,0,0,0,0,0,"Fix missing cronie package in RHEL-based image builds

In RHEL-based distros, cron is provided by the cronie package. This package is
missing from the amphora built images.

This patch maps the cron package to cronie for distros in the Red Hat family.

Story: 2008351
Task: 41253
[SEP]
FILES CHANGED:
releasenotes/notes/fix-missing-cronie-rh-bd31001338ddbb1e.yaml (+4, -0)
elements/amphora-agent/pkg-map (+1, -1)
",-0.32995,-0.633782,-0.577392,0.559759,0.037363,-0.079211,0.152795,0.692044,-0.200416,-0.072198,0.177545,0.220709,0.041166,0.096085,-0.179982
openstack/octavia,I3c830a9f0fd21ca10238946721c0f75d01d3ddff,1,0,1.0,1.9459,0.1667,2,13.25,413,0,Feature,0,0,0,1,0.142857,0.5,0,0.5,2,2,0,0.5122,0.9183,2.0,54.51,11.34,1,0,0.0,1,59.0,0,0,0,0,0,"Map cloud-guest-utils to cloud-utils-growpart for Red Hat distros.

The package cloud-utils-growpart is missing from Red Hat based image
builds which means the root filesystems are not grown on instance
startup which means not much space for things like logs.

This patch maps the cloud-guest-utils package to cloud-utils-growpart.

Story: 2008350
Task: 41252
[SEP]
FILES CHANGED:
elements/amphora-agent/pkg-map (+1, -1)
releasenotes/notes/fix-missing-cloud-guest-utils-rh-eb39a53502dc1e91.yaml (+4, -0)
",-1.33679,0.232575,-0.599574,0.780063,0.445215,-0.537514,0.113224,0.233674,-0.446705,-0.252387,0.043233,-0.137547,0.39062,0.366902,0.225011
openstack/kolla,I702f8fba37e22a6bb45eae14f1fbb251bcdb4d8a,1,0,0.8148,1.0986,0.0,2,9.0,98,0,Doc,1,0,0,27,0.015376,0.0,0,0.0,2,2,0,0.8214,1.0,1.5,0.3,21.38,1,0,1.0,0,32.6667,0,0,0,0,0,"CI: add templated Dockerfiles to build logs
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+1, -0)
.zuul.d/base.yaml (+1, -0)
",2.402387,0.018811,0.835089,0.562136,0.751661,-0.404692,0.146359,0.27215,-0.231712,-0.066171,-0.204444,-0.582199,0.292108,0.250917,-0.62347
openstack/kolla-ansible,I02817963c691784c126c79e330981e0cc771bc88,0,1,0.9,2.4849,0.0,2,11.0,123,0,Bug Fix,0,0,0,10,0.075758,0.5,0,0.45,4,2,0,0.7761,0.4395,3.0,18.78,18.95,1,0,0.0909,0,10.25,0,14,0,17,0,"cinder: check for coordination backend when HA

Related-Bug: #1904062
[SEP]
FILES CHANGED:
ansible/roles/cinder/tasks/precheck.yml (+10, -0)
tests/templates/globals-default.j2 (+1, -0)
",2.412558,-0.230837,-0.333938,-1.157178,-0.957827,0.82252,-0.812878,0.005849,0.373581,-0.385537,0.413152,-0.034298,0.248418,-0.079495,-0.124108
openstack/octavia,I03ed95e876c0fb8dc9ac44986d42eb664fbcbb01,0,0,0.4694,2.6391,0.0,2,10.0,150,0,CI,1,0,0,98,0.003941,0.3636,0,0.1707,1,1,0,0.5146,0.6194,1.0,48.64,10.0,0,0,1.0,1,10.7143,0,0,0,0,0,"Add nightly test image build job for focal

Adds a nightly image build for a focal based image.
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+2, -0)
zuul.d/jobs.yaml (+11, -0)
",1.261266,0.036699,-0.361133,1.267448,0.617358,0.37244,0.498658,0.203251,0.576332,-0.113482,0.219678,0.523804,0.410808,0.142239,0.024113
openstack/kolla-ansible,I44d5c62eae6778f2fb2a8a12adc9561b994b1302,0,0,0,0.6931,0.0,1,5.25,205,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.7647,0.0,4.0,36.33,13.53,0,0,0.0,0,102.5,0,0,0,0,0,"Use hostPID for ceph-mgr deployment

This change is to address a memory leak in the ceph-mgr deployment.

refer https://review.opendev.org/#/c/744236/
[SEP]
FILES CHANGED:
ansible/roles/ceph/tasks/start_mgrs.yml (+1, -0)
",0.276571,2.094548,-0.741199,0.333377,-0.776822,0.342232,0.683187,-0.34736,0.209426,-0.371594,-0.307373,-0.099095,-0.196816,-0.354598,0.154207
openstack/python-magnumclient,I7306d167a17284c7f478ec1c1599a8d4b32040c2,1,0,0,1.3863,0.0,1,13.0,195,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0,0.0,2.0,63.49,9.82,0,0,0.0,0,48.75,0,0,0,0,0,"Fix failing to parse json error msg

It assumes its a requests response but could
be a HTTPResponse from urllib.

Story: 2008789
Task: 42183
[SEP]
FILES CHANGED:
magnumclient/common/httpclient.py (+3, -0)
",1.012935,-1.23438,-0.355062,-0.597087,-0.709815,0.548918,-0.610383,-0.376114,-0.070123,0.052346,0.369175,-0.224436,-0.216122,0.52575,-0.173161
openstack/octavia,I64a7072b2c4e1a12b5d908647f1eddcad7ec3b90,1,0,0.6774,5.0876,0.0,3,29.0,230,0,Bug Fix,0,0,0,31,0.004454,0.5,0,0.3387,5,2,0,0.5121,0.4275,3.67,43.21,14.36,0,0,0.9317,1,1.4198,0,0,0,0,0,"Fix setting None in tls_versions and tls_ciphers in pools

Setting None in tls_versions and tls_ciphers should reset their value
to the default value

Story 2008367
Task 41276
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_pool.py (+150, -0)
octavia/api/v2/controllers/pool.py (+5, -0)
releasenotes/notes/fix-unset-for-tls_versions-tls_ciphers-in-pools-7534715ce28bd8cb.yaml (+6, -0)
",-0.659748,-0.12735,-0.963727,0.75348,1.362609,0.11203,-1.274348,-0.423208,-0.348477,0.06266,-0.112424,-0.686056,-0.058425,0.010498,0.146428
openstack/kolla-ansible,I5a630109e3c4b59bff216146a3ed64c6d47e247f,0,0,0.6667,5.1417,0.8118,7,6.62,392,0,Feature,0,0,0,6,0.013129,1.0,0,0.6667,4,3,0,0.7536,2.3386,3.71,37.3,13.97,1,0,0.0,1,2.2924,0,0,0,0,0,"Use trove.conf  for all trove services

it was confused to customize opts in trove-conductor.conf
or trove-taskmanager.conf now.
if we want to customize a opts,The operator needs
to know which service is using the configuration opts.
actually trove uses trove.conf is enough for all services
this change combines  all trove config files.
[SEP]
FILES CHANGED:
ansible/roles/trove/templates/trove-taskmanager.json.j2 (+3, -3)
ansible/roles/trove/templates/trove.conf.j2 (+14, -0)
releasenotes/notes/combine_trove_config_files-ff3d37440a472a82.yaml (+12, -0)
ansible/roles/trove/templates/trove-conductor.conf.j2 (+0, -46)
ansible/roles/trove/templates/trove-taskmanager.conf.j2 (+0, -63)
ansible/roles/trove/templates/trove-conductor.json.j2 (+3, -3)
ansible/roles/trove/tasks/config.yml (+0, -23)
",-0.470554,-1.552438,0.033015,0.738981,-0.033717,-0.785627,0.238943,-0.517664,-0.59318,-0.135395,-0.357207,-0.667186,-0.1497,0.480312,-0.041096
openstack/kayobe,Ibd73999e54586b88d26adb688305af3c60595fbd,1,0,1.0,2.3979,0.5,1,5.0,343,0,Doc,0,0,0,1,0.333333,0.2857,0,0.2857,0,1,0,0.9167,0.0,0.0,-48.66,14.8,0,0,0.0,1,31.1818,0,0,0,0,0,"Update TOX_CONSTRAINTS_FILE

UPPER_CONSTRAINTS_FILE is old name and deprecated
-https://zuul-ci.org/docs/zuul-jobs/python-roles.html#rolevar-tox.tox_constraints_file
This allows to use lower-constraints file as more
readable way instead of UPPER_CONSTRAINTS_FILE=<lower-constraints file>.
[SEP]
FILES CHANGED:
tox.ini (+5, -5)
",-2.221564,2.918954,-0.945293,1.137649,0.861982,-0.273923,-0.276234,0.141338,0.257808,-0.420359,0.286836,-0.244109,-0.153794,0.325856,0.187562
openstack/octavia-dashboard,I6e2a5b838a47842205d44ef1204c437331829728,1,0,0.6875,7.0379,0.4279,12,12.0,124,0,CI,0,0,0,32,0.004494,1.0,0,0.6875,7,3,0,0.0952,2.107,6.5,11.36,14.8,0,0,0.0,1,0.1089,0,0,0,0,0,"Allows creation of resources without forcing the creation of children
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.html (+258, -237)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/monitor/monitor.controller.spec.js (+24, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.controller.js (+11, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/monitor/monitor.controller.js (+10, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.controller.spec.js (+22, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/monitor/monitor.html (+158, -137)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.controller.js (+9, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+4, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/members/members.html (+2, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.html (+129, -109)
releasenotes/notes/allows-creation-of-single-resources-9ec5fe87acc7c93c.yaml (+7, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/listener/listener.controller.spec.js (+17, -0)
",1.007169,0.994705,1.632164,1.699918,1.672316,1.393234,-0.421043,-0.915616,0.186249,0.561963,-1.350161,0.338199,0.786397,-0.257663,-0.327707
openstack/octavia-dashboard,I41559e3f2d13e5adbb850f28f058b72404e28124,0,0,0.697,4.6151,0.06,11,6.0,196,0,Feature,0,0,1,33,0.003996,0.3333,0,0.2323,7,5,0,0.1364,2.4734,4.64,52.7,14.07,0,0,0.0,1,1.9406,0,0,0,0,0,"Add TLS enabled support for pools

Bump openstacksdk to 0.53.0, it provides the tls_enabled flag for
Octavia pools.

Story 2008368
Task 41277
[SEP]
FILES CHANGED:
releasenotes/notes/add-tls_enabled-support-for-pools-449e39f851535839.yaml (+5, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.html (+18, -0)
requirements.txt (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/pools/pools.module.js (+4, -0)
octavia_dashboard/api/rest/lbaasv2.py (+2, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/pools/details/detail.html (+1, -1)
lower-constraints.txt (+2, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/pools/details/drawer.html (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+48, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+5, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/pool/pool.help.html (+7, -0)
",0.40595,-1.147794,-0.744116,-0.534598,0.00479,0.238523,-1.178134,0.708163,-0.15037,0.21447,-0.384042,0.133533,-0.315268,-0.169956,0.280302
openstack/kolla,Icae24e3a5f522ec97cc43d6eda1811d5b2231d94,0,0,0.3333,3.4965,0.5,5,8.0,88,0,Feature,0,0,0,3,0.076923,0.7143,0,0.2381,3,3,0,0.8276,2.1266,2.0,-12.78,18.2,1,0,0.0625,0,2.6667,0,0,0,0,0,"Use apt instead of legacy apt-get
[SEP]
FILES CHANGED:
kolla/template/methods.py (+5, -5)
docker/bifrost/bifrost-base/Dockerfile.j2 (+3, -3)
docker/base/Dockerfile.j2 (+5, -5)
tools/validate-install-command.sh (+2, -2)
kolla/tests/test_methods.py (+1, -1)
",2.401752,2.50251,1.256469,0.689822,0.787156,0.143719,0.584773,-0.79963,-1.192782,-0.083647,-0.197653,-0.067311,0.402888,-0.010406,0.561527
openstack/octavia,I30e23ca13d033d77c8ebdabbfdc7b54556a9466b,1,0,0.6765,4.6052,0.1818,6,16.75,472,0,Bug Fix,0,0,0,34,0.004067,0.75,0,0.5074,6,3,0,0.5144,1.934,4.67,34.52,13.27,0,0,0.8081,1,4.72,0,0,0,0,0,"Fix operating status for empty UDP pools

Fix empty UDP pools status: a UDP pool without members went OFFLINE
instead of ONLINE.

This commit changes the keepalived configuration with empty pools:
the configuration now contains a virtual_server and a comment about the
existing pool. This comment is used by the get_udp_listener_pool_status
to detect that the pool exists and is not offline.

Story 2007984
Task 40610
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+44, -0)
octavia/common/jinja/lvs/templates/macros.j2 (+5, -7)
releasenotes/notes/fix-empty-udp-pool-status-3171950628898468.yaml (+5, -0)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+1, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+24, -8)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+2, -2)
",-2.278129,-0.780476,0.75288,-1.123738,0.195702,-0.060626,-0.004725,0.098554,0.31656,-0.424758,0.009769,-0.087883,-0.323729,0.316366,-0.212442
openstack/kolla,I2c82c6269b2c357b0815ea29bc6a7c322f84dac9,1,0,0.6667,1.7918,0.0,1,8.0,101,0,Bug Fix,0,0,0,6,0.065934,0.0,0,0.0,2,1,0,0.8,0.0,2.0,-12.78,23.2,0,0,0.0,0,16.8333,0,0,0,0,0,"base: fix QEMU dependencies for Debian/aarch64
[SEP]
FILES CHANGED:
docker/base/apt_preferences.debian (+5, -0)
",1.038238,0.02905,-1.860277,-2.431342,1.377244,0.186391,0.828441,-0.293842,-0.07237,0.018522,-0.709639,0.305918,-0.154885,-0.46362,-0.177943
openstack/kolla,I2c82c6269b2c357b0815ea29bc6a7c322f84dac9,0,0,0.7143,1.7918,0.0,1,13.0,170,0,Bug Fix,0,0,0,7,0.072917,1.0,0,0.7143,2,1,0,0.8065,0.0,2.0,-1.59,20.58,0,0,0.0,0,28.3333,0,0,0,0,0,"base: fix QEMU dependencies for Debian/aarch64

(cherry picked from commit 753623b29bdf66b5bbf50960d44addf9e3855bee)
[SEP]
FILES CHANGED:
docker/base/apt_preferences.debian (+5, -0)
",1.038238,0.02905,-1.860277,-2.431342,1.377244,0.186391,0.828441,-0.293842,-0.07237,0.018522,-0.709639,0.305918,-0.154885,-0.46362,-0.177943
openstack/octavia-lib,Ie90f09c3c557f9bc3e72afbc957898d17d3b1b1e,0,0,0.25,2.7726,1.0,2,3.4,160,0,Feature,0,0,0,4,0.056338,0.129,0,0.0323,0,1,0,0.0435,0.5665,0.0,44.14,10.77,1,0,0.0,0,10.0,0,0,0,0,0,"Remove babel.cfg

Remove babel.cfg and the translation bits from setup.cfg, those are not
needed anymore.
[SEP]
FILES CHANGED:
babel.cfg (+0, -2)
setup.cfg (+0, -13)
",0.954288,0.559533,-0.321874,1.087573,0.361483,0.294546,0.117349,-0.63996,-0.819848,-0.245666,0.020215,-0.159754,-0.526774,0.923721,-0.649358
openstack/kayobe,I1264832398744c48a6f706efe91f084890a37772,1,0,0.8214,1.0986,0.5,1,12.0,553,0,Bug Fix,0,0,0,28,0.015927,0.0,0,0.0,1,1,0,0.92,0.0,1.0,45.43,13.13,1,0,0.0,0,184.3333,0,0,0,0,0,"Fix overcloud provisioning

Affects master & Victoria only.

Since Victoria, Bifrost added a play to gather facts for localhost at
the beginning of deploy-dynamic.yaml. Kayobe executes the playbook with
a limit, which does not include localhost. This causes fact gathering to
be skipped for localhost:

    PLAY [Gather facts on localhost] ***********************************
      skipping: no hosts matched

This change fixes the issue by adding localhost to the limit.

Story: 2008388
Task: 41311
[SEP]
FILES CHANGED:
ansible/overcloud-provision.yml (+1, -1)
",-1.269037,-1.565881,0.28872,-0.092509,-0.368559,-0.037309,-0.705522,0.167849,0.085103,0.333737,0.240574,-0.191626,0.276663,0.258172,-0.355761
openstack/kayobe,I7fa88a203274c3030b3d8e5208f94b2230d43c68,1,0,0,2.0794,0.0,2,19.0,191,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.9231,0.5917,3.0,9.44,22.34,0,0,0.0,1,23.875,0,0,0,0,0,"Fix /tmp/swift-rings/backups/ files deletion

Add permission escalation to the swift ring generation playbook

Task: 41256
Story: 2008354
[SEP]
FILES CHANGED:
ansible/roles/swift-rings/tasks/main.yml (+1, -0)
releasenotes/notes/story-2008354-0c34e2ad7aeb7d3d.yaml (+6, -0)
",-0.711277,-0.177876,-2.230308,-1.660224,0.763495,0.033872,0.287042,0.025549,0.228058,-0.160414,-0.248959,-0.165604,0.442566,0.391886,-0.178188
openstack/kolla,I303ee5367aba0ae114e52b7b559faf06133f2304,1,0,0,1.0986,0.5,1,7.0,165,0,Feature,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.7812,0.0,2.0,-48.03,19.94,1,0,0.0,0,55.0,0,0,0,0,0,"horizon: set FORCE_GENERATE to no if not set
[SEP]
FILES CHANGED:
docker/horizon/extend_start.sh (+1, -1)
",1.625881,0.271449,0.211811,0.695208,1.108722,0.809975,-0.348206,-0.728511,0.027463,0.404647,0.222495,-0.767439,-0.468114,-0.545722,-0.156998
openstack/kolla-ansible,Ib1a03772d0bd58758430b37b4f2f67126cf86fa3,1,1,1.0,2.1972,0.125,2,14.0,239,0,Bug Fix,0,0,0,4,0.043956,0.5,0,0.5,5,2,0,0.7429,0.8113,3.5,20.4,19.89,1,0,0.0,1,26.5556,0,6,0,6,0,"Monasca log-metrics - Drop ""notice"" and ""note"" loglevel metrics by default

Those loglevels can build up over time and create unnecessary high metrics cardinality.

Closes-bug: #1906796
[SEP]
FILES CHANGED:
ansible/roles/monasca/templates/monasca-log-metrics/log-metrics.conf.j2 (+1, -1)
releasenotes/notes/bug-1906796-e52b9e113f36ceed.yaml (+6, -0)
",-0.040721,-0.603144,-0.89844,0.358879,0.220121,-0.084264,-0.532352,-0.326958,-0.078773,-0.185604,-0.153404,0.132146,0.507215,-0.399237,0.239644
openstack/kolla-ansible,I7970c5b02f178fd8fb35c984117f6bc848353a5b,1,1,0.6818,2.1972,0.125,2,10.0,117,0,Bug Fix,0,0,0,22,0.013863,0.0,0,0.0,4,2,0,0.7465,0.8113,3.0,27.49,16.0,1,0,0.0,1,13.0,1,6,0,7,0,"Do not start swift-object-updater on stop

Closes-Bug: #1906944
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1906944-38798e1348ff9c97.yaml (+6, -0)
ansible/roles/swift/tasks/stop.yml (+1, -1)
",2.96007,0.977042,-0.008093,-0.720524,-0.776008,0.423375,0.250441,-0.291411,0.105336,-0.708989,0.693964,0.031694,0.149012,0.11975,0.550368
openstack/kolla,I2d67b3ed7b7c521bc755ec9a87365c9962a9eeff,1,1,1.0,3.1781,0.2174,3,3.0,509,0,Bug Fix,0,0,0,1,0.028571,0.6667,0,0.6667,2,2,0,0.7879,1.3016,2.0,-20.05,13.7,1,0,0.0,1,21.2083,0,14,0,9,0,"Support CentOS 8.3

Backport this until Train.

CentOS 8.3 renamed system repos. [1]
This caused failures when disabling and enabling.
More details in the referenced bug report.

Notice CentOS 8.2 and below will no longer work.

[1] https://wiki.centos.org/Manuals/ReleaseNotes/CentOS8.2011#Yum_repo_file_and_repoid_changes

Closes-Bug: #1907213
Co-Authored-By: Rados≈Çaw Piliszek <radoslaw.piliszek@gmail.com>
Depends-On: https://review.opendev.org/766211
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+4, -4)
releasenotes/notes/bug-1907213-e0cee8498d19a170.yaml (+13, -0)
",-2.92239,1.404103,0.43476,-0.548001,-0.938504,0.407776,-0.593107,0.467477,-0.097622,0.068893,0.32385,-0.018904,-0.014484,-0.023927,-0.340445
openstack/kolla,I835c18424153f8529a37fc78e16d2becacb71263,0,0,0.625,1.7918,0.2,3,9.0,153,0,Feature,0,0,0,8,0.079208,0.75,0,0.4688,2,2,0,0.7941,1.371,2.0,28.5,12.49,0,0,0.0,1,25.5,0,0,0,0,0,"centos: do not enable PowerTools repo in base

This repo is only needed for source openstack-base.
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+1, -0)
docker/base/Dockerfile.j2 (+0, -1)
kolla/template/repos.yaml (+3, -0)
",2.78394,-1.06737,0.263181,-0.231319,-0.455393,-0.400906,0.373212,0.137944,-0.604062,-0.467515,0.044435,0.127544,0.041297,0.078769,-0.590615
openstack/kolla,I916faee02f1387d08d786f2a74699bd613904280,1,0,0.5556,1.7918,0.8,1,8.5,140,0,Feature,0,0,0,9,0.084906,0.0,0,0.0,3,1,0,0.7714,0.0,3.0,48.91,12.81,0,0,0.0,0,23.3333,0,0,0,0,0,"freezer: drop EPEL

There is no 'trickle' package in EPEL8 so enabling it is useless.
[SEP]
FILES CHANGED:
docker/freezer/freezer-base/Dockerfile.j2 (+1, -4)
",1.620628,1.080664,-0.461875,0.65131,0.0191,0.810221,0.005263,-0.617875,-0.744941,0.24187,0.436163,0.295828,-0.270979,-0.392534,0.278741
openstack/kolla,I97308c74406d2af0e39b77eddef2693554381ab6,1,0,0.6,2.3979,0.8,1,33.0,238,0,Feature,0,0,0,10,0.09009,0.6,0,0.36,2,1,0,0.7778,0.0,2.0,16.96,19.26,0,0,0.0,0,21.6364,0,0,0,0,0,"centos: clean up repo enable/disable/keys

- install all 'centos-release-*' packages we need
- disable all repos in one place
- do not import CentOS keys - they are trusted by default
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+2, -8)
",1.183218,-0.317951,-0.148224,0.458319,0.379719,-0.874141,0.359268,-0.520754,-1.185124,-0.549908,-0.387136,-0.344028,0.766293,0.375988,-0.1111
openstack/kolla,Icfedd16ef9aed84e9f9be939e832c35e0d735efe,1,0,0.6957,0.6931,1.0,1,5.8,296,0,CI,1,0,0,23,0.01442,0.0,0,0.0,1,1,0,0.7838,0.0,1.0,-0.34,11.98,1,1,1.0,0,148.0,0,0,0,0,0,"[CI] Stop testing lower-constraints

This patch disables the lower-constraints job as it started
failing and we agreed during the PTG to drop it anyway. [1]

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-October/018445.html
[SEP]
FILES CHANGED:
.zuul.d/project.yaml (+0, -1)
",-0.318631,1.926092,-1.044049,0.716376,-1.105214,0.080363,0.765436,-0.129515,0.020367,0.415893,0.290064,-0.082557,0.281269,0.203445,-0.08579
openstack/kayobe,I9c6b0d9d5e13e8b82ebb8e8a3a0f432efb865e28,1,0,0.8276,3.5553,0.2647,4,18.33,399,0,Bug Fix,0,0,0,29,0.016477,1.0,0,0.8276,4,3,0,0.9259,1.6664,3.5,34.41,15.33,1,0,0.0,1,11.4,0,0,0,0,0,"Fix copying Swift ring files

Ring files are binary formatted and should not be templated. Attempting
to template them causes an error such as the following:

    Template source files must be utf-8 encoded

This change fixes the issue by implementing support for configuration
files that are listed as 'untemplated'.

Story: 2007297
Task: 38774
[SEP]
FILES CHANGED:
ansible/roles/kolla-openstack/tasks/config.yml (+16, -1)
releasenotes/notes/story-2007297-73f498ef6bc89fe9.yaml (+5, -0)
ansible/roles/swift-rings/files/swift-ring-builder.py (+1, -1)
ansible/roles/swift-rings/tasks/main.yml (+3, -7)
",-0.937024,-1.52011,-0.51547,0.37809,-0.24268,0.114897,-0.635454,-0.202367,0.28675,0.631682,-0.069714,-0.229862,0.431758,0.182348,-0.368789
openstack/kolla,Ia4aecd2fbe70d1760e0ddc401d06510914dbd1fb,1,0,0.7083,4.4886,0.5,2,11.6,346,0,Bug Fix,1,0,0,24,0.015038,0.0,0,0.0,1,1,0,0.7895,0.994,1.0,71.08,8.78,1,1,1.0,0,3.8876,0,0,0,0,0,"[CI] Slim down

Move all extra jobs to the experimental pipeline.
Cores should know when to test these extras.
This is to reduce the load when a fix is needed in the base image
or across all images.
Otherwise, due to how CI works, we incur the cost of running
all these jobs on each recheck.
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+20, -20)
.zuul.d/ubuntu.yaml (+24, -24)
",0.186125,-1.930367,0.166241,0.50097,-0.541889,0.298328,0.324428,-0.613785,-0.233887,0.20688,-0.372124,0.083717,0.218917,0.139833,-0.198183
openstack/kayobe,Ie8fd965165e8d347d27528a2c16d0647e412ccdc,1,0,0.8333,3.912,0.3469,6,5.66,1273,0,Bug Fix,0,0,1,30,0.016722,1.0,0,0.8333,4,4,0,0.9286,2.176,1.5,35.51,8.85,0,0,0.0816,1,25.46,0,0,0,0,0,"Fixes for CentOS 8.3

* Bump stackhpc.libvirt-host to v1.7.1. On seed-hypervisors installed
  using CentOS 8.2 or earlier, interaction with libvirt may fail due to
  libgcrypt being incompatible. See
  https://github.com/stackhpc/ansible-role-libvirt-host/issues/42

* Bump MichaelRigart.interfaces to v1.9.2. The CentOS 8.3 cloud image
  includes an ifcfg-ens3-1 file. See
  https://github.com/michaelrigart/ansible-role-interfaces/pull/93

* Previously a second libvirt daemon was installed by Tenks on the host,
  however changes in libvirt 6.0.0 to separate libvirtd into multiple
  daemons do not allow for customisation of the PID files used by the
  new daemons. This leads to a conflict between the container and host
  daemons. Update the Tenks config to use the containerised Nova libvirt
  daemon. This depends on a change to the stackhpc.libvirt-host role:
  https://github.com/stackhpc/ansible-role-libvirt-host/pull/44

* Not CentOS 8.3 related, but tox jobs are now failing on python
  dependencies. Remove upper limits from docker and paramiko.

* Not CentOS 8.3 related, but Bifrost has enabled authentication by
  default. We are not ready to support this, so override it.

Story: 2008429
Task: 41378
[SEP]
FILES CHANGED:
releasenotes/notes/centos-8.3-89d07c8f8db5b17b.yaml (+4, -0)
test-requirements.txt (+2, -2)
dev/tenks-deploy-config-compute.yml (+14, -6)
ansible/roles/kolla-bifrost/templates/bifrost.yml.j2 (+3, -0)
requirements.yml (+2, -2)
playbooks/kayobe-overcloud-upgrade-base/run.yml (+7, -7)
",-3.38168,2.018525,3.539947,-0.553744,-0.63827,0.108745,-0.030518,0.162538,-0.60911,-0.210423,-0.356726,0.49292,0.153752,-0.033758,0.231279
openstack/octavia,Ib089affa229531cd72f6853105d74b446687ae86,1,0,0.8,1.0986,0.5,1,25.0,185,0,Feature,0,0,0,5,0.050505,1.0,0,0.8,6,1,0,0.5167,0.0,6.0,56.25,14.8,1,0,0.0,0,61.6667,0,0,0,0,0,"Use 'bash' in the keepalived check script

Use bash instead of sh to avoid the error ""shopt: not found""

Story: 2008437
Task: 41399
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/keepalived_check_script.conf.j2 (+1, -1)
",1.178352,-0.689987,-0.450014,-0.487458,-0.184342,0.542469,-0.450515,-0.597964,-0.232281,-0.29713,0.081432,-0.044841,0.144367,0.38502,-0.12038
openstack/kolla,Iabe5b9684a7bf0e39a7dca824e6705b5069560bf,1,0,0.6364,1.6094,0.75,1,6.0,267,0,Feature,0,0,0,11,0.090909,0.5,0,0.3182,3,1,0,0.7949,0.0,3.0,-21.33,17.4,0,0,0.0,0,53.4,0,0,0,0,0,"elasticsearch-curator: drop botocore workaround

Curator got requirements sorted out upstream and builds fine now without
hack.

This reverts curator part of https://review.opendev.org/c/openstack/kolla/+/755339/
[SEP]
FILES CHANGED:
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+1, -3)
",-0.164258,0.839275,-1.058186,-0.317424,-1.014815,-0.1432,0.051799,-0.059848,-0.49074,-0.257308,-0.441614,-0.465985,-0.004977,-0.258413,0.191228
openstack/kolla-ansible,I6ad0256fb2a3cdc91dddf441e5e1c41f4ac69017,1,1,0.9091,0.6931,0.0,1,13.75,461,0,Bug Fix,0,0,0,11,0.039427,0.0,0,0.0,4,1,0,0.75,0.0,4.0,12.91,16.41,1,0,0.0,0,230.5,0,6,0,6,0,"Fix failure during Monasca Grafana upgrade

The task ""Stopping all Monasca Grafana instances but the first node""
can fail with:

    error while evaluating conditional (monasca_grafana_differs['result']): 'dict object' has no attribute 'result'

This is fixed by running this task on the same set of hosts than the
task defining monasca_grafana_differs, i.e. groups['monasca-grafana'].

Closes-Bug: #1907689
[SEP]
FILES CHANGED:
ansible/roles/monasca/tasks/upgrade.yml (+1, -0)
",-1.628409,-0.281525,-0.229002,0.305824,0.355261,0.1553,-0.309048,0.090857,0.072447,-0.164749,0.621167,-0.298673,-0.086226,0.165306,-0.32082
openstack/octavia-dashboard,I63729aecefb9763c49f19d69b7f1edf43a921cd3,0,0,0.0,4.0943,0.4576,4,3.75,216,0,Doc,0,0,0,1,0.000655,0.0,0,0.0,5,1,0,0.1304,1.8995,4.5,-78.97,22.83,1,0,0.0,0,3.6,0,0,0,0,0,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html
[SEP]
FILES CHANGED:
octavia_dashboard/locale/en_GB/LC_MESSAGES/djangojs.po (+17, -4)
releasenotes/source/locale/en_GB/LC_MESSAGES/releasenotes.po (+12, -7)
releasenotes/source/locale/de/LC_MESSAGES/releasenotes.po (+1, -7)
octavia_dashboard/locale/de/LC_MESSAGES/djangojs.po (+2, -9)
",-0.801902,3.149072,-1.483006,1.013018,-0.707281,0.457268,-0.409607,-0.452539,-0.017266,-0.120098,-1.100088,0.33791,-0.026385,0.030705,-0.277609
openstack/octavia-dashboard,Ia93cb7520ff9c179a27e72719f1fd10524c57acb,1,0,0,1.0986,0.5,1,20.5,314,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.125,0.0,4.0,29.21,17.96,1,0,0.0,0,104.6667,0,0,0,0,0,"Disable Load Balancers panel when Octavia service is not deployed

Currently Load Balancers panel is enabled based on 'network' service
defined in Keystone but it should refer to 'load-balancer' service
which is served by Octavia.

Story: #2008446
Task: #41413
[SEP]
FILES CHANGED:
octavia_dashboard/dashboards/project/load_balancer/panel.py (+1, -1)
",-0.980617,-0.439926,-1.00914,-0.692899,0.793705,-0.048876,0.450276,0.20933,0.170422,0.05703,0.196014,-0.122341,0.504424,0.198817,-0.301431
openstack/octavia,I1236d3c6231a657b2aa53b1e488a4d0fe3215070,1,0,0.6857,4.5643,0.0842,9,17.67,389,1,Feature,0,0,0,35,0.004138,0.4615,0,0.3165,7,2,0,0.519,2.7504,4.56,22.9,16.88,1,0,0.6632,1,4.0521,0,0,0,0,0,"Add validation for VIP network parameters in amphora driver

Some network parameters can be validated in the API, it would avoid to
handle exceptions in the worker when plugging networking resources.
This commit validates that port_security_enabled is True on the VIP
network when using the amphora driver.

Story: 2008449
Task: 41422
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+15, -0)
octavia/network/drivers/neutron/utils.py (+2, -1)
releasenotes/notes/validate-vip-network-params-57662cc3a99f80e5.yaml (+5, -0)
octavia/api/drivers/amphora_driver/v2/driver.py (+7, -0)
octavia/network/data_models.py (+3, -1)
octavia/network/drivers/noop_driver/driver.py (+4, -2)
octavia/tests/functional/api/v2/test_load_balancer.py (+29, -4)
octavia/api/drivers/amphora_driver/v1/driver.py (+7, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+15, -0)
",0.207084,-2.080129,0.080257,0.347744,-0.387285,-0.103575,0.077836,0.378684,0.467003,-0.217025,-0.237948,-0.00861,0.033099,-0.015615,-0.001631
openstack/kayobe,I82313fcd258e58969e0b68ae91a78943df537a7f,1,0,0.8387,2.1972,0.125,2,14.0,570,0,Bug Fix,0,0,0,31,0.01682,0.0,0,0.0,2,2,0,0.931,0.8113,1.5,48.6,13.22,0,0,0.0,1,63.3333,0,0,0,0,0,"Fix overcloud host image resolv workaround on CentOS 8.3

If a seed's bifrost_deploy container is deployed using a CentOS 8.2 base
image, prior to the CentOS 8.3 release, then a user runs 'kayobe seed
service deploy', the following task may fail:

    TASK [Ensure the overcloud host image has bogus name server entries removed]

This seems to be an issue with libgcrypt not being upgraded with
qemu-kvm, and becoming incompatible. The workaround is to ensure
libgcrypt is upgraded also.

Story: 2008430
Task: 41379
[SEP]
FILES CHANGED:
ansible/overcloud-host-image-workaround-resolv.yml (+1, -1)
releasenotes/notes/story-2008430-6a50101d05219aad.yaml (+6, -0)
",-0.890482,-1.250685,0.458809,-0.253798,-0.195823,-0.179013,0.364475,0.490988,-0.080418,0.035981,0.612021,0.002334,-0.230583,0.051677,0.068141
openstack/kolla-ansible,I867322ee43d509fe46b6afba9216586515fee0d5,1,0,0.72,2.3979,0.0,1,14.33,391,0,Doc,0,0,0,25,0.014846,0.5,1,0.36,3,1,0,0.7534,0.0,3.0,11.28,16.9,1,1,0.0,0,35.5455,0,0,0,0,0,"[docs] Add python3-venv package to quickstart.rst

Python virtual environment creation fails on a fresh system if
python3-venv is not installed (Debian/Ubuntu).

Installation instructions used to be in the Quick Start guide, but
were removed in kolla-ansible/+/735894

(cherry picked from commit 43a1e386e40a490b5477fe15a17de75c69fbc1ea)
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+10, -0)
",-0.787952,-0.197968,-0.874514,-0.896042,0.226261,-0.2648,1.128638,0.388802,-0.081881,0.267774,0.376933,-0.017916,0.275709,0.174713,-0.228665
openstack/kolla-ansible,I867322ee43d509fe46b6afba9216586515fee0d5,1,0,0.7308,2.3979,0.0,1,14.33,391,0,Doc,0,0,0,26,0.015348,0.6,1,0.4385,3,1,0,0.7568,0.0,3.0,11.28,16.9,1,1,0.0,0,35.5455,0,0,0,0,0,"[docs] Add python3-venv package to quickstart.rst

Python virtual environment creation fails on a fresh system if
python3-venv is not installed (Debian/Ubuntu).

Installation instructions used to be in the Quick Start guide, but
were removed in kolla-ansible/+/735894

(cherry picked from commit 43a1e386e40a490b5477fe15a17de75c69fbc1ea)
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+10, -0)
",-0.787952,-0.197968,-0.874514,-0.896042,0.226261,-0.2648,1.128638,0.388802,-0.081881,0.267774,0.376933,-0.017916,0.275709,0.174713,-0.228665
openstack/kolla,Iabacaeccdb360544125ad910d5c3f5f9d895dac5,1,0,0.6667,2.8332,0.125,1,10.0,153,0,Feature,0,0,0,12,0.096,0.0,0,0.0,3,1,0,0.8,0.0,3.0,40.18,12.0,0,0,0.0,0,9.0,0,0,0,0,0,"nova-compute: daxio on CentOS 8 is x86-64 only

I somehow missed that when it was sent for review.
[SEP]
FILES CHANGED:
docker/nova/nova-compute/Dockerfile.j2 (+14, -2)
",1.224134,-0.9142,-0.343938,-0.352744,-0.672962,-0.079849,0.089314,-0.27923,-1.025936,0.165677,0.227751,0.192306,-0.128352,-0.001927,0.033913
openstack/oslo.limit,I04a845fd98f0d21f7a21dae9f184117263390dd1,1,0,0.125,3.1781,0.7391,4,7.78,1151,0,Bug Fix,0,0,0,8,0.029091,0.8,0,0.1,0,3,0,0.0,1.7623,0.0,28.53,10.25,1,0,0.0,1,47.9583,0,0,0,0,0,"Fix requirements issues

This patch is the merge of 2 current fixes that need to be solved in the
same time. Indeed each issue lock our gates independently.

Dropping lower constraints testing

We facing errors related to the new pip resolver, this
topic was discussed on the ML and QA team proposed to
to test lower-constraints [1].

I propose to drop this test because the complexity and recurring pain needed
to maintain that now exceeds the benefits provided by this mechanismes.

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019390.html

Move flake8 as a pre-commit local target.

The goal here is to avoid conflicts between flake8 and hacking version each
2 days.

Inspired from nova's approach[1].

The flake8 version to install will be determined by hacking and
requirements[2] will stay aligned instead of relying on different versions.

[1] https://opendev.org/openstack/nova/src/branch/master/.pre-commit-config.yaml#L26-L35
[2] https://opendev.org/openstack/hacking/src/branch/master/requirements.txt#L1

Co-authored-by: Daniel Bengtsson <dbengt@redhat.com>
[SEP]
FILES CHANGED:
.zuul.yaml (+0, -1)
lower-constraints.txt (+0, -8)
tox.ini (+0, -6)
.pre-commit-config.yaml (+6, -2)
",-3.439578,1.600631,3.312648,-0.895018,-0.845456,0.315368,-0.279738,-0.075474,-0.26788,-0.123595,-0.554847,0.484643,-0.212383,-0.055176,-0.189823
openstack/kolla-ansible,Iec1a8bd9c98dbae03660259468d30ddf8667ff80,1,1,0.7407,3.1781,0.0,1,10.0,110,0,Bug Fix,0,0,0,27,0.015845,0.0,0,0.0,2,1,0,0.76,0.0,2.0,35.95,16.0,1,0,0.0,1,4.5833,0,14,0,17,0,"Add `issue` reno for bug #1904062

Related-Bug: #1904062
[SEP]
FILES CHANGED:
releasenotes/notes/issue-bug-1904062-ef446343323c8452.yaml (+23, -0)
",1.08555,1.081137,-0.199256,-0.471351,0.074228,1.305502,-1.301408,-0.158354,0.63015,0.531468,0.139247,-0.118627,-0.082826,0.345634,0.559221
openstack/kolla-ansible,I4c65a428facdf6d4ce28d97a868589aeae4c856e,1,0,0.75,4.5643,1.0,4,4.11,437,0,Feature,0,0,0,28,0.016213,1.0,0,0.75,1,3,0,0.7632,0.5062,0.5,-21.41,14.62,1,0,0.0211,1,4.5521,0,0,0,0,0,"Drop lower-constraints

Per our PTG resolution [1] and general OpenStack resolution [2], lower-constraints
are not worth the extra work and confusion they introduce.
This patch drops them along with all mentions.

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-October/018445.html
[2] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019521.html
[SEP]
FILES CHANGED:
lower-constraints.txt (+0, -87)
zuul.d/base.yaml (+0, -1)
zuul.d/project.yaml (+0, -1)
tox.ini (+0, -6)
",-2.271453,3.421856,-0.795564,1.263743,-0.217315,0.01941,0.661115,-0.161787,-0.181953,0.46472,0.052978,0.219018,0.468338,0.166167,-0.073652
openstack/kolla,I58807c27fd20c7269019e26e8b507744d35325f3,1,0,0.7586,4.585,1.0,3,4.11,437,0,Feature,0,0,0,29,0.015917,1.0,0,0.7586,1,3,0,0.8049,0.4166,0.33,-14.55,14.62,1,0,0.0103,1,4.4592,0,0,0,0,0,"Drop lower-constraints

Per our PTG resolution [1] and general OpenStack resolution [2], lower-constraints
are not worth the extra work and confusion they introduce.
This patch drops them along with all mentions.

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-October/018445.html
[2] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019521.html
[SEP]
FILES CHANGED:
.zuul.d/base.yaml (+0, -1)
lower-constraints.txt (+0, -90)
tox.ini (+0, -6)
",-2.271454,3.421856,-0.795564,1.263743,-0.217315,0.01941,0.661115,-0.161787,-0.181953,0.46472,0.052978,0.219018,0.468338,0.166167,-0.073652
openstack/kolla-ansible,Ifda71047ab041b4b9838e3480d6a301a43c1c156,1,0,0,1.0986,0.5,1,7.4,339,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.7662,0.0,4.0,4.97,12.69,0,0,0.0,0,113.0,1,0,0,0,0,"Use ansible_distribution_release instead of ansible_lsb.codename

ansible_lsb.codename fact needs lsb-release package installed but it absent in Debian 10 minimal install.
It's better to use ansible_distribution_release fact which contain the same value and don't need extra packages.
[SEP]
FILES CHANGED:
ansible/roles/baremetal/defaults/main.yml (+1, -1)
",-0.363746,0.50317,-0.738236,1.157288,0.987662,-0.70872,0.601773,-0.220435,-0.545502,-0.42642,0.241159,-0.394458,-0.521884,0.108035,0.039938
openstack/kayobe,I7360953c6b5b579392d746971df7200e998ed3ef,1,0,0.8438,1.0986,0.5,1,8.0,164,0,Bug Fix,0,0,0,32,0.017288,0.0,0,0.0,2,1,0,0.9333,0.0,2.0,34.8,13.2,0,0,0.0,1,54.6667,0,0,0,0,0,"Fix reno link

Fixes a link to storyboard in release note added in
Ibe44583cb93b7dca8f5091c893386a15288af915.
[SEP]
FILES CHANGED:
releasenotes/notes/fix-python-setup-5e7ff929a6cab092.yaml (+1, -1)
",0.227216,-0.641891,-1.925635,-2.294259,1.389994,0.330958,0.152544,-0.550004,0.089953,-0.081492,-0.688334,0.206984,-0.343467,-0.193614,-0.245179
openstack/oslo.messaging,I01a38754a31c891f2b3b9c7f8135690693df5d13,1,1,0.5,2.5649,0.5,1,11.8,386,0,Bug Fix,0,0,0,2,0.051282,0.4286,0,0.2143,2,1,0,0.3333,0.0,2.0,64.37,10.14,1,0,0.0,0,29.6923,0,6,0,7,0,"Fix type of direct_mandatory_flag opt

An IntOpt with a default of True is invalid. I'm a little surprised
this doesn't fail a defaults check somewhere, but it needs to be
fixed regardless.

Looking at where it is used, it appears the boolean type is correct.
This just changes the opt type to BoolOpt to match.

Closes-Bug: 1909036
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/impl_rabbit.py (+6, -6)
",0.213489,-1.566723,-0.270424,-0.102477,-1.05683,0.320153,0.473865,-1.083158,-0.117819,0.317514,0.687742,-0.554519,-0.034013,0.189835,0.193468
openstack/kolla-ansible,I86a13d2476644bfa2545a6737752cda1ade34d23,1,1,0.5714,2.7081,0.2143,4,6.75,449,0,Bug Fix,0,0,0,7,0.011164,0.5,0,0.2857,4,3,0,0.7692,1.7783,3.0,40.18,10.85,1,0,0.0,1,29.9333,0,6,0,9,0,"Fix dpdk deploy failed

This change fix ansible deploy ovs-dpdk failed and
neutron_openvswitch_agent container can't start..

dpdk_tunnel is a role variable, but kolla_address gets vaule
from hostvars. so we need remove this variable and it's friends
to group/all.yaml

neutron_openvswitch_agent connects to ovs-db with 127.0.0.1,
but ovs-db listen on management interface.

Closes-Bug: 1908850
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+3, -0)
ansible/roles/ovs-dpdk/templates/ovsdpdk-db.json.j2 (+1, -1)
ansible/roles/ovs-dpdk/defaults/main.yml (+0, -2)
releasenotes/notes/fix-dpdk-deploy-failed-6695899422a67359.yaml (+7, -0)
",-1.626383,-1.115858,0.145591,-0.341349,0.105216,-0.997566,-0.065986,0.324383,-0.54232,-0.437981,0.483245,-0.663246,-0.326566,0.452888,-0.061131
openstack/octavia-lib,I4d8de05aa8e7d0828957c33bda78038794621e95,1,0,0,3.0445,0.5,2,8.0,89,0,Feature,0,0,0,0,0.0,0.2857,0,0.0,2,1,0,0.0417,0.8813,2.0,-12.78,18.2,0,0,0.0,0,4.2381,1,0,0,0,0,"Remove unicode to adapt to Python3
[SEP]
FILES CHANGED:
doc/source/conf.py (+3, -3)
releasenotes/source/conf.py (+7, -7)
",3.016754,1.852269,1.667694,0.92739,0.883958,1.217357,0.573305,-0.167325,-0.600787,0.906049,-0.184559,0.068253,0.090881,-0.113919,0.366586
openstack/python-octaviaclient,Icd0e728afadade109ef018ef2ae540357bf74808,0,0,0.0,3.0445,0.5,2,6.0,79,0,Feature,0,0,0,2,0.222222,0.5,0,0.0,2,1,0,0.1026,0.8813,2.0,-67.15,22.4,0,0,0.0,0,3.7619,1,0,0,0,0,"remove unicode from code
[SEP]
FILES CHANGED:
doc/source/conf.py (+3, -3)
releasenotes/source/conf.py (+7, -7)
",3.499679,2.861966,1.727188,1.219716,1.460616,1.565541,0.786351,-1.09563,0.382248,-0.334166,0.004018,-0.326322,0.345299,0.81146,-0.272485
openstack/octavia-dashboard,I324d36a1e92c66556f73a839acbde425f669d2a3,1,0,1.0,2.9444,0.5,2,8.0,89,0,Feature,0,0,0,1,0.047619,0.3333,0,0.3333,2,1,0,0.16,0.9183,2.0,-23.36,18.2,1,0,0.0,0,4.6842,1,0,0,0,0,"Remove unicode to adapt to python3
[SEP]
FILES CHANGED:
doc/source/conf.py (+3, -3)
releasenotes/source/conf.py (+6, -6)
",2.876906,1.844776,1.637982,0.961187,0.973936,0.987987,0.748733,-0.481927,-0.503819,0.882981,-0.308464,0.023113,0.006162,-0.09645,0.512544
openstack/kolla-ansible,Ib0c96479c79ce3dfa7469a58b1ea8ca038defe1e,1,0,1.0,1.0986,0.5,1,5.5,150,0,Bug Fix,0,0,0,1,0.333333,0.5,0,0.5,4,1,0,0.7722,0.0,4.0,-83.31,20.38,1,0,0.0,0,50.0,0,0,0,0,0,"octavia: fix typo in defaults
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+1, -1)
",2.589249,1.078207,1.297086,-0.649074,0.049927,0.366116,-0.043095,-1.064089,-0.074099,0.099703,0.851053,-0.318665,0.689087,-0.443086,0.510022
openstack/kolla-ansible,Ib15c95bb72cf79e9e55945d757b248e06f5f4065,1,0,0.6667,4.7958,0.0417,5,26.0,699,0,CI,0,0,0,6,0.029126,0.5385,0,0.359,4,2,0,0.775,1.5655,3.2,27.51,18.86,1,0,0.0,1,5.7769,0,0,0,0,0,"Support explicit creation of Monasca Kafka topics

With this patch, Monasca no longer relies on automatic topic creation
in Kafka, and instead pre-creates all topics before bringing up the
containers. If the topic already exists then it will not be
changed, therefore existing users are not affected.

This patch allows per topic customisations, such as increasing the
number of partitions on particular topics and also works around
a race condition in automatic topic creation where multiple instances
of the same service could race to create a topic causing some of the
services to restart and throw an error before resuming normal
operation.
[SEP]
FILES CHANGED:
releasenotes/notes/add-kafka-topic-creation-for-monasca-c8fccf0b6117eca5.yaml (+9, -0)
ansible/group_vars/all.yml (+5, -0)
ansible/roles/kafka/defaults/main.yml (+0, -1)
ansible/roles/monasca/defaults/main.yml (+57, -1)
ansible/roles/monasca/tasks/bootstrap.yml (+44, -3)
",-1.518262,-1.630634,0.815016,0.836246,0.097251,0.092219,0.058034,-0.372576,0.169852,0.200295,-0.004286,0.296449,0.403717,-0.346516,-0.067642
openstack/kolla,I7ad2373327be29cd307db5ce4f7db022829e3b35,1,0,0.8182,1.6094,0.5,1,6.33,185,0,CI,0,0,0,11,0.076923,0.0,0,0.0,2,1,0,0.8095,0.0,2.0,-13.32,17.27,0,0,0.0,0,37.0,0,0,0,0,0,"Bump up rally and rally-openstack

New rally and rally-openstack versions released due to incompatibility
with latest oslo.config.
[SEP]
FILES CHANGED:
kolla/common/config.py (+2, -2)
",1.418546,0.590452,-0.169453,0.462735,0.498429,0.163496,0.562041,0.187028,-0.233867,-0.407045,0.092321,0.935089,0.026069,-0.031175,0.404496
openstack/octavia,I30e23ca13d033d77c8ebdabbfdc7b54556a9466b,1,0,0.2727,4.6052,0.1818,6,14.8,625,0,Bug Fix,0,0,0,11,0.010742,1.0,0,0.2727,6,3,0,0.5213,1.934,4.67,13.47,12.95,1,0,0.8081,1,6.25,0,0,0,0,0,"Fix operating status for empty UDP pools

Fix empty UDP pools status: a UDP pool without members went OFFLINE
instead of ONLINE.

This commit changes the keepalived configuration with empty pools:
the configuration now contains a virtual_server and a comment about the
existing pool. This comment is used by the get_udp_listener_pool_status
to detect that the pool exists and is not offline.

Story 2007984
Task 40610

Conflicts:
    octavia/tests/unit/common/sample_configs/sample_configs_combined.py

(cherry picked from commit 2954370e386d54a88763128e2dbfb9c4b2bca96d)
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/lvs/test_lvs_jinja_cfg.py (+44, -0)
octavia/common/jinja/lvs/templates/macros.j2 (+5, -7)
releasenotes/notes/fix-empty-udp-pool-status-3171950628898468.yaml (+5, -0)
octavia/amphorae/backends/utils/keepalivedlvs_query.py (+1, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+24, -8)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+2, -2)
",-2.278129,-0.780476,0.75288,-1.123738,0.195702,-0.060626,-0.004725,0.098554,0.31656,-0.424758,0.009769,-0.087883,-0.323729,0.316366,-0.212442
openstack/octavia,I6ce224d3f5413f1ba1f9972576ec51a89d249886,0,0,0.6944,1.3863,0.3333,2,16.0,308,0,Bug Fix,0,0,1,36,0.004209,0.125,1,0.0868,0,1,0,0.5236,0.9183,0.0,0.25,20.15,0,0,0.0,0,77.0,0,0,0,0,0,"Fix Ussuri requirements for Victoria grenade

Victoria grenade job is broken because diskimage-builder is missing
when deploying Ussuri.
A previous commit that fixed l-c and requirements incorrectly removed it
(Ia2b49128258b18653865622022e8877489f0087b)
[SEP]
FILES CHANGED:
requirements.txt (+1, -0)
lower-constraints.txt (+1, -1)
",-0.338464,-1.510372,-1.057323,-1.390519,0.745717,-0.050039,-0.132986,0.03705,-0.091899,0.034461,-0.390956,-0.023362,0.149051,-0.027595,-0.152162
openstack/kolla,I53e8ba8d4baa4434cf3c49ed94d1f7cb44099bee,1,1,0.8485,3.2189,0.3333,4,18.4,652,0,Bug Fix,0,0,0,33,0.017809,0.0,0,0.0,3,2,0,0.814,1.4284,3.0,41.03,15.19,0,0,0.0,0,26.08,0,4,0,10,0,"Add a storm-base image

Refactor storm image dependencies. Previously we had:

base -> storm -> monasca-thresh

Both storm and monasca-thresh images are final, and each includes a
footer. This causes issues when the footer expects to be at the end of
the image, or there to be only a single footer. In particular, since
I2592a736206eaec811290e9fbdbf2540c0518ffe, the footer used in CI jobs
reverts to the public package mirrors.

This change introduces a storm-base image, and refactors the dependency
chain:

base -> storm-base -> storm
base -> storm-base -> monasca-thresh

Related-Bug: #1902101
[SEP]
FILES CHANGED:
docker/monasca/monasca-thresh/Dockerfile.j2 (+1, -3)
docker/storm/storm-base/extend_start.sh (+0, -0)
docker/storm/storm/Dockerfile.j2 (+13, -0)
docker/storm/storm-base/Dockerfile.j2 (+2, -5)
",-1.805242,-0.996173,0.954801,-0.717362,0.43924,-0.102397,0.322708,0.156698,0.176991,-0.112727,0.280849,0.280359,0.222319,0.330326,-0.055549
openstack/kolla,I644e072a699dccd8f32a24e484ff6dab7b9b449d,1,0,0.7667,4.2195,0.5373,1,16.71,833,0,Bug Fix,0,0,0,30,0.015633,1.0,0,0.7667,2,1,0,0.8182,0.0,2.0,38.02,15.23,1,0,0.0,0,12.25,0,0,0,0,0,"Horizon: gentler `-o nounset` handling

When running with `-o nounset` since [1], the Horizon became quite
fragile to run as it started requiring all ENABLE_* environment
variables to be set upfront. Normally they are - via kolla-ansible.
However, when working with it outside of kolla-ansible or removing
services (like it was the case 3 times during the Wallaby cycle),
it creates needless issues (like having to wait for images to get
published for kolla-ansible gate or users bumping into irrelevant
incompatibilities [2]).

This patch makes sure all ENABLE_* environment variables default
to 'no' and are no longer required to be set when there is no
need to set them to 'yes'.

[1] 032804e5a0ddf89f7726880d1b57dd492d7d5c07
[2] https://bugs.launchpad.net/kolla/+bug/1911141
[SEP]
FILES CHANGED:
docker/horizon/extend_start.sh (+31, -36)
",-3.154406,-0.280572,2.201447,-0.970888,0.226982,0.005439,-0.023885,-0.279056,-0.285831,0.208154,0.018876,-0.115877,0.111817,-0.256614,0.01825
openstack/magnum,I76fedd34edec55f5a906a96672529ed15775f5da,1,0,0,3.1355,0.4091,5,32.0,332,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,1.0,1.6729,4.8,-15.99,24.05,1,0,0.0,1,14.4348,0,0,0,0,0,"Refix --registry-enabled

This fixes an issue with --registry-enabled that was previously fixed [1] but
somehow dropped after a refactoring [2]

[1] Change Ib93a7c0f761d047da3408703a5cf4208821acb33
[2] Change Ibbed59bc135969174a20e5243ff8464908801a23

Task: 41306
Story: 2008383
[SEP]
FILES CHANGED:
magnum/drivers/k8s_fedora_atomic_v1/templates/kubeminion.yaml (+2, -0)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubeminion.yaml (+2, -0)
magnum/drivers/common/templates/fragments/configure-docker-registry.sh (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/write-heat-params.sh (+2, -0)
magnum/drivers/common/templates/fragments/enable-docker-registry.sh (+6, -8)
",-1.420895,-0.595013,-1.185854,-1.503415,1.057383,0.316238,0.07893,-0.184893,-0.007931,0.758043,0.252926,-0.100639,0.43335,-0.020655,-0.075861
openstack/kolla,I0c4d5e1ea16c6677813a334b38b3a22ad811531d,1,0,0.8333,3.0445,0.0,1,8.0,85,0,Doc,1,0,0,12,0.081633,0.0,0,0.0,2,1,0,0.8222,0.0,2.0,18.94,13.2,0,0,1.0,0,4.0476,0,0,0,0,0,"CI: Use Docker proxy for pulls
[SEP]
FILES CHANGED:
tests/playbooks/pre.yml (+20, -0)
",3.623314,1.082128,1.783282,0.271716,-0.131759,0.42512,-0.300337,0.552748,-0.188768,0.177286,-0.171716,-0.587407,1.029975,-0.26219,-0.343754
openstack/magnum-ui,Idf74601b8efa195bae756005cc8f4b83400eac87,1,0,0,2.1972,0.125,2,6.0,227,0,Feature,0,0,0,0,0.0,0.0,0,0.0,6,2,0,0,0.8113,4.0,13.92,10.73,1,0,0.0,1,25.2222,0,0,0,0,0,"Default `floating_ip_enabled` to true in cluster template

This matches the default value in the Magnum API backend.
[SEP]
FILES CHANGED:
releasenotes/notes/bugfix-set-floating_ip_enabled-default_in-cluster-template-true-ce06118f0e6064ba.yaml (+6, -0)
magnum_ui/static/dashboard/container-infra/cluster-templates/workflow/workflow.service.js (+1, -1)
",1.712589,-0.496638,-0.358201,0.664509,-0.098431,0.557111,-0.147874,0.112392,0.937853,-0.266103,0.133049,0.072457,-1.102942,-0.290334,-0.489331
openstack/kolla,I44fcb6e11b729369b5e64bdeb64e9ca7c0142979,1,0,0.6923,2.3026,0.7778,1,9.33,196,0,Doc,0,0,0,13,0.092199,0.0,1,0.0,3,1,0,0.8261,0.0,3.0,43.27,12.3,0,0,0.0,0,19.6,0,0,0,0,0,"docs: drop Fedora info, mark Ubuntu one as Debian / Ubuntu

Newton release was long time ago. Time to retire info that we had Fedora
support.
[SEP]
FILES CHANGED:
doc/source/admin/image-building.rst (+2, -7)
",1.606633,-1.429449,-0.107429,-0.081102,-0.620464,0.491314,0.279638,-0.102837,-1.32896,0.038818,0.143994,0.199069,0.100244,0.124258,0.121636
openstack/kolla-ansible,I9437a049b24e5e613a7e66add481a8983b84867a,1,0,1.0,0.6931,0.0,1,16.2,599,0,Bug Fix,0,0,0,3,0.023622,0.0,0,0.0,4,1,0,0.7778,0.0,4.0,53.57,11.42,0,0,0.0,0,299.5,0,0,0,0,0,"Do not wait for grafana to start when kolla_action=config

Prior to this change it was not possible to generate the config
before deploying the services as you'd hit:

RUNNING HANDLER [Waiting for grafana to start on first node] *************************
Monday 18 January 2021  15:06:35 +0000 (0:00:00.182)       0:04:39.213 ********
skipping: [sv-h22a8-u19]
skipping: [sv-h22a5-u36]
FAILED - RETRYING: Waiting for grafana to start on first node (10 retries left).

This would never succeed as the service has not yet been deployed.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/grafana/handlers/main.yml (+1, -0)
",-2.240065,-0.616339,1.013879,-0.934578,-0.144572,0.19252,-0.210291,0.068468,-0.20114,0.291447,0.512509,-0.246481,0.313305,0.361468,-0.133881
openstack/kolla-ansible,Ife38237a308c87465d5ac3faf7d8de93fd49de4e,1,1,0,2.1972,0.25,3,15.5,341,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7805,1.5,3.33,21.9,13.94,1,0,0.0,1,37.8889,0,6,0,5,0,"Replace db-sock with db-nb-sock and db-sb-sock

--db-sock JSON-RPC socket name
--db-nb-sock OVN_Northbound db socket
--db-sb-sock OVN_Southbound db socket [1]
so should use db-nb-sock and db-sb-sock

Closes-bug: #1913031

[1] https://github.com/ovn-org/ovn/blob/master/utilities/ovn-ctl
[SEP]
FILES CHANGED:
ansible/roles/ovn/templates/ovn-nb-db.json.j2 (+1, -1)
releasenotes/notes/bug-1913031-e8b14c50e8a27d14.yaml (+4, -0)
ansible/roles/ovn/templates/ovn-sb-db.json.j2 (+1, -1)
",-2.507296,2.735697,-0.781071,0.76861,0.846348,-0.578983,-0.254581,0.101445,-0.48091,-0.362489,0.662984,-0.396488,0.112937,0.299624,0.214335
openstack/octavia,I1c5cb987945a7a465bfecfda399dfe93fc1b76bb,1,0,0.6757,4.3175,0.027,4,21.67,460,0,Feature,0,0,0,37,0.004324,0.5,0,0.3378,7,1,0,0.5211,1.974,6.0,18.25,21.59,1,0,0.4054,0,6.1333,0,0,0,0,0,"Validate listener protocol in amphora driver

Validate that the amphora driver supports the listener protocol when
receving a listener_create request.

It returns an UnsupportedOptionError exception to the user if the
amphora driver doesn't support a protocol that is defined in the API
(ex: SCTP is supported in the API in the Victoria release, but not in
the amphora driver).

Story: 2008545
Task: 41647
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+14, -1)
octavia/api/drivers/amphora_driver/v2/driver.py (+22, -0)
octavia/api/drivers/amphora_driver/v1/driver.py (+22, -0)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+14, -1)
",-0.49243,-1.240862,0.171048,0.754308,-0.138723,0.007213,0.010989,0.417568,0.529677,0.096401,0.22338,0.34124,-0.046291,0.263769,-0.052884
openstack/kolla-ansible,I2f832d73138b4c9f29e3c71e2463293eab71483a,1,0,1.0,1.0986,0.0,1,11.0,261,0,Bug Fix,0,0,0,4,0.03125,0.0,0,0.0,4,1,0,0.7831,0.0,4.0,36.72,12.88,0,0,0.0,0,87.0,0,0,0,0,0,"Fix ""Restart mariadb-clustercheck container"" during config gen

The handler was firing even when we were only generating config.
This is an issue because the services may not have been deployed.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/mariadb/handlers/main.yml (+2, -0)
",0.903018,-1.661624,-0.263516,-0.109943,-0.448889,0.288044,0.01071,-0.330284,-0.183786,-0.213852,0.324865,0.229461,-0.133043,0.305414,0.020888
openstack/kayobe,Ia885a226de30d72610dca2eb2f194cef10193095,1,0,0.9167,2.4849,0.2727,3,13.5,220,0,CI,0,0,0,12,0.042857,0.0,0,0.0,3,2,0,0.9355,1.4949,2.0,27.07,15.77,1,0,0.3636,1,18.3333,0,0,0,0,0,"Quote kolla limit when calling kolla-ansible

This is necessary for correctly passing limits containing special
characters such as ~ or &.

Story: 2008546
Task: 41651
[SEP]
FILES CHANGED:
kayobe/tests/unit/test_kolla_ansible.py (+2, -2)
releasenotes/notes/quote-kolla-limit-042422e69c008109.yaml (+5, -0)
kayobe/kolla_ansible.py (+1, -1)
",0.191509,-1.154941,-0.842922,-0.208649,0.177179,0.293083,-1.252838,-0.358449,0.027961,-0.069363,-0.139954,0.04624,0.326169,-0.209891,-0.368868
openstack/kayobe,I7fa88a203274c3030b3d8e5208f94b2230d43c68,1,0,0.8529,2.0794,0.0,2,24.0,260,0,Bug Fix,0,0,0,34,0.018114,1.0,0,0.8529,4,2,0,0.9375,0.5917,3.0,6.23,22.93,0,0,0.0,1,32.5,0,0,0,0,0,"Fix /tmp/swift-rings/backups/ files deletion

Add permission escalation to the swift ring generation playbook

Task: 41256
Story: 2008354
(cherry picked from commit f811d3148ac542f32b476146ffc791aa4ea72693)
[SEP]
FILES CHANGED:
ansible/roles/swift-rings/tasks/main.yml (+1, -0)
releasenotes/notes/story-2008354-0c34e2ad7aeb7d3d.yaml (+6, -0)
",-0.711277,-0.177876,-2.230308,-1.660224,0.763495,0.033872,0.287042,0.025549,0.228058,-0.160414,-0.248959,-0.165604,0.442566,0.391886,-0.178188
openstack/kolla-ansible,I15acbdf7d47b8b1e07eb9587462d8a3a0d7c40ef,0,0,0.7143,1.0986,0.5,1,6.0,114,0,CI,1,0,0,14,0.093333,0.0,0,0.0,1,1,0,0.7857,0.0,1.0,17.45,15.73,0,0,1.0,0,38.0,1,0,0,0,0,"CI: Use Python2 compatible pip

pip 21 requires Python 3.6+
[SEP]
FILES CHANGED:
tests/pre.yml (+1, -1)
",2.3312,-0.16381,0.831022,-0.745731,-0.310173,0.321276,-0.985239,1.054962,-0.571492,1.288214,-0.227026,0.150413,-0.32031,0.164857,0.542957
openstack/kolla,I4a13bbe959e3324f05d5cf78a3be2415eb2ba7ec,1,0,0.7742,1.9459,0.1667,2,7.0,146,0,Bug Fix,0,0,0,31,0.015609,0.0,0,0.0,3,2,0,0.8298,0.9183,2.5,-11.77,17.09,1,0,0.0,1,20.8571,1,0,0,0,0,"Fix Mistral source images to respect upper-constraints

Backport to all supported branches.
[SEP]
FILES CHANGED:
releasenotes/notes/mistral-respect-uc-77aea99b5c6506ba.yaml (+4, -0)
docker/mistral/mistral-base/Dockerfile.j2 (+1, -1)
",3.157559,-0.496069,0.85285,0.014959,-0.126521,0.347341,0.435848,0.482175,0.332521,-0.12775,-0.202317,0.287751,-0.101804,-0.409885,-0.140408
openstack/kolla,Id903880b121d87d75b7b14084b0961b9ce99deba,1,0,0.6667,2.0794,1.0,5,9.5,142,0,Doc,0,0,0,15,0.098684,1.0,0,0.6667,3,1,0,0.8333,2.2359,2.6,54.71,10.12,0,0,0.0,0,17.75,0,0,0,0,0,"docker: do not install pip again in images

We install pip in base image so why repeat?
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -1)
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+0, -2)
docker/openvswitch/openvswitch-netcontrold/Dockerfile.j2 (+0, -1)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+0, -1)
docker/telegraf/Dockerfile.j2 (+0, -2)
",2.4824,-0.983884,0.095465,-0.013365,-0.215239,-0.244161,0.682399,-1.156003,-1.591109,0.036774,0.3618,-0.706883,0.603505,0.398401,-0.215071
openstack/kolla,I543965a2741cebfa759576a4c75669a7bacd4208,1,0,0.6875,5.3706,0.4766,14,3.67,251,0,Feature,0,0,0,16,0.100629,1.0,0,0.6875,3,6,0,0.8367,2.9347,2.14,-16.08,14.19,1,0,0.0561,1,1.1674,0,0,0,0,0,"move to Debian 'bullseye'

Bullseye is now in hard freeze cycle and goes for release.

https://release.debian.org/bullseye/freeze_policy.html

Co-Authored-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-server/Dockerfile.j2 (+4, -0)
kolla/template/repos.yaml (+0, -2)
tests/templates/template_overrides.j2 (+1, -1)
docker/mariadb/mariadb-server/security_reset.expect.debian (+67, -0)
kolla/common/config.py (+2, -2)
kolla/image/build.py (+6, -10)
.zuul.d/debian.yaml (+6, -2)
doc/source/matrix_x86.csv (+3, -3)
doc/source/matrix_aarch64.csv (+4, -4)
docker/base/apt_preferences.debian (+1, -46)
docker/base/Dockerfile.j2 (+12, -2)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+2, -1)
docker/base/sources.list.debian (+3, -28)
kolla/tests/test_build.py (+1, -1)
",-1.57913,1.249615,-1.5317,-0.809743,0.194189,0.096918,0.856236,0.033241,-0.165375,0.021769,0.580978,-0.098345,0.123456,0.313067,-0.363066
openstack/kayobe,I25078e69acdf41a4ef9957f99fe5047de54b778d,1,0,0.9231,4.4773,0.4253,11,13.38,760,0,CI,0,0,0,13,0.044674,1.0,0,0.9231,4,3,0,0.9394,3.1916,1.73,38.29,13.95,1,0,0.0,1,8.6364,0,0,0,0,0,"Adapt to changes from the Bifrost Victoria release

The critical part of this commit is adapting code that was still
sourcing env-vars. This file was removed from Bifrost in the Victoria
release, breaking the `kayobe seed deployment image build` command.

The other changes are not yet breaking Kayobe:

1) Release notes claim that OpenStackClient is no longer installed when
   keystone is not enabled, but it appears to still be available. Use
   the ironic native baremetal command instead except in playbooks
   related to baremetal compute nodes (i.e. overcloud ironic).

2) The use of OS_CLOUD=bifrost-inspector is deprecated and should be
   replaced by OS_CLOUD=bifrost.

Story: 2008558
Task: 41696
[SEP]
FILES CHANGED:
ansible/overcloud-hardware-inspect.yml (+4, -4)
ansible/overcloud-bios-raid.yml (+2, -2)
ansible/overcloud-provision.yml (+4, -4)
doc/source/administration/seed.rst (+5, -10)
doc/source/deployment.rst (+4, -4)
ansible/overcloud-deprovision.yml (+3, -3)
doc/source/upgrading.rst (+4, -5)
releasenotes/notes/bifrost-victoria-fixes-eed49b088afdac5b.yaml (+19, -0)
ansible/overcloud-introspection-data-save.yml (+1, -1)
ansible/roles/dell-switch-bmp/handlers/main.yml (+3, -3)
ansible/seed-ipa-build.yml (+1, -1)
",-2.148764,-0.62177,1.484785,-0.14487,-0.258024,0.054554,0.118994,0.471347,-0.179189,-0.140874,0.520539,0.151859,-0.10906,-0.110834,0.034005
openstack/oslo.cache,Ibdc6015ac1a9812976c4f3d8a737f7245599553e,1,0,0.0,3.8918,0.0417,8,2.17,230,0,Feature,0,0,1,1,0.333333,0.8333,0,0.0,4,4,0,0.0,1.8425,1.38,-133.76,28.56,1,0,0.625,1,4.6939,0,0,0,0,0,"Add dogpile.cache.pymemcache backend

Depends-On: https://review.opendev.org/c/openstack/requirements/+/772684
[SEP]
FILES CHANGED:
oslo_cache/tests/functional/dogpile_cache_pymemcache/__init__.py (+0, -0)
requirements.txt (+1, -1)
test-requirements.txt (+1, -0)
oslo_cache/_opts.py (+1, -0)
oslo_cache/tests/functional/dogpile_cache_pymemcache/test_cache_backend.py (+29, -0)
.zuul.yaml (+8, -0)
lower-constraints.txt (+2, -1)
releasenotes/notes/add-dogpile.cache.pymemcache-backend-627d31a76013f8e1.yaml (+4, -0)
",-0.350742,3.622517,-1.835918,-0.0011,-0.969723,0.004323,-0.090231,-0.189647,-0.049915,-0.568209,-0.590116,-0.022037,-0.386703,-0.47258,0.053921
openstack/kayobe,I5efdbd52556721914fe69d7c6ba454b2c721b643,1,0,0.9286,1.0986,0.5,1,8.0,1052,0,Bug Fix,0,0,0,14,0.037037,0.75,0,0.6964,0,1,0,0.9412,0.0,0.0,11.19,12.87,1,0,0.0,0,350.6667,0,0,0,0,0,"Fix deployment image build in Victoria

In the Victoria release, deployment images fail to build with the
following error:

/opt/kayobe/venvs/ipa-build-dib/lib/python3.6/site-packages/diskimage_builder/lib/common-functions: line 343: element-info: command not found

This is caused by the virtualenv bin directory not being included in
PATH while executing code from common-functions, which results in the
element-info script not being found.

This doesn't happen in Ussuri because older versions of DIB were
activating the virtualenv automatically [1].

This doesn't happen in master because its upper constraints allow a
newer DIB which doesn't use element-info anymore.

The fix is to activate the DIB virtualenv, which is done since
stackhpc.os-images v1.10.1 [2]. Bump in master first then backport to
stable/victoria.

[1] https://review.opendev.org/c/openstack/diskimage-builder/+/734414
[2] https://github.com/stackhpc/ansible-role-os-images/releases/tag/v1.10.1

Story: 2008550
Task: 41673
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
",-3.049529,1.614675,3.002098,-1.055892,-0.758209,-0.264384,-0.071299,0.204545,-0.230852,-0.39153,-0.448801,0.20754,-0.176917,0.070722,0.085958
openstack/python-octaviaclient,Ide7650da79c7c9e677ba392992de665797d5d52d,0,0,0.6842,3.0445,0.5,3,10.0,126,0,Bug Fix,0,0,1,38,0.004403,0.2105,1,0.144,0,1,0,0.1,0.9219,0.0,-23.27,24.0,0,0,0.1,0,6.0,0,0,0,0,0,"Fix lower-constraints job

Bump some lower-constraints and requirements
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
test-requirements.txt (+1, -1)
lower-constraints.txt (+8, -8)
",0.751889,0.722446,-0.364312,1.071422,1.756205,-0.189734,-0.357167,-0.452156,-0.255572,-0.035989,-0.28756,0.364695,0.629244,0.260843,0.268422
openstack/kolla-ansible,I855dfef33aa0f3fd1301295bb8ede3e587e7162a,0,0,0.7812,6.8276,0.8254,64,10.83,994,0,Bug Fix,0,0,0,32,0.016064,0.5,0,0.3906,4,3,0,0.7765,5.8801,3.94,23.39,13.87,1,0,0.0,1,1.0769,1,0,0,0,0,"Refactor services' check-containers and optimise

This might fix some hidden bugs where the check tasks forgot to
include params important for the service.

We also get a nice optimisation by using a filtered loop instead
of task skipping per service with 'when'. As proven in
https://review.opendev.org/c/openstack/kolla-ansible/+/914997

This refactoring allows for further optimisation and
fixing work to proceed with much less hassle. Including getting
rid of many notify statements as the restarts are now safely handled
by check-containers. Some notifies had to stay, because of special
edge cases eg. in rolling upgrades and loadbalancer config.

One downside is we remove the little optimisation for Zun that
ignored config change for copying loopback but this is an
acceptable tradeoff considering the benefits above.

Co-Authored-By: Roman Krƒçek <roman.krcek@tietoevry.com>
Partially-Implements: blueprint performance-improvements
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/check-containers.yml (+2, -14)
ansible/roles/nova-cell/tasks/check-containers.yml (+2, -18)
ansible/roles/nova-cell/defaults/main.yml (+2, -0)
ansible/roles/opensearch/tasks/check-containers.yml (+2, -14)
ansible/roles/kuryr/tasks/check-containers.yml (+2, -15)
ansible/roles/redis/tasks/check-containers.yml (+2, -14)
ansible/roles/common/tasks/check-containers.yml (+2, -14)
ansible/roles/venus/tasks/check-containers.yml (+2, -13)
ansible/roles/ovs-dpdk/tasks/check-containers.yml (+2, -13)
ansible/roles/masakari/tasks/check-containers.yml (+2, -14)
ansible/roles/openvswitch/tasks/check-containers.yml (+2, -14)
ansible/roles/cinder/tasks/check-containers.yml (+2, -16)
ansible/roles/neutron/tasks/check-containers.yml (+2, -15)
ansible/roles/trove/tasks/check-containers.yml (+2, -13)
ansible/roles/magnum/tasks/check-containers.yml (+2, -14)
ansible/roles/octavia/tasks/check-containers.yml (+2, -13)
ansible/roles/mistral/tasks/check-containers.yml (+2, -13)
ansible/roles/nova-cell/tasks/external_ceph.yml (+0, -6)
ansible/roles/ovn-controller/tasks/check-containers.yml (+2, -12)
ansible/roles/cloudkitty/tasks/check-containers.yml (+2, -13)
ansible/roles/nova/tasks/check-containers.yml (+2, -17)
ansible/roles/blazar/tasks/check-containers.yml (+2, -13)
ansible/roles/ironic/tasks/check-containers.yml (+2, -16)
ansible/roles/aodh/tasks/check-containers.yml (+2, -13)
ansible/roles/heat/tasks/check-containers.yml (+2, -13)
ansible/roles/ceilometer/tasks/check-containers.yml (+2, -14)
ansible/roles/manila/tasks/check-containers.yml (+2, -14)
ansible/roles/watcher/tasks/check-containers.yml (+2, -13)
ansible/roles/mariadb/handlers/main.yml (+0, -2)
ansible/roles/grafana/tasks/check-containers.yml (+2, -12)
ansible/roles/multipathd/tasks/check-containers.yml (+2, -13)
ansible/roles/skyline/tasks/check-containers.yml (+2, -13)
ansible/roles/telegraf/tasks/check-containers.yml (+2, -13)
ansible/roles/etcd/tasks/check-containers.yml (+2, -13)
releasenotes/notes/refactor-container-check-27624449c47f5e6e.yaml (+23, -0)
ansible/roles/gnocchi/tasks/external_ceph.yml (+0, -4)
ansible/roles/letsencrypt/tasks/check-containers.yml (+2, -14)
ansible/roles/hacluster/tasks/check-containers.yml (+2, -24)
ansible/roles/cinder/tasks/external_ceph.yml (+0, -6)
ansible/roles/mariadb/tasks/check-containers.yml (+2, -14)
ansible/roles/designate/tasks/check-containers.yml (+2, -13)
ansible/roles/ovn-db/tasks/check-containers.yml (+2, -12)
ansible/roles/memcached/tasks/check-containers.yml (+2, -14)
ansible/roles/rabbitmq/tasks/check-containers.yml (+2, -14)
ansible/roles/prometheus/tasks/check-containers.yml (+2, -14)
ansible/roles/barbican/tasks/check-containers.yml (+2, -13)
ansible/roles/glance/tasks/external_ceph.yml (+0, -4)
ansible/roles/zun/tasks/check-containers.yml (+2, -17)
ansible/roles/collectd/tasks/check-containers.yml (+2, -13)
ansible/roles/tacker/tasks/check-containers.yml (+2, -13)
ansible/roles/zun/handlers/main.yml (+2, -11)
ansible/roles/gnocchi/tasks/check-containers.yml (+2, -13)
ansible/roles/iscsi/tasks/check-containers.yml (+2, -14)
ansible/roles/glance/tasks/check-containers.yml (+2, -15)
ansible/roles/horizon/tasks/check-containers.yml (+2, -14)
ansible/roles/influxdb/tasks/check-containers.yml (+2, -12)
ansible/library/kolla_container.py (+2, -0)
ansible/roles/manila/tasks/external_ceph.yml (+0, -4)
ansible/roles/keystone/tasks/check-containers.yml (+2, -13)
ansible/roles/designate/tasks/backend_external.yml (+0, -4)
ansible/roles/placement/tasks/check-containers.yml (+2, -17)
ansible/roles/zun/tasks/external_ceph.yml (+0, -4)
ansible/roles/cyborg/tasks/check-containers.yml (+2, -14)
ansible/roles/service-check-containers/tasks/main.yml (+30, -0)
",-2.035996,-0.725972,2.710505,-0.869433,-0.948578,-0.077017,0.325295,-0.105081,-0.082801,-0.360914,-0.150201,0.041487,0.110186,-0.318783,0.108301
openstack/kolla,Ic638516eb92d24ad247a7866fd1b5e2ac0400388,1,1,0.7576,3.4657,0.0323,3,10.5,302,0,Bug Fix,0,0,0,33,0.011325,1.0,0,0.7576,2,2,0,0.84,1.0332,1.67,33.02,13.72,1,0,0.7419,1,9.4375,1,6,0,5,0,"Make kolla_set_configs open files in binary mode

This fixes comparisons when files are not Unicode-encoded.

A relevant unit test is included.
It can be used as a base for other _cmp_file method unit tests
if the need arises.

Closes-Bug: #1913952
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+1, -1)
releasenotes/notes/bug-1913952-a23431cef137f9c7.yaml (+6, -0)
tests/test_set_config.py (+23, -0)
",-0.147092,-2.099493,-0.318542,-0.145549,-0.503674,-0.046696,-0.606487,-0.216653,0.312713,0.247512,-0.151045,-0.445043,-0.051385,-0.165339,-0.071448
openstack/kolla,I4d20f23a9b26364943bf967908255d82c8f6621b,1,0,0.7059,4.382,0.7722,2,10.0,92,0,Feature,0,0,0,17,0.045576,0.0,0,0.0,3,1,0,0.8431,0.8859,3.0,61.33,8.0,0,0,0.0,0,1.15,0,0,0,0,0,"get rid of traces of CentOS 7 support
[SEP]
FILES CHANGED:
docker/nova/nova-base/Dockerfile.j2 (+12, -43)
docker/nova/nova-libvirt/Dockerfile.j2 (+6, -18)
",1.618744,1.325284,1.011086,0.584908,0.958323,1.234691,0.033117,-0.670808,-0.575895,0.423476,-0.182479,-0.044968,0.414896,-0.43375,0.449117
openstack/kolla-ansible,I073d04319b510182f5c1478e728c0c5bcc8799f1,1,0,0,3.434,0.0667,5,9.0,246,0,Feature,0,0,0,0,0.0,0.6667,0,0.0,4,4,0,0.7674,2.0757,3.2,15.97,15.45,1,0,0.0,1,7.9355,0,0,0,0,0,"Add Neutron DHCP agent to OVN networking setup

This commit adds possibility to deploy Neutron's DHCP agents in OVN
networking scenario.

Co-Authored-By: Micha≈Ç Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron.conf.j2 (+1, -1)
ansible/roles/neutron/defaults/main.yml (+6, -1)
releasenotes/notes/ovn-neutron-dhcp-agent-21aaafe5e1cda501.yaml (+6, -0)
etc/kolla/globals.yml (+3, -0)
doc/source/reference/networking/neutron.rst (+12, -0)
",-0.960825,0.632262,-1.548634,0.837336,0.122685,0.342102,-0.322378,0.817218,-0.054721,-0.462054,0.479705,0.726924,0.053704,0.038435,-0.530756
openstack/oslo.cache,I8c7f9291652a58b8291c3df90571501eed43bf18,1,0,0.5,4.2767,1.0,2,8.0,466,0,CI,0,0,0,4,0.030303,0.359,0,0.1795,0,2,0,0.5,0.3675,0.0,32.54,12.49,1,0,0.0,1,6.4722,0,0,0,0,0,"Dropping lower constraints testing.

We facing errors related to the new pip resolver, this
topic was discussed on the ML and QA team proposed to
to test lower-constraints[1].

I propose to drop this test because the complexity and recurring pain needed
to maintain that now exceeds the benefits provided by this mechanismes.

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019390.html
[SEP]
FILES CHANGED:
lower-constraints.txt (+0, -66)
tox.ini (+0, -5)
",-0.639735,-0.237436,0.046566,0.289598,-1.205271,-0.194889,0.49786,0.381717,0.136268,0.425875,-0.071784,0.094141,-0.023734,-0.113507,-0.145757
openstack/kolla,Ia678cd43b5ce53aee528674280f674c596a278ff,0,0,0.7222,2.3979,0.7,2,3.0,235,0,CI,0,0,0,18,0.039823,0.6667,0,0.4815,2,2,0,0.8462,0.469,2.0,45.87,11.87,0,0,0.0,1,21.3636,1,0,0,0,0,"Debian: use libvirt 7.0.0 from Linaro OBS repository

Nova requires libvirt 6.0.0 or newer in Wallaby. So I backported 7.0.0
from Debian 'testing'.

AArch64 and x86-64 are covered.
[SEP]
FILES CHANGED:
docker/base/apt_preferences.debian (+2, -7)
kolla/template/repos.yaml (+1, -0)
",0.465262,-0.646762,-0.421248,-0.188997,-0.465592,0.115882,-0.353354,0.966822,-0.775006,0.807296,-0.246855,0.144083,-0.386699,0.266453,0.197446
openstack/octavia,I6dd8e99b07ff557674871cb503dece96a9df3ada,1,0,0.6667,2.0794,0.0,1,31.0,688,0,Feature,0,0,0,39,0.004509,0.0,0,0.0,6,1,0,0.5234,0.0,6.0,-2.02,23.58,0,0,0.0,1,86.0,1,0,0,0,0,"Disable auto configuration of new interfaces in NetworkManager

NetworkManager in Centos images configures new network devices as soon
as they appear in the default namespace, it means that we might have
conflicts between the management interface's routes and address and the
new VIP or member interfaces' routes and addresses during a small period
of time before they are moved to the amphora-haproxy namespace.

Now, the ""no-auto-default=*"" option is enabled in NetworkManager, it
disables the configuration of new interfaces, while the management
interface is still enabled/configured through cloud-init.

Story 2008599
Task 41773
[SEP]
FILES CHANGED:
elements/amphora-agent/static/etc/NetworkManager/conf.d/no-auto-default.conf (+7, -0)
",-1.172806,-1.906332,0.795354,0.337755,0.02887,-0.457196,0.054978,0.386471,0.186601,-0.155257,-0.103399,0.334915,0.074459,0.136277,0.034267
openstack/octavia,If2841720009c2e402127e2e0080efdd56b68f6c9,1,0,0.675,1.3863,0.6667,1,18.0,403,0,Feature,0,0,0,40,0.004621,0.5,0,0.3375,1,1,0,0.5256,0.0,1.0,33.47,13.87,0,0,0.0,0,100.75,0,0,0,0,0,"Configure rsyslog on Octavia service nodes in devstack

{admin,tenant}_log_targets options are configured with
MGMT_PORT_IP in devstack, which contains the IP address
of the local management interface. In multinode setup,
it means that the second node should run a rsyslog
service to receive logs from amphorae that have been
spawned by its worker.
[SEP]
FILES CHANGED:
devstack/plugin.sh (+1, -2)
",0.188935,-1.721701,0.323605,0.620052,0.065584,-0.926718,0.752806,0.776377,0.488506,-0.494369,-0.071009,-0.343241,-0.345682,0.230518,-0.201591
openstack/kolla,Ice125e101a689fd3df9d1cd9a093a026f9747a3e,1,0,0.6842,2.4849,0.5455,4,6.0,468,0,Bug Fix,0,0,0,19,0.041126,1.0,0,0.6842,3,4,0,0.8302,1.9808,2.25,46.93,9.67,0,0,0.0,0,39.0,0,0,0,0,0,"Fix several issues (Train)

* sensu: drop Ubuntu support

  Upstream removed Ubuntu repositories.

  Train/Stein only

* Bifrost: pin IPA builder to 2.4.0

  Train & earlier

  IPA builder master branch now requires diskimage-builder 3.4.0, but
  Python 2 is supported only up to DIB 2.38.

  This change works around the issue by pinning IPA builder to 2.4.0,
  which has a Python 2 compatible dependency on DIB.
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -2)
doc/source/matrix_x86.csv (+1, -1)
docker/bifrost/bifrost-base/build_arg.yml (+3, -0)
docker/base/sources.list.ubuntu (+0, -3)
",-0.670212,-0.952823,0.590359,-0.117018,-0.231308,-0.133371,0.08428,1.104547,-0.55029,0.940707,-0.005967,-0.025567,0.139536,0.267952,0.33849
openstack/kolla-ansible,I6b8f5807ebb746428a501dca13eae30763dede8d,1,1,0,2.0794,0.1429,2,4.55,543,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7701,0.8631,3.0,-27.89,17.82,1,0,0.0,1,67.875,0,8,0,13,0,"Correctly configure S3 Token Middleware for Swift

According the documentation [1] there need to configure auth_uri in the
[filter:s3token] section instead of www_authenticate_uri which cause an
error 'swift.common.wsgi.ConfigFileError: Invalid auth_uri; must
include scheme and host' during start the swift-proxy-server container.

1. https://docs.openstack.org/swift/ussuri/middleware.html#s3-token-middleware

Closes-Bug: 1862765
[SEP]
FILES CHANGED:
ansible/roles/swift/templates/proxy-server.conf.j2 (+1, -1)
releasenotes/notes/bug-1862765-a6cad9fd2d3f0f48.yaml (+5, -0)
",-0.824148,1.165628,-0.098143,0.255336,-0.402366,-0.632994,0.237235,0.602714,0.661992,-0.104065,0.191162,-0.320277,-0.056721,-0.047325,-0.157135
openstack/kolla-ansible,I5b47a146627d06bb3fe4a747c5f20290c726b0f9,1,1,0.8571,2.1972,0.0,2,12.43,636,0,Bug Fix,0,0,0,35,0.018577,1.0,0,0.8571,2,2,0,0.7727,0.8113,1.5,48.36,11.87,0,0,0.0,1,70.6667,0,6,0,18,0,"Fix installation with pip install --user

If kolla-ansible is installed via pip install --user, currently the
kolla-ansible script is unable to locate the installed playbooks.
This leads to a failure when running commands.

This change fixes the issue by checking for the user's .local directory
as a possible installation path.

This fixes some of the scenario tests which were failing after switching
to a user installation in Ifaf1948ed5d42eebaa62d7bad375bbfc12b134d5.
Most tests did not fail since the kolla-ansible script in the source
checkout was used.

Closes-Bug: #1915527
[SEP]
FILES CHANGED:
releasenotes/notes/fix-pip-install-user-5f871f67433e465a.yaml (+6, -0)
tools/kolla-ansible (+2, -0)
",-1.826559,-1.310375,0.419074,-0.567174,0.203784,-0.259289,0.524346,0.051282,0.07415,0.116901,0.550297,0.176232,0.105067,0.069643,0.056943
openstack/kayobe,Id5ed0b594d6270c4a03606caa776bbb291be2694,1,0,0.9333,3.7136,0.75,2,10.0,105,0,Doc,0,0,0,15,0.039474,0.0,0,0.0,4,2,0,0.9429,0.469,3.0,19.03,16.0,1,0,0.0,0,2.561,0,0,0,0,0,"Update IPA docs and test build with extra-hardware
[SEP]
FILES CHANGED:
doc/source/configuration/reference/ironic-python-agent.rst (+7, -29)
playbooks/kayobe-seed-base/overrides.yml.j2 (+3, -1)
",3.011297,-0.018726,1.511581,0.238495,0.45663,-0.517088,0.34489,0.787755,-0.088413,-0.262153,-1.172679,-0.177959,0.340659,-0.057674,-0.254343
openstack/kolla-ansible,Ie8cc228198651c57f8ffe3eb060875e45d1f0700,1,0,1.0,3.5553,0.0294,3,15.33,432,0,Feature,0,0,0,2,0.181818,0.0,0,0.0,4,3,0,0.7753,1.4887,3.33,-9.19,17.44,1,0,0.0,1,12.3429,0,0,0,0,0,"Add way to change weight of haproxy backend per service

This patch adding option to control weight of haproxy
backends per service via host variable.

Example:

[control]
server1 haproxy_nova_api_weight=10
server2 haproxy_nova_api_weight=2 haproxy_keystone_internal_weight=10
server3 haproxy_keystone_admin_weight=50

If weight is not defined, everything is working as before.
[SEP]
FILES CHANGED:
doc/source/reference/high-availability/haproxy-guide.rst (+17, -0)
releasenotes/notes/haproxy-service-backend-weight-e4a908f732a37b42.yaml (+10, -0)
ansible/roles/haproxy-config/templates/haproxy_single_service_split.cfg.j2 (+6, -1)
",-2.065549,-0.294988,-0.397251,0.656077,1.231772,-0.520643,-0.855306,0.298401,0.192967,-0.083134,-0.182824,-0.515019,0.127779,0.02222,-0.098783
openstack/magnum,I10a6a4d72e9ec635f2c73d9fe64a8d136228f532,0,0,0.8462,5.3132,0.0347,7,5.8,270,0,Feature,0,0,0,13,0.077844,1.0,0,0.8462,4,3,0,1.0,2.2994,3.43,11.33,11.98,1,0,0.0644,1,1.33,0,0,0,0,0,"Support extra_network and extra_subnet labels

This allows users to add extra network interface to cluster nodes, e.g.
storage network.

Story: 2002448
Task: 21983
Co-Authored-By: Bharat Kunwar <bharat@stackhpc.com>
[SEP]
FILES CHANGED:
doc/source/user/index.rst (+22, -1)
magnum/tests/unit/drivers/test_template_definition.py (+13, -0)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubeminion.yaml (+63, -2)
magnum/drivers/heat/k8s_fedora_template_def.py (+2, -1)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubecluster.yaml (+27, -1)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubemaster.yaml (+62, -2)
releasenotes/notes/extra-network-interface-68bc169cb467a13e.yaml (+6, -0)
",-0.555607,0.630172,-1.068286,0.024476,-0.21437,0.124279,-0.604703,0.092281,0.26433,-0.239307,0.185703,0.146974,0.304653,0.420797,-0.714688
openstack/kayobe,Idbe57e7edc3fae25153f5e24ad6b7847b1c4660c,1,0,0.9375,3.1781,0.087,6,15.33,369,0,Feature,0,0,0,16,0.038095,1.0,0,0.9375,4,4,0,0.9444,2.4518,2.17,16.55,14.83,1,0,0.0,1,15.375,0,0,0,0,0,"Add ipa_build_upper_constraints_file variable

This variable allows to customise the upper constraints file used to
install packages inside the ipa-build-dib virtual environment. This can
be used when we need a newer version of diskimage-builder than the one
available in upper constraints for the current release.
[SEP]
FILES CHANGED:
doc/source/configuration/reference/ironic-python-agent.rst (+4, -0)
ansible/group_vars/all/ipa (+4, -0)
ansible/overcloud-ipa-build.yml (+1, -1)
releasenotes/notes/ipa-build-upper-constraints-5686abaa161b0d94.yaml (+7, -0)
ansible/seed-ipa-build.yml (+1, -1)
etc/kayobe/ipa.yml (+4, -0)
",-0.108662,-0.533373,-0.392912,1.043941,0.30433,-0.571364,0.240747,0.197837,0.515817,-0.266172,-0.407823,0.372612,-0.478228,0.087358,0.019776
openstack/magnum,Ia148b2d3bc352e96e7633f7af82ecd26b5f35e35,1,0,0,4.4188,0.2683,3,11.25,317,0,CI,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.6667,1.333,2.67,37.5,13.39,1,0,0.5488,0,3.8193,0,0,0,0,0,"Re-factored rpc serializer

This patch cleans up the current rpc
implementation by moving the seralizer
back to the rpc module, this is more in
line with other projects; such as Nova.

- Moved _init_serializer back into rpc.
- Added back unit-tests for profiler.
[SEP]
FILES CHANGED:
magnum/common/rpc.py (+8, -0)
magnum/tests/unit/common/test_rpc.py (+43, -2)
magnum/common/rpc_service.py (+9, -20)
",0.370944,-1.333121,0.02618,0.29267,-0.268827,-0.414266,0.091807,0.198307,-0.29083,-0.266502,-0.258047,0.053704,-0.227996,0.147842,0.423884
openstack/octavia,I41033e8cd9710a91b9502db11577b1f1cb85fa46,0,0,0.6829,5.2257,0.0486,2,11.0,233,0,Doc,0,0,0,41,0.004734,0.0,0,0.0,4,2,0,0.5278,0.2806,3.5,57.23,12.88,0,0,0.9514,0,1.2527,0,0,0,0,0,"Add test coverage for SCTP health checker script

Also removed a block of shell code in install-ubuntu.rst,
because the block triggered an error in the doc job and it was unused.
[SEP]
FILES CHANGED:
doc/source/install/install-ubuntu.rst (+0, -9)
octavia/tests/unit/cmd/test_health_checker.py (+176, -0)
",1.210747,-1.373962,0.062339,-0.060585,-0.755959,0.030786,0.742088,-0.312104,-0.284526,-0.430132,0.236919,-0.049101,-0.238337,0.581923,0.200048
openstack/oslo.db,I07b577f4e948c03d1751145e5f898b90ac1c197a,0,0,1.0,4.2047,1.0,2,12.0,161,0,Feature,0,0,0,2,0.153846,0.375,0,0.375,0,2,0,0,0.3871,0.0,4.31,18.13,0,0,0.0,1,2.403,0,0,0,0,0,"Remove lower-constraints remnants

These were missed in change : Icd090cf8a36fa560bf7b0c67d0e1c4923c221c65
[SEP]
FILES CHANGED:
lower-constraints.txt (+0, -61)
tox.ini (+0, -5)
",0.071405,-0.64143,-2.37887,-2.313668,1.617581,0.537018,0.394968,-0.752311,0.325271,0.081405,-0.669625,0.729005,-0.209672,-0.116945,-0.22292
openstack/octavia,I196e13996ce4bce93d9a8eed87f6c3cb8ef3cea1,0,0,0.6667,2.3026,0.0,8,7.75,281,0,Bug Fix,0,0,0,42,0.004748,1.0,0,0.6667,4,1,0,0.5253,2.9477,3.12,-5.71,16.0,0,0,0.0,0,28.1,0,0,0,0,0,"Fix pep8 errors

pylint 2.7.0 added additional checks for inconsistent-return-statements:
- inconsistent-return-statements message is now emitted if one of
  try/except statement is not returning explicitly while the other do.
[SEP]
FILES CHANGED:
octavia/common/utils.py (+1, -0)
octavia/common/policy.py (+1, -0)
octavia/controller/worker/v1/controller_worker.py (+1, -0)
octavia/certificates/manager/barbican_legacy.py (+2, -0)
octavia/controller/worker/task_utils.py (+1, -0)
octavia/api/v2/controllers/member.py (+1, -0)
octavia/certificates/manager/barbican.py (+1, -0)
octavia/api/v2/controllers/listener.py (+1, -0)
",0.08444,-0.311807,-0.163202,0.454513,-0.032203,-0.463425,-0.276647,-0.391223,0.146113,0.551683,-0.254962,0.286801,0.038849,0.221099,0.622483
openstack/python-octaviaclient,I9ad1f709403e8a33ef07ccf859c4267412fc3186,1,0,0.6512,4.9836,0.0,3,16.0,289,0,Feature,0,0,0,43,0.004857,0.2,0,0.1302,4,2,0,0.0976,0.8386,3.0,5.53,17.65,0,0,0.8069,1,1.9795,0,0,0,0,0,"Improve error messages in list/show calls

Some list/show calls didn't use the @correct_return_codes decorator,
users may have received obscure error messages when they perfomed
unauthorized/invalid requests.

Story 2008647
Task 41910
[SEP]
FILES CHANGED:
octaviaclient/api/v2/octavia.py (+23, -0)
octaviaclient/tests/unit/api/test_octavia.py (+117, -0)
releasenotes/notes/improve-error-messages-for-invalid-calls-bc9eb3d18d3e4fdf.yaml (+5, -0)
",0.746544,-1.541035,-0.280198,-0.054684,0.061313,0.280047,-0.276248,-0.701733,-0.104988,-0.434049,-0.29093,-0.430371,0.202486,-0.366273,0.177143
openstack/kolla-ansible,I48e7fe2a5a585a2e1cab885b4d725dec7e175aea,1,0,0.8611,0.6931,0.0,1,10.0,98,0,CI,1,0,0,36,0.019027,0.3333,0,0.287,2,1,0,0.7778,0.0,2.0,-23.27,12.0,0,0,1.0,0,49.0,0,0,0,0,0,"CI: Reduce neutron RPC service workers to 1
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -0)
",2.561345,0.78338,1.405915,0.39201,0.664228,0.735088,-0.33247,0.545006,-0.136599,0.522316,-0.182296,-0.139012,0.627576,-0.195445,-0.463278
openstack/kolla-ansible,I3296dcc4780160cbf88bd18285571276f58bb249,1,1,0.7143,2.3979,0.1,3,9.17,411,0,Bug Fix,0,0,0,7,0.021472,0.5,0,0.3571,4,2,0,0.7802,1.4855,3.33,49.87,10.94,0,0,0.0,1,37.3636,0,8,0,6,0,"Fix Cinder log parsing

The Cinder API log is currently written to a file called
cinder-wsgi.log, and the WSGI logs to cinder-api.log. Fluentd
then tries to parse the WSGI log as an OpenStack log which
results in 'got incomplete line' errors and prevents proper
ingestion of these logs.

Co-Authored-By: yaoning <yaoning@unitedstack.com>
Closes-Bug: 1916752
[SEP]
FILES CHANGED:
ansible/roles/cinder/templates/cinder.conf.j2 (+3, -0)
ansible/roles/cinder/templates/cinder-wsgi.conf.j2 (+1, -1)
releasenotes/notes/fix-cinder-logging-22fea4739begd6s.yaml (+5, -0)
",-1.332545,-0.141238,-0.556864,0.286765,-0.177761,-0.175122,-0.008884,0.089461,0.120386,-0.276747,0.439513,0.052464,0.267279,0.463169,-0.181861
openstack/kolla-ansible,I77791d504327ace880d0cc2438af2f8ced66d4eb,1,0,0.7857,0.6931,0.0,1,6.0,74,0,CI,1,0,0,14,0.03794,0.0,0,0.0,2,1,0,0.7826,0.0,2.0,3.34,15.73,0,0,1.0,0,37.0,0,0,0,0,0,"CI: Add ssh retries
[SEP]
FILES CHANGED:
tests/templates/ansible.cfg.j2 (+1, -0)
",3.70671,1.093002,1.168465,0.521205,0.421574,0.899772,-0.141356,-0.008332,0.157901,0.469029,-0.041024,-0.719261,0.918987,-0.277511,-0.043324
openstack/octavia-dashboard,Ia93cb7520ff9c179a27e72719f1fd10524c57acb,1,0,1.0,1.0986,0.5,1,23.0,383,0,Feature,0,0,0,1,0.333333,1.0,0,1.0,4,1,0,0.1923,0.0,4.0,27.16,17.9,1,0,0.0,0,127.6667,1,0,0,0,0,"Disable Load Balancers panel when Octavia service is not deployed

Currently Load Balancers panel is enabled based on 'network' service
defined in Keystone but it should refer to 'load-balancer' service
which is served by Octavia.

Story: #2008446
Task: #41413
(cherry picked from commit 9b10ff4964d125dbd59232c52ca692c5c7fe0044)
[SEP]
FILES CHANGED:
octavia_dashboard/dashboards/project/load_balancer/panel.py (+1, -1)
",-0.980617,-0.439926,-1.00914,-0.692899,0.793705,-0.048876,0.450276,0.20933,0.170422,0.05703,0.196014,-0.122341,0.504424,0.198817,-0.301431
openstack/octavia,Ia4aa2047a79ad6fc3e33c7ebe2da9438914f7a88,1,0,0.6591,4.7958,0.175,5,19.0,292,0,Bug Fix,0,0,0,44,0.004889,0.5385,0,0.3549,5,2,0,0.5229,1.9659,3.6,16.12,16.02,0,0,0.6083,1,2.4132,0,0,0,0,0,"Fix overriding default listener timeout values in config file

The default value for timeout parameters in the BaseListenerType was
not correctly set because the class was defined before reading the
config file.

Story 2008666
Task 41953
[SEP]
FILES CHANGED:
releasenotes/notes/fix-default-timeout-values-for-listeners-108c8048ba8beb9a.yaml (+6, -0)
octavia/api/v2/types/listener.py (+8, -20)
octavia/tests/functional/api/v2/test_load_balancer.py (+55, -1)
octavia/db/prepare.py (+13, -0)
octavia/tests/functional/api/v2/test_listener.py (+17, -0)
",1.071926,-2.455378,0.225525,-0.004751,-0.43442,0.403469,-0.158459,0.087492,0.553749,-0.199333,-0.209093,-0.181006,-0.34243,0.158214,0.027572
openstack/octavia,I435c40a5493828bce24c2850182f0ddc8e5bdd1f,1,0,0,2.1972,0.5,1,14.25,459,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,5,1,0,0.5251,0.0,5.0,15.75,15.52,1,0,0.0,0,51.0,0,0,0,0,0,"Fix failover of az-specific loadbalancers

There is a bug exists in CalculateAmphoraDelta class
If there is no such a key as constants.MANAGEMENT_NETWORK
in availability_zone dictionary, method get will return None
It means that management_nets list will become [None], not
CONF.controller_worker.amp_boot_network_list as it supposes to be
It breaks the following failover flow

Story: 2008669
Task: 41957
[SEP]
FILES CHANGED:
octavia/controller/worker/v1/tasks/network_tasks.py (+4, -4)
",-0.595844,-1.364946,0.112739,-0.018748,-0.11321,-0.073603,-0.134506,0.242752,0.39242,-0.307085,0.29497,-0.483803,-0.409442,0.184136,-0.332904
openstack/octavia,Ic63929d8864e5285baf70dd85e6362988bf2863f,1,0,1.0,3.8067,0.4318,4,13.14,660,0,Bug Fix,0,0,0,1,0.025,0.375,0,0.375,6,2,0,0.5273,1.4568,4.25,49.12,14.39,1,0,0.8182,1,14.6667,0,0,0,0,0,"Fix weighted round-robin about UDP and SCTP listener

'lb_algo rr' in keepalived won't work correctly with weight
for UDP and SCTP listeners, it should be 'lb_algo wrr'.

'wrr' is superset of 'rr' algorithm, as round-robin is
a specical instance of the weighted round-robin scheduling,
in which all the weights are equal. [1]

Algorithm in HAProxy is set to 'roundrobin', which also support
weights, but in keepalived must be set to 'wrr' to work with
the weighted round-robin scheduling, as it is different to 'rr'.

[1] https://www.keepalived.org/doc/scheduling_algorithms.html

Story 2008462
Task 41491
[SEP]
FILES CHANGED:
releasenotes/notes/fix-udp-and-sctp-listener-wrr-50de9dc0774a8ea1.yaml (+6, -0)
octavia/common/jinja/lvs/jinja_cfg.py (+1, -1)
octavia/tests/unit/common/jinja/lvs/test_jinja_cfg.py (+14, -14)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+4, -4)
",-2.904079,0.13562,1.206565,0.308911,0.447524,0.120427,-0.646476,-0.134113,-0.062574,-0.007559,0.051587,-0.067842,-0.28173,-0.325207,-0.021362
openstack/kolla-ansible,I20c1d9bddee5a046b521b9378bade2ab50612be0,0,0,0.625,5.112,0.0061,7,7.0,148,0,CI,1,0,0,8,0.01248,1.0,0,0.625,2,4,0,0.7849,1.9042,1.14,0.32,19.94,1,0,1.0,1,0.8916,0,0,0,0,0,"CI: octavia: create and test a load balancer

Co-Authored-By: Mark Goddard <mark@stackhpc.com>
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+100, -0)
tests/run.yml (+15, -1)
tests/setup_gate.sh (+6, -0)
tests/templates/globals-default.j2 (+14, -0)
zuul.d/base.yaml (+11, -0)
zuul.d/project.yaml (+2, -0)
zuul.d/jobs.yaml (+16, -0)
",-0.136798,2.849404,-1.725216,0.345052,-0.664383,0.819023,-0.717412,-0.27291,0.256433,-0.415092,0.771536,0.939965,0.187932,0.127147,-0.892021
openstack/kolla-ansible,I2e18f2d912dad92a327261e092da358911531ebe,0,0,1.0,3.6376,0.0,4,11.0,218,0,Doc,0,0,0,2,0.014085,1.0,0,1.0,4,2,0,0.7766,1.0982,3.5,7.24,17.13,1,0,0.0,1,5.7368,0,0,0,0,0,"Use Docker healthchecks for skydive services

This change enables the use of Docker healthchecks for skydive services.
Implements: blueprint container-health-check
[SEP]
FILES CHANGED:
ansible/roles/skydive/tasks/check-containers.yml (+1, -0)
ansible/roles/skydive/defaults/main.yml (+28, -0)
ansible/roles/skydive/handlers/main.yml (+2, -0)
releasenotes/notes/implement-docker-healthchecks-for-skydive-a3063822a68205b1.yaml (+6, -0)
",-0.326189,1.089084,-1.350288,1.902212,1.008684,0.173419,-0.539765,-0.089876,0.042386,-0.202061,-0.016689,0.516444,0.53744,-0.379168,-0.004737
openstack/octavia,I1fe342d2bdf1301dd89ab7dfaa8e6a23e69c252b,1,0,0.4646,4.3694,0.0513,7,23.33,441,0,Bug Fix,0,0,0,99,0.003979,0.5,0,0.2323,7,2,0,0.5294,2.5616,5.14,42.96,18.48,0,0,0.4744,1,5.5823,0,0,0,0,0,"Fix LB failover when IP addresses exhausted

When a load balancer failover was performed on a load balancer where
the VIP address is on a subnet that has no IP addresses available,
the VIP address may be deactivated.
This patch corrects the failover flow to not deallocate the VIP
address on a failover revert flow due to the subnet being out of
IP addresses.

Story: 2008625
Task: 41827
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+21, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_network_tasks.py (+16, -0)
octavia/controller/worker/v1/flows/load_balancer_flows.py (+2, -2)
releasenotes/notes/Fix-failover-ip-addresses-exhausted-69110b2fa4683e1a.yaml (+5, -0)
octavia/controller/worker/v2/tasks/network_tasks.py (+14, -0)
octavia/controller/worker/v1/tasks/network_tasks.py (+14, -0)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+2, -2)
",-0.93737,-1.66626,-0.072848,0.848552,0.210454,0.357038,0.357125,-0.148573,0.72543,-0.084239,0.278614,0.421587,0.119079,0.075185,-0.084111
openstack/octavia,I6505243ddbf1eab7d110e9bfa03bffda840f07ae,1,0,0.47,1.7918,0.0,1,11.6,373,0,Bug Fix,0,0,0,100,0.004007,0.0,0,0.0,2,1,0,0.5315,0.0,2.0,63.79,10.85,0,0,0.0,0,62.1667,0,0,0,0,0,"Fix grenade resource waiters

The grenade job resource.sh script is waiting for the created object
status but not the overall load balancer status to go ACTIVE.
This can lead to the script failing with a 409 error.

This patch adds a check for the load balancer to be unlocked before
advancing to the next create call.
[SEP]
FILES CHANGED:
devstack/upgrade/resources.sh (+5, -0)
",-0.092186,-1.745252,0.076193,0.822665,-0.352548,0.381849,0.646522,-0.261152,0.66778,0.037149,-0.029569,0.132827,-0.193204,0.288846,0.079464
openstack/tooz,I109d3b5770c3cd8fe0bdeae78517f4d36ba3b65f,1,0,0,1.0986,0.5,1,9.0,158,0,CI,0,0,1,0,0.0,0.0968,1,0.0,0,1,0,0.3333,0.0,0.0,23.8,14.71,1,0,0.0,0,52.6667,0,0,0,0,0,"Cap tenacity to unblock the gate

Recent version 7 changed retry and dropped the
retry_state parameter.
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
",1.520046,-0.493772,-0.448218,0.425114,0.034782,0.633751,0.349172,-0.327831,0.533783,-0.209157,0.564438,0.528504,-0.754548,-0.548107,0.36493
openstack/kolla-ansible,I251febe3fd192372177116569f41ccb9aa225302,1,0,0.8649,0.0,0,1,2.89,289,0,Feature,0,0,0,37,0.019546,0.0,0,0.0,4,1,0,0.7684,0.0,4.0,41.21,13.46,1,0,0,0,289.0,0,0,0,0,0,"Rename eswitchd.conf -> eswitchd.conf.j2

In I173669bdf92b1f2ea98907ba16808ca3c914944c, eswitchd.conf.j2 template
file missed a .j2 at the end. This PS rectifies it.

(cherry picked from commit e3c199d1817c013c9129c89f6a3272d346f283a3)
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/eswitchd.conf.j2 (+0, -0)
",-1.42894,-0.438029,-1.568955,-1.551305,1.243194,-0.073401,0.444094,-0.148859,-0.227175,0.375162,0.228159,-0.270538,-0.057884,0.590821,-0.191482
openstack/octavia,I34341e1aaad1524e3e0834309c5f6897f176af53,1,0,0.6667,4.5218,0.0549,5,14.88,860,0,Bug Fix,0,0,0,45,0.004935,0.3333,0,0.2222,4,2,0,0.5336,1.713,3.0,22.54,16.37,1,0,0.5934,1,9.3478,0,0,0,0,0,"Don't fail if a provider driver cannot be loaded in Octavia API

Fix an issue that prevents the Octavia API service to be correctly
initialized when it fails to load a provider driver.

When enabled_provider_drivers setting is not correctly configured (ex:
if it contains a non existing driver) or when a provider driver fails
to load, the exception was not caught by the Octavia API service, so the
service was not properly configured and the whole Octavia API was
unreachable.

Now the Octavia API service skips the driver initialization in case of
errors, removes the driver(s) from the enabled list, and the other
provider drivers are functional.

Story 2008710
Task 42044

Depends-on: https://review.opendev.org/c/openstack/octavia/+/964892
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/provider.py (+1, -3)
octavia/tests/unit/api/test_app.py (+54, -0)
octavia/api/app.py (+14, -2)
releasenotes/notes/fix-octavia-api-driver-init-68b634549c12da6e.yaml (+6, -0)
octavia/api/drivers/driver_factory.py (+11, -0)
",-2.157126,-0.408012,1.520546,-0.003047,-0.460688,0.108074,0.01646,-0.046972,0.242289,-0.139144,0.039232,0.12938,0.010249,-0.11815,0.020317
openstack/kolla-ansible,Ib5a073d5b8209005be8841e355e75047c77bd488,0,0,1.0,1.6094,0.5,2,6.8,281,0,Bug Fix,0,0,0,1,0.125,0.0,0,0.0,4,2,0,0.7708,1.0,4.0,45.66,8.6,1,0,0.0,0,56.2,0,0,0,0,0,"Fix the Tempest image url variable

Seems very strange the variable of the image url doeesn't have the
correct prefix. This trivial fix will solve the issue.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/tempest/templates/tempest.conf.j2 (+1, -1)
ansible/roles/tempest/defaults/main.yml (+1, -1)
",0.438873,-1.033726,-0.178475,0.340923,-0.291667,0.873467,-0.409158,-0.946194,0.19824,-0.008072,0.25685,0.006016,-0.239728,0.136996,0.180508
openstack/ironic,Icbdd284de38b8e54c52cdbba709bba0e644c35cd,1,0,0,3.989,0.0943,3,3.33,487,0,Doc,0,0,0,0,0.0,0.0,0,0.0,4,2,0,1.0,1.3326,2.67,17.33,7.73,0,0,0.6038,1,9.0185,0,0,0,0,0,"update grub2 file name

Some higher versions of grub2 (e.g. 2.05 or 2.06-rc1) use
grub.cfg-01-MAC, while another lower versions of
grub2 (e.g. 2.04) use MAC.conf, so we generate both paths
in order to be compatible with both.

For more information we can see:
https://docs.oracle.com/en/operating-systems/oracle-linux/7/install/ol7-install-prepare.html#ol7-install-pxe-boot-uefi
[SEP]
FILES CHANGED:
releasenotes/notes/fix-grub2-config-file-name-88e689a982a21684.yaml (+7, -0)
ironic/common/pxe_utils.py (+9, -5)
ironic/tests/unit/common/test_pxe_utils.py (+32, -0)
",-2.341043,2.385496,-0.274548,0.390033,-0.031841,-0.600216,0.240135,-0.051339,-0.456326,0.375136,-0.225492,0.239136,0.190595,0.542984,-0.154893
openstack/python-ironicclient,I136503f546be2ecbd3203ee07597df59a40a594e,1,0,0.0,3.1781,0.0,2,8.67,209,0,Bug Fix,0,0,0,1,0.043478,0.0,0,0.0,2,2,0,0,0.7554,1.5,38.6,12.7,1,0,0.0,1,8.7083,0,0,0,0,0,"Make baremetal --debug actually work

The --debug option exists but does nothing. Wire in openstacksdk logging
and make sure ironicclient can log as well.
[SEP]
FILES CHANGED:
ironicclient/shell.py (+18, -0)
releasenotes/notes/debug-e9dd680d783fa4b6.yaml (+5, -0)
",1.057775,-1.55648,-0.153548,0.113961,-0.171015,-0.557909,0.223643,-0.412006,-0.936354,-0.027708,-0.042702,-0.158817,0.060115,-0.303703,-0.042578
openstack/python-ironicclient,Id1c6f1a69161e3ddbb83c9229aa9be84a0c8c02d,1,0,0.5,1.9459,0.0,3,5.0,80,0,Bug Fix,0,0,0,2,0.043478,0.0,0,0.0,5,2,0,1.0,1.2516,3.0,-52.04,26.0,1,0,0.1667,1,11.4286,0,0,0,0,0,"Fix --fields network_data
[SEP]
FILES CHANGED:
releasenotes/notes/network_data-c48b3878a5b04df5.yaml (+4, -0)
ironicclient/v1/resource_fields.py (+1, -0)
ironicclient/tests/unit/osc/v1/test_baremetal_node.py (+1, -0)
",3.853201,0.605285,2.217758,-0.340079,0.346601,0.257289,-0.147264,-0.029249,0.556542,-0.489795,-0.499302,-1.210374,-0.122462,0.710731,0.084045
openstack/kolla-ansible,Iec4d2bea37321efe655f8f499673cb593e85d5a6,0,1,1.0,2.3026,0.1111,2,11.0,114,0,Bug Fix,0,0,0,1,0.014706,1.0,0,1.0,4,2,0,0.7629,0.7642,3.0,11.09,18.95,1,0,0.0,1,11.4,0,16,0,13,0,"fix missing lang env in curator crontab

Closes-Bug: 1919328
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1919328-9a9550e73392436e.yaml (+7, -0)
ansible/roles/elasticsearch/templates/elasticsearch-curator.crontab.j2 (+1, -1)
",2.240882,-0.063463,-0.546122,-1.615841,-0.308109,0.470983,-0.574442,-0.01263,-0.259756,-0.674116,0.796083,-0.169932,0.084611,-0.053632,0.176002
openstack/kolla,I7c1f0c5fc643678b29f963b6769d8f900a03b726,1,0,0.7647,5.3982,0.1636,6,2.39,646,0,Doc,1,0,0,34,0.011545,1.0,0,0.7647,2,2,0,0.8333,2.3075,1.33,4.44,8.96,1,1,1.0,0,2.9231,0,0,0,0,0,"[CI] Publish images to quay.io on a daily basis

Based on the discussions from the past 3 Kolla meetings [1][2][3],
we established that, to avoid the DockerHub pull limit issues
in our CI, we will try using quay.io.

We still publish weekly to the DockerHub.

[1] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-17-15.00.log.html#l-102
[2] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-24-15.00.log.html#l-137
[3] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-31-15.01.log.html#l-50

Depends-On: Id113a53c083d105ac9200474ff20faacef6decaf
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+1, -1)
.zuul.d/debian.yaml (+57, -11)
.zuul.d/centos.yaml (+36, -7)
.zuul.d/base.yaml (+26, -0)
.zuul.d/ubuntu.yaml (+36, -7)
tests/playbooks/publish.yml (+28, -10)
",-4.748691,4.496766,0.744927,-0.016318,-0.051636,0.217612,0.147094,-0.016433,-0.370673,0.21221,-0.034826,0.188227,0.323564,0.459288,0.001367
openstack/kolla-ansible,I5025fdb7e48c79a107b45f1454f5d5e81367a2f9,1,1,0.8684,1.0986,0.5,1,9.5,169,0,Bug Fix,0,0,0,38,0.020074,0.0,1,0.0,3,1,0,0.7551,0.0,3.0,32.45,14.33,0,0,0.0,0,56.3333,0,6,0,8,0,"docs: fix registry mirror example

The docker configuration should be a URL, not a host:port.

Closes-Bug: #1919932
[SEP]
FILES CHANGED:
doc/source/user/multinode.rst (+1, -1)
",1.496332,-0.976656,-0.443548,-0.622761,-0.78176,0.470403,-0.628834,0.106761,0.212576,-0.067699,0.069287,-0.169237,-0.011156,0.370108,-0.209541
openstack/python-octaviaclient,I706d24ee35e06a32f79b7e73ea95f088db0c45a4,0,0,0.1765,2.0794,0.0,2,14.0,333,0,Doc,0,0,0,17,0.239437,0.0,1,0.0,2,1,0,0.119,0.5917,2.0,13.35,14.17,1,0,0.0,0,41.625,0,0,0,0,0,"Update master for stable/wallaby

Add file to the reno documentation build to show release notes for
stable/wallaby.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/wallaby.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/wallaby.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",0.043957,-1.669756,-0.174338,0.187913,0.170491,-0.426029,-0.539386,0.400452,0.035413,0.009023,-0.626081,-0.027105,0.007104,0.474211,0.000888
openstack/python-octaviaclient,Ib19ec423c9c2965827dc0332137d1f0bb8196ef9,0,0,0.1667,1.0986,0.5,1,6.33,324,0,CI,1,0,0,18,0.230769,0.1,0,0.0167,1,1,0,0.1163,0.0,1.0,17.85,9.9,1,0,1.0,1,108.0,0,0,0,0,0,"Add Python3 xena unit tests

This is an automatically generated patch to ensure unit testing
is in place for all the of the tested runtimes for xena.

See also the PTI in governance [1].

[1]: https://governance.openstack.org/tc/reference/project-testing-interface.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.936783,0.378425,-0.701656,0.716735,-0.886918,0.066208,-0.298109,0.189309,0.255499,0.539354,-0.45815,0.193783,-0.151105,0.019464,-0.086623
openstack/kolla-ansible,I22e11a994801447526ac26fc2815a1679876225e,1,0,0.7714,1.9459,0.3333,1,2.59,818,0,Doc,1,0,0,35,0.011058,0.4,0,0.3086,2,1,0,0.7576,0.0,2.0,3.43,10.63,1,1,1.0,0,116.8571,0,0,0,0,0,"[CI] Use images from quay.io

Based on the discussions from the past 3 Kolla meetings [1][2][3],
we established that, to avoid the DockerHub pull limit issues
in our CI, we will try using quay.io.

The images have already been published via Kolla CI
for master/Wallaby [4] and Victoria [5].

This change applies only to CI.
The user-facing move is yet to be discussed.

[1] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-17-15.00.log.html#l-102
[2] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-24-15.00.log.html#l-137
[3] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-03-31-15.01.log.html#l-50
[4] https://review.opendev.org/c/openstack/kolla/+/781130
[5] https://review.opendev.org/c/openstack/kolla/+/781899
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+4, -2)
",-4.725158,5.234791,1.78851,0.030334,-0.510194,0.474637,-0.097513,-0.2206,-0.54947,0.081416,-0.173488,0.375339,0.100606,0.306244,-0.07126
openstack/ironic-python-agent-builder,I4b89119b8e2eded72973fa12879b1419542ba984,1,0,0.6667,3.7612,0.0,1,6.75,232,0,Feature,0,0,0,3,0.057692,0.0,0,0.0,3,1,0,0,0.0,3.0,18.25,14.55,1,0,0.0,0,5.3953,0,0,0,0,0,"Copy resolv.conf handling from diskimage-builder

The copy in finalise_base runs too late for us, leaving a stale
resolv.conf around (usually copied from the build environment).
[SEP]
FILES CHANGED:
dib/ironic-ramdisk-base/cleanup.d/98-prepare-resolve-conf (+42, -0)
",0.664843,0.067797,-0.127278,0.539121,0.110459,0.171058,0.425415,-0.637493,-0.608725,-0.624955,0.371017,-0.265053,-0.493919,0.555584,0.098062
openstack/magnum,Iac87a4a56187694d5f5b3454de380de6b6db48fa,1,0,1.0,1.6094,0.25,1,8.67,255,0,Bug Fix,0,0,0,2,0.133333,0.0,0,0.0,3,1,0,0.75,0.0,3.0,25.58,11.16,1,0,0.0,0,51.0,0,0,0,0,0,"Fix debug logging during cluster upgrade

Incorrectly formatted logging causes error. This PS fixes it.

Story: 2008628
Task: 41833

(cherry picked from commit 00f8aa5d67c03e9ff1dd828c13b25d201754eac2)
[SEP]
FILES CHANGED:
magnum/drivers/heat/driver.py (+3, -1)
",-0.354704,-0.844578,-1.884291,-1.860355,0.620265,0.490176,0.408049,-0.283568,0.329476,0.032075,-0.195107,-0.140228,0.367213,0.092402,-0.209135
openstack/octavia,I1bb334ef0c11a79038b21a873a6675d76b0fbefc,1,0,0,2.8904,0.1765,4,15.8,590,1,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,7,2,0,0.5357,1.9211,5.25,15.17,16.45,1,0,0.5882,1,32.7778,0,0,0,0,0,"Fix LB failover for amphorav2: set security group

Fix for the issue that an amphorav2 LB cannot be reached after
loadbalancer failover. The LB security group was not set in the
amphora port.

Fixed the v2 variant of UpdateVIPSecurityGroup to actually return the
security group id (v1 already did).
The flow created in get_failover_LB_flow uses UpdateVIPSecurityGroup
which is supposed to provide VIP_SG_ID, which is later needed in
get_amphora_for_lb_failover_subflow as a requirement for
CreateVIPBasePort.

Story: 2008735
Task: 42087
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+4, -1)
releasenotes/notes/fix-amphorav2-failover-secgroup-c793de5e00b32653.yaml (+5, -0)
octavia/tests/unit/controller/worker/v1/tasks/test_network_tasks.py (+4, -1)
octavia/controller/worker/v2/tasks/network_tasks.py (+1, -1)
",-2.073643,-0.650113,0.744027,0.005898,0.527163,0.065349,-0.344679,0.415057,0.530941,-0.532775,0.621507,-0.069706,-0.523638,-0.091371,0.127318
openstack/kolla,I031128d38e32c23147ad70e429b9aff66df3b8da,1,0,0.7,2.3979,0.3,4,3.6,153,0,Feature,0,0,0,20,0.042283,1.0,0,0.7,2,3,0,0.8364,1.9219,2.0,38.68,12.55,1,1,0.0,0,13.9091,0,0,0,0,0,"[release] Use UCA Wallaby

openvswitch has been pinned to 2.13.1 due to upgrade
issues with 2.15.0
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+4, -0)
docker/base/sources.list.ubuntu.aarch64 (+1, -1)
docker/base/sources.list.ubuntu.ppc64le (+1, -1)
docker/base/sources.list.ubuntu (+1, -1)
",0.018531,-0.363723,-1.630494,-1.704835,0.548447,0.105788,0.660602,0.110563,-0.199419,0.884086,-0.326028,-0.005988,-0.069748,0.001553,-0.047508
openstack/kolla-ansible,Ic3a8bf05a73fb042ae42cbd26ccced60240d8e94,1,0,1.0,1.9459,0.0,2,4.57,296,0,Feature,0,0,0,1,0.032258,0.0,0,0.0,4,2,0,0.76,0.65,3.0,1.27,13.08,1,0,0.0,1,42.2857,0,0,0,0,0,"Disable usage collection in Kibana

This commit disables collection of usage data in Kibana by default.
User has still an option to enable it via GUI. Reference: [1]

[1] https://www.elastic.co/guide/en/kibana/7.x/telemetry-settings-kbn.html
[SEP]
FILES CHANGED:
ansible/roles/kibana/templates/kibana.yml.j2 (+1, -0)
releasenotes/notes/disable-kibana-telemetry-46de5aaf2fc7c186.yaml (+5, -0)
",-1.011691,2.094735,-1.192064,1.287027,-0.782231,0.095206,0.25443,0.24022,0.248583,0.346558,-0.265313,0.094441,0.122361,-0.175144,-0.504944
openstack/octavia,Idb3ad20b8539bfdb788981a8634317257d83b238,1,0,0.2778,4.0943,0.322,7,11.67,237,0,Bug Fix,0,0,0,18,0.001601,0.6,0,0.1667,7,2,0,0.5378,2.7075,5.0,66.88,10.38,0,0,0.4407,1,3.95,0,0,0,0,0,"Fix empty Batch Member Update to unlock objects

Move the decision up one layer to the API controller.
The amphora driver should now just do as it is told.

Story: 2008731
Task: 42083
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/amphora_driver/v2/test_driver.py (+10, -1)
releasenotes/notes/Fix-noop-batch-member-update-issue-09b76787553e7752.yaml (+5, -0)
octavia/api/drivers/amphora_driver/v2/driver.py (+4, -7)
octavia/api/v2/controllers/member.py (+6, -0)
octavia/tests/functional/api/v2/test_member.py (+1, -3)
octavia/api/drivers/amphora_driver/v1/driver.py (+4, -7)
octavia/tests/unit/api/drivers/amphora_driver/v1/test_driver.py (+10, -1)
",1.332392,-2.021812,-0.249311,-0.532371,-1.034583,0.503558,-0.107942,0.230084,0.082754,-0.317424,0.045835,0.119925,-0.249464,0.357494,-0.266666
openstack/tooz,Ic3f3d05ce7bb10a7d29815444dac00dea4f9c9d1,1,0,0.6,2.5649,0.3333,2,5.3,527,0,Feature,0,0,0,5,0.024631,1.0,0,0.6,0,2,0,0.5,0.65,0.0,5.12,9.67,1,0,0.0,1,40.5385,0,0,0,0,0,"Move flake8 as a pre-commit local target.

The goal here is to avoid conflicts between flake8 and hacking version each
2 days.

Inspired from nova's approach[1].

The flake8 version to install will be determined by hacking and
requirements[2] will stay aligned instead of relying on different versions.

[1] https://opendev.org/openstack/nova/src/branch/master/.pre-commit-config.yaml#L26-L35
[2] https://opendev.org/openstack/hacking/src/branch/master/requirements.txt#L1
[SEP]
FILES CHANGED:
tox.ini (+1, -1)
.pre-commit-config.yaml (+7, -3)
",-2.585462,1.98832,0.19998,0.467408,-0.159865,-0.132249,0.425709,0.173822,-0.136494,0.242578,-0.065312,0.07885,-0.23364,0.011081,-0.149931
openstack/magnum,I8dec787660604d52156d71617d2bdda73fb62e9c,1,0,0,1.0986,0.0,1,11.25,633,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.8,0.0,6.0,50.66,10.72,1,0,0.0,0,211.0,0,0,0,0,0,"Add toleration to CSI nodeplugin

This commit allows the CSI nodeplugin to start on machines with taints.
A use case is nodegroups; a dedicated machine (e.g. ASICs and GPU) will
join the cluster with a pre-defined taint so that pods can't grab
valuable resources. However the taint currently stops the node from
starting the plugin and getting a node ID, so we cannot use cinder
volumes within pods.

This commit ports the work done by jichenjc
(https://github.com/kubernetes/cloud-provider-openstack/pull/1276) into
Magnum fixing the issue here too.

Story: 2007048
Task: 42097
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/enable-cinder-csi.sh (+2, -0)
",-1.749043,-0.362634,0.631817,0.004418,-0.229642,-0.188688,0.297378,0.159154,0.041407,-0.377628,0.158064,0.284124,0.151983,-0.212284,-0.172999
openstack/magnum,I22b698cd925dcf4f10805ae9493b77ddc9709f3f,1,0,1.0,2.9444,0.4444,4,6.2,307,0,Feature,0,0,0,3,0.157895,0.25,0,0.25,6,3,0,0.8333,1.8911,4.25,28.61,10.22,1,0,0.0,1,16.1579,0,0,0,0,0,"Download correct cri-containerd-cni tarball

In I05cbd1ec62e9a68c68a1666ff62f20138bf8c731, fedora_coreos_v1 driver was
missed in version bump. This PS bumps it to 1.4.4 for both fedora_coreos_v1 and
fedora_atomic_v1 drivers.

Story: 2008451
Task: 42098
[SEP]
FILES CHANGED:
magnum/drivers/k8s_fedora_atomic_v1/templates/kubecluster.yaml (+3, -3)
doc/source/user/index.rst (+3, -1)
magnum/drivers/common/templates/kubernetes/fragments/install-cri.sh (+1, -1)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubecluster.yaml (+3, -3)
",-0.440872,0.067284,-1.093582,-0.901048,0.711067,-0.121246,0.721979,0.467539,0.050681,-0.037098,0.118905,0.113806,-0.371881,0.196833,0.382033
openstack/kolla-ansible,I7f472a27eb9f2e1f267d7c4bac22236cdd076322,1,1,1.0,3.7612,0.4762,2,13.0,147,0,Bug Fix,0,0,0,2,0.4,0.0,0,0.0,4,2,0,0.7624,0.5266,3.0,-8.1,26.74,1,0,0.0,1,3.4186,0,14,0,15,0,"gnocchi: fix external ceph integration when gnocchi-statsd is disabled

Closes-Bug: #1926914
[SEP]
FILES CHANGED:
releasenotes/notes/fix-gnocchi-statsd-a56c789a3da758a6.yaml (+5, -0)
ansible/roles/gnocchi/tasks/external_ceph.yml (+17, -20)
",1.519486,0.498521,-0.617197,-0.798296,0.00405,0.268901,-0.569764,0.097926,-0.337954,-0.320298,0.467087,-0.020999,0.01051,-0.425672,0.424928
openstack/octavia,I987535e90cbf13917c50c5905c64b614188928ec,1,0,0.6739,2.4849,0.2727,1,9.0,347,0,Bug Fix,0,0,0,46,0.004995,0.5333,0,0.3594,1,1,0,0.5398,0.0,1.0,45.42,13.38,0,0,0.0,0,28.9167,0,0,0,0,0,"Fix devstack cleanup when using amphorav2

When cleaning up a devstack environment with amphorav2 enabled,
./clean.sh might fail because redis has already been stopped and
uninstalled.
This commit move the stop_redis step to the octavia_stop step and
ensures that stopping redis doesn't fail.
[SEP]
FILES CHANGED:
devstack/plugin.sh (+8, -3)
",-0.73078,-0.33523,-0.744451,0.922928,0.278871,-0.155755,0.462572,-0.471939,-0.61059,-0.135322,0.522239,-0.229241,-0.035209,-0.099132,0.296331
openstack/magnum,I65561358113952e3f60dc488b35ee8fa8f8da740,1,0,0,2.9444,0.2778,5,2.6,245,0,Feature,0,0,0,0,0.0,1.0,0,0.0,6,3,0,0.8571,2.0999,3.8,18.73,10.27,1,0,0.0,1,12.8947,0,0,0,0,0,"Update traefik options

* Traefik version updated from v1.7.19 to v1.7.28
* Force secure connections to use TLSv1.2 or greater
[SEP]
FILES CHANGED:
magnum/drivers/k8s_fedora_atomic_v1/templates/kubecluster.yaml (+1, -1)
doc/source/user/index.rst (+1, -1)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubecluster.yaml (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/enable-ingress-traefik.sh (+3, -2)
releasenotes/notes/update-traefik-min-tls-protocol-de7e36de90c1a2f3.yaml (+7, -0)
",-0.519635,1.275547,-1.226163,0.971415,0.980455,0.697418,-0.459591,0.621902,-0.210649,1.143895,-0.264456,0.44056,-0.494347,0.300313,0.658609
openstack/kolla-ansible,Iae8ca4aae945892f1dc65e1b10381d2e26e88805,1,1,0.0,4.4998,0.0225,5,20.77,1827,0,Bug Fix,0,0,0,1,0.003145,0.75,0,0.0,3,3,0,0.7647,2.1223,2.0,34.41,16.31,1,0,0.0,1,20.3,0,6,0,12,0,"Make setup module arguments configurable

Ansible facts can have a large impact on the performance of the Ansible
control host. This patch introduces some control over which facts are
gathered (kolla_ansible_setup_gather_subset) and which facts are stored
(kolla_ansible_setup_filter). By default we do not change the default
values of these arguments to the setup module. The flexibility of these
arguments is limited, but they do provide enough for a large performance
improvement in a typical moderate to large OpenStack cloud.

In particular, the large complex dict fact for each interface has a
large effect, and on an OpenStack controller or hypervisor there may be
many virtual interfaces. We can use the kolla_ansible_setup_filter
variable to help:

    kolla_ansible_setup_filter: 'ansible_[!qt]*'

This causes Ansible to collect but not store facts matching that
pattern, which includes the virtual interface facts. Currently we are
not referencing other facts matching the pattern within Kolla Ansible.
Note that including the 'ansible_' prefix causes meta facts module_setup
and gather_subset to be filtered, but this seems to be the only way to
get a good match on the interface facts. To work around this, we use
ansible_facts rather than module_setup to detect whether facts exist in
the cache.

The exact improvement will vary, but has been reported to be as large as
18x on systems with many virtual interfaces.

For reference, here are some other tunings tried:

* Increased the number of forks (great speedup depending of the size of
  the deployment)
* Use `strategy = mitogen_linear` (cut processing time in half)
* Ansible caching (little speed up)
* SSH tunning (little speed up)

Co-Authored-By: Mark Goddard <mark@stackhpc.com>
Closes-Bug: #1921538
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+15, -0)
releasenotes/notes/setup-module-args-c29e1815bbbe8aca.yaml (+8, -0)
ansible/gather-facts.yml (+11, -2)
etc/kolla/globals.yml (+16, -0)
doc/source/user/ansible-tuning.rst (+37, -0)
",-3.208811,0.006541,3.942942,-0.814962,-0.14537,0.486756,-1.10633,-0.686883,-0.277124,-0.197985,-0.834808,0.442328,-0.055075,-0.342999,-0.089404
openstack/octavia,Iac949431f0901aaa0a60e5c39c2aab44cb9c1970,1,0,0.4752,4.2485,0.0725,4,24.0,498,0,Bug Fix,0,0,0,101,0.004046,0.4211,0,0.2001,7,2,0,0.5419,0.9841,4.0,27.38,17.93,0,0,0.7971,1,7.1143,1,0,0,0,0,"Fix pool ALPN compatibility with older amphora

The ALPN for pools patch introduced a bug that causes amphora to
fail if the HAProxy version running inside the amphroa does not
support ALPN on backend members (bionic images for example).
This patch adds compatibility support for those older HAProxy versions
by removing the ALPN configuration settings if the HAProxy version
is too old to support the functionality.

Story: 2008780
Task: 42171
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+4, -1)
octavia/common/constants.py (+1, -0)
releasenotes/notes/Fix-pool-alpn-older-haproxy-50514c1df4f77bcd.yaml (+8, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+51, -4)
",-0.556898,-1.464953,0.055386,0.515954,-0.024721,0.095265,-0.030676,0.507375,0.140765,0.233911,0.095982,0.383536,0.11811,-0.27941,0.229016
openstack/octavia,I3125cfc7b3bd12eed139b058fc2bb7f23f12abc7,1,0,0.6809,3.8918,0.2708,3,13.0,222,0,Bug Fix,0,0,0,47,0.005097,0.0,0,0.0,6,3,0,0.5439,0.9466,4.33,24.44,19.05,0,0,0.7917,1,4.5306,0,0,0,0,0,"Fix rsyslog configuration when disabling logs

Fix an invalid rsyslog configuration when disabling both log offloading
and local log storage.

Story 2008782
Task 42173
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/logging/test_logging_jinja_cfg.py (+25, -13)
octavia/common/jinja/logging/templates/10-rsyslog.conf.template (+5, -0)
releasenotes/notes/fix-error-in-rsyslog-config-a316a7856e1a847a.yaml (+5, -0)
",0.334102,-1.703528,-0.130796,0.144583,0.411769,0.015267,-1.132859,0.202018,0.150649,-0.126688,-0.395654,0.059458,0.143563,-0.065471,-0.19975
openstack/ironic,I7f5b7323b108b303b5b77609d5903128d4adca3c,1,0,0,1.6094,0.5,1,6.94,1150,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,6.9,12.06,0,0,0.0,0,230.0,0,0,0,0,0,"Fix Bandit check

Bandit has started to fail on master.

 >> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
    Severity: High   Confidence: Medium
    Location: ironic/common/utils.py:491
    More Info: https://bandit.readthedocs.io/en/latest/plugins/b701_jinja2_autoescape_false.html
 489	    # NOTE(pas-ha) not using default_for_string=False as we set the name
 490	    # of the template above for strings too.
 491	    env = jinja2.Environment(
 492	        loader=loader,
 493	        autoescape=jinja2.select_autoescape(),
 494	        undefined=jinja2.StrictUndefined if strict else jinja2.Undefined
 495	    )

It appears that Arun changed this around a little in
https://review.opendev.org/c/openstack/ironic/+/777448/10/ironic/common/utils.py
however this doesn't seem to pass reliably. As such, I'm returning
the notation of the label to the first line as it was before, which
seems to consistently pass bandit checking.
[SEP]
FILES CHANGED:
ironic/common/utils.py (+2, -2)
",-3.727511,2.194845,3.331159,-0.994946,-0.225841,0.822245,-0.869711,-0.805228,-0.33503,-0.268573,-0.103645,-0.246338,-0.069162,0.021036,-0.037306
openstack/magnum,I053808fac72a63af7ebf6f33d94659134b6cbdac,1,0,0.8333,1.0986,0.5,1,2.58,547,1,Doc,0,0,0,6,0.059406,0.0,0,0.0,6,1,0,0.875,0.0,6.0,-191.5,16.52,1,1,0.0,0,182.3333,0,0,0,0,0,"[K8S] Enable --use-service-account-credentials

Enable the config --use-service-account-credentials=true. This is
necessary to support Pod Security Policy[1].

See
https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/
for the option description, and more information here[2].

[1]: https://kubernetes.io/docs/concepts/policy/pod-security-policy/#troubleshooting
[2]: https://docs.datadoghq.com/security_monitoring/default_rules/cis-kubernetes-1.5.1-1.3.3/
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/configure-kubernetes-master.sh (+1, -1)
",-3.11053,3.17536,0.009845,0.427783,-0.321951,-0.631665,0.022105,0.275883,0.257997,-0.057359,-0.456251,0.30312,-0.001531,-0.085308,-0.141768
openstack/magnum,Ibf8745abef8d95297a8c38effb7af98162a086ed,0,0,1.0,2.8332,0.5625,4,1.38,238,0,Feature,0,0,0,1,0.052632,1.0,0,1.0,6,3,0,0.8889,1.5488,4.25,-85.97,18.33,1,0,0.0,1,14.0,0,0,0,0,0,"Update magnum container images

node-problem-detector: v0.6.2 -> v0.8.2
cluster-proportional-autoscaler: 1.1.2 -> 1.8.3
[SEP]
FILES CHANGED:
magnum/drivers/k8s_fedora_atomic_v1/templates/kubecluster.yaml (+1, -1)
doc/source/user/index.rst (+1, -1)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubecluster.yaml (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/core-dns-service.sh (+4, -6)
",-0.699866,1.165251,-1.544677,0.344307,0.688353,-0.297935,-0.490998,0.864796,0.40219,0.523288,-0.793079,0.658301,-0.638831,1.143793,0.623056
openstack/kayobe,I18f67eda4e48058f3f402b9d0e692d6eeb02855f,1,0,0.8718,3.2958,0.2308,10,15.5,640,0,Bug Fix,0,0,0,39,0.02058,1.0,0,0.8718,1,1,0,0.9459,3.2185,1.0,57.38,10.93,0,0,0.0,0,23.7037,0,0,0,0,0,"Avoid fact gathering for group_by

There are a few places where we have a play with one task that uses the
group_by module to generate groups that are used in a subsequent play.
These plays do not need to gather facts for their target hosts.

In particular, the kolla-openstack.yml playbook should really be able to
operate without access to remote hosts.

This change also adds changed_when: false to all group_by tasks, since
they show as changed but haven't really made any changes outside of
Ansible.

TrivialFix

(cherry picked from commit 388dfa369c9608f252dc946123c1801999931f6f)
[SEP]
FILES CHANGED:
ansible/physical-network.yml (+2, -0)
ansible/overcloud-bios-raid.yml (+1, -0)
ansible/overcloud-grafana-configure.yml (+2, -1)
ansible/provision-net.yml (+2, -1)
ansible/overcloud-ipa-build.yml (+2, -1)
ansible/overcloud-ipa-images.yml (+2, -1)
ansible/overcloud-introspection-rules-dell-lldp-workaround.yml (+3, -1)
ansible/kayobe-ansible-user.yml (+1, -0)
ansible/overcloud-introspection-rules.yml (+2, -1)
ansible/kolla-openstack.yml (+3, -0)
",-1.441061,-1.5169,0.715213,-0.732211,0.186175,-0.191159,0.345009,-0.335246,-0.08061,-0.041399,0.007667,-0.045523,-0.082233,-0.164354,-0.253083
openstack/kolla-ansible,Id0144e8fa518e3236cb94ba2e3961fb455d36443,1,0,1.0,3.3322,0.037,4,9.5,303,0,CI,0,0,0,2,0.054054,0.8,0,0.8,4,3,0,0.767,1.3212,3.0,19.09,16.43,0,0,0.0,1,10.8214,0,0,0,0,0,"Reduce container metrics cardinality

Adds support for passing extra runtime options to cAdvisor.
By default new options disable exporting rarely useful metrics
and labels by cAdvisor. This helps reducing the load on Prometheus
and cAdvisor itself.
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus-cadvisor.json.j2 (+1, -1)
releasenotes/notes/reduce-cadvisor-cardinality-1213854b9fe0c828.yaml (+19, -0)
ansible/roles/prometheus/defaults/main.yml (+2, -0)
etc/kolla/globals.yml (+4, -0)
",0.508189,-0.940343,-0.158421,0.98937,0.028154,0.053532,-0.098604,0.140931,-0.050828,-0.069709,-0.606266,0.19128,0.143321,-0.722781,-0.251189
openstack/ironic,Ic14ebc04f01bece1460f6244ec2dd88c8dd00b0e,1,0,0,1.0986,0.5,1,14.33,280,1,Bug Fix,0,0,0,0,0.0,0.0,1,0.0,3,1,0,1.0,0.0,3.0,50.63,12.24,1,0,0.0,0,93.3333,0,0,0,0,0,"Fix typo in security docs around is_admin rule

The security docs give an example of how to enable admins to show
passwords via the API, but the policy guidance is wrong. There is no
""is_admin"" _role_, it is instead a _rule_.
[SEP]
FILES CHANGED:
doc/source/admin/security.rst (+1, -1)
",-0.225012,-0.858903,-0.632882,1.006554,0.120146,0.453382,0.105876,-0.713426,0.128384,-0.080374,0.134799,-0.230483,-0.376627,-0.470213,0.206656
openstack/oslo.privsep,Ie7cc25ed53563dd500f7b10ff43a48518d46a2e0,1,1,0,4.5951,0.1939,4,13.5,566,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,2,0,1.0,1.6452,1.5,45.87,11.33,1,0,0.5612,1,5.7172,0,6,0,15,0,"Allow finer grained log levels

Currently all privsep calls use the same logging level as they use the
``oslo_privsep.daemon`` logger.

This creates a problem for services like nova where we don't want to
log its own privsep debug messages by default (even in debug mode) but
we want them for os-brick privsep calls.

This patch introduces a new string parameter to ``PrivContext`` called
``logger_name`` to control the name of the logger to use, which defaults
to ``oslo_privsep.daemon``.

Related-Bug: #1922052
[SEP]
FILES CHANGED:
oslo_privsep/daemon.py (+11, -9)
oslo_privsep/tests/test_daemon.py (+46, -9)
releasenotes/notes/context-logger-06b475357bebadc7.yaml (+15, -0)
oslo_privsep/priv_context.py (+7, -1)
",-1.906396,-0.654571,0.484856,0.395472,0.32521,-0.246703,-0.13671,-0.024319,0.041608,-0.021698,0.299015,-0.188257,-0.259737,-0.121945,0.084389
openstack/ironic,I9f305cb3f33766c1c93cf4347368b1ce025fc635,1,0,0,3.7377,0.2927,3,9.43,475,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,1.0,1.4125,4.0,54.98,9.83,1,0,0.561,1,11.3095,0,0,0,0,0,"Restrict syncing of boot mode to Supermicro

The fix for https://storyboard.openstack.org/#!/story/2008252 synced
the boot mode after changing the boot device, because Supermicro nodes
reset the boot mode if not included in the boot device set. However this
can cause a problem on Dell nodes when changing the mode uefi->bios or
bios->uefi. Restrict the syncing of the boot mode to Supermicro.

Story: 2008712
Task: 42046
[SEP]
FILES CHANGED:
releasenotes/notes/restrict-sync-mode-after-device-to-supermicro-218e8cb57735c685.yaml (+11, -0)
ironic/drivers/modules/redfish/management.py (+6, -1)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+12, -11)
",-0.938862,-0.241411,-0.086031,0.702142,0.125496,0.182181,0.525455,0.165533,0.27361,-0.151251,0.345749,-0.258382,0.151632,-0.060573,-0.01984
openstack/ironic,Ia7093a3ed48e19197f74da9e1c49416a974a76be,1,0,0,1.0986,0.5,1,2.4,274,0,Feature,0,0,1,0,0.0,0.0,1,0.0,0,1,0,1.0,0.0,0.0,-28.25,17.63,1,0,0.0,0,91.3333,0,0,0,0,0,"Update python-dracclient version

Update python-dracclient version to indicate Wallaby compatibility with
6.*.* releases.

Version 6.0.0 is available from PyPI [1].

[1] https://pypi.org/project/python-dracclient/6.0.0/
[SEP]
FILES CHANGED:
driver-requirements.txt (+1, -1)
",-1.126277,1.706606,-0.991729,0.888328,-0.155391,-0.028958,-0.251453,0.697186,-0.261499,0.786903,-0.446607,0.335358,-0.120441,0.259197,0.071421
openstack/ironic,Ie7cb2c831854be288553dc634d5367739519e0e1,1,0,0,3.6109,0.6111,2,11.0,157,0,Feature,0,0,0,0,0.0,0.0,0,0.0,6,1,0,1.0,0.9183,5.0,-42.75,26.22,1,0,0.6667,0,4.2432,0,0,0,0,0,"Followup idrac configuration mold steps

Followup to change: I10dbc30614d8654dda540ffaa5e61e7a9f03c7b3
[SEP]
FILES CHANGED:
ironic/drivers/modules/drac/management.py (+6, -6)
ironic/tests/unit/drivers/modules/drac/test_management.py (+8, -16)
",-0.40423,-1.161774,-2.212402,-2.555282,1.508201,0.04489,1.265784,-0.20496,0.152122,0.441045,-0.47302,0.199208,0.219025,0.246004,-0.026754
openstack/kayobe,I215f927d8249aadd9cc7bb44893e0bdf5f26510a,1,0,0.9412,2.3026,0.5556,2,11.5,361,0,Bug Fix,0,0,0,17,0.038375,1.0,0,0.9412,1,1,0,0.9474,0.9183,1.0,25.96,14.17,1,0,0.0,0,36.1,0,0,0,0,0,"Fix help texts of inventory options

Passing the Kayobe or Kolla Ansible inventories as comma-separated host
list was never supported since we check that inventory directories
exist.

Also fix the check for the Kolla Ansible inventory directory, which was
using the wrong variable (parsed_args.kolla_venv).
[SEP]
FILES CHANGED:
kayobe/kolla_ansible.py (+3, -3)
kayobe/ansible.py (+1, -2)
",-0.174546,-1.453124,-0.380183,0.417091,-0.055252,-0.516262,0.349678,0.276132,-0.157456,-0.078404,0.157497,-0.336156,-0.02253,0.22773,-0.448612
openstack/kolla,I8f5a9b220fc8afd6ef07cb5f2142df8c6ead9bc0,0,0,0.7143,4.852,0.9449,6,5.0,159,0,Feature,0,0,0,21,0.043478,1.0,0,0.7143,3,5,0,0.8393,1.0508,2.5,-23.84,20.67,0,0,0.0,1,1.2422,0,0,0,0,0,"Drop monasca-grafana image.

After months of using deprecated components image finally stopped
building.
[SEP]
FILES CHANGED:
kolla/image/build.py (+0, -2)
releasenotes/notes/deprecate-monasca-grafana-d05af2e96cffd82c.yaml (+0, -5)
docker/monasca/monasca-grafana/Dockerfile.j2 (+0, -104)
docker/monasca/monasca-grafana/grafana_sudoers (+0, -1)
releasenotes/notes/drop-monasca-grafana-df2c45d6826752f6.yaml (+7, -0)
docker/monasca/monasca-grafana/extend_start.sh (+0, -8)
",2.362372,-1.161307,-0.390336,-0.219858,-0.388143,0.126281,0.356322,0.644687,-0.069355,-0.650048,0.032877,0.878191,-0.429585,0.666971,-0.277009
openstack/kolla,Ie19bf46236907d79cb42a5e94cd1067e952b8cbb,1,0,0.6818,5.7991,0.2736,5,10.83,503,0,Feature,0,0,0,22,0.036066,0.6667,0,0.4545,2,3,0,0.8246,1.6068,2.0,40.96,8.64,0,0,0.1216,1,1.5242,0,0,0,0,0,"Debian/Ubuntu: handle APT keys in proper way

apt-key is deprecated and in Debian 'bullseye' it complain when we use
it the way we did.

The right way is to store key files in separate directory and then, for
each repo source file, point to proper key. And this is what this patch
does.

Both distros use the same keys now.

More info: https://michael-prokop.at/blog/2021/02/16/how-to-properly-use-3rd-party-debian-repository-signing-keys-with-apt/
[SEP]
FILES CHANGED:
kolla/template/methods.py (+10, -2)
docker/base/Dockerfile.j2 (+17, -46)
releasenotes/notes/apt-keys-bb7c8678fc6d908b.yaml (+12, -0)
kolla/template/repos.yaml (+167, -35)
kolla/tests/test_methods.py (+33, -7)
",-1.909732,0.740875,0.296998,0.15196,-0.623101,-0.321995,0.399926,-0.488928,-0.460849,-0.133006,-0.006641,0.038259,0.251775,0.471636,0.038663
openstack/kayobe,I468d4e0460c13791b9f01d5854ef45472528c6fe,1,0,0.875,1.6094,0.5,1,11.67,753,0,Bug Fix,0,0,0,40,0.020822,0.0,0,0.0,1,1,0,0.9487,0.0,1.0,51.58,11.52,1,0,0.0,0,150.6,0,0,0,0,0,"CentOS Stream 8: Use /usr/bin/which instead of bash function

A bug has been introduced to the which package in CentOS Stream 8 which
causes it to fail when used with the following bash options:

set -u
set -o pipefail

Then, when running which we see the following output:

environment: line 1: _declare: unbound variable

As found by Pierre, this seems to be caused by the implementation of
which as a bash function which references an unbound variable
(_declare). It's tracked in Fedora by
https://bugzilla.redhat.com/show_bug.cgi?id=1944877#.

This change works around the issue by using the /usr/bin/which binary.

Co-Authored-By: Pierre Riteau <pierre@stackhpc.com>

Story: 2008795
Task: 42215
[SEP]
FILES CHANGED:
dev/functions (+2, -2)
",-2.849792,-0.16893,1.463091,-0.63678,-0.624868,0.21182,-0.594678,-0.188354,0.043015,-0.004809,0.221676,-0.169485,0.047071,0.126763,-0.170324
openstack/ironic,Ie7cb2c831854be288553dc634d5367739519e0e1,1,0,1.0,3.6109,0.6111,2,16.0,226,0,Feature,0,0,0,1,0.027027,1.0,0,1.0,6,1,0,1.0,0.9183,5.0,-42.05,23.9,1,0,0.6667,0,6.1081,0,0,0,0,0,"Followup idrac configuration mold steps

Followup to change: I10dbc30614d8654dda540ffaa5e61e7a9f03c7b3

(cherry picked from commit ae30139af2a61e3d2031a1dc53f1fcf373fea933)
[SEP]
FILES CHANGED:
ironic/drivers/modules/drac/management.py (+6, -6)
ironic/tests/unit/drivers/modules/drac/test_management.py (+8, -16)
",-0.40423,-1.161774,-2.212402,-2.555282,1.508201,0.04489,1.265784,-0.20496,0.152122,0.441045,-0.47302,0.199208,0.219025,0.246004,-0.026754
openstack/octavia-dashboard,Ie669829b149001f77f7475216b86a33d96cb5ff5,1,0,0.6875,3.4657,0.2903,2,14.0,263,0,Bug Fix,0,0,0,48,0.005179,0.0,0,0.0,3,2,0,0.2222,0.6374,2.5,20.4,18.46,0,0,0.0,1,8.2188,0,0,0,0,0,"Fix updating a non-HTTP(S) Health Monitor

Prevent octavia-dashboard from sending parameters that trigger a
InvalidOption exception when updating a non-HTTP/non-HTTPS health
monitor.

Story 2008803
Task 42223
[SEP]
FILES CHANGED:
octavia_dashboard/api/rest/lbaasv2.py (+17, -9)
releasenotes/notes/fix-updating-non-http-hm-114180139961e441.yaml (+5, -0)
",0.798575,-0.764714,-0.267106,-0.066088,-0.197909,0.165233,-0.680283,0.25173,0.174586,-0.327025,-0.179352,0.41451,0.667151,0.039876,0.09525
openstack/kolla-ansible,Ic8ce6fbc3ed8f31d5d090e114b35703532679729,0,0,1.0,3.434,0.2667,8,12.33,493,0,Feature,0,0,0,3,0.06383,1.0,0,1.0,6,3,0,0.7692,2.6799,5.25,52.55,11.96,1,0,0.0,1,15.9032,0,0,0,0,0,"Add fluentd_enable_watch_timer

By default, the watch timer in Fluentd is set to True.
To save CPU and I/O consumption this can be set to False, which
kolla-ansible has been hardcoding so far.

When the watch timer is disabled, in_tail relies entirely
on inotify. In certain constellations, this may not work
reliably. In these cases, the watch timer needs to be activated, so this
change adds a variable to make the setting configurable.
[SEP]
FILES CHANGED:
releasenotes/notes/add-parameter-fluentd-enable-watch-timer-08fbe65ba2b549e8.yaml (+11, -0)
ansible/roles/common/defaults/main.yml (+3, -0)
ansible/roles/common/templates/conf/input/02-mariadb.conf.j2 (+2, -2)
ansible/roles/common/templates/conf/input/04-openstack-wsgi.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/03-rabbitmq.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/10-openvswitch.conf.j2 (+2, -2)
ansible/roles/common/templates/conf/input/05-libvirt.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/00-global.conf.j2 (+1, -1)
",-1.407108,-1.24646,0.287254,0.484661,-0.140373,-0.1291,0.039306,-0.395661,-0.040046,0.41246,0.454865,-0.065145,-0.227591,-0.493531,-0.109532
openstack/kolla,I27dfe34ade088228d71f6857ec4f3ab28ee63915,0,0,0.6957,5.3033,0.85,19,11.5,168,0,CI,0,0,0,23,0.024494,1.0,0,0.6957,3,5,0,0.8276,3.2873,2.26,44.35,11.56,0,0,0.325,1,0.8358,0,0,0,0,0,"drop leftovers of RHEL support

As a project we never built RHEL based images so support for them
was not tested.
[SEP]
FILES CHANGED:
docker/ovsdpdk/ovsdpdk/Dockerfile.j2 (+1, -1)
doc/source/support_matrix.rst (+0, -1)
docker/magnum/magnum-base/Dockerfile.j2 (+1, -4)
doc/source/admin/image-building.rst (+0, -18)
docker/macros.j2 (+1, -2)
kolla/template/repos.yaml (+0, -6)
tests/files/process_build_logs.py (+1, -1)
kolla/common/config.py (+2, -4)
kolla/tests/test_methods.py (+0, -11)
docker/ironic/ironic-pxe/extend_start.sh (+2, -2)
kolla/image/build.py (+9, -40)
releasenotes/notes/drop-rhel-support-03ccce1a69bd88a7.yaml (+5, -0)
docker/magnum/magnum-api/Dockerfile.j2 (+1, -4)
docker/magnum/magnum-conductor/Dockerfile.j2 (+1, -4)
tools/validate-binary-build.sh (+1, -1)
docker/base/Dockerfile.j2 (+1, -19)
docker/base/copy_cacerts.sh (+1, -1)
doc/source/admin/kolla_api.rst (+0, -2)
kolla/tests/test_build.py (+3, -49)
",1.434821,-1.673494,0.229225,0.06351,-0.376168,0.306345,-0.219967,-0.223871,-1.04643,-0.040504,-0.165208,0.308842,-0.004842,-0.061355,0.160912
openstack/kolla,I635964a84f0cd5cadccd7ce8040fa36e1300c765,0,0,0.6667,3.2958,0.8077,4,10.0,101,0,Feature,0,0,0,24,0.021071,1.0,0,0.6667,3,2,0,0.8136,1.4761,2.25,10.56,16.0,1,0,0.3462,0,3.7407,0,0,0,0,0,"centos: switch to RDO final release of Wallaby
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -13)
docker/neutron/neutron-base/Dockerfile.j2 (+0, -1)
tests/templates/template_overrides.j2 (+3, -6)
kolla/common/config.py (+1, -1)
",2.210389,0.584286,0.421881,-0.079362,0.135875,0.842842,0.122,0.465475,-0.627475,-0.003477,0.57377,0.761462,-0.370457,-0.478193,-0.005788
openstack/ironic,I86225b3e34c63a0124a2a63f8a624dd00a8d38e4,1,0,0.75,3.7612,0.1667,5,15.75,457,0,Bug Fix,0,0,0,4,0.042553,0.0,0,0.0,5,2,0,1.0,2.2019,3.6,43.13,12.01,1,0,0.4524,1,10.6279,0,0,0,0,0,"Remove a pause before cleaning when fast-tracking

When fast track mode is used, ironic still waits for the next heartbeat
before running the first clean step, because prepare_cleaning
unconditionally returns CLEANWAIT for agent drivers. This patch fixes
it by returning None for fast-track.

Agent code then needs to refresh clean steps before proceeding,
otherwise it will assume an empty steps list.
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent_base.py (+12, -1)
ironic/drivers/modules/deploy_utils.py (+2, -3)
releasenotes/notes/fast-track-opt-d50eab2cc58fddcb.yaml (+5, -0)
ironic/tests/unit/drivers/modules/test_agent.py (+12, -0)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+4, -3)
",-0.056685,-1.840285,0.206564,0.552898,-0.195023,-0.140187,0.362416,-0.568241,-0.000417,0.028785,0.100635,-0.237283,0.252678,-0.057844,0.177792
openstack/kolla,I499251d13ca77aea2215f8a879b7bb8dd51f1c9f,1,0,0.8,3.7842,0.4186,6,12.5,190,0,Doc,0,0,0,15,0.040541,1.0,0,0.8,2,4,0,0.8,2.2493,2.0,52.02,11.4,0,0,0.0,1,4.3182,0,0,0,0,0,"rabbitmq: Move to packagecloud

bintray is being shut down 1st of May 2021, rabbitmq docs direct
users to packagecloud - so let's move.
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-packagecloud-c009ff6d0d2bd02d.yaml (+6, -0)
docker/base/Dockerfile.j2 (+5, -4)
kolla/template/repos.yaml (+10, -8)
docker/base/rabbitmq_rabbitmq-server.repo (+1, -2)
docker/base/rabbitmq_rabbitmq-erlang.repo (+1, -2)
docker/base/sources.list.ubuntu (+2, -2)
",-0.620448,-0.767232,-0.658649,-1.965357,0.582914,-0.149739,1.167128,0.297889,-0.161959,0.235865,0.202735,-0.158424,0.101613,0.084415,-0.159904
openstack/kolla-ansible,I7ae919875fb9dea756ca26d90dc1af791ac766ce,1,0,0.8125,1.0986,0.5,1,3.67,163,0,Feature,0,0,0,16,0.038741,0.6,0,0.4875,2,1,0,0.7619,0.0,2.0,-50.69,16.01,0,0,0.0,0,54.3333,0,0,0,0,0,"Bump up python version for Debian Bullseye

Depends-On: https://review.opendev.org/c/openstack/kolla/+/772479
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",0.654409,3.582437,-1.472112,-0.19954,-1.27074,0.681052,0.431394,-0.241362,0.002039,-0.903117,-0.486551,0.118934,-0.142244,-0.486307,0.244536
openstack/kolla,Ib7147def6aec21e46d49a1c880bd1b53ec5472e6,1,0,0.64,1.9459,0.0,1,3.33,161,0,Feature,0,0,0,25,0.021459,0.0,0,0.0,2,1,0,0.8033,0.0,2.0,-92.65,21.33,1,0,0.0,1,23.0,0,0,0,0,0,"releasenotes: we move to Debian bullseye

Depends-On: https://review.opendev.org/c/openstack/kolla/+/772479
[SEP]
FILES CHANGED:
releasenotes/notes/debian-bullseye-4fedf3b3638783de.yaml (+6, -0)
",-0.675026,1.067945,-2.201931,-1.667896,0.213886,0.074611,0.805347,-0.296885,-0.017885,-0.297746,-0.391938,-0.138274,0.263703,-0.175355,-0.207641
openstack/ironic-python-agent,I9078ef37f1e94382c645ae98ce724ac9ed87c287,1,0,0,5.5255,0.504,3,13.8,808,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.0,1.0044,2.67,66.54,10.74,1,0,0.264,1,3.2191,0,0,0,0,0,"Software RAID: RAID the ESPs

For software RAID in UEFI mode, we create ESPs on all holder disks
and copy the bootloader there. Since there is no mechanism to keep
the ESPs in sync, e.g. on kernel upgrades or when kernel parameters
are updated, the ESPs will get out of sync eventually. This may lead
to a situation where a node boots with outdated parameters or does
not have any of the installed kernels in the boot menu anymore.
This change proposes to RAID the ESPs. While the UEFI firmware will
find an ESP partition (one leg of the mirror), the node will see
an md device and all subsequent updates will go to all member disks.

Also, remove the source ESP after copying in order to avoid mount
confusion (same UUID!).

Story: #2008745
Task: #42103
[SEP]
FILES CHANGED:
releasenotes/notes/software-raid-raid-ESPs-25a2aa117b99620a.yaml (+7, -0)
ironic_python_agent/tests/unit/extensions/test_image.py (+30, -36)
ironic_python_agent/extensions/image.py (+87, -90)
",-2.245082,-1.489782,1.553709,0.164388,-0.251472,0.270861,0.048155,-0.160741,0.021326,-0.087829,0.035556,0.261079,0.2563,0.147173,-0.241717
openstack/kolla,Ibd955869a6f9485dfa4d08a8ad2f4b28b7d59c15,0,0,0.6538,4.9053,0.9328,11,10.33,205,0,CI,0,0,0,26,0.022203,1.0,0,0.6538,3,5,0,0.8065,3.0974,2.27,73.54,6.71,0,0,0.0,1,1.5185,0,0,0,0,0,"Drop ppc64le support

We do not test support for ppc64le on CI or other systems.

In previous cycles it was used by TripleO and now they have own way.
[SEP]
FILES CHANGED:
kolla/image/build.py (+0, -24)
doc/source/support_matrix.rst (+0, -5)
docker/nova/nova-base/Dockerfile.j2 (+0, -8)
doc/source/contributor/adding-a-new-image.rst (+0, -4)
docker/base/Dockerfile.j2 (+0, -25)
releasenotes/notes/drop-ppc64le-516442a16cc9f27c.yaml (+4, -0)
docker/collectd/Dockerfile.j2 (+1, -6)
docker/ironic/ironic-pxe/Dockerfile.j2 (+3, -11)
kolla/template/repos.yaml (+0, -18)
docker/base/sources.list.ubuntu.ppc64le (+0, -23)
kolla/common/config.py (+1, -1)
",1.03648,-0.89204,0.073074,0.385412,-0.462406,0.209617,0.088013,-0.202338,-0.985251,0.27489,-0.177214,-0.151471,-0.00862,-0.252711,0.034748
openstack/kolla,I9db7ec2df050fa20317d84f6cea40d1f5fd42e60,1,0,0.75,2.3026,0.1111,2,11.0,291,0,Feature,0,0,0,8,0.02381,0.0,0,0.0,2,2,0,0.7937,0.9183,2.0,11.09,22.58,0,0,0.0,1,29.1,0,0,0,0,0,"Install Monasca datasource plugin for Grafana

The Monasca Grafana image has been removed. This change provides
a path for Monasca users to switch to using the vanilla Grafana
image.

Depends-On: I8f5a9b220fc8afd6ef07cb5f2142df8c6ead9bc0
[SEP]
FILES CHANGED:
docker/grafana/Dockerfile.j2 (+2, -1)
releasenotes/notes/add-monasca-datasource-to-grafana-06dfe0ce329a7b7f.yaml (+6, -0)
",-1.002324,-0.611833,-1.784569,-0.708351,0.853901,0.210676,0.732431,0.62109,0.316338,0.143394,-0.158457,0.499095,0.106064,-0.061337,0.165406
openstack/kolla-ansible,Ib7ce4ed79c28456281087eb4156577f910c072e7,1,1,0,3.0445,0.05,3,6.67,339,0,Bug Fix,0,0,0,0,0.0,0.625,0,0.0,4,3,0,0.7642,1.0763,2.67,20.29,13.67,0,0,0.0,1,16.1429,0,6,0,16,0,"manila: add glance section in manila-share.conf

Since the Victoria release, manila-share.conf requires a glance section
for some drivers. This change adds the missing section.

It also uses the correct cinder_keystone_user variable to reference the
cinder user.

Closes-Bug: #1921935
[SEP]
FILES CHANGED:
releasenotes/notes/manila-glance-4524ed1e9d488a60.yaml (+5, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+13, -1)
",-0.623076,-0.422972,-0.844636,0.412456,-0.278525,-0.083205,-0.211776,0.081992,0.264698,-0.129883,0.430633,-0.093105,-0.151261,0.071564,0.130415
openstack/kolla,I499251d13ca77aea2215f8a879b7bb8dd51f1c9f,1,0,0.7778,4.1431,0.5968,7,22.5,385,0,Doc,0,0,0,36,0.011353,1.0,0,0.7778,2,5,0,0.7969,2.3687,2.0,29.84,17.0,0,0,0.0,1,6.1111,0,0,0,0,0,"rabbitmq: Move to packagecloud

bintray is being shut down 1st of May 2021, rabbitmq docs direct
users to packagecloud - so let's move.

For Victoria and below, includes I6a3ba599af3deedd450b4ffff6b86a0c04628340
(base: drop Linaro OBS key for CentOS and Ubuntu)

(cherry picked from commit 641b936bc7fd33203a80bb3827fce7c44d010476)
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-packagecloud-c009ff6d0d2bd02d.yaml (+6, -0)
docker/base/Dockerfile.j2 (+5, -15)
kolla/template/repos.yaml (+10, -10)
docker/base/sources.list.debian (+0, -3)
docker/base/rabbitmq_rabbitmq-server.repo (+1, -2)
docker/base/rabbitmq_rabbitmq-erlang.repo (+1, -2)
docker/base/sources.list.ubuntu (+2, -5)
",-0.620448,-0.767232,-0.658649,-1.965357,0.582914,-0.149739,1.167128,0.297889,-0.161959,0.235865,0.202735,-0.158424,0.101613,0.084415,-0.159904
openstack/oslo.messaging,Id3603f4b7e1274b616d76e1c0c009d2ab7f6efb6,0,1,0,1.3863,0.3333,1,14.5,626,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,2,1,0,0.375,0.0,2.0,46.26,13.16,1,0,0.0,0,156.5,0,30,0,105,0,"Use default exchange for direct messaging

Lots of exchanges create problems during failover under high
load. Please see bug report for details.

This is step 1 in the process: only using default exchange
when publishing. Consumers will still consume on separate
exchanges (and on default exchange by default) so this
should be (and tested to be) a non-breaking and
upgrade-friendly change.

Step 2 is to update consumers to only listen on default exchange,
to happen in T release.

Closes-Bug: #1789177
(cherry picked from commit 3a5de89dd686dbd9660f140fdddd9c78b20e1632)
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/impl_rabbit.py (+2, -1)
",-1.536826,-1.269033,0.732108,-1.016019,0.001693,0.136814,0.31587,-0.241119,0.016455,0.242709,0.067774,0.149788,0.167408,-0.078327,-0.104118
openstack/octavia,Idd9021c8a73d1be87f5df40d3f27c0fba9067e3c,1,0,0.6939,3.4012,0.5517,3,22.0,316,0,Bug Fix,0,0,0,49,0.005269,0.2222,0,0.1542,6,2,0,0.5459,1.113,4.0,21.07,21.53,1,0,0.7241,1,10.5333,0,0,0,0,0,"Fix amphora failover flow in amphorav2 driver

Remove amphora_id from the failover flow parameters in amphorav2, it is
unused and it hides in a later task the amphora_id of the newly created
amphora, breaking a simple amphora failover.

Story 2008848
Task 42360
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+7, -14)
octavia/controller/worker/v2/controller_worker.py (+1, -2)
releasenotes/notes/fix-amphora-failover-amphorav2-b19a76ccfdc75245.yaml (+5, -0)
",-0.533143,-1.545914,-0.671384,0.102403,0.41935,0.033005,-0.148633,-0.176413,0.024801,-0.502383,0.117936,0.382132,-0.274434,0.087483,0.26608
openstack/kolla-ansible,Ic251b447026262eab4b406b8432cc009ca97ae82,1,0,0.8235,2.4849,0.0,1,3.56,325,1,Doc,0,0,0,17,0.040964,0.0,0,0.0,3,1,0,0.7664,0.0,3.0,10.23,11.42,0,0,0.0,0,27.0833,0,0,0,0,0,"cephadm: Set auth_allow_insecure_global_id_reclaim to true

Background in [1].
Ubuntu uses pre 15.2.11 client and new 15.2.11 installs default that to false,
therefore not allowing Ubuntu clients to connect.

[1]: https://docs.ceph.com/en/latest/security/CVE-2021-20288/
[SEP]
FILES CHANGED:
roles/cephadm/tasks/main.yml (+11, -0)
",-1.286997,0.797736,-1.034754,0.338719,-0.253272,-0.174143,-0.094535,0.262724,-0.110807,0.872322,-0.02129,-0.435276,-0.212432,-0.063786,0.057202
openstack/kolla-ansible,Ifaf64e3d9d89b2ec36a883fb7458556745b64802,1,0,0.7838,1.6094,0.75,1,10.0,548,0,Feature,0,0,0,37,0.011444,0.0,0,0.0,4,1,0,0.7685,0.0,4.0,4.93,14.67,1,0,0.0,0,109.6,1,0,0,0,0,"Avoid an Ansible quirk in hacluster role

Followup on I91e5c1840ace8f567daf462c4eb3ec1f0c503823

When+run_once do not play nicely. [1]
The general workaround is to use include_tasks. [2]
However, it is very unlikely user wishes to run this role
without having any pacemaker nodes so the simplification that we
use throughout the Kolla Ansible code should be enough.

[1] https://github.com/ansible/ansible/issues/11496
[2] https://github.com/ansible/ansible/issues/11496#issuecomment-412936547
[SEP]
FILES CHANGED:
ansible/roles/hacluster/tasks/bootstrap_service.yml (+1, -3)
",-1.738649,1.219921,0.195083,-0.706024,-0.091878,0.170964,0.700013,-0.246259,-0.104726,0.092001,0.290287,-0.022882,-0.068408,-0.303041,-0.153534
openstack/kolla,I4bd385b53257a60cc55a190138e5d7078f8b64bf,1,0,0.6296,1.7918,0.0,1,7.0,89,0,Doc,0,0,0,27,0.02069,0.0,0,0.0,2,1,0,0.8,0.0,2.0,6.36,25.66,1,0,0.0,1,14.8333,0,0,0,0,0,"docs: deprecate ppc64le in Wallaby
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-ppc64le-2b7b642e79bddd66.yaml (+5, -0)
",2.465262,0.845381,0.606314,-0.802053,0.418294,0.072934,-0.247321,0.029148,-0.772675,0.199536,0.321365,-0.250129,-0.769152,-0.999608,-0.043343
openstack/kolla,Ia4d326601d14c5d55e8f67d8996458fc796583ea,1,0,0.6429,0.6931,0.0,1,8.0,409,0,Feature,0,0,0,28,0.021374,0.5,0,0.3214,2,1,0,0.803,0.0,2.0,-14.9,18.2,0,0,0.0,0,204.5,0,0,0,0,0,"Disable trove for Debian/binary

Package installation fails:

Setting up trove-common (1:14.0.0-2~bpo10+1) ...
install: cannot stat '/usr/share/trove-common/api-paste.ini': No such file or directory
dpkg: error processing package trove-common (--configure):
 installed trove-common package post-installation script subprocess returned error exit status 1
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -0)
",-1.014177,-0.704669,-0.334029,-0.277732,0.330267,-0.753095,-0.340208,0.579771,-0.248108,0.140698,-0.29992,-0.707063,0.530471,0.722459,-0.143576
openstack/kolla-ansible,I9da331e007c25c4a760839c566831769a68507a9,1,1,0.5556,2.5649,0.1667,3,14.5,253,0,Bug Fix,0,0,0,9,0.011166,1.0,0,0.5556,4,2,0,0.7706,1.4591,3.33,17.08,19.59,1,0,0.0,1,19.4615,0,6,0,14,0,"Fix incorrect config of linuxbridge multiple external networks

multiple external networks are supported by linuxbridge and OVS.
Currently the config template only works for OVS

Closes-Bug: #1863935
[SEP]
FILES CHANGED:
releasenotes/notes/linux-bridge-multi-fe8576616fb7d373.yaml (+6, -0)
ansible/roles/neutron/templates/ml2_conf.ini.j2 (+1, -1)
ansible/roles/neutron/templates/linuxbridge_agent.ini.j2 (+3, -1)
",1.243871,-1.006787,-0.184824,-0.038018,-0.233095,0.019285,-0.315103,0.561455,-0.082379,-0.23232,-0.20908,-0.037487,0.261126,-0.314259,0.264415
openstack/kolla,Ifa491b102ad0db7f6dc645ca552d83b53bcf3b46,1,0,0.7895,1.9459,0.0,3,10.5,156,0,Feature,0,0,0,38,0.011739,1.0,0,0.7895,2,2,0,0.806,1.2516,2.0,51.15,9.91,1,0,0.0,0,22.2857,0,0,0,0,0,"Pin erlang

Now that we run without erlang pinned by the repository itself,
let's pin it on our side.
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+4, -0)
docker/rabbitmq/Dockerfile.j2 (+1, -0)
docker/kolla-toolbox/Dockerfile.j2 (+1, -0)
",1.17572,-0.527277,-0.258735,0.898292,-0.173882,0.640505,0.393678,-1.293988,-0.950042,-0.111495,0.174964,0.452881,-0.359552,0.102118,-0.439293
openstack/octavia,Iacf485f8d7ac61e79c3bc9073b40d0813c006745,0,0,0.7,1.7918,0.0,4,10.67,254,0,Bug Fix,0,0,0,50,0.00536,0.6667,0,0.4667,4,1,0,0.5478,1.9219,3.25,40.03,11.77,0,0,0.0,0,42.3333,0,0,0,0,0,"Fix pylint errors

New pylint release catches 'consider-using-with' errors on some class
members. This new checker looks interesting for future errors but it is
not justified for the detected issues.
[SEP]
FILES CHANGED:
octavia/common/base_taskflow.py (+1, -0)
octavia/amphorae/backends/utils/network_namespace.py (+1, -0)
octavia/controller/healthmanager/health_manager.py (+1, -0)
octavia/amphorae/drivers/health/heartbeat_udp.py (+2, -0)
",0.399329,-1.14719,-0.212044,0.379834,-0.261363,-0.00296,-0.288614,-0.996676,-0.257073,0.188147,-0.133978,0.181085,0.126737,-0.422978,0.367866
openstack/octavia,Iebffbb041dd2d8c7418b054c865c45f0eac8459b,0,0,0,2.1972,0.5,1,8.44,625,0,CI,0,0,0,0,0.0,0.125,0,0.0,0,1,0,0.5455,0.0,0.0,25.72,13.38,0,0,0.0,0,69.4444,0,0,0,0,0,"setup.cfg: Replace dashes with underscores

Setuptools v54.1.0 introduces a warning that the use of dash-separated
options in 'setup.cfg' will not be supported in a future version [1].
Get ahead of the issue by replacing the dashes with underscores. Without
this, we see 'UserWarning' messages like the following on new enough
versions of setuptools:

  UserWarning: Usage of dash-separated 'description-file' will not be
  supported in future versions. Please use the underscore name
  'description_file' instead

[1] https://github.com/pypa/setuptools/commit/a2e9ae4cb
[SEP]
FILES CHANGED:
setup.cfg (+4, -4)
",-2.190046,1.261822,0.415311,0.49181,0.052007,0.434232,0.224903,-0.412772,-0.114927,0.529936,0.40197,-0.008542,-0.032502,-0.043444,0.011325
openstack/magnum,I4996060dd18ef3c448d4b225caec53bf0ae0ba75,1,0,0,1.0986,0.0,2,11.0,296,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,0.8,1.0,5.0,64.92,9.85,1,1,0.0,1,98.6667,0,0,0,0,0,"[k8s] Fix CA rotate

Using admin.conf as the kubeconfig to get correct permissions
to run kubectl command to update pods to use the new CA certs.
Besides, now we need to create client certs on master nodes
as well.

Story:2008858
Task: 42379
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/rotate-kubernetes-ca-certs-master.sh (+1, -0)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubemaster.yaml (+1, -0)
",1.003858,-1.302806,-0.147001,0.02147,-0.425713,-0.422415,0.552304,0.054895,-0.167604,-0.43225,0.038853,-0.428337,0.016638,0.437202,-0.367467
openstack/kolla-ansible,I4917ece1951084f6665722ba9a91d47764d3709a,1,0,0.7778,6.1026,0.8767,17,14.67,361,0,CI,0,0,0,9,0.026087,1.0,0,0.7778,5,4,0,0.7727,3.3145,3.65,9.29,23.14,1,0,0.0,1,0.8076,0,0,0,0,0,"Remove Monasca Grafana service

In the Xena cycle it was decided to remove the Monasca
Grafana fork due to lack of maintenance. This commit removes
the service and provides a limited workaround using the
Monasca Grafana datasource with vanilla Grafana.

Depends-On: I9db7ec2df050fa20317d84f6cea40d1f5fd42e60
[SEP]
FILES CHANGED:
ansible/roles/monasca/tasks/config.yml (+0, -19)
ansible/roles/monasca/handlers/main.yml (+0, -53)
ansible/roles/monasca/tasks/deploy.yml (+0, -2)
etc/kolla/passwords.yml (+0, -1)
ansible/roles/monasca/tasks/upgrade.yml (+0, -30)
ansible/roles/grafana/defaults/main.yml (+9, -0)
releasenotes/notes/remove-monasca-grafana-43cf1f74b09a6e54.yaml (+11, -0)
ansible/roles/monasca/tasks/bootstrap.yml (+1, -2)
ansible/roles/monasca/templates/monasca-grafana/monasca-grafana.json.j2 (+0, -23)
doc/source/reference/logging-and-monitoring/monasca-guide.rst (+29, -25)
ansible/roles/haproxy/tasks/precheck.yml (+0, -27)
ansible/roles/monasca/tasks/post_config.yml (+0, -120)
ansible/group_vars/all.yml (+1, -1)
ansible/roles/monasca/templates/monasca-grafana/grafana.ini.j2 (+0, -55)
ansible/roles/monasca/defaults/main.yml (+3, -21)
ansible/roles/monasca/tasks/precheck.yml (+0, -11)
etc/kolla/globals.yml (+1, -1)
",-0.785347,-0.940449,-1.123665,-0.671891,0.472114,0.301027,1.001139,0.602283,0.43856,-0.037015,0.29818,0.599423,0.060975,0.003636,0.098266
openstack/kolla-ansible,I04bafaebba44d162adb908839cdad6f5bb6ee8f7,1,0,0.8,2.0794,0.0,1,7.0,93,0,Feature,0,0,0,10,0.012642,0.0,0,0.0,2,1,0,0.7748,0.0,2.0,-78.24,31.37,1,0,0.0,1,11.625,0,0,0,0,0,"Add Monasca Grafana deprecation notice
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-monasca-grafana-f5bfc61a5d453a8e.yaml (+7, -0)
",2.60109,0.61812,0.774666,-0.032851,0.422099,0.484154,0.583912,1.098027,0.171074,-0.494799,0.645254,0.643975,-0.538253,-0.88234,-0.20327
openstack/kolla,I75d4e4ba52ffb27ac4e434b7b3c00812c5f3b86c,1,0,0.6552,2.8332,0.5,2,9.5,151,0,CI,1,0,0,29,0.022121,1.0,0,0.6552,1,1,0,0.8088,1.0,1.0,54.71,10.12,1,0,1.0,0,8.8824,0,0,0,0,0,"CI: move to Debian 'bullseye' nodes

Now that we build Bullseye based images, do it on Bullseye.
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+4, -4)
.zuul.d/base.yaml (+4, -4)
",1.043288,-0.033688,-0.696028,0.533038,0.480681,-0.01179,0.258201,0.09042,-1.495212,-0.071938,0.284572,-0.068181,-0.238945,-0.058678,-0.267891
openstack/kayobe,I30709df86b4cc334413b76507700dc03e7df2ea1,1,0,1.0,3.6109,0.6944,2,10.5,185,0,Bug Fix,0,0,0,5,0.038462,0.0,0,0.0,4,2,0,0.95,0.65,3.0,43.09,11.82,0,0,0.0,1,5.0,0,0,0,0,0,"Switch to reboot module

The manual SSH command is buggy since it does not respect things
like ansible_ssh_extra_args.

TrivialFix
[SEP]
FILES CHANGED:
releasenotes/notes/fix-selinux-disable-reboot-65c32f5dc895211c.yaml (+6, -0)
ansible/roles/disable-selinux/tasks/main.yml (+5, -25)
",0.586262,-1.996207,-0.130226,-0.441802,-0.062918,-0.02983,-1.37012,-0.38423,-0.210507,-0.142182,-0.001073,-0.226253,-0.520276,0.176499,-0.061082
openstack/kolla-ansible,I482640dd63959143732d86fcffb320cc94611247,1,0,0.8182,3.3673,1.0,6,12.0,189,0,Feature,0,0,0,11,0.013784,0.6,0,0.4909,4,3,0,0.7768,1.8162,2.0,39.56,18.13,0,0,0.1071,0,6.5172,0,0,0,0,0,"Finish removing Monasca Log Transformer

This service was disabled in the Wallaby release and all
references to it can now be removed.
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -3)
ansible/monasca_cleanup.yml (+0, -1)
ansible/site.yml (+0, -1)
ansible/roles/monasca/defaults/main.yml (+0, -17)
tests/templates/inventory.j2 (+0, -3)
ansible/inventory/all-in-one (+0, -3)
",1.436471,-1.158739,-0.323439,0.374164,-0.666661,0.901098,0.134018,0.157189,-0.139124,-0.066671,0.145209,0.781131,-0.786715,-0.036062,-0.57281
openstack/kolla-ansible,I7d825906edc4b78677d839942cba3a158f44b2e2,1,0,0.8333,4.9558,0.9291,6,14.0,209,0,Feature,0,0,0,12,0.014528,1.0,0,0.8333,5,3,0,0.7788,2.0365,4.0,35.51,17.03,0,0,0.0,1,1.4718,0,0,0,0,0,"Remove Monasca Log Metrics service

This service was deprecated in the Wallaby release and we
can now start removing it if it hasn't already been removed.
[SEP]
FILES CHANGED:
ansible/roles/monasca/tasks/config.yml (+0, -18)
ansible/roles/monasca/handlers/main.yml (+0, -15)
ansible/roles/monasca/templates/monasca-log-metrics/log-metrics.conf.j2 (+0, -75)
ansible/roles/monasca/templates/monasca-log-metrics/monasca-log-metrics.json.j2 (+0, -18)
releasenotes/notes/remove-monasca-log-metrics-02a81671f864d1a9.yaml (+7, -0)
ansible/roles/monasca/defaults/main.yml (+3, -5)
",1.387849,-1.304523,-0.429724,0.507528,-0.892025,0.715054,0.442875,-0.14169,-0.388929,0.010788,0.599475,0.818568,-0.800304,0.158441,-0.277126
openstack/tooz,Iaab5ce609c0dcf7085f5dd43efbd37eb4b88f17b,1,0,1.0,4.8903,0.4015,2,8.67,245,0,Feature,0,0,1,1,0.333333,0.125,0,0.125,2,2,0,0.6,0.1133,1.0,28.84,12.7,1,0,0.0,0,1.8421,0,0,0,0,0,"Retry on redis connection errors

Sometimes, connections get closed by the server. This change
adds retrying to the code.

(cherry picked from commit a025b4d4ee9fe1bd722960ea03445034580bec6f)
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
tooz/drivers/redis.py (+78, -52)
",-2.827677,0.02209,0.819401,-2.073574,0.545166,0.22441,0.823696,-0.060912,0.363645,0.018375,-0.013083,0.038537,-0.046686,-0.346188,-0.107789
openstack/kolla,I543965a2741cebfa759576a4c75669a7bacd4208,0,0,0.6667,5.3706,0.4766,14,4.33,318,0,Feature,0,0,0,30,0.022607,1.0,0,0.6667,3,6,0,0.8116,2.9347,2.14,-12.32,15.58,1,0,0.0561,1,1.4791,0,0,0,0,0,"move to Debian 'bullseye'

Bullseye is now in hard freeze cycle and goes for release.

https://release.debian.org/bullseye/freeze_policy.html

Co-Authored-By: Michal Nasiadka <mnasiadka@gmail.com>

(cherry-pick from master e0f8cbc50cf7184930a501b0f5452a64f523cd6f)
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-server/Dockerfile.j2 (+4, -0)
kolla/template/repos.yaml (+0, -2)
tests/templates/template_overrides.j2 (+1, -1)
docker/mariadb/mariadb-server/security_reset.expect.debian (+67, -0)
kolla/common/config.py (+2, -2)
kolla/image/build.py (+6, -10)
.zuul.d/debian.yaml (+6, -2)
doc/source/matrix_x86.csv (+3, -3)
doc/source/matrix_aarch64.csv (+4, -4)
docker/base/apt_preferences.debian (+1, -46)
docker/base/Dockerfile.j2 (+12, -2)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+2, -1)
docker/base/sources.list.debian (+3, -28)
kolla/tests/test_build.py (+1, -1)
",-1.57913,1.249615,-1.5317,-0.809743,0.194189,0.096918,0.856236,0.033241,-0.165375,0.021769,0.580978,-0.098345,0.123456,0.313067,-0.363066
openstack/kolla,Ib7147def6aec21e46d49a1c880bd1b53ec5472e6,0,0,0.6452,1.9459,0.0,1,5.0,230,0,Feature,0,0,0,31,0.020117,1.0,0,0.6452,2,1,0,0.8,0.0,2.0,-63.32,18.0,1,0,0.0,1,32.8571,0,0,0,0,0,"releasenotes: we move to Debian bullseye

Depends-On: https://review.opendev.org/c/openstack/kolla/+/788304
(cherry picked from commit bcdec58c69ca68c776d69f1af38d0bc26da4727a)
[SEP]
FILES CHANGED:
releasenotes/notes/debian-bullseye-4fedf3b3638783de.yaml (+6, -0)
",-0.675026,1.067945,-2.201931,-1.667896,0.213886,0.074611,0.805347,-0.296885,-0.017885,-0.297746,-0.391938,-0.138274,0.263703,-0.175355,-0.207641
openstack/octavia,I5341949513e6eb814655ee8f14a01b061894fc34,1,0,0.6863,2.4849,0.1818,2,14.33,340,0,Bug Fix,0,0,0,51,0.005464,0.5,0,0.3431,4,1,0,0.5431,0.994,3.0,28.99,17.83,0,0,0.5455,0,28.3333,0,0,0,0,0,"Fix task_flow.max_workers with persistence in amphorav2

When jobboard was enabled in amphorav2, the [task_flow]/max_workers
option was unused, updating a LB with a lot of children could have
failed because of dozens of concurrent connections to the database.

Story 2008860
Task 42381
[SEP]
FILES CHANGED:
octavia/common/base_taskflow.py (+4, -1)
octavia/tests/unit/common/test_base_taskflow.py (+5, -1)
",-0.787328,-1.138539,-0.609812,0.031897,0.05594,0.017247,-0.512075,-0.151647,-0.188022,-0.00174,-0.075649,-0.098611,-0.135529,0.070951,0.141265
openstack/kolla-ansible,Ibffa019e2106784e97f5c482106bb5082f788752,1,0,0.7949,3.091,0.0,4,1.71,199,0,Feature,0,0,0,39,0.012026,1.0,0,0.7949,4,3,0,0.7807,1.8727,3.5,-55.76,17.35,1,0,0.0,1,9.0455,0,0,0,0,0,"Deprecate enable_host_ntp

As agreed during IRC meeting. [1]

[1] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-04-07-15.00.html
[SEP]
FILES CHANGED:
doc/source/reference/deployment-and-bootstrapping/bootstrap-servers.rst (+5, -0)
ansible/roles/baremetal/defaults/main.yml (+2, -0)
ansible/roles/baremetal/tasks/post-install.yml (+7, -0)
releasenotes/notes/deprecate-enable-host-ntp-3ad934c097f18b1b.yaml (+7, -0)
",-0.401123,2.864534,-1.769378,0.220863,-1.0917,0.077087,0.299501,0.167443,0.132676,0.24526,-0.333914,-0.186825,-0.455569,0.212296,-0.12745
openstack/ironic-python-agent,Ie3bd49add9a57fabbcdcbae4b73309066b620d02,1,0,1.0,3.9703,0.0192,3,12.73,888,0,Bug Fix,0,0,0,1,0.2,1.0,0,1.0,4,2,0,0.5,1.0602,2.67,56.74,11.66,0,0,0.75,1,16.7547,0,0,0,0,0,"Fix NVMe Partition image on UEFI

The _manage_uefi code has a check where it attempts to just
identify the precise partition number of the device, in order
for configuration to be parsed and passed. However, the same code
did not handle the existence of a `p1` partition instead of just a
partition #1. This is because the device naming format is different
with NVMe and Software RAID.

Likely, this wasn't an issue with software raid due to how complex the
code interaction is, but the docs also indicate to use only whole disk
images in that case.

This patch was pulled down my one RH's professional services folks
who has confirmed it does indeed fix the issue at hand. This is noted
as a public comment on the Red Hat bugzilla.
https://bugzilla.redhat.com/show_bug.cgi?id=1954096

Story: 2008881
Task: 42426
Related: rhbz#1954096
[SEP]
FILES CHANGED:
releasenotes/notes/fix-nvme-partition-image-handling-b8487133a188fd32.yaml (+6, -0)
ironic_python_agent/tests/unit/extensions/test_image.py (+39, -0)
ironic_python_agent/extensions/image.py (+6, -1)
",-2.640537,-0.949773,2.172448,-0.7494,-0.875931,0.254973,-0.070605,-0.126671,0.078524,0.015231,0.23322,-0.003632,-0.210748,0.051682,0.184156
openstack/ironic-python-agent-builder,Id3dc4eaad9b698241ad70a69f93b8463bc15de0d,1,0,0,2.0794,0.0,1,12.75,367,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,1.0,0.0,4.0,64.51,9.81,1,0,0.0,0,45.875,0,0,0,0,0,"Fix build error on aarch64

Fix ""error: invalid command 'bdist_wheel'"" when building on aarch64.

For aarch64 platform, it seems it always tries to build wheels first for
python packages which have no wheels in PyPi. Although it will install
the source packages successfully at last.

Task: #41701
Story: #2008562
[SEP]
FILES CHANGED:
dib/ironic-python-agent-ramdisk/install.d/ironic-python-agent-ramdisk-source-install/60-ironic-python-agent-ramdisk-install (+7, -0)
",0.071613,-1.8044,0.021447,-0.121067,-0.581229,-0.168293,-0.172443,0.191061,-0.090533,0.351696,0.03178,-0.33048,0.230828,0.291667,0.135521
openstack/octavia,I36601dc7423fb50ea1d94c82764986a67ee3e10e,0,0,0.6923,1.6094,0.5,1,7.25,249,0,Feature,1,0,1,52,0.005564,0.2,1,0.1385,0,1,0,0.5451,0.0,0.0,30.28,11.18,0,0,1.0,0,49.8,0,0,0,0,0,"Cap hacking and pylint

Cap hacking (4.1.0 added a new checker that conflicts with one of our
internal checker check_no_import_mock)
Cap pylint (2.8 introduced new 'consider-using-with' checker)
[SEP]
FILES CHANGED:
test-requirements.txt (+2, -2)
",0.109583,-1.098002,-1.395292,-1.724121,0.831269,0.049839,0.331551,-0.185064,-0.114513,0.210459,-0.523824,-0.255911,-0.107617,0.044147,-0.092651
openstack/octavia,I36601dc7423fb50ea1d94c82764986a67ee3e10e,0,0,0.6792,1.0986,0.5,1,6.67,176,0,Feature,1,0,1,53,0.005669,0.1905,1,0.1294,0,1,0,0.5427,0.0,0.0,39.33,10.67,0,0,1.0,0,58.6667,0,0,0,0,0,"Cap hacking

Cap hacking (4.1.0 added a new checker that conflicts with one of our
internal checker check_no_import_mock)
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",0.109583,-1.098002,-1.395292,-1.724121,0.831269,0.049839,0.331551,-0.185064,-0.114513,0.210459,-0.523824,-0.255911,-0.107617,0.044147,-0.092651
openstack/octavia,I36601dc7423fb50ea1d94c82764986a67ee3e10e,0,0,0.6667,1.0986,0.5,1,8.33,245,0,Feature,1,0,1,54,0.005775,0.1818,1,0.1212,0,1,0,0.5404,0.0,0.0,35.94,11.33,0,0,1.0,0,81.6667,0,0,0,0,0,"Cap hacking

Cap hacking (4.1.0 added a new checker that conflicts with one of our
internal checker check_no_import_mock)

(cherry picked from commit 7ab43edc1cdb743d6f7dd25480ab1b357411976d)
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",0.109583,-1.098002,-1.395292,-1.724121,0.831269,0.049839,0.331551,-0.185064,-0.114513,0.210459,-0.523824,-0.255911,-0.107617,0.044147,-0.092651
openstack/kayobe,I0c7d57231a63e1f9ff3fdcdef1be7fff57160e08,1,0,0.9444,1.3863,1.0,1,4.25,147,0,Feature,0,1,0,18,0.039823,0.0,0,0.0,2,1,0,0.9512,0.0,2.0,8.44,18.17,0,0,0.0,0,36.75,0,0,0,0,0,"Revert to binary images for nova

The centos binary images now include nova 23.0.0 packages.
[SEP]
FILES CHANGED:
playbooks/kayobe-overcloud-upgrade-base/globals.yml.j2 (+0, -3)
",1.394828,-0.720792,-0.076211,0.428058,0.302794,-0.016566,0.175743,0.916959,-0.636546,0.259469,-0.324572,0.457043,-0.318018,-0.03748,-0.147747
openstack/kolla,I91a90e38509bab2bd896909d796d09286dc2b9af,1,0,0.625,2.0794,1.0,1,9.0,228,0,Feature,0,1,0,32,0.020685,0.0,0,0.0,2,1,0,0.7887,0.0,2.0,62.97,9.53,0,0,0.0,1,28.5,0,0,0,0,0,"Revert ""deprecate use of GnuPG ids for APT keys""

This reverts commit 2534c65dac19f576c60f7958d9d74a291447be49.

Reason for revert: due to PPA use APT keys stays for longer.
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-apt-keys-eff6e68272923b6b.yaml (+0, -7)
",-0.098817,-0.315945,-1.841006,-1.018146,1.073735,0.513677,0.607258,-0.192999,0.168961,0.155364,-0.212657,0.271909,-0.076424,-0.322854,-0.255146
openstack/kolla,Ia53ae5130cf621a031681192ab0c881e6a861d0f,1,0,0.8,1.6094,0.5,1,8.0,89,0,Bug Fix,1,0,0,40,0.012255,1.0,0,0.8,1,1,0,0.7917,0.0,1.0,-2.21,18.2,1,1,1.0,0,17.8,0,0,0,0,0,"[CI] Fix Ubuntu cephadm jobs names
[SEP]
FILES CHANGED:
.zuul.d/ubuntu.yaml (+2, -2)
",2.297148,1.887068,0.68337,-0.381897,0.721284,0.739643,-0.162092,0.210965,-1.000309,0.164567,0.665573,-0.115926,0.233992,-0.391866,-0.930423
openstack/kolla-ansible,Ifb3e51891de33e5d698571b898f7a471cfe89718,1,0,0.878,1.6094,0.5,2,9.0,92,0,Bug Fix,1,0,0,41,0.021299,0.6,0,0.5268,1,2,0,0.7826,1.0,1.0,9.7,16.93,0,0,1.0,1,18.4,0,0,0,0,0,"CI: Fix nfv job with kolla dependency
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
zuul.d/base.yaml (+1, -1)
",2.51446,0.758228,0.779226,-0.3069,0.732185,-0.254678,0.338594,0.396012,-0.539371,-0.152644,0.47068,-0.308185,0.176341,-0.271122,0.029562
openstack/kolla,I1d68a47f78b925af76c44c61af7da1465371e721,1,0,0.6364,3.3673,0.1071,2,6.33,151,0,Feature,0,0,0,33,0.021236,1.0,0,0.6364,2,1,0,0.7945,0.9963,2.0,53.47,6.74,0,0,0.0,0,5.2069,0,0,0,0,0,"CentOS on AArch64 has only Erlang 22

RabbitMQ 3.8.14 is the last version with Erlang 22 support
[SEP]
FILES CHANGED:
docker/rabbitmq/Dockerfile.j2 (+12, -1)
docker/kolla-toolbox/Dockerfile.j2 (+13, -2)
",2.117336,-0.239437,0.254463,-0.501487,-0.273771,0.662698,0.395021,1.18078,-0.711738,0.46038,-0.059554,0.428821,-0.825596,-0.150016,0.473297
openstack/kayobe,I4b4a8d1c848bb992f65860b058cb9fd9d77613d0,1,0,0.881,4.4188,0.2805,6,9.0,490,0,Doc,0,0,0,42,0.021773,0.4,0,0.3524,5,2,0,0.9524,2.324,3.0,15.97,10.27,1,0,0.1463,0,5.9036,0,0,0,0,0,"docs: add variable for current branch

This allows us to include the correct branch when cloning repositories
in documentation.

Method adapted from OpenStack Ansible documentation. A backslash is
added on purpose before repository URLs to bypass highlighting which
makes them less readable (dark text on dark background).

https://opendev.org/openstack/openstack-ansible/src/branch/master/doc/source/conf.py

Story: 2008851
Task: 42366
[SEP]
FILES CHANGED:
doc/source/contributor/testing.rst (+7, -5)
doc/source/contributor/automated.rst (+18, -10)
doc/source/contributor/vagrant.rst (+4, -2)
doc/source/conf.py (+22, -0)
doc/source/configuration/scenarios/all-in-one/overcloud.rst (+3, -3)
doc/source/installation.rst (+5, -3)
",-0.940966,-0.187805,-0.434863,-0.210046,-0.650188,-0.36002,0.137479,0.227887,0.154566,0.033819,-0.250565,-0.453401,0.307684,0.099996,-0.349579
openstack/ironic,I6ecbe8ae4c775f5a39b68ff698bde655795e5db7,1,0,0,4.2767,0.0141,4,24.0,599,0,Feature,0,0,0,0,0.0,0.0,0,0.0,5,2,0,1.0,1.8883,3.0,39.71,16.27,1,0,0.4225,1,8.3194,0,0,0,0,0,"Provide an option to not cache bootable iso ramdisks

The behavior when a bootable iso is provided behind an http server is
to download and serve the image from the conductor; the image is
removed only when the node is undeployed.
In certain cases, for example on large deployments, this could cause
undesired behaviors, like the conductor nodes running out of disk storage.
We provide an option to avoid this event directly using the original url of
the bootable iso that is then served directly by the external http server
where it is hosted.
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/test_image_utils.py (+30, -0)
releasenotes/notes/option-no-cache-http-ramdisk-62fc29cdd1d5b152.yaml (+14, -0)
ironic/drivers/modules/image_utils.py (+10, -1)
ironic/conf/deploy.py (+16, -0)
",-1.122441,-1.828488,0.60064,1.079771,-0.065372,-0.069769,1.129974,-0.064905,0.293659,-0.080878,0.105301,0.307088,0.069927,-0.18074,-0.102938
openstack/kolla,Ie5bacf5d76850e51aa5f20b34759f76f89f73a2c,0,0,0.8049,1.9459,0.5,1,8.0,89,0,Bug Fix,0,0,0,41,0.012546,1.0,0,0.8049,2,1,0,0.7973,0.0,2.0,18.94,13.2,1,0,0.0,0,12.7143,0,0,0,0,0,"Fix RabbitMQ and Erlang pins again
[SEP]
FILES CHANGED:
docker/rabbitmq/Dockerfile.j2 (+3, -3)
",2.601126,1.16479,1.35426,-0.008092,0.772583,0.362764,-0.091176,0.648051,-0.848521,0.27559,0.314254,-0.505084,0.302981,-0.503374,0.032594
openstack/kayobe,I62ef7746aca4c6889526692cd0897e422937e70e,1,0,0.8837,1.7918,0.0,1,13.83,592,0,Bug Fix,0,0,0,43,0.021382,0.0,0,0.0,4,1,0,0.9535,0.0,4.0,39.9,13.24,0,0,0.0,0,98.6667,0,0,0,0,0,"Ubuntu: avoid shadowing of networkd config files

Kayobe removes any systemd-networkd configuration generated by netplan,
since it can shadow our own configuration. This is performed via a
handler, but in practice it may run after the handler that restarts
systemd-networkd. This can leave the system using the netplan
configuration, which might not be correct. For example, if the interface
should be a bridge port.

This change fixes the issue by flushing handlers before importing the
systemd-networkd role.

Story: 2004960
Task: 42415
[SEP]
FILES CHANGED:
ansible/roles/network-debian/tasks/main.yml (+5, -0)
",-0.808231,-2.054196,0.653045,0.147201,-0.315433,-0.524385,0.190283,0.236505,0.000404,0.011531,0.128515,0.251314,0.191192,0.286765,-0.035173
openstack/kolla,Ic5abc4b87fd76f87aba383abf43e95ba70629fcb,1,0,0.7857,3.4965,0.6875,1,11.11,665,1,CI,1,0,0,42,0.012828,0.5,0,0.3929,2,1,0,0.7867,0.0,2.0,41.59,12.84,1,1,1.0,0,20.1515,0,0,0,0,0,"[CI] Trust only infra mirrors

Infra mirrors get their indices rebuilt to avoid broken
indices (due to partial update).
Unfortunately, this wipes out the cryptographic signatures.
Our approach so far was disabling apt security features globally.
However, this is not a valid choice for external repos.
It hid an issue we introduced with new RabbitMQ repos missing
proper keys installed in the image.
This caused permanent failures outside of our CI.

Our process should be as close as possible to users' experience.
This patch makes CI trust only the mirrors that have their indices
rebuilt (so infra mirrors).
[SEP]
FILES CHANGED:
tests/templates/template_overrides.j2 (+10, -22)
",-1.799811,-1.455442,1.072303,-0.807398,0.109453,0.214519,0.389396,-0.137845,-0.400667,-0.091866,0.053736,0.027185,0.213262,-0.410612,-0.292458
openstack/kayobe,I3d231076052fbfa8416f34c038c02fd10a1c37f2,1,0,0.8864,3.2581,0.24,6,31.0,243,0,Feature,0,0,0,44,0.021825,1.0,0,0.8864,3,3,0,0.9545,2.5649,2.5,25.27,24.01,0,0,0.0,1,9.3462,0,0,0,0,0,"Add os_release variable, build CentOS stream images

* add os_release variable
* build CentOS stream overcloud root disk images
* build CentOS stream IPA images

Story: 2008795
Task: 42417
[SEP]
FILES CHANGED:
etc/kayobe/bifrost.yml (+1, -2)
ansible/group_vars/all/globals (+4, -0)
releasenotes/notes/os-distribution-69445eb19a611d43.yaml (+4, -1)
etc/kayobe/globals.yml (+4, -0)
ansible/group_vars/all/ipa (+4, -0)
ansible/group_vars/all/bifrost (+2, -3)
",0.136863,-0.278777,-0.512278,0.19532,1.048822,0.028365,-1.259866,0.346238,-0.08732,-0.546344,-0.242018,-0.230468,0.765532,0.683812,-0.028549
openstack/kolla,Ie8eec4cb4e29e7f659228e2792c13c01dfb4a41c,1,0,0.8889,3.091,0.4762,2,18.0,151,0,Doc,0,0,0,45,0.022048,0.5,1,0.4444,3,1,0,0.7895,0.7919,2.5,14.67,18.31,0,0,0.0,0,6.8636,0,0,0,0,0,"docs: update supported OS distros

* correct base container image info
* show RHEL as deprecated
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+8, -8)
doc/source/admin/image-building.rst (+3, -2)
",1.635941,-1.371283,-0.06115,-0.136605,0.461598,-0.182444,-0.588392,0.150574,-0.416602,-0.358761,-0.306292,-0.240279,0.395109,-0.010087,-0.410595
openstack/kolla,I11256c674c42e35496146ff64fee1e8e04c30d2c,1,0,0.7907,1.7918,0.2,1,10.0,250,1,Bug Fix,0,0,0,43,0.013007,0.5789,0,0.4578,2,1,0,0.7922,0.0,2.0,27.49,13.33,1,0,0.0,0,41.6667,0,0,0,0,0,"Install RabbitMQ repo key on Ubuntu and Debian

It was missed previously.
CI did not detect it because it ignores apt security issues.
That gets fixed in Ic5abc4b87fd76f87aba383abf43e95ba70629fcb
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+4, -1)
",0.505028,-0.881685,-1.646582,-1.493833,0.592414,0.44999,0.946722,-0.476345,-0.081932,-0.014209,0.072892,0.11372,-0.173645,-0.233622,0.229817
openstack/kolla,I5cade6c97978c38eb60eee43d6f065a9746d4bb8,1,0,0.7955,2.3026,0.0,1,6.33,202,0,CI,1,1,0,44,0.013289,1.0,0,0.7955,1,1,0,0.7949,0.0,1.0,22.3,10.95,0,0,1.0,0,20.2,0,0,0,0,0,"Revert ""CI: drop ubuntu-aarch64 job""

This reverts commit 781dd8a01ed4951e6242f0065eb4e692c2942dcf.

Reason for revert: It should be passing again.
[SEP]
FILES CHANGED:
.zuul.d/ubuntu.yaml (+9, -0)
",-0.347653,-0.345806,-1.668382,-2.207804,1.049008,0.165809,1.4912,-0.256907,0.30152,0.207861,0.198711,-0.12437,0.14761,0.229022,-0.153083
openstack/kolla,Id6df7a0b8c065d886a555bfa0f71155a8c0660a2,1,0,0.6471,1.9459,0.5,1,6.67,220,0,Bug Fix,1,1,0,34,0.021492,1.0,0,0.6471,1,1,0,0.7975,0.0,1.0,18.18,10.67,0,0,1.0,0,31.4286,0,0,0,0,0,"Revert ""CI: temporarily disable CentOS/AArch64 testing""

This reverts commit 5cc3bafc2c46c7b431284199b600f70c4f1c13a7.

Reason for revert: Issue got fixed in CentOS.
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+3, -3)
",-0.769261,-0.846636,-1.808311,-2.222923,1.046863,0.061112,1.619842,0.00742,0.134995,0.575648,0.335155,-0.168451,0.091889,0.275341,-0.007844
openstack/python-octaviaclient,I91c4e1829e33d9a3bb3f01629275e9a380e6d07a,0,0,0.0,2.1972,0.5,1,8.44,625,0,CI,0,0,0,1,0.111111,0.1212,0,0.0,0,1,0,0.1136,0.0,0.0,19.05,13.9,0,0,0.0,0,69.4444,0,0,0,0,0,"setup.cfg: Replace dashes with underscores

Setuptools v54.1.0 introduces a warning that the use of dash-separated
options in 'setup.cfg' will not be supported in a future version [1].
Get ahead of the issue by replacing the dashes with underscores. Without
this, we see 'UserWarning' messages like the following on new enough
versions of setuptools:

  UserWarning: Usage of dash-separated 'description-file' will not be
  supported in future versions. Please use the underscore name
  'description_file' instead

[1] https://github.com/pypa/setuptools/commit/a2e9ae4cb
[SEP]
FILES CHANGED:
setup.cfg (+4, -4)
",-2.190045,1.261822,0.41531,0.49181,0.052007,0.434232,0.224903,-0.412772,-0.114927,0.529936,0.40197,-0.008542,-0.032502,-0.043444,0.011325
openstack/kolla,Id6df7a0b8c065d886a555bfa0f71155a8c0660a2,0,0,0.6571,1.9459,0.5,1,8.33,289,0,Bug Fix,1,1,0,35,0.02204,1.0,0,0.6571,1,1,0,0.8,0.0,1.0,15.64,11.33,0,0,1.0,0,41.2857,0,0,0,0,0,"Revert ""CI: temporarily disable CentOS/AArch64 testing""

This reverts commit 5cc3bafc2c46c7b431284199b600f70c4f1c13a7.

Reason for revert: Issue got fixed in CentOS.

(cherry picked from commit bfea49246db981ea2f0a6fbc5343dd8f2a55d746)
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+3, -3)
",-0.769261,-0.846636,-1.808311,-2.222923,1.046863,0.061112,1.619842,0.00742,0.134995,0.575648,0.335155,-0.168451,0.091889,0.275341,-0.007844
openstack/kolla,I2b084ea78b236623b174473f411bae04e624a3e9,1,0,0.6389,1.0986,0.5,1,16.0,225,0,CI,1,0,0,36,0.022585,0.6,0,0.3833,2,1,0,0.7901,0.0,2.0,47.83,12.65,0,0,1.0,0,75.0,0,0,0,0,0,"CI: drop bashism from template overrides

[[ is bash only

In many distributions /bin/sh == bash but not in Debian and derived
where it is dash (very simple POSIX shell).
[SEP]
FILES CHANGED:
tests/templates/template_overrides.j2 (+1, -1)
",1.304241,-2.01288,0.31694,-0.655738,-0.352172,-0.376501,-0.431737,0.081317,-0.767165,0.128048,-0.687901,-0.231828,0.157769,0.159763,-0.261666
openstack/kolla-ansible,I8d3a320c9fb19e18d959c555d16b736b85e010cd,1,0,0.6486,3.2189,0.25,2,5.67,139,0,CI,1,0,0,37,0.023183,0.3077,0,0.1996,1,1,0,0.7845,0.9183,1.0,46.81,14.03,1,1,1.0,1,5.56,0,0,0,0,0,"[CI] Move to Debian Bullseye

Wallaby upgrades run on Buster.
To be amended in Xena.
[SEP]
FILES CHANGED:
zuul.d/nodesets.yaml (+14, -2)
zuul.d/jobs.yaml (+4, -4)
",1.682267,-0.333086,-0.526842,-0.593519,-0.623319,0.812702,-0.446598,0.706705,-0.955112,0.041639,0.534641,0.471923,-0.481944,0.207186,-1.019344
openstack/kolla-ansible,Ie109d15db1e26e20b78efdb4ab0653d24054820f,1,0,0.8,2.8904,0.0,3,1.43,176,0,Feature,0,0,0,45,0.013554,0.0,0,0.0,4,2,0,0.7863,1.5657,3.33,-65.33,16.57,1,0,0.0,1,9.7778,0,0,0,0,0,"Deprecate tempest and rally

Per [1].

[1] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-04-28-15.00.html
[SEP]
FILES CHANGED:
ansible/roles/tempest/tasks/main.yml (+5, -0)
ansible/roles/rally/tasks/main.yml (+5, -0)
releasenotes/notes/deprecate-tempest-and-rally-2418cbe2a9f315a4.yaml (+7, -0)
",-0.502599,3.699628,-2.062437,0.292313,-1.108669,0.247821,0.296573,-0.008857,-0.036781,0.170526,-0.535796,0.13644,-0.301548,0.435611,-0.226158
openstack/kolla,I4cd3d7f67068157b0de2c0a61dff622a1968b71d,1,0,0.8043,3.3322,0.2222,8,1.43,176,0,Feature,0,0,0,46,0.013785,0.75,0,0.6033,2,5,0,0.7927,2.8419,1.75,-56.87,16.57,1,0,0.0,1,6.2857,0,0,0,0,0,"Deprecate tempest and rally

Per [1].

[1] http://eavesdrop.openstack.org/meetings/kolla/2021/kolla.2021-04-28-15.00.html
[SEP]
FILES CHANGED:
doc/source/matrix_x86.csv (+2, -2)
doc/source/matrix_aarch64.csv (+2, -2)
releasenotes/notes/deprecate-tempest-and-rally-0647efa7209cf03a.yaml (+7, -0)
README.rst (+2, -2)
docker/rally/Dockerfile.j2 (+2, -0)
docker/rally/extend_start.sh (+2, -0)
docker/tempest/Dockerfile.j2 (+2, -0)
docker/tempest/extend_start.sh (+2, -0)
",-0.502599,3.699628,-2.062437,0.292313,-1.108669,0.247821,0.296573,-0.008857,-0.036781,0.170526,-0.535796,0.13644,-0.301548,0.435611,-0.226158
openstack/kolla,I5cade6c97978c38eb60eee43d6f065a9746d4bb8,0,0,0.8085,2.3026,0.0,1,8.0,271,0,CI,1,1,0,47,0.013971,1.0,0,0.8085,1,1,0,0.7952,0.0,1.0,15.42,11.53,0,0,1.0,0,27.1,0,0,0,0,0,"Revert ""CI: drop ubuntu-aarch64 job""

This reverts commit 781dd8a01ed4951e6242f0065eb4e692c2942dcf.

Reason for revert: It should be passing again.

(cherry picked from commit 9e4df387c2f6f16ab1ff327b76492a1af6b549ab)
[SEP]
FILES CHANGED:
.zuul.d/ubuntu.yaml (+9, -0)
",-0.347653,-0.345806,-1.668382,-2.207804,1.049008,0.165809,1.4912,-0.256907,0.30152,0.207861,0.198711,-0.12437,0.14761,0.229022,-0.153083
openstack/kolla,Ic5abc4b87fd76f87aba383abf43e95ba70629fcb,1,0,0.7917,3.4965,0.6875,1,11.67,734,1,CI,1,0,0,48,0.014231,0.6667,0,0.5278,2,1,0,0.7857,0.0,2.0,39.49,13.05,1,1,1.0,0,22.2424,0,0,0,0,0,"[CI] Trust only infra mirrors

Infra mirrors get their indices rebuilt to avoid broken
indices (due to partial update).
Unfortunately, this wipes out the cryptographic signatures.
Our approach so far was disabling apt security features globally.
However, this is not a valid choice for external repos.
It hid an issue we introduced with new RabbitMQ repos missing
proper keys installed in the image.
This caused permanent failures outside of our CI.

Our process should be as close as possible to users' experience.
This patch makes CI trust only the mirrors that have their indices
rebuilt (so infra mirrors).

(cherry picked from commit c364c8be85f4653bf7af1c7ac0378823553e7441)
[SEP]
FILES CHANGED:
tests/templates/template_overrides.j2 (+10, -22)
",-1.799811,-1.455442,1.072303,-0.807398,0.109453,0.214519,0.389396,-0.137845,-0.400667,-0.091866,0.053736,0.027185,0.213262,-0.410612,-0.292458
openstack/kolla,Ic5abc4b87fd76f87aba383abf43e95ba70629fcb,1,0,0.7959,3.4965,0.6875,1,11.67,734,1,CI,1,0,0,49,0.014391,0.7143,0,0.5685,2,1,0,0.7882,0.0,2.0,39.49,13.05,1,1,1.0,0,22.2424,0,0,0,0,0,"[CI] Trust only infra mirrors

Infra mirrors get their indices rebuilt to avoid broken
indices (due to partial update).
Unfortunately, this wipes out the cryptographic signatures.
Our approach so far was disabling apt security features globally.
However, this is not a valid choice for external repos.
It hid an issue we introduced with new RabbitMQ repos missing
proper keys installed in the image.
This caused permanent failures outside of our CI.

Our process should be as close as possible to users' experience.
This patch makes CI trust only the mirrors that have their indices
rebuilt (so infra mirrors).

(cherry picked from commit c364c8be85f4653bf7af1c7ac0378823553e7441)
[SEP]
FILES CHANGED:
tests/templates/template_overrides.j2 (+10, -22)
",-1.799811,-1.455442,1.072303,-0.807398,0.109453,0.214519,0.389396,-0.137845,-0.400667,-0.091866,0.053736,0.027185,0.213262,-0.410612,-0.292458
openstack/kayobe,Iaf0dfb34750ba8b8d74a043587a2035b511de6ad,0,0,0.5,4.7536,0.5304,7,5.86,329,0,Feature,0,0,0,2,0.166667,0.0,0,0.0,4,2,0,0.9556,2.7426,4.0,37.88,10.15,1,0,0.0,0,2.8362,0,0,0,0,0,"Sync the names and content of the repo-files for CentOS8

Since 8.3.2011 release of CentOS the repo-files renamed and the content
is slightly changed. This change sync the templates used in role with
upstream changes.
[SEP]
FILES CHANGED:
ansible/roles/dnf/templates/CentOS-Base.repo.j2 (+0, -19)
ansible/roles/dnf/templates/CentOS-Linux-Extras.repo.j2 (+17, -0)
ansible/roles/dnf/templates/CentOS-Linux-AppStream.repo.j2 (+17, -0)
ansible/roles/dnf/templates/CentOS-AppStream.repo.j2 (+0, -19)
ansible/roles/dnf/templates/CentOS-Linux-BaseOS.repo.j2 (+17, -0)
ansible/roles/dnf/tasks/local-mirror.yml (+3, -3)
ansible/roles/dnf/templates/CentOS-Extras.repo.j2 (+0, -20)
",1.123838,-1.244954,0.32823,0.604737,-0.255793,-0.082748,0.435036,0.422477,-0.376702,0.072577,-0.701252,0.173986,-0.219644,0.367006,0.040256
openstack/kolla,I22db3cd4cb608332261824626e3b8768821b8dd0,0,0,0.6579,3.4965,0.5625,3,16.0,555,0,Feature,0,0,0,38,0.023457,0.6,0,0.3947,2,2,0,0.7907,1.3894,2.0,53.12,12.4,0,0,0.0,0,16.8182,0,0,0,0,0,"base: check for compatible distro using just sh

We allow users to use own image as base one and then we check is it
proper distribution version one. And this check is done in different way
for CentOS and different for Debian/Ubuntu systems.

This patchset uses PRETTY_NAME from /etc/os-release for check. And it is
done before anything gets installed so if wrong distribution is used
then build process breaks as soon as possible.

(cherry picked from commit 68fc72cd5d5003025da53cd1160e9cd19367cb10)
[SEP]
FILES CHANGED:
kolla/image/build.py (+2, -2)
docker/base/Dockerfile.j2 (+6, -11)
kolla/common/config.py (+6, -5)
",-0.95176,-1.467531,0.369094,-0.690716,0.186236,-0.256897,1.079443,-0.147548,-0.483222,0.244967,0.214438,-0.463986,0.265695,0.225169,-0.242728
openstack/kolla-ansible,I60e1dedeac25fa8fe9538a3a8e582bd8cc9324d7,1,1,1.0,2.3026,0.1111,2,6.5,215,0,Bug Fix,0,0,0,3,0.046875,0.0,0,0.0,4,2,0,0.7881,0.7642,3.0,-164.19,24.14,0,0,0.0,1,21.5,0,6,0,24,0,"Disable Alertmanager's peer gossip in non-HA deployments

Reference:

https://github.com/prometheus/alertmanager#turn-off-high-availability

Closes-Bug: #1926463
[SEP]
FILES CHANGED:
releasenotes/notes/disable-alertmanager-clustering-ec70f5f970c4933a.yaml (+7, -0)
ansible/roles/prometheus/templates/prometheus-alertmanager.json.j2 (+1, -1)
",-0.249998,1.734778,-1.234076,-0.071385,-0.603319,0.100264,-1.393768,-0.038794,0.296663,-0.442948,-0.615461,0.384154,0.543459,0.099074,0.153432
openstack/kayobe,Iaf0dfb34750ba8b8d74a043587a2035b511de6ad,1,0,0.3333,4.804,0.4876,8,5.86,329,0,Feature,0,0,0,3,0.023622,0.0,0,0.0,4,3,0,0.9348,2.8566,3.88,37.88,10.15,1,0,0.0165,0,2.6967,0,0,0,0,0,"Sync the names and content of the repo-files for CentOS8

Since 8.3.2011 release of CentOS the repo-files renamed and the content
is slightly changed. This change sync the templates used in role with
upstream changes.
[SEP]
FILES CHANGED:
ansible/roles/dnf/templates/CentOS-Base.repo.j2 (+0, -19)
ansible/roles/dnf/templates/CentOS-Linux-Extras.repo.j2 (+17, -0)
ansible/roles/dnf/templates/CentOS-Linux-AppStream.repo.j2 (+17, -0)
ansible/roles/dnf/templates/CentOS-AppStream.repo.j2 (+0, -19)
ansible/roles/dnf/templates/CentOS-Linux-BaseOS.repo.j2 (+17, -0)
ansible/roles/dnf/tasks/local-mirror.yml (+10, -0)
ansible/roles/dnf/templates/CentOS-Extras.repo.j2 (+0, -20)
playbooks/kayobe-overcloud-host-configure-base/tests/test_overcloud_host_configure.py (+1, -1)
",1.123838,-1.244954,0.32823,0.604737,-0.255793,-0.082748,0.435036,0.422477,-0.376702,0.072577,-0.701252,0.173986,-0.219644,0.367006,0.040256
openstack/kayobe,Ifcc3781d771e150b5771f2bf20cd8bcbc5faa443,1,0,0.8913,4.804,0.4876,8,10.25,300,0,Feature,0,0,0,46,0.022308,1.0,0,0.8913,4,3,0,0.9362,2.8566,3.88,43.74,11.9,1,0,0.0165,0,2.459,0,0,0,0,0,"CentOS Stream: update DNF repo file names

CentOS repositories were renamed following the separation of CentOS
Linux and Stream. This change updates their names when using a local
mirror. It also removes the old files.

Story: 2008795
Task: 42435
[SEP]
FILES CHANGED:
ansible/roles/dnf/templates/CentOS-Base.repo.j2 (+0, -19)
ansible/roles/dnf/templates/CentOS-AppStream.repo.j2 (+0, -19)
ansible/roles/dnf/tasks/local-mirror.yml (+10, -0)
ansible/roles/dnf/templates/CentOS-Extras.repo.j2 (+0, -20)
ansible/roles/dnf/templates/CentOS-Stream-BaseOS.repo.j2 (+17, -0)
ansible/roles/dnf/templates/CentOS-Stream-Extras.repo.j2 (+17, -0)
playbooks/kayobe-overcloud-host-configure-base/tests/test_overcloud_host_configure.py (+1, -1)
ansible/roles/dnf/templates/CentOS-Stream-AppStream.repo.j2 (+17, -0)
",0.457983,-1.802646,-0.573895,0.016758,-0.512232,0.375649,-0.47164,0.394591,-0.089027,-0.334122,0.147845,-0.053971,0.141075,0.173366,-0.435425
openstack/ironic,I2ea21c9ec440fa7ddf8578cf7b34d6d0ebbb5dc8,1,0,0.8,5.4161,0.0938,3,18.5,719,0,Bug Fix,0,0,0,5,0.036765,0.0,0,0.0,5,2,0,1.0,1.1975,3.33,39.44,14.97,1,0,0.5223,1,3.1956,0,0,0,0,0,"Fix deployment when executing a command fails after the command starts

If the agent accepts a command, but is unable to reply to Ironic (which
sporadically happens before of the eventlet's TLS implementation), we
currently retry the request and fail because the command is already
executing. Ironic now detects this situation by checking the list of
executing commands after receiving a connection error. If the requested
command is last one, we assume that the command request succeeded.

Ideally, we should pass a request ID to IPA and then compare it. Such
a change would affect the API contract between the agent and Ironic
and thus would not be backportable.
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent_client.py (+77, -21)
releasenotes/notes/agent-last-command-4ec6967c995ba84a.yaml (+9, -0)
ironic/tests/unit/drivers/modules/test_agent_client.py (+117, -0)
",-0.842511,-1.97984,1.000366,0.412459,-0.588335,0.210333,0.845903,-0.346356,0.132374,0.099894,0.451056,0.502401,-0.095381,-0.114972,-0.098726
openstack/kolla-ansible,Ib993b387d681921d804f654bea780a1481b2b0d0,1,1,1.0,2.3979,0.1,2,14.67,385,0,Bug Fix,0,0,0,3,0.066667,0.5,0,0.5,4,2,0,0.7899,0.971,3.0,5.44,17.68,1,0,0.0,1,35.0,0,6,0,10,0,"Do not write octavia_amp_ssh_key if auto_config disabled

This task is writing private key from passwords to
/etc/kolla/octavia-worker/{{ octavia_amp_ssh_key_name }} even
if user disabled octavia auto configure.

This patch is adding conditional for this task and skipping
it if octavia_auto_configure: ""no"".

Closes-Bug: #1927727
[SEP]
FILES CHANGED:
ansible/roles/octavia/tasks/config.yml (+3, -1)
releasenotes/notes/bug-1927727-4437103de59e85e5.yaml (+6, -0)
",-1.184079,-0.578012,-0.814725,-0.144659,0.274958,-0.308001,-0.703299,0.022904,0.039596,-0.569242,0.382399,-0.748015,-0.121793,0.342582,0.129696
openstack/kolla,I031128d38e32c23147ad70e429b9aff66df3b8da,0,0,0.8,2.3979,0.3,4,4.6,222,0,Feature,0,0,0,50,0.014548,1.0,0,0.8,2,3,0,0.7816,1.9219,2.0,36.64,12.27,1,1,0.0,0,20.1818,0,0,0,0,0,"[release] Use UCA Wallaby

openvswitch has been pinned to 2.13.1 due to upgrade
issues with 2.15.0

(cherry picked from commit c028639af80f552304d45c48c25c1a27af10bb0c)
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+4, -0)
docker/base/sources.list.ubuntu.aarch64 (+1, -1)
docker/base/sources.list.ubuntu.ppc64le (+1, -1)
docker/base/sources.list.ubuntu (+1, -1)
",0.018531,-0.363723,-1.630494,-1.704835,0.548447,0.105788,0.660602,0.110563,-0.199419,0.884086,-0.326028,-0.005988,-0.069748,0.001553,-0.047508
openstack/kolla-ansible,I1ba60fa51ecc86c74d05898b897d7b84c70707ef,0,0,0.6,2.8332,1.0,1,7.5,129,0,CI,0,0,0,10,0.012225,0.0,0,0.0,4,1,0,0.7917,0.0,4.0,41.3,11.0,1,0,0.0,0,7.5882,0,0,0,0,0,"cleanup no longer needed task for cinder

we don't need this task anymore.
[SEP]
FILES CHANGED:
ansible/roles/cinder/tasks/upgrade.yml (+0, -16)
",3.526518,-0.206093,1.32488,0.105435,-0.629936,0.527617,1.051367,-1.497373,-1.049842,-0.17291,-0.002224,-0.07282,-0.326942,0.362813,0.146217
openstack/ironic,Ida21f21d6435c0d7fa46cb5b1161f034ad8956ee,1,0,0.8333,5.273,0.5309,6,13.86,735,0,Bug Fix,0,0,0,6,0.016667,0.0,0,0.0,6,2,0,1.0,2.0309,4.17,28.8,15.03,1,0,0.8351,1,3.7692,0,0,0,0,0,"Avoid unnecessary validation in boot interfaces

Interfaces should only validate values they're going to use. Boot
interfaces do not care about image properties when local boot is used
(which is the default), so they shouldn't validate them. The deploy
interface has to provide validation for images.

This change fixes PXE, iPXE and redfish-virtual-media, although other
boot interfaces may need a similar change. We also need to refactor
handling instance_info in deploy_utils, but that can wait until the
iSCSI deploy removal.

Also refactor unit tests for redfish-virtual-media.

Story: #2008874
Task: #42418
(cherry picked from commit e6bb99cd8ff94a24c3f2108e649c7ca39189d220)
[SEP]
FILES CHANGED:
ironic/drivers/modules/pxe_base.py (+9, -5)
ironic/tests/unit/drivers/modules/test_ipxe.py (+28, -9)
ironic/tests/unit/drivers/modules/redfish/test_boot.py (+22, -76)
ironic/tests/unit/drivers/modules/test_pxe.py (+17, -10)
releasenotes/notes/boot-validate-6b4b6b40c8e27273.yaml (+7, -0)
ironic/drivers/modules/redfish/boot.py (+8, -3)
",-2.092727,-0.691909,1.135292,-0.859549,0.15601,-0.28093,0.25472,-0.09885,-0.206261,-0.281613,-0.05097,-0.079381,0.180909,-0.209189,-0.006511
openstack/kayobe,I536a526340f6d7dea7a69372904b777292774eba,1,0,0.9474,1.9459,0.0,1,21.0,440,0,Doc,0,0,0,19,0.041758,1.0,0,0.9474,2,1,0,0.9375,0.0,2.0,37.81,15.38,1,0,0.0,0,62.8571,0,0,0,0,0,"CI: Remove unused Docker images after overcloud upgrade

Overcloud upgrade jobs often fail when running on nodes with a 38G root
disk. The overcloud upgrade itself generally works, but post-upgrade
testing fails, for example when RabbitMQ gets in alarm state due to lack
of free disk space, which prevents Nova from functioning correctly and
makes it return ""Unknown Error (HTTP 504)"".
[SEP]
FILES CHANGED:
playbooks/kayobe-overcloud-upgrade-base/run.yml (+6, -0)
",-0.213819,-1.541199,0.105409,0.326713,0.079493,-0.126883,0.068554,-0.036979,-0.230774,0.245162,-0.151744,-0.196833,0.527141,-0.283273,0.131488
openstack/kolla-ansible,Iff7bb02d2906604eeace608029f0a032e82a9689,0,0,1.0,2.7081,0.0,3,6.75,593,0,Feature,0,0,0,5,0.050505,0.0,0,0.0,4,2,0,0.7851,1.3788,3.33,-11.52,13.07,1,0,0.0,1,39.5333,0,0,0,0,0,"ovn: make DVR work on VLAN tenant networks

In order for DVR to work on VLAN tenant networks we need to configure
external_ids:ovn-chassis-mac-mappings with per node generated MAC [2]
on computes [1].

This change is a stable/victoria version of 780919 change [2]

[1]: https://github.com/ovn-org/ovn/commit/1fed74cfc1a1e3b29cf86eab2e96048813019b57
[2]: https://review.opendev.org/c/openstack/kolla-ansible/+/780919

Co-Authored-By: Michal Nasiadka <mnasiadka@gmail.com>

Depends-On: https://review.opendev.org/c/openstack/neutron/+/785131
[SEP]
FILES CHANGED:
ansible/roles/ovn/defaults/main.yml (+2, -0)
ansible/roles/ovn/tasks/bootstrap.yml (+8, -0)
releasenotes/notes/ovn_dvr_vlan-e3464ddf17837655.yaml (+4, -0)
",-3.368554,2.374542,0.931132,-0.847184,-0.074939,-0.004096,0.149894,0.321512,-0.006694,-0.256105,0.037676,0.132683,0.116912,-0.128449,-0.230056
openstack/kolla-ansible,I40213d4092fa325bcf37bb1fb4437ab125fe328b,1,0,0.7843,4.6634,0.0476,3,12.5,205,0,Doc,0,0,0,51,0.014795,0.0,0,0.0,2,2,0,0.7787,1.2797,1.67,48.64,13.0,1,1,0.5143,1,1.934,0,0,0,0,0,"[docker] Add support for setting CgroupnsMode

This is required to support Debian Bullseye (11) - need to set
nova-libvirt to use 'host' CgroupnsMode.
[SEP]
FILES CHANGED:
releasenotes/notes/docker-cgroupns-mode-9e1b32c357a14095.yaml (+7, -0)
tests/test_kolla_docker.py (+50, -4)
ansible/library/kolla_docker.py (+43, -1)
",1.418949,0.076132,-0.42846,0.423752,0.016263,0.078882,0.190392,0.336977,-0.437516,-0.114442,0.036943,0.065274,0.174506,-0.407581,-0.249712
openstack/oslo.config,I70ab87c9bed093cad883b6301b8a09753fc470d9,1,1,0,2.7081,0.0,1,9.0,345,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.5,0.0,1.0,41.66,12.49,1,0,0.0,0,23.0,0,6,0,15,0,"config-generator yaml format doesn't work with i18n fields

This is because there's no yaml representer for i18n Messages object.
This patch aims to add this representer and allow the generation of
configurations using oslo.i18n strings.

One example of this is cinder.

Closes-bug: #1928582
[SEP]
FILES CHANGED:
oslo_config/generator.py (+14, -0)
",-2.880221,-0.294456,0.450776,-1.99966,1.141011,-0.006923,1.029218,-0.046027,0.007189,0.076355,0.23346,0.132621,0.096798,-0.109664,-0.170758
openstack/octavia,I258b9b49b4a876a2bf9772b19f2100187ea83007,0,0,0.4783,2.4849,0.5455,3,6.75,307,0,Feature,0,0,0,23,0.010648,0.5,0,0.2391,2,3,0,0.5381,1.4949,1.33,-31.88,19.0,0,0,0.0,1,25.5833,0,0,0,0,0,"Remove i386 amphora build support

Diskimage-builder has removed support to building i386 images, and major
Linux distributions have already end-of-lifed 32-bit host support.

Depends-On: https://review.opendev.org/c/openstack/diskimage-builder/+/790878
[SEP]
FILES CHANGED:
diskimage-create/README.rst (+1, -1)
elements/amphora-agent/package-installs.yaml (+2, -2)
diskimage-create/diskimage-create.sh (+2, -3)
",-0.323644,1.531039,-0.957448,0.241768,-0.763134,-0.32495,0.237334,0.190233,0.033024,-0.361512,-0.492863,-0.035798,0.597969,-0.138888,0.153116
openstack/kolla-ansible,I79a7a8c80327cfd9ef31d17fe71f450a181a638c,1,1,1.0,3.0445,0.0,2,8.0,229,0,Bug Fix,0,0,0,6,0.036145,0.6667,0,0.6667,4,2,0,0.7805,0.9341,3.0,18.94,14.87,0,0,0.0,1,10.9048,0,6,0,4,0,"Switch prometheus to active/passive mode

This uses the same approach as the mariadb role (and others).

Closes-Bug: #1928193
Co-Authored-By: John Garbutt <johng@stackhpc.com>
[SEP]
FILES CHANGED:
ansible/roles/prometheus/defaults/main.yml (+7, -0)
releasenotes/notes/prometheus-active-passive-be4fb033493e958f.yaml (+13, -0)
",-0.482978,0.563086,-1.451753,-0.32937,-0.933176,0.540987,-0.57198,0.055145,-0.021613,-0.327866,0.613551,0.442897,0.15424,-0.101866,-0.462019
openstack/kolla,I721001f877f6ec2f9a2e425c088a2e22177d2e5b,0,0,0.641,3.0445,1.0,1,18.5,349,0,Feature,0,0,0,39,0.023608,0.75,0,0.4808,3,1,0,0.7727,0.0,3.0,18.86,18.21,0,0,0.0,0,16.619,0,0,0,0,0,"gnocchi-base: numpy provides aarch64 binary wheels

There is no need to install libraries to build Numpy as we have binary
wheel provided by numpy upstream.

(cherry picked from commit 9bad71d7c3fe3cdd1b128925554c4fdec1420a7f)
(cherry picked from commit 858c2748692d0b0c8fed9613a0c0a2514136190d)
[SEP]
FILES CHANGED:
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+0, -20)
",-0.815033,-0.937708,-1.225128,-1.593398,1.105436,-0.301295,1.544084,0.021829,-0.255573,0.505508,0.038201,-0.065333,0.362407,0.139028,0.030986
openstack/kolla-ansible,If23a6b1273c2639d1296becc9d222546d52f63ac,1,1,0,2.1972,0.125,2,12.2,535,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,4,2,0,0.7823,0.8113,3.0,12.77,16.68,1,0,0.0,1,59.4444,0,6,0,14,0,"fluentd: Fix check for external elasticsearch

When enable_elasticsearch is False, and kolla_internal_fqdn is set
and elasticsearch_address is the default, fluentd is still enabling
output to elasticsearch.

elasticsearch_address defaults to kolla_internal_fqdn, but the
check to enable logging to an ""external"" elasticsearch host
compares with kolla_internal_vip_address (fqdn != vip address).

This patch fixes the comparison to use the kolla_internal_fqdn.

Closes-Bug: #1927880
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1927880-cc407f18f415bbd2.yaml (+6, -0)
ansible/roles/common/tasks/config.yml (+1, -1)
",-1.969454,-0.223539,0.242124,0.314039,1.054048,-0.337228,-0.38541,0.124984,0.152504,-0.384236,0.430255,-0.354419,-0.504307,-0.184359,-0.037804
openstack/kolla-ansible,Ib225d76076782d695c9387e1c2693bae9a4521d7,1,1,1.0,4.3307,0.1867,8,14.54,1333,0,Bug Fix,0,0,0,1,0.111111,1.0,0,1.0,5,3,0,0.784,2.2731,4.0,31.83,16.61,1,0,0.0,1,17.5395,0,8,0,16,0,"monasca-thresh: Fix topology submission to storm

monasca-thresh currently runs a local copy of the storm
to handle the threshold topology.  However, it doesn't setup
the environment correctly, and the executable fails, causing
the container to continually restart.

This patch updates the container command to correctly
submit the topology to the running Apache storm.  The
container will exit after it finishes the submission,
so the restart_policy is updated to on-failure, this way
if the storm is temporarily unavailable, the submission
will be retried. (NOTE: further deploys will see the
container as ""changed"" as it won't be running)

Patch uses KOLLA_BOOTSTRAP to trigger the container to
check if the topology is already submitted, and if so skips
the submission command so the container doesn't fail.

The config task now triggers a new reconfigure handler that
spawns a one-shot container to replace any existing topology
if the configuration has changed.

Also, all the storm.* variables in storm.yml.j2 are
removed as they were only needed for local mode and
make submitted topologies fail to load when the storm
is restarted (the referenced directories not mounted
on nimbus).

Depends-On: https://review.opendev.org/c/openstack/kolla/+/792751
Closes-Bug: #1808805
[SEP]
FILES CHANGED:
ansible/roles/monasca/tasks/config.yml (+2, -2)
ansible/roles/monasca/handlers/main.yml (+30, -3)
ansible/roles/monasca/tasks/check-containers.yml (+1, -0)
ansible/roles/monasca/tasks/upgrade.yml (+13, -0)
ansible/roles/monasca/templates/monasca-thresh/storm.yml.j2 (+0, -8)
ansible/roles/monasca/defaults/main.yml (+1, -0)
releasenotes/notes/bug-1808805-3ebd9b0edceff170.yaml (+13, -0)
ansible/roles/monasca/templates/monasca-thresh/monasca-thresh.json.j2 (+1, -1)
",-2.479071,-0.447522,3.9193,-0.967096,-0.77514,0.045449,-0.018362,-0.272025,-0.0571,-0.675281,-0.120912,0.404634,-0.257849,0.298754,0.09625
openstack/tooz,Iaab5ce609c0dcf7085f5dd43efbd37eb4b88f17b,1,0,0.2222,4.8903,0.4015,2,9.14,608,0,CI,0,0,1,9,0.030201,1.0,0,0.2222,2,2,0,0.6667,0.1133,1.0,24.39,11.78,1,0,0.0,0,4.5714,0,0,0,0,0,"Retry on redis connection errors

Sometimes, connections get closed by the server. This change
adds retrying to the code.

Conflict:
requirements.txt

NOTE(hberaud): This conflict is due to the cap of tenacity during wallaby
to unblock the gate. This requirement cap won't be an issue for victoria
and for previous stable branches.

https://opendev.org/openstack/tooz/commit/fe9c4304551cce0ac85366965009ad102fd9610a

(cherry picked from commit a025b4d4ee9fe1bd722960ea03445034580bec6f)
(cherry picked from commit 62d5d17a5d2495f1f898163bbd83acbbc9873620)
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
tooz/drivers/redis.py (+78, -52)
",-2.827677,0.02209,0.819401,-2.073574,0.545166,0.22441,0.823696,-0.060912,0.363645,0.018375,-0.013083,0.038537,-0.046686,-0.346188,-0.107789
openstack/kolla,I7ed0202dfa644f7e85161b2ebaa999069fc1dcc2,1,0,0.8333,1.6094,1.0,1,2.33,147,0,Feature,0,0,0,18,0.042254,0.6667,0,0.5556,2,1,0,0.764,0.0,2.0,-182.28,29.5,0,0,0.0,0,29.4,0,0,0,0,0,"ubuntu: unpin OVS

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/792352
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+0, -4)
",0.431107,4.390304,-1.767803,-0.123099,-1.400243,0.463834,0.310074,-0.610808,-0.043699,-1.051753,-0.564192,0.214242,0.025247,-0.218677,0.039132
openstack/ironic-python-agent,I6e3db5db2042ca3fb5dafacfacf036fd7fc2fc4c,1,0,0.8571,2.6391,0.5385,3,11.33,246,0,Feature,0,0,0,7,0.012635,0.0,0,0.0,3,2,0,0.6667,1.4605,2.33,53.5,12.77,1,0,0.4615,1,17.5714,0,0,0,0,0,"Do not serialize command_params

The command params can be huge when configdrive is used. There is no
point in sending them back, Ironic does not use them anyhow.

Story: #2008904
Task: #42479
[SEP]
FILES CHANGED:
ironic_python_agent/extensions/base.py (+1, -1)
ironic_python_agent/tests/unit/test_agent.py (+0, -6)
releasenotes/notes/command_params-869fa547b5be2236.yaml (+5, -0)
",0.431956,-1.007696,-0.590366,0.10437,-0.523254,0.72176,-0.359198,-0.825124,-0.449364,-0.113132,0.149626,-0.272358,0.300111,0.235346,-0.200866
openstack/kolla-ansible,Ib67d715ddfa986a5b70a55fdda39e6d0e3333162,1,1,1.0,3.6889,0.0,28,10.0,125,0,Bug Fix,0,0,0,4,0.072727,1.0,0,1.0,5,2,0,0.7857,4.5413,3.96,-23.27,24.0,1,0,0.0,1,3.125,0,6,0,12,0,"Add missing region_name in keystoneauth sections

Closes-Bug: #1933025
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+1, -0)
ansible/roles/freezer/templates/freezer.conf.j2 (+1, -0)
releasenotes/notes/bug-1933025-1cb5d64d20d57be7.yaml (+6, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+1, -0)
ansible/roles/sahara/templates/sahara.conf.j2 (+1, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -0)
ansible/roles/heat/templates/heat.conf.j2 (+1, -0)
ansible/roles/designate/templates/designate.conf.j2 (+1, -0)
ansible/roles/placement/templates/placement.conf.j2 (+1, -0)
ansible/roles/solum/templates/solum.conf.j2 (+1, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -0)
ansible/roles/nova/templates/nova.conf.j2 (+1, -0)
ansible/roles/senlin/templates/senlin.conf.j2 (+1, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+1, -0)
ansible/roles/monasca/templates/monasca-api/api.conf.j2 (+1, -0)
ansible/roles/murano/templates/murano.conf.j2 (+3, -0)
ansible/roles/vitrage/templates/vitrage.conf.j2 (+1, -0)
ansible/roles/watcher/templates/watcher.conf.j2 (+1, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+2, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+2, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+3, -0)
ansible/roles/trove/templates/trove.conf.j2 (+1, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -0)
ansible/roles/manila/templates/manila.conf.j2 (+1, -0)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+1, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+1, -0)
",2.686192,-0.181808,-0.116009,-0.940035,-0.334009,0.516191,-0.52416,0.332343,0.492574,-0.356061,0.208673,-0.472753,-0.0363,-0.158771,0.298182
openstack/kolla-ansible,I726541f4b3fdc357387a44c6a2153593a10bf282,1,1,0.8421,2.3026,0.1111,2,3.43,244,0,Bug Fix,0,0,0,19,0.044186,0.0,0,0.0,4,2,0,0.7874,0.9183,3.0,23.58,11.37,0,0,0.0,1,24.4,0,10,0,15,0,"baremetal: Install Docker SDK less than 5.0.0

Docker 5.0.0 [1] dropped requirement for six, but still imports it.

[1]: https://github.com/docker/docker-py/issues/2807

Closes-Bug: #1928915
[SEP]
FILES CHANGED:
ansible/roles/baremetal/tasks/install.yml (+2, -1)
releasenotes/notes/bug-1928915-482b2d53bb2a4d92.yaml (+6, -0)
",-0.381314,1.053781,-1.121599,-0.178497,-0.960226,0.136869,-0.551799,0.279264,-0.421227,0.945961,-0.150344,-0.261636,0.151893,-0.015253,0.096381
openstack/kolla,I505b0645dc3331264c8fc6762df1c6cb8bb2f2ed,1,0,1.0,1.9459,0.1667,2,8.0,268,1,Bug Fix,0,0,0,4,0.054795,0.0,0,0.0,3,2,0,0.7667,0.9183,2.5,-26.88,18.2,0,1,0.0,1,38.2857,0,0,0,0,0,"[Security] Fix open redirect in Prometheus

Bump up Prometheus to the oldest non affected version as per
security advisory [1].

[1] https://github.com/prometheus/prometheus/security/advisories/GHSA-vx57-7f4q-fpc7
[SEP]
FILES CHANGED:
docker/prometheus/prometheus-v2-server/Dockerfile.j2 (+1, -1)
releasenotes/notes/security-fix-prometheus-v2.26.1-03e1410ad8ed4410.yaml (+4, -0)
",-0.343147,2.593757,-1.275245,0.286716,-0.405001,0.368931,0.500606,0.147072,0.478896,0.41582,-0.316098,-0.066528,0.23934,-0.011858,-0.267701
openstack/ironic,I03fdb48e47c9557c207a20ee876eccf3f3459d9f,1,0,1.0,6.7569,0.6566,10,15.25,436,0,CI,0,0,0,2,0.027397,1.0,0,1.0,6,1,0,1.0,3.1119,5.0,27.7,16.59,1,0,0.4622,0,0.507,0,0,0,0,0,"Refactor iDRAC OEM extension manager calls

- Re-usable helper created to avoid duplication.
- Although there is only one manager for system in known iDRAC systems
still iterate through collection for future changes.
- Restructured exception raising and error logging for better feedback.
- Removed some unit tests to avoid duplication that is covered by
method specific unit tests
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/drac/test_utils.py (+103, -0)
ironic/drivers/modules/drac/boot.py (+7, -60)
ironic/drivers/modules/drac/management.py (+28, -157)
ironic/tests/unit/drivers/modules/drac/test_raid.py (+2, -43)
ironic/drivers/modules/drac/inspect.py (+5, -41)
ironic/tests/unit/drivers/modules/drac/test_management.py (+13, -111)
ironic/tests/unit/drivers/modules/drac/test_inspect.py (+0, -27)
ironic/drivers/modules/drac/raid.py (+4, -39)
ironic/tests/unit/drivers/modules/drac/test_boot.py (+12, -86)
ironic/drivers/modules/drac/utils.py (+121, -0)
",0.279045,-1.978768,0.283883,0.489734,-0.056958,-0.14011,0.028519,-0.031686,0.040549,0.165078,-0.691589,0.00249,0.437176,-0.412486,0.308216
openstack/kolla-ansible,I1c4436072c2d47a95625e64b731edb473384b395,1,0,0.8936,5.1705,0.0971,9,10.0,231,0,Feature,0,0,0,47,0.02153,1.0,0,0.8936,4,5,0,0.7891,2.5959,2.22,33.12,16.0,0,0,0.2971,1,1.3125,0,0,0,0,0,"chrony: allow to remove the container

The chrony container is deprecated in Wallaby, and disabled by default.
This change allows to remove the container if chrony is disabled.
[SEP]
FILES CHANGED:
ansible/roles/chrony/tasks/cleanup.yml (+12, -0)
ansible/roles/prechecks/defaults/main.yml (+3, -0)
ansible/roles/prechecks/tasks/timesync_checks.yml (+65, -8)
ansible/chrony-cleanup.yml (+14, -0)
tests/pre.yml (+28, -0)
tests/templates/globals-default.j2 (+4, -6)
releasenotes/notes/deprecate-chrony-077a8686e79a919e.yaml (+13, -3)
tools/kolla-ansible (+5, -0)
tests/upgrade.sh (+14, -0)
",0.245564,-0.464251,-1.01968,1.28896,-0.165197,0.532432,0.242177,-0.401151,-0.270721,0.205754,0.680798,0.485127,-0.297586,-0.069018,-0.579612
openstack/python-octaviaclient,Ica7c8c953c11af4400b224ad942023f69a72ae02,1,0,0.6545,5.0999,0.2577,4,12.0,276,0,Bug Fix,0,0,0,55,0.00588,0.3333,0,0.2182,4,2,0,0.1111,1.3704,2.75,39.56,12.58,0,0,0.0552,1,1.6829,0,0,0,0,0,"Support pagination for 'list' API calls

Fix 'list' CLI calls when API calls are paginated.
Fix some UUID or name lookups that failed when the number of resources
exceeded 'pagination_max_limit'.

Story 2008892
Task 42489
[SEP]
FILES CHANGED:
octaviaclient/api/v2/octavia.py (+76, -22)
releasenotes/notes/fix-cli-pagination-792ad8cd386eb0e7.yaml (+6, -0)
octaviaclient/api/constants.py (+34, -16)
octaviaclient/tests/unit/api/test_octavia.py (+5, -4)
",-0.028591,-1.081659,-0.408761,0.241705,0.354011,0.328824,-0.804612,-0.260669,0.308436,-0.170673,-0.352321,-0.551519,0.176604,0.054348,-0.049194
openstack/kolla-ansible,Ib3bee6e810fb8d31552d4c72c2a1ccae382c51f0,1,0,0.85,4.1431,0.2742,6,14.67,287,0,CI,0,0,0,20,0.045558,0.6667,0,0.5667,3,3,0,0.7907,2.3275,1.67,57.36,13.14,0,0,0.6129,1,4.5556,0,0,0,0,0,"CI: Configure IP on a linux bridge instead of OVS br-ex

OVS upgrade jobs failed due to assigning an IP on the br-ex interface
(which is recycled during OVS upgrade). This change introduces a bridge
and veth pair for Neutron to use.
[SEP]
FILES CHANGED:
roles/veth/tasks/main.yml (+12, -0)
tests/run.yml (+0, -2)
tests/pre.yml (+18, -1)
zuul.d/base.yaml (+3, -1)
tests/init-core-openstack.sh (+0, -13)
roles/bridge/tasks/main.yml (+12, -0)
",0.249637,-1.260795,-0.235539,0.404616,0.136786,0.057312,-0.065915,0.386708,-0.350106,-0.177232,0.029013,0.312937,0.157323,-0.240914,-0.10853
openstack/kolla-ansible,If2fdab2ae0f981d9fcbb0fea7a92fcde325804f8,1,0,1.0,1.7918,0.4,2,6.0,108,0,Feature,0,0,0,5,0.053191,0.0,0,0.0,4,2,0,0.7923,0.971,4.0,-123.56,29.07,0,0,0.0,0,18.0,0,0,0,0,0,"Make rabbitmq cluster_partition_handling configurable
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/templates/rabbitmq.conf.j2 (+1, -2)
ansible/roles/rabbitmq/defaults/main.yml (+2, -0)
",1.271648,0.135534,0.691478,0.124385,1.850174,-0.315539,-0.432379,0.348952,0.176462,-0.300842,0.213642,-0.929183,-1.195224,-0.844076,0.552165
openstack/kolla-ansible,I58275a2fa1490307858d45855255bb8e3a05043c,1,0,0.7885,1.0986,0.5,1,8.67,212,0,Bug Fix,1,0,0,52,0.01464,0.4,0,0.3154,1,1,0,0.7939,0.0,1.0,35.35,15.77,1,1,1.0,0,70.6667,0,0,0,0,0,"[CI] Fix testing in cephadm scenario

One missed previous scenario name occurence turned off OpenStack
testing in multinode scenario.
This patch to fix that.
[SEP]
FILES CHANGED:
tests/run.yml (+1, -1)
",0.881161,-1.156946,-0.116764,-0.207927,-0.075697,0.457965,-0.357222,-0.229093,-0.258868,-0.215064,0.171546,0.215683,-0.104179,0.021313,-0.108962
openstack/oslo.db,I0d1a197e7e62062a87b8d5c77b499ea633f4f88d,0,1,0.0,3.0445,0.0,1,13.33,309,0,Bug Fix,0,0,0,1,0.125,0.0,0,0.0,2,1,0,0.0,0.0,2.0,36.79,12.33,1,0,0.0,0,14.7143,0,6,0,16,0,"Add method to return the SQL dialect specific rand method

Depending on the SQL dialect (""postgresql"", ""sqlite"", ""mysql""),
the random method used is different.

In case of not matching any supported dialect, the method returns
None.

Related-Bug: #1920923
[SEP]
FILES CHANGED:
oslo_db/sqlalchemy/utils.py (+20, -0)
",-0.021554,-1.471855,-0.48042,0.213593,-0.277264,0.552915,-0.659613,0.155142,0.3428,-0.04736,-0.500299,0.063311,-0.102276,0.132045,-0.028814
openstack/kolla,If8f0730031435dda4235b7f2d2c23e5f5f767f87,1,1,1.0,4.7274,0.0089,4,17.17,710,0,Bug Fix,0,0,0,2,0.02381,1.0,0,1.0,3,3,0,0.7692,1.0236,2.75,28.42,19.29,1,0,0.0,1,6.2832,0,8,0,16,0,"monasca-thresh: Allow topology check and removal in storm

Patch adds a script in the monasca-thresh image that can be used
to check if a topology exists in Storm, and optionally kill it.

This is part of a bug in kolla-ansible where topologies were
not submitted to Storm, but run locally.  This patch includes
a topology check script enabled by KOLLA_BOOTSTRAP which will exit
kolla_start if the topology exists, and optionally enables topology
removal (to allow replacement) enabled by TOPOLOGY_REPLACE.

Topology names and various timeouts may be customized.  If the
new env variables are not set, existing behavior is unchanged.

Partial-Bug: #1808805
[SEP]
FILES CHANGED:
docker/monasca/monasca-thresh/Dockerfile.j2 (+7, -1)
releasenotes/notes/bug-1808805-e63af01591f03506.yaml (+8, -0)
docker/monasca/monasca-thresh/extend_start.sh (+6, -0)
docker/monasca/monasca-thresh/topology_bootstrap.sh (+90, -0)
",-2.220449,-0.800825,1.020939,0.266992,0.152472,-0.121907,-0.012634,0.163381,0.116894,-0.043183,0.515809,0.101449,-0.03204,0.12673,0.049983
openstack/kolla-ansible,Icd38f1edf0cb0551704e5a95aa0922d572a2bf24,1,0,0.8958,1.7918,1.0,1,7.5,150,0,CI,1,0,0,48,0.020356,1.0,0,0.8958,1,1,0,0.7955,0.0,1.0,-9.46,21.67,0,0,1.0,0,25.0,0,0,0,0,0,"CI: Don't generate certificates before upgrade

We generate them before the initial deployment.
[SEP]
FILES CHANGED:
tests/upgrade.sh (+0, -5)
",3.518764,0.154001,1.187583,0.551585,-0.286694,0.977095,0.88234,-0.709165,-0.496454,0.087882,0.168346,-0.109761,0.259426,0.620578,-0.409324
openstack/kolla,I4faabdfa9c273fc61b536e6ce88b8d71ab2fc581,1,1,1.0,2.3026,0.1111,2,7.2,333,0,Bug Fix,0,0,0,3,0.015306,1.0,0,1.0,2,2,0,0.7717,0.7642,2.0,-4.92,18.44,1,0,0.0,1,33.3,0,6,0,15,0,"horizon: Correct location of monitoring_policy file

Patch to correctly copy monitoring_policy.json into
/etc/openstack-dashboard.  Policy was misplaced, and not being enforced.

Note that by current default policy, admin doesn't not have Monitoring
access.

Closes-Bug: #1928408
[SEP]
FILES CHANGED:
docker/horizon/extend_start.sh (+1, -1)
releasenotes/notes/bug-1928408-4a22a85570eee8d6.yaml (+7, -0)
",0.260681,-1.364575,-0.404642,-0.157202,-0.972704,-0.296172,-0.04233,0.504782,0.097047,-0.262633,0.08516,-0.546603,0.000926,0.428957,-0.089779
openstack/octavia,I1281e74a398d03eac8db7a468e71ea4889dd8229,0,0,0.4583,3.2581,0.24,1,12.75,417,0,CI,1,0,0,24,0.011055,0.0952,0,0.0437,1,1,0,0.5359,0.0,1.0,13.08,16.08,0,0,1.0,1,16.0385,0,0,0,0,0,"Explicitely set nodeset to Bionic-based

The default nodeset has been updated to Ubuntu Focal in [1]. Train CI
jobs need to be explicitely set to Bionic-based nodeset or else Devstack
will fail to deploy with the following message:

  ""WARNING: this script has not been tested on focal""

[1] https://review.opendev.org/c/openstack/octavia-tempest-plugin/+/788954
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+19, -6)
",-0.913032,0.802892,-0.47973,0.465026,-0.70281,-0.029217,0.752528,0.1457,0.207038,0.246344,0.643686,-0.014566,0.15047,-0.047866,-0.367891
openstack/kolla-ansible,Ifa3b8c7365e4092202bf9e89b67293cf8d983e0a,1,0,0.898,3.8501,0.1957,4,27.0,226,0,Doc,0,0,0,49,0.020736,0.6667,0,0.5986,3,2,0,0.797,1.9767,2.75,25.9,18.21,0,0,0.0,1,4.8085,0,0,0,0,0,"docs: update supported OS distros

* add CentOS Stream 8 info & reno
* mark RHEL as deprecated in docs

(cherry picked from commit f295b1a0556d12d5fccb6329b4c42552e1cfa168)
[SEP]
FILES CHANGED:
releasenotes/notes/centos-stream-686441cc4c0e47d7.yaml (+13, -0)
doc/source/user/quickstart.rst (+5, -5)
doc/source/user/support-matrix.rst (+10, -4)
doc/source/user/operating-kolla.rst (+9, -0)
",-0.153699,-0.743738,-1.938019,-1.643182,1.204724,0.006784,0.270434,-0.368132,-0.043401,0.207741,-0.715794,-0.262453,0.356264,-0.06738,-0.233684
openstack/kayobe,I5bc8197143ce763cdaf8a9ac0b782b524d5df258,1,0,0.95,2.3026,0.0,1,7.36,850,0,Bug Fix,0,0,0,20,0.043384,0.0,0,0.0,2,1,0,0.9388,0.0,2.0,34.27,11.1,1,0,0.0,0,85.0,0,0,0,0,0,"CI: Fix libvirt errors caused by latest edk2-ovmf

Some CentOS Stream CI jobs started to fail when defining VMs with:

    libvirt.libvirtError: internal error: unknown feature amd-sev-es

This was introduced by edk2-ovmf-20200602gitca407c7246bf-5.el8.noarch.
This change excludes this package version in Zuul jobs, which fixes the
kayobe-seed-vm-centos8s job.

Overcloud centos8s jobs were also broken by the nova-libvirt Kolla image
containing this package, which is used by Tenks. Updated images using
the previous version of edk2-ovmf [1][2] are now available from quay.io.

This also needs to be fixed for Kayobe and Tenks in general, unless a
new package is released soon.

[1] https://review.opendev.org/c/openstack/kolla/+/792999
[2] https://review.opendev.org/c/openstack/kolla/+/793174
[SEP]
FILES CHANGED:
playbooks/kayobe-seed-vm-base/pre.yml (+9, -0)
",-3.159204,1.375438,2.053518,-0.920164,-0.549476,-0.117953,0.148044,0.288505,-0.283113,-0.153967,0.093634,0.228407,0.008346,-0.05193,0.012935
openstack/kolla,I0cb0512ef40c48353d582b1c37a446f251b79ac7,1,0,0.8571,1.3863,0.3333,1,4.12,283,0,Bug Fix,0,0,0,21,0.041916,1.0,0,0.8571,3,1,0,0.7742,0.0,3.0,46.27,7.71,1,0,0.0,0,70.75,0,0,0,0,0,"libvirt: pin edk2-ovmf

edk2-ovmf introduced a bug [1] and results libvirt/qemu errors
It's going to be fixed in next rebase to libvirt 7.4.0 - but let's pin for now.

[1]: https://bugzilla.redhat.com/show_bug.cgi?id=1961558#c10
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+2, -1)
",-0.620614,1.276664,-0.592618,-0.223208,-0.943189,-0.235315,0.583154,-0.285018,-0.267116,0.769144,0.289474,-0.653131,-0.149705,-0.097304,0.364473
openstack/ironic-python-agent,I71a28ec59ec31c691205eb34d9fcab63a2ccb682,1,0,1.0,3.1781,0.087,3,22.8,747,0,CI,0,0,0,2,0.035088,0.0,0,0.0,4,2,0,0.75,1.4509,2.67,36.01,17.54,0,0,0.1739,1,31.125,0,0,0,0,0,"Limit qemu-img execution arenas

qemu-img attempts to launch multiple threads by default *and*
attempts to have multiple memory allocation arenas to operate
from. While multithreading can be good for performance, this
pattern and the memory footprint for process launch and
dependencies can turn the memory footprint for a cirros image
conversion (16MB) into 1.2GB of memory being asked for by the
qemu-img tool.

In order to limit this impact, as the default number of arenas
is governed by the number of CPUs times the number 8, it seems
reasonable to lower this to a more reasonable number which
also helps keep our possible memory footprint from being exceeded.

Story: 2008928
Task: 42528
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_standby.py (+3, -1)
releasenotes/notes/limit-qemu-img-malloc-arena-025ed84115481eae.yaml (+7, -0)
ironic_python_agent/extensions/standby.py (+11, -1)
",-2.808221,-0.983644,3.480728,-1.216327,-0.100883,0.175536,0.107421,-0.21403,-0.021281,-0.039921,-0.39013,0.548268,-0.335364,-0.281248,0.038144
openstack/oslo.i18n,I611811b3393f24934c4f336ed05dd121a760f488,1,0,0,1.0986,0.5,1,4.25,213,0,CI,0,0,0,0,0.0,0.8571,0,0.0,0,1,0,0,0.0,0.0,-41.33,13.46,0,0,0.0,0,71.0,0,0,0,0,0,"Switch testing to Xena testing runtime

Upating the tetsing template to Xena testing runtime:
https://governance.openstack.org/tc/reference/runtimes/xena.html
[SEP]
FILES CHANGED:
.zuul.yaml (+1, -1)
",-0.807894,2.439633,-1.38925,0.993811,-0.06161,0.305231,-0.318661,0.346141,0.065117,-0.299482,-0.806016,0.245332,-0.463673,-0.185969,-0.124308
openstack/ironic-lib,I8b2b490f2cc0ac5f47c3aaaaa249ce59db6602d6,1,0,1.0,3.989,0.3019,2,16.0,797,0,Feature,0,0,0,3,0.0375,0.0,0,0.0,2,1,0,0,0.8595,1.5,34.24,14.26,0,0,0.717,0,14.7593,0,0,0,0,0,"Limit the number of malloc arenas for qemu-img convert

Under heavy load, the qemu-img convert method may attempt to create
additional malloc arenas to complete its work. By default this number
is 8 * ncpu * which at about 250 MB of memory which can be consumed
in this mannor should the.

Since this is only something which should realistically occur under
heavy cross-thread load where memory locking prevents a thread from
unlocking a range of memory, (such as what can happen with hypervisors
and VMs inside those hypervisors), then a new arena gets created, and
the memory consumption spikes.

More information is avialable at:
https://www.gnu.org/software/libc/manual/html_node/Memory-Allocation-Tunables.html

Story: 2008928
Task: 42529
[SEP]
FILES CHANGED:
ironic_lib/tests/test_disk_utils.py (+23, -15)
ironic_lib/disk_utils.py (+14, -1)
",-2.500409,-0.61147,1.626865,-0.167305,-0.209821,0.034047,-0.166103,-0.093438,0.12193,-0.015194,-0.334008,0.141584,-0.04592,-0.25912,-0.003812
openstack/oslo.policy,I23af2528894096cea746002a87ee2ca810b9a6c2,0,0,0.2,1.6094,0.75,1,8.0,96,0,CI,0,0,0,5,0.05814,0.381,0,0.0762,0,1,0,1.0,0.0,0.0,-44.51,23.2,1,0,0.0,1,19.2,0,0,0,0,0,"Dependency already exists in testenv deps
[SEP]
FILES CHANGED:
tox.ini (+1, -3)
",2.315646,1.476242,1.290344,0.589475,1.168862,0.441653,0.287011,-0.239903,-0.612864,-0.488849,0.350903,-0.709891,-0.054221,0.379002,-0.174606
openstack/ironic-python-agent,I71a28ec59ec31c691205eb34d9fcab63a2ccb682,1,0,1.0,2.8332,0.0,2,19.22,1160,0,CI,0,0,0,4,0.030075,1.0,0,1.0,2,2,0,0.8,0.9887,2.0,34.26,16.94,0,0,0.0,1,68.2353,0,0,0,0,0,"Limit qemu-img execution arenas

qemu-img attempts to launch multiple threads by default *and*
attempts to have multiple memory allocation arenas to operate
from. While multithreading can be good for performance, this
pattern and the memory footprint for process launch and
dependencies can turn the memory footprint for a cirros image
conversion (16MB) into 1.2GB of memory being asked for by the
qemu-img tool.

In order to limit this impact, as the default number of arenas
is governed by the number of CPUs times the number 8, it seems
reasonable to lower this to a more reasonable number which
also helps keep our possible memory footprint from being exceeded.

NOTE: This change is largely different than the original change
as an intermediate change converted write_image.sh to python.
As it is unlikely for us to backport the intermediate change,
it is logical for us to just modify the original script.
Otherwise the release note is ultimately what is backported for
release note tooling continutity.

Story: 2008928
Task: 42528
(cherry picked from commit 9e4c7052a2fd9aac03858db696bf1ea9487f15e6)
[SEP]
FILES CHANGED:
ironic_python_agent/shell/write_image.sh (+9, -0)
releasenotes/notes/limit-qemu-img-malloc-arena-025ed84115481eae.yaml (+7, -0)
",-2.808221,-0.983644,3.480728,-1.216327,-0.100883,0.175536,0.107421,-0.21403,-0.021281,-0.039921,-0.39013,0.548268,-0.335364,-0.281248,0.038144
openstack/kolla-ansible,I4ed4651b55a912f1d9aec7277bae6bb4776f1e0a,1,1,1.0,2.1972,0.0,2,10.0,173,0,Bug Fix,0,0,0,7,0.037634,0.0,0,0.0,4,2,0,0.7985,0.5436,3.0,27.49,14.0,0,0,0.0,1,19.2222,0,6,0,10,0,"Add OIDCDiscoverURL mod_oidc option

This gets rid of one of the steps in the authentication flow.

Closes-Bug: 1930055
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -0)
releasenotes/notes/add-oidc-discover-url-83edb9f43f73a97f.yaml (+7, -0)
",1.081135,-1.181714,-0.695904,-0.582725,-0.37798,0.750144,-0.691701,0.15441,0.071553,-0.141927,0.344575,0.148544,-0.199361,-0.066893,0.132059
openstack/kolla-ansible,I0c7e9a28876a1d4278fb2ed8555c2b08472864b9,1,0,0,3.6636,0.1053,4,14.24,1679,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,4,4,0,0.8,1.5174,3.5,28.08,15.94,1,0,0.0,1,43.0513,1,0,0,0,0,"Extra var ironic_enable_keystone_integration added.

Basically, there are three main installation scenario:

Scenario 1:
Ironic installation together with other openstack services
including keystone. In this case variable enable_keystone
is set to true and keystone service will be installed
together with ironic installation. It is possible realise this
scenario, no fix needed

Scenario 2:
Ironic installation with connection to already installed
keystone. In this scenario we have to set enable_keystone
to ‚ÄúNo‚Äù to prevent from new keystone service installation
during the ironic installation process. But in other hand,
we need to have correct sections in ironic.conf to provide
all information needed to connect to existing keystone.
But all sections for keystone are added to ironic.conf only
if enable_keystone var is set to ‚ÄúYes‚Äù. It isn‚Äôt possible
to realise this scenario. Proposed fix provide support for
this scenario, where multiple regions share the same
keystone service.

Scenario 3:
No keystone integration. Ironic don't connect to Keystone.
It is possible realise this scenario, no fix needed

Proposed solution also keep the default behaviour: if no
enable_keystone_integration is manually defined by default
it takes value of enable_keystone variable and all behaviour
is the same. But if we don't want to install keystone and
want to connect to existing one at the same time, it will be
possible to set enable_keystone var to ‚ÄúNo‚Äù
(preventing keystone from installation) and at the same
time set ironic_enable_keystone_integration to Yes to allow
needed section appear in ironic.conf through templating.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+4, -4)
releasenotes/notes/update-ironic-template-for-keystone-1ee5f80fda7a21a0.yaml (+7, -0)
ansible/roles/ironic/defaults/main.yml (+1, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+22, -0)
",-3.448924,0.087742,3.874348,-0.47603,0.118061,0.628892,-0.999287,-0.795926,-0.492476,-0.230574,-0.461289,0.424222,-0.159115,0.160836,-0.000295
openstack/kolla-ansible,I75105baf434977c68bc5c8ca1f5213e602c52c8c,1,0,0.7925,2.1972,0.0,5,11.5,190,0,Feature,0,0,0,53,0.014913,0.0,0,0.0,4,2,0,0.8015,2.0,3.6,48.03,11.56,1,0,0.0,1,21.1111,1,0,0,0,0,"Add support for Debian Bullseye (11) as host distro

Makes nova-libvirt container always run in 'host' CgroupnsMode
to ensure it works.
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/check-containers.yml (+1, -0)
releasenotes/notes/debian-bullseye-host-adc7778d7103b84f.yaml (+4, -0)
ansible/roles/nova-cell/defaults/main.yml (+1, -0)
ansible/roles/nova-cell/handlers/main.yml (+1, -0)
ansible/roles/prechecks/vars/main.yml (+1, -0)
",1.19375,-1.264076,-0.351923,-0.187151,-0.023049,-0.291364,-0.097363,0.463897,-0.653989,-0.140035,-0.102141,0.089043,-0.000378,-0.079889,-0.518475
openstack/kolla-ansible,I99ebeb493ff9c3c7af0010ce1efea45c7f9a2559,1,0,0.5,1.0986,0.0,1,5.75,232,0,Bug Fix,0,0,0,4,0.016129,0.0,0,0.0,4,1,0,0.8029,0.0,4.0,-8.66,16.21,1,0,0.0,0,77.3333,1,0,0,0,0,"Add the ansible_managed header for admin-openrc.sh

This change inform us that the file is 'Ansible managed'

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/common/templates/admin-openrc.sh.j2 (+2, -0)
",0.750706,-0.97478,-1.06952,-0.34886,-0.182792,0.068576,-0.615844,-0.059565,-0.178167,-0.431152,0.208654,-0.069934,-0.500272,0.458803,-0.148688
openstack/kayobe,I916de4232155f36052ee8ffbd1947a750ffe9778,0,0,0.6,2.1972,0.25,4,13.4,553,0,Feature,0,0,0,5,0.02,0.0,0,0.0,5,2,0,0.94,1.5488,4.0,17.72,15.51,1,0,0.0,0,61.4444,1,0,0,0,0,"Set defaults for openstack_cacert

Since I0fd596d93a0e575a391250d4bed261ad370a3664 we always have the
'ca-certificates' package installed in the all containers so its fine
to set defaults but leave an ability to override the 'openstack_cacert'
via environment variable too. All supported systems already install
the 'ca-certificates' package by default but for sure we install it
on the Ansible control host in the kolla-ansible role itself.
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+1, -0)
ansible/group_vars/all/openstack (+3, -2)
ansible/roles/kolla-ansible/vars/Debian.yml (+1, -0)
ansible/roles/kolla-ansible/vars/RedHat.yml (+1, -0)
",-1.284647,-0.085247,-0.380848,0.027804,1.073006,-0.401803,0.698935,-0.273072,-0.032456,0.005466,0.245534,0.015081,-0.1091,0.110285,0.099787
openstack/kolla-ansible,Ia95355c529f1b0222dc1de06632984b6d130b9ec,1,0,0.7963,1.6094,1.0,3,5.17,305,0,Doc,0,0,0,54,0.01516,0.5,0,0.3981,4,1,0,0.8043,1.5,4.0,26.93,11.1,1,0,0.0,0,61.0,0,0,0,0,0,"Drop /sys/fs/cgroup mounts

They are handled by Docker since at least 18.09 (tested).
Backport to Wallaby at most to not introduce needless restarts in
already stable branches.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/792583
[SEP]
FILES CHANGED:
ansible/roles/multipathd/defaults/main.yml (+0, -1)
ansible/roles/nova-cell/defaults/main.yml (+0, -1)
ansible/roles/iscsi/defaults/main.yml (+0, -2)
",-0.553986,0.622418,-0.838156,-1.193243,-0.439608,-0.129555,1.215184,0.121554,0.005186,0.040853,0.053864,-0.326441,0.287864,-0.118909,-0.031432
openstack/kolla,I051fb0f17d97134d89da0b6668879a9b36de10d1,1,0,0,4.382,0.0,8,10.4,449,0,Feature,0,0,0,0,0.0,0.4444,0,0.0,3,5,0,0.7766,2.5092,2.62,4.3,17.24,1,0,0.0,1,5.6125,0,0,0,0,0,"venus: add log management system

This project provides a one-stop solution to log collection, cleaning, indexing, analysis, alarm, visualization, report generation and other needs.
Which involves helping operator or maintainer to quickly solve retrieve problems, grasp the operational health of the platform, and improve the level of platform management.

https://wiki.openstack.org/wiki/Venus
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -0)
docker/venus/venus-manager/Dockerfile.j2 (+13, -0)
docker/venus/venus-api/Dockerfile.j2 (+11, -0)
releasenotes/notes/add-venus-e2a9824f5ef5cf30.yaml (+6, -0)
docker/venus/venus-base/Dockerfile.j2 (+29, -0)
docker/venus/venus-base/extend_start.sh (+10, -0)
roles/kolla-build-config/defaults/main.yml (+1, -0)
kolla/common/config.py (+8, -0)
",-1.328708,-0.035335,-0.649172,1.335514,0.072201,0.220037,0.022867,0.143024,0.464418,0.238564,-0.250926,0.571926,0.398728,-0.722249,-0.231646
openstack/kolla-ansible,If3562bbed6181002b76831bab54f863041c5a885,1,0,1.0,6.2934,0.0,33,13.5,455,0,Feature,0,0,0,1,0.0125,1.0,0,1.0,6,4,0,0.8058,3.9668,3.55,8.27,17.25,1,0,0.0167,1,0.841,0,0,0,0,0,"ADD venus for kolla-ansible

This project [1] can provide a one-stop solution to log collection,
cleaning, indexing, analysis, alarm, visualization, report generation
and other needs, which involves helping operator or maintainer to
quickly solve retrieve problems, grasp the operational health of the
platform, and improve the level of platform management.

[1] https://wiki.openstack.org/wiki/Venus
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+9, -0)
ansible/roles/venus/tasks/main.yml (+2, -0)
ansible/roles/venus/handlers/main.yml (+32, -0)
ansible/site.yml (+18, -0)
ansible/roles/venus/tasks/check-containers.yml (+17, -0)
ansible/roles/venus/vars/main.yml (+2, -0)
ansible/inventory/all-in-one (+9, -0)
ansible/roles/venus/tasks/register.yml (+7, -0)
ansible/roles/venus/tasks/deploy.yml (+14, -0)
ansible/roles/venus/tasks/pull.yml (+11, -0)
ansible/roles/venus/tasks/upgrade.yml (+7, -0)
ansible/roles/venus/tasks/bootstrap.yml (+34, -0)
ansible/roles/venus/tasks/deploy-containers.yml (+2, -0)
ansible/roles/venus/tasks/reconfigure.yml (+2, -0)
etc/kolla/globals.yml (+1, -0)
ansible/roles/venus/tasks/copy-certs.yml (+6, -0)
ansible/roles/venus/templates/venus-manager.json.j2 (+19, -0)
etc/kolla/passwords.yml (+3, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
ansible/roles/common/templates/cron-logrotate-venus.conf.j2 (+3, -0)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+5, -0)
ansible/roles/venus/tasks/loadbalancer.yml (+7, -0)
ansible/roles/venus/templates/venus-api.json.j2 (+19, -0)
ansible/roles/venus/defaults/main.yml (+138, -0)
ansible/roles/venus/tasks/clone.yml (+8, -0)
ansible/roles/venus/tasks/config.yml (+81, -0)
ansible/group_vars/all.yml (+3, -0)
ansible/roles/venus/tasks/precheck.yml (+24, -0)
releasenotes/notes/add-venus-80b98b2d3bea348e.yaml (+5, -0)
ansible/roles/venus/tasks/stop.yml (+6, -0)
ansible/roles/venus/tasks/check.yml (+1, -0)
tests/templates/inventory.j2 (+9, -0)
ansible/roles/venus/templates/venus.conf.j2 (+35, -0)
",-1.275738,-0.585978,-0.114663,0.828714,-0.126142,-0.308734,-0.251918,0.246945,0.34663,0.264623,-0.361084,0.466306,0.219478,-0.4728,-0.389625
openstack/kolla,I0b3eb6744a34a601266179fb358510a5c500e6ba,1,1,0,1.9459,0.0,2,15.0,339,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,2,2,0,0.7789,0.65,2.0,41.21,11.33,1,0,0.0,1,48.4286,0,6,0,15,0,"Fix _get_images_dir when pip-installed with --user

There are two cases where pip installs kolla share into ~/.local/share/kolla:

- with `pip install --user kolla`
- with `pip install kolla` as non-root

This patch helps kolla find the share dir in these cases.

Closes-Bug: #1930544
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -0)
releasenotes/notes/bug-1930544-a8926990f3a578a9.yaml (+5, -0)
",-1.035373,-0.753125,-0.58855,0.010018,0.284562,-0.511026,-0.709777,0.067058,-0.467845,-0.247489,0.005495,-0.551927,0.592555,0.342401,0.214408
openstack/oslo.config,I70ab87c9bed093cad883b6301b8a09753fc470d9,1,1,1.0,2.7081,0.0,1,10.0,414,0,Bug Fix,0,0,0,1,0.066667,1.0,0,1.0,1,1,0,0.6667,0.0,1.0,35.95,12.8,1,0,0.0,0,27.6,0,6,0,15,0,"config-generator yaml format doesn't work with i18n fields

This is because there's no yaml representer for i18n Messages object.
This patch aims to add this representer and allow the generation of
configurations using oslo.i18n strings.

One example of this is cinder.

Closes-bug: #1928582
(cherry picked from commit e5fc313ecf47813364a2111b987ced823c0d64e3)
[SEP]
FILES CHANGED:
oslo_config/generator.py (+14, -0)
",-2.880221,-0.294456,0.450776,-1.99966,1.141011,-0.006923,1.029218,-0.046027,0.007189,0.076355,0.23346,0.132621,0.096798,-0.109664,-0.170758
openstack/kolla-ansible,Ib15f81120d353ebcf8965dc0aaba90f3a9b0ec44,0,1,0.9,2.6391,0.4615,3,14.0,239,0,Bug Fix,0,0,0,50,0.020756,0.7143,0,0.6429,3,2,0,0.8071,1.4196,2.0,20.4,17.03,0,0,0.6923,1,17.0714,0,6,0,11,0,"CI: test interface names with dashes

Interface names with dashes can cause problems in Ansible since dashes
are replaced with underscores when referencing facts.

Related-Bug: #1927357
[SEP]
FILES CHANGED:
roles/cephadm/templates/cephadm.yml.j2 (+2, -2)
tests/templates/neutron-server-overrides.j2 (+1, -1)
zuul.d/base.yaml (+4, -3)
",-0.073544,-0.884584,-0.565383,0.021445,0.255496,0.238666,-1.143259,-0.604005,-0.267653,0.239614,-0.295668,-0.105193,0.606647,-0.366323,-0.095054
openstack/kolla,I3c6fdcb9b7dd7443a7755599f7e4ee59f67e0a91,1,1,0.9524,1.0986,0.5,1,6.62,542,0,Bug Fix,0,0,0,21,0.044681,1.0,0,0.9524,2,1,0,0.7812,0.0,2.0,-39.32,16.99,1,0,0.0,0,180.6667,0,6,0,7,0,"Add missing default policy files for ubuntu-binary-horizon

The ubuntu-binary-horizon image is missing the default policies files
which should be in /etc/openstack-dashboard/default_policies. By copying
everything from /usr/share/openstack-dashboard/openstack_dashboard/conf
into /etc/openstack-dashboard, we get the default policy files, as well
as commented out policy files (e.g. cinder_policy.yaml) and the
nova_policy.d directory containing api-extensions.yaml.

Closes-Bug: #1930586
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+1, -1)
",-2.757264,1.020924,0.283767,-0.536439,0.637765,-0.548631,0.365129,0.238429,-0.189802,-0.483568,-0.057292,0.003107,-0.157396,0.281025,0.004424
openstack/kayobe,I608c0362e6eeea65ffafb32cda5c19ccb6ec8b5c,1,0,0.8824,2.3979,0.0,2,5.67,342,0,Bug Fix,0,0,0,51,0.021057,0.0,0,0.0,4,2,0,0.9216,0.971,3.0,-5.44,16.38,0,0,0.0,1,31.0909,0,0,0,0,0,"Fix container image builds

Container image builds broken due to disabling docker iptables
management in
https://review.opendev.org/c/openstack/kolla-ansible/+/751795. This
affects Wallaby and later.

This patch configures kolla-build to use network_mode=host.

Story: 2008942
Task: 42560
[SEP]
FILES CHANGED:
releasenotes/notes/kolla-build-network-mode-ba92e36d52e70d99.yaml (+6, -0)
ansible/roles/kolla-build/templates/kolla-build.conf.j2 (+4, -0)
",-1.053768,0.362376,-1.0345,-0.320138,-0.78627,-0.393124,-0.523504,0.282951,0.077827,-0.241064,-0.313961,-0.255417,0.191496,0.137702,-0.01791
openstack/kolla-ansible,Ideac1925cb764ad0d7d8416f56d5e4a993c6d8b6,1,0,0,1.6094,0.5,1,13.67,313,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,6,1,0,0.8014,0.0,6.0,42.33,14.25,1,0,0.0,0,62.6,0,0,0,0,0,"Stop fluentd deprecation warnings of type vs @type

Currently when elasticsearch log output is enabled there are lots
of warnings going into elasticsearch about type being deprecated
and needing to move to @type. This change stops those warnings.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+2, -2)
",-0.081308,-1.357631,-0.378961,0.430527,-0.004968,0.258386,-0.395321,-0.689126,-0.196578,0.021477,-0.183756,0.01394,0.007875,-0.28931,0.181843
openstack/kolla-ansible,I45be67df3717f78d78bcdc7df69600ab8681922f,1,1,1.0,2.3979,0.0,3,16.0,523,0,Bug Fix,0,0,0,1,0.2,1.0,0,1.0,6,2,0,0.8028,1.361,4.67,26.68,13.9,1,0,0.0,1,47.5455,0,6,0,8,0,"Add suppress_type_name to stop warnings with ES7

When using elasticsearch 7 with fluentd, you seem to get a lot
of warnings in the docker logs output that look like:

    [types removal] Specifying types in bulk requests is deprecated.

The docs suggest adding suppress_type_name to stop these warnings,
and that seems to work without affecting any functionality.

Further info here:
https://github.com/uken/fluent-plugin-elasticsearch/issues/785

Closes-Bug: #1930856
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/01-es.conf.j2 (+1, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+4, -0)
releasenotes/notes/fix_supress_type_warning-59f87fe62f83bd12.yaml (+5, -0)
",-1.474179,-0.422621,0.136945,0.150626,-0.530012,-0.235675,-0.434372,-0.250206,-0.031102,0.430594,-0.020693,-0.400696,0.193577,-0.027083,-0.014484
openstack/kolla-ansible,Icd72206de7c1f701bdf35c8fb3b128ef2dbe29a8,1,0,1.0,1.0986,0.5,1,6.75,419,0,Bug Fix,0,0,0,2,0.133333,0.6667,0,0.6667,6,1,0,0.8042,0.0,6.0,35.48,13.07,1,0,0.0,0,139.6667,0,0,0,0,0,"Fix parsing of infra.mariadb.xinetd logs

Currently the logs tagged with infra.mariadb.xinetd flow into
elasticsearch with no hostname or programname attach, thus making
navigating the logs very hard.

The quick fix is renaming the tag to infra.mariadb-xinetd, which is just
enought to ensure the logs are processed correctly with the existing
filters.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/input/02-mariadb.conf.j2 (+1, -1)
",-1.884244,-0.050031,-0.543615,0.784937,0.793917,-0.413724,0.052091,-0.103807,-0.323154,0.075231,0.517554,0.021619,-0.037564,0.01677,0.159441
openstack/kolla-ansible,I3bb74dcdc3cbe78cd1e1657f44e2a0af9d6508ef,1,0,1.0,1.6094,0.5,2,17.0,360,0,Bug Fix,0,0,0,3,0.176471,1.0,0,1.0,6,1,0,0.8056,1.0,6.0,40.29,15.43,1,0,0.0,0,72.0,0,0,0,0,0,"Robustify fluentd output tag matching

We really want elasticsearch or monasca to catch all logs,
to providd the required centrailsed logging.

While these appears to make little material difference,
it should make it harder for logs to not get caught by
any of the outputs we have configured.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/output/01-es.conf.j2 (+1, -1)
",-0.48017,-2.513225,-0.557529,0.312399,-0.256532,-0.21583,-0.348342,-0.585446,-0.502617,0.267009,-0.453004,0.053779,0.219821,-0.399177,0.214974
openstack/oslo.messaging,If129b56be47952d018b9f6024d2a192950c1a974,1,0,1.0,1.9459,0.5,1,3.86,292,0,Doc,0,0,0,1,0.333333,0.3721,0,0.3721,0,1,0,0.3529,0.0,0.0,11.79,10.43,0,0,0.0,1,41.7143,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-1.877485,3.05582,-1.292178,0.978966,0.070687,-0.260951,0.110036,-0.040772,-0.280312,0.767143,-0.438821,-0.604713,0.039271,0.428285,0.451685
openstack/oslo.i18n,I75d9aa9aafc692f7bc67be59ee20523eb07d573d,1,0,1.0,1.6094,0.5,1,3.86,292,0,Doc,0,0,0,2,0.222222,0.3864,0,0.3864,0,1,0,1.0,0.0,0.0,5.52,10.43,0,0,0.0,1,58.4,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+2, -2)
",-1.877485,3.05582,-1.292178,0.978966,0.070687,-0.260951,0.110036,-0.040772,-0.280312,0.767143,-0.438821,-0.604713,0.039271,0.428285,0.451685
openstack/oslo.policy,I28abab34878d3c62a88be8894107f994d02c1c4f,1,0,1.0,1.9459,0.5,1,3.86,292,0,Doc,0,0,0,3,0.230769,0.4,0,0.4,0,1,0,0.75,0.0,0.0,8.65,10.43,0,0,0.0,1,41.7143,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-1.877485,3.05582,-1.292178,0.978966,0.070687,-0.260951,0.110036,-0.040772,-0.280312,0.767143,-0.438821,-0.604713,0.039271,0.428285,0.451685
openstack/oslo.privsep,I4ad1fbca83af0f0c89c3f18d38caa66ee735ea3e,1,0,1.0,1.9459,0.5,1,3.86,292,0,Doc,0,0,0,4,0.210526,0.413,0,0.413,0,1,0,1.0,0.0,0.0,2.39,10.43,0,0,0.0,1,41.7143,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-1.877485,3.05582,-1.292178,0.978966,0.070687,-0.260951,0.110036,-0.040772,-0.280312,0.767143,-0.438821,-0.604713,0.039271,0.428285,0.451685
openstack/oslo.reports,I7482b0cfa02e0ac5dfb9813e1eb7c4e4d032b8ac,1,0,1.0,1.9459,0.5,1,3.86,292,0,Doc,0,0,0,5,0.2,0.4255,0,0.4255,0,1,0,0.0,0.0,0.0,-0.75,10.43,0,0,0.0,1,41.7143,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+3, -3)
",-1.877485,3.05582,-1.292178,0.978966,0.070687,-0.260951,0.110036,-0.040772,-0.280312,0.767143,-0.438821,-0.604713,0.039271,0.428285,0.451685
openstack/kayobe,I4613e8973ccaef4534e44e3c79e910de5041add0,1,0,0.8,1.0986,0.5,1,4.17,302,0,Doc,0,0,0,55,0.015423,1.0,0,0.8,3,1,0,0.9231,0.0,3.0,-64.73,16.07,1,0,0.0,0,100.6667,0,0,0,0,0,"Optimise order of inspector_processing_hooks

Ironic Inspector docs [1] recommend to use lldp_basic before
local_link_connection.
It is also how TripleO applies them.

[1] https://docs.openstack.org/ironic-inspector/wallaby/user/usage.html#plugins
[SEP]
FILES CHANGED:
ansible/group_vars/all/inspector (+1, -1)
",-0.011218,0.996701,-0.62953,0.315023,-0.855615,-0.462645,0.393552,0.310446,0.174604,-0.25114,-0.241036,-0.537786,-0.336168,-0.296568,-0.316157
openstack/oslo.config,I70ab87c9bed093cad883b6301b8a09753fc470d9,1,1,1.0,2.7081,0.0,1,11.0,483,0,Bug Fix,0,0,0,2,0.068966,1.0,0,1.0,1,1,0,0.75,0.0,1.0,31.08,13.13,1,0,0.0,0,32.2,0,6,0,15,0,"config-generator yaml format doesn't work with i18n fields

This is because there's no yaml representer for i18n Messages object.
This patch aims to add this representer and allow the generation of
configurations using oslo.i18n strings.

One example of this is cinder.

Closes-bug: #1928582
(cherry picked from commit e5fc313ecf47813364a2111b987ced823c0d64e3)
(cherry picked from commit de1dbeed235d2df7cf1528aef6ad4a70ddf8559f)
[SEP]
FILES CHANGED:
oslo_config/generator.py (+14, -0)
",-2.880221,-0.294456,0.450776,-1.99966,1.141011,-0.006923,1.029218,-0.046027,0.007189,0.076355,0.23346,0.132621,0.096798,-0.109664,-0.170758
openstack/oslo.config,I70ab87c9bed093cad883b6301b8a09753fc470d9,1,1,1.0,2.7081,0.0,1,12.0,552,0,Bug Fix,0,0,0,3,0.069767,1.0,0,1.0,1,1,0,0.8,0.0,1.0,25.46,13.47,1,0,0.0,0,36.8,0,6,0,15,0,"config-generator yaml format doesn't work with i18n fields

This is because there's no yaml representer for i18n Messages object.
This patch aims to add this representer and allow the generation of
configurations using oslo.i18n strings.

One example of this is cinder.

Closes-bug: #1928582
(cherry picked from commit e5fc313ecf47813364a2111b987ced823c0d64e3)
(cherry picked from commit de1dbeed235d2df7cf1528aef6ad4a70ddf8559f)
(cherry picked from commit 0950f82ec59e1b4a2af66b5c5940a651a5cb574f)
[SEP]
FILES CHANGED:
oslo_config/generator.py (+14, -0)
",-2.880221,-0.294456,0.450776,-1.99966,1.141011,-0.006923,1.029218,-0.046027,0.007189,0.076355,0.23346,0.132621,0.096798,-0.109664,-0.170758
openstack/kolla-ansible,I2d0615ce6914e1f875a2647c8a95b86dd17eeb22,1,1,0.5,2.5649,0.0833,3,10.67,563,0,Bug Fix,0,0,0,6,0.023256,0.0,0,0.0,4,2,0,0.8069,1.4591,3.33,24.16,13.64,1,0,0.0,1,43.3077,0,6,0,12,0,"Add forgotten 'Restart container' handler for swift

Since I0474324b60a5f792ef5210ab336639edf7a8cd9e swift role uses the new
service-cert-copy role introduced in the
I6351147ddaff8b2ae629179a9bc3bae2ebac9519 but the swift role itself
doesn't contain the handler used in the service-cert-copy. Right now,
restarting the swift container isn't necessary, but the handler should
exist. Also we should fix the name of the service used.

Closes-Bug: #1931097
[SEP]
FILES CHANGED:
ansible/roles/swift/defaults/main.yml (+1, -1)
ansible/roles/swift/handlers/main.yml (+4, -0)
releasenotes/notes/bug-1931097-c94832ed2ed92c3a.yaml (+6, -0)
",-1.044263,-0.848334,-0.514921,-1.02678,0.613444,-0.038495,1.049929,-0.058505,0.349773,-0.143486,0.471271,0.428867,0.038268,0.031936,0.175429
openstack/kolla-ansible,Ib32b78cfd6f3fe535d30d8aa48f3187b9aec746e,0,1,0.8846,1.7918,0.0,1,26.6,938,0,Bug Fix,0,0,0,52,0.021382,0.0,0,0.0,4,1,0,0.8082,0.0,4.0,21.45,22.07,0,0,0.0,0,156.3333,0,6,0,5,0,"grafana: add bootstrap during upgrade

Upgrading from Victoria to Wallaby with Monasca enabled fails waiting
for Grafana to start.

Grafana defaults to enabled if Monasca is enabled in Wallaby (was
default disabled in Victoria), so the database user and tables don't
necessarily exist prior to the upgrade.

Running `kolla-ansible upgrade` then attempts to start the Grafana
container, but fails to include the bootstrap task (which creates the
db) so the container is unable to start with a database connection
error, from the grafana container logs:

  service init failed: failed to check table existence: Error 1045:
  Access denied for user 'grafana'@'xxx' (using password: YES)

This change performs a bootstrap of Grafana during upgrade. It is
required only for the Wallaby release where the default change is
introduced.

Closes-Bug: #1931037
Co-Authored-By: Scott Shambarger
[SEP]
FILES CHANGED:
ansible/roles/grafana/tasks/upgrade.yml (+5, -0)
",-2.659639,-0.735442,2.345355,-0.706939,-0.221776,0.178788,-0.122973,0.265565,-0.128182,-0.331669,0.541574,0.08048,0.068377,0.102598,-0.171128
openstack/kolla,Iefcdd3100b7e3c5320bc5f1286a18251bdeab885,1,1,0.8462,2.7081,0.0714,3,6.13,590,0,Bug Fix,0,0,0,13,0.013444,1.0,0,0.8462,2,3,0,0.7835,1.5306,2.0,70.95,7.24,0,0,0.0,1,39.3333,0,10,0,28,0,"Pin td-agent to 4.0.* to fix missing logs

The recent inclusion of Fluentd 1.12.x in Centos/Ubuntu packages
causes a significant number of logs to fail to appear in the
Elasticsearch or Monasca output plugins. The logs appear to
sit in a local buffer, and are only flushed when Fluentd is
restarted. The same issue persists in the most recent release
(1.13.0), so for now we pin the td-agent package to 4.0.* which
should restrict Fluentd to the 1.11.x release where we don't
see this issue.

Backport to Victoria.

Closes-Bug: #1930867
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+5, -0)
docker/fluentd/Dockerfile.j2 (+2, -1)
releasenotes/notes/bug-1930867.yaml (+6, -0)
",-1.711716,-0.765591,0.671587,-0.047006,-0.400672,-0.076323,0.07401,0.368653,-0.158694,0.504649,0.168456,0.394811,-0.171812,-0.145648,0.333312
openstack/kolla,I7430b72f5d8abe59a7151df73e6d59898d942636,1,0,0.8636,3.3673,0.3929,3,4.25,219,0,Doc,0,0,0,22,0.043651,0.375,0,0.3239,2,2,0,0.7857,1.0949,2.0,-26.4,13.46,0,0,0.7143,1,7.5517,0,0,0,0,0,"Change network_mode default to host

Kolla-Ansible deploys Docker without bridge by default [1].

[1]: https://review.opendev.org/c/openstack/kolla-ansible/+/751795
[SEP]
FILES CHANGED:
releasenotes/notes/network-mode-host-2aca256e2a1fbf68.yaml (+6, -0)
kolla/common/config.py (+1, -1)
kolla/tests/test_build.py (+10, -10)
",-0.57397,2.76117,-1.682569,0.54364,-0.82861,0.170031,-0.066173,0.035613,0.013149,-0.193725,-0.210149,-0.110007,0.061037,-0.279699,-0.419873
openstack/kolla-ansible,I1823301d5889589bfd48326ed7de03c6061ea5ba,1,1,0.8679,3.1781,0.0435,2,11.11,712,0,Bug Fix,0,0,0,53,0.021748,0.0,0,0.0,4,2,0,0.8027,0.7554,3.0,51.74,10.44,0,0,0.0,1,29.6667,0,12,0,21,0,"Fix RabbitMQ restart ordering

The host list order seen during Ansible handlers may differ to the usual
play host list order, due to race conditions in notifying handlers. This
means that restart_services.yml for RabbitMQ may be included in a
different order than the rabbitmq group, resulting in a node other than
the 'first' being restarted first. This can cause some nodes to fail to
join the cluster. The include_tasks loop was introduced in [1].

This change fixes the issue by splitting the handler into two tasks, and
restarting the first node before all others.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/763137

Closes-Bug: #1930293
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/handlers/main.yml (+17, -1)
releasenotes/notes/bug-1930293-d8a524f2070e6779.yaml (+5, -0)
",-2.075272,-0.276662,1.076572,0.032115,-0.546689,0.11574,0.070764,0.021773,0.267408,-0.124412,-0.023103,0.158571,-0.177782,-0.318887,-0.1636
openstack/kolla,I3c6fdcb9b7dd7443a7755599f7e4ee59f67e0a91,0,1,0.8036,1.0986,0.5,1,7.25,611,0,Bug Fix,0,0,0,56,0.015695,1.0,0,0.8036,2,1,0,0.7879,0.0,2.0,-35.36,16.69,1,0,0.0,0,203.6667,0,6,0,7,0,"Add missing default policy files for ubuntu-binary-horizon

The ubuntu-binary-horizon image is missing the default policies files
which should be in /etc/openstack-dashboard/default_policies. By copying
everything from /usr/share/openstack-dashboard/openstack_dashboard/conf
into /etc/openstack-dashboard, we get the default policy files, as well
as commented out policy files (e.g. cinder_policy.yaml) and the
nova_policy.d directory containing api-extensions.yaml.

Closes-Bug: #1930586
(cherry picked from commit 740448a658f0060b86d56e78915d8b751ade3616)
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+1, -1)
",-2.757264,1.020924,0.283767,-0.536439,0.637765,-0.548631,0.365129,0.238429,-0.189802,-0.483568,-0.057292,0.003107,-0.157396,0.281025,0.004424
openstack/octavia,I8f0d3ba1d083c7e37e7e26617826400a538a0890,1,0,0.6607,2.8332,0.125,3,18.5,326,0,Bug Fix,0,0,0,56,0.005885,0.3333,0,0.2202,7,2,0,0.5336,1.5794,4.67,-6.29,22.54,1,0,0.3125,1,19.1765,0,0,0,0,0,"Fix using host_routes in VIP subnet with amphorav2

Ensure that amphorae_network_config parameter is not modified in
AmphoraPostVIPPlug. Modifying it would break amphorav2 persistence by
introducing non-serializable elements in the subnet dict

Story: 2008955
Task: 42580
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+4, -2)
releasenotes/notes/fix-host-routes-with-amphorav2-and-persistence-54b99d651a4ee9c4.yaml (+5, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+5, -0)
",-0.45412,-1.459656,-0.594351,0.070204,0.368799,-0.326204,-0.585158,0.321004,0.309131,-0.41979,0.013185,-0.341947,-0.373145,-0.24425,-0.009187
openstack/kolla-ansible,I9d5ebed293a5fb25f4cd7daa473df152440e8b50,1,0,1.0,6.3456,0.9877,39,10.0,167,0,Feature,0,0,0,2,0.014815,1.0,0,1.0,6,5,0,0.8041,4.3668,3.56,27.49,14.0,1,0,0.0123,1,0.293,0,0,0,0,0,"Remove support for panko

the project is deprecated and in the process of being removed
from OpenStack upstream.
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -7)
ansible/roles/ceilometer/templates/ceilometer-notification.json.j2 (+1, -8)
ansible/roles/common/templates/conf/filter/01-rewrite-0.14.conf.j2 (+1, -6)
ansible/roles/panko/templates/wsgi-panko.conf.j2 (+0, -36)
ansible/roles/ceilometer/tasks/config.yml (+0, -23)
ansible/roles/panko/tasks/deploy-containers.yml (+0, -2)
releasenotes/notes/remove-panko-component-dda787fca995b9b096a1446e2d2cf9dede37f358.yaml (+4, -0)
README.rst (+0, -1)
ansible/roles/panko/tasks/pull.yml (+0, -8)
ansible/roles/ceilometer/templates/event_pipeline.yaml.j2 (+0, -3)
ansible/site.yml (+0, -19)
ansible/roles/panko/tasks/config.yml (+0, -97)
ansible/inventory/all-in-one (+0, -7)
ansible/roles/panko/tasks/stop.yml (+0, -6)
ansible/roles/panko/templates/panko-api.json.j2 (+0, -32)
ansible/roles/panko/templates/panko.conf.j2 (+0, -37)
etc/kolla/globals.yml (+0, -1)
ansible/roles/common/templates/conf/filter/01-rewrite-0.12.conf.j2 (+1, -2)
ansible/roles/panko/handlers/main.yml (+0, -15)
ansible/roles/panko/tasks/bootstrap.yml (+0, -36)
ansible/roles/panko/tasks/deploy.yml (+0, -11)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/panko/tasks/loadbalancer.yml (+0, -7)
ansible/roles/panko/tasks/main.yml (+0, -2)
ansible/roles/panko/tasks/bootstrap_service.yml (+0, -20)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/panko/tasks/check.yml (+0, -1)
ansible/roles/common/templates/cron-logrotate-panko.conf.j2 (+0, -3)
ansible/roles/panko/tasks/precheck.yml (+0, -24)
ansible/roles/panko/tasks/upgrade.yml (+0, -9)
ansible/roles/haproxy/tasks/precheck.yml (+0, -13)
ansible/roles/panko/tasks/register.yml (+0, -7)
ansible/roles/panko/defaults/main.yml (+0, -79)
ansible/group_vars/all.yml (+0, -3)
ansible/roles/panko/tasks/check-containers.yml (+0, -16)
ansible/roles/panko/tasks/copy-certs.yml (+0, -6)
tests/templates/inventory.j2 (+0, -7)
ansible/roles/panko/tasks/reconfigure.yml (+0, -2)
",1.572835,-1.412068,0.316069,0.054868,-0.424735,0.373959,-0.279635,-0.118549,-0.696322,0.187759,-0.396529,0.650475,-0.615457,0.137842,-0.193486
openstack/ironic,Ic042f0a87ff0723f313adb3888c24c5963624182,1,0,1.0,5.1475,0.0175,6,11.33,279,0,Bug Fix,0,0,0,3,0.003219,1.0,0,1.0,6,2,0,1.0,1.3556,3.67,33.6,15.12,1,0,0.7544,1,1.6221,0,0,0,0,0,"Fix Redfish RAID interface_type physical disk hint

Map between sushy's protocol and RAID config schema's
interface_type constants.

Not supporting `scsi` from RAID schema as Redfish does
not support it in Protocol property.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+26, -1)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+121, -2)
ironic/tests/unit/drivers/third_party_driver_mock_specs.py (+3, -0)
releasenotes/notes/fix-redfish-raid-interface-type-4b3566b637cc2301.yaml (+5, -0)
ironic/tests/unit/drivers/third_party_driver_mocks.py (+3, -0)
ironic/common/raid.py (+10, -0)
",1.204111,-0.862939,0.092278,0.846548,0.422758,-0.087832,0.068542,0.658542,0.253769,-0.375657,-0.322764,-0.0642,-0.176615,-0.154922,-0.154487
openstack/oslo.db,Idb0410a1946acbd7caf6a0bb1dad229bd5c2c346,1,0,0,2.1972,0.0,1,5.67,189,0,Feature,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.0,0.0,2.0,-2.95,18.74,1,0,0.0,1,21.0,0,0,0,0,0,"Followup of ""Added handler for mysql 8.0.19 duplicate key error update""

Followup of change: Ic78059b625e73cece355541cb4d89e641abc1103
[SEP]
FILES CHANGED:
releasenotes/notes/fix-mysql-duplicate-key-error-information-update-548888bc44b8dbd7.yaml (+8, -0)
",0.877375,-0.12326,-1.652306,-2.093327,0.916306,0.65111,0.538565,-0.130407,0.56636,0.336252,-0.409503,0.235758,-0.242491,-0.013076,0.300228
openstack/tooz,Ibca3f568b65dfea252da4b67f6d5105ba7f1ecb1,1,0,0,4.3567,0.4675,2,26.0,246,0,CI,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.7143,0.3467,2.0,-1.77,21.17,1,0,0.0,1,3.1538,0,0,0,0,0,"Enable retries in redis driver

this is followup to Iaab5ce609c0dcf7085f5dd43efbd37eb4b88f17b

actually retry for specified number of retries instead of raising
error on first ConnectionError
[SEP]
FILES CHANGED:
releasenotes/notes/redis-connect-retries-c9adfc81eb06a4ab.yaml (+5, -0)
tooz/drivers/redis.py (+36, -36)
",-2.179774,-0.746613,-1.035269,-2.084647,1.817083,0.069133,1.215096,-0.272495,0.185379,0.550124,0.043533,0.140965,0.271325,0.00783,-0.083914
openstack/kayobe,I2637085a1df22e39d64c33b823fc948063d3e06f,1,0,1.0,1.0986,0.5,1,6.5,126,0,Bug Fix,0,0,0,1,0.025641,1.0,1,1.0,4,1,0,0.9245,0.0,4.0,44.05,11.83,1,0,0.0,0,42.0,0,0,0,0,0,"Fix url to ansible site in kolla-ansible.rst

Story: 2008961
Task: 42597
[SEP]
FILES CHANGED:
doc/source/configuration/reference/kolla-ansible.rst (+1, -1)
",0.93418,1.689873,-1.696225,-0.351792,-0.24539,0.543785,-0.207742,-0.085432,0.0047,-0.750032,0.79219,0.304797,-0.242537,0.856474,-0.287209
openstack/kolla,I60a76f42708f1746bd2c582ce25867ac34c9e865,1,0,0.7895,1.0986,1.0,1,6.33,202,0,CI,1,1,0,57,0.015966,1.0,0,0.7895,2,1,0,0.78,0.0,2.0,17.85,13.06,1,0,1.0,0,67.3333,0,0,0,0,0,"Revert ""[CI] Add grafana to allowed-to-fail""

This reverts commit a6884085e1a5336f17c2ed64f67d8f885c454207.

Reason for revert: Repo is fine again.
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+0, -2)
",0.134956,-0.391042,-2.062079,-1.715467,0.565751,0.444753,0.352161,-0.405094,0.161512,-0.003817,-0.115321,0.335113,-0.034971,0.173985,-0.264567
openstack/ironic-python-agent,Ibf1ef4fe0764c0a6f1a39cb7eebc23ecc0ee177d,1,0,1.0,5.0239,0.0927,3,8.54,820,0,Bug Fix,0,0,0,5,0.033557,1.0,0,1.0,4,2,0,0.8333,1.4336,2.67,37.35,10.26,0,0,0.5033,1,5.3947,0,0,0,0,0,"Utilize CSV file for EFI loader selection

Adds support to identify and utilize a CSV file to signal which
bootloader to utilize, and set it when the OS is running as opposed
to when EFI is running. This works around EFI loader potentially
crashing some vendors hardware types when entry stored in the
image does not match the EFI loader record which was utilzied to
boot.

Grub2+shim specifically specifically needs the CSV file name
and entry label to match what the system was booted with in order
to prevent the machine from potentially crashing.

See https://storyboard.openstack.org/#!/story/2008962
and https://bugzilla.redhat.com/show_bug.cgi?id=1966129#c37
for more information.

Story: 2008962
Task: 42598
Co-Authored-By: Bob Fournier <bfournie@redhat.com>
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+72, -4)
ironic_python_agent/extensions/image.py (+43, -10)
releasenotes/notes/support-bootloader-csv-file-use-c815b520c600cd98.yaml (+22, -0)
",-2.736275,-0.00025,1.839217,-0.567486,-0.655891,0.078816,-0.082819,0.06153,0.078161,-0.18353,0.10005,0.003268,-0.05974,0.172458,-0.141607
openstack/kayobe-config-dev,Ie3eec95ac7dadbfc613e913c09371d61b7e5eb2a,1,0,1.0,1.3863,0.0,1,10.0,197,0,Feature,0,0,0,5,0.063291,0.0,0,0.0,3,1,0,0,0.0,3.0,-35.96,20.0,0,0,0.0,0,49.25,0,0,0,0,0,"Enable deploying monitoring with default inventory

This makes enabling monitoring possible without any modification
to the default inventory.
[SEP]
FILES CHANGED:
etc/kayobe/inventory/hosts (+3, -0)
",1.346071,-1.017713,0.117556,1.219168,0.153336,0.644172,0.091573,-0.16936,0.12711,0.084531,-0.324076,0.333392,0.056822,-0.016596,-0.525089
openstack/ironic-python-agent,Ifd738b2c5663f1a211d7e13b5ba386be631d8db1,1,0,1.0,3.3322,0.2593,3,13.0,192,0,Feature,0,0,0,1,0.003984,1.0,0,1.0,4,2,0,0.8571,1.3604,2.67,47.22,14.43,1,0,0.5926,1,6.8571,0,0,0,0,0,"Only mount the ESP if not yet mounted

Check if the ESP is already mounted before attempting to mount it
for the bootloader installation.
[SEP]
FILES CHANGED:
releasenotes/notes/check-if-ESP-is-mounted-f9e0eff3609c2668.yaml (+7, -0)
ironic_python_agent/tests/unit/extensions/test_image.py (+10, -6)
ironic_python_agent/extensions/image.py (+3, -1)
",1.220465,-0.912042,0.04858,1.047785,0.07965,0.417055,0.572973,-0.884322,-0.029955,0.015094,0.436369,0.526548,-0.281358,0.518315,-0.32228
openstack/kolla,Ie8b9659d03b3a442695b091e946e7be1fd1bdd89,1,0,0.7931,1.0986,0.5,1,5.0,105,0,Bug Fix,0,0,0,58,0.016237,0.3333,1,0.2644,2,1,0,0.7822,0.0,2.0,49.48,10.0,1,1,0.0,0,35.0,0,0,0,0,0,"[docs] Fix Debian release name

It's Bullseye now.
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+1, -1)
",3.623124,0.821973,0.622145,-0.548574,-1.003389,1.446186,0.653752,-0.309007,-0.720682,0.118676,0.745187,0.024485,-0.340556,0.140215,-0.850422
openstack/kolla,If69536387513ca221e03a80878016532a41aef87,1,0,0.9545,1.0986,0.5,1,5.27,854,0,Bug Fix,0,0,0,22,0.04661,0.0,0,0.0,3,1,0,0.7843,0.0,3.0,-21.25,13.25,0,0,0.0,0,284.6667,0,0,0,0,0,"Fix build of masakari-monitors image

The CentOS 8 Advanced Virtualization repository recently added libvirt
7.0.0. The current version of libvirt-python fails to build against it:

    running build
    /usr/bin/pkg-config --print-errors --atleast-version=0.9.11 libvirt
    /var/lib/kolla/venv/bin/python3.6 generator.py libvirt /usr/share/libvirt/api/libvirt-api.xml
    Found 480 functions in /usr/share/libvirt/api/libvirt-api.xml
    Found 0 functions in libvirt-override-api.xml
    Generated 389 wrapper functions
    Missing type converters:
    char ** *:1
    char **:1
    ERROR: failed virDomainAuthorizedSSHKeysGet
    ERROR: failed virDomainAuthorizedSSHKeysSet
    error: command '/var/lib/kolla/venv/bin/python3.6' failed with exit status 1

We need at least libvirt-python v6.10.0.
[SEP]
FILES CHANGED:
docker/masakari/masakari-monitors/Dockerfile.j2 (+1, -1)
",-3.539494,1.428584,2.655698,-0.925534,0.042298,-0.39739,-0.417876,0.408107,-0.493979,0.09543,-0.172851,-0.429611,0.027438,0.401323,0.262786
openstack/kolla-ansible,I2f88b8fc2c6924de9f6bc1840b183ee024c5c1e9,1,1,0.8704,2.7726,0.0,1,8.0,200,0,Bug Fix,0,0,0,54,0.021951,0.0,0,0.0,2,1,0,0.8054,0.0,2.0,-12.78,15.7,0,0,0.0,1,12.5,0,6,0,22,0,"Reno follow up for docker_disable_ip_forward

Follow up to I5129136c066489fdfaa4d93741c22e5010b7e89d, adding upgrade
notes.

Related-Bug: #1931615
[SEP]
FILES CHANGED:
releasenotes/notes/docker-disable-ip-forward-b0490b71f9f07cd6.yaml (+15, -0)
",0.646687,-0.36492,-1.892319,-1.950226,1.012427,0.606977,0.165584,-0.248439,0.544694,-0.21072,-0.333505,0.070555,-0.286646,-0.183501,0.175752
openstack/kolla-ansible,Ia95355c529f1b0222dc1de06632984b6d130b9ec,1,0,0.7966,1.6094,1.0,3,6.0,374,0,Doc,0,0,0,59,0.016508,1.0,0,0.7966,4,1,0,0.8067,1.5,4.0,24.5,11.29,1,0,0.0,0,74.8,0,0,0,0,0,"Drop /sys/fs/cgroup mounts

They are handled by Docker since at least 18.09 (tested).
Backport to Wallaby at most to not introduce needless restarts in
already stable branches.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/795037
(cherry picked from commit 286a03bad20955aa4d3f7009cef5856d328b76f1)
[SEP]
FILES CHANGED:
ansible/roles/multipathd/defaults/main.yml (+0, -1)
ansible/roles/nova-cell/defaults/main.yml (+0, -1)
ansible/roles/iscsi/defaults/main.yml (+0, -2)
",-0.553986,0.622418,-0.838156,-1.193243,-0.439608,-0.129555,1.215184,0.121554,0.005186,0.040853,0.053864,-0.326441,0.287864,-0.118909,-0.031432
openstack/ironic,Ib4ab755c806f028d97379b80a8c27d6ade63cba1,1,0,0,2.6391,0.2308,3,16.33,336,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,2,0,1.0,1.4196,4.0,55.59,13.88,1,0,0.3077,1,24.0,0,0,0,0,0,"Update the clear job id's constant

Fixes an issue of powering off with the ``idrac-wsman`` management
interface while the execution of a clear job queue cleaning step is
proceeding.
Prior to this fix, the clean step would fail when powering off a node.

Story: 2008988
Task: 42641
[SEP]
FILES CHANGED:
ironic/drivers/modules/drac/management.py (+1, -1)
ironic/tests/unit/drivers/modules/drac/test_management.py (+2, -2)
releasenotes/notes/update-clear-job-id-constant-fix-c69cf96c55364bb3.yaml (+7, -0)
",-0.164529,-1.528413,-0.362233,0.429713,-0.349436,0.472809,-0.16482,0.01042,0.688886,-0.038003,0.107307,0.412964,-0.077771,0.049027,0.227439
openstack/ironic,I5a176f51db93d2a2238496f6955c1c7d9a79c548,1,0,1.0,3.5553,0.8529,6,19.14,848,0,Bug Fix,0,0,0,6,0.02,0.0,0,0.0,6,1,0,1.0,2.2251,3.5,39.04,15.12,1,0,0.5882,0,24.2286,0,0,0,0,0,"Remove redundant/legacy is_admin logic

The original model used was to assert is_admin on the object context
which was actually used in only one place in ironic's code. Redudnantly
of course.

This is an excess call of is_admin on all API invocations, and is
simply not necessary as individual calls have API policy checking
and is_admin was only being consulted in the glance service utils...
However, the glance service utils also confirmed it should be able
to access glance if there was an auth_token present on the request
which should also always be the case. This was somewhat identified
as redundant/possible bug during the Wallaby cycle and appears to
be fine to remove

This does *not* remove the deprecated rule. At present, it appears
that rule may not be removed until after Xena.
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_context.py (+0, -5)
ironic/api/hooks.py (+0, -3)
ironic/common/context.py (+0, -4)
ironic/tests/unit/api/test_hooks.py (+4, -10)
ironic/common/glance_service/service_utils.py (+1, -6)
ironic/tests/unit/api/controllers/v1/test_node.py (+0, -1)
",-1.870835,-1.732556,1.813002,-0.105909,-0.556429,0.220142,0.362974,-0.61225,-0.182906,0.135751,0.470447,0.160109,-0.389974,-0.391114,0.147523
openstack/octavia,Ia15a110c6c5a9b83a29bab56538fa425d994d477,1,0,0.6667,3.5264,0.0,2,17.67,388,0,Feature,0,0,0,57,0.00598,0.0,0,0.0,6,2,0,0.5356,0.684,4.0,43.65,13.86,0,0,0.0,1,11.4118,0,0,0,0,0,"Disable conntrack for TCP flows in the amphora

conntrack is used in the amphora for LVS-based listeners (UDP and
SCTP) and it's enabled by default.
Add nft/iptable rules to disable conntrack for TCP flows, it reduces
memory usage and prevents getting ""nf_conntrack: table full, dropping
packet"" messages.

Story: 2008979
Task: 42623
[SEP]
FILES CHANGED:
elements/amphora-agent/static/usr/local/bin/lvs-masquerade.sh (+27, -0)
releasenotes/notes/disable-conntrack-for-tcp-01ef6948d99353c2.yaml (+6, -0)
",-0.33831,-0.684079,-0.285767,0.396191,0.163766,-0.186351,-0.023644,0.220957,-0.030065,-0.267565,0.272301,-0.227509,0.328222,-0.165414,0.050229
openstack/ironic,I9bfa5a54e02c8a1e9c8cad6b9acdbad6ab62bef3,1,0,1.0,5.2832,0.2959,4,23.2,863,0,Bug Fix,0,0,0,7,0.020958,1.0,0,1.0,6,2,0,1.0,1.4315,3.75,6.79,21.35,1,0,0.3827,1,4.3807,0,0,0,0,0,"Fix node detail instance_uuid request handling

The instance_uuid handling on the detailed node information
endpoint of the api (/v1/nodes/detail?instance_uuid=<uuid>),
which is used by services such as Nova for explicit node status
lookups, previously had special conditional logic surrounding it
which skipped the inclusion of the API requestor project-id, from
being incorporated into the database query.

Ultimately, this allowed an authenticated user to obtain a partially
redacted node entry where sensitive informational fields were scrubbed
from the response payload.

With this fix, queries for an explicit instance_uuid now follow the
standard path inside the Ironic API to the database which includes
inclusion of a requestor Project-ID if required by configured policy.

Story: 2008976
Task: 42620
[SEP]
FILES CHANGED:
releasenotes/notes/correct-detailed-instance-info-behavior-1375914a30621eca.yaml (+20, -0)
ironic/db/sqlalchemy/api.py (+1, -1)
ironic/tests/unit/api/controllers/v1/test_node.py (+75, -0)
ironic/api/controllers/v1/node.py (+42, -57)
",-1.79575,-1.48652,1.672551,0.135758,0.078308,-0.044712,-0.061169,0.285661,0.636614,-0.607998,-0.404141,0.116987,-0.011885,-0.016189,0.107594
openstack/kayobe,I0510db9fd1b8dd72540c83173267491b32728330,1,0,0.9565,3.1781,1.0,1,7.67,195,0,Feature,0,0,0,23,0.048523,1.0,1,0.9565,2,1,0,0.9259,0.0,2.0,37.21,16.98,1,0,0.0,0,8.125,0,0,0,0,0,"Remove outdated upgrade step

Migrating to Ironic hardware types was required in Rocky. This can now
be removed from upgrading instructions.
[SEP]
FILES CHANGED:
doc/source/upgrading.rst (+0, -23)
",1.048701,-1.074872,-0.046862,0.685514,-0.173055,1.152752,-0.303336,0.022685,-0.217225,0.480889,0.038336,0.627594,-0.525953,-0.07161,-0.248184
openstack/ironic-python-agent,Idfbce44065e1e5a8b730b94741b2604c51f0ab14,1,0,0.875,4.3307,0.12,3,10.11,625,0,Feature,0,0,0,8,0.014109,1.0,0,0.875,3,2,0,0.875,1.3532,2.0,52.47,11.08,1,0,0.5867,1,8.2237,0,0,0,0,0,"Coalesce heartbeats

The IPA sends heartbeats to the conductor periodically and when
requested, e.g. at the end of asynchronous commands. In order
to avoid to send such notifications in too quick succession,
e.g. when two asynchronous commands finish at the same time or
when the periodic heartbeat was just sent right before a command
ended, this patch proposes to coalesce heartbeats which are
close together timewise and send only one for all of them
in a time interval of 5 seconds.

Co-Authored-By: Arne Wiebalck <arne.wiebalck@cern.ch>

Story: #2008983
Task: 42633
[SEP]
FILES CHANGED:
ironic_python_agent/agent.py (+18, -3)
ironic_python_agent/tests/unit/test_agent.py (+38, -6)
releasenotes/notes/coalesce_heartbeats-fb8899a5f9fe4709.yaml (+10, -0)
",-2.125524,-0.660958,0.616202,0.09647,-0.247346,0.290218,-0.028696,-0.296517,0.124752,0.155249,0.422232,0.431597,-0.023423,0.240857,-0.104294
openstack/octavia,I64b5c70fca7f1cacb2ef10c2b61f28b9000c7504,0,0,0.6724,3.091,0.381,2,11.75,715,0,Bug Fix,0,0,0,58,0.006064,0.5,0,0.3362,4,1,0,0.5375,0.7919,3.0,29.31,14.91,0,0,0.7619,0,32.5,0,0,0,0,0,"Fix new errors with SQLAlchemy 1.4

Fixed in Repositories.get_amphora_stats:
  TypeError: unsupported operand type(s) for +:
  'ImmutableColumnCollection' and 'list'

Fixed in many places:
  KeyError: ""Deferred loader for attribute 'id' failed to populate
  correctly""

  Modifying an object without using a transaction created some issues
  with the next query. SQLAlchemy flushed and expired the modified
  object while it still needed to read one attribute. This is a weird
  behavior in SQLAlchemy>=1.4 (perhaps a bug), but using transactions
  seems the correct way to update the objects.

  Note: The message in the SQLAlchemy exception is totally bogus.
[SEP]
FILES CHANGED:
octavia/db/repositories.py (+3, -2)
octavia/tests/functional/db/test_models.py (+10, -6)
",-1.22328,-1.04544,1.742827,-0.223792,-0.473674,0.192066,0.278277,0.035652,0.201809,0.288194,0.233775,-0.329394,0.053379,0.016809,0.136034
openstack/kolla-ansible,Idc3e39716bcb0dccadbd0f72c2a354616b1acb38,1,0,0.8,2.3026,0.0,2,7.0,81,0,CI,1,0,0,60,0.016769,0.6667,0,0.5333,1,1,0,0.8079,0.5033,1.0,6.36,19.94,1,1,1.0,1,8.1,1,0,0,0,0,"[CI] Test Ironic on Debian
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+1, -0)
zuul.d/jobs.yaml (+8, -0)
",1.470833,4.657821,0.503845,1.393275,0.701508,1.88532,-0.357849,-0.295104,-0.749711,0.925214,0.963036,-0.033173,1.099522,-0.243899,-1.457031
openstack/kolla-ansible,Ic0c4beae0c812f3ca68a6ee5cc4daa2fee0f277d,1,1,0.8033,2.1972,0.125,2,18.67,353,0,Bug Fix,0,0,0,61,0.017006,0.0,0,0.0,4,2,0,0.8092,0.8113,3.0,50.41,13.18,1,0,0.0,1,39.2222,1,6,0,16,0,"Do not set pid file for iscsid

Kolla Ansible runs iscsid in the foreground (-f) and
a recent change to iscsid in CentOS 8 (both Linux and Stream)
caused it to reject setting pid file in such a case.
PID file is irrelevant in this scenario so this commit
removes its parameter.

Closes-Bug: #1933033
[SEP]
FILES CHANGED:
ansible/roles/iscsi/templates/iscsid.json.j2 (+1, -1)
releasenotes/notes/bug-1933033-76746d127285cfe8.yaml (+6, -0)
",-0.283057,-1.268659,-0.160234,0.084481,-0.244035,0.14568,0.015471,-0.144993,-0.246792,0.104499,0.302298,-0.092544,0.263462,0.084852,0.204917
openstack/kolla,I199185e24cedd2e282c53460a24aeffc83478a12,1,1,0.5714,2.3026,0.1111,2,5.44,506,0,Bug Fix,0,0,0,7,0.025926,0.0,0,0.0,3,2,0,0.7864,0.9911,2.5,11.39,13.61,1,0,0.0,1,50.6,0,16,0,18,0,"Add boto3 as s3 dependency for Glance container

boto3 library is needed [1] for glance_store and didn't installed yet
since [2] adds s3 support back. this change adds both binary and source
parts to install boto3 library.

1. https://github.com/openstack/glance_store/blob/04e5ead7c000211a4c10104ed2bb65c9df7681ae/setup.cfg#L76
2. I203134837319080ead96da69048baf90086d2117

Closes-Bug: #1884259
[SEP]
FILES CHANGED:
docker/glance/glance-base/Dockerfile.j2 (+3, -1)
releasenotes/notes/bug-1884259-23bdaa6c1c038a81.yaml (+5, -0)
",-1.984756,0.761563,-0.64859,-1.134734,0.55582,-0.283637,0.811875,0.494324,-0.00777,0.52157,0.105755,-0.369337,0.130556,0.022524,0.128688
openstack/kolla-ansible,Ib40aafaa9ca360d57e87ffdd81dbc15e603fef99,1,0,0.625,1.0986,0.5,1,5.75,485,0,Bug Fix,0,0,0,8,0.028674,1.0,0,0.625,4,1,0,0.8105,0.0,4.0,-16.02,12.73,1,0,0.0,0,161.6667,0,0,0,0,0,"Blazar: Fix support for external keystone in multiregion deploy

We need to correctly set keystone auth api for all cases.
By default [1] the keystone_internal_fqdn is equal to the
kolla_internal_fqdn, but in multiregion deploy it can be overriden.

1. https://github.com/openstack/kolla-ansible/blob/3a7440b370f5c2bf6f255a6530349a3e680007b9/ansible/group_vars/all.yml#L834
[SEP]
FILES CHANGED:
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -1)
",-2.19653,1.400394,-0.562183,-0.40434,0.472216,-0.434211,1.13673,0.244211,0.240715,0.104579,0.261425,-0.345956,-0.338884,-0.314852,-0.034709
openstack/kolla-ansible,Idd975f5f1dd7fb95fe921f660e8ef32a570932f3,0,1,0.5455,7.6275,0.4769,33,9.75,298,0,Bug Fix,0,0,0,11,0.013189,1.0,0,0.5455,4,3,0,0.8117,3.6332,3.91,51.6,12.11,1,0,0.0,1,0.1451,0,12,0,16,0,"Modernize the swift role

Swift role is still using the old format today. and the code
refactoring was delayed for several cycles.
This commit restructures the swift role and keeps the previous logic.

Closes-Bug: #1842637
Closes-Bug: #1941611
[SEP]
FILES CHANGED:
ansible/roles/swift/tasks/deploy-containers.yml (+1, -1)
ansible/roles/swift/templates/swift-account-replication-server.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-container-updater.json.j2 (+5, -6)
ansible/roles/swift/tasks/rolling_upgrade.yml (+22, -58)
ansible/roles/swift/templates/swift-container-server.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-proxy-server.json.j2 (+5, -6)
ansible/roles/swift/tasks/deploy.yml (+8, -4)
ansible/roles/swift/tasks/pull.yml (+2, -73)
ansible/roles/swift/tasks/reconfigure.yml (+1, -104)
ansible/roles/swift/templates/swift-container-replication-server.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-container-auditor.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-object-server.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-object-updater.json.j2 (+5, -6)
ansible/roles/swift/tasks/start.yml (+0, -315)
ansible/roles/swift/templates/swift-account-auditor.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-object-expirer.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-object-replication-server.json.j2 (+5, -6)
releasenotes/notes/modernize-the-swift-role-d9db5f0f44270742.yaml (+18, -0)
ansible/roles/swift/tasks/check-containers.yml (+19, -0)
ansible/roles/swift/defaults/main.yml (+435, -6)
ansible/roles/swift/tasks/config-disk.yml (+25, -0)
ansible/roles/swift/templates/swift-container-replicator.json.j2 (+5, -6)
ansible/roles/swift/templates/swift-object-auditor.json.j2 (+5, -6)
ansible/roles/swift/tasks/config.yml (+143, -133)
ansible/roles/swift/handlers/main.yml (+292, -2)
ansible/roles/swift/templates/swift-account-replicator.json.j2 (+5, -6)
roles/openstack-clients/defaults/main.yml (+4, -0)
ansible/roles/swift/templates/swift-object-replicator.json.j2 (+5, -6)
ansible/roles/swift/tasks/legacy_upgrade.yml (+6, -31)
ansible/roles/swift/templates/swift-account-server.json.j2 (+5, -6)
ansible/roles/swift/tasks/clone.yml (+8, -0)
ansible/roles/swift/tasks/stop.yml (+5, -150)
ansible/roles/swift/templates/swift-account-reaper.json.j2 (+5, -6)
",-0.16434,-1.030441,-0.697664,0.152766,-0.671281,0.790268,-0.372457,0.131326,0.127014,0.055817,0.480409,0.085312,-0.021973,0.023987,0.355963
openstack/ironic,I25c28df048c706f0c5b013b4d252f09d5a7e57bd,1,0,0.8889,3.7377,0.7561,3,17.43,811,0,Bug Fix,0,0,0,9,0.014019,1.0,0,0.8889,5,1,0,1.0,1.5433,3.67,45.6,12.87,1,0,0.439,0,19.3095,0,0,0,0,0,"Fix ramdisk boot option handling

The current ramdisk deploy code expects a user to set the boot_option
capability to ""ramdisk"". Not only is it redundant, it's also not
documented, so chances are high nobody has ever done that.

As a side effect of e6bb99cd8ff94a24c3f2108e649c7ca39189d220 boot
interfaces no longer validate kernel/ramdisk/image if boot option
is ""local"". Unless a user explicitly sets boot option to ""ramdisk"",
the validation will be skipped for the ramdisk deploy.

This patch follows the pattern of the anaconda deploy and makes
get_boot_option always return ""ramdisk"" for the ramdisk deploy.

In the future we need to refactor this code so that the deploy interface
provides the boot option it works with, but that is a lot of changes.
[SEP]
FILES CHANGED:
ironic/drivers/modules/deploy_utils.py (+10, -0)
ironic/drivers/modules/pxe.py (+0, -13)
ironic/tests/unit/drivers/modules/test_pxe.py (+0, -18)
",-2.503922,-0.543863,1.450148,-0.345784,0.347019,0.077217,0.484967,-0.40116,0.196322,0.101856,0.09902,0.120002,-0.206915,-0.190962,0.150184
openstack/kolla-ansible,Ifefb9c74ee6a80cdbc458992d0196850ddfe7ffa,1,1,1.0,1.9459,0.0,2,18.33,407,0,Bug Fix,0,0,0,6,0.060606,0.0,0,0.0,4,2,0,0.8065,0.65,3.0,31.33,18.24,1,0,0.0,1,58.1429,0,6,0,13,0,"Do not run timesync checks on deployment host

Kolla-ansible install python docker library in role/baremetal
to group/baremetal, because of this get container facts
for timesync checks is failing on deployment host.

This patch adding when conditional, so deployment host
will be skipped as there is no need to run timesync
checks.

Closes-Bug: #1933347
[SEP]
FILES CHANGED:
ansible/roles/prechecks/tasks/main.yml (+1, -0)
releasenotes/notes/bug-1933347-4031d94ef7decb3c.yaml (+5, -0)
",-0.761934,-1.371225,-0.055468,-1.024856,0.25939,-0.470945,0.499015,0.087221,-0.139008,-0.187023,0.36276,-0.235214,0.338224,0.135415,0.017
openstack/kolla-ansible,Ifefb9c74ee6a80cdbc458992d0196850ddfe7ffa,1,1,1.0,1.9459,0.0,2,20.0,476,0,Bug Fix,0,0,0,7,0.066667,1.0,0,1.0,4,2,0,0.8077,0.65,3.0,27.21,18.67,1,0,0.0,1,68.0,0,6,0,13,0,"Do not run timesync checks on deployment host

Kolla-ansible install python docker library in role/baremetal
to group/baremetal, because of this get container facts
for timesync checks is failing on deployment host.

This patch adding when conditional, so deployment host
will be skipped as there is no need to run timesync
checks.

Closes-Bug: #1933347
(cherry picked from commit 281c9935da076eb7a744136e3738084468692278)
[SEP]
FILES CHANGED:
ansible/roles/prechecks/tasks/main.yml (+1, -0)
releasenotes/notes/bug-1933347-4031d94ef7decb3c.yaml (+5, -0)
",-0.761934,-1.371225,-0.055468,-1.024856,0.25939,-0.470945,0.499015,0.087221,-0.139008,-0.187023,0.36276,-0.235214,0.338224,0.135415,0.017
openstack/ironic,Ie000463fa8ac2cd739a9d8f256346472fe3f4288,1,0,0.9,3.6109,0.0833,3,12.0,206,0,Bug Fix,0,0,0,10,0.014641,1.0,0,0.9,5,2,0,1.0,1.2997,3.33,7.83,14.8,1,0,0.6111,1,5.5676,0,0,0,0,0,"Fix handling driver_info[agent_verify_ca] == False

Because of using 'or', it will only be respected when verify_ca
is also False in the configuration.
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent_client.py (+7, -3)
releasenotes/notes/verify-bool-ab3607429e005bed.yaml (+4, -0)
ironic/tests/unit/drivers/modules/test_agent_client.py (+22, -0)
",0.079929,0.002235,-1.022871,0.937655,0.297093,0.671622,-0.982068,-1.111975,0.11443,0.245117,0.144234,-0.429496,-0.74143,-0.224801,-0.530345
openstack/octavia,I15997acaf12258ec483286dad676efdea8963611,1,0,0.661,2.7081,0.0714,3,12.33,306,0,Bug Fix,0,0,0,59,0.006155,1.0,0,0.661,6,3,0,0.5353,1.3788,4.33,2.25,18.99,0,0,0.0,1,20.4,0,0,0,0,0,"Enable lo interface in the amphora-haproxy netns

Configure the lo interface in the amphora-haproxy namespace.
It fixes issues with the synchronization of haproxy peer/stick tables
when updating a load balancer configuration.

Story 2009005
Task 42682
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/amphora-netns.systemd.j2 (+4, -0)
octavia/amphorae/backends/agent/api_server/osutils.py (+1, -1)
releasenotes/notes/fix-lo-interface-amphora-netns-90fb9934026e1485.yaml (+8, -0)
",-0.287194,-1.822954,-0.301895,0.131203,0.137964,-0.426447,-0.70171,0.615951,0.102431,-0.439059,-0.252056,0.236258,-0.099589,-0.026004,-0.068253
openstack/kolla,I822d640a251e6ed9f71c76a922513e23e4218418,1,1,1.0,2.0794,0.1429,2,6.82,694,0,Bug Fix,0,0,0,8,0.072072,0.6667,0,0.6667,2,2,0,0.7885,0.8631,2.0,-13.28,14.46,1,0,0.0,1,86.75,1,6,0,7,0,"Add missing default policy files for debian-binary-horizon

The debian-binary-horizon image is missing the default policies files
which should be in /etc/openstack-dashboard/default_policies. By copying
everything from /etc/openstack-dashboard/policy
into /etc/openstack-dashboard, we get the default policy files, as well
as commented out policy files (e.g. cinder_policy.yaml) and the
nova_policy.d directory containing api-extensions.yaml.

Change was merged for ubuntu in [1] but unfortunatelly
not for debian, this trivial patch fixes it also
for debian.

[1] https://review.opendev.org/c/openstack/kolla/+/794589

Closes-Bug: #1933759
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+1, -1)
releasenotes/notes/bug-1933759-c03e50c243850a49.yaml (+5, -0)
",-2.741005,1.137542,1.052724,-0.14835,-0.249691,-0.558284,0.037885,0.262827,-0.31678,-0.178487,-0.188738,-0.165721,-0.097563,0.209381,0.118002
openstack/kolla,Ie276b7877ca2edd31dd7a107d70b75ae1735f744,1,1,1.0,2.1972,0.125,2,10.5,328,0,Bug Fix,0,0,0,9,0.076271,0.4444,0,0.4444,2,2,0,0.7905,0.8113,2.0,33.02,15.63,1,0,0.0,1,36.4444,1,6,0,7,0,"Fix build of debian images

Kolla expects different PRETTY_NAME var as
debian defined in /etc/os-release. Therefore
bullseye debian images build is failing.
This patch is changing what kolla expects in
PRETTY_NAME var and fixing build of debian images.

Closes-Bug: #1933770
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1933770-c08c6804aa5d9e61.yaml (+6, -0)
kolla/common/config.py (+1, -1)
",-0.88974,-0.62482,-0.453633,0.237407,0.282532,0.214647,-0.676889,0.065146,-0.36446,-0.214503,0.157341,-0.375831,0.266376,0.10065,0.139414
openstack/ironic-python-agent,Ibd3060bef2e56468ada6b1a5c1cc1632a42803c3,1,0,1.0,5.0938,0.0556,2,20.2,646,0,CI,0,0,0,8,0.015094,1.0,0,1.0,4,1,0,0.8889,0.8161,3.0,40.59,16.79,0,0,0.7469,0,3.9632,0,0,0,0,0,"Catch ismount not being handled

While investigating another grub issue, I was confused by the path
taken in the logs reported, and noticed that on a ramdisk, we might
not actually have a valid response to os.path.ismount, I'm guessing
depending on what in memory filesystem is in use while also coupled
with attempting to check a filesystem.

Adds a test to validate that exceptions raised on these commands
where this issue can be encountered, are properly bypassed, and also
adds additional logging to make it easier to figure out what is
going on in the entire bootloader setup sequence.
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+121, -0)
ironic_python_agent/extensions/image.py (+32, -9)
",-1.086247,-2.536505,1.015899,0.061898,-0.594146,-0.231613,0.30623,-0.837576,-0.178699,0.289895,0.035468,-0.033368,-0.057759,0.006554,0.219811
openstack/octavia,Ia815461a15bff065fd63e9ce80636e2b736bebdf,0,0,0.1667,3.2958,0.5,1,3.86,292,0,Doc,0,0,0,6,0.066667,0.4375,0,0.0729,0,1,0,0.5372,0.0,0.0,5.52,10.43,1,0,0.0,1,10.8148,0,0,0,0,0,"Changed minversion in tox to 3.18.0

The patch bumps min version of tox to 3.18.0 in order to
replace tox's whitelist_externals by allowlist_externals option:
https://github.com/tox-dev/tox/blob/master/docs/changelog.rst#v3180-2020-07-23
[SEP]
FILES CHANGED:
tox.ini (+13, -13)
",-1.877484,3.055821,-1.292178,0.978966,0.070688,-0.260951,0.110035,-0.040774,-0.280312,0.767144,-0.438822,-0.604713,0.03927,0.428285,0.451686
openstack/octavia,I4651f8bdaca13486a1dc6408f445d41779a95653,0,0,0.6667,3.4965,0.4688,9,10.67,316,0,Bug Fix,0,0,0,60,0.00625,0.6667,0,0.4444,5,2,0,0.535,3.0026,3.44,-28.71,18.02,0,0,0.0,0,9.5758,0,0,0,0,0,"Fix new pylint issues

new pylint 2.9.0 provides some new checkers and detects new errors with
existing checkers:
- consider-using-enumerate (disabled)
- consider-using-from-import
- arguments-renamed (disabled)
- consider-using-with
- consider-using-dict-items
[SEP]
FILES CHANGED:
octavia/common/data_models.py (+1, -2)
octavia/api/v2/controllers/load_balancer.py (+1, -1)
octavia/controller/worker/v1/tasks/database_tasks.py (+1, -1)
.pylintrc (+3, -1)
octavia/controller/worker/v2/tasks/database_tasks.py (+1, -1)
octavia/api/v2/controllers/member.py (+1, -1)
octavia/amphorae/drivers/health/heartbeat_udp.py (+3, -4)
octavia/api/v2/controllers/listener.py (+2, -2)
octavia/certificates/generator/local.py (+4, -2)
",-1.281191,0.628951,-0.714657,0.405594,0.69585,-0.916475,-1.385527,-0.593872,-0.310226,0.411913,-0.680902,0.403751,0.862583,0.538896,0.292344
openstack/kolla-ansible,I6aa8db2214e07906f1f3e035411fc80ba911a274,1,1,0.8727,3.4657,0.2581,3,7.8,838,0,Bug Fix,0,0,0,55,0.022222,0.7,0,0.6109,4,3,0,0.8089,1.2734,2.67,47.07,9.96,0,0,0.0,1,26.1875,0,6,0,13,0,"nova: Use cinder user for Ceph

In Ussuri, nova stopped using separate Ceph keys for the volumes and vms
pools by default. Instead, we set ceph_nova_keyring to the value of
ceph_cinder_keyring by default, which is ceph.client.cinder.keyring.
This is in line with the Ceph OpenStack integration guide [1]. However,
the user used by nova to access the vms pool (ceph_nova_user) defaults
to nova, meaning that nova will still try to use a
ceph.client.nova.keyring, which probably does not exist. We did not see
this issue in CI, because we set ceph_nova_user to cinder.

This change fixes the issue by setting ceph_nova_user to the value of
ceph_cinder_user by default, which is cinder.

Closes-Bug: #1934145
Related-Bug: #1928690

[1] https://docs.ceph.com/en/latest/rbd/rbd-openstack/
[SEP]
FILES CHANGED:
doc/source/reference/storage/external-ceph-guide.rst (+6, -7)
releasenotes/notes/nova-ceph-user-53670f9ccc546225.yaml (+16, -0)
ansible/group_vars/all.yml (+1, -1)
",-3.712043,1.402177,2.069891,0.138109,0.183465,0.168852,-0.118771,0.025783,-0.07506,-0.336932,0.433209,0.098299,-0.454603,-0.06554,-0.13033
openstack/magnum,I55042665c25704cd65eb4e4883f8a796bdcdaa7f,1,0,0.8333,2.0794,0.0,1,7.67,570,0,Feature,0,0,0,6,0.053097,0.0,0,0.0,6,1,0,0.8182,0.0,6.0,-43.71,14.37,1,0,0.0,0,71.25,0,0,0,0,0,"Add cloud-provider flag to openstack cloud control manager

Recent OpenStack Cloud Control Manager (occm) fails without
cloud-provider flag, starting v1.21.0 onwards --cloud-provider cannot be
empty Error: --cloud-provider cannot be empty

Additionally, add create role for serviceaccounts/token resource [1].

[1] https://github.com/kubernetes/cloud-provider-openstack/blob/7d844dac9d4bbfd5eee919ce84e1534b5476ee73/manifests/controller-manager/cloud-controller-manager-roles.yaml#L52-L57

Story: 2009023
Task: 42745
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/kube-apiserver-to-kubelet-role.sh (+7, -0)
",-2.727859,2.322808,-0.159006,-0.221256,0.651988,-0.379526,0.276229,0.468239,0.23453,-0.025309,0.176426,0.112963,0.238538,0.113116,-0.177972
openstack/kolla-ansible,I644ad475ca88aac0c22b14163d33a30193fe706a,1,1,0.8065,2.8904,0.0,2,10.0,116,0,Bug Fix,0,0,0,62,0.017246,0.0,0,0.0,4,2,0,0.8101,0.9367,3.0,-31.73,24.0,1,0,0.0,1,6.4444,0,6,0,8,0,"Fix Masakari host monitor default config

Closes-Bug: #1933209
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1933209-73e78353cb5c3266.yaml (+11, -0)
ansible/roles/masakari/templates/masakari-monitors.conf.j2 (+6, -0)
",2.332566,-0.193001,0.235687,-1.438548,-0.610027,0.734787,-1.015036,0.734261,0.106649,-0.250265,0.368813,-0.164416,0.082121,-0.374234,0.216183
openstack/kolla-ansible,Ifa1bcf80a5d2256c1b07b921aa53bd238157d186,0,1,0.8095,2.3979,0.1,2,11.0,115,0,Bug Fix,0,0,0,63,0.017442,0.0,0,0.0,4,2,0,0.8113,0.7219,3.0,34.16,15.31,1,0,0.0,1,10.4545,0,6,0,11,0,"Fix Cinder Glance backend when no iSCSI

Closes-Bug: #1928669
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1928669-3aa3b7a60741a4b1.yaml (+8, -0)
ansible/roles/glance/defaults/main.yml (+1, -1)
",2.424436,-0.398756,0.179827,-1.203696,-0.555264,0.587788,-0.844352,0.861932,-0.094122,-0.327441,0.283384,-0.190896,0.148256,-0.476994,0.32335
openstack/ironic,I4a169b42d516a7ae2adcee9b69d71723fdefcd95,1,0,0,2.4849,0.0,2,8.75,600,0,Doc,0,0,0,0,0.0,0.0,0,0.0,3,1,0,1.0,0.9457,2.5,9.42,12.64,1,0,0.3636,0,50.0,0,0,0,0,0,"Suppress policy deprecation and default change warnings

As part of the policy defaults refresh work, all of the defaults for
policies were changed and warnings about it are being emitted
constantly in the logs. We can suppress these for now until we are
enforcing new defaults [1].

This also suppresses policy deprecation warnings during tests to avoid
filling the console with warning messages.

Related to blueprint policy-defaults-refresh

[1]https://docs.openstack.org/nova/latest/configuration/config.html#oslo_policy.enforce_new_defaults
[SEP]
FILES CHANGED:
ironic/tests/unit/policy_fixture.py (+4, -0)
ironic/common/policy.py (+7, -0)
",-1.708615,0.06702,0.662757,0.510904,-0.271039,-0.203243,0.01079,-0.050024,0.296234,0.087865,-0.209892,-0.094435,-0.082304,-0.134334,-0.110672
openstack/octavia,Ifa8c620fe76517b1c040af5905e6a6c1cdb4c922,0,0,0.0,3.1355,0.5,3,5.6,487,0,Bug Fix,0,0,1,1,0.25,0.1765,0,0.0,2,2,0,0.5328,0.8659,0.67,7.78,11.53,1,0,0.0,0,21.1739,1,0,0,0,0,"Fix oslo policy DeprecatedRule warnings

Since 3.7.0, oslo policy started the DeprecationWarning[1] if
deprecated_reason and deprecated_since param are not passed
in DeprecatedRule or they are passed in RuleDefault object.

These warnings are logged for every test which increase the
log size and sometime can full the log buffer and fail the
job.

[1] https://github.com/openstack/oslo.policy/blob/3.7.0/oslo_policy/policy.py#L1538
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
lower-constraints.txt (+1, -1)
octavia/policies/base.py (+9, -9)
",-1.009555,1.153975,0.108832,0.48691,-0.51315,-0.071327,0.426265,0.109998,0.256669,0.313917,0.271939,-0.411792,-0.284164,0.01858,-0.153369
openstack/magnum,I4e8029a4cd5e89d7173758fa1dc2e718895fdbe7,1,0,0,0.6931,1.0,1,4.33,266,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.8333,0.0,6.0,67.94,5.84,1,0,0.0,0,133.0,1,0,0,0,0,"Fix CoreDNS 1.7.0 and above

Starting from CoreDNS 1.7.0 the upstream option is not valid anymore
and CoreDNS does not start when it is set. It has been effectively a
noop since 1.5.2.

Task: 42765
Story: 2009030
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/core-dns-service.sh (+0, -1)
",-0.064936,-0.640212,-0.292898,0.050941,-0.774252,0.717837,-0.512211,0.145747,-0.425161,1.06682,-0.014078,0.086461,-0.309948,0.377425,0.448858
openstack/ironic,I5da43dc244c1a4fa828a00c02e3aa5b5f1b71e14,1,0,0,4.6728,0.4057,2,16.67,751,0,CI,0,0,0,0,0.0,1.0,0,0.0,5,1,0,1.0,0.4508,4.0,17.33,15.07,1,0,0.9057,0,7.0187,0,0,0,0,0,"Defer checking image size until instance info is built

The image size check is skipped if the image is raw and will be
streamed directly to disk. However metalsmith does not expose
instance_info so it is not possible to set image_disk_format=raw.

image_disk_format is detected and set during
build_instance_info_for_deploy but this is run *after* the call to
check_image_size. This results in large raw whole-disk images always
failing check_image_size when deployed by metalsmith (or any time
image_disk_format isn't explicitly set).

This change avoids that by moving the check_image_size call out of
validate to after the call to build_instance_info_for_deploy.

Blueprint: whole-disk-default
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent.py (+4, -6)
ironic/tests/unit/drivers/modules/test_agent.py (+59, -37)
",-2.691881,0.394167,1.20938,0.742131,0.60709,0.222131,-0.078637,-0.481314,0.207235,-0.450674,0.495781,-0.259156,-0.352561,-0.031659,0.265722
openstack/kolla-ansible,Ie5d82a2e4575bd74674ac38a042df49cfe7f74c9,1,1,0.6667,2.7081,0.4286,4,5.61,863,0,Bug Fix,0,0,0,9,0.032028,0.0,0,0.0,4,2,0,0.8063,1.9502,4.0,21.05,13.33,1,0,0.0,0,57.5333,0,8,0,14,0,"Fix usage of Subject Alternative Name for TLS

All TLS certificates are incorrectly generated in the 'certificates'
role. The generated certificates don't contain both the 'X509v3
extensions' and 'X509v3 Subject Alternative Name' blocks at all.

This change fixes the 'openssl x509' commands used to generate all the
certificates to include the 'Subject Alternative Name'.

Also, this change fixes both internal and external templates to
constantly use alternative names as described in the RFCs [1] [2].
We use DNS Name in SAN extension only when 'kolla_internal_fqdn' or
'kolla_external_fqdn' is set.

1. https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.6
2. https://datatracker.ietf.org/doc/html/rfc6125#appendix-B.2

Closes-Bug: #1935978
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/generate-backend.yml (+2, -0)
ansible/roles/certificates/tasks/generate.yml (+4, -0)
ansible/roles/certificates/templates/openssl-kolla-internal.cnf.j2 (+1, -3)
ansible/roles/certificates/templates/openssl-kolla.cnf.j2 (+1, -3)
",-3.254815,1.610707,1.925225,0.045317,0.011331,0.257171,-0.111984,0.293423,0.354171,0.224214,-0.153096,-0.172774,-0.282165,-0.036451,-0.171863
openstack/kayobe,Iea1daff70fca5cf49f4e7f44af71a900678bb5c9,1,0,0,4.3944,0.0375,10,11.0,181,0,Feature,0,0,0,0,0.0,1.0,0,0.0,4,6,0,0.9273,3.1429,3.0,38.01,11.67,1,0,0.0375,1,2.2346,0,0,0,0,0,"Add support for apt proxy setting

Add support for configuring apt's proxy setting on Ubuntu hosts.

Story: 2009035
Task: 42782
[SEP]
FILES CHANGED:
ansible/roles/apt/tasks/main.yml (+17, -0)
etc/kayobe/apt.yml (+6, -0)
kayobe/tests/unit/cli/test_commands.py (+3, -0)
ansible/group_vars/all/apt (+6, -0)
ansible/apt.yml (+12, -0)
ansible/roles/apt/defaults/main.yml (+12, -0)
kayobe/cli/commands.py (+3, -3)
releasenotes/notes/add-apt-proxy-support-f688702868095ed0.yaml (+6, -0)
doc/source/configuration/reference/hosts.rst (+4, -0)
ansible/roles/apt/templates/01proxy.j2 (+8, -0)
",0.521216,-0.755161,-0.618746,0.163342,-0.091802,0.60614,-1.015295,0.086004,0.210055,0.007415,-0.178273,0.139946,0.506402,0.254565,-0.135352
openstack/kolla-ansible,Ia85ef26015ff341bff1414da039bed52f34e7cc0,1,0,1.0,1.6094,0.0,1,20.0,270,0,Bug Fix,0,0,0,8,0.041237,0.0,0,0.0,4,1,0,0.8075,0.0,4.0,49.06,15.0,0,0,0.0,0,54.0,0,0,0,0,0,"Fix config action when OVN is enabled

Prior to this change, if you generated the config before deploying any
of the OVN services, it would fail on these tasks as the services will
not have been started.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/ovn/handlers/main.yml (+4, -0)
",0.900652,-1.839705,-0.048276,0.653778,-0.667858,0.34988,0.258995,-0.294774,-0.17209,0.034039,0.070454,0.321825,-0.137073,0.088507,-0.077244
openstack/kayobe,I20465eab4e0aec6620578a92d3bdbddcec0954df,1,0,0.9583,3.091,0.1429,4,9.8,762,0,CI,0,0,0,24,0.04829,1.0,0,0.9583,4,4,0,0.9286,1.6153,2.75,23.37,14.94,1,0,0.0,1,34.6364,0,0,0,0,0,"Enable consistent network device naming

CentOS cloud images come with net.ifnames=0 on the kernel command line,
which disables consistent network device naming. This does not provide a
good experience on bare metal because NIC ordering can vary. This is
specific to cloud images: an ISO installation would use consistent
network device naming.

We now set net.ifnames=1 in the DIB default environment to use
consistent network device naming. The parameters `nofb nomodeset
gfxpayload=text` are also set to preserve defaults from DIB.

To restore the existing behaviour, set DIB_BOOTLOADER_DEFAULT_CMDLINE to
`nofb nomodeset gfxpayload=text net.ifnames=0` in the
kolla_bifrost_dib_env_vars_extra dictionary.
[SEP]
FILES CHANGED:
etc/kayobe/bifrost.yml (+4, -2)
releasenotes/notes/dib-consistent-network-device-naming-e0edec5d5fdf83e2.yaml (+11, -0)
doc/source/configuration/reference/bifrost.rst (+2, -1)
ansible/group_vars/all/bifrost (+1, -0)
",-2.375068,-0.455642,1.976894,-0.023335,0.602918,-0.100579,-0.136924,0.346915,0.185023,-0.459412,0.061192,-0.034279,-0.47717,-0.382357,-0.163614
openstack/octavia-dashboard,Idec2c182b2758a148ae9d0efa251510d5e7985a3,0,0,0.4804,3.9318,0.44,6,15.5,485,0,Feature,0,0,0,102,0.004075,0.3,0,0.1441,6,3,0,0.25,2.2579,4.5,5.53,21.04,0,0,0.0,1,9.5098,0,0,0,0,0,"Change the Octavia Barbican namespace

The octavia dashboard has a built-in barbican rest API client used
to access barbican for certificate selection during load blanancer
creation.
Unfortunately, this client used the ""barbican"" namespace, which is
now used by the barbican-ui dashboard.

This patch renames the octavia client namespace to be octavia-barbican
to eliminate any namespace collisions with the barbican-ui dashboard.
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.spec.js (+1, -1)
releasenotes/notes/Fix-namespace-collision-with-barbican-ui-267f4ba074729ea6.yaml (+4, -0)
octavia_dashboard/api/rest/barbican.py (+2, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/model.service.js (+5, -5)
octavia_dashboard/static/app/core/openstack-service-api/octavia-barbican.service.js (+9, -9)
octavia_dashboard/static/app/core/openstack-service-api/octavia-barbican.service.spec.js (+7, -5)
",-1.436756,-0.724056,-0.42497,1.055163,0.28383,-0.382616,0.349871,0.46464,0.002556,-0.097648,0.533377,0.673541,0.06176,0.016074,0.037924
openstack/magnum,I2f9651421370ba44e2f0ddc7bb6526745b62ad40,1,0,1.0,2.5649,0.6667,2,14.5,213,0,Bug Fix,0,0,0,1,0.333333,1.0,0,1.0,6,1,0,0.8462,1.0,6.0,60.84,12.7,1,0,0.0,0,16.3846,0,0,0,0,0,"Fix kubelet on FCOS 34

Fedora CoreOS 34 has switched from cgroups v1 to
cgroups v2 by default, which changes the sysfs hierarchy.

Task: 42809
Story: 2009045
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/configure-kubernetes-minion.sh (+2, -4)
magnum/drivers/common/templates/kubernetes/fragments/configure-kubernetes-master.sh (+2, -4)
",0.072069,-1.082248,-0.532576,-0.357719,-0.237028,0.274143,-0.874089,0.505204,-0.45708,-0.045079,0.004047,-0.077469,-0.257566,0.270072,-0.030462
openstack/ironic-python-agent,I6edafe8edeb8549f324959e7a1ec175c3049a515,1,0,1.0,4.1897,0.7077,4,14.8,473,0,Feature,0,0,0,2,0.007194,1.0,0,1.0,4,2,0,0.9,1.7219,2.5,53.48,10.24,1,0,0.6,1,7.1667,0,0,0,0,0,"Force immediate NTP time sync with chronyd at IPA startup

In order to make sure we have the correct time early, e.g.
by the time we create a TLS certificate, this patch proposes
to force an immediate NTP update when using chronyd. While
the previous approach uses the passed NTP server as well, the
update may happen only after chronyd has performed measurements
(which may be too late).

Story: #2009058
Task: #42843
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_standby.py (+4, -4)
ironic_python_agent/tests/unit/test_utils.py (+4, -27)
ironic_python_agent/utils.py (+5, -15)
releasenotes/notes/fix_chronyd_time_sync-626a14b66ca37677.yaml (+6, -0)
",-0.405779,-1.659238,0.193372,0.591556,-0.335478,0.178488,0.345274,0.022294,0.114301,0.415568,0.236472,0.066357,-0.01589,0.137336,0.198178
openstack/kolla-ansible,Ib9a5058d6290d805670001ac2b5a42630aeec2b2,1,0,0.96,1.6094,0.5,1,5.0,111,0,Bug Fix,0,0,0,25,0.048263,0.0,0,0.0,2,1,0,0.8086,0.0,2.0,7.18,18.0,1,0,0.0,1,22.2,0,0,0,0,0,"Fix typos in release note

Backports: Wallaby, Victoria.
[SEP]
FILES CHANGED:
releasenotes/notes/change-default-migration-interface-3cdf30eed98553fd.yaml (+2, -2)
",2.527604,-0.001545,-0.225387,-0.498896,-0.494296,0.742289,-0.873045,0.263829,-0.320137,-0.17913,0.292011,0.172722,0.132867,0.419965,-0.816302
openstack/kolla,I582020488b3e69a554988b58ab6d92426911a1c2,0,0,0,0.6931,0.0,1,22.0,157,0,CI,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0.7925,0.0,3.0,49.91,14.25,0,0,0.0,0,78.5,0,0,0,0,0,"Get pip freeze

I'm new to kolla project, and this patch only check the CI output

It will be abadoned
[SEP]
FILES CHANGED:
docker/barbican/barbican-base/Dockerfile.j2 (+1, -0)
",2.119138,-2.146031,0.049125,-0.832285,-1.02207,0.416143,0.208309,-0.594834,-1.206512,-0.473227,0.177708,0.177172,-0.471087,0.700861,-0.356437
openstack/kayobe,Ic949577afd3ea07306cebf224637a08a1ecce0f5,1,0,0.9615,2.5649,0.0833,2,12.4,390,0,Feature,0,0,0,26,0.049808,1.0,0,0.9615,2,2,0,0.9298,1.0,1.5,57.8,8.83,1,0,0.0,1,30.0,0,0,0,0,0,"Set proxy option in early dnf invocation

If hosts need to use a proxy to install packages and python is absent,
the call to install the python package will hang, at least on CentOS.

Set proxy if it exists in dnf_config using a command-line option. Later
uses of dnf will be after dnf.conf has been updated.

Story: 2009274
Task: 43528
[SEP]
FILES CHANGED:
releasenotes/notes/dnf-proxy-22a6eb457c06a223.yaml (+6, -0)
ansible/kayobe-ansible-user.yml (+5, -1)
",-0.608402,-1.070433,-0.336918,0.650248,-0.347203,-0.335674,0.265879,-0.228764,0.094346,0.047145,0.253029,-0.247301,0.060781,0.431958,0.016894
openstack/ironic,Ic017cc0f3aebd4858a1a6e3326e5cf0fc0888d24,1,0,0.9091,4.5326,0.0435,3,8.33,247,0,Bug Fix,0,0,0,11,0.015299,1.0,0,0.9091,5,2,0,1.0,0.7913,3.33,5.49,14.53,1,0,0.837,1,2.6559,0,0,0,0,0,"Fix regression in ramdisk deploy kernel parameters

After commit d7a5b3469cfb5c16e122451e9cd8594d7a7671a1 the custom kernel
parameters are not used in cleaning/inspection. This patch fixes it.
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/test_image_utils.py (+76, -1)
ironic/drivers/modules/image_utils.py (+7, -3)
releasenotes/notes/custom-params-cleaning-f938549964ff6df0.yaml (+5, -0)
",0.578833,-0.615281,-1.395905,-1.373827,1.167944,0.152351,0.717405,-0.394589,0.345936,0.148339,-0.649811,0.379409,-0.175055,-0.121459,0.004835
openstack/ironic,Id5bcfad5cd4514dd710232d75fbd729856f16b17,1,0,0,1.3863,0.3333,1,11.0,114,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,41.85,11.67,1,0,0.0,0,28.5,0,0,0,0,0,"Fixes missing argument for log format string

Story: 2008567
[SEP]
FILES CHANGED:
ironic/conductor/utils.py (+2, -1)
",3.162472,-1.029953,0.350479,-0.782764,-0.524337,0.661355,-0.250466,0.285663,1.062795,-0.039642,0.190014,-0.293603,0.07918,0.361953,-0.360293
openstack/kolla-ansible,I1d0d34919fbbe74a4022cd496bf84b8b764b5e0f,1,1,1.0,4.8903,0.697,7,13.25,363,0,Bug Fix,0,0,0,1,0.012346,1.0,0,1.0,4,4,0,0.8098,1.8177,3.43,44.94,14.36,1,0,0.0,1,2.7293,0,6,0,11,0,"Update Manila deploy steps for Wallaby

Manila has changed from using subfolders to subvolumes.
We need a bit of a tidy up to prevent deploy errors.
This change also adds the ability to specify the ceph FS
Manila uses instead of relying on the default ""first found"".

Closes-Bug: #1938285
Closes-Bug: #1935784
[SEP]
FILES CHANGED:
ansible/roles/manila/defaults/main.yml (+7, -0)
doc/source/reference/storage/external-ceph-guide.rst (+7, -0)
ansible/roles/manila/tasks/fix_cephfs_owner.yml (+0, -85)
releasenotes/notes/support-manila-wallaby-2e29e866af0d6287.yaml (+15, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+6, -2)
etc/kolla/globals.yml (+5, -0)
ansible/roles/manila/tasks/deploy.yml (+0, -5)
",-0.834584,-1.142391,-0.702369,0.118638,-0.414525,0.450352,-0.201212,0.120321,-0.088438,0.107302,0.24708,0.089866,0.26821,-0.206974,0.337689
openstack/oslo.limit,I8e43dceec76aecd2b2ae23a137e56519efe29777,1,0,1.0,4.585,0.1134,4,15.8,506,0,Feature,0,0,0,1,0.083333,0.0,0,0.0,2,2,0,0.5,1.4153,1.5,45.16,13.91,1,0,0.4021,1,5.1633,0,0,0,0,0,"Add caching of limits in Enforcer

This adds caching of resource limits for an Enforcer in order to
improve performance when repeated limit checks are needed. The cache
lasts the lifetime of an Enforcer and is enabled by default. It can be
disabled by passing cache=False when instantiating an Enforcer.

One usage pattern for a caching Enforcer would be to create an Enforcer
per service request so that the caching lives only as long as the
request.
[SEP]
FILES CHANGED:
oslo_limit/tests/test_limit.py (+39, -0)
oslo_limit/limit.py (+39, -10)
oslo_limit/fixture.py (+1, -1)
releasenotes/notes/enforcer-limit-caching-fb59725aad88b039.yaml (+7, -0)
",-1.374593,-1.248342,0.269369,1.423885,0.132513,0.375831,-0.053656,-0.397868,0.668006,0.569326,-0.191167,0.337922,0.09644,-0.280948,-0.116315
openstack/kayobe,I68332411e53c1d50ed56ddba3f46ee37db22f976,1,0,0.963,1.7918,1.0,1,3.5,98,0,Feature,0,0,0,27,0.050562,0.0,0,0.0,2,1,0,0.931,0.0,2.0,-50.52,29.97,1,0,0.0,0,16.3333,0,0,0,0,0,"Remove references to resolv.conf workaround
[SEP]
FILES CHANGED:
playbooks/kayobe-seed-upgrade-base/overrides.yml.j2 (+0, -5)
",2.5592,1.713468,0.754928,0.465491,0.596963,-0.258146,0.13644,-0.042692,-0.14528,-0.06715,0.178318,-0.98311,-0.917113,0.552659,-0.046162
openstack/octavia,I6ae2740557f0e62b6805e5dadd025e7bf44ec57d,1,0,1.0,2.9444,0.1667,1,5.5,286,0,Bug Fix,0,0,0,2,0.4,0.4286,0,0.4286,0,1,0,0.5306,0.0,0.0,-41.01,18.56,1,0,0.0,1,15.0526,0,0,0,0,0,"Add caps for pip-extra-reqs/pip-missing-reqs

pip-check-reqs fails with latest pip, cap both packages until
https://github.com/r1chardj0n3s/pip-check-reqs/issues/66 is fixed.

Co-Authored-By: Gregory Thiemonge <gthiemon@redhat.com>
[SEP]
FILES CHANGED:
tox.ini (+15, -3)
",-1.942431,3.235566,-1.694048,0.636073,-0.16265,-0.478992,-0.169078,-0.358787,-0.311566,-0.244945,0.224803,0.136925,0.71139,0.417617,0.286512
openstack/oslo.cache,I501100e1a48cdd4e094c08046e2150405dcf371e,1,0,0.3,4.9904,0.0137,8,3.71,869,0,CI,0,0,1,10,0.023256,1.0,0,0.3,3,4,0,0.6667,1.775,1.0,-7.95,11.37,1,0,0.5959,1,5.9116,0,0,0,0,0,"Add socket keepalive options to oslo.cache

This patch specifies a set of options required to setup the
socket keepalive of the dogpile.cache's pymemcache
backend [1][2]. This setup from those options can later on
be passed to this backend.

This patch also sets up the socket keepalive object based on
the configuration options passed via oslo.config and adds it
as an argument to be passed to the selected oslo.cache backend.

Dogpile.cache will be used as an interface between oslo.cache and
pymemcache [3].

[1] https://github.com/sqlalchemy/dogpile.cache/pull/205
[2]
https://github.com/pinterest/pymemcache/commit/b289c87bb89b3ab477bd5d92c8951ab42c923923
[3]
https://dogpilecache.sqlalchemy.org/en/latest/api.html?highlight=keepalive#dogpile.cache.backends.memcached.PyMemcacheBackend.params.socket_keepalive
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
test-requirements.txt (+1, -1)
oslo_cache/_opts.py (+26, -0)
oslo_cache/core.py (+23, -0)
doc/requirements.txt (+1, -0)
releasenotes/notes/pymemcache_socket_keepalive-f91c69770961e2b6.yaml (+6, -0)
setup.cfg (+1, -0)
oslo_cache/tests/unit/test_cache_basics.py (+85, -0)
",-3.872411,2.583436,2.389713,-0.43244,0.300218,-0.132691,0.060862,0.11731,0.051327,-0.032038,-0.122979,0.20542,-0.493456,-0.073495,-0.179236
openstack/oslo.cache,I6c1a4872d7cf19e3a55c676ef4b4200f18e08f2c,0,0,0.3636,4.7707,0.0,4,9.12,490,0,CI,0,0,0,11,0.019097,1.0,0,0.3636,3,2,0,0.75,1.41,1.75,45.76,11.87,1,0,0.6581,1,4.1525,0,0,0,0,0,"Add retry mechanisms to oslo.cache

This patch specifies a set of options required to setup a retry
context.  The context built from those options can later on be
passed to any of the oslo.cache backends that supports pymemcache's
retry mechanisms.

This patch also sets up the retry mechanisms context based on
the configuration option passed via oslo.config and adds it
as an argument to be passed to the selected oslo.cache backend.
[SEP]
FILES CHANGED:
releasenotes/notes/pymemcache_retry_mecchanisms-fa969d1ac6f64096.yaml (+5, -0)
oslo_cache/_opts.py (+16, -0)
oslo_cache/core.py (+19, -0)
oslo_cache/tests/unit/test_cache_basics.py (+77, -0)
",-1.444145,-0.480797,0.382167,1.593088,0.459322,-0.270377,0.184252,0.013983,0.476118,0.418082,-0.034254,0.257982,-0.075201,0.036674,0.171304
openstack/oslo.cache,I3b1b9a80aa57bfae44256fc4a1a301f752c84804,0,0,0.3333,4.2627,0.0,3,9.5,275,0,Feature,0,0,0,12,0.017316,0.5,0,0.1667,3,2,0,0.6,0.8773,2.0,39.12,12.22,1,0,0.8143,1,3.8732,0,0,0,0,0,"Add retry context creation from config

This patch sets up the retry mechanisms context based on the
configuration option passed via oslo.config and adds it as an argument
to be passed to the selected oslo.cache backend.
[SEP]
FILES CHANGED:
releasenotes/notes/pymemcache_retry_mecchanisms-fa969d1ac6f64096.yaml (+6, -0)
oslo_cache/core.py (+7, -0)
oslo_cache/tests/unit/test_cache_basics.py (+57, -0)
",0.482706,-0.785878,0.170369,1.364615,0.309328,-0.145625,0.351739,0.099404,0.580311,-0.23868,-0.203107,0.310676,-0.374248,0.122808,-0.156829
openstack/kolla-ansible,I81ad7d8642654f8474f11084c6934aab40243d35,1,0,0.7969,3.9318,0.0,5,15.2,495,0,CI,0,0,0,64,0.01767,0.3333,0,0.2656,4,2,0,0.811,2.0093,3.6,51.15,13.97,1,0,0.0,1,9.7059,1,0,0,0,0,"Add ability to retry image pulling

Sometimes, the registries may intermittently fail to deliver the
images. This is often seen in the CI, though it also happens with
production deployments, even those with internal registries and/or
registry mirrors - due to sheer load when trying to pull the
images from many hosts.

This patchs adds two new vars to control retry behaviour.
The default has been set to make users happier by default. :-)
[SEP]
FILES CHANGED:
ansible/roles/swift/defaults/main.yml (+6, -0)
ansible/roles/service-images-pull/tasks/main.yml (+4, -0)
releasenotes/notes/image-pull-retries-75490c3e6e1e4b54.yaml (+9, -0)
ansible/roles/service-images-pull/defaults/main.yml (+7, -0)
ansible/roles/swift/tasks/pull.yml (+24, -0)
",-0.76606,-2.265172,0.233706,0.551956,-0.528205,-0.296375,0.410672,-0.160531,-0.128776,0.254923,-0.087884,-0.092548,0.451514,-0.379404,-0.017954
openstack/kolla-ansible,I0103d7ef55e6aebe043a582d36f1a2efa137f447,1,0,0.875,1.6094,0.5,1,7.0,89,0,Bug Fix,0,0,0,56,0.022346,0.0,0,0.0,2,1,0,0.8121,0.0,2.0,-54.07,19.94,0,0,0.0,1,17.8,0,0,0,0,0,"Fix release note for ansible_facts
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-facts-4279741e84c03ce0.yaml (+2, -2)
",3.002969,0.954866,1.267491,-0.518147,0.413058,-0.153359,-0.045316,0.016875,0.376593,-0.395644,0.186247,-0.742475,-0.109149,-0.249909,0.157663
openstack/ironic,If3c01e6e4e8cedfe053e78fab9632bfff3682b06,1,0,0,3.9703,0.0385,3,15.5,692,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,1.0,1.3431,2.67,16.44,16.95,1,0,0.6154,1,13.0566,0,0,0,0,0,"Enable priority overrides to enable/disable steps

Generic way to configure clean step priorites feature
( https://review.opendev.org/c/openstack/ironic/+/744117 ) enabled support
for customising clean step priorities for any clean step by setting a
configuration option. However, due to an error in code, it was not possible
to use this feature to enable/disable steps entirely using this option
as overrides were applied too late, after the disabled steps were already
filtered out.

This change fixes this error, making it possible to use step priority
override configuration option to enable/disable steps as required.

Story: 2009105
[SEP]
FILES CHANGED:
ironic/tests/unit/conductor/test_steps.py (+32, -0)
ironic/conductor/steps.py (+9, -2)
releasenotes/notes/fix-step-priority-overrides-edecff2a6c68dcac.yaml (+9, -0)
",-1.387084,-0.883844,0.714848,0.386011,-0.273954,-0.017844,0.135949,-0.216533,0.234064,0.142143,-0.282886,-0.072512,0.090577,-0.419091,-0.006923
openstack/kolla-ansible,I2ecba4999e194766258ac5beed62877d43829313,1,0,0.8772,1.9459,0.5,2,9.0,471,0,Feature,0,0,0,57,0.022709,1.0,0,0.8772,4,2,0,0.8133,0.9183,4.0,-48.58,16.93,0,0,0.0,0,67.2857,0,0,0,0,0,"ironic: Follow up for ironic_enable_keystone_integration

Follow up for I0c7e9a28876a1d4278fb2ed8555c2b08472864b9 which added a
ironic_enable_keystone_integration variable to support Ironic in
multi-region environments. This change skips Keystone service
registration based on ironic_enable_keystone_integration rather than
enable_keystone. It also updates the ironic-inspector.conf template to
use the new variable.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+2, -2)
ansible/roles/ironic/tasks/deploy.yml (+1, -1)
",-2.049956,0.29309,-0.883771,0.059007,1.25804,-0.224561,-0.018641,0.023075,0.365692,-0.29954,0.4041,-0.072766,-0.226648,-0.190594,0.496113
openstack/kolla,Ie8757817f4b0f0fa1317b3444b8bf40281f0d50c,1,0,0.9643,1.0986,0.5,1,9.0,90,0,Bug Fix,0,0,0,28,0.051948,0.0,0,0.0,2,1,0,0.785,0.0,2.0,56.7,8.04,0,0,0.0,1,30.0,0,0,0,0,0,"Fix naming of CentOS Stream in reno
[SEP]
FILES CHANGED:
releasenotes/notes/centos-8-stream-b5b45ccee94f7cf5.yaml (+1, -1)
",3.059549,1.478751,1.832911,0.25877,0.276811,0.921231,-0.051624,-0.050508,0.081451,-0.133915,0.216176,-0.292925,0.187054,-0.078095,-0.042634
openstack/kayobe,I097b826cb477577fc9482bbc3b8875b71a505a99,1,0,0.9655,2.3979,0.5,2,10.0,112,0,Bug Fix,0,0,0,29,0.053604,1.0,1,0.9655,4,1,0,0.9322,0.7219,4.0,19.03,16.0,1,0,0.0,0,10.1818,0,0,0,0,0,"Fix documentation links for routed control plane networks
[SEP]
FILES CHANGED:
doc/source/configuration/reference/routed-control-plane-networks.rst (+4, -4)
doc/source/configuration/reference/kolla-ansible.rst (+1, -1)
",3.10835,-0.051735,2.005555,0.605459,1.046001,-0.141153,0.73702,0.983787,0.870671,-0.27626,-0.578175,-0.227054,0.394989,-0.65259,-0.34105
openstack/octavia,I9dbdb71e9b94bbcc75766a8687a996d5358f3381,1,0,0,4.0431,0.0893,3,7.5,521,1,Bug Fix,0,0,0,0,0.0,0.4,0,0.0,6,2,0,0.5325,1.4284,4.0,50.33,12.07,1,0,0.5357,1,9.1404,0,0,0,0,0,"Fix duplicate SG creation for listener peer port

In cases where the listener protcol port is same as the peer port
and allowed_cidr set to 0.0.0.0/0 explicitly, the listener is not
provisioned due to duplicate security group creation for peer port
with None as remote_ip_prefix. Neutron SG defaults remote_ip_prefix
to 0.0.0.0/0 if not specified or None and hence the error SG rule
already exists.

Remove the duplicate entry from the updated_ports.

Story: #2009117
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+30, -0)
releasenotes/notes/fix-duplicate-sg-creation-0c502a5d2d8c276d.yaml (+9, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+12, -5)
",-1.321565,-0.932812,0.460587,0.459916,0.458689,0.062465,-0.261029,0.27435,0.650095,0.148852,0.039568,-0.282437,-0.224263,0.295711,-0.248641
openstack/kolla-ansible,Ica311acba445cccac1d20757ced6f15a064ebcaa,1,1,0.8,2.5649,0.1667,3,11.0,125,0,Bug Fix,0,0,0,65,0.017702,0.8333,0,0.6667,4,3,0,0.8144,1.4591,3.33,-27.37,22.58,1,0,0.0,1,9.6154,0,6,0,13,0,"Fix kolla-toolbox with IPv6 and disabled RabbitMQ

Closes-Bug: #1939883
[SEP]
FILES CHANGED:
ansible/roles/common/templates/kolla-toolbox.json.j2 (+2, -2)
ansible/roles/common/tasks/config.yml (+2, -0)
releasenotes/notes/bug-1939883-dbfca874b138cfe9.yaml (+6, -0)
",2.146276,-0.050286,0.088443,-1.246868,-0.464244,0.249776,-0.852534,0.735398,-0.001582,-0.335208,0.210884,-0.059716,0.309286,-0.383227,0.481572
openstack/kolla-ansible,Ib5a073d5b8209005be8841e355e75047c77bd488,1,0,0.7,1.6094,0.5,2,6.8,281,0,Bug Fix,0,0,0,10,0.033898,0.0,0,0.0,4,2,0,0.8155,1.0,4.0,45.66,8.6,1,0,0.0,0,56.2,0,0,0,0,0,"Fix the Tempest image url variable

Seems very strange the variable of the image url doeesn't have the
correct prefix. This trivial fix will solve the issue.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/tempest/templates/tempest.conf.j2 (+1, -1)
ansible/roles/tempest/defaults/main.yml (+1, -1)
",0.438873,-1.033726,-0.178475,0.340923,-0.291667,0.873467,-0.409158,-0.946194,0.19824,-0.008072,0.25685,0.006016,-0.239728,0.136996,0.180508
openstack/kayobe,I4a15578135a48cf282672288f4db24ded65f3b82,1,0,1.0,2.1972,0.125,2,11.67,295,1,Bug Fix,0,0,0,2,0.086957,1.0,0,1.0,2,2,0,0.9333,0.8113,1.5,25.79,17.24,1,0,0.0,1,32.7778,0,0,0,0,0,"Fix overcloud introspection data save

The command `kayobe overcloud introspection data save` has been failing
due to lack of OpenStack credentials when running the bifrost dynamic
inventory. Add OS_CLOUD=bifrost.

Story: 2009129
Task: 43059
[SEP]
FILES CHANGED:
releasenotes/notes/fix-introspection-data-save-51001baa37d97084.yaml (+6, -0)
ansible/overcloud-introspection-data-save.yml (+1, -1)
",-0.477177,-0.892934,-0.940421,-0.050188,0.272417,0.224398,-0.733109,0.2275,-0.041013,-0.58336,0.297826,-0.091726,0.110579,0.142871,-0.011918
openstack/ironic,I02b63547566c94ffa1a5d0e84bd1b1f10d28bfc3,1,0,1.0,4.7707,0.0256,5,16.33,360,0,Bug Fix,0,0,0,4,0.003626,1.0,0,1.0,6,2,0,1.0,1.3754,4.0,31.42,15.51,1,0,0.7949,1,3.0508,0,0,0,0,0,"Fix iDRAC import configuration job with errors

In iDRAC import configuration task can be completed with OK health
but having some errors, for example, when one disk failed to be
created and another succeeded.
Also changed to exclude informational messages for error reporting.

Story: 2009198
Task: 43253
[SEP]
FILES CHANGED:
ironic/drivers/modules/drac/management.py (+17, -1)
ironic/tests/unit/drivers/modules/drac/test_management.py (+83, -0)
releasenotes/notes/idrac-import-conf-partial-success-86b8bd1983d227f6.yaml (+6, -0)
ironic/tests/unit/drivers/third_party_driver_mock_specs.py (+4, -1)
ironic/tests/unit/drivers/third_party_driver_mocks.py (+4, -1)
",-0.328644,-1.916976,-0.377319,0.183503,-0.33133,0.380684,-0.476458,-0.340188,0.148773,0.1724,-0.171972,0.007376,0.415551,0.414196,-0.15927
openstack/kolla-ansible,Ide9e9009a6e272f20a43319f27d257efdf315f68,1,1,0.803,3.6109,0.1944,5,9.67,235,1,Bug Fix,0,0,0,66,0.017915,1.0,0,0.803,4,4,0,0.8166,1.7638,2.4,21.99,14.9,1,0,0.0278,1,6.3514,0,260,0,16,0,"Never make Docker registry insecure by default

To follow best security practices and help fellow operators.

More details inline and in the linked bug report.

Closes-Bug: #1940547
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+2, -1)
tests/templates/globals-default.j2 (+0, -1)
releasenotes/notes/bug-1940547-771f6affb3547748.yaml (+18, -0)
doc/source/reference/deployment-and-bootstrapping/bootstrap-servers.rst (+7, -4)
etc/kolla/globals.yml (+2, -1)
",0.909057,-1.723596,-0.414606,-0.363964,-1.148232,0.593754,-0.387843,0.152029,0.122145,-0.163719,-0.038559,-0.034528,0.072618,-0.257332,-0.15889
openstack/kolla-ansible,I584a83d352c747a799b5dab1d3b8159ba3805454,1,1,0.806,2.0794,0.0,2,12.0,190,0,Bug Fix,0,0,0,67,0.018011,1.0,0,0.806,4,2,0,0.8176,0.5917,3.0,28.98,16.47,1,0,0.0,1,23.75,0,6,0,14,0,"Fix Masakari in multi-region deploys

to behave like it is most commonly expected - query Nova in the
same region.

Closes-Bug: #1939291
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1939291-bf2e405d286e4b07.yaml (+6, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+1, -0)
",1.288213,-1.408152,0.037869,-0.711967,-0.823536,0.154561,-0.535791,-0.062448,-0.199775,-0.126459,-0.008699,0.212062,0.122095,0.125987,0.252355
openstack/kolla,I1fbad333b1bc95484e6f4c5145d5936a0e2db84f,1,0,0.7273,5.0039,0.2905,23,12.4,510,0,Feature,0,0,0,11,0.036789,1.0,0,0.7273,3,3,0,0.787,4.3841,2.7,22.32,18.51,1,0,0.0135,1,3.4228,0,0,0,0,0,"Unify curl use (customisation options)

This change adds and unifies an ability to override hardcoded URLs for
air-gapped environments via the usual blocks mechanism. Also, this
change replaces ENV with ARG instruction for the variables used only
in building images, and uses bash variable expansion where it possible.

This change is a continuation of the I46b77978926fc2b578a68d1aaa944b2198af0685
[SEP]
FILES CHANGED:
releasenotes/notes/generic-customisation-b2d431caa2fc5c10.yaml (+15, -0)
docker/mariadb/mariadb-base/Dockerfile.j2 (+6, -1)
docker/zun/zun-cni-daemon/Dockerfile.j2 (+8, -3)
docker/kafka/Dockerfile.j2 (+4, -4)
doc/source/admin/image-building.rst (+11, -0)
docker/prometheus/prometheus-blackbox-exporter/Dockerfile.j2 (+3, -2)
tests/templates/template_overrides.j2 (+1, -1)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
docker/prometheus/prometheus-haproxy-exporter/Dockerfile.j2 (+3, -2)
docker/prometheus/prometheus-mysqld-exporter/Dockerfile.j2 (+3, -2)
docker/prometheus/prometheus-node-exporter/Dockerfile.j2 (+3, -2)
docker/storm/storm-base/Dockerfile.j2 (+3, -3)
docker/zookeeper/Dockerfile.j2 (+3, -3)
docker/prometheus/prometheus-memcached-exporter/Dockerfile.j2 (+3, -2)
docker/prometheus/prometheus-elasticsearch-exporter/Dockerfile.j2 (+3, -2)
docker/prometheus/prometheus-v2-server/Dockerfile.j2 (+3, -2)
docker/prometheus/prometheus-alertmanager/Dockerfile.j2 (+4, -3)
docker/skydive/skydive-base/Dockerfile.j2 (+6, -1)
docker/prometheus/prometheus-cadvisor/Dockerfile.j2 (+4, -3)
docker/prometheus/prometheus-msteams/Dockerfile.j2 (+2, -1)
docker/base/Dockerfile.j2 (+7, -0)
docker/fluentd/Dockerfile.j2 (+6, -3)
docker/prometheus/prometheus-openstack-exporter/Dockerfile.j2 (+3, -2)
",-0.881221,-1.622956,-0.426079,-0.469143,0.492782,-0.012779,0.681767,0.183157,0.416023,0.507559,-0.018572,-0.021779,0.212362,-0.266573,-0.219792
openstack/octavia,Ia8ec48ab858eeecf71ed429e5b7625fd7af9d8f6,1,0,0.6557,4.0943,0.0169,10,19.0,527,0,Feature,0,0,0,61,0.006333,1.0,0,0.6557,7,3,0,0.5344,2.2184,5.4,31.71,15.49,0,0,0.6949,1,8.7833,0,0,0,0,0,"Preserve haproxy server states during reloads

haproxy doesn't keep the state of the servers (UP or DOWN) during
reloads, so a member with an ERROR operating_status may be updated
to ONLINE after updating a load balancer.

This commit adds the load-server-state-from-file option in haproxy
configuration files. It also adds an extra step in the haproxy systemd
service file to dump the current server-state in a file when reloading
the service.

Story: 2009142
Task: 43084
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/systemd.conf.j2 (+1, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+4, -0)
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+2, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+2, -0)
octavia/common/jinja/haproxy/combined_listeners/templates/base.j2 (+1, -0)
octavia/amphorae/backends/agent/api_server/util.py (+4, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+34, -0)
releasenotes/notes/fix-member-operating-status-on-reload-fe3688603bae8726.yaml (+5, -0)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+1, -0)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+4, -1)
",-0.854403,-1.227529,0.458513,0.579815,0.0347,-0.306959,0.067651,0.063475,0.422758,-0.24037,-0.051683,0.072804,0.081248,0.223779,0.023157
openstack/kolla,I19c2a15fb0917d2a81daf706a4e02fd377e53b3d,1,0,0,2.3979,0.5,3,6.6,480,0,Feature,0,1,1,0,0.0,0.5,0,0.0,2,2,0,0.789,1.5219,1.33,50.16,8.7,0,0,0.0,0,43.6364,0,0,0,0,0,"Revert ""Update code to Jinja 3.0 style""

This reverts commit 383364e671fb82e3c0ddca37a4690a1a33be3b54.

Reason for revert: Xena stay in jinja 3.0.1 which still provides contextfilter. In RDO, jinja is consumed from CentOS repo which still provides version 2.11, so this change is causing problems.

I'm proposing to revert this change and retake it Y release when jinja is updated to 3.1 which will not provide contextfilter.
[SEP]
FILES CHANGED:
kolla/template/methods.py (+2, -2)
kolla/template/filters.py (+2, -2)
requirements.txt (+1, -1)
",-1.069988,-0.616724,-0.192431,-0.691426,0.2447,0.179696,0.970936,0.17644,-0.416204,0.592458,0.297242,0.162003,-0.29275,-0.122741,0.049687
openstack/kolla,Ic8f0554c95c1903640c98a7831b829c1f88f49ff,1,1,1.0,2.1972,0.0,2,6.8,276,0,Bug Fix,0,0,0,6,0.073171,0.75,0,0.75,3,2,0,0.7909,0.8113,2.5,43.17,13.31,0,0,0.0,1,30.6667,0,10,0,9,0,"Fix Elasticsearch Curator

Newest elasticsearch python library required by Curator does no longer
work against the last OSS version of Elasticsearch (7.10.2). Pin it
to the last known working version.

Closes-Bug: #1941073
[SEP]
FILES CHANGED:
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+2, -0)
releasenotes/notes/fix-elasticsearch-curator-7876896ebbd41ad3.yaml (+6, -0)
",0.243254,-1.231058,-0.477144,-0.215555,-0.460992,0.491965,-0.656514,0.611097,-0.269196,0.281859,-0.209567,0.324568,-0.342993,-0.063442,0.389918
openstack/python-ironicclient,I92d8ce2a61f459ce14335bfb05424dc883dbc4d1,1,0,0,3.0445,0.15,2,15.33,331,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,1.0,0.971,3.0,36.78,16.57,1,0,0.6,0,15.7619,0,0,0,0,0,"Validate path when passing a config-drive

Currently when --config-drive should point to a file or directory the
command silently uses the path as a configdrive if this file/directory
does not exist.

This is not easily understandable for the user as no error message appears.
[SEP]
FILES CHANGED:
ironicclient/v1/node.py (+6, -2)
ironicclient/tests/unit/v1/test_node.py (+11, -1)
",0.379532,-1.226596,-0.265423,1.253145,-0.162727,-0.292512,0.640946,-0.762488,0.45118,0.108385,-0.101246,0.275014,0.296211,0.370416,-0.173982
openstack/ironic-lib,I3b20754727de904dbe72f358a21f31f00a5fbb77,1,0,0.9167,4.8598,0.3125,2,16.67,353,0,Bug Fix,0,0,0,12,0.014797,1.0,0,0.9167,2,1,0,1.0,0.9998,1.5,41.02,13.07,1,0,0.5078,0,2.7364,0,0,0,0,0,"Avoid using blkid in favour of lsblk and parted

Per blkid man page, we should rather use lsblk, which has much better
debugging output (blkid essentially only returns an exit code). Since
the partition table type is not available in lsblk, copy the procedure
using parted from ironic-python-agent.
[SEP]
FILES CHANGED:
ironic_lib/tests/test_disk_utils.py (+40, -25)
ironic_lib/disk_utils.py (+48, -15)
",0.359246,-0.80201,0.02234,0.567514,-0.09201,-0.452694,0.341222,-0.321579,-0.404088,0.017837,-0.166468,-0.074657,-0.120066,-0.315785,0.256467
openstack/kolla-ansible,I629bb9e70a3fd6bd1e26b2ca22ffcff5e9e8c731,1,1,0.8088,2.7081,0.0,2,15.67,379,0,Bug Fix,0,0,0,68,0.018245,0.75,0,0.6066,4,2,0,0.8187,0.3712,3.0,43.33,14.78,1,0,0.0,1,25.2667,0,12,0,39,0,"Restore libvirtd cgroupfs mount

It was removed in [1] as part of cgroupsv2 cleanup.
However, the testing did not catch the fact that the legacy
cgroups behaviour was actually still breaking despite latest
Docker and setting to use host's cgroups namespace.

[1] 286a03bad20955aa4d3f7009cef5856d328b76f1

Closes-Bug: #1941706
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+1, -0)
releasenotes/notes/bug-1941706-a8f9e9544f1540e3.yaml (+13, -0)
",-0.220384,-1.140985,-0.429701,-1.039564,-0.136459,0.101821,0.791513,0.2868,0.085593,0.410348,0.380046,-0.160501,0.137448,-0.066697,0.012236
openstack/stevedore,I20a7fe4240cf78e6b863951740c2d0fe9aa28132,1,0,1.0,1.0986,0.5,1,4.67,145,0,Feature,0,0,0,4,0.004773,1.0,0,1.0,1,1,0,1.0,0.0,1.0,-3.36,13.3,1,0,0.0,0,48.3333,0,0,0,0,0,"Rely on member access, the preferred access since importlib_metadata 4.8.

Closes: #1941991
[SEP]
FILES CHANGED:
stevedore/_cache.py (+1, -1)
",2.702193,-0.949716,0.527043,-0.897966,-1.122694,0.551028,-0.039958,0.551484,0.217424,0.34786,-0.36602,-0.192933,-0.790061,0.030168,0.396961
openstack/kolla,I55c3f142d0390b66ffdaf9ec89462e6530e8a3bd,1,0,0.8116,1.0986,0.5,1,9.0,96,0,Doc,0,0,0,69,0.018444,0.0,0,0.0,2,1,0,0.7928,0.0,2.0,-9.1,25.82,1,1,0.0,0,32.0,0,0,0,0,0,"[doc] Ubuntu has Ceph Pacific in Wallaby+
[SEP]
FILES CHANGED:
doc/source/ceph_versions.csv (+1, -1)
",2.482495,1.271883,0.680768,-0.342927,0.047123,0.770082,-0.255858,0.698017,-1.017173,0.147934,0.522838,0.343124,0.102708,-0.520377,-1.038432
openstack/ironic,Ibc5610b14cea487d26191249e5c0333fdcd4b914,1,0,0.9231,5.8021,0.397,5,14.25,445,0,Bug Fix,0,0,0,13,0.013845,1.0,0,0.9231,5,2,0,1.0,1.2674,3.6,26.14,14.82,1,0,0.2182,1,1.3444,0,0,0,0,0,"Fix in-band cleaning for ramdisk and anaconda deploy

We have implemented the cleaning prepare/tear_down, but haven't
implemented fetching/running in-band clean steps. This change moves
the cleaning logic from AgentDeployMixin to AgentBaseMixin, where it
arguably belongs.

In a follow-up patch I'm planning to reduce the number of mix-ins we
currently have, but that won't be backportable.
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent.py (+1, -1)
ironic/drivers/modules/agent_base.py (+118, -121)
ironic/tests/unit/drivers/modules/test_agent_base.py (+11, -9)
releasenotes/notes/ramdisk-cleaning-f4e061f978bd6ac4.yaml (+17, -0)
ironic/tests/unit/drivers/modules/test_pxe.py (+52, -0)
",-0.63407,-1.005165,0.181993,0.505795,-0.307525,-0.111959,0.540191,-0.280149,-0.572283,0.151138,0.314316,0.234576,0.100622,-0.300073,0.466009
openstack/kolla,Id5938697b62ba040062475fcf5215d64e1ba8c6f,1,1,0.8143,2.4849,0.0,2,5.2,273,0,Bug Fix,0,0,0,70,0.018702,0.4,0,0.3257,2,2,0,0.7946,0.994,2.0,38.86,12.85,1,0,0.0,1,22.75,1,10,0,28,0,"Pin td-agent to 4.0.* also on Debian

Debian was missed in the original patch. [1]

Backport to Victoria.

[1] 6d0882ef799bb531d007c3e6839ef318fd512d5c
aka Iefcdd3100b7e3c5320bc5f1286a18251bdeab885

Closes-Bug: #1930867
[SEP]
FILES CHANGED:
docker/base/apt_preferences.debian (+5, -0)
releasenotes/notes/bug-1930867-debian-c01f2cd22d8c10f0.yaml (+6, -0)
",-1.262919,-0.97031,-1.661991,-2.46238,0.847143,-0.058079,0.377925,0.407657,0.179344,0.731803,-0.127166,-0.060021,0.204068,0.025668,-0.041988
openstack/kolla,Ic5d90459b6b95b69c7df7382ca74e1420f4cdb35,1,0,0.8696,2.8332,0.5,1,11.0,119,0,Feature,0,0,0,23,0.043233,0.5385,0,0.4682,2,1,0,0.7965,0.0,2.0,41.85,11.67,0,0,0.0,1,7.0,0,0,0,0,0,"debian: Change influxdb, rabbitmq and td-agent repos to bullseye
[SEP]
FILES CHANGED:
kolla/template/repos.yaml (+8, -8)
",0.62858,0.57806,-0.563258,-0.012779,1.269974,-0.979779,-0.056353,0.618108,-1.353185,-0.147698,0.088662,0.256021,-0.173346,-0.230811,-0.327697
openstack/kolla-ansible,I1be60ac7647b1a838e97f05f15ba5f0e39e8ae3c,1,1,0.875,2.1972,0.125,2,8.29,442,0,Bug Fix,0,0,0,24,0.043796,1.0,0,0.875,4,2,0,0.8198,0.9544,3.0,23.39,12.28,1,0,0.0,1,49.1111,0,6,0,10,0,"toolbox: Allow different users logging to ansible.log

Currently only operations done with default kolla_toolbox user are logged
to /var/log/kolla/ansible.log.

In order to fix logging, permissions to ansible.log must allow writing
for other users in kolla group - and then a separate patch will follow
to make custom ansible.cfg file usable by other toolbox users.

Partial-Bug: #1942846
[SEP]
FILES CHANGED:
ansible/roles/common/templates/kolla-toolbox.json.j2 (+2, -1)
releasenotes/notes/bug-1942846-8b9edb99a7e7c24f.yaml (+5, -0)
",-0.843747,-0.721454,-0.256548,0.339718,-0.024492,-0.665689,0.284151,0.170088,-0.195298,-0.22234,-0.038416,-0.43565,-0.012647,0.076326,-0.19894
openstack/kolla,I4325fe031647a04766516afa528639d6ff0b5ae6,1,1,0.88,3.2189,0.0833,3,7.4,356,0,Bug Fix,0,0,0,25,0.044964,0.7143,0,0.6286,2,3,0,0.7982,1.4506,2.0,-1.89,12.69,1,0,0.0,1,14.24,0,6,0,10,0,"toolbox: Move custom Ansible config to global location

In order to achieve logging to /var/log/kolla/ansible.log from different
users than default ansible - the config needs to be moved to global
location.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/807679
Closes-Bug: #1942846
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1942846-1216faacacba94be.yaml (+5, -0)
docker/kolla-toolbox/Dockerfile.j2 (+4, -2)
docker/kolla-toolbox/extend_start.sh (+13, -0)
",-1.493986,1.577147,-1.204217,0.325958,-0.685537,-0.205718,0.295935,0.076514,0.060225,-0.188656,0.041069,-0.501383,0.421475,-0.060723,-0.009353
openstack/kolla-ansible,I0e03db1177931ee6d17b21f614573575c3493eef,1,1,0.0,2.1972,0.0,2,11.0,122,0,Bug Fix,1,0,0,1,0.5,0.5,0,0.0,1,2,0,0.8208,0.8113,1.0,-4.29,22.58,1,0,1.0,0,13.5556,0,8,0,5,0,"Zun: Temporarily skip capsule test for ubuntu

Related-Bug: #1941982
[SEP]
FILES CHANGED:
tests/run.yml (+2, -0)
tests/test-zun.sh (+6, -0)
",2.389386,0.005735,0.284635,-1.053678,-1.103782,1.025064,-0.632568,0.01917,-0.067318,0.204654,0.572275,0.150919,0.227995,-0.033131,0.323323
openstack/python-octaviaclient,Id0f07b7145a6a19a6bc13ddeee93dc1957ddd8dd,1,0,0.6613,3.3673,0.0714,3,16.75,499,0,Bug Fix,0,0,0,62,0.006398,0.0,0,0.0,5,2,0,0.1304,1.4098,3.33,6.74,15.06,0,0,0.5357,1,17.2069,0,0,0,0,0,"Fix inconsistent parameter name in azp

The availability zone data parameter was uncorrectly defined as
""--availabilityzone-data"" in SetAvailabilityzoneProfile while it is
called ""--availability-zone-data"" when creating a resource.

Fixing this typo also fixed the set CLI call, the availability zone
data parameter was dropped in the PUT request. Now an admin is able
to update the JSON data.

Story 2009195
Task 43250
Story 2009196
Task 43251
[SEP]
FILES CHANGED:
releasenotes/notes/fix-inconsistent-parameter-name-in-azp-0267d025b7c78fc2.yaml (+9, -0)
octaviaclient/tests/unit/osc/v2/test_availabilityzoneprofile.py (+15, -0)
octaviaclient/osc/v2/availabilityzoneprofile.py (+2, -2)
",-0.797068,-1.304011,-0.017656,0.360353,-0.032658,0.347696,-0.273728,0.067989,0.533142,-0.067224,0.217341,0.066737,-0.096682,0.623181,0.188105
openstack/octavia,I990b6af1ff880b25e54f6c41ae0c966007f3f098,1,0,0,3.5835,0.3429,3,15.0,372,0,Bug Fix,0,0,0,0,0.0,0.5714,0,0.0,5,2,0,0.5363,1.1953,3.0,31.81,16.67,0,0,0.6857,1,10.3333,0,0,0,0,0,"Fix MAX_TIMEOUT value for listener

In the database, timeout_client_data, timeout_member_connect,
timeout_member_data, timeout_tcp_inspect have an integer type with
a maximum size of 2147483647. Now MAX_TIMEOUT in API does not exceed
this value and is equal to 24 days (2073600000 seconds).

Story: 2009193
Task: 43248
[SEP]
FILES CHANGED:
octavia/common/constants.py (+2, -2)
releasenotes/notes/fix-listener-MAX_TIMEOUT-4c4fdf804a96c34b.yaml (+7, -0)
octavia/tests/functional/api/v2/test_listener.py (+14, -10)
",-1.060255,-0.783119,-0.543823,0.048533,0.45807,0.434881,-0.600548,-0.156908,0.561474,-0.132406,-0.12218,-0.45501,-0.259391,0.385776,-0.117856
openstack/oslo.policy,Iaed5682bc72f4c66adb9a40c6510b399314574df,1,0,0,1.9459,0.1667,1,13.0,301,0,CI,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.8,0.0,1.0,41.79,15.46,0,0,0.0,0,43.0,0,0,0,0,0,"Clarify enforce_new_defaults help text

The help text isn't clear what happens when enforce_new_defaults is
False, which is the default behavior. Explicity call that out in the
help text since it's important for users to understand that behavior.
[SEP]
FILES CHANGED:
oslo_policy/opts.py (+5, -1)
",0.515452,-0.47146,-0.296157,0.949598,0.15536,0.541922,0.539148,-1.111931,-0.192853,-0.013649,0.234198,-0.188057,-0.15642,-0.265955,0.292484
openstack/octavia,I387d9a3ad2197f6b59cd12db5f7643484c98fcd2,1,0,0.6667,3.9512,0.0196,2,13.33,289,0,Feature,0,0,0,63,0.006482,0.5,0,0.3333,6,1,0,0.5382,0.8479,5.0,43.14,13.33,0,0,0.7255,0,5.5577,0,0,0,0,0,"Ignore status update on deleted objects in driver-agent

When receiving 2 DELETE updates on the same object, ignore the 2nd
update. It avoids throwing exceptions because the object no longer
exists in the DB.

Story 2009202
Task 43259
[SEP]
FILES CHANGED:
octavia/api/drivers/driver_agent/driver_updater.py (+13, -1)
octavia/tests/functional/api/drivers/driver_agent/test_driver_agent.py (+37, -0)
",0.698266,-1.874928,-0.071363,0.028352,-0.504641,0.335192,0.104775,-0.202273,0.054232,-0.097432,-0.150437,0.076506,0.082609,0.36952,-0.215656
openstack/kolla-ansible,If5a26b1ba4bf35bc29306c24f608396dbf5e3371,0,1,0.8169,4.5433,0.7312,7,6.0,211,0,Bug Fix,0,0,0,71,0.018913,1.0,0,0.8169,4,3,0,0.8218,1.9328,3.0,35.07,14.07,0,0,0.0,1,2.2447,0,12,0,13,0,"Switch default images source to quay.io

Docs adapted to match.
Removed the unsupported-for-quay option to set up
a pull-through cache.

Closes-Bug: #1942134
[SEP]
FILES CHANGED:
releasenotes/notes/switch-images-to-quay-d4640afca6862eee.yaml (+11, -0)
doc/source/user/multinode.rst (+7, -46)
ansible/group_vars/all.yml (+2, -2)
doc/source/user/quickstart.rst (+2, -1)
doc/source/user/troubleshooting.rst (+0, -16)
doc/source/reference/deployment-and-bootstrapping/bootstrap-servers.rst (+2, -2)
doc/source/reference/logging-and-monitoring/monasca-guide.rst (+1, -1)
",0.814247,-1.076435,-0.530264,-0.483832,-0.883682,-0.211194,-0.674814,0.253438,-0.072545,-0.132143,-0.118377,0.134447,0.205144,0.116738,0.325156
openstack/ironic,I5a1c5708bdc1709e928f0faf7e18396e260dc551,1,0,0,3.8712,0.0213,3,22.29,1024,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,1.0,0.8509,4.0,38.88,16.61,1,1,0.8085,1,21.3333,0,0,0,0,0,"[iRMC] Avoid repeatedly resuming clean after creating raid configuration

Fixed the bug of repeated resume cleaning due to the value of `fgi_status` not being updated correctly when obtaining the
RAID configuration status of the node managed by the `irmc` hardware type.

```
Unexpected error when processing next clean step. TypeError: 'NoneType' object is not subscriptable
```

This `NoneType` error occurs because ironic resumes clean without waiting for IPA to get the clean steps, and then it tries to read the
clean steps which should be a list but actually is none.
During auto clean, resume clean should be triggered by IPA, but in this case, it is triggered by a iRMC periodic task which checks
the progress of running raid config.
This error does not occur every time, sometime raid can be configured, auto clean can complete without error and the node can be deployed successfully.

Story: #2009206
Task: #43265
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/irmc/test_periodic_task.py (+38, -0)
releasenotes/notes/irmc-fix-repeatedly-resuming-clean-020f0dfc2e30d7bc.yaml (+7, -0)
ironic/drivers/modules/irmc/raid.py (+1, -1)
",-2.279642,-1.486083,2.271774,-0.267234,-0.315299,0.348501,0.155268,0.043845,0.206592,-0.149645,0.234197,-0.13924,-0.114861,-0.049607,-0.264436
openstack/python-ironicclient,Ic732c2e6c77474e0d5b701c47758959c3511743b,1,0,1.0,4.4427,0.1786,3,23.75,743,0,Bug Fix,0,0,0,9,0.013006,0.0,0,0.0,4,2,0,1.0,1.3214,2.67,12.64,21.29,0,0,0.5119,1,8.7412,0,0,0,0,0,"Fix distribution compatability for configdrive build

Previously, the configuration drive generation code made
use of ``genisoimage``, however ``genisoimage`` is not shipped
universally on all linux distributions, and largely has been
replaced in distributions with other forks, as the tooling has
evolved, forked, and changed over the past quarter century.

We now attempt to utilize multiple different commands, including
the original ``mkisofs`` command and the newer ``xorrisofs``
command when attempting to generate the ISO image, falling back
until one works.

Credit goes to I720f25921f8e52f20a631f238a528dedf65a91c6 for
the base pattern in OpenstackSDK.

Story: 2009230
Task: 43328
[SEP]
FILES CHANGED:
ironicclient/tests/unit/common/test_utils.py (+40, -3)
releasenotes/notes/address-cross-distro-iso-tools-006711c9f150037a.yaml (+7, -0)
ironicclient/common/utils.py (+22, -12)
",-2.108322,-1.58443,1.320378,-0.878237,0.032805,-0.053837,0.082203,0.421775,0.177373,-0.039214,-0.06043,0.388407,-0.36685,-0.077724,0.214749
openstack/kolla-ansible,Ic10a23c42eab77661a95a7bb90a49531241ad886,1,0,0.8056,5.3327,0.534,1,7.0,172,0,Doc,0,0,0,72,0.018716,1.0,1,0.8056,3,1,0,0.8171,0.0,3.0,30.53,12.32,1,1,0.0,0,0.8309,0,0,0,0,0,"[docs] Rewrite operating-kolla upgrade-wise

This file was so wrong that it needed an urgent rewrite.
And here it is.
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+96, -110)
",1.70198,-1.426433,-0.124731,-0.374219,-1.182894,0.756853,0.046665,-0.70058,-0.711155,0.077808,0.341688,0.528369,0.030584,0.265231,-0.483505
openstack/kolla-ansible,I164cdd41787f8bd52d8e08cb380d42625a8bbd84,1,0,0.8793,2.3979,0.2,2,11.5,182,0,Bug Fix,0,0,0,58,0.023052,0.0,0,0.0,4,2,0,0.8182,0.971,3.0,48.03,15.03,0,0,0.0,1,16.5455,0,0,0,0,0,"Use mariadb_tag as default for all mariadb tags

This allows one variable to specify the tag for all MariaDB images.

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/mariadb/defaults/main.yml (+2, -2)
releasenotes/notes/mariadb-tag-6f08b8d5874c9106.yaml (+6, -0)
",0.202899,-0.469697,-0.919376,0.626084,0.890745,0.098056,-0.72233,-0.158934,-0.128601,-0.058841,0.231611,0.089403,-0.524125,-0.160257,-0.39492
openstack/kolla,I9704e5371a410cb1f69ec0367174e2b368961dc1,1,1,0.8082,3.0445,0.0,2,11.0,304,0,Bug Fix,0,0,0,73,0.018011,0.5714,0,0.4618,2,1,0,0.8,1.0,2.0,51.47,12.58,1,1,0.0,1,14.4762,0,6,0,13,0,"[debian] Use upstream MariaDB

This preserves the Debian-provided minor version - 10.5 in case
of Bullseye in Wallaby and Xena - and will be backported as
a fix to Victoria and Ussuri (where it will follow Buster and its
10.3).

Related-Bug: #1944410
[SEP]
FILES CHANGED:
releasenotes/notes/debian-mariadb-upstream-75e05cbdaa013abe.yaml (+10, -0)
kolla/template/repos.yaml (+10, -0)
",0.841491,-1.357917,-0.556071,-0.581715,-1.039984,0.239075,0.086915,0.883161,-0.375649,0.202204,0.033724,0.546202,-0.066407,-0.026775,0.065571
openstack/kolla-ansible,If96034e602bee3b3eea34a2656047355e1d17eec,1,1,0.9667,1.9459,0.0,3,15.0,311,0,Bug Fix,0,0,0,30,0.054446,0.6957,0,0.6725,4,3,0,0.8192,1.2516,2.67,-17.07,20.67,1,0,0.0,1,44.4286,0,6,0,10,0,"Add override timeout for openstack exporter

Add scrape_timeout option in
prometheus_openstack_exporter job in order
to avoid timeout for large Openstack environment.

Closes-Bug: #1903547
(cherry picked from commit 99680b56ef330a3cb44e58a12fcf67fdba328543)
[SEP]
FILES CHANGED:
releasenotes/notes/add-openstack-exporter-scrape-timeout-af5dcd5d988ae12b.yaml (+4, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+1, -0)
",-0.438927,-0.614904,-1.282234,-1.213431,0.846871,-0.047352,0.398391,0.228094,0.426119,-0.067764,0.027192,-0.395678,0.153602,-0.182885,0.215839
openstack/oslo.vmware,I072c64904298cf83cb113e402d85fb62626f39f7,1,0,1.0,1.9459,0.6667,1,4.28,1435,0,Doc,1,0,0,5,0.005952,0.0,0,0.0,2,1,0,0,0.0,2.0,-3.76,11.93,1,0,1.0,0,205.0,0,0,0,0,0,"Don't use 'requests.PreparedRequest'

We're using 'requests.PreparedRequest' in one place in the tests.
However, the requests docs have a warning that one shouldn't do this:

  Instances are generated from a Request object, and should not be
  instantiated manually; doing so may produce undesirable effects.

It seems we're now seeing just such an effect, as requests has started
attempting to do proxy-related things resulting in the following error:

    Traceback (most recent call last):
      File ""/usr/lib64/python3.6/unittest/mock.py"", line 1183, in patched
    return func(*args, **keywargs)
      File "".../oslo.vmware/oslo_vmware/tests/test_service.py"", line 518, in test_send_with_local_file_url
    resp = transport.session.send(request)
      File "".../oslo.vmware/.tox/py36/lib/python3.6/site-packages/requests/sessions.py"", line 636, in send
    kwargs.setdefault('proxies', self.rebuild_proxies(request, self.proxies))
      File "".../oslo.vmware/.tox/py36/lib/python3.6/site-packages/requests/sessions.py"", line 301, in rebuild_proxies
    if 'Proxy-Authorization' in headers:
    TypeError: argument of type 'NoneType' is not iterable

Do what we should have done from the beginning and use
'requests.Request.prepare' instead.

[1] https://docs.python-requests.org/en/master/api/#requests.PreparedRequest
[SEP]
FILES CHANGED:
oslo_vmware/tests/test_service.py (+2, -4)
",-3.896184,2.826412,3.506106,-0.620395,-0.325459,0.680027,-0.909064,-0.745618,-0.571851,-0.194489,-0.572654,-0.255318,-0.131302,0.272884,0.051328
openstack/kolla,Ib7b45ea6ca0a465ce075ac2f2a0e7b8006ee6190,1,0,1.0,2.7726,0.2667,2,7.5,134,0,Feature,0,0,0,7,0.077778,1.0,0,1.0,3,2,0,0.8017,0.8366,2.5,1.82,13.67,0,0,0.0,1,8.375,0,0,0,0,0,"Bump up Alertmanager version

Yoga deserves a newer version than one from 2019.
[SEP]
FILES CHANGED:
releasenotes/notes/bump-alertmanager-to-0.23-42e3e3894158d7d0.yaml (+4, -0)
docker/prometheus/prometheus-alertmanager/Dockerfile.j2 (+7, -4)
",1.840249,-0.343346,0.298204,0.022546,-0.194051,0.966291,0.269115,0.234357,-0.59312,0.283929,0.203791,0.613058,-0.734869,0.397296,0.701892
openstack/kolla-ansible,I1b2a82b57cb9884b6c3c3ad07f6449ae29042a3d,1,1,0.8108,2.7081,0.0,3,13.0,127,0,Bug Fix,0,0,0,74,0.018168,1.0,0,0.8108,6,2,0,0.8202,1.5567,4.0,30.95,20.58,1,0,0.0,1,8.4667,1,6,0,13,0,"Do not create haproxy and swift log dirs needlessly

Closes-Bug: #1945070
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1945070-965635387a8581f9.yaml (+6, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+4, -0)
ansible/roles/common/templates/fluentd.json.j2 (+4, -0)
",1.568639,-0.094008,-0.45701,-0.729059,-0.183139,0.549186,-0.500135,-0.13282,-0.422485,-0.5098,0.466945,-0.446031,0.374694,-0.256875,-0.071106
openstack/kolla-ansible,I1ff06162569c46c51847b4c31933861549787c65,1,0,0.8133,1.7918,1.0,1,3.2,223,0,Feature,0,0,0,75,0.018351,1.0,0,0.8133,4,1,0,0.8212,0.0,4.0,-34.35,16.28,1,1,0.0,0,37.1667,1,0,0,0,0,"[mariadb] Drop some old workaround

innodb_lock_schedule_algorithm setting is removed in MariaDB 10.6.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/811014
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+0, -5)
",-0.273166,2.005636,-1.072696,-0.358537,-0.802718,0.046492,-0.350221,0.1773,0.124024,-0.067784,-0.201615,-0.455992,-0.520033,-0.406621,0.089405
openstack/ironic,I42e555a1a01eb4124e3152669578f3403db83801,1,0,0,4.0254,0.0909,6,16.0,352,0,Feature,0,0,0,0,0.0,1.0,0,0.0,5,2,0,1.0,1.7612,3.17,39.02,12.23,0,0,0.7273,1,6.2857,0,0,0,0,0,"Ensure enable_netboot_fallback writes out pxe config on adopt.

without the ipxe config adopted nodes that would have needed
the fallback ipxe config to boot from disk will fail (as they
continuously attempt to network boot) and instead boot into
the discovery image.

Story: #2009259
Task: #43471
[SEP]
FILES CHANGED:
ironic/drivers/modules/pxe_base.py (+2, -1)
ironic/drivers/modules/agent.py (+3, -2)
releasenotes/notes/pxe-onadopt-7214eba4f5822e1a.yaml (+5, -0)
ironic/common/pxe_utils.py (+1, -1)
ironic/tests/unit/drivers/modules/test_agent.py (+4, -1)
ironic/tests/unit/common/test_pxe_utils.py (+35, -0)
",-0.212463,-1.514824,-0.48,0.276108,0.012714,0.007618,-0.052109,-0.390905,0.05155,-0.323754,-0.026932,-0.269749,0.03082,0.295278,0.033998
openstack/ironic,I780d8e88f9319dc37ab56309bddbfb6b5f3c9d13,1,0,0,3.9318,0.32,3,18.33,371,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,2,0,1.0,1.0856,4.0,43.64,16.06,1,0,0.74,1,7.2745,0,0,0,0,0,"Fix restricted allocation creation for old policy defaults

The logic for restricted allocation creation checks that the
user is not trying to create an allocation with an owner other
than themselves. However the logic as it stands will always fail,
as it does not check if the user actually set an allocation owner.
[SEP]
FILES CHANGED:
releasenotes/notes/restricted-allocation-creation-fix-a70dfcbcb9996602.yaml (+7, -0)
ironic/api/controllers/v1/allocation.py (+4, -2)
ironic/tests/unit/api/controllers/v1/test_allocation.py (+23, -14)
",-0.252629,-1.714755,0.122102,1.081397,0.082602,0.314557,0.415142,-1.001493,0.204084,0.338922,0.012671,0.248099,0.073265,-0.043539,0.045725
openstack/kayobe,Ieb6d6e4d491b4ceb44d5fe364f0da215ac303fe1,1,0,0.8814,4.625,0.0,2,7.5,168,0,CI,0,0,0,59,0.023357,1.0,0,0.8814,3,2,0,0.9344,0.774,2.5,-3.82,16.33,0,0,0.7723,0,1.6471,0,0,0,0,0,"CI: add host configure tests for firewalld

Follow up adding tests for Id60e25e129e323f3c07e702bb81a11efc530fb3e.
[SEP]
FILES CHANGED:
playbooks/kayobe-overcloud-host-configure-base/overrides.yml.j2 (+23, -0)
playbooks/kayobe-overcloud-host-configure-base/tests/test_overcloud_host_configure.py (+78, -0)
",0.885127,0.093453,-1.914764,-2.030629,1.527992,0.3611,0.799805,-0.355662,0.424374,-0.031348,-0.688497,0.420231,-0.201516,-0.337175,0.243818
openstack/kayobe,Ie572eda567782cc377767bd8d925145e2ad4bd61,1,0,0.8833,3.0445,0.5,1,12.25,339,0,Bug Fix,0,0,0,60,0.02284,0.0,0,0.0,2,1,0,0.9355,0.0,2.0,58.01,12.25,0,0,0.0,0,16.1429,0,0,0,0,0,"CI: always return host configure test results

Currently, the overcloud host configure test results are only returned
on success, when they are least useful. This is because the zuul_return
task is not reached when the test task fails. This change reorders the
tasks to fix the issue.
[SEP]
FILES CHANGED:
playbooks/kayobe-overcloud-host-configure-base/run.yml (+10, -10)
",0.411941,-2.023224,0.085465,0.449643,-0.310588,0.148184,0.239083,-0.526465,0.139169,-0.102018,-0.162003,0.006655,-0.153952,-0.011498,0.025291
openstack/ironic-python-agent,I68799980e67c05afe4ca68ca9733605dd166d54d,1,0,1.0,2.1972,0.125,2,20.33,375,0,Feature,0,0,0,3,0.008746,1.0,0,1.0,2,2,0,0.9091,0.8113,2.0,50.28,14.69,1,0,0.0,1,41.6667,0,0,0,0,0,"Assert EFI part UUID is not None before editing fstab

The EFI partition UUID may be None and this will break
the fstab editing. While this is not necessarily fatal when
instantiating a node, it creates an exception at the end of
bootloader installation, so only attempt to add a line to
fstab when the UUID is not None.
[SEP]
FILES CHANGED:
releasenotes/notes/fix_efi_uuid_fstab-f2edbee9bfbac64a.yaml (+6, -0)
ironic_python_agent/extensions/image.py (+1, -1)
",-0.192109,-1.020338,0.020397,1.17124,0.042223,0.392364,0.514508,-0.479253,0.327907,0.098555,0.441549,0.062555,0.127902,-0.028808,-0.104815
openstack/kolla,I2bf11d9c8d0e8e76bc79fab698decb4f6efc6096,1,0,0.8846,1.9459,0.1667,2,2.0,79,0,Feature,0,0,0,26,0.044828,0.5,0,0.4423,2,2,0,0.8034,0.9183,2.0,-6.69,14.13,1,0,0.0,1,11.2857,0,0,0,0,0,"gnocchi: update to 4.4.1
[SEP]
FILES CHANGED:
releasenotes/notes/gnocchi-4.4.1-1332afc3c6fca766.yaml (+4, -0)
kolla/common/config.py (+1, -1)
",2.508214,0.922509,0.900007,-0.358124,-0.245485,0.391603,-0.155477,0.374783,0.033011,1.625894,-0.43535,0.171942,-1.086947,0.706163,0.637707
openstack/ironic,I556f8c9efbc5ab0941513c3ecaa2aa3ca7f346ae,1,0,0,4.9836,0.2276,9,16.58,1405,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,5,4,0,1.0,2.9539,3.33,33.98,15.08,1,0,0.2759,1,9.6233,0,0,0,0,0,"Fix various issues in the anaconda deploy interface

The kickstart template expects a dictionary with 'ks_options'
as the key. Instead build_kickstart_config_options function
returns a dict with keys 'liveimg_url', 'agent_token' and
'heartbeat_url'.

This change fixes this problem by returning a dictionary of
dict with 'ks_options' as key and the dictionary with
keys 'liveimg_url', 'agent_token' and heartbeat_url' as
value.

Fix a bug where the deploy() method of anaconda deploy
interface where it did not return states.DEPLOYWAIT instead
it returned 'None' which caused the instance to go straight to
'active' instead of 'wait call-back'.

Fix issues in the default kickstart template where heartbeat was
missing 'callback_url' parameter and the HTTP method should be
'POST' not 'PUT'.

Fix issues with automated cleaning when anaconda deploy interface
is used.

Anaconda deploy interface could not deploy tarballs as
the disk image sent to the anaconda interface via liveimg --url
kickstart command does not include any file extension. When
no file extension is present the kickstart command liveimg --url
assumes the disk is a mountable partiton image. We fix this
problem by enabling the user to specify file extensions using
a glance image property named 'disk_file_extension' on the OS
image.

Co-Authored-By: Ruby Loo <opensrloo@gmail.com>
[SEP]
FILES CHANGED:
doc/source/admin/anaconda-deploy-interface.rst (+21, -7)
ironic/drivers/modules/deploy_utils.py (+21, -1)
ironic/drivers/modules/pxe.py (+6, -2)
ironic/tests/unit/drivers/modules/test_pxe.py (+18, -3)
ironic/drivers/modules/ks.cfg.template (+6, -6)
ironic/common/pxe_utils.py (+5, -5)
releasenotes/notes/fix-anaconda-deploy-interface-bfa2cfca22b04680.yaml (+25, -0)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+1, -1)
ironic/tests/unit/common/test_pxe_utils.py (+9, -8)
",-3.722094,0.521388,3.784212,-0.441122,0.276916,0.351049,-0.722096,-0.399048,0.027664,-0.610349,-0.210573,0.256737,-0.170481,0.280881,0.099374
openstack/magnum,Ia6a848eae11bc38ff71ef4575247010a8ffaa47b,1,0,1.0,1.6094,0.5,2,15.33,392,0,Bug Fix,0,0,0,1,0.25,1.0,0,1.0,6,1,0,0.8571,1.0,5.5,16.55,19.18,1,1,0.0,0,78.4,0,0,0,0,0,"[fix] Detect virtio-scsi volumes correctly

When the Cinder volume is presented as a virtio-scsi volume, the
device_name detection fails. This change allows the device name to be
retrieved correctly for both virtio-pci and virtio-scsi cases.

Story: 2008618
Task: 41808
(cherry picked from commit 68e6c0e48ddeab37af43b9ef553ddefaf1e54d8c)
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/fragments/configure-docker-storage.sh (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/configure-etcd.sh (+1, -1)
",-1.727233,-0.379382,-0.890663,-0.651122,0.782438,-0.266087,0.672599,0.153264,0.125937,0.166292,0.531476,0.048616,0.363368,-0.023197,-0.332886
openstack/kolla-ansible,I449d4c2073d4e3953e9f09725577d2e1c9d563c9,1,1,0.8158,2.6391,0.0,2,16.5,808,0,Bug Fix,0,0,0,76,0.018573,0.3333,0,0.2719,4,2,0,0.8222,0.9957,3.0,61.26,12.05,1,1,0.0,1,57.7143,0,6,0,10,0,"[mariadb] Start new nodes serially

There seems to be a bug in Galera that causes
TASK [mariadb : Check MariaDB service WSREP sync status]
to fail.
One (in case of 3-node cluster) or more (possible with
more-than-3-node clusters) nodes may ""lose the race"" and get stuck
in the ""initialized"" state of WSREP.
This is entirely random as is the case with most race issues.
MariaDB service restart on that node will fix the situation but
it's unwieldy.
The above may happen because Kolla Ansible starts and waits for
all new nodes at once.
This did not bother the old galera (galera 3) which figured out
the ordering for itself and let each node join the cluster properly.
The proposed workaround is to start and wait for nodes serially.

Closes-Bug: #1947485
[SEP]
FILES CHANGED:
ansible/roles/mariadb/handlers/main.yml (+6, -0)
releasenotes/notes/bug-1947485-d059864252fb1813.yaml (+7, -0)
",-1.8913,-1.074335,2.10428,-0.506388,-0.580856,0.147865,0.340297,-0.203144,-0.158456,-0.150083,0.519194,0.202632,0.135825,-0.084266,-0.084622
openstack/ironic,I2aa1230468132c2b7a8585d691ec180947f89c1e,1,0,0.9286,3.4012,0.0345,3,8.17,357,0,Bug Fix,0,0,0,14,0.011032,0.0,0,0.0,5,2,0,1.0,1.0057,3.33,51.79,10.61,1,0,0.7586,1,11.9,0,0,0,0,0,"Do not use any parts of image URL in temporary file names

We currently use the last component, which is:
a) a potential information exposure,
b) can hit file name length limits [1]

Use the master path file name instead, which is always a UUID.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=2014630
[SEP]
FILES CHANGED:
ironic/drivers/modules/image_cache.py (+1, -1)
ironic/tests/unit/drivers/modules/test_image_cache.py (+22, -0)
releasenotes/notes/image-cache-size-28a9072901b98edf.yaml (+5, -0)
",-0.246122,-0.303256,0.056598,0.205044,-1.010482,0.091226,0.737166,-0.278895,0.371133,0.706506,-0.184607,-0.503394,0.248551,0.17804,-0.401297
openstack/kolla-ansible,I08be074c3633cc4fb0a0bc6c9cb8d03eb5226d89,1,1,0.8889,4.8442,0.8889,7,3.5,108,0,Bug Fix,0,0,0,27,0.046075,1.0,0,0.8889,4,3,0,0.8232,1.8033,3.43,-26.35,24.26,0,0,0.0,1,0.8504,0,6,0,18,0,"mariadb: Remove wsrep-notify.sh

Closes-Bug: #1947534
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+0, -3)
ansible/roles/mariadb/templates/wsrep-notify.sh.j2 (+0, -79)
releasenotes/notes/bug-1947534-bf3b5ed19473015f.yaml (+5, -0)
releasenotes/notes/remove-wsrep-notify-dbb5ef5f700b06b1.yaml (+5, -0)
ansible/roles/mariadb/templates/mariadb.json.j2 (+1, -7)
ansible/roles/mariadb/defaults/main.yml (+3, -3)
ansible/roles/mariadb/tasks/config.yml (+0, -20)
",2.550776,0.579658,-0.34296,-1.421889,-1.046371,0.220412,-0.404362,0.083522,0.020297,-0.199998,0.776012,-0.143449,-0.461979,0.089574,0.142175
openstack/kolla,I645f5d04ff2be3a5857765e901eccfe0b56ff199,1,0,0.8929,2.9957,0.4737,4,13.0,126,0,Feature,0,0,0,28,0.039326,0.8,0,0.7143,3,4,0,0.8051,1.8474,2.25,11.42,20.58,0,0,0.0,1,6.3,0,0,0,0,0,"ovn: Add Debian x86 images

aarch64 still has no installation candidate
[SEP]
FILES CHANGED:
kolla/image/build.py (+4, -1)
doc/source/matrix_x86.csv (+1, -1)
docker/ovn/ovn-base/Dockerfile.j2 (+1, -7)
releasenotes/notes/ovn-debian-x86-d584f88b9e94b226.yaml (+4, -0)
",3.162263,-0.733077,0.866888,-0.803247,-0.266821,0.072338,0.35059,0.196674,-0.534255,0.050094,-0.31832,0.133145,0.008965,0.140699,-0.227456
openstack/kolla-ansible,Id634426a1961f0b883068e4ed80e7d1633e5708e,1,0,0.8182,4.2767,0.9437,4,4.0,98,0,Feature,0,0,0,77,0.018758,1.0,0,0.8182,4,3,0,0.8242,1.3081,3.5,-19.3,21.6,1,0,0.0,1,1.3611,0,0,0,0,0,"Drop enable_host_ntp

As promised for Xena.
[SEP]
FILES CHANGED:
doc/source/reference/deployment-and-bootstrapping/bootstrap-servers.rst (+0, -11)
ansible/roles/baremetal/defaults/main.yml (+0, -6)
ansible/roles/baremetal/tasks/post-install.yml (+0, -50)
releasenotes/notes/drop-enable_host_ntp-ce6e60a46e7544ea.yaml (+4, -0)
",2.359442,-0.069693,-0.192297,-0.069414,-0.187205,0.641354,-0.843409,0.263025,0.163636,-0.288558,0.59451,-0.220822,-1.101439,-0.069029,-0.376953
openstack/kolla-ansible,Id046a3048436c4c18dd1fd9700ac9971d8c42c57,1,0,0.8852,3.3322,0.5926,2,6.67,223,0,Feature,0,1,0,61,0.023045,0.0,0,0.0,4,2,0,0.8251,0.9751,3.0,18.18,14.67,1,0,0.0,1,7.9643,0,0,0,0,0,"Revert ""Do not load br_netfilter""

This reverts commit 15259002beb6b9f35f8eee6529132c6e1a126902.

Reason for revert: The iptables_firewall produces warnings without it.
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1945789-cfb50a9bd8693c41.yaml (+0, -16)
ansible/roles/nova-cell/tasks/config-host.yml (+11, -0)
",0.670614,-0.32868,-1.770692,-1.674234,0.546597,0.402685,1.011159,-0.333242,0.420242,-0.221988,0.057612,0.093936,-0.614809,-0.030478,-0.131811
openstack/kolla-ansible,I2a5871ccd4e8198171ef3239ce95f475f3e4b051,1,1,0.8871,1.9459,0.0,2,16.0,631,0,Bug Fix,0,0,0,62,0.023186,1.0,0,0.8871,4,1,0,0.8261,0.9183,2.5,53.12,13.48,1,0,0.0,0,90.1429,0,6,0,19,0,"nova: use any_errors_fatal for once-per-cell tasks

We run some nova tasks once per cell, using a condition to match a
single host in the cell. In other similar tasks, we use run_once, which
will fail all hosts if the task fails. Typically these tasks are
critical, and that is desirable. However, with the approach used in
nova-cell to support multiple cells, if a once-per-cell task fails, then
other hosts will continue to execute, which could lead to unexpected
results.

This change adds any_errors_fatal to the plays or blocks that run these
tasks.

Closes-Bug: #1948694
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/discover_computes.yml (+2, -0)
ansible/nova.yml (+4, -0)
",-1.664387,-0.962375,0.765058,0.347406,-0.077431,-0.080016,0.094365,-0.514074,0.169245,0.067898,0.3351,0.181371,0.261019,-0.170298,0.156672
openstack/kayobe,Ic337c6fe61343f1ba15f977f13e88c3bd9d5ec18,1,0,0.9677,1.0986,0.5,1,8.0,86,0,Bug Fix,0,0,0,31,0.055655,0.0,0,0.0,2,1,0,0.9365,0.0,2.0,29.52,13.2,0,0,0.0,1,28.6667,0,0,0,0,0,"Fix link syntax in release note
[SEP]
FILES CHANGED:
releasenotes/notes/add-support-for-custom-seed-vms-a938ffdbedcd7b14.yaml (+1, -1)
",4.208527,1.233865,2.165372,0.242314,0.214007,0.308182,1.237974,-0.120119,0.775354,0.042707,0.208453,-0.677718,0.681446,0.061442,-0.036488
openstack/kolla,I094c8559726d1068b65366ff86732881d3be5929,0,0,0.625,1.9459,0.1667,1,14.67,306,0,CI,1,0,0,40,0.023923,0.75,0,0.4688,1,1,0,0.8067,0.0,1.0,51.59,13.14,1,0,1.0,0,43.7143,0,0,0,0,0,"CI: make Debian source jobs voting

We have Debian support for quite a while. While binary target is not
always up-to-date (due to Debian OpenStack team policy of building only
released code, not git snapshots) source images are expected to just
work.
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+5, -1)
",0.66384,-1.858745,-0.116877,0.058827,-0.472024,-0.221389,0.03206,-0.124253,-0.911902,0.195525,-0.660413,0.245969,0.274853,-0.111199,-0.09919
openstack/kolla,I78da7eb2b6b5eae2b04fd95b24615bd4a572a1d6,1,1,0.8966,2.1972,0.125,2,7.33,216,0,Bug Fix,0,0,0,29,0.039672,1.0,0,0.8966,3,2,0,0.8,0.9544,2.5,-12.11,13.84,0,0,0.0,1,24.0,0,6,0,14,0,"neutron: Use update-alternatives --display instead of --query

--query is not supported before update-alternatives 1.15
and CentOS uses 1.13

Closes-Bug: #1936947
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1936947-8beac926823cdf8f.yaml (+5, -0)
docker/neutron/neutron-base/extend_start.sh (+2, -1)
",-0.124857,-0.245629,-0.983205,-0.101753,-0.182156,-0.097081,-1.060904,0.19889,-0.642407,0.425794,-0.031376,0.121571,0.095214,0.16697,0.446199
openstack/ironic-python-agent,Ib61a7100a059e79a8b0901fd8f46b9bc41d657dc,1,0,1.0,4.3307,0.32,3,16.0,849,0,Feature,0,0,0,10,0.012887,1.0,0,1.0,4,2,0,0.9167,1.322,2.67,29.7,14.97,0,0,0.4667,1,11.1711,0,0,0,0,0,"Delete EFI boot entry duplicate labels first

Some firmware seems to take an objection with EFI nvram
entries being deleted after one is added, resulting in the
entire entry table being reset to the last known good state.

This is problematic, as ultimately deployments can time out
if we previously booted with Networking, and the machine, while
commanded to do other wise, reboots back to networking regardless.

We will now delete entries first, before proceeding.

Additionally, for general use, this pattern may serve the
community better by avoiding cases where we would have
previously just relied upon efibootmgr[0] to warn us of duplicate
entries.

[0]: https://github.com/rhboot/efibootmgr/blob/103aa22ece98f09fe3ea2a0c83988f0ee2d0e5a8/src/efibootmgr.c#L228

Story: 2009649
Task: 43808
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+26, -9)
ironic_python_agent/extensions/image.py (+19, -15)
releasenotes/notes/de-duplicate-by-label-baa090c5b1bff992.yaml (+6, -0)
",-2.76068,-0.06459,1.970573,-0.918081,-0.167342,0.112998,0.437435,-0.073131,0.066436,-0.12219,-0.163099,-0.111492,-0.102946,-0.156512,0.016995
openstack/octavia,I48b0f5a773209b1c1b056d71c0da05d6fd82ca73,1,0,0.6719,6.0088,0.8867,11,24.4,758,0,Bug Fix,0,0,0,64,0.006551,0.8,0,0.5375,7,2,0,0.54,2.8771,5.64,41.3,15.01,0,0,0.6108,1,1.8624,0,0,0,0,0,"Fix LB set in ERROR too early in the revert flow

When an error occurs in a flow, the provisioning status of the load
balancer should be set to ERROR in the revert method of the first task
of the flow. This update acts as an unlock of the LB object and cannot
occur in any other revert method because the API might consider the LB
as mutable before finishing a task/flow.

Remove all occurrences of mark_loadbalancer_prov_status_error calls in
revert method of tasks that are not specifically designed for unlocking
the load balancers. Add a LoadBalancerToErrorOnRevertTask task in the
amphora failover flow to prevent a LB to be in an immutable state.

Story 2009651
Task 43810
Story 2009652
Task 43811
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+11, -82)
octavia/tests/unit/controller/worker/v2/flows/test_amphora_flows.py (+2, -1)
octavia/controller/worker/v1/tasks/database_tasks.py (+3, -43)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+0, -10)
octavia/controller/worker/v2/tasks/database_tasks.py (+5, -76)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+8, -70)
releasenotes/notes/fix-provisioning-status-on-errors-7f3736ef6e94d453.yaml (+9, -0)
octavia/controller/worker/v2/flows/amphora_flows.py (+4, -0)
octavia/controller/worker/v1/tasks/amphora_driver_tasks.py (+0, -8)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+2, -35)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+2, -35)
",-2.038927,-1.027819,1.411835,0.252632,0.24232,0.342876,0.108463,0.003998,0.828778,-0.194214,0.310175,0.471662,-0.295137,-0.084541,0.222332
openstack/ironic-python-agent,I3486aa8c3331e56543eebc166e0543d7d2289b9a,0,0,1.0,4.2341,0.3382,3,17.0,438,0,Bug Fix,0,0,0,4,0.011396,1.0,0,1.0,4,2,0,0.9231,0.4879,2.67,55.22,13.27,1,0,0.9118,1,6.3478,0,0,0,0,0,"Add blockdev to re-read the partition table

Re-reading the partition table can require an ioctl system call.
Add a call to blockdev to issue one.

This should fix an timing issue where the bootloader installation
fails to mount the EFI partition from a whole disk image since it
is not yet aware of the new partitions (observed with both, the
iscsi and the direct deploy interface).
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+39, -23)
ironic_python_agent/extensions/image.py (+1, -0)
releasenotes/notes/fix-rescan-device-12e473be5c9616db.yaml (+5, -0)
",-0.529887,-1.797583,0.290049,0.782849,-0.272365,-0.179634,0.491831,-0.050112,0.170944,0.008913,0.003739,0.087507,0.154335,0.159203,0.171442
openstack/kolla-ansible,I211d9063742dfef202cf39c29c75a0ce3fefe510,0,0,0.5,1.0986,0.5,1,6.2,307,0,Bug Fix,0,0,0,2,0.133333,1.0,0,0.5,4,1,0,0.827,0.0,4.0,-4.14,15.38,1,0,0.0,0,102.3333,0,0,0,0,0,"Fix freezer config template

The openstack_auth.domain_name variable is no longer being defined, the
domain_name for the keystone_admin_project is hardcoded to ""Default"" by
keystone-manage bootstrap.
[SEP]
FILES CHANGED:
ansible/roles/freezer/templates/freezer.conf.j2 (+1, -1)
",0.042189,-0.66567,-0.54846,0.373978,0.361358,-0.461573,-0.242076,0.156018,0.186482,-0.746909,-0.166283,-0.090111,-1.044818,0.304699,0.124287
openstack/kolla-ansible,Ibe51db5060e8d809539f5e929a65f285e0f7d343,1,1,0,4.0604,0.4912,3,4.25,244,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,3,2,0,0.8226,1.3271,2.67,-71.18,18.17,1,0,0.0,0,4.2069,0,8,0,30,0,"docs: Get release name dynamically

Address comments in https://review.opendev.org/c/openstack/kolla-ansible/+/815043

Related-Bug: #1844710
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+2, -6)
doc/source/conf.py (+7, -7)
doc/source/user/operating-kolla.rst (+20, -15)
",0.833049,2.525622,-1.36401,-0.796272,-1.604106,0.362517,-0.239299,-0.044161,0.232238,-0.505239,-0.662488,-0.122928,-0.097364,-0.22573,-0.051039
openstack/ironic-python-agent,I1f67b0fb1f645fa82e98bd7c7bba3ffc7755cc74,1,0,1.0,4.4067,0.0741,3,25.67,486,0,Bug Fix,0,0,0,11,0.012926,0.875,0,0.875,4,2,0,0.8571,0.5882,2.67,36.85,16.5,0,0,0.8889,1,5.9268,0,0,0,0,0,"Fix UEFI record regex

I accidently put colons on the test data and remembered taking the
colon character out of the regex I was working on, but apparently
left it in, and accounted for the active entry indicator flag
which appears to have inconsistent support across vendors.

The regex has been fixed, and a test added from a Lenovo SR650
which has some additional string entry data in the UEFI output
which may separate entries.
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+67, -5)
ironic_python_agent/extensions/image.py (+1, -1)
releasenotes/notes/correct-uefi-regex-112211c2427cd4d9.yaml (+7, -0)
",-0.452116,-2.656528,0.059418,0.039081,-0.523737,0.028339,0.156173,-0.381603,-0.286393,0.362696,0.07316,-0.199719,0.300073,0.196334,0.248642
openstack/octavia,Iecd466130ef3941481b4ad79ff6fa60efbd0e5ad,1,0,0.6769,2.6391,0.4615,1,11.33,248,0,Bug Fix,0,0,0,65,0.006388,0.6,0,0.4062,2,1,0,0.5418,0.0,2.0,46.04,13.95,0,0,0.0,0,17.7143,0,0,0,0,0,"Fix job book deletion issue in taskflow

Some jobs unattached to a book might have been scheduled in taskflow,
triggering an error. On completion, skip the logbook deletion if it
doesn't exist.
[SEP]
FILES CHANGED:
octavia/common/base_taskflow.py (+7, -6)
",0.575838,-1.329535,-0.053212,0.850875,-0.142427,0.136904,0.382986,-0.759784,0.304224,-0.13291,-0.034921,0.425361,0.051169,0.304121,0.073158
openstack/ironic-python-agent,If5da3075e813ae01df3decf8f0647aba111b0515,1,0,0.8,3.6889,0.4359,3,20.33,403,0,Bug Fix,0,0,0,5,0.011933,0.8889,0,0.7111,4,2,0,0.8667,0.8339,2.67,51.67,14.69,1,0,0.8205,1,10.075,0,0,0,0,0,"Re-read the partition table with partx -a

Re-read the partition table with 'partx -a', rather than 'partx -u'.

This should fix an timing issue where the bootloader installation
fails to mount the EFI partition from a whole disk image since it
is not yet aware of the new partitions (observed with both, the
iscsi and the direct deploy interface).
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+16, -16)
ironic_python_agent/extensions/image.py (+1, -1)
releasenotes/notes/fix-rescan-device-7b00c6836b687ce8.yaml (+5, -0)
",-0.666332,-1.561812,-0.05434,0.824479,0.218442,-0.354991,0.155913,-0.117739,0.020387,-0.007293,-0.118057,0.222424,0.173478,0.323684,0.201365
openstack/tooz,Ibca3f568b65dfea252da4b67f6d5105ba7f1ecb1,1,0,0,4.3567,0.4675,2,31.0,315,0,CI,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.75,0.3467,2.0,-7.48,22.72,1,0,0.0,1,4.0385,0,0,0,0,0,"Enable retries in redis driver

this is followup to Iaab5ce609c0dcf7085f5dd43efbd37eb4b88f17b

actually retry for specified number of retries instead of raising
error on first ConnectionError

(cherry picked from commit 47c4d56e446a49726e7145c6cbc3bb7620a431f7)
[SEP]
FILES CHANGED:
releasenotes/notes/redis-connect-retries-c9adfc81eb06a4ab.yaml (+5, -0)
tooz/drivers/redis.py (+36, -36)
",-2.179774,-0.746613,-1.035269,-2.084647,1.817083,0.069133,1.215096,-0.272495,0.185379,0.550124,0.043533,0.140965,0.271325,0.00783,-0.083914
openstack/kolla-ansible,Iaa3fc69ee7954b5b202b0a6052c30bfb1780e84b,1,1,0.5,2.0794,0.1429,2,8.5,159,0,Bug Fix,0,0,0,12,0.004157,0.5,0,0.25,4,2,0,0.8235,0.8631,3.0,29.01,17.52,1,0,0.0,1,19.875,0,12,0,15,0,"Fix octavia doesn't set subnet gateway_ip

the gateway_ip should be in subnet dict.

Closes-Bug: #1949260
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1949260-34d82ecd677dd8ff.yaml (+5, -0)
ansible/roles/octavia/tasks/prepare.yml (+1, -1)
",1.603443,-0.148062,-0.183368,-0.304776,-0.011226,0.37887,-0.281729,-0.341777,0.027812,-0.518441,0.362909,-0.472264,-0.148119,0.204949,0.139147
openstack/oslo.messaging,Ife62a7d76022908f0dc6a77f1ad607cb2fbd3e8f,1,1,0,1.3863,0.3333,1,12.24,1504,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0.3889,0.0,3.0,34.16,14.89,1,0,0.0,0,376.0,0,6,0,10,0,"amqp1: fix race when reconnecting

Currently this is how reconnect works:

- pyngus detects failure and invokes callback
  Controller.connection_failed() which in turn calls
  Controller._handle_connection_loss()

- The first thing that _handle_connection_loss does is to set
  self.addresser to None (important later)

- Then it defers _do_reconnect after a delay (normally 1 second)

- (1 second passes)

- _do_reconnect calls _hard_reset which resets the controller state

However, there is a race here.  This can happen:

- The above, up until it defers and waits for 1 second

- Controller.send() is invoked on a task

- A new Sender is created, and critically because self.reply_link
  still exists and is active, we call sender.attach and pass in
  self.addresser.  Remember _handle_connection_loss sets
  self.addresser to None.

- Eventually Sender.attach throws an AttributeError because it
  attempts to call addresser.resolve() but addresser is None

The reason this happens is because although the connection is dead,
the controller state is still half-alive because _hard_reset hasn't
been called yet since it's deferred one second in _do_reconnect.

The fix here is to move _hard_reset out of _do_reconnect and directly
into _handle_connection_loss.  The eventloop is woken up immediately
to process _hard_reset but _do_reconnect is still deferred as before
so as to retain the desired reconnect backoff behavior.

Closes-Bug: #1941652
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/amqp1_driver/controller.py (+2, -1)
",-3.341007,0.181238,4.003474,-1.127412,-0.315416,0.768145,-1.102247,-1.203506,-0.583197,-0.363917,-0.188396,-0.122064,-0.126107,0.281904,0.225308
openstack/octavia,I876fd91fb40d9250381bbb37f8148b53692a7d8d,1,0,0.6818,3.5553,0.0588,6,18.67,367,0,Bug Fix,0,0,0,66,0.006478,0.6667,0,0.4545,7,2,0,0.5437,2.5136,4.83,45.88,17.47,0,0,0.5882,1,10.4857,0,0,0,0,0,"Fix PortNotFound exception when updating a LB after a failover

The ApplyQos task applied the qos policy on the VRRP ports of all the
amphorae linked to a load balancer, including amphorae in DELETED
status. It triggered an ERROR when updating a LB (with a qos policy)
after a failover.

Story 2009667
Task 43894
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+7, -1)
octavia/tests/unit/controller/worker/v1/tasks/test_network_tasks.py (+7, -1)
octavia/controller/worker/v2/tasks/network_tasks.py (+4, -0)
octavia/controller/worker/v1/tasks/network_tasks.py (+4, -0)
releasenotes/notes/fix-qos-apply-after-failover-561abbd153ab88ee.yaml (+6, -0)
octavia/tests/common/constants.py (+4, -0)
",-0.662832,-1.330123,-0.51907,0.372961,0.334123,0.374577,-0.144519,0.185934,0.490918,-0.131647,0.235246,0.266361,0.073981,0.112427,-0.103461
openstack/octavia,I3859c7fcefc89e91fdaecd139143e6a74d8b3c1b,1,0,0.6866,4.804,0.3636,3,6.12,414,0,Bug Fix,0,0,0,67,0.006554,0.125,0,0.0858,4,2,0,0.5455,0.9182,2.67,19.33,13.06,0,0,0.1653,1,3.3934,0,0,0,0,0,"Fix serialization of lists in data_models.to_dict

data_models.to_dict didn't convert values inside lists.
When serializing TLSContainer, the intermediates list that contains
bytes types wasn't converted properly.

to_dict now converts the items of a list recursively.

Add a test that checks if TLSContainer.to_dict is serializable.

Story 2009310
Task 43699
[SEP]
FILES CHANGED:
octavia/common/data_models.py (+51, -44)
octavia/tests/unit/common/test_data_models.py (+20, -0)
releasenotes/notes/fix-tls-container-serialization-1cb83ad4c9eca3b8.yaml (+6, -0)
",-1.150093,-1.189032,-0.122777,0.333545,0.150151,0.028931,-0.551294,-0.237239,-0.01582,0.262575,-0.07374,-0.835037,-0.186921,0.202342,-0.114509
openstack/kolla-ansible,I81d2dae0f8f4d0d4c6e359e1d7d954d6e190b742,1,0,0.8889,1.7918,0.8,1,11.5,185,0,Doc,0,0,0,63,0.023507,0.6667,1,0.5926,3,1,0,0.8245,0.0,3.0,44.35,13.3,0,0,0.0,0,30.8333,0,0,0,0,0,"docs: stop installing kolla in quickstart

We don't need kolla to use kolla-ansible, and installing it makes the
start less quick.
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+1, -4)
",2.134666,0.405894,-0.468792,0.442518,-0.243597,-0.061192,0.585327,-0.971961,-1.352654,-0.028523,0.210769,0.183045,-0.068112,-0.353338,0.33069
openstack/ironic-lib,I10a52c16ebe4e519d0af63b36c3a89fd5d371319,1,0,1.0,2.7081,0.3571,3,10.25,303,0,Feature,0,0,0,1,0.013889,1.0,0,1.0,2,2,0,1.0,1.5774,1.67,43.74,9.95,1,0,0.3571,1,20.2,0,0,0,0,0,"Restore blkid compatibility with Centos 7

The blkid version included in util-linux 2.23.2 does not allow long
options name for probe and match-tag.
Use the short single letter name to restore compatibility with Centos 7

Story: 2009328
Task: 43764
[SEP]
FILES CHANGED:
releasenotes/notes/restore-centos7-compatibility-bfbe2bcf1d1fb7f0.yaml (+5, -0)
ironic_lib/tests/test_disk_utils.py (+2, -3)
ironic_lib/disk_utils.py (+2, -2)
",0.743693,-0.661767,-0.478458,-0.104534,-0.279096,0.123862,0.106432,0.396808,0.030936,0.094471,0.05259,0.167982,-0.01599,0.175138,0.19771
openstack/kayobe,I5df2918035df7577627fd2bd68417beddbcbf848,1,0,0.8906,2.1972,0.5,4,10.0,226,0,Bug Fix,0,0,0,64,0.023836,1.0,0,0.8906,1,1,0,0.9375,2.0,1.0,75.43,6.67,0,0,0.0,0,25.1111,0,0,0,0,0,"Infra VMs: fix some playbook host patterns

The infra-vms group was not added to some playbook host patterns where
it should have been. This change fixes that.

TrivialFix
[SEP]
FILES CHANGED:
ansible/apt.yml (+1, -1)
ansible/wipe-disks.yml (+1, -1)
ansible/kayobe-ansible-user.yml (+1, -1)
ansible/network-connectivity.yml (+1, -1)
",0.042175,-1.059349,-0.400463,0.414035,0.080544,0.164336,-0.770586,-0.536284,-0.242942,-0.039604,-0.04577,-0.083197,0.11519,0.281162,-0.022242
openstack/kayobe,Icfc5cbc80af1199ad00f78292c6228273af701aa,1,0,1.0,3.091,0.0,1,24.0,212,0,Doc,0,0,0,4,0.190476,0.0,1,0.0,4,1,0,0.9385,0.0,4.0,37.95,17.93,0,0,0.0,0,9.6364,0,0,0,0,0,"docs: update switch list to include arista eos

The support was added in this commit, but the docs were not updated:
c6263dbfd4dfbac5f53a4fdd94b154811fbd0af6
[SEP]
FILES CHANGED:
doc/source/configuration/reference/physical-network.rst (+21, -0)
",0.735232,-0.718794,-1.695826,-1.547818,0.815939,0.113041,1.473361,-0.340819,0.310634,-0.016155,-0.57967,0.192456,-0.14941,-0.136993,0.011746
openstack/tooz,Ibca3f568b65dfea252da4b67f6d5105ba7f1ecb1,1,0,1.0,4.3567,0.4675,2,36.0,384,0,CI,0,0,0,1,0.012821,1.0,0,1.0,2,2,0,0.7778,0.3467,2.0,-17.7,24.4,1,0,0.0,1,4.9231,0,0,0,0,0,"Enable retries in redis driver

this is followup to Iaab5ce609c0dcf7085f5dd43efbd37eb4b88f17b

actually retry for specified number of retries instead of raising
error on first ConnectionError

(cherry picked from commit 47c4d56e446a49726e7145c6cbc3bb7620a431f7)
(cherry picked from commit 11526e594c7e7cef8b5a4a4220f100d76a418036)
[SEP]
FILES CHANGED:
releasenotes/notes/redis-connect-retries-c9adfc81eb06a4ab.yaml (+5, -0)
tooz/drivers/redis.py (+36, -36)
",-2.179774,-0.746613,-1.035269,-2.084647,1.817083,0.069133,1.215096,-0.272495,0.185379,0.550124,0.043533,0.140965,0.271325,0.00783,-0.083914
openstack/octavia,I7692155fb113442b692267ab12b69ab90200bcb5,1,0,0.6912,4.3175,1.0,4,29.0,469,0,Bug Fix,0,0,0,68,0.006574,0.75,0,0.5184,7,1,0,0.5472,1.5714,6.0,12.58,18.5,0,0,0.8649,0,6.2533,0,0,0,0,0,"Fix LB set in ERROR too early in MapLoadbalancerToAmphora

This is a follow up patch for I48b0f5a773209b1c1b056d71c0da05d6fd82ca73,
this fix applies only on Wallaby and older releases because the code was
removed during the Xena cycle.

It removes calls to mark_loadbalancer_prov_status_error in revert method
of tasks (except in LoadBalancer*ToErrorOnRevertTask)

Story 2009651
Task 43810
Story 2009652
Task 43811
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+0, -32)
octavia/controller/worker/v1/tasks/database_tasks.py (+0, -5)
octavia/controller/worker/v2/tasks/database_tasks.py (+0, -5)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+0, -32)
",-1.501961,-1.260878,-0.439907,-1.219933,0.551429,0.305168,0.136926,0.268785,0.337345,-0.01581,0.285949,0.126303,-0.438857,0.106357,0.078109
openstack/octavia,I59664615e1ef5e46a99c12256dbe02f89ecf4c0b,1,0,0.5385,2.0794,0.1429,2,23.0,212,0,Bug Fix,0,0,0,13,0.004492,0.6,0,0.3231,5,2,0,0.549,0.8631,3.5,-0.42,19.63,0,0,0.0,1,26.5,0,0,0,0,0,"Fix update listener certs doesn't work

This change fixes listener update sni-container-refs
doesn't work by adding O_TRUNC flag to upload_certificate method
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/loadbalancer.py (+1, -1)
releasenotes/notes/fix-listener-update-certs-failed-315c66f4806e76c8.yaml (+5, -0)
",1.186025,-1.058815,-0.082645,-0.044143,0.301358,-0.513706,0.085199,-0.352623,-0.344595,-0.711274,0.017929,-0.698052,0.11304,0.217726,0.251649
openstack/kolla,I748fb3fa259303a89ef2615a37299360bcf11545,1,0,0.6098,3.091,0.5238,8,8.0,90,0,Feature,0,0,0,41,0.024434,1.0,0,0.6098,2,1,0,0.8017,2.8559,2.0,-2.21,13.2,0,0,0.0,1,4.0909,0,0,0,0,0,"reno: polish release notes for Xena
[SEP]
FILES CHANGED:
releasenotes/notes/debian-bullseye-4fedf3b3638783de.yaml (+3, -3)
releasenotes/notes/deprecate-ppc64le-2b7b642e79bddd66.yaml (+1, -1)
releasenotes/notes/bug-1934753-98ec4951a0f7373b.yaml (+1, -1)
releasenotes/notes/deprecate-tempest-and-rally-0647efa7209cf03a.yaml (+1, -2)
releasenotes/notes/add-masakari-dashboard-eae5f216888e5fe0.yaml (+1, -1)
releasenotes/notes/bug-1933770-c08c6804aa5d9e61.yaml (+1, -1)
releasenotes/notes/ovn-debian-x86-d584f88b9e94b226.yaml (+1, -1)
releasenotes/notes/ubuntu-mariadb-10.5-38631eae76f6d091.yaml (+1, -1)
",2.842889,0.955942,1.131909,0.105722,0.286037,0.674747,-0.184562,-0.107311,-0.403338,-0.203749,0.164608,-0.233074,0.072096,-0.376433,-0.061235
openstack/kayobe,Icb02cffe04d84c6d29f3f0c3b4af540a4ffe631d,1,0,0.75,3.6376,0.0,9,3.0,160,0,Feature,0,0,0,12,0.026846,1.0,0,0.75,6,5,0,0.9394,2.8467,3.78,-50.01,21.2,1,0,0.0541,1,4.2105,0,0,0,0,0,"Adds support for custom Placement configuration.
[SEP]
FILES CHANGED:
ansible/roles/kolla-openstack/vars/main.yml (+5, -0)
ansible/roles/kolla-openstack/tasks/config.yml (+1, -0)
releasenotes/notes/add-extended-placement-conf-70a4b9a318c1b555.yaml (+3, -0)
doc/source/configuration/reference/kolla-ansible.rst (+2, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/tests/test_default.py (+2, -0)
ansible/roles/kolla-openstack/templates/placement.conf.j2 (+9, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/molecule.yml (+4, -0)
ansible/roles/kolla-openstack/defaults/main.yml (+9, -0)
ansible/kolla-openstack.yml (+2, -0)
",3.163216,0.115671,1.639059,1.080211,0.060878,0.506564,0.532544,1.065609,0.922293,0.394561,-0.426925,0.270343,0.184608,-0.259018,-0.48967
openstack/ironic,I50d4381e11da96cb7ae0ee8cbda18534380bd471,1,0,1.0,1.3863,0.3333,1,27.0,561,0,Feature,0,0,0,12,0.012876,0.0,0,0.0,2,1,0,1.0,0.0,2.0,21.72,20.18,0,0,0.0,0,140.25,0,0,0,0,0,"Clarify driver load error message

The NoValidDefaultForInterface exception is a little misleading
in that if one doesn't have the base interface enabled, and they
attempt to enable a hardware type which requires or only supports
disabled interfaces, they will also get an exeption. The reality
is we need to suggest for them to look at enabling the interfaces
before looking at the default interface overrides, because logically
the brain jumps to setting a default before checking the interface
settings.
[SEP]
FILES CHANGED:
ironic/common/exception.py (+2, -1)
",-0.613107,-2.445657,0.384255,0.533254,-0.341535,-0.383674,0.374361,-0.704199,0.164985,0.426789,-0.052087,-0.147967,0.153597,-0.047022,0.031294
openstack/oslo.messaging,Id8557050157aecd3abd75c9114d3fcaecdfc5dc9,1,1,0,4.2341,0.0,1,5.67,870,0,Bug Fix,1,0,0,0,0.0,0.0,0,0.0,3,1,0,0.4211,0.0,3.0,-22.86,12.15,1,0,1.0,0,12.6087,0,22,0,27,0,"Reproduce bug 1917645

The [oslo_messaging_notification]retry parameter is not applied during
connecting to the message bus. But the documentation implies it should[1][2].
The two possible drivers, rabbit and kafka, behaves differently.

1) The rabbit driver will retry the connection forever, blocking the caller
   process.

2) The kafka driver also ignores the retry configuration but the
   notifier call returns immediately even if the notification is not
   (cannot) be delivered.

This patch adds test cases to show the wrong behavior.

[1] https://docs.openstack.org/oslo.messaging/latest/configuration/opts.html#oslo_messaging_notifications.retry
[2] https://github.com/openstack/oslo.messaging/blob/feb72de7b81e3919dedc697f9fb5484a92f85ad8/oslo_messaging/notify/messaging.py#L31-L36

Related-Bug: #1917645
[SEP]
FILES CHANGED:
oslo_messaging/tests/notify/test_notifier.py (+68, -0)
",-3.325016,2.283176,2.234599,-0.495246,-0.243929,0.218821,0.59527,0.147554,0.389062,-0.069684,0.102126,0.010567,-0.260426,-0.13833,-0.117595
openstack/oslo.messaging,Id4ccafc95314c86ae918336e42cca64a6acd4d94,1,1,1.0,4.4659,0.3023,8,18.67,525,0,Bug Fix,0,0,0,1,0.014493,1.0,0,1.0,3,2,0,0.45,2.7556,2.25,-31.17,19.61,1,1,0.2674,1,6.0345,0,22,0,27,0,"[rabbit] use retry parameters during notification sending

The rabbit backend now applies the [oslo_messaging_notifications]retry,
[oslo_messaging_rabbit]rabbit_retry_interval, rabbit_retry_backoff and
rabbit_interval_max configuration parameters when tries to establish the
connection to the message bus during notification sending.

This patch also clarifies the differences between the behavior
of the kafka and the rabbit drivers in this regard.

Closes-Bug: #1917645
[SEP]
FILES CHANGED:
oslo_messaging/tests/notify/test_notifier.py (+13, -6)
oslo_messaging/_drivers/pool.py (+5, -5)
oslo_messaging/tests/drivers/test_pool.py (+2, -2)
oslo_messaging/_drivers/amqpdriver.py (+4, -3)
oslo_messaging/notify/messaging.py (+17, -6)
oslo_messaging/_drivers/common.py (+2, -2)
oslo_messaging/_drivers/impl_rabbit.py (+9, -2)
releasenotes/notes/bug-1917645-rabbit-use-retry-parameter-for-notifications-3f7c508ab4437579.yaml (+8, -0)
",-1.902061,-0.147413,0.249211,-0.61113,1.12319,-0.003419,0.096934,0.316057,0.476042,-0.373513,0.445847,0.200955,-0.557915,-0.431935,-0.029871
openstack/kolla-ansible,I8bf5453c6943fd2ad8912e5d80af179296ada894,1,0,0.9,3.2958,0.1923,4,9.0,96,0,Feature,0,0,0,30,0.040595,1.0,0,0.9,4,3,0,0.8254,1.6479,3.5,9.7,16.93,0,0,0.0,1,3.5556,0,0,0,0,0,"openvswitch: add option to set hw offload
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/tasks/post-config.yml (+8, -5)
ansible/roles/openvswitch/defaults/main.yml (+1, -0)
releasenotes/notes/openvswitch-hw-offload-5d9319d69472db69.yaml (+5, -0)
doc/source/reference/networking/sriov.rst (+7, -0)
",2.042866,0.334127,0.883079,0.139507,1.177126,-0.51181,0.342259,-0.67624,-0.102914,-0.026043,-0.247392,-0.567639,0.16055,-0.413586,0.261268
openstack/kolla-ansible,I33c2c458a98145315b0de0c069f13b83f59622eb,1,1,0.9688,0.6931,0.0,1,13.0,341,0,Bug Fix,0,0,0,32,0.057245,1.0,0,0.9688,4,1,0,0.8263,0.0,4.0,41.79,15.46,1,0,0.0,0,170.5,0,6,0,16,0,"Fix monasca-thresh upgrade

Change Ib225d76076782d695c9387e1c2693bae9a4521d7 introduced a new
upgrade task for monasca-thresh. Because the task is not restricted to
the correct group, it fails while trying to stop monasca_thresh on hosts
not running this container.

Closes-Bug: #1952408
[SEP]
FILES CHANGED:
ansible/roles/monasca/tasks/upgrade.yml (+1, -0)
",-0.300816,-0.985298,-1.039281,-0.786831,0.628257,0.048946,0.639191,-0.046818,0.264242,-0.05736,0.136244,0.236909,0.001709,-0.011424,0.336468
openstack/kolla-ansible,If8c569e1f7815520c84627671e3cbf275bed8ff9,1,0,0.9032,0.6931,0.0,1,4.43,417,0,CI,1,0,0,31,0.040523,0.0,0,0.0,1,1,0,0.8272,0.0,1.0,-46.0,12.09,0,0,1.0,0,208.5,0,0,0,0,0,"CI: check-logs - add another exception

It was seen in [1] and some other occassions, possibly neutron was trying
to fetch token while keystone was being upgraded.

[1]: https://storage.bhs.cloud.ovh.net/v1/AUTH_dcaab5e32b234d56b626f72581e3644c/zuul_opendev_logs_ec2/665117/12/check/kolla-ansible-ubuntu-source-upgrade/ec2fc04/primary/logs/kolla/all-CRITICAL.txt
[SEP]
FILES CHANGED:
tests/check-logs.sh (+1, -0)
",-1.649206,1.593836,-0.753328,-0.899541,-0.268458,-0.683567,1.166122,0.357045,0.372649,-0.307891,0.33165,-0.331256,0.011876,0.171447,-0.074331
openstack/magnum,I2313c6a8b647e521cfa476f9cec65ab286fa5a23,1,0,0,4.8442,0.5,9,11.57,614,0,Feature,0,0,0,0,0.0,0.0,0,0.0,6,1,0,0.8667,2.7465,3.33,41.56,12.04,1,0,0.3651,0,4.8346,0,0,0,0,0,"Optimize cluster list api

Up till now, cluster api controller cluster_template_id was a
property field loading the id from the DB every time. With this
change the field becomes of text type and mandatory, so wsme fwk
guarantees that the field is provided when needed.

Cluster objects will not load the cluster template on creation.
Instead cluster templates will be loaded when they are actually
needed.

story: 2006693
task: 36989

Co-Authored-By: Stavros Moiras <stavros.moiras@cern.ch>

(cherry picked from commit 0792885a1b2c5f5d93f48bd07b9a169c2096669f)
[SEP]
FILES CHANGED:
magnum/objects/cluster_template.py (+1, -2)
magnum/tests/unit/api/test_validation.py (+8, -8)
magnum/tests/unit/objects/test_cluster_template.py (+1, -1)
magnum/tests/unit/objects/test_cluster.py (+7, -17)
magnum/api/controllers/v1/cluster.py (+6, -25)
magnum/api/validation.py (+16, -2)
magnum/tests/unit/api/controllers/v1/test_cluster.py (+3, -1)
magnum/objects/cluster.py (+16, -7)
magnum/common/exception.py (+5, -0)
",-2.464695,-0.302894,0.738255,-1.134291,0.315639,0.249322,0.104379,-0.140919,0.071924,-0.255853,0.363372,0.163856,-0.198472,0.186367,-0.432459
openstack/octavia,I00c3083d7dbcf4473af3386d114c4af9e07751a0,1,0,1.0,2.0794,0.0,2,14.0,294,0,Bug Fix,0,0,0,3,0.130435,0.5,0,0.5,3,2,0,0.5508,0.5917,2.5,31.48,16.08,1,0,0.0,1,36.75,0,0,0,0,0,"Fix ignored [nova] service_name

The [nova] service_name parameter is supposed to be used to find
the nova endpoint from keystone catalog but in fact the parameter is
not used and has had no effect.
This change fixes the ignored parameter.
[SEP]
FILES CHANGED:
releasenotes/notes/fix-nova-service_name-6bde4970047817f4.yaml (+6, -0)
octavia/compute/drivers/nova_driver.py (+1, -0)
",-0.262247,-0.707132,-0.526462,1.327155,-0.000756,0.56517,0.118068,-0.878974,0.105243,-0.040095,0.242441,0.409679,-0.316227,0.270101,-0.52402
openstack/ironic,Icc6e5dd74d9f15e679a7e764fe49238ed6b8dc1e,1,0,1.0,4.7274,0.0089,3,15.89,976,0,CI,0,0,0,13,0.013904,0.0,0,0.0,6,2,0,1.0,1.2652,4.0,35.71,13.91,1,0,0.6429,1,8.6372,0,0,0,0,0,"Remove redfish cache entry upon errors

Some transient errors can ultimately cause the client to need to be
completely restarted due to cached connection data.

Ironic now explicitly removes the cache entry when a sushy
AccessError or python AttributeError is detected originating
from the library. This will now result in the prior cached connection
object to be discarded, and upon the next attempt to interact with
the same node, a new connection will be launched.

This will result in new sessions being created, but in all likelihood
the prior session had already timed out or had been administratively
removed. Sushy's code, as of
https://review.opendev.org/c/openstack/sushy/+/820076
will raise SessionService lookup access errors as AccessErrors.
Prior to that change, they should have been raised as AttributeError
as the previous call sould have returned None to be used as an object.

Story: 2009719
Task: 44107
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/utils.py (+27, -0)
releasenotes/notes/redfish-connection-cache-pool-accesserror-743e39a2f017b990.yaml (+13, -0)
ironic/tests/unit/drivers/modules/redfish/test_utils.py (+71, -1)
",-2.402544,-0.813198,2.283289,-0.300647,-0.754682,0.389559,0.069009,-0.254278,0.448514,0.010504,0.000136,0.208859,-0.154739,-0.127276,-0.216045
openstack/kolla-ansible,I5d6af3707c3de4466699f1a0e6ff2f2e2fe4e123,1,0,0.1429,1.6094,0.0,2,7.0,87,0,Feature,0,0,0,7,0.060345,0.8571,0,0.1224,4,2,0,0.8281,0.8113,4.0,-41.98,19.94,1,0,0.0,0,17.4,0,0,0,0,0,"Add logrotate to libvirt service
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron-logrotate-nova-libvirt.conf.j2 (+3, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
",3.476064,-0.141307,1.59557,0.431227,0.192321,-0.6732,1.188653,1.192939,0.721993,-0.110162,-0.265574,-0.448653,-0.208198,-0.157807,-0.436439
openstack/kolla-ansible,I9efe73193bf828b084c2844be73c9813a969c9c7,1,1,1.0,2.3979,0.4,2,13.33,303,0,Bug Fix,0,0,0,10,0.079365,0.0,0,0.0,4,2,0,0.829,0.971,3.0,34.68,16.33,1,0,0.0,1,27.5455,0,6,0,13,0,"Fix aodh wsgi config file in Debuntu binary

This patch is fixing file path for WSGIScriptAlias
as debian/ubuntu binary packages installs /usr/bin/aodh-api
as it is in source images also. For details please check
LP bug report.

Closes-Bug: #1953059
[SEP]
FILES CHANGED:
releasenotes/notes/fix-aodh-wsgi-config-7679adda584e33bb.yaml (+6, -0)
ansible/roles/aodh/templates/wsgi-aodh.conf.j2 (+0, -4)
",0.092667,-1.589626,-0.429145,-0.466855,-0.477206,-0.701394,-0.155343,0.731959,-0.160805,-0.169506,-0.173636,-0.365809,0.127908,0.194204,-0.180527
openstack/kolla-ansible,If9186d8aa65150c492657550064789e211dbb570,1,1,0.3333,2.8904,0.1176,3,8.5,382,0,Bug Fix,0,0,0,3,0.176471,0.5,0,0.1667,4,2,0,0.8299,1.3831,3.33,45.6,12.81,1,0,0.0,1,21.2222,0,6,0,15,0,"Bump timeout for grafana startup

The initial migrations when starting grafana for the first time may
sometimes take much longer than 20s, we have seen samples up to near
60s. Allow 120s to have some margin. Also make the timeout parameters
configurable.

Closes-Bug: 1769962
[SEP]
FILES CHANGED:
ansible/roles/grafana/defaults/main.yml (+3, -0)
ansible/roles/grafana/handlers/main.yml (+2, -2)
releasenotes/notes/grafana-start-first-node-timeout-f9a6149cc68153a5.yaml (+10, -0)
",0.275146,-1.782018,-0.372653,-0.07535,-0.44484,0.392245,0.121383,-0.201663,-0.087033,0.290851,-0.024852,0.000451,0.150167,0.068124,0.189543
openstack/kayobe,Ie42ab7a0dc9dd1ed1925b3a17134b3770ae8ba98,1,0,0.9697,2.4849,0.0,1,4.0,80,0,Doc,0,0,0,33,0.058929,1.0,1,0.9697,4,1,0,0.9403,0.0,4.0,-177.92,41.6,1,0,0.0,0,6.6667,0,0,0,0,0,"Document seed_enable_snat
[SEP]
FILES CHANGED:
doc/source/configuration/reference/hosts.rst (+11, -0)
",1.882718,2.105098,0.496648,-0.032315,0.312785,1.062852,-1.437216,-0.483726,1.208263,-0.408582,0.294493,-0.298244,-0.739038,0.065804,0.049978
openstack/ironic,I10ca0a32b407a7f9d60827b4bde799a1688f5c1a,1,0,0.8333,3.2189,0.0,1,12.0,179,0,Doc,0,0,0,6,0.0131,0.0,1,0.0,3,1,0,1.0,0.0,3.0,39.56,11.47,1,1,0.0,0,7.16,0,0,0,0,0,"[doc] Add parameters for burn-in log files

Add the options to log the various burn-in steps to a file to the
documentation.
[SEP]
FILES CHANGED:
doc/source/admin/hardware-burn-in.rst (+24, -0)
",1.531348,-0.69806,0.218736,1.046397,-0.492928,0.002947,0.223559,0.024999,0.735826,0.332093,-0.481,0.533361,0.17917,0.262011,-0.818384
openstack/kolla-ansible,I4d694d6224c813285d228d6bc7eece5731db1078,1,1,0.6667,4.0604,0.0175,7,11.67,327,0,Bug Fix,0,0,0,3,0.01676,1.0,0,0.6667,4,3,0,0.8308,2.4065,3.0,13.71,17.24,1,0,0.0,1,5.6379,0,10,0,17,0,"Support enable/disable rabbitmq prometheus plugins

rabbitmq starting from 3.8.0, built-in Prometheus support,
prometheus plugins are enabled by default, when the environment is
""enable_prometheus is no"", rabbitmq role will disable prometheus plugins

Closes-Bug: #1885106
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/templates/rabbitmq.json.j2 (+6, -0)
ansible/roles/rabbitmq/tasks/config.yml (+18, -0)
ansible/group_vars/all.yml (+11, -1)
ansible/roles/rabbitmq/templates/rabbitmq.conf.j2 (+5, -0)
ansible/site.yml (+2, -0)
releasenotes/notes/bug-1885106-2347d7458a8f9cb0.yaml (+13, -0)
ansible/roles/rabbitmq/templates/enabled_plugins.j2 (+1, -0)
",0.257881,-0.54866,-0.309145,0.1753,0.037672,-0.116468,-0.037951,0.532564,-0.257451,0.041337,0.021801,-0.338789,-0.245606,-0.478234,0.410003
openstack/kolla,I231e0ace0822f55cfd7785e68078c577e9902481,1,1,0.9062,0.6931,0.0,1,8.0,109,0,Bug Fix,0,0,0,32,0.041775,0.5,0,0.4531,3,1,0,0.8033,0.0,3.0,-44.51,23.2,0,0,0.0,0,54.5,0,6,0,4,0,"monasca-grafana: Fix build errors

Closes-Bug: #1954621
[SEP]
FILES CHANGED:
docker/monasca/monasca-grafana/Dockerfile.j2 (+1, -0)
",2.154387,1.175119,-0.568069,-1.119141,-0.913338,0.751013,-0.452434,0.111264,0.162337,-0.202379,0.762497,0.314988,0.001721,-0.008662,0.331698
openstack/ironic,Iced8e921335995e1e084d6e632c6e81d3fc9249f,1,0,1.0,2.4849,0.2727,3,7.25,290,0,Bug Fix,0,0,0,5,0.004098,1.0,0,1.0,6,2,0,1.0,1.4949,4.0,-1.81,15.31,1,0,0.3636,1,24.1667,0,0,0,0,0,"Fix redfish update_firmware for newer Sushy

`TaskMonitor.task_monitor` is deprecated and was removed from sushy
at Ie48fab19199c0c2f3455d2212d50460a29685eed. Somehow missed to
update it for `redfish` firmware upgrade steps previously.
[SEP]
FILES CHANGED:
releasenotes/notes/fix-redfish-firmware-upgrade-7ef2fcb6bfd74e67.yaml (+5, -0)
ironic/drivers/modules/redfish/management.py (+1, -1)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+2, -2)
",-0.004017,0.125807,-1.524113,-0.831013,0.872481,0.100634,0.55288,-0.190473,-0.005051,-0.194652,-0.137654,-0.294955,-0.417839,-0.157619,0.231633
openstack/kolla,I3045786e863b098d7339d1066aef6c857aa5f97f,1,1,0.5,3.3673,0.4643,4,8.62,601,0,Bug Fix,0,0,0,4,0.117647,1.0,0,0.5,2,4,0,0.8049,1.9172,2.0,32.56,12.73,1,0,0.0,1,20.7241,0,10,0,28,0,"Unpin td-agent and cap elasticsearch gem

With [0] the version of td-agent being installed was pinned, which isn't
sustainable in the long run, so we drop the pin.

Latest version of the elasticsearch gem no longer works with older
(OSS) versions of Elasticsearch. This is fixed by downgrading the version
of the elasticsearch gems.

[0] Iefcdd3100b7e3c5320bc5f1286a18251bdeab885
Related-Bug: 1930867
Closes-Bug: 1954759
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/823155
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+0, -5)
docker/base/apt_preferences.debian (+0, -5)
releasenotes/notes/cap-fluentd-elasticsearch-18c0ca8e90c1234c.yaml (+7, -0)
docker/fluentd/Dockerfile.j2 (+8, -3)
",-1.84709,1.137725,0.017819,-0.760101,-0.161056,0.255176,0.823324,0.055138,-0.042236,-0.032936,0.452899,0.391537,0.13887,-0.158176,-0.07612
openstack/oslo.messaging,I27625b468c428cde6609730c8ab429c2c112d010,1,1,0.3077,4.2195,0.0448,2,14.07,1314,0,Bug Fix,0,0,0,13,0.017038,0.5,0,0.1538,2,2,0,0.4762,0.383,2.0,48.26,12.74,1,0,0.0,1,19.3235,0,10,0,8,0,"Force creating non durable control exchange when a precondition failed

Precondition failed exception related to durable exchange
config may be triggered when a control exchange is shared
between services and when services try to create it with
configs that differ from each others. RabbitMQ will reject
the services that try to create it with a configuration
that differ from the one used first.

This kind of exception is not managed for now and services
can fails without handling this kind of issue.

These changes catch this kind exception to analyze if they
related to durable config. In this case we try to re-declare
the failing exchange/queue as non durable.

This problem can be easily reproduced by running a local RabbitMQ
server.

By setting the config below (sample.conf):

```
[DEFAULT]
transport_url = rabbit://localhost/
[OSLO_MESSAGING_RABBIT]
amqp_durable_queues = true
```

And by running our simulator twice:

```
$ tox -e venv --  python tools/simulator.py -d rpc-server -w 40
$ tox -e venv --  python tools/simulator.py --config-file ./sample.conf -d rpc-server -w 40
```

The first one will create a default non durable control exchange.
The second one will create the same default control exchange but as
durable.

Closes-Bug: #1953351
[SEP]
FILES CHANGED:
releasenotes/notes/declare_fallback_durable_exchange-0db677de4fdf1e78.yaml (+5, -0)
oslo_messaging/_drivers/impl_rabbit.py (+59, -3)
",-3.627127,-0.516503,3.880831,-1.116964,-0.02502,0.049003,-0.95797,-0.201754,-0.181427,-0.278339,-0.518196,-0.061669,-0.116081,0.222251,0.006712
openstack/kolla-ansible,I2d4a4fab35771723be82a1c8b98dbe4cc3164f58,1,0,1.0,2.0794,0.1429,2,9.0,117,1,Feature,0,0,0,8,0.07619,1.0,0,1.0,4,2,0,0.8316,0.8631,3.0,-84.3,30.27,0,1,0.0,1,14.625,0,0,0,0,0,"[Security] Add log4j vulnerability mitigation in Elasticsearch
[SEP]
FILES CHANGED:
ansible/roles/elasticsearch/defaults/main.yml (+1, -1)
releasenotes/notes/security-log4j-1be047799f8e590a.yaml (+5, -0)
",1.846173,1.529673,0.637333,0.557232,0.331718,0.358248,-0.20655,0.703891,0.285661,0.650532,-0.107993,0.474833,0.190448,-0.805368,-0.93991
openstack/kolla-ansible,Ifa2b2ea8622f56c34b8f7f37fee53133272ff925,1,1,0.8923,4.4067,0.7407,2,8.0,267,0,Bug Fix,0,1,0,65,0.024137,1.0,0,0.8923,4,2,0,0.8325,0.5033,3.0,-2.21,16.53,0,0,0.0,1,3.2561,0,6,0,6,0,"Revert ""Use friendly target names in Prometheus""

This reverts commit 4ff65b7661ea06e9fa8631c4eb82232e03af77d7.

Reason for revert: adds assumptions about inventory_hostname being resolvable.

Closes-Bug: #1955563
[SEP]
FILES CHANGED:
releasenotes/notes/fix-1955563-42a14bb080e15df2.yaml (+9, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+12, -60)
",-0.694611,-0.629166,-1.517266,-2.161793,0.788881,0.24109,1.177924,-0.041035,0.628104,0.19647,0.278156,-0.092182,-0.058154,-0.037097,-0.154625
openstack/kolla-ansible,I67995073b92d6ea9ccc208ae96e8a6045369b801,1,0,0.25,2.1972,1.0,3,13.0,120,0,Feature,0,0,0,8,0.066667,0.875,0,0.2188,4,2,0,0.8333,1.5613,4.0,24.44,17.51,1,0,0.0,0,13.3333,0,0,0,0,0,"Delete the logrotate files because they do not have separate logs
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron-logrotate-keepalived.conf.j2 (+0, -3)
ansible/roles/common/tasks/config.yml (+0, -2)
ansible/roles/common/templates/cron-logrotate-iscsid.conf.j2 (+0, -3)
",3.58675,-1.010799,1.940231,0.502469,0.10131,-0.179501,1.377575,0.037955,-0.163739,-0.291112,-0.636796,-0.026497,-0.252788,0.523583,-0.530912
openstack/oslo.cache,Icbe6dc3e93b4d2fec1ceb88366027294e49d7032,1,1,0.3158,1.3863,0.3333,1,14.25,457,0,Bug Fix,0,0,0,19,0.001682,0.0,0,0.0,2,1,0,0.5,0.0,2.0,40.98,12.02,1,0,0.0,0,114.25,0,12,0,15,0,"Don't import module ""etcd3gw"" if etcd3gw backend is not used.

If module etcd3gw is not required for used backend,
then no need to have it installed and imported.
Otherwise we always have ugly log error:
Could not load 'oslo_cache.etcd3gw': No module named 'etcd3gw': ModuleNotFoundError: No module named 'etcd3gw

Closes-Bug: 1928318
(cherry picked from commit 40946a9349407f36a43d5020d991085c11468698)
[SEP]
FILES CHANGED:
oslo_cache/backends/etcd3gw.py (+2, -1)
",-2.270478,0.159614,-0.497382,-0.645053,0.769847,-0.032561,0.11991,-0.137757,-0.234165,0.092521,0.707146,-0.405889,0.148702,0.229037,-0.058395
openstack/kolla-ansible,I27496528c684c993a3e470265ba86cc29c136c7b,1,0,0.8205,2.9444,0.5,1,9.0,102,0,Bug Fix,0,0,0,78,0.018678,0.0,1,0.0,4,1,0,0.8342,0.0,4.0,19.1,16.93,1,1,0.0,0,5.3684,0,0,0,0,0,"[docs] swift: fix mentions of interfaces config
[SEP]
FILES CHANGED:
doc/source/reference/storage/swift-guide.rst (+9, -9)
",3.037452,0.866606,1.33784,0.137814,0.484356,-0.024577,-0.197483,-0.332913,-0.114028,0.622581,-0.279183,-0.679711,0.422107,-0.291824,-1.083557
openstack/kolla,I10ff098b3356eb02ad4a1006b988812356768fec,1,1,0.8228,2.0794,0.1429,2,15.33,374,0,Bug Fix,0,0,0,79,0.018836,1.0,0,0.8228,2,2,0,0.8065,0.8631,2.0,40.46,13.09,1,0,0.0,1,46.75,0,6,0,4,0,"Add fluentd grok-parser plugin on CentOS on aarch64

This conditional was missed in the original patch moving aarch64
to td-agent. [1]

After this change, other plugins will have newer versions
installed as well, as it happens in other image flavours.

[1] I86ecdc1ac45dfd76b94a34d1b837f7c0bc975dcd

Closes-Bug: #1955889
[SEP]
FILES CHANGED:
docker/fluentd/Dockerfile.j2 (+1, -1)
releasenotes/notes/bug-1955889-92d98ef6527a75ef.yaml (+5, -0)
",-0.847698,-1.48301,-0.480889,-1.376637,-0.128712,-0.44641,0.738593,0.4582,0.114281,0.724056,0.171421,0.024237,0.369957,0.210845,-0.01476
openstack/ironic,I423b387a9fe9b4d0a13ecf31a89f04c32cb26950,1,0,1.0,2.9957,0.2105,2,7.0,84,0,Bug Fix,0,0,0,6,0.004874,1.0,0,1.0,4,2,0,1.0,0.9495,3.0,6.36,14.23,1,0,0.0,1,4.2,0,0,0,0,0,"Fix Redfish RAID deploy steps
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+8, -4)
releasenotes/notes/fix-redfish-raid-deploy-steps-e9ee1ea3d1f2a475.yaml (+7, -0)
",3.048736,1.102798,1.705072,0.051693,0.599338,0.779722,0.478933,1.019746,-0.090018,-0.615884,0.26188,0.049253,0.545922,-0.517372,0.135792
openstack/kolla-ansible,Ifbb601be3ef1a1e853d5a7e832adf556c0ae38b9,1,1,0,2.0794,0.0,2,12.2,448,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.835,0.5917,3.0,23.87,14.72,1,0,0.0,1,56.0,0,12,0,21,0,"Use Volume V3 API in OpenStack exporter

Kolla has removed the Volume V2 API by default since OpenStack Wallaby.
However, openstack-exporter attempts to use the Volume V2 API by
default, resulting in clean installs failing to fetch Cinder metrics
in Prometheus.

This patch updates the clouds.yml configuration file for
openstack-exporter to use the Volume V3 API instead.

Closes-Bug: #1938194
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1938194-80dba28f9cdd434c.yaml (+6, -0)
ansible/roles/prometheus/templates/clouds.yml.j2 (+1, -0)
",-0.378864,-0.388922,-0.055083,0.567763,-0.333126,-0.088963,0.188889,0.95072,0.042357,-0.08288,0.49196,0.143204,-0.012182,-0.23725,0.202101
openstack/octavia,I48a02780adf54b8d6d3bedada448a4f91e0539ed,1,0,0.6957,4.8363,0.128,5,65.0,499,0,Feature,0,0,0,69,0.006623,0.625,0,0.4348,6,2,0,0.5525,1.9665,4.4,-28.34,36.46,0,0,0.592,1,3.9603,0,0,0,0,0,"Pass timeout_dict to _get_haproxy_versions

The timeout_dict args was ignored when calling _get_haproxy_versions

_get_haproxy_versions might be the first function (that uses the amphora
API) that is called from rest_api_driver, it should respect the
timeout_dict passed by the tasks of the controller (for instance during
a failover a custom timeout_dict is used in order to optimize the
failover of missing amphorae)

Story 2009761
Task 44232
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+36, -1)
octavia/amphorae/drivers/keepalived/vrrp_rest_driver.py (+2, -1)
releasenotes/notes/fix-timeout-dict-in-failover-tasks-537456e0fe1d7cb8.yaml (+9, -0)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+26, -13)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+36, -1)
",-1.116451,-0.692079,0.137957,0.499939,0.291333,0.094353,-0.008806,-0.205476,0.115155,-0.485849,0.343273,-0.449851,-0.406786,0.036554,0.240935
openstack/octavia,I6619ba117f7051fe44086389789bc6e2810fd23d,1,0,0.7,4.5539,0.4468,5,26.0,506,0,Feature,0,0,0,70,0.006639,0.6667,0,0.4667,6,2,0,0.5543,2.0137,3.6,39.45,18.09,0,0,0.6702,1,5.3263,0,0,0,0,0,"Add keepalive for redis-based taskflow boards

When using amphorav2+persistence, taskflow maintains the ownership of a
task using a TTL in redis for each job.

When a task is longer than expected, it is released in redis and another
controller can take it over while it is still running on the first
controller.

Add a keepalive mechanism in the worker to periodically reset the TTL
while the worker is still processing a job

Story 2009761
Task 44242
[SEP]
FILES CHANGED:
octavia/common/base_taskflow.py (+13, -6)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+11, -17)
octavia/controller/worker/v2/controller_worker.py (+2, -2)
octavia/tests/unit/common/test_base_taskflow.py (+18, -17)
releasenotes/notes/fix-long-tasks-with-redis-keepalive-af18211334c14f54.yaml (+8, -0)
",-1.04372,-2.327632,0.424474,0.309484,-0.14098,-0.031108,0.164119,-0.159318,0.11895,0.10232,0.007237,0.211436,0.086993,0.010369,-0.169266
openstack/oslo.rootwrap,I76094065de5b37f59a2500fbce7f500ada9915da,1,1,1.0,2.7081,0.0714,2,13.25,355,0,Bug Fix,0,0,0,4,0.070175,0.0,0,0.0,2,1,0,0,0.9852,1.5,57.71,10.58,0,0,0.5714,0,23.6667,0,6,0,4,0,"CommandFilter should allow exec from full path

The current logic prevents from using a full path as argument.
We can't just compare basename to basename as it would allow passing
bogus paths. We need to make sure that passing a full path will compare
to the config's full path.

Closes-Bug: #1956606
[SEP]
FILES CHANGED:
oslo_rootwrap/tests/test_functional.py (+8, -0)
oslo_rootwrap/filters.py (+5, -1)
",0.54934,-1.707997,-0.131138,0.23639,-0.383345,0.078291,0.718817,-0.577484,-0.197409,-0.007364,0.134033,-0.25421,0.225167,-0.098173,-0.195391
openstack/openstack-ansible,I2b5ea03d3e65b0d206f57bd48182a96beab793de,1,0,0,1.6094,0.0,1,13.67,335,0,Feature,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.0,1.0,17.57,15.22,1,0,0.0,0,67.0,0,0,0,0,0,"Gather additional facts for haproxy playbook

Our deployment requires extra network interface facts in order
to identify the correct haproxy_stats_bind_address. Adding this
pre-task allows us define filters and gather these without
having to run another playbook or command first.
[SEP]
FILES CHANGED:
playbooks/haproxy-install.yml (+4, -0)
",0.232116,-1.656045,-0.028227,0.697304,0.393223,-0.455944,-0.216989,-0.47401,0.287446,-0.311893,-0.652836,-0.155583,-0.05366,-0.156627,0.04949
openstack/ironic,I863dd4ab9615a9ce3b3dcb8798af674ac9966bf2,1,0,0,2.7081,0.0714,3,17.29,843,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,2,0,1.0,1.5306,2.67,32.68,16.5,1,0,0.3571,1,56.2,0,0,0,0,0,"Ensure 'port' is up2date after binding:host_id

On neutron routed provider networks IP allocation is
deferred until 'binding:host_id' is set. When ironic
creates neutron ports it first creates the port, then
updates the port setting binding information.

When using IPv6 networking ironic adds additional address
allocations to ensure network chain-booting will succeed.
When address allocation is deferred on port create ironic
cannot detect that IPv6 is used and does not add the
required additional addresses.

This change ensures the 'port' object is updated after the
port update setting the port binding required for neutron
to allocate the address. This allows ironic to correctly
detect IPv6 is used, and it will add the required IP
address allocations.

Story: 2009773
Task: 44254
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_neutron.py (+5, -0)
ironic/common/neutron.py (+2, -1)
releasenotes/notes/fix-ipv6-provisioning-routed-provider-network-bbd0c46559f618ac.yaml (+6, -0)
",-1.859131,-1.485817,1.60306,0.259831,0.309095,-0.077904,-0.276961,0.000689,0.482451,0.013641,-0.087998,0.05135,-0.137334,-0.037183,-0.044612
openstack/openstack-ansible,I4a66a5b24f03eadc0fe758065749a7ae15a013d8,1,0,1.0,1.0986,0.5,1,5.6,271,0,Bug Fix,0,0,0,1,0.2,0.0,0,0.0,3,1,0,1.0,0.0,3.0,-4.31,13.67,1,0,0.0,0,90.3333,0,0,0,0,0,"Fix definition of ssl_protocol

The syntax for TLS 1.0 is incorrect for Apache servers
which appear to be the only users of this variable.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/823971
[SEP]
FILES CHANGED:
inventory/group_vars/all/ssl.yml (+1, -1)
",-0.215324,1.155915,-0.838728,0.341251,-1.029354,0.021601,0.168358,-0.028612,0.397006,0.055262,-0.675362,-0.16066,-0.033006,-0.234385,0.266458
openstack/openstack-ansible-os_keystone,I56a6c47e4d95e86dc1e0d731f1e39eeec6ac7dc8,1,0,1.0,2.8904,0.0588,1,16.0,376,0,Bug Fix,0,0,0,2,0.285714,0.0,0,0.0,1,1,0,0,0.0,1.0,3.77,20.57,1,0,0.0,0,20.8889,0,0,0,0,0,"Fix ordering error enabling/disabling Apache modules

When site configuration already exists, a change to make a module
'absent' would fail as the module was removed before the
configuration.

This change ensures modules are enabled first, before site
configuration changes, and finally any required modules are
disabled.
[SEP]
FILES CHANGED:
tasks/keystone_apache.yml (+16, -1)
",0.458545,-1.803667,0.112458,0.85573,-0.129793,0.143896,0.58618,-0.48991,0.227796,0.162963,-0.202586,-0.161462,0.047793,0.177903,-0.141671
openstack/kayobe,I0747cc8fa6fdbfa980b1263da3b3edddb725d2db,1,0,0.9706,2.6391,0.5385,3,7.0,96,0,Doc,0,0,0,34,0.059545,1.0,1,0.9706,2,1,0,0.9412,1.2389,2.0,-54.07,19.94,1,0,0.0,0,6.8571,0,0,0,0,0,"Update documentation about CentOS support
[SEP]
FILES CHANGED:
doc/source/support-matrix.rst (+2, -2)
doc/source/upgrading.rst (+4, -4)
doc/source/installation.rst (+0, -1)
",3.983019,0.606038,2.287706,0.512836,-0.005475,0.838961,1.028098,0.528564,0.52846,0.073078,-0.482637,-0.116677,0.057592,-0.311505,0.411708
openstack/ironic,I6cc52eb56c7888a433d24aa79154143d6f35cf83,1,0,0.8571,2.7726,0.0,3,13.5,207,0,Feature,0,0,0,7,0.014523,1.0,0,0.8571,6,2,0,1.0,1.3996,4.0,42.73,12.81,1,0,0.5333,1,12.9375,0,0,0,0,0,"Set resource_url when getting all nodes

Since the default value resource_url is None, make sure the
parameter is set to 'nodes' when getting all nodes.
[SEP]
FILES CHANGED:
releasenotes/notes/fix_pagination_resource_url-42fb4023fde9da2b.yaml (+5, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+8, -0)
ironic/api/controllers/v1/node.py (+2, -0)
",-0.101075,0.154342,-0.54865,1.710476,0.909282,0.306588,-0.182345,-0.911599,0.213986,0.153391,-0.168916,-0.386829,-0.443404,-0.021952,-0.290785
openstack/openstack-ansible-os_zun,Ie081e4e9bdf84e0f3c1f0116fcd6c76e47573895,1,0,0,1.9459,0.5,2,4.4,301,0,Doc,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.9183,1.0,-97.58,19.94,1,0,0.0,0,43.0,0,0,0,0,0,"Enable recursion in combine() filter

Ansible's combine() filter needs recursive=True parameter in order to recursively merge nested hashes.

https: //docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#combining-hashes-dictionaries
[SEP]
FILES CHANGED:
defaults/main.yml (+2, -2)
vars/main.yml (+1, -1)
",-1.399235,2.340024,-1.039221,0.936012,-0.077274,-0.223809,0.019328,-0.38931,0.267478,-0.342135,-0.825299,-0.335918,0.314838,-0.385359,-0.148006
openstack/oslo.messaging,Id4ccafc95314c86ae918336e42cca64a6acd4d94,1,1,1.0,4.4659,0.3023,8,20.33,594,0,Bug Fix,0,0,0,2,0.012903,1.0,0,1.0,3,2,0,0.5,2.7556,2.25,-31.54,19.94,1,1,0.2674,1,6.8276,0,0,0,0,0,"[rabbit] use retry parameters during notification sending

The rabbit backend now applies the [oslo_messaging_notifications]retry,
[oslo_messaging_rabbit]rabbit_retry_interval, rabbit_retry_backoff and
rabbit_interval_max configuration parameters when tries to establish the
connection to the message bus during notification sending.

This patch also clarifies the differences between the behavior
of the kafka and the rabbit drivers in this regard.

Closes-Bug: #1917645
(cherry picked from commit 7b3968d9b012e873a9b393fcefa578c46fca18c6)
[SEP]
FILES CHANGED:
oslo_messaging/tests/notify/test_notifier.py (+13, -6)
oslo_messaging/_drivers/pool.py (+5, -5)
oslo_messaging/tests/drivers/test_pool.py (+2, -2)
oslo_messaging/_drivers/amqpdriver.py (+4, -3)
oslo_messaging/notify/messaging.py (+17, -6)
oslo_messaging/_drivers/common.py (+2, -2)
oslo_messaging/_drivers/impl_rabbit.py (+9, -2)
releasenotes/notes/bug-1917645-rabbit-use-retry-parameter-for-notifications-3f7c508ab4437579.yaml (+8, -0)
",-1.902061,-0.147413,0.249211,-0.61113,1.12319,-0.003419,0.096934,0.316057,0.476042,-0.373513,0.445847,0.200955,-0.557915,-0.431935,-0.029871
openstack/ironic,I0023e0750e372185747ca28cddd2a8dda110dd7f,1,0,0.9333,3.091,0.0952,3,7.33,214,0,Feature,0,0,0,15,0.011556,0.0,0,0.0,5,2,0,1.0,1.5452,3.33,-0.57,17.48,1,0,0.4286,1,9.7273,0,0,0,0,0,"Do not fail inspection on invalid MAC

Some adapters may have addresses that are not MAC. See for example:
https://github.com/metal3-io/ironic-image/issues/314
[SEP]
FILES CHANGED:
releasenotes/notes/invalid-mac-b0e3d99f23afeb30.yaml (+5, -0)
ironic/tests/unit/drivers/modules/test_inspect_utils.py (+7, -2)
ironic/drivers/modules/inspect_utils.py (+7, -0)
",-0.140508,1.869489,-1.092776,0.740353,-0.576355,0.080041,-0.307438,-0.571914,-0.018862,-0.026565,-0.753417,0.013451,0.434371,-0.299446,-0.148256
openstack/openstack-ansible-os_nova,Iee1dca9221b6968d11be54fc1df03b2f8a6c3f44,1,0,1.0,1.6094,0.0,1,12.0,271,0,Bug Fix,0,0,0,3,0.125,0.0,0,0.0,1,1,0,1.0,0.0,1.0,51.31,11.47,0,0,0.0,0,54.2,0,0,0,0,0,"Fix nova-key tag handling

It appears that this tag stopped working recently when switching
from import to include syntax. This patch adds the necessary
'always' tag to ensure the 'nova-key' tag gets carried through.
[SEP]
FILES CHANGED:
tasks/nova_compute.yml (+4, -0)
",0.355784,-1.18292,-0.493569,0.57891,-0.273723,0.091539,0.009305,-0.529413,-0.183971,-0.005745,0.004619,0.144027,0.102392,0.056912,0.270502
openstack/kolla-ansible,I83e4cb48192c8024650a8d347363f6babb75ad90,1,1,0.9714,2.1972,0.125,2,8.89,695,0,Bug Fix,0,0,0,35,0.059932,0.5,0,0.4857,4,2,0,0.8358,0.5436,3.0,19.1,14.06,1,0,0.0,1,77.2222,0,6,0,16,0,"Remove custom value of max_allowed_secret_in_bytes

Barbican has recently bumped max_allowed_secret_in_bytes from 10 KB to
20 KB since the original value was too small for some certificates [1].
Remove custom value from the barbican.conf template, which anyway was
the same as the default configuration before the recent upstream change.

The upstream change was backported to Wallaby and has been proposed to
Victoria, Ussuri and Train [2], so this change should be backported too.

[1] https://review.opendev.org/c/openstack/barbican/+/783381
[2] https://review.opendev.org/q/I59d11c5c9c32128ab9d71eaecdf46dd2d789a8d1

Closes-Bug: #1957795
[SEP]
FILES CHANGED:
releasenotes/notes/barbican-max-allowed-secret-size-1941307ab5d2a9fd.yaml (+7, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+0, -1)
",-3.128234,1.41125,0.733473,-0.714908,-0.048431,0.669659,0.501887,-0.053309,0.143374,-0.013112,0.389804,-0.001585,-0.384748,-0.261049,-0.153104
openstack/kolla-ansible,I30c2a7b6850350901b15fe196175508634c8e9a5,1,0,0.6,2.3979,0.0,2,4.57,339,0,Bug Fix,0,0,0,5,0.080645,0.0,0,0.0,4,1,0,0.8366,0.469,3.5,-1.37,14.33,1,0,0.0,0,30.8182,0,0,0,0,0,"Fix permission denied errors with ping on c8s

They seem to think ping is too dangerous for normal users.

Co-Authored-By: Pierre Riteau <pierre@stackhpc.com>
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/824903
[SEP]
FILES CHANGED:
roles/multi-node-managed-addressing/tasks/main.yml (+1, -0)
ansible/roles/baremetal/tasks/pre-install.yml (+9, -0)
",-0.421163,1.873476,-1.303796,-0.119706,-1.497491,0.019661,0.598067,-0.137867,0.018037,-0.292225,0.346314,-0.192594,0.35527,-0.10692,-0.221489
openstack/kolla-ansible,I821e513d24f2a1c59240d65ad68c3b5f2080e439,1,1,1.0,2.0794,0.0,2,13.5,586,0,Bug Fix,0,0,0,3,0.096774,1.0,0,1.0,4,2,0,0.8374,0.8631,3.0,35.42,16.26,1,0,0.0,1,73.25,0,0,0,0,0,"Fix post-config of OVS for manila-share servers

A host that is in the manila-share group, but not in controllers
network, etc., will fail service deployment if it is not using the
generic manila driver (eg, if it is using the CephFS native driver).
This is because deployment of openvswitch-vswitchd is predicated on
the drivers enabled for manila-share.  However, this predicate is not
universally applied.  Where inventory group membership is used the
dependency on openvswitch-vswitchd presence will fail.

Closes-Bug: #1993285
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/tasks/post-config.yml (+2, -0)
releasenotes/notes/bug-1993285-127fe764e461465a.yaml (+5, -0)
",-1.338667,-1.166501,0.577017,0.38172,0.122382,-0.469048,0.181952,0.349115,-0.013796,-0.309377,0.302241,0.412825,0.140913,-0.165265,0.01639
openstack/kolla-ansible,I827ed30d0247f21478a45d96ae8396ec0e778d3b,1,0,0.825,1.6094,1.0,1,10.57,541,0,Bug Fix,1,0,0,80,0.019043,0.75,0,0.6187,1,1,0,0.8382,0.0,1.0,41.77,12.88,1,1,1.0,1,108.2,0,0,0,0,0,"[CI] [to-revert] Avoid upgrades on CentOS Stream 8

CentOS Stream 8 currently has a bug which makes it require root
privileges for ping.
A workaround patch (see needed-by below) has been proposed, yet
the dependency on previous branches via the upgrade jobs make it
fail the CI.
Thus, this patch temporarily disables those jobs on CentOS Stream 8.
This patch is to be reverted once we patch the affected branches.

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/824681
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -4)
",-1.161235,-0.030584,0.345468,-0.127956,-0.871539,-0.039232,0.355488,0.085466,-0.052832,0.096805,0.276337,0.076968,0.185187,-0.20577,-0.038736
openstack/oslo.utils,I941750b4d49d2d75f0831b24d6dd17f4040f70a2,1,1,0.6667,3.6109,0.0278,3,10.83,607,0,Bug Fix,0,0,0,6,0.027907,1.0,0,0.6667,2,2,0,0.75,1.5155,1.67,30.54,8.64,0,0,0.3889,1,16.4054,0,0,0,0,0,"Fix regex used to mask password

Some use cases are poorly handled by the regex used
to mask password. Indeed when the password contains
quotes or double quotes in the middle such as `pass""word`,
the mask_password method will return `***""word`.

For more details please see
https://bugs.launchpad.net/oslo.utils/+bug/1949623

Closes-Bug: #1949623
(cherry picked from commit 6e17ae1f7959c64dfd20a5f67edf422e702426aa)
(cherry picked from commit 5ce8a7f0f8ecec7a85a23ec3d7a7fb1cad14ceba)
(cherry picked from commit 143d3fbfa1e04778884de5acc08fa6f7fdabb265)
[SEP]
FILES CHANGED:
oslo_utils/tests/test_strutils.py (+14, -0)
releasenotes/notes/fix_mask_password_regex-c0661f95a23369a4.yaml (+7, -0)
oslo_utils/strutils.py (+14, -1)
",-4.522466,0.859108,1.922106,-2.828679,1.284849,0.532176,0.448563,-0.360075,0.102448,0.152896,-0.079439,0.174258,0.138909,-0.109403,-0.158613
openstack/ironic,Id603ae5a4a802dfc8f866b15c8d327d95eba9310,1,0,0.875,2.8332,0.125,4,14.5,221,0,Feature,0,0,0,8,0.016097,1.0,0,0.875,6,2,0,1.0,1.8113,4.0,46.26,12.7,1,0,0.125,1,13.0,0,0,0,0,0,"Set resource_url when getting all ports or portgroups

Since the default value resource_url is None, make sure the
parameter is set to 'ports' when getting all ports.
[SEP]
FILES CHANGED:
ironic/api/controllers/v1/port.py (+4, -2)
releasenotes/notes/fix_pagination_resource_url_ports-8d2696a6a7ab012f.yaml (+6, -0)
ironic/api/controllers/v1/portgroup.py (+2, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+2, -0)
",0.005681,0.021377,-0.419745,1.658017,0.756477,0.258411,-0.083317,-0.723252,0.346805,0.179521,-0.159968,-0.407112,-0.436729,-0.067874,-0.274219
openstack/kolla-ansible,I91d0e23b22319cf3fdb7603f5401d24e3b76a56e,1,1,0.8571,3.7136,0.125,3,10.12,3203,0,Bug Fix,0,0,0,14,0.014271,0.0,0,0.0,4,3,0,0.839,1.406,3.33,35.72,12.99,0,0,0.0,1,78.122,0,24,0,30,0,"Remove classic queue mirroring for internal RabbitMQ

When OpenStack is deployed with Kolla-Ansible, by default there
are no durable queues or exchanges created by the OpenStack
services in RabbitMQ. In Rabbit terminology, not being durable
is referred to as `transient`, and this means that the queue
is generally held in memory.

Whether OpenStack services create durable or transient queues is
traditionally controlled by the Oslo Notification config option:
`amqp_durable_queues`. In Kolla-Ansible, this remains set to
the default of `False` in all services. The only `durable`
objects are the `amq*` exchanges which are internal to RabbitMQ.

More recently, Oslo Notification has introduced support for
Quorum queues [7]. These are a successor to durable classic
queues, however it isn't yet clear if they are a good fit for
OpenStack in general [8].

For clustered RabbitMQ deployments, Kolla-Ansible configures all
queues as `replicated` [1]. Replication occurs over all nodes
in the cluster. RabbitMQ refers to this as 'mirroring of classic
queues'.

In summary, this means that a multi-node Kolla-Ansible deployment
will end up with a large number of transient, mirrored queues
and exchanges. However, the RabbitMQ documentation warns against
this, stating that 'For replicated queues, the only reasonable
option is to use durable queues: [2]`. This is discussed
further in the following bug report: [3].

Whilst we could try enabling the `amqp_durable_queues` option
for each service (this is suggested in [4]), there are
a number of complexities with this approach, not limited to:

1) RabbitMQ is planning to remove classic queue mirroring in
   favor of 'Quorum queues' in a forthcoming release [5].
2) Durable queues will be written to disk, which may cause
   performance problems at scale. Note that this includes
   Quorum queues which are always durable.
3) Potential for race conditions and other complexity
   discussed recently on the mailing list under:
   `[ops] [kolla] RabbitMQ High Availability`

The remaining option, proposed here, is to use classic
non-mirrored queues everywhere, and rely on services to recover
if the node hosting a queue or exchange they are using fails.
There is some discussion of this approach in [6]. The downside
of potential message loss needs to be weighed against the real
upsides of increasing the performance of RabbitMQ, and moving
to a configuration which is officially supported and hopefully
more stable. In the future, we can then consider promoting
specific queues to quorum queues, in cases where message loss
can result in failure states which are hard to recover from.

[1] https://www.rabbitmq.com/ha.html
[2] https://www.rabbitmq.com/queues.html
[3] https://github.com/rabbitmq/rabbitmq-server/issues/2045
[4] https://wiki.openstack.org/wiki/Large_Scale_Configuration_Rabbit
[5] https://blog.rabbitmq.com/posts/2021/08/4.0-deprecation-announcements/
[6] https://fuel-ccp.readthedocs.io/en/latest/design/ref_arch_1000_nodes.html#replication
[7] https://bugs.launchpad.net/oslo.messaging/+bug/1942933
[8] https://www.rabbitmq.com/quorum-queues.html#use-cases

Partial-Bug: #1954925
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/templates/definitions.json.j2 (+1, -5)
ansible/roles/rabbitmq/tasks/upgrade.yml (+22, -0)
releasenotes/notes/remove-queue-mirroring-for-rabbitmq-d54b9e7e25e57a88.yaml (+12, -0)
",-3.086199,-0.189071,3.445758,-0.505462,-0.169574,0.74821,-1.522709,-0.345287,-0.378231,0.279121,-0.903325,0.770989,-0.080425,-0.371441,-0.233957
openstack/ironic-python-agent-builder,I9b6e03f50a4eb2484a04748e51d7348401b6ca04,1,0,1.0,4.3175,0.7432,7,18.0,598,0,CI,0,0,0,1,0.009346,1.0,0,1.0,4,5,0,1.0,2.1396,2.29,14.67,17.2,1,0,0.3514,1,7.9733,0,0,0,0,0,"Remove centos7 job, python2 support

This change does the following:
- Removes the centos7 job, it uses python2 even though python2 was
  dropped from IPA in 2019.
  (see Ifd0e0b99bb82a7d7e82d6c14309468196f5734fc)
- Allow 60-ironic-python-agent-ramdisk-install to assume python3 and
  the venv module, the remaining centos7-python3 job will also test this
- Replaces the pip-and-virtualenv element with ensure-venv.
  pip-and-virtualenv exists to install virtualenv for python2
  environments, and it is unmaintained and mostly technical debt.
[SEP]
FILES CHANGED:
dib/ironic-python-agent-ramdisk/environment.d/20-ipa-distro-family.bash (+1, -1)
dib/ironic-python-agent-ramdisk/install.d/ironic-python-agent-ramdisk-source-install/60-ironic-python-agent-ramdisk-install (+4, -28)
zuul.d/ironic-python-agent-builder-jobs.yaml (+0, -20)
releasenotes/notes/python2-removal-dee895550b1959af.yaml (+10, -0)
dib/ironic-python-agent-ramdisk/element-deps (+1, -1)
zuul.d/project.yaml (+2, -4)
dib/ironic-python-agent-ramdisk/post-install.d/99-remove-extra-packages (+1, -1)
",-1.722525,0.054501,0.507255,-0.522771,0.453757,-0.564002,0.692223,0.119978,-0.183012,-0.057836,0.098945,0.382372,0.276673,0.191632,0.421168
openstack/ironic-python-agent-builder,I31dd48509ad029c88ee79415516771019cd1314e,1,0,1.0,2.3979,0.6,1,9.0,99,0,Feature,1,0,0,2,0.01105,0.8333,0,0.8333,1,1,0,1.0,0.0,1.0,28.5,16.93,1,0,1.0,1,9.0,0,0,0,0,0,"Move centos9 jobs from experimental to check
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+4, -6)
",1.98932,0.958296,1.372344,0.128992,0.756819,0.272795,0.468537,0.658366,-0.776904,0.09998,-0.062763,-0.033584,0.068591,0.055471,0.58272
openstack/ironic-python-agent,I7ed34e595215194a589c2f1cd0b39ff0336da8f1,1,0,0.8889,5.3845,0.2074,7,65.0,461,0,Feature,0,0,0,9,0.017544,0.9,0,0.8,4,2,0,0.875,2.173,2.29,-4.91,34.62,1,0,0.5576,1,2.1147,0,0,0,0,0,"SoftwareRAID: Use efibootmgr (and drop grub2-install)

Move the software RAID code path from grub2-install to
efibootmgr:

- remove the UEFI efibootmgr exception for software RAID
- create and populate the ESPs on the holder disks
- update the NVRAM with all ESPs (the component devices
  of the ESP mirror, use unique labels to avoid unintentional
  deduplication of entries in the NVRAM)

Story: #2009794
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+3, -3)
ironic_python_agent/tests/unit/test_efi_utils.py (+75, -8)
releasenotes/notes/move_swraid_to_efibootmgr-d87c1bfde1661fb5.yaml (+7, -0)
ironic_python_agent/efi_utils.py (+64, -9)
ironic_python_agent/tests/unit/extensions/test_image.py (+12, -12)
ironic_python_agent/tests/unit/test_hardware.py (+7, -7)
ironic_python_agent/extensions/image.py (+4, -6)
",-1.298242,-0.929291,0.220472,0.190415,0.702494,-0.464778,-0.106418,0.572558,-0.294605,-0.277857,0.028093,0.036888,0.226373,0.405011,-0.285146
openstack/kolla,I8ee32e53cda581493b2a4bb73ca72ab05014b9d4,1,1,0.8272,4.0254,0.2909,13,17.9,1324,0,Bug Fix,0,0,0,81,0.019263,1.0,0,0.8272,3,4,0,0.808,3.535,2.15,24.19,14.76,1,0,0.5091,0,23.6429,0,20,0,8,0,"CI: make it work again

Python changes:
- limit pip to 20.x as this is last version working on both Python 2 and 3.
- cap 'setuptools' to be older than 58 to have use_2to3 functionality
  (fixes 'anyjson' installation)
- upgrade pip in 'elasticsearch-curator' image to get it built on CentOS 7

Unbuildable images:
- 'bifrost-base' under CentOS 8
  (Error: Cannot find a valid baseurl for repo: epel)
- 'monasca-grafana' under CentOS 7/8
- 'sensu-client' under CentOS 7
  (aws-eventstream requires Ruby version >= 2.3)

- dropped *-upgrade CI jobs as Stein is EOL

- pin 'qpid-proton-c' package for CentOS 7 to not install EPEL one
  (cinder-volume, openstack-base and tripleoclient)

- bump 'libvirt-python' in 'masakari-monitors' to 7.10.0
  (newer branches install package from distribution but CentOS 7 lacks
  it)

- pin 'unf_ext' gem in Sensu images as CentOS 7 lacks Ruby 2.2+
  (fixed sensu-server)

- install 'ca-certificates' for newer Let's Encrypt certificates support
  (so we can fetch upper-constraints)

- make Zuul fetch openstack/requirements project files
   (make 'openstack-base' pass) (like 2nd fix)

Co-Authored-by: Pierre Riteau <pierre@stackhpc.com>
Closes-Bug: #1943617
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/826464
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+0, -4)
docker/masakari/masakari-monitors/Dockerfile.j2 (+1, -1)
kolla/image/build.py (+4, -0)
tests/playbooks/run.yml (+8, -1)
docker/openstack-base/Dockerfile.j2 (+5, -1)
docker/elasticsearch/elasticsearch-curator/Dockerfile.j2 (+3, -1)
tests/playbooks/pre.yml (+7, -1)
.zuul.d/base.yaml (+3, -0)
.zuul.d/ubuntu.yaml (+0, -4)
docker/cinder/cinder-volume/Dockerfile.j2 (+2, -0)
docker/sensu/sensu-server/Dockerfile.j2 (+1, -1)
docker/sensu/sensu-client/Dockerfile.j2 (+2, -1)
docker/tripleoclient/Dockerfile.j2 (+3, -1)
",-2.466383,0.692897,3.943121,-1.898314,-0.536144,-0.314736,-0.825508,0.07969,-0.973001,-0.408167,-0.769375,0.418226,0.119017,0.258101,-0.001111
openstack/kolla,Ic8ebe4089c84f923c24697d632eb294a262059a8,1,0,0.619,1.0986,1.0,1,9.33,246,0,Feature,0,0,0,42,0.02472,0.6667,0,0.4127,2,1,0,0.8095,0.0,2.0,25.14,13.73,0,0,0.0,0,82.0,0,0,0,0,0,"openstack-base: drop anyjson

It is required only in Tacker and fails to be installed.

And even Tacker does not use it...

(cherry picked from commit ec06d44d2c095199a9e14aef2f036e957082537e)
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -2)
",0.089404,-1.0343,-1.568545,-1.554596,0.413388,-0.037208,0.676485,-0.515807,-0.311421,0.21522,-0.276003,-0.043465,0.180656,0.145243,-0.082891
openstack/kolla,Ic8ebe4089c84f923c24697d632eb294a262059a8,0,0,0.6279,1.0986,1.0,1,9.33,246,0,Feature,0,0,0,43,0.025279,0.7143,0,0.4485,2,1,0,0.811,0.0,2.0,25.14,13.73,0,0,0.0,0,82.0,0,0,0,0,0,"openstack-base: drop anyjson

It is required only in Tacker and fails to be installed.

And even Tacker does not use it...

(cherry picked from commit ec06d44d2c095199a9e14aef2f036e957082537e)
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -2)
",0.089404,-1.0343,-1.568545,-1.554596,0.413388,-0.037208,0.676485,-0.515807,-0.311421,0.21522,-0.276003,-0.043465,0.180656,0.145243,-0.082891
openstack/kolla,Ic8ebe4089c84f923c24697d632eb294a262059a8,0,0,0.6136,1.0986,1.0,1,9.33,246,0,Feature,0,0,0,44,0.025837,0.625,0,0.3835,2,1,0,0.8047,0.0,2.0,25.14,13.73,0,0,0.0,0,82.0,0,0,0,0,0,"openstack-base: drop anyjson

It is required only in Tacker and fails to be installed.

And even Tacker does not use it...

(cherry picked from commit ec06d44d2c095199a9e14aef2f036e957082537e)
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -2)
",0.089404,-1.0343,-1.568545,-1.554596,0.413388,-0.037208,0.676485,-0.515807,-0.311421,0.21522,-0.276003,-0.043465,0.180656,0.145243,-0.082891
openstack/oslo.utils,Ia02154a1eb04434658a21adf82599ae55302e310,1,0,0.7143,3.8712,1.0,3,5.53,975,0,CI,0,0,0,7,0.027888,0.875,0,0.625,0,3,0,0.8,0.6953,0.0,5.02,10.72,0,0,0.0,1,20.3125,0,0,0,0,0,"Dropping lower constraints testing

We facing errors related to the new pip resolver, this
topic was discussed on the ML and QA team proposed to
to test lower-constraints [1].

I propose to drop this test because the complexity and recurring pain needed
to maintain that now exceeds the benefits provided by this mechanismes.

Contain also the patch[2] to remove the tox environment and the patch[3] to
remove the lower-constraints.txt file.

https://review.opendev.org/c/openstack/oslo.utils/+/787867

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019390.html
[2] https://review.opendev.org/c/openstack/oslo.utils/+/772630
[3] https://review.opendev.org/c/openstack/oslo.utils/+/787867

(cherry picked from commit 4cc3a558244769017ed5d8c3a6e4a63429d1e8e9)
(cherry picked from commit c4e3576c63f8f12dc1b2c3ff9bf0350042cd1703)
(cherry picked from commit 125617dcb444739eb19e2d4f3372b65fa49e926a)
[SEP]
FILES CHANGED:
.zuul.yaml (+0, -1)
lower-constraints.txt (+0, -40)
tox.ini (+0, -6)
",-3.852063,2.870292,3.116338,-1.897756,0.15938,0.804524,-0.49646,-0.676285,-0.476688,-0.028686,-0.851745,0.681846,-0.057671,0.176279,-0.108621
openstack/ironic,I1328e2f07621bf7e39b96eb4a7ddb66c9a2b65bb,1,0,0.9375,4.9127,0.3852,16,11.67,265,0,Bug Fix,0,0,0,16,0.01213,1.0,0,0.9375,6,2,0,1.0,3.6592,4.5,25.79,18.38,1,0,0.4,1,1.9485,0,0,0,0,0,"Fix resource_url in the remaining resources

Node history was particularly affected: limit was not converted from
string to integer, so ""next"" link was never added.

Add some safeguards to the generic API code.
[SEP]
FILES CHANGED:
ironic/api/controllers/v1/port.py (+4, -5)
ironic/api/controllers/v1/collection.py (+6, -2)
ironic/tests/unit/api/controllers/v1/test_conductor.py (+8, -4)
ironic/api/controllers/v1/conductor.py (+1, -1)
ironic/tests/unit/api/controllers/v1/test_deploy_template.py (+9, -4)
ironic/api/controllers/v1/portgroup.py (+3, -6)
ironic/api/controllers/v1/volume_connector.py (+1, -1)
ironic/tests/unit/api/controllers/v1/test_port.py (+3, -2)
releasenotes/notes/api-none-3fdca1ccbb64d9b0.yaml (+12, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+10, -0)
ironic/api/controllers/v1/allocation.py (+2, -2)
ironic/tests/unit/api/controllers/v1/test_allocation.py (+10, -4)
ironic/api/controllers/v1/chassis.py (+4, -4)
ironic/api/controllers/v1/deploy_template.py (+1, -0)
ironic/api/controllers/v1/volume_target.py (+1, -1)
ironic/api/controllers/v1/node.py (+8, -16)
",1.231498,-2.19882,0.18471,0.032005,-0.471871,0.312444,-0.034608,-0.350482,0.299799,0.086485,-0.429262,-0.20198,-0.193619,0.025834,-0.292755
openstack/kolla-ansible,Ifa2b2ea8622f56c34b8f7f37fee53133272ff925,1,1,0.8939,4.4067,0.7407,2,9.67,336,0,Bug Fix,0,1,0,66,0.023792,1.0,0,0.8939,4,2,0,0.8398,0.5033,3.0,-1.35,16.28,0,0,0.0,1,4.0976,0,6,0,6,0,"Revert ""Use friendly target names in Prometheus""

This reverts commit 4ff65b7661ea06e9fa8631c4eb82232e03af77d7.

Reason for revert: adds assumptions about inventory_hostname being resolvable.

Closes-Bug: #1955563
(cherry picked from commit c358a2d586ebc6bd03f2060ac36295f003dfa17c)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-1955563-42a14bb080e15df2.yaml (+9, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+12, -60)
",-0.694611,-0.629166,-1.517266,-2.161793,0.788881,0.24109,1.177924,-0.041035,0.628104,0.19647,0.278156,-0.092182,-0.058154,-0.037097,-0.154625
openstack/kolla-ansible,If5c7f19c315bd11c02e3c3857c9497855eea2b7a,1,0,0.6,1.7918,0.2,1,4.5,196,0,CI,0,0,0,45,0.026393,1.0,0,0.6,4,1,0,0.8406,0.0,4.0,70.67,6.24,1,0,0.0,0,32.6667,0,0,0,0,0,"CI: make it work again (k-a side)

1. limit websocket-client to 0.59 as last Python 2 version
   (pip 8 installs 1.1.0, pip 20 installs 0.59)
[SEP]
FILES CHANGED:
ansible/roles/baremetal/tasks/install.yml (+4, -1)
",1.428859,-0.406554,-0.246857,-0.21816,-0.201436,-0.059522,0.021392,0.140916,-0.803718,0.821436,-0.510905,-0.019951,0.005994,0.459018,0.144318
openstack/octavia-dashboard,I25ce292f962cf6a0d6f017fe7bc47aaed0790efc,1,0,0,3.1355,0.3182,7,17.33,338,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,8,3,0,0.2414,2.5839,6.71,55.83,13.09,0,0,0.0,1,14.6957,0,0,0,0,0,"Fix invalid value range for member weight

Octavia supports setting the weight of members from 0 to 256, but
in Horizon the value 0 was not accepted. This fix allows entering
the value 0 as well, which is important for putting a member into
DRAINING state.

Story: 2009804
Task: 44362
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/members/actions/edit-member/modal.html (+1, -1)
releasenotes/notes/fix-member-weight-value-range-9310678f967c771a.yaml (+7, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/members/actions/edit-member/modal.controller.js (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/members/members.help.html (+3, -2)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/members/members.controller.js (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/members/actions/edit-member/modal.controller.spec.js (+1, -1)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/members/members.html (+1, -1)
",-0.404483,-1.202848,-0.651356,0.497371,-0.278402,0.680438,-0.471926,-0.378761,0.373974,0.447112,-0.02853,0.278928,0.357913,-0.049567,-0.114881
openstack/openstack-ansible-os_aodh,I8ad644ed723e05058be92e5f67a4d7b7542a7071,1,1,0,0.6931,0.0,1,11.0,120,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,-11.98,18.95,0,0,0.0,0,60.0,0,6,0,17,0,"Ensure libxml2 is installed on debian systems

Closes-Bug: 1958434
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",1.973867,0.585013,-0.01155,-0.441024,-0.348602,0.878577,-0.101206,0.100101,0.021943,-0.029526,0.546452,-0.110125,0.231129,0.107214,0.3821
openstack/kolla-ansible,I73f80cd2c81a3944de0933e60f5768956a1a3b70,1,1,0,2.3026,0.1111,2,37.0,288,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.8413,0.7642,3.0,0.08,25.61,1,0,0.0,1,28.8,0,6,0,9,0,"Fix bad openstack command while registering IDP

This fixes a bug in registering identity providers

The bug was caused by a missing `=` in the openstack command

Add the missing `=` after `--os-user-domain-name`

Closes-Bug: #1959022
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1959022-e3bb9448414b4ebe.yaml (+7, -0)
ansible/roles/keystone/tasks/register_identity_providers.yml (+1, -1)
",-1.371492,-1.029602,-0.864381,-1.233282,0.574828,-0.054901,0.418656,0.111614,0.534355,0.242194,0.150716,-0.305974,0.546761,0.047869,0.055719
openstack/kolla-ansible,I73f80cd2c81a3944de0933e60f5768956a1a3b70,1,1,0.9091,2.3026,0.1111,2,42.0,357,0,Bug Fix,0,0,0,33,0.043025,1.0,0,0.9091,4,2,0,0.8421,0.7642,3.0,-4.99,27.28,1,0,0.0,1,35.7,0,6,0,9,0,"Fix bad openstack command while registering IDP

This fixes a bug in registering identity providers

The bug was caused by a missing `=` in the openstack command

Add the missing `=` after `--os-user-domain-name`

Closes-Bug: #1959022
(cherry picked from commit f955383b9c8cbc38dc1a8d03323ba6d9e83d3664)
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1959022-e3bb9448414b4ebe.yaml (+7, -0)
ansible/roles/keystone/tasks/register_identity_providers.yml (+1, -1)
",-1.371492,-1.029602,-0.864381,-1.233282,0.574828,-0.054901,0.418656,0.111614,0.534355,0.242194,0.150716,-0.305974,0.546761,0.047869,0.055719
openstack/openstack-ansible,I2e41323cc8dbd0e93679de9360ad6359ab90710b,1,0,0,2.9957,0.3684,3,18.5,283,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,1.0,1.5294,1.33,25.72,17.13,1,0,0.0,0,14.15,0,0,0,0,0,"Fix infra upgrade

Since we launch upgrade script from another bash script, we don't really alter environmental
variables, which remain to be defined in scope of gate-check-commit. So we explicitly
unset them and re-using unset
[SEP]
FILES CHANGED:
scripts/upgrade-utilities/unset-ansible-env.rc (+7, -0)
scripts/gate-check-commit.sh (+4, -0)
scripts/run-upgrade.sh (+1, -7)
",0.944744,-1.283016,0.283224,0.489339,0.083729,-0.463948,0.269715,-0.95539,-0.495155,-0.075461,-0.460366,0.098609,0.171987,0.041504,0.064441
openstack/oslo.utils,Ia02154a1eb04434658a21adf82599ae55302e310,1,0,0.75,4.0073,1.0,3,4.76,1221,0,CI,0,0,0,8,0.026846,0.8889,0,0.6667,0,3,0,0.8333,0.6857,0.0,10.05,10.64,0,0,0.0,1,22.2,0,0,0,0,0,"Dropping lower constraints testing

We facing errors related to the new pip resolver, this
topic was discussed on the ML and QA team proposed to
to test lower-constraints [1].

I propose to drop this test because the complexity and recurring pain needed
to maintain that now exceeds the benefits provided by this mechanismes.

Contain also the patch[2] to remove the tox environment and the patch[3] to
remove the lower-constraints.txt file.

https://review.opendev.org/c/openstack/oslo.utils/+/787867

NOTE(damani): The lower-constraints.txt has been removed and about the
.zuul.yaml need to adapt the jobs name.

Conflicts:
    tox.ini
    lower-constraints.txt
    .zuul.yaml

[1] http://lists.openstack.org/pipermail/openstack-discuss/2020-December/019390.html
[2] https://review.opendev.org/c/openstack/oslo.utils/+/772630
[3] https://review.opendev.org/c/openstack/oslo.utils/+/787867

(cherry picked from commit 4cc3a558244769017ed5d8c3a6e4a63429d1e8e9)
(cherry picked from commit c4e3576c63f8f12dc1b2c3ff9bf0350042cd1703)
(cherry picked from commit 125617dcb444739eb19e2d4f3372b65fa49e926a)
(cherry picked from commit 03ed19655230005ce69faefef993f6fa17773f18)
[SEP]
FILES CHANGED:
.zuul.yaml (+0, -1)
lower-constraints.txt (+0, -46)
tox.ini (+0, -7)
",-3.852063,2.870292,3.116338,-1.897756,0.15938,0.804524,-0.49646,-0.676285,-0.476688,-0.028686,-0.851745,0.681846,-0.057671,0.176279,-0.108621
openstack/ironic,I38bf39e4e4845415640b3468e9fb3029f70dcded,1,0,0.9412,2.4849,0.2727,4,5.4,223,0,Feature,0,0,0,17,0.011692,0.0,0,0.0,2,2,0,1.0,1.8586,2.0,22.75,18.46,1,0,0.0,1,18.5833,0,0,0,0,0,"Return non-zero exit code on failures

Launcher.wait() does not raise, it returns an integer code. Propagate it
to sys.exit() so that failures are correctly recognized.
[SEP]
FILES CHANGED:
releasenotes/notes/service-exit-77bcf3a538fab4bc.yaml (+5, -0)
ironic/cmd/singleprocess.py (+1, -1)
ironic/cmd/api.py (+1, -1)
ironic/cmd/conductor.py (+1, -1)
",0.451604,-0.138626,-0.10706,0.948576,-0.024989,0.756854,-0.06994,-1.341237,-0.105026,0.360631,0.253133,-0.175813,0.083429,0.130584,-0.184553
openstack/openstack-ansible,I3fdb94f707c9972b5ddb6d9f6fba4af92f3c4e3b,1,0,1.0,1.7918,0.2,1,12.67,264,0,Bug Fix,0,0,0,1,0.5,0.0,0,0.0,2,1,0,1.0,0.0,2.0,42.59,11.38,0,0,0.0,0,44.0,0,0,0,0,0,"Fix infra scenario repo server cluster

The container affinity was not set for the repo server ansible group
so only one was created, rather than 3.

To test repo server synchronisation we need 3 repo servers.
[SEP]
FILES CHANGED:
etc/openstack_deploy/openstack_user_config.yml.aio.j2 (+4, -1)
",0.682824,-2.135149,0.180313,0.459489,-0.2008,0.095776,-0.037456,-0.003188,-0.460525,-0.058074,-0.377406,-0.111425,-0.116404,0.240103,-0.085921
openstack/ironic,Ib460622d69a9cb1cb82e796a6ab294bbbb40c359,1,0,0.9444,4.2485,0.0,5,9.8,376,0,Feature,0,0,0,18,0.012287,1.0,0,0.9444,4,2,0,1.0,1.8996,2.4,39.77,14.53,1,0,0.4493,1,5.3714,0,0,0,0,0,"Wait for conductor start before notifying systemd

Currently, the launcher first notifies systemd, then starts checking the
services (RPC and WSGI). So any failures will be reported, but only
after systemd declares the service ready.

This change adds a polling loop to make sure RpcService.start() finishes
successfully.
[SEP]
FILES CHANGED:
ironic/common/rpc_service.py (+22, -0)
ironic/cmd/singleprocess.py (+5, -0)
ironic/tests/unit/common/test_rpc_service.py (+31, -0)
ironic/cmd/conductor.py (+6, -0)
releasenotes/notes/service-wait-e85cbe7978f61764.yaml (+5, -0)
",-0.243035,-1.705467,-0.156523,0.760947,-0.326954,0.096285,-0.019918,-0.346703,-0.151807,0.252321,-0.105889,-0.194888,0.307698,0.283115,-0.206862
openstack/kolla,I8be5bdf5f1a62751aefe6bd0959e8f558fcfe591,1,1,0.8293,4.0073,0.3333,3,7.64,691,0,Bug Fix,0,0,0,82,0.019249,0.0,0,0.0,3,3,0,0.7984,1.0811,2.67,24.85,10.2,1,0,0.0,1,12.5636,0,0,0,0,0,"Use distro provided GRUB efi

Use distro provided GRUB efi instead of creating it like ironic GRUB
setup doc[1]. This avoids below ubuntu ironic-python-agent images PXE
booting failure.
----------
error: invalid magic number.
error: you need to load the kernel first.

Press any key to continue...
----------

This also fixes x86_64 uefi pxe booting issue by setting up GRUB efi
for x86_64.

Besides, GRUB setup only needs to do once at bootstrap stage.

[1]:
https://docs.openstack.org/ironic/train/install/configure-pxe.html#uefi-pxe-GRUB-setup

Closes-Bug: #1879265
(cherry picked from commit b6e057d694d90d50ea278411d0edf20afe427e13)
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+26, -14)
docker/ironic/ironic-pxe/Dockerfile.j2 (+4, -4)
releasenotes/notes/fix-ubuntu-ironic-python-agent-pxe-booting-issue-95adaf9249207d5b.yaml (+6, -0)
",-2.948161,0.084902,1.792952,-1.522604,0.118161,-0.11877,-0.230549,0.414315,-0.173308,-0.197466,-0.036468,-0.115702,0.062292,0.015955,-0.143832
openstack/kolla,I8be5bdf5f1a62751aefe6bd0959e8f558fcfe591,1,1,0.8313,4.0431,0.3393,3,7.64,691,0,Bug Fix,0,0,0,83,0.01924,1.0,0,0.8313,3,3,0,0.8,1.1358,2.67,24.85,10.2,1,0,0.0,1,12.1228,0,0,0,0,0,"Use distro provided GRUB efi

Use distro provided GRUB efi instead of creating it like ironic GRUB
setup doc[1]. This avoids below ubuntu ironic-python-agent images PXE
booting failure.
----------
error: invalid magic number.
error: you need to load the kernel first.

Press any key to continue...
----------

This also fixes x86_64 uefi pxe booting issue by setting up GRUB efi
for x86_64.

Besides, GRUB setup only needs to do once at bootstrap stage.

[1]:
https://docs.openstack.org/ironic/train/install/configure-pxe.html#uefi-pxe-GRUB-setup

Closes-Bug: #1879265
(cherry picked from commit b6e057d694d90d50ea278411d0edf20afe427e13)
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+26, -14)
docker/ironic/ironic-pxe/Dockerfile.j2 (+5, -5)
releasenotes/notes/fix-ubuntu-ironic-python-agent-pxe-booting-issue-95adaf9249207d5b.yaml (+6, -0)
",-2.948161,0.084902,1.792952,-1.522604,0.118161,-0.11877,-0.230549,0.414315,-0.173308,-0.197466,-0.036468,-0.115702,0.062292,0.015955,-0.143832
openstack/kolla,I8be5bdf5f1a62751aefe6bd0959e8f558fcfe591,1,1,0.8333,4.0431,0.3393,3,7.64,691,0,Bug Fix,0,0,0,84,0.019222,1.0,0,0.8333,3,3,0,0.8015,1.1358,2.67,24.85,10.2,1,0,0.0,1,12.1228,0,0,0,0,0,"Use distro provided GRUB efi

Use distro provided GRUB efi instead of creating it like ironic GRUB
setup doc[1]. This avoids below ubuntu ironic-python-agent images PXE
booting failure.
----------
error: invalid magic number.
error: you need to load the kernel first.

Press any key to continue...
----------

This also fixes x86_64 uefi pxe booting issue by setting up GRUB efi
for x86_64.

Besides, GRUB setup only needs to do once at bootstrap stage.

[1]:
https://docs.openstack.org/ironic/train/install/configure-pxe.html#uefi-pxe-GRUB-setup

Closes-Bug: #1879265
(cherry picked from commit b6e057d694d90d50ea278411d0edf20afe427e13)
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+26, -14)
docker/ironic/ironic-pxe/Dockerfile.j2 (+5, -5)
releasenotes/notes/fix-ubuntu-ironic-python-agent-pxe-booting-issue-95adaf9249207d5b.yaml (+6, -0)
",-2.948161,0.084902,1.792952,-1.522604,0.118161,-0.11877,-0.230549,0.414315,-0.173308,-0.197466,-0.036468,-0.115702,0.062292,0.015955,-0.143832
openstack/kolla,Ic6e3ae4ff40c6ce5a5c0646ed309a2938903f6c0,1,0,0,2.7726,0.0,2,8.71,447,0,Feature,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.803,0.9183,2.0,39.89,13.32,0,0,0.0,1,27.9375,0,0,0,0,0,"Ensure set_configs sets execute bit on directories

While handling permissions for directories, set_configs.py configures them
same as for files - i.e. 0640 set in config.json which works fine for file
will cause any potential subdirectories to lack traverse permission.

Check and permission change was added to handle_permissions function
to add +x if +r is present for user, group, others.
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+10, -0)
releasenotes/notes/set_config-directory-execute-permission-8ab919b7b17025d2.yaml (+5, -0)
",-0.261845,-1.52392,0.284196,0.475459,0.352575,-0.546748,0.360669,-0.425547,-0.031038,0.097793,-0.256659,-1.010906,0.076451,0.195897,0.022395
openstack/octavia,If7d68c95173b8da66050659d1fb86225880dafdd,1,0,1.0,3.1781,0.3478,3,13.0,290,0,Bug Fix,0,0,0,1,0.043478,1.0,0,1.0,6,2,0,0.556,1.474,4.0,48.3,13.41,1,0,0.2609,1,12.0833,0,0,0,0,0,"Fix detection of member operating status DRAIN

When querying the status from HAProxy all values get read as
strings. Because the check wrongly assumed integer type values
it never detected the DRAIN status.

Story: 2009817
Task: 44389
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/haproxy_query.py (+7, -5)
octavia/tests/unit/amphorae/backends/utils/test_haproxy_query.py (+3, -3)
releasenotes/notes/fix-drain-status-detection-b9395fa4fe8c936f.yaml (+5, -0)
",0.121013,-1.588094,-0.512344,-0.032856,-0.267403,0.495739,-0.65413,-0.16446,0.259973,-0.054314,0.084798,-0.060011,0.275602,0.220609,-0.170135
openstack/octavia-dashboard,I1383f94e7efe8629d588b32af734e042544d0f11,1,0,1.0,1.7918,0.0,2,10.0,115,0,Feature,0,0,0,2,0.043478,0.0,0,0.0,6,2,0,0.2667,0.7219,4.0,10.56,16.0,1,0,0.0,1,19.1667,0,0,0,0,0,"Display Draining state correctly

Story: 2009817
Task: 44388
[SEP]
FILES CHANGED:
octavia_dashboard/static/dashboard/project/lbaasv2/loadbalancers/loadbalancers.service.js (+1, -0)
releasenotes/notes/add-draining-operating-status-48f59a204371ff0d.yaml (+4, -0)
",1.385591,0.208278,-0.895551,-0.910866,-0.496999,1.641507,-1.247973,0.026445,0.45796,-0.271681,0.503665,0.567284,0.198439,0.80176,-0.509496
openstack/oslo.utils,I941750b4d49d2d75f0831b24d6dd17f4040f70a2,1,1,0.7778,3.6109,0.0278,3,11.67,676,0,Bug Fix,0,0,0,9,0.025568,1.0,0,0.7778,2,2,0,0.8571,1.5155,1.67,27.0,9.24,0,0,0.3889,1,18.2703,0,6,0,22,0,"Fix regex used to mask password

Some use cases are poorly handled by the regex used
to mask password. Indeed when the password contains
quotes or double quotes in the middle such as `pass""word`,
the mask_password method will return `***""word`.

For more details please see
https://bugs.launchpad.net/oslo.utils/+bug/1949623

Closes-Bug: #1949623
(cherry picked from commit 6e17ae1f7959c64dfd20a5f67edf422e702426aa)
(cherry picked from commit 5ce8a7f0f8ecec7a85a23ec3d7a7fb1cad14ceba)
(cherry picked from commit 143d3fbfa1e04778884de5acc08fa6f7fdabb265)
(cherry picked from commit 65aa4226d4bf286468da6df6759e364c1eb3e049)
[SEP]
FILES CHANGED:
oslo_utils/tests/test_strutils.py (+14, -0)
releasenotes/notes/fix_mask_password_regex-c0661f95a23369a4.yaml (+7, -0)
oslo_utils/strutils.py (+14, -1)
",-4.522466,0.859108,1.922106,-2.828679,1.284849,0.532176,0.448563,-0.360075,0.102448,0.152896,-0.079439,0.174258,0.138909,-0.109403,-0.158613
openstack/octavia,Iccc50867b28dd20ee45cad623ab19f23ff865682,1,0,0.7042,1.7918,0.8,1,17.67,376,0,Feature,0,0,0,71,0.006675,0.3636,0,0.2561,4,1,0,0.5577,0.0,4.0,50.03,14.61,0,0,0.0,0,62.6667,0,0,0,0,0,"Remove incorrect info message

In amphorav2 the controller now waits for the completion of the job to
send a keepalive to taskflow.  This patch is a follow up patch to
I6619ba117f7051fe44086389789bc6e2810fd23d, it removes a INFO message
that no longer makes sense because it is displayed after the
completion of the flow.
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/controller_worker.py (+1, -4)
",-0.053635,-1.940488,-0.4264,-0.549599,0.153086,0.071833,0.727978,-0.222501,0.44521,0.176633,-0.386218,0.183399,-0.173475,0.135412,0.185863
openstack/ironic,I352429065eedb1dcbbfa803ec2814c3e870c3be9,0,0,0,5.0752,0.0063,7,11.45,833,0,CI,0,0,1,0,0.0,0.2162,0,0.0,4,3,0,1.0,2.0576,2.0,44.81,14.42,1,0,0.283,1,5.2062,0,0,0,0,0,"Delete resource provider after node deletion.

After node deletion resource provider exists for some
time due to the reconcile time lag of the nova-compute
service.

Time gap can last minutes, to potentially hours in.

Placement can schedule upon a deleted baremetal node,
which causes error behavior. Time gap depends on nova
option 'report_interval' as well as the general overhead
of interaction dependent upon the size of a deployment.

If we decrease the value the gap is less.
But it increases load in deployment,
especially in high-loaded one.
So the option is not a cure.

The patch removes resource provider in placement after
node deletion. It doesn't solve the problem of nova and
ironic synchronization, but it's ""nice thing"" which helps.

Story: #1248022
Task: #9332
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
ironic/conductor/manager.py (+2, -0)
ironic/tests/unit/conductor/test_manager.py (+45, -0)
ironic/conf/__init__.py (+2, -0)
releasenotes/notes/bug-1248022-71a6f5e04f30775e.yaml (+14, -0)
ironic/conf/placement.py (+32, -0)
ironic/common/placement.py (+62, -0)
",-1.744171,-1.746127,1.995028,-0.275596,-0.440914,0.099018,0.319422,0.028827,0.326759,-0.318893,-0.077655,0.40035,0.048932,0.000636,0.007539
openstack/openstack-ansible,I09cb19803ffa9dbad3cf99c4ebaff027a32cbd06,1,0,1.0,0.6931,1.0,1,14.0,123,0,Doc,0,0,0,2,0.285714,0.0,1,0.0,2,1,0,1.0,0.0,2.0,29.47,17.03,0,1,0.0,0,61.5,0,0,0,0,0,"[DOC] A centos deployment host does not need the RDO repo installing
[SEP]
FILES CHANGED:
deploy-guide/source/deploymenthost.rst (+0, -1)
",2.187383,0.628345,1.099519,0.537927,-0.176863,0.455734,0.530132,0.545972,-0.610818,0.094451,0.189571,0.483467,-0.140663,-0.483404,-0.994463
openstack/ironic-python-agent,I7cedd5df1836f6c571b84fc8418bf5608bcebf9d,1,0,1.0,1.3863,1.0,1,7.0,87,0,Feature,1,0,0,14,0.013372,0.8571,0,0.8571,1,1,0,0.8824,0.0,1.0,18.44,19.94,0,0,1.0,1,21.75,0,0,0,0,0,"Remove legacy centos7 build jobs
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -3)
",3.144641,0.866144,1.186835,-0.023278,1.144307,0.291453,0.318283,0.843711,-0.39249,-0.598662,0.064131,-0.312821,0.194254,-0.399214,0.334563
openstack/octavia,Ic08ad89b4e07e0fe8a80b3e5db6d50276aafff82,1,0,1.0,6.1612,0.3446,19,11.5,500,0,Feature,0,0,0,1,0.05,0.6667,0,0.6667,7,1,0,0.5594,3.8757,4.79,-40.25,16.77,1,0,0.9831,0,1.0549,0,0,0,0,0,"Rename Context to RequestContext

If castellan is used, it requires one of the following context types to
be provided during init: KeystonePassword, KeystoneToken or
RequestContext [1]

Also it makes sense to be consistent across projects and with
oslo_context regarding context class naming.

[1] https://opendev.org/openstack/castellan/src/commit/86712360f345866e108e12eda1075101635dd1ec/castellan/key_manager/barbican_key_manager.py#L208-L210
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+24, -12)
octavia/common/context.py (+1, -1)
octavia/tests/functional/api/v2/test_quotas.py (+34, -17)
octavia/tests/functional/api/v2/test_amphora.py (+24, -12)
octavia/tests/functional/api/v2/test_flavors.py (+10, -5)
octavia/tests/functional/api/v2/test_l7policy.py (+24, -12)
octavia/tests/functional/api/v2/test_flavor_profiles.py (+10, -5)
octavia/tests/functional/api/v2/test_pool.py (+24, -12)
octavia/controller/worker/v2/tasks/notification_tasks.py (+2, -1)
octavia/tests/unit/controller/worker/v2/tasks/test_notification_tasks.py (+5, -4)
octavia/tests/functional/api/v2/test_availability_zones.py (+10, -5)
octavia/tests/unit/common/test_policy.py (+12, -12)
octavia/tests/functional/api/v2/test_l7rule.py (+22, -11)
octavia/tests/functional/api/v2/test_member.py (+22, -11)
octavia/api/common/hooks.py (+2, -1)
octavia/tests/functional/api/v2/test_load_balancer.py (+42, -21)
octavia/tests/functional/api/v2/test_listener.py (+28, -14)
octavia/tests/functional/api/v2/test_provider.py (+4, -2)
octavia/tests/functional/api/v2/test_availability_zone_profiles.py (+10, -5)
",-2.366936,1.262387,-0.568481,-0.252803,0.346691,-0.210586,0.432111,0.42285,0.275578,0.258554,0.178898,-0.348352,-0.170296,-0.338052,-0.36306
openstack/openstack-ansible-openstack_hosts,Iab5beacfc3b1189fb0554ac0115eb99236edaf3c,0,0,1.0,1.9459,0.0,1,8.0,173,0,Feature,0,0,0,3,0.375,0.0,0,0.0,1,1,0,0,0.0,1.0,-33.93,18.2,0,0,0.0,0,24.7143,0,0,0,0,0,"Use advancedvirt-common repo for redhat-8

This is a centos-8-stream replacement for the advanced-virutalisation
repo.
[SEP]
FILES CHANGED:
vars/redhat-8.yml (+6, -0)
",1.854861,-0.96551,-0.198151,-0.345516,-0.709937,-0.778565,0.19486,0.957622,-0.494103,-0.689396,-0.527575,0.920264,-0.403219,-0.037371,0.04958
openstack/openstack-ansible,I71173689a5cb3274124c50e1909a55d2644618da,1,0,0.75,1.6094,0.0,1,5.57,432,0,Doc,1,0,0,4,0.285714,0.0,0,0.0,4,1,0,1.0,0.0,4.0,-37.44,15.56,1,0,1.0,0,86.4,0,0,0,0,0,"Set minimum and maximum microversions for manila api

The manila tempest plugin is branchless and needs the minimum
and maxium microversion setting depending on the version of
manila being tested. See [1] [2]

[1] https://github.com/openstack/manila/blob/master/devstack/plugin.sh#L968-L977
[2] https://docs.openstack.org/manila/latest/contributor/api_microversion_history.html
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_manila.yml.j2 (+4, -0)
",-2.477641,2.504896,-0.887811,1.013628,-0.183453,0.042902,0.230708,0.348823,0.144568,0.465213,-0.059051,-0.214075,0.041008,-0.209765,-0.232205
openstack/kayobe,I6d9e3acc477c9c4b3bb9db9c01a2db83b9568f59,1,0,0.7692,2.7726,0.4667,3,6.5,336,0,Feature,0,0,0,13,0.02686,1.0,0,0.7692,5,1,0,0.942,1.5058,4.33,-27.53,25.68,1,0,0.5333,0,21.0,0,0,0,0,0,"Multiple DHCP ranges for Ironic Inspector

Synchronize with new kolla-ansible parameters introduced in the
Ib69fc0017b3bfbc8da4dfd4301710fbf88be661a for Ironic Inspector.

Depends-On: Ib69fc0017b3bfbc8da4dfd4301710fbf88be661a
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+4, -3)
ansible/roles/kolla-ansible/tests/test-defaults.yml (+1, -2)
ansible/roles/kolla-ansible/tests/test-extras.yml (+3, -2)
",-2.626692,-0.3132,-1.927302,-0.627785,2.072233,0.149218,-0.972917,0.269881,-0.12416,0.425877,-0.152863,0.457142,0.267997,-0.235786,0.173263
openstack/ironic-python-agent,I568d7edfe81e928e6d7f09bd4a7933ca72b8813a,1,0,0.9474,3.091,0.4762,2,6.0,77,0,Feature,0,0,0,19,0.012386,1.0,0,0.9474,2,1,0,0.8889,0.9587,2.0,-38.95,15.73,1,0,0.0,1,3.5,0,0,0,0,0,"Clean up release notes
[SEP]
FILES CHANGED:
releasenotes/notes/move_swraid_to_efibootmgr-d87c1bfde1661fb5.yaml (+4, -4)
releasenotes/notes/add_burnin_dynamic_network_pairing-33e398255050eb98.yaml (+7, -6)
",3.919809,2.480028,2.512068,0.928138,0.826251,1.573949,1.106271,-0.817394,0.488359,-0.589465,-0.123177,-0.584947,0.630251,0.604326,0.423446
openstack/magnum,I24b89366a4a8e8bc4c90f6a85ef6de2ac77dae1d,1,0,1.0,3.912,0.4898,15,4.25,306,0,Feature,0,0,0,1,0.007874,1.0,0,1.0,6,3,0,0.875,3.7572,4.8,18.39,11.11,1,0,0.0816,1,6.12,0,0,0,0,0,"fcos-k8s: Update to v1.22

* change rbac.authorization.k8s.io/v1beta1 to v1
  * update metrics-server
* change storage.k8s.io/v1beta1 to v1
* drop kubelet-https
* update to FCOS 35

story: 2009828
task: 44416
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/kubernetes/fragments/flannel-service.sh (+2, -2)
magnum/drivers/common/templates/kubernetes/fragments/kube-apiserver-to-kubelet-role.sh (+3, -3)
magnum/drivers/common/templates/kubernetes/fragments/enable-cinder-csi.sh (+1, -1)
doc/source/user/monitoring.rst (+1, -0)
magnum/drivers/k8s_fedora_coreos_v1/templates/kubecluster.yaml (+1, -1)
devstack/plugin.sh (+1, -1)
magnum/drivers/common/templates/kubernetes/helm/metrics-server.sh (+2, -2)
magnum/drivers/common/templates/kubernetes/fragments/enable-ingress-traefik.sh (+2, -2)
doc/source/contributor/quickstart.rst (+1, -1)
magnum/drivers/k8s_fedora_atomic_v1/templates/kubecluster.yaml (+1, -1)
magnum/tests/contrib/gate_hook.sh (+2, -2)
magnum/drivers/common/templates/kubernetes/fragments/enable-keystone-auth.sh (+2, -2)
magnum/drivers/common/templates/kubernetes/fragments/kube-dashboard-service.sh (+3, -3)
magnum/drivers/common/templates/kubernetes/fragments/configure-kubernetes-master.sh (+1, -1)
magnum/drivers/common/templates/kubernetes/fragments/enable-prometheus-monitoring.sh (+2, -2)
",-0.71786,0.775701,-0.820866,-0.180766,0.029175,-1.138021,-0.073697,0.762683,-0.369206,0.22779,-0.408887,-0.051036,0.127146,0.919005,0.125938
openstack/kolla,I5f446fc276e245c1e6974ceeb6ff3dccd84ee502,1,0,0.9118,1.7918,1.0,2,21.5,637,0,Feature,0,0,0,34,0.043814,0.5556,0,0.5065,2,1,0,0.8045,0.7219,2.0,25.65,16.97,0,0,0.0,0,106.1667,0,0,0,0,0,"Remove missing collectd packages

Since CentOS Linux 8 repository retirement from
CentOS mirrors - we need to use CentOS Stream 8
version of Opstools repo.

Listed below packages are missing from the repo,
and according to the maintainer dpdk_telemetry is
not going to show up at all (it's basically dead).

The rest of the packages might show up at a later
stage - but it's not a priority for the maintainer.

- collectd-dpdk_telemetry
- collectd-libpod-stats
- collectd-sensubility
- python3-sqlalchemy-collectd

(cherry picked from commit 405fca90f2c8d3763ac56ce8b925611d136bba6c)
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -1)
docker/collectd/Dockerfile.j2 (+0, -4)
",-2.234268,-0.658251,0.980374,-1.140185,0.264997,-0.62166,0.358557,0.101752,-0.421397,-0.422451,-0.01616,0.29502,-0.077666,0.263248,-0.014744
openstack/oslo.utils,I941750b4d49d2d75f0831b24d6dd17f4040f70a2,1,1,0.8,3.6109,0.0278,3,12.5,745,0,Bug Fix,0,0,0,10,0.025773,1.0,0,0.8,2,2,0,0.875,1.5155,1.67,20.44,9.8,0,0,0.3889,1,20.1351,0,0,0,0,0,"Fix regex used to mask password

Some use cases are poorly handled by the regex used
to mask password. Indeed when the password contains
quotes or double quotes in the middle such as `pass""word`,
the mask_password method will return `***""word`.

For more details please see
https://bugs.launchpad.net/oslo.utils/+bug/1949623

Closes-Bug: #1949623
(cherry picked from commit 6e17ae1f7959c64dfd20a5f67edf422e702426aa)
(cherry picked from commit 5ce8a7f0f8ecec7a85a23ec3d7a7fb1cad14ceba)
(cherry picked from commit 143d3fbfa1e04778884de5acc08fa6f7fdabb265)
(cherry picked from commit 65aa4226d4bf286468da6df6759e364c1eb3e049)
(cherry picked from commit 5e9dfa3408a6fac7e870a9b86ee774b5fd71a595)
[SEP]
FILES CHANGED:
oslo_utils/tests/test_strutils.py (+14, -0)
releasenotes/notes/fix_mask_password_regex-c0661f95a23369a4.yaml (+7, -0)
oslo_utils/strutils.py (+14, -1)
",-4.522466,0.859108,1.922106,-2.828679,1.284849,0.532176,0.448563,-0.360075,0.102448,0.152896,-0.079439,0.174258,0.138909,-0.109403,-0.158613
openstack/kolla,I8c740655c7f7803d9ab36dac79d30e35e65dd586,1,0,0.6087,1.7918,0.0,1,3.89,600,0,CI,0,0,0,46,0.026901,0.5714,0,0.3478,2,1,0,0.806,0.0,2.0,19.18,11.27,0,0,0.0,0,100.0,0,0,0,0,0,"pin out some package from Debian OpenStack Team repos

Debian OpenStack Team backports many packages to get their stuff done.
Sometimes something goes wrong:

INFO:kolla.common.utils.kolla-toolbox:The following packages have unmet dependencies:
INFO:kolla.common.utils.kolla-toolbox: git : Depends: git-man (< 1:2.30.2-.) but 1:2.34.1-1~bpo11+1 is to be installed
INFO:kolla.common.utils.kolla-toolbox:E: Unable to correct problems, you have held broken packages.

So let pin out problematic packages as we are fine with bullseye version
of git.
[SEP]
FILES CHANGED:
docker/base/apt_preferences.debian (+5, -0)
",-2.120914,0.596703,0.71109,-0.092398,-0.289601,-0.305485,-0.018922,0.350489,-0.62285,0.375762,0.136387,-0.11756,0.113933,0.622222,0.138711
openstack/ironic,I953e948bcfa108d4c8e7b145da2f52b652e52a10,1,0,0,4.9345,0.3261,5,14.0,1515,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,5,3,0,0.9773,1.6291,3.0,35.51,15.06,1,0,0.0725,1,10.8993,0,0,0,0,0,"More fixes for anaconda deploy interface

The anaconda deploy interface has a few issues that are
addressed here:

- fixes logic in get_instance_image_info() for anaconda. If the
  ironic node's instance_info doesn't have both 'stage2' and
  'ks_template' specified, we weren't using any values from the
  instance_info. This has been fixed to use values from
  instance_info if specified. Otherwise, they are set as follows:
  The 'stage2' value is taken from the image properties.
  We use the value for 'ks_template' if it is specified in the
  image properties. If not (since it is optional), we use the
  config option's '[anaconda]default_ks_template' value.
  setting.
- For anaconda's stage2 directory, we were incorrectly creating a
  directory using the full path of the stage2 file. It now
  correctly creates the right directory.
- The anaconda deploy interface expects the node's instance_info
  to be populated with the 'image_url'; added code to do that in
  PXEAnacondaDeploy's prepare() method.
- When the deploy is finished and the bm node is being rebooted,
  we incorrectly set the node's provision state to 'active'
  instead of doing it via the provisioning state machine mechanism.
- The code that was doing the validation of the kickstart file was
  incorrect and resulted in errors; this has been addressed.
- The '%traceback' section in the packaged 'ks.cfg.template' file
  is deprecated and fails validation, so it has been removed.
[SEP]
FILES CHANGED:
releasenotes/notes/anaconda-deploy-more-fixes-58d996c7031c8c4b.yaml (+33, -0)
ironic/drivers/modules/pxe.py (+5, -2)
ironic/tests/unit/drivers/modules/test_pxe.py (+9, -1)
ironic/drivers/modules/ks.cfg.template (+1, -5)
ironic/common/pxe_utils.py (+45, -37)
",-3.327664,0.580817,3.95457,-0.175453,-0.257877,0.44594,-0.241939,-0.510438,-0.237013,-0.227078,-0.161321,0.517615,-0.099974,0.172988,0.107509
openstack/ironic-python-agent,I4e8b30deb5e2247f51ce8f10bd3271f64a264089,1,0,0,3.2581,0.16,3,12.0,468,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.8947,1.2098,2.0,24.05,14.8,1,0,0.68,1,18.0,1,0,0,0,0,"Rescan device after filesystem creation

In work_on_disk function, IPA runs mkfs commands without
following device rescan operation. This leads to incorrect
content of uuids_to_return to be returned.
These mkfs commands modify partition label but IPA fails
to catch such changes because of no following device
rescan operation.

This commit adds call of device rescan function before
uuids_to_return construction.
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/test_partition_utils.py (+13, -4)
releasenotes/notes/rescan-device-after-mkfs-3f9d52a2e3b6fff3.yaml (+5, -0)
ironic_python_agent/partition_utils.py (+3, -0)
",-1.21009,-1.0207,0.081275,0.913295,0.680629,0.133591,-0.484633,-0.402484,0.358015,-0.381165,-0.147893,-0.312493,0.076746,0.040277,0.067148
openstack/openstack-ansible-lxc_hosts,I3adb4dd75198935c4656d0208043ad8051f29312,1,0,0.8,0.6931,0.0,1,11.0,188,0,Feature,0,0,0,5,0.277778,0.0,0,0.0,1,1,0,0,0.0,1.0,41.85,13.49,0,0,0.0,0,94.0,0,0,0,0,0,"Ensure that the legacy network-scripts package is present

The lxc_hosts ansible role currently relies on the ifup / ifdown
commands.
[SEP]
FILES CHANGED:
vars/redhat-host.yml (+1, -0)
",1.145624,-0.497616,-0.155305,0.420091,0.165166,-0.471325,0.161738,0.239474,-0.17057,-0.535724,-0.086947,0.265553,-0.318852,-0.245257,0.444022
openstack/openstack-ansible-os_horizon,I9fc9147263881cc96f8e51b739d2ccf6f1f9fbf9,1,0,0,1.3863,0.3333,1,7.8,292,0,Feature,0,0,0,0,0.0,1.0,0,0.0,1,1,0,0,0.0,1.0,42.73,12.35,0,0,0.0,0,73.0,0,0,0,0,0,"Disable barbican-ui dashboard

barbican-ui has not yet reached a 1.0.0 release and does not provide
a functioning UI for the key manager service at this time.

Once barbican-ui has basic functionality we can consider enabling this again.
[SEP]
FILES CHANGED:
defaults/main.yml (+2, -1)
",0.034967,-0.525132,-0.402608,0.689183,-0.227814,0.143888,0.119394,0.091567,-0.456759,0.458882,-0.085404,0.673983,-0.38245,-0.317513,0.284023
openstack/kolla-ansible,I290d0a81c57c189b6eb62fc3eee3ed19f441671b,1,0,0.9722,1.3863,1.0,1,5.14,404,0,Feature,0,1,0,36,0.060811,0.8,0,0.7778,4,1,0,0.8429,0.0,4.0,-26.33,14.28,1,0,0.0,0,101.0,0,0,0,0,0,"Revert ""Add workaround for keystonemiddleware/neutron memcached issue""

The default configuration was changed to use the advanced cache pool in
keystonemiddleware 9.3.0 (Xena release) [1].

This reverts commit 5a52d8e4a0c5d4c246deb8851ef893df63ee0847 (except the
release note).

[1] https://review.opendev.org/c/openstack/keystonemiddleware/+/773939
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -3)
",-1.23263,0.633109,-0.617259,-1.075651,0.056054,-0.046515,0.780436,0.563202,0.108843,0.246567,0.285976,0.028175,-0.228796,-0.191239,-0.179883
openstack/openstack-ansible,Ib7f85dedb62dbd30a493277995ed57c394045bee,0,0,0.8333,3.1781,0.0,1,10.0,394,0,CI,1,0,0,6,0.315789,0.0,0,0.0,2,1,0,1.0,0.0,2.0,2.11,13.0,0,0,1.0,0,16.4167,0,0,0,0,0,"Disable unwanted repositories from the zuul configure-mirrors role

These cause failures in real-world deployments as the host config
ends up being different from CI and it's possible we merge code that
is broken for non-CI cases.

See https://opendev.org/zuul/zuul-jobs/src/branch/master/roles/configure-mirrors/tasks/mirror/CentOS-8.yaml
[SEP]
FILES CHANGED:
zuul.d/playbooks/pre-gate-cleanup.yml (+23, -0)
",-0.957522,1.385912,-0.724403,0.562048,-0.807858,-0.721564,0.766854,0.099631,-0.096416,-0.262464,-0.341988,-0.229569,0.381709,-0.021544,0.039147
openstack/openstack-ansible,If48096a7309c7140cd9c182d5d3175e8d827cbd6,1,1,1.0,1.9459,0.5,3,10.0,317,0,Bug Fix,0,0,0,2,0.004057,0.0,0,0.0,4,3,0,0.875,1.585,3.33,48.64,10.0,1,0,0.6667,0,45.2857,0,18,0,24,0,"Rename RBD cinder backend

RBD seems to be reserved name in cinder. Once it's used as
volume type, cinder fails with [1]

We rename backend name in doc and AIO to workaround the issue

[1] https://paste.opendev.org/show/bAJR9YEYA1hRjCuMc6kU/

Closes-Bug: #1877421
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_ceph.yml.j2 (+1, -1)
etc/openstack_deploy/user_variables.yml.prod-ceph.example (+1, -1)
tests/roles/bootstrap-host/tasks/prepare_ceph.yml (+1, -1)
",-0.77163,-0.486628,-0.625255,-0.609954,-0.758232,0.055607,0.101575,0.430049,0.015687,0.275261,0.171746,-0.754192,0.095063,-0.083228,-0.360471
openstack/openstack-ansible-os_horizon,I8a5ef5234b8aee1e7b3517e9543d2af0a84e90ce,1,0,1.0,2.4849,0.2727,2,10.75,317,0,Feature,0,0,0,3,0.006012,0.0,0,0.0,1,1,0,1.0,0.9457,1.0,32.63,11.74,0,0,0.0,0,26.4167,0,0,0,0,0,"Move Listen definition to VHosts

In order to avoid conflicts with other applications running Apache,
like keystone, we avoid using ports.conf for Listen and using VHost files
for this purpose.

We place same dummy template as keystone does for upgrade purposes.
[SEP]
FILES CHANGED:
templates/horizon_apache_ports.conf.j2 (+4, -3)
templates/openstack_dashboard.conf.j2 (+4, -0)
",-0.039336,-1.549529,-0.273134,0.824101,-0.205824,-0.158363,-0.190427,-0.123848,-0.780764,0.14572,-0.634371,-0.094286,0.249076,-0.224812,-0.232394
openstack/openstack-ansible-os_keystone,I596614f55a8db8e814b1d24a78c3f1a9d0e00bb2,1,1,1.0,1.0986,1.0,1,20.5,296,0,Bug Fix,0,0,0,4,0.007843,0.0,0,0.0,1,1,0,1.0,0.0,1.0,27.14,19.91,1,0,0.0,0,98.6667,0,6,0,17,0,"Drop ProxyPass out of VHost

As ProxyPass defined out of VHost, it has global effect, resulting
in Horizon Identity section to be jsut proxied to keystone API
instead of rederred by Django as instructed by Horizon VHost.

Closes-Bug: #1960342
[SEP]
FILES CHANGED:
templates/keystone-httpd.conf.j2 (+0, -2)
",0.11901,-1.803322,-0.417455,-0.050587,-0.426838,0.187913,-0.649955,0.344642,-0.226843,-0.340174,-0.181675,0.108282,-0.098001,-0.235408,-0.12901
openstack/openstack-ansible-repo_server,I26bb0e21d797c2bfbe67e03003da01c355c27561,1,0,0.7143,2.5649,0.5833,3,21.4,649,0,Feature,0,0,0,7,0.166667,0.0,0,0.0,1,2,0,0,1.5546,1.0,53.87,13.05,0,0,0.0,0,49.9231,0,0,0,0,0,"Ensure insist=true is always set for lsyncd

If insist is not set to true then lsyncd will exit if it cannot
perform an initial rsync to the target hosts.

Due to the order in which the repo servers are configured, lsyncd
may be installed and started on the first host in the repo_servers
group before the ssh keys and other necessary configuration have
been placed on the remaining hosts. This leads to a failure to
start lsyncd.

This patch moves the setting of insist into the lua config file
for all operating systems, and removes the need to template a
defaults file on debian derivatives.
[SEP]
FILES CHANGED:
templates/lsyncd.lua.j2 (+2, -1)
templates/lsyncd.defaults.j2 (+0, -4)
tasks/repo_sync_manager.yml (+3, -2)
",-1.562615,-1.468565,0.725512,0.731759,0.143644,-0.238557,0.231601,-0.231791,0.189345,0.174186,0.186773,0.049268,-0.166214,-0.014867,-0.167105
openstack/openstack-ansible-os_nova,Iacc093311036fb8d6559a0e32252579303a639ba,1,0,1.0,3.1781,0.2609,5,9.43,461,0,Bug Fix,0,0,0,5,0.009766,1.0,0,1.0,3,1,0,1.0,2.2299,1.4,48.57,11.04,0,0,0.0,0,19.2083,0,0,0,0,0,"Fix race-condition when libvirt starts unwillingly

libvirtd.socket does monitor libvirtd.service and trigger service restart
when it spot that service is down.

However in order to enable tcp and tls sockets, we need libvirt
to be stopped.

Currently race condition can happen, when we stop libvirt, but it's
started by socket before we enable tls one.

To overcome this we stop socket along with service.
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+3, -1)
vars/redhat.yml (+3, -1)
vars/debian.yml (+3, -1)
handlers/main.yml (+6, -2)
tasks/drivers/kvm/nova_compute_kvm_install.yml (+2, -1)
",-0.378881,-1.668303,0.236553,0.444315,-0.472044,-0.676531,0.529726,-0.375694,-0.637131,0.12669,0.237241,-0.402506,0.282189,0.248387,0.040044
openstack/openstack-ansible,Ie6210a71f7b9890b74d9006de86050c822002c69,1,0,1.0,3.3673,0.4286,3,9.25,301,0,Bug Fix,0,0,0,6,0.011215,1.0,0,1.0,3,2,0,0.8889,1.1516,1.67,21.39,16.67,0,0,0.0,0,10.3793,0,0,0,0,0,"Fix behaviour of OSA_CONFIG_DIR

OSA_CONFIG_DIR environemntal variable allows to manage several
deployments from same deploy host. That is handy feature
which was broken for several roles and usecases. It should be
respected and handled properly.
[SEP]
FILES CHANGED:
inventory/group_vars/all/ssl.yml (+1, -1)
scripts/get-ansible-role-requirements.yml (+4, -3)
scripts/run-upgrade.sh (+11, -8)
",-0.764019,-0.954259,-0.502731,0.935934,0.593218,0.268198,-0.635574,-0.12112,-0.086591,-0.131654,-0.033566,-0.110593,-0.236569,-0.33785,0.211137
openstack/openstack-ansible-rabbitmq_server,Ia20902f0ffe21ce563966fee4d233e5ec3afe3d9,1,1,1.0,3.9512,0.3333,3,17.33,361,0,Bug Fix,0,0,0,7,0.012433,1.0,0,1.0,2,2,0,0,1.1596,1.33,33.06,16.93,1,0,0.0,1,6.9423,0,6,0,32,0,"Verify if hosts file already managed with OSA

With this patch we ensure that duplicated records are not
created with rabbitmq role if hosts file already contain
OSA managed block. Managing hosts still might be required for
role usage outside of the OSA so we workaround this usecase.

Related-Bug: #1960587
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq_manage_hosts-834150c45dfc0771.yaml (+9, -0)
defaults/main.yml (+4, -2)
tasks/rabbitmq_pre_install.yml (+21, -15)
",0.851175,-1.625546,-0.030308,0.436007,-0.425316,0.098578,0.59926,0.223986,0.206776,-0.250469,0.029127,-0.074,0.232813,-0.242725,0.024023
openstack/openstack-ansible-rabbitmq_server,Ib14c4d6dbe32531950e41b3de6ee5eae778baaaf,0,1,1.0,1.3863,1.0,1,9.3,616,0,Bug Fix,0,0,0,8,0.013029,0.0,0,0.0,1,1,0,1.0,0.0,1.0,59.12,8.88,1,0,0.0,0,154.0,0,6,0,32,0,"Unpin Erlang distribution server port

Port 25672 has been pinned to specific address during bind-to-mgmt topic

This brings issue, when node hostname resolves to 127.0.1.1 which is
default thing for bare metal nodes. In the meanwhile, distribution port
listens only on management address which
makes rabbitmqctl and clustering complain about that.

At the same time it's not really required for bind-to-mgmt for port 25672
to listen only on mgmt IP since it's not served by haproxy
or any other tool, so we can allow it to bind on 0.0.0.0.

Closes-Bug: #1960587
[SEP]
FILES CHANGED:
templates/rabbitmq.config.j2 (+0, -3)
",-1.534895,-1.371206,1.006369,-0.147464,-0.340696,-0.354599,0.167725,0.228346,-0.164241,0.211619,0.371188,-0.013887,0.032916,0.248746,-0.074888
openstack/openstack-ansible-galera_server,I71bc866aedaa6fba3cc86d2a2a99ed32f0727c54,1,0,1.0,1.6094,0.5,1,7.2,268,0,Feature,0,0,0,1,0.142857,0.0,0,0.0,1,1,0,0,0.0,1.0,39.73,10.66,0,0,0.0,0,53.6,1,0,0,0,0,"Use unix socket while granting access for the backup service

/root/.my.cnf is not stored on galera container anymore, so it's not
possible to run mysql_user via TCP connection.
Unix socket should be used instead.
[SEP]
FILES CHANGED:
tasks/galera_server_backups.yml (+2, -2)
",1.427478,-1.159033,0.10579,0.441351,-0.397775,-0.157269,0.933932,-0.05575,-0.351564,-0.408329,-0.119527,-0.350065,-0.484291,0.018729,0.052895
openstack/openstack-ansible-openstack_hosts,Idf4cac9b166b9fe922bc412cdb5b79e260723f2e,1,0,0.75,1.0986,0.5,1,12.5,207,0,CI,0,0,0,8,0.148148,1.0,0,0.75,1,1,0,0.0,0.0,1.0,35.1,14.6,0,0,0.0,0,69.0,0,0,0,0,0,"Enable powertools/crb repository for the repo server

This is needed for the kmod-devel package which os_cinder tries
to install during the wheel build.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",1.679489,-1.257361,0.028795,0.027912,-0.176927,-0.70697,0.599855,0.533678,-0.513504,-0.882437,-0.111839,0.189705,-0.662121,-0.005873,0.09825
openstack/kolla,I61d0790c5d4d070b7ea9e8c99c0a76ff5d22bf9d,0,0,1.0,6.4232,0.0081,210,26.1,1522,0,Bug Fix,0,0,0,11,0.080882,1.0,0,1.0,3,5,0,0.8074,6.9925,2.87,48.1,15.19,1,0,0.0,1,2.4708,0,0,0,0,0,"Add mechanism for patching files in containers

This patch adds a way to patch files in a Docker
image built by Kolla. This is very useful for several
reasons, specifically:

- Custom modifications
- The stable branch of some library has a fix but no pip
  package has been released
- Eliminates the need to package your own pip packages
- Eliminates the need to invent your own versioning to prevent
  upstream versioning
- Eliminates the need to manage a pip server
- In other words, it eliminates the need to get a wheel into
  the image and install it manually using any method not
  previously mentioned

It is also highly desirable because, although Kolla can replace
the source for a service with a custom URL for a tarball or its
own Git repo, it cannot do this for dependencies pulled from pip.

I would also like to point out that this is a feature with its own
code path and works only if the user ""inserts"" a patch into the folder
patches/docker-image/something.patch and creates an analogous series
file for patch source code.

Simply said, this code will never interfere with the upstream build process
since this feature is not intended for use in upstream.
It is rather meant for downstream users who know what they are doing.
Now they just have an option to patch their images.

Everything works on all layers of the Docker image and stores a report
of applied patches which can then be seen in /etc.

This mechanism is similar as debian patch quilt.
[SEP]
FILES CHANGED:
docker/aodh/aodh-evaluator/Dockerfile.j2 (+2, -0)
docker/nova/nova-scheduler/Dockerfile.j2 (+2, -0)
docker/mistral/mistral-executor/Dockerfile.j2 (+2, -0)
docker/trove/trove-guestagent/Dockerfile.j2 (+2, -0)
docker/openstack-base/Dockerfile.j2 (+2, -0)
docker/venus/venus-api/Dockerfile.j2 (+4, -0)
docker/prometheus/prometheus-cadvisor/Dockerfile.j2 (+1, -0)
docker/haproxy/haproxy/Dockerfile.j2 (+2, -0)
docker/tacker/tacker-base/Dockerfile.j2 (+2, -0)
docker/zun/zun-cni-daemon/Dockerfile.j2 (+2, -0)
docker/ceilometer/ceilometer-central/Dockerfile.j2 (+2, -0)
docker/swift/swift-object/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-metadata-agent/Dockerfile.j2 (+2, -0)
docker/zun/zun-wsproxy/Dockerfile.j2 (+4, -0)
docker/magnum/magnum-conductor/Dockerfile.j2 (+2, -0)
docker/ceilometer/ceilometer-compute/Dockerfile.j2 (+2, -0)
docker/gnocchi/gnocchi-statsd/Dockerfile.j2 (+2, -0)
docker/opensearch/opensearch/Dockerfile.j2 (+2, -0)
docker/grafana/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-driver-agent/Dockerfile.j2 (+2, -0)
docker/nova/nova-libvirt/Dockerfile.j2 (+2, -0)
docker/swift/swift-account/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-blackbox-exporter/Dockerfile.j2 (+2, -0)
docker/barbican/barbican-api/Dockerfile.j2 (+2, -0)
docker/tgtd/Dockerfile.j2 (+2, -0)
docker/nova/nova-conductor/Dockerfile.j2 (+2, -0)
docker/trove/trove-api/Dockerfile.j2 (+2, -0)
docker/swift/swift-proxy-server/Dockerfile.j2 (+2, -0)
docker/barbican/barbican-keystone-listener/Dockerfile.j2 (+2, -0)
docker/heat/heat-base/Dockerfile.j2 (+2, -0)
doc/source/admin/image-building.rst (+53, -0)
docker/designate/designate-mdns/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-sb-db-server/Dockerfile.j2 (+2, -0)
releasenotes/notes/patch-docker-images-69764f0b1df5c9ed.yaml (+6, -0)
docker/collectd/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-housekeeping/Dockerfile.j2 (+2, -0)
docker/opensearch/opensearch-dashboards/Dockerfile.j2 (+2, -0)
docker/ceilometer/ceilometer-ipmi/Dockerfile.j2 (+2, -0)
docker/cyborg/cyborg-conductor/Dockerfile.j2 (+4, -0)
docker/tacker/tacker-conductor/Dockerfile.j2 (+2, -0)
docker/placement/placement-base/Dockerfile.j2 (+2, -0)
docker/gnocchi/gnocchi-metricd/Dockerfile.j2 (+2, -0)
docker/nova/nova-api/Dockerfile.j2 (+2, -0)
docker/designate/designate-base/Dockerfile.j2 (+2, -0)
docker/designate/designate-worker/Dockerfile.j2 (+2, -0)
docker/keystone/keystone-fernet/Dockerfile.j2 (+2, -0)
docker/masakari/masakari-monitors/Dockerfile.j2 (+2, -0)
docker/ironic/ironic-prometheus-exporter/Dockerfile.j2 (+2, -0)
kolla/common/config.py (+2, -0)
docker/glance/glance-base/Dockerfile.j2 (+2, -0)
docker/horizon/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-memcached-exporter/Dockerfile.j2 (+4, -0)
docker/watcher/watcher-applier/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-metering-agent/Dockerfile.j2 (+2, -0)
docker/nova/nova-compute-ironic/Dockerfile.j2 (+2, -0)
docker/trove/trove-taskmanager/Dockerfile.j2 (+2, -0)
docker/watcher/watcher-api/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-openvswitch-agent/Dockerfile.j2 (+2, -0)
docker/ceilometer/ceilometer-notification/Dockerfile.j2 (+2, -0)
docker/cinder/cinder-volume/Dockerfile.j2 (+2, -0)
docker/swift/swift-base/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-ovn-exporter/Dockerfile.j2 (+4, -0)
docker/neutron/neutron-mlnx-agent/Dockerfile.j2 (+2, -0)
docker/skyline/skyline-apiserver/Dockerfile.j2 (+2, -0)
docker/mariadb/mariadb-base/Dockerfile.j2 (+2, -0)
docker/skyline/skyline-console/Dockerfile.j2 (+2, -0)
docker/base/kolla_patch.sh (+55, -0)
docker/ovsdpdk/ovsdpdk-vswitchd/Dockerfile.j2 (+4, -0)
docker/telegraf/Dockerfile.j2 (+2, -0)
docker/blazar/blazar-api/Dockerfile.j2 (+4, -0)
docker/prometheus/prometheus-elasticsearch-exporter/Dockerfile.j2 (+4, -0)
docker/ironic/ironic-api/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-worker/Dockerfile.j2 (+2, -0)
docker/etcd/Dockerfile.j2 (+2, -0)
docker/barbican/barbican-base/Dockerfile.j2 (+2, -0)
docker/hacluster/hacluster-base/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-health-manager/Dockerfile.j2 (+2, -0)
docker/glance/glance-api/Dockerfile.j2 (+2, -0)
docker/gnocchi/gnocchi-api/Dockerfile.j2 (+2, -0)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+3, -1)
docker/cinder/cinder-base/Dockerfile.j2 (+2, -0)
docker/cloudkitty/cloudkitty-processor/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-base/Dockerfile.j2 (+2, -0)
docker/zun/zun-compute/Dockerfile.j2 (+2, -0)
docker/ceilometer/ceilometer-base/Dockerfile.j2 (+2, -0)
docker/cinder/cinder-scheduler/Dockerfile.j2 (+2, -0)
docker/masakari/masakari-engine/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-mysqld-exporter/Dockerfile.j2 (+4, -0)
docker/cron/Dockerfile.j2 (+2, -0)
docker/placement/placement-api/Dockerfile.j2 (+2, -0)
docker/cinder/cinder-backup/Dockerfile.j2 (+2, -0)
docker/blazar/blazar-base/Dockerfile.j2 (+2, -0)
kolla/image/kolla_worker.py (+32, -1)
docker/ovsdpdk/ovsdpdk-db/Dockerfile.j2 (+4, -0)
docker/aodh/aodh-expirer/Dockerfile.j2 (+2, -0)
docker/manila/manila-data/Dockerfile.j2 (+2, -0)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+2, -0)
docker/keystone/keystone-ssh/Dockerfile.j2 (+2, -0)
docker/zun/zun-api/Dockerfile.j2 (+4, -0)
docker/manila/manila-scheduler/Dockerfile.j2 (+2, -0)
docker/bifrost/bifrost-deploy/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-dhcp-agent/Dockerfile.j2 (+2, -0)
docker/bifrost/bifrost-base/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-sriov-agent/Dockerfile.j2 (+2, -0)
docker/trove/trove-conductor/Dockerfile.j2 (+2, -0)
docker/influxdb/Dockerfile.j2 (+2, -0)
docker/manila/manila-share/Dockerfile.j2 (+2, -0)
docker/nova/nova-base/Dockerfile.j2 (+2, -0)
docker/magnum/magnum-base/Dockerfile.j2 (+2, -0)
docker/kolla-toolbox/Dockerfile.j2 (+2, -0)
docker/heat/heat-api-cfn/Dockerfile.j2 (+2, -0)
docker/cyborg/cyborg-api/Dockerfile.j2 (+2, -0)
docker/nova/nova-spicehtml5proxy/Dockerfile.j2 (+2, -0)
docker/mistral/mistral-api/Dockerfile.j2 (+2, -0)
docker/zun/zun-base/Dockerfile.j2 (+2, -0)
docker/nova/nova-compute/Dockerfile.j2 (+2, -0)
docker/watcher/watcher-base/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-ovn-agent/Dockerfile.j2 (+2, -0)
docker/hacluster/hacluster-pacemaker/Dockerfile.j2 (+2, -0)
docker/ironic/ironic-conductor/Dockerfile.j2 (+2, -0)
docker/keystone/keystone/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-openstack-exporter/Dockerfile.j2 (+4, -0)
docker/aodh/aodh-listener/Dockerfile.j2 (+2, -0)
docker/nova/nova-novncproxy/Dockerfile.j2 (+2, -0)
docker/skyline/skyline-base/Dockerfile.j2 (+2, -0)
docker/letsencrypt/letsencrypt-webserver/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-linuxbridge-agent/Dockerfile.j2 (+2, -0)
docker/trove/trove-base/Dockerfile.j2 (+2, -0)
docker/redis/redis-base/Dockerfile.j2 (+2, -0)
docker/magnum/magnum-api/Dockerfile.j2 (+2, -0)
docker/venus/venus-base/Dockerfile.j2 (+2, -0)
docker/blazar/blazar-manager/Dockerfile.j2 (+4, -0)
docker/manila/manila-base/Dockerfile.j2 (+2, -0)
docker/multipathd/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-base/Dockerfile.j2 (+2, -0)
docker/macros.j2 (+7, -0)
docker/masakari/masakari-base/Dockerfile.j2 (+2, -0)
docker/rabbitmq/Dockerfile.j2 (+2, -0)
docker/watcher/watcher-engine/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-libvirt-exporter/Dockerfile.j2 (+2, -0)
docker/redis/redis-sentinel/Dockerfile.j2 (+2, -0)
docker/hacluster/hacluster-pcs/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-base/Dockerfile.j2 (+2, -0)
docker/cinder/cinder-api/Dockerfile.j2 (+2, -0)
docker/redis/redis/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-server/Dockerfile.j2 (+2, -0)
docker/ironic-inspector/Dockerfile.j2 (+2, -0)
docker/hacluster/hacluster-corosync/Dockerfile.j2 (+2, -0)
docker/fluentd/Dockerfile.j2 (+2, -0)
docker/mistral/mistral-engine/Dockerfile.j2 (+2, -0)
docker/mariadb/mariadb-clustercheck/Dockerfile.j2 (+4, -0)
docker/swift/swift-object-expirer/Dockerfile.j2 (+2, -0)
docker/designate/designate-backend-bind9/Dockerfile.j2 (+2, -0)
docker/designate/designate-sink/Dockerfile.j2 (+2, -0)
docker/heat/heat-engine/Dockerfile.j2 (+2, -0)
docker/nova/nova-serialproxy/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-node-exporter/Dockerfile.j2 (+4, -0)
docker/letsencrypt/letsencrypt-lego/Dockerfile.j2 (+2, -0)
docker/mistral/mistral-event-engine/Dockerfile.j2 (+2, -0)
docker/openvswitch/openvswitch-vswitchd/Dockerfile.j2 (+4, -0)
kolla/image/build.py (+1, -0)
docker/swift/swift-container/Dockerfile.j2 (+2, -0)
docker/venus/venus-manager/Dockerfile.j2 (+4, -0)
docker/base/Dockerfile.j2 (+8, -3)
docker/memcached/Dockerfile.j2 (+2, -0)
docker/ironic/ironic-pxe/Dockerfile.j2 (+2, -0)
docker/haproxy/haproxy-ssh/Dockerfile.j2 (+2, -0)
docker/keepalived/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-mtail/Dockerfile.j2 (+4, -0)
docker/dnsmasq/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-controller/Dockerfile.j2 (+2, -0)
docker/manila/manila-api/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-northd/Dockerfile.j2 (+2, -0)
docker/proxysql/Dockerfile.j2 (+2, -0)
docker/cloudkitty/cloudkitty-base/Dockerfile.j2 (+2, -0)
docker/networking-baremetal/ironic-neutron-agent/Dockerfile.j2 (+2, -0)
docker/nova/nova-ssh/Dockerfile.j2 (+2, -0)
docker/octavia/octavia-api/Dockerfile.j2 (+2, -0)
docker/letsencrypt/letsencrypt-base/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-base/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-alertmanager/Dockerfile.j2 (+4, -0)
docker/iscsid/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-nb-db-server/Dockerfile.j2 (+2, -0)
docker/aodh/aodh-api/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-l3-agent/Dockerfile.j2 (+2, -0)
docker/designate/designate-producer/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-infoblox-ipam-agent/Dockerfile.j2 (+2, -0)
docker/cyborg/cyborg-base/Dockerfile.j2 (+2, -0)
docker/openvswitch/openvswitch-db-server/Dockerfile.j2 (+4, -0)
docker/barbican/barbican-worker/Dockerfile.j2 (+2, -0)
docker/cyborg/cyborg-agent/Dockerfile.j2 (+2, -0)
docker/designate/designate-central/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-bgp-dragent/Dockerfile.j2 (+2, -0)
docker/designate/designate-api/Dockerfile.j2 (+2, -0)
docker/cloudkitty/cloudkitty-api/Dockerfile.j2 (+2, -0)
docker/masakari/masakari-api/Dockerfile.j2 (+2, -0)
docker/ironic/ironic-base/Dockerfile.j2 (+2, -0)
docker/mariadb/mariadb-server/Dockerfile.j2 (+2, -0)
docker/ovsdpdk/ovsdpdk/Dockerfile.j2 (+2, -0)
docker/mistral/mistral-base/Dockerfile.j2 (+2, -0)
docker/swift/swift-rsyncd/Dockerfile.j2 (+2, -0)
docker/hacluster/hacluster-pacemaker-remote/Dockerfile.j2 (+2, -0)
docker/heat/heat-api/Dockerfile.j2 (+2, -0)
docker/aodh/aodh-base/Dockerfile.j2 (+2, -0)
docker/prometheus/prometheus-v2-server/Dockerfile.j2 (+4, -0)
docker/kuryr/kuryr-base/Dockerfile.j2 (+2, -0)
docker/keystone/keystone-base/Dockerfile.j2 (+2, -0)
docker/tacker/tacker-server/Dockerfile.j2 (+2, -0)
docker/kuryr/kuryr-libnetwork/Dockerfile.j2 (+2, -0)
docker/aodh/aodh-notifier/Dockerfile.j2 (+2, -0)
",-2.842235,-1.378966,4.154625,-0.946542,-0.666295,0.011869,-0.3794,-0.340799,-0.576204,0.017804,-0.738532,0.312544,0.218946,0.012547,0.066264
openstack/kolla-ansible,I4087dc81f9d1fa5daa24b9df6daf1f9e1ccd702f,1,1,0.973,2.4849,0.2727,3,13.25,424,0,Bug Fix,0,0,0,37,0.062185,0.75,0,0.7297,4,3,0,0.8436,1.4354,3.33,33.76,12.85,1,0,0.0,1,35.3333,0,6,0,16,0,"Configure node-exporter to report correct file system metrics

Without this configuration, all mount points are reporting the same
utilisation metrics [1]. With the rslave option, all root mounts from
the host are visible in the container, so we can remove the bind mounts
for /proc and /sys.

[1] https://github.com/prometheus/node_exporter#docker

Closes-Bug: #1961438
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus-node-exporter.json.j2 (+1, -1)
releasenotes/notes/node-exporter-filesystem-metrics-d3ae7b0a892d2957.yaml (+6, -0)
ansible/roles/prometheus/defaults/main.yml (+1, -2)
",-0.461504,-0.62179,-0.034343,0.360156,-0.528837,-0.417834,0.033211,0.454846,0.093935,0.191871,-0.141721,-0.38391,0.262304,-0.006804,-0.496271
openstack/openstack-ansible-rabbitmq_server,Ife5bb330240ecbac3814f2e161c5e108e25f6c14,0,0,0.8889,1.3863,0.0,1,10.67,254,0,Bug Fix,0,0,0,9,0.014587,0.0,0,0.0,1,1,0,0.5,0.0,1.0,32.1,11.77,0,0,0.0,0,63.5,0,0,0,0,0,"Return Erlang distribution port mgmt binding

While converting config to new style, erlang 25672 port binding to
mgmt IP has been lost.

We fix this now with re-adding inet_dist_use_interface option.
[SEP]
FILES CHANGED:
templates/advanced.config.j2 (+3, -0)
",0.375951,-1.416912,-0.191456,0.395531,0.214154,-0.128669,-0.257715,0.271597,0.085209,-0.200286,-0.277844,-0.295709,-0.343108,-0.400079,0.080469
openstack/openstack-ansible-rabbitmq_server,I907d4714319ac7134ede0dc62b51c1964b9befc5,1,1,0.8,1.7918,0.0,1,6.0,489,0,Bug Fix,0,0,0,10,0.016129,1.0,0,0.8,1,1,0,0.3333,0.0,1.0,67.97,7.4,1,0,0.0,0,81.5,0,6,0,32,0,"Remove affecting rabbitmq hosts record

Record for 127.0.1.1 is added by some distributions which makes
clustering fail, as Erlang port is binded to mgmt IP, while rabbit
expects to access it through $hostname, which would lead to 127.0.1.1.
At same time it's possbile to explicitly bind distribution port only
to single address. So we need to
ensure that hostname resolvs to mgmt IP and drop record for 127.0.1.1

Closes-Bug: #1960587
[SEP]
FILES CHANGED:
tasks/rabbitmq_pre_install.yml (+5, -0)
",-1.635766,-0.346266,0.135949,0.573335,0.118663,0.020503,0.061486,0.009544,-0.012882,0.544656,0.155819,-0.065863,0.036761,0.201465,0.042386
openstack/ironic-python-agent,I3e25ce4997f5dd3df87caba753daced65838f85a,1,0,1.0,2.8332,0.125,2,11.33,220,0,Feature,0,0,0,2,0.023256,1.0,0,1.0,2,2,0,0.9,0.9544,1.5,68.43,8.06,1,0,0.0,1,12.9412,0,0,0,0,0,"Use utf-16-le if BOM not present

In case no BOM is present in the CSV file the utf-16 codec won't work.
We fail over to utf-16-le as Little Endian is commonly used.
[SEP]
FILES CHANGED:
ironic_python_agent/efi_utils.py (+8, -2)
releasenotes/notes/detect-endianness-f53a6c4571aba3fe.yaml (+6, -0)
",-0.101135,1.016035,-0.523946,1.244107,0.324675,0.476498,0.5298,-0.798957,-0.292025,0.28821,0.68212,0.33778,0.043478,0.003257,0.212021
openstack/kolla-ansible,I5547cce5c389846ed216bb898b78e45b8f231e1e,1,1,0,2.8904,0.1176,4,10.0,120,0,Bug Fix,0,0,0,0,0.0,0.8889,0,0.0,4,3,0,0.8443,1.9328,3.5,-6.35,28.0,1,0,0.0,1,6.6667,0,14,0,12,0,"Add openvswitch and prometheus to logrotate

Closes-Bug: #1961795
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron-logrotate-prometheus.conf.j2 (+3, -0)
ansible/roles/common/templates/cron-logrotate-openvswitch.conf.j2 (+3, -0)
releasenotes/notes/bug-1961795-16fb2ac27152fc03.yaml (+6, -0)
ansible/roles/common/tasks/config.yml (+3, -2)
",2.589052,0.156817,-0.217471,-0.690668,-0.339692,0.409802,-0.340815,0.382963,0.193888,-0.365515,0.377103,-0.430731,0.053935,-0.129711,0.148264
openstack/kolla-ansible,If574d2242aa6a875dcf624d95495e6cec6fefddd,1,1,1.0,2.3979,0.1,3,10.0,108,0,Bug Fix,0,0,0,9,0.080357,1.0,0,1.0,4,3,0,0.8451,1.1568,3.33,19.03,16.0,0,0,0.0,1,9.8182,0,6,0,10,0,"Fix hard coded OIDC response type

Closes-bug: 1959781
[SEP]
FILES CHANGED:
releasenotes/notes/fix-hardcoded-oidc-response-fc0f115f0b56cddf.yaml (+7, -0)
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -1)
ansible/roles/keystone/defaults/main.yml (+1, -0)
",2.238868,-0.743735,-0.224607,-1.075594,-0.419704,0.503901,-0.583254,0.479798,0.526413,-0.15771,0.593598,-0.051459,0.086308,-0.169582,0.258772
openstack/ansible-role-pki,Ic4f3c46f14ae75a022ba59635d03066adfd94036,1,0,0.7778,2.3979,0.5,1,3.67,178,0,Bug Fix,0,0,0,9,0.160714,0.0,0,0.0,2,1,0,0,0.0,2.0,-89.14,19.65,0,0,0.0,0,16.1818,0,0,0,0,0,"Fix variable names for certificate CSR fields

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/830806
[SEP]
FILES CHANGED:
tasks/standalone/create_cert.yml (+5, -5)
",0.440184,4.196541,-1.386956,0.396511,-1.114369,0.47134,0.268711,-0.460482,0.40159,-0.732351,-0.761482,0.170986,0.050875,-0.526413,0.031336
openstack/octavia,I287d89cd83e91473f1375788c969521aa58ca567,0,0,0,6.0259,0.0678,11,8.33,226,0,Feature,0,0,0,0,0.0,1.0,0,0.0,7,4,0,0.5611,2.7656,3.45,12.26,17.73,1,0,0.3801,1,0.5459,0,0,0,0,0,"Add event notifications for load balancers.

This patch creates tasks for load balancer notifications and adds them to the amphora loadbalancer create/delete/update flows.
[SEP]
FILES CHANGED:
octavia/common/config.py (+1, -0)
doc/source/admin/index.rst (+1, -0)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+77, -20)
octavia/controller/worker/v2/tasks/notification_tasks.py (+51, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_notification_tasks.py (+60, -0)
releasenotes/notes/add-event-notifications-aa9946d771308da5.yaml (+13, -0)
octavia/common/rpc.py (+19, -8)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+17, -0)
etc/octavia.conf (+24, -0)
tools/create_flow_docs.py (+7, -0)
doc/source/admin/event-notifications.rst (+115, -0)
",0.339914,0.244113,-0.41507,1.66422,1.018589,0.068796,0.490671,0.209109,0.404697,-0.436332,-0.422827,0.705605,0.142814,-0.282429,-0.183736
openstack/oslo.limit,I176a7b2b8e2edb50659783a2139c3cc13e8f2f53,1,1,1.0,2.6391,0.2308,2,9.0,251,0,Bug Fix,0,0,0,4,0.133333,0.0,0,0.0,2,2,0,0.6667,0.9957,1.5,-12.23,16.93,1,0,0.0,1,17.9286,1,6,0,7,0,"oslo-config-generator: Fix ValueError

This fixes how the opts data is formatted to fix auto-generation of
config file using oslo-config-generator with oslo.limit entry point.

Closes-Bug: #1962406
[SEP]
FILES CHANGED:
oslo_limit/opts.py (+3, -3)
releasenotes/notes/bug-1962406-e239d60400c726c8.yaml (+7, -0)
",0.899671,0.154899,-0.5202,0.19557,-0.364666,-0.382505,0.13114,0.152481,0.36259,-0.607516,0.124639,-0.084142,0.034199,0.159687,0.354076
openstack/python-ironicclient,I88ed81337c6e2d724b3cf4ddf90e0d60fa052d1c,1,0,1.0,1.0986,0.5,1,18.0,377,0,CI,1,0,0,3,0.015707,1.0,0,1.0,4,1,0,1.0,0.0,4.0,27.2,16.83,1,0,1.0,0,125.6667,0,0,0,0,0,"Avoid using 'foo' as invalid JSON test data

Downstream test environments appear to have a file called 'foo' either
created out-of-band, or created by tests executed in a
non-deterministic order.

This changes the test data to very invalid json which is unlikely to
be a filename, ensuring the expected codepath is tested.
[SEP]
FILES CHANGED:
ironicclient/tests/unit/common/test_utils.py (+1, -1)
",-0.009249,-1.440839,0.01479,0.613565,0.095456,0.088672,0.538638,-0.563548,0.206277,0.038921,-0.194541,0.207154,0.045854,0.337471,-0.002726
openstack/openstack-ansible,Ic110f8cc425482680070d71f8fe3dacfd1f561fd,1,0,0.8182,1.3863,0.0,1,3.8,400,0,Bug Fix,0,0,0,11,0.0176,0.0,0,0.0,0,1,0,0.9,0.0,0.0,-1.84,12.05,1,0,0.0,0,100.0,0,0,0,0,0,"Bump ansible.netcommon version

Starting from version 2.6.0 ansible.netcommon drops ipaddr filter.

This collection is pulled in as a requirement by openvswitch.

We need to fix version of netcommon to ensure that behaviour stays same.

[1] https://github.com/ansible-collections/ansible.netcommon/commit/db4920ebf6bae6476ff8829e2cf475f19f83a990
[SEP]
FILES CHANGED:
ansible-collection-requirements.yml (+3, -0)
",-1.69176,1.088113,-0.780916,-0.492819,0.133655,-0.306272,0.816441,0.21541,-0.01066,0.549029,0.091984,-0.249462,0.018866,0.053694,0.216085
openstack/openstack-ansible-galera_server,Ia110dd9ed09b04f6bb7a0a3adf5a808966558507,1,0,0.8333,2.9444,0.0556,4,14.25,455,0,Feature,0,0,0,12,0.019108,1.0,0,0.8333,2,3,0,1.0,1.6158,1.25,26.14,16.93,0,0,0.0,1,23.9474,0,0,0,0,0,"Use separate tmp directory

During upgrades or cluster repairments, temporary directories are created
inside /var/lib/mysql and treated as databases. This results in errors
during mysqlcheck like:

`Got error: 1102: Incorrect database name '#mysql50#tmp.stLr46FBlt'`

Path outside of datadir is not choosen since it could be separate mount
point and it's important for replication
to survive reboots.
[SEP]
FILES CHANGED:
releasenotes/notes/galera_tmpdir-3271e0bc8e353930.yaml (+10, -0)
tasks/galera_server_post_install.yml (+1, -0)
templates/my.cnf.j2 (+3, -1)
defaults/main.yml (+3, -0)
",-1.006723,-1.966863,-0.219764,-0.193491,0.049382,-0.457674,0.03508,0.027568,-0.043772,0.34417,-0.175768,-0.734337,0.289299,0.304273,-0.29718
openstack/octavia,Icbbab19fabc90f4f4ea63a0ffdf75bb00144b745,1,0,0.0,3.2189,0.6667,1,8.0,155,0,Bug Fix,1,0,0,2,0.033898,0.4,0,0.0,1,1,0,0.5589,0.0,1.0,24.23,15.7,1,0,1.0,1,6.2,0,0,0,0,0,"Change FIPS jobs to centos-9-stream

It also fixed the missing nslookup_target variable for ansible.
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+8, -16)
",2.356706,-0.177078,0.240672,-0.206524,-0.141421,-0.394394,0.249959,0.363919,0.006761,-0.512285,0.134558,-0.083246,-0.4842,-0.054829,0.190482
openstack/kolla-ansible,Iebda3ca7a5f9cef7e5e0930fc4f70764774d6ed5,0,0,0.5,4.6052,0.0404,7,13.86,1979,1,Feature,0,0,0,2,0.004914,1.0,0,0.5,4,4,0,0.8458,2.5181,3.71,45.66,11.59,1,0,0.0,1,19.79,0,0,0,0,0,"Customize the authentication error timeout page in modOIDC

There is a situation that happens when a user triggers an authentication
in OpenStack that uses Identity federation, which leads users to a blank
page with an error message that might not be that clear to users. If the
user takes too long to enter his/her credentials in the login page of
the IdP, the user sees a page saying that the authentication took too
much and that the user must try it again. However, if the user tries
again, she/he is already logged in to the IdP, and then the user gets
access direct to Horizon. This whole process can be a bit confusing for
users, and they saw an error page after the login, which leads them to
think that there was an error in the authentication, but then when
he/she tries again, everything just works.

Therefore, to handle such cases we propose Kolla-ansble to use a custom
error page that has an automatic redirect if the error happens.

The timeout is managed by ""OIDCStateTimeout"" variable. The default
(which is what we have in place now) is 300 seconds (5 minutes):
https://github.com/zmartzone/mod_auth_openidc/blob/d13ee0e4bd2cef94c4d2b55829310175288e0bdf/src/mod_auth_openidc.c#L651).

I would not recommend the increase of this timeout though. I would
rather decrease this value; 5 minutes to such an operation is already
too much. This variable can be overridden via wsgi-keystone.conf file.

To customize the error page we have the following variable
""OIDCHTMLErrorTemplate"". The template is processed in the following
line: https://github.com/zmartzone/mod_auth_openidc/blob/f2b8315cd48faba04320e9a06fc52b57f0989dcb/src/util.c#L1619.
As we can see, there is no default page. The default HTML is hardcoded
in C++, and the template requires two ""%s"" placeholders that will
receive the title of the error message and the full description of the error.
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -0)
ansible/roles/keystone/templates/keystone.json.j2 (+8, -1)
ansible/roles/keystone/templates/modoidc-error-page.html.j2 (+29, -0)
ansible/roles/keystone/defaults/main.yml (+6, -3)
ansible/roles/keystone/tasks/config-federation-oidc.yml (+18, -0)
doc/source/reference/shared-services/keystone-guide.rst (+14, -0)
releasenotes/notes/custom_modOIDC_error_page-0fe3dd7414310536.yaml (+19, -0)
",-2.634604,0.493659,3.179486,-1.199213,-0.62535,0.829622,-0.253557,-1.110726,-0.313316,-0.016034,-0.720241,0.618326,-0.330184,0.085348,0.081101
openstack/kolla-ansible,I94a70d89123611899872061bd69593280d0a68c4,1,0,0.8353,0.6931,1.0,1,14.0,291,0,Bug Fix,0,0,0,85,0.019205,0.0,0,0.0,4,1,0,0.8419,0.0,4.0,17.38,17.03,1,0,0.0,0,145.5,0,0,0,0,0,"Fix prechecks for ""Ironic iPXE"" container

Since I30c2ad2bf2957ac544942aefae8898cdc8a61ec6 this container
is always enabled and thus the port should always be checked.

(cherry picked from commit 19c5f2f0333a8acdc9d745c2d17ef8e9a74bf23c)
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/precheck.yml (+0, -1)
",-1.012906,-1.224453,-1.70821,-2.093788,1.421674,-0.084685,1.04714,-0.214784,0.090336,0.653343,-0.052911,-0.105845,0.259741,0.041556,-0.112611
openstack/openstack-ansible-os_nova,I7de034307da9352e6f5d1f5f175a330fb8c86463,1,1,1.0,2.7081,0.0,4,12.0,294,0,Bug Fix,0,0,0,4,0.142857,1.0,0,1.0,2,3,0,1.0,1.9242,1.25,20.76,17.02,1,0,0.0,1,19.6,0,14,0,24,0,"Add configuration option for heartbeat_in_pthread

This configuration option has been observed to result in file
descriptor leaks in certain circumstances. A variable is added
here so that it can be easily overridden.

Related-Bug: #1961603
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+4, -0)
releasenotes/notes/heartbeat-in-pthread-6266b4bad0efa00c.yaml (+5, -0)
defaults/main.yml (+3, -0)
vars/main.yml (+2, -0)
",0.213608,-1.738273,-0.460232,0.105827,-0.624883,0.549482,-0.29058,-0.549478,0.677826,0.208011,-0.113473,0.046701,-0.142046,-0.14321,0.177024
openstack/openstack-ansible-os_neutron,I833d72715daff81b64da077e899615b9b2002650,1,1,1.0,2.3979,0.0,3,12.0,294,0,Bug Fix,0,0,0,5,0.119048,1.0,0,1.0,2,3,0,0,1.361,1.33,23.11,17.02,1,0,0.0,1,26.7273,0,14,0,24,0,"Add configuration option for heartbeat_in_pthread

This configuration option has been observed to result in file
descriptor leaks in certain circumstances. A variable is added
here so that it can be easily overridden.

Related-Bug: #1961603
[SEP]
FILES CHANGED:
templates/neutron.conf.j2 (+1, -0)
releasenotes/notes/heartbeat-in-pthread-9f5fde7bfdd7d306.yaml (+5, -0)
defaults/main.yml (+4, -0)
",0.213608,-1.738273,-0.460232,0.105827,-0.624883,0.549482,-0.29058,-0.549478,0.677826,0.208011,-0.113473,0.046701,-0.142046,-0.14321,0.177024
openstack/openstack-ansible-os_cinder,I8155264b181d6f21728804ef8260979931597427,1,1,1.0,2.6391,0.0,4,12.0,294,0,Bug Fix,0,0,0,6,0.115385,1.0,0,1.0,2,3,0,0,1.922,1.25,27.81,15.91,1,0,0.0,1,21.0,0,14,0,24,0,"Add configuration option for heartbeat_in_pthread

This configuration option has been observed to result in file
descriptor leaks in certain circumstances. A variable is added
here so that it can be easily overridden.

Related-Bug: #1961603
[SEP]
FILES CHANGED:
releasenotes/notes/heartbeat-in-pthread-d0c9958361c224f0.yaml (+5, -0)
defaults/main.yml (+3, -0)
vars/main.yml (+2, -0)
templates/cinder.conf.j2 (+3, -0)
",0.213608,-1.738273,-0.460232,0.105827,-0.624883,0.549482,-0.29058,-0.549478,0.677826,0.208011,-0.113473,0.046701,-0.142046,-0.14321,0.177023
openstack/castellan,I4e3e4c50ba5d829ed739e278b5286f2bf4808870,1,0,0,2.1972,0.5,2,5.0,269,0,Feature,0,0,0,0,0.0,0.4286,0,0.0,3,2,0,1.0,0.8113,3.0,-14.82,18.0,0,0,0.75,0,29.8889,0,0,0,0,0,"Replace the deprecated argument tenant

The deprecated argument tenant from RequestContext
has been removed since [1], so we switch to 'project_id'.

[1] https://review.opendev.org/c/openstack/oslo.context/+/815938
[SEP]
FILES CHANGED:
doc/source/user/index.rst (+1, -1)
castellan/tests/unit/test_utils.py (+3, -3)
",-0.450743,1.315888,-0.874392,0.303228,-0.976463,0.24732,-0.230477,-0.00894,0.140491,0.231433,-0.5166,-0.439482,-0.42604,-0.125378,-0.203226
openstack/openstack-ansible-os_nova,Ib13d07f4f8c8007be47e5a10a9f63f1e93986876,1,0,0,1.0986,0.5,1,5.0,72,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,1.0,0.0,3.0,-18.2,18.0,1,0,0.0,0,24.0,0,0,0,0,0,"Fix missing quote
[SEP]
FILES CHANGED:
tasks/drivers/kvm/nova_enable_ksm.yml (+1, -1)
",4.853668,2.93092,3.347289,0.388727,0.412263,1.762115,1.306188,-0.707675,1.22571,0.147395,0.338858,-0.588371,0.85539,0.29892,0.677478
openstack/kolla-ansible,I974046662b383a12ac6281b725523760a96657bd,1,1,0.8955,3.912,0.0204,5,10.33,565,0,Bug Fix,0,0,0,67,0.023468,0.0,0,0.0,4,3,0,0.8426,2.1834,3.6,8.04,17.04,0,0,0.0,1,11.3,0,0,0,0,0,"masakari: support libvirt SASL in instance monitor

Since enabling libvirt SASL authentication, the masakari instance
monitor fails to connect to libvirt. We see the following error in logs:

    libvirt.libvirtError: authentication failed: Failed to start SASL
    negotiation: -4 (SASL(-4): no mechanism available: No worthy mechs
    found)

This change adds support for SASL authentication in Masakari instance
monitor.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/834456
Closes-Bug: #1965754
[SEP]
FILES CHANGED:
ansible/roles/masakari/templates/auth.conf.j2 (+6, -0)
ansible/roles/masakari/templates/masakari-instancemonitor.json.j2 (+7, -1)
ansible/roles/masakari/tasks/config.yml (+18, -0)
releasenotes/notes/masakari-libvirt-sasl-f368c31c0b5567b6.yaml (+6, -0)
ansible/roles/masakari/defaults/main.yml (+11, -0)
",-1.610096,-0.235136,0.525139,-0.279997,-0.579743,-0.180866,-0.417349,0.518999,0.09294,0.00339,0.324151,-0.154396,0.224009,-0.152168,-0.095422
openstack/kolla-ansible,Ife83c50c048d517a5c8a5dee588f8f7846fcee00,1,1,1.0,3.4965,0.0,3,13.25,411,0,Bug Fix,0,0,0,1,0.055556,0.9,0,0.9,6,3,0,0.8433,0.9467,4.0,30.57,16.62,0,0,0.0,1,12.4545,0,18,0,4,0,"Adds FluentD configuration for OpenvSwitch log matching

Adds a new configuration file that provides fluentd with an appropiate regex to match with OpenvSwitch logs in both default files.

The regex is segmented with variable as to isolate the relevant parts of each log message.

Closes-Bug: #1965815
[SEP]
FILES CHANGED:
ansible/roles/common/tasks/config.yml (+2, -0)
ansible/roles/common/templates/conf/input/10-openvswitch.conf.j2 (+25, -0)
releasenotes/notes/bug-1965815-37fc4f82bef7a47e.yaml (+5, -0)
",-0.255846,-1.515453,-0.6186,0.649158,0.076414,0.029674,-0.014378,0.530274,0.455736,0.175052,-0.309173,-0.05927,-0.00864,-0.34692,-0.107132
openstack/octavia,I0f4c59a2928f2a813171109aaf73a1d7dff9eefe,1,0,1.0,2.8904,0.0,3,18.5,299,0,Feature,0,0,0,3,0.058824,0.25,0,0.25,4,2,0,0.5606,1.2533,2.67,7.43,21.45,1,0,0.5294,1,16.6111,0,0,0,0,0,"Reject invalid whitespace in HM url_path value

Plain whitespace characters in url_path must be rejected because
they may allow authorized users to inject arbitrary HAProxy
directives in the configuration of amphorae.

Story: 2008994
Task: 42656
[SEP]
FILES CHANGED:
octavia/tests/unit/common/test_validate.py (+9, -0)
releasenotes/notes/validate-url_path-value-in-requests-3eb3adedcd696433.yaml (+7, -0)
octavia/common/validate.py (+1, -0)
",0.096068,-1.270874,-0.338694,0.301051,0.237811,-0.008289,-0.591277,-0.087207,0.434191,-0.22321,-0.262102,0.032726,0.27786,-0.199029,-0.243998
openstack/kolla-ansible,Ie50228a26d635e3db82e41ec266ab820bf58938e,1,1,1.0,1.0986,0.0,1,11.67,314,0,Bug Fix,0,0,0,1,0.5,0.0,0,0.0,4,1,0,0.844,0.0,4.0,13.71,19.52,1,0,0.0,0,104.6667,0,16,0,15,0,"designate: fix external backend deployment

The backend external tasks which utilize an existing bind9
installation require appropriate permissions to be able to
copy rndc config and key.

Closes-Bug: #1912063
[SEP]
FILES CHANGED:
ansible/roles/designate/tasks/backend_external.yml (+2, -0)
",0.958047,-2.26506,-0.11202,-0.642275,-0.176826,-0.227987,-0.578211,0.511866,0.156371,-0.243883,-0.578995,-0.025242,-0.00099,-0.018848,-0.097938
openstack/kayobe,I70f8ddf984996d0821917ba5e5b8977c5a3b6614,0,0,0.8971,1.7918,0.0,2,5.23,590,0,Bug Fix,0,0,1,68,0.023416,0.2105,0,0.1889,2,2,0,0.9429,0.7219,1.0,29.84,11.5,0,0,0.0,1,98.3333,0,0,0,0,0,"Pin Jinja2<3.1.0 to avoid contextfilter removal

Jinja2 3.1.0 removes the contextfilter function which is used heavily in
Kayobe. The following errors are seen:

    [WARNING]: Skipping plugin (networks.py) as it seems to be invalid:
    module 'jinja2' has no attribute 'contextfilter'

    template error while templating string: No filter named 'net_ip'..
    String: {{ admin_oc_net_name | net_ip }}

This change fixes the issue by pinning Jinja2 to <3.1.0.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/835092
[SEP]
FILES CHANGED:
requirements.txt (+1, -0)
releasenotes/notes/pin-jinja2-988297e06a2cf790.yaml (+4, -0)
",-2.115008,1.03383,1.110539,-0.218855,-0.352619,0.145937,-0.099358,-0.065873,0.030784,0.073506,0.244559,-0.432379,-0.054311,-0.001514,-0.083847
openstack/ironic,Icaffb5d346001d62e5c9522708dd44f01faeb3a6,1,0,0.95,2.5649,0.25,2,12.0,118,0,Feature,0,0,0,20,0.012862,1.0,0,0.95,2,2,0,0.9778,1.0,2.0,-2.75,21.47,1,0,0.0,1,9.0769,0,0,0,0,0,"Start API after conductor is started in the combined executable
[SEP]
FILES CHANGED:
releasenotes/notes/allinone-4ca71f150a718811.yaml (+6, -0)
ironic/cmd/singleprocess.py (+3, -3)
",3.332253,-0.747726,2.410424,0.432826,-0.077386,0.409076,0.798589,0.520307,0.16847,-0.368069,-0.369283,0.370222,-0.468731,0.764736,-0.418931
openstack/octavia,Ic370e9edc3fb5548e9cf0d66b85df66e01c41e79,1,0,1.0,4.2905,0.125,5,10.5,484,0,Doc,0,0,0,4,0.058824,0.0,0,0.0,6,2,0,0.5623,2.2065,4.4,29.66,11.82,1,0,0.5,1,6.6301,0,0,0,0,0,"Validate L7Rule value and cookie name

Adds validations in L7 rule and session cookie APIs in order to prevent
authenticated and authorized users to inject code into HAProxy
configuration. CR and LF (\r and \n) are no longer allowed in L7
rule keys and values. The session persistence cookie names must follow
the rules described in
https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie.

Story: 2008994
Task: 44859
[SEP]
FILES CHANGED:
octavia/api/v2/types/pool.py (+10, -4)
octavia/tests/unit/api/v2/types/test_pool.py (+10, -0)
octavia/tests/unit/api/v2/types/test_l7rule.py (+25, -1)
releasenotes/notes/fixed-API-validation-for-L7-rules-and-session-cookies-cb88f3f1b90171f9.yaml (+9, -0)
octavia/api/v2/types/l7rule.py (+9, -4)
",-1.453587,0.359173,0.036035,0.584741,-0.105325,-0.122796,-0.379079,0.454649,0.360778,0.421706,-0.411146,-0.195749,0.397288,-0.093062,-0.458374
openstack/kolla,I97102e18e4ec47bca94d17d964936f039580b06b,1,0,0.617,1.0986,0.5,1,5.5,393,0,Bug Fix,0,0,0,47,0.027405,0.25,0,0.1543,1,1,0,0.8015,0.0,1.0,32.05,13.11,0,0,0.0,0,131.0,0,0,0,0,0,"macros/pip: revert to old setuptools way

AArch64 builds fail with ""AttributeError: install_layout"". This is due
to setuptools issue in Debian:

https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1003252

Switching setuptools to use distutils from stdlib makes error go away.

Backports: Xena, Wallaby (this is where it was first reported).
[SEP]
FILES CHANGED:
docker/macros.j2 (+1, -1)
",-1.067267,-0.14211,-0.262913,-0.337128,-0.661787,-0.06219,-0.046129,-0.043623,-0.482522,0.219872,0.323485,-0.687783,0.239989,0.103288,0.171092
openstack/octavia,I499bdd5edc23b602495a9b2b9f22baf9547261d5,1,0,0.7083,2.7081,0.0,2,14.25,399,0,Bug Fix,0,0,0,72,0.006766,0.5,0,0.3542,3,2,0,0.5639,0.9852,2.5,38.01,14.12,0,0,0.0,1,26.6,0,0,0,0,0,"Fix PING health-monitor with recent Centos releases

Centos 8 Stream removed the capabilities to open raw sockets from the
ping binary and added new sysctl default to allow an unprivileged user
to send ping request.  This sysctl was not inherited by the
amphora-haproxy namespace. Add it explicitly to our sysctl list.

Story 2009953
Task 44911
[SEP]
FILES CHANGED:
elements/haproxy-octavia/post-install.d/20-haproxy-tune-kernel (+8, -0)
releasenotes/notes/fix-ping-hm-on-centos-stream-6624f19c8da86e22.yaml (+6, -0)
",0.175388,-1.430387,-0.332385,0.127463,-0.360768,-0.158788,0.230956,0.457921,-0.061697,-0.221052,0.081176,-0.07676,0.227829,-0.055039,0.248213
openstack/octavia,I35c5976c6bdb8828e54bcde00052622a7b6bc96a,1,0,0.7123,5.0752,0.0189,5,8.6,339,0,Bug Fix,0,0,0,73,0.006851,1.0,0,0.7123,7,3,0,0.5655,0.8416,4.4,28.91,14.6,0,0,0.8491,1,2.1187,0,0,0,0,0,"Fix PING health-monitor with recent haproxy releases

haproxy 2.2.x requires an ""insecure-fork-wanted"" global option when
using external-check.

This commit also fixes a function that builds the list of the features
available in haproxy based on its version.

Story 2009953
Task 44900
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+11, -3)
octavia/common/constants.py (+1, -0)
releasenotes/notes/fix-ping-hm-with-haproxy-2.2-9b83777172fb8835.yaml (+6, -0)
octavia/common/jinja/haproxy/combined_listeners/templates/base.j2 (+3, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+135, -0)
",0.476701,-1.31774,-0.243982,-0.203453,-0.449944,-0.306475,-0.201354,0.306129,0.334991,0.085477,-0.359939,0.000444,-0.064728,-0.000644,0.342972
openstack/openstack-ansible-openstack_hosts,I98622226683d2de63f07e9560bc9521f7eaddf49,1,1,0.8462,1.0986,0.5,1,2.67,113,0,Bug Fix,0,0,0,13,0.020124,0.0,0,0.0,1,1,0,0.5,0.0,1.0,-7.37,26.07,1,0,0.0,0,37.6667,0,6,0,14,0,"Use correct system.conf.d permissions

Closes-Bug: #1964332
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
",1.867108,-0.509633,-0.234689,-0.898552,-0.708677,0.665622,-0.825001,0.436698,0.16919,-0.154666,0.437386,-0.402723,-0.283608,0.57264,-0.218339
openstack/kolla,I72d7920acd8d15941c8c57a4186186212b273a38,1,0,0.625,1.9459,0.1667,1,3.29,503,0,Feature,0,0,0,48,0.027956,0.0,0,0.0,3,1,0,0.8029,0.0,3.0,-28.23,10.88,0,0,0.0,0,71.8571,0,0,0,0,0,"elasticsearch: install Java first on CentOS too

elasticsearch-oss package fails to install if we install it with Java:

INFO:kolla.common.utils.elasticsearch:could not find java; set JAVA_HOME
INFO:kolla.common.utils.elasticsearch:error: %prein(elasticsearch-oss-0:6.8.23-1.noarch) scriptlet failed, exit status 1
INFO:kolla.common.utils.elasticsearch:[91mError in PREIN scriptlet in rpm package elasticsearch-oss

Backport down to ussuri needed.
[SEP]
FILES CHANGED:
docker/elasticsearch/elasticsearch/Dockerfile.j2 (+5, -1)
",-1.903394,1.487073,0.127014,0.205484,0.221628,-0.354237,-0.077802,0.290269,-0.405613,0.176938,0.589686,-0.301366,0.122784,0.626434,-0.139175
openstack/openstack-ansible-repo_server,I19321a61cce978e781c3581fcc136609b5be8092,1,0,0.8571,1.0986,0.5,1,4.0,410,0,Feature,0,0,0,14,0.021605,1.0,0,0.8571,1,1,0,1.0,0.0,1.0,-4.03,10.49,0,0,0.0,0,136.6667,0,0,0,0,0,"Use /run/nginx.pid

In modern systems /var/run folder is just a symlink to
/run with potential to be removed in the future.

Currently, nginx might fail on Debian jobs because of that [1]

[1] https://zuul.opendev.org/t/openstack/build/54263ee3816c484d94505a629558218c/log/logs/openstack/aio1_repo_container-da3488c9/nginx.service.journal-12-02-06.log.txt
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -1)
",-1.913784,1.716036,-0.467395,-0.532422,-0.420059,-0.569701,1.196217,0.343576,0.161624,0.159154,0.115847,-0.452842,0.021585,0.320109,-0.121599
openstack/kolla-ansible,Icd709cb042d44e063c5da64ab0695b0b6ba6d48b,0,0,0,6.3561,0.0017,21,3.83,536,0,Doc,0,0,0,0,0.0,1.0,0,0.0,4,6,0,0.8447,3.3311,2.57,-49.02,18.06,0,0,0.4991,1,0.9306,0,0,0,0,0,"Add container engine migration scenario

Add ""migrate-container-engine"" action to kolla-ansible which
changes the container engine on which the Openstack is deployed on.
For example Docker to Podman and vice versa.

Depends-on: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/925083
[SEP]
FILES CHANGED:
tests/post.yml (+7, -0)
ansible/roles/container-engine-migration/tasks/main.yml (+8, -0)
ansible/roles/container-engine-migration/tasks/check-migration.yml (+15, -0)
tests/run.yml (+15, -1)
ansible/roles/container-engine-migration/tasks/uninstall-current-engine.yml (+20, -0)
doc/source/admin/advanced-configuration.rst (+38, -0)
kolla_ansible/cli/commands.py (+13, -0)
zuul.d/base.yaml (+11, -0)
ansible/roles/container-engine-migration/defaults/main.yml (+19, -0)
ansible/roles/container-engine-migration/tasks/migrate-volumes.yml (+69, -0)
ansible/roles/container-engine-migration/files/ce-cleanup.sh (+55, -0)
ansible/roles/container-engine-migration/tasks/install-target-engine.yml (+8, -0)
tests/test-container-engine-migration.sh (+205, -0)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+1, -0)
ansible/roles/container-engine-migration/tasks/ovs-cleanup.yml (+14, -0)
ansible/migrate-container-engine.yml (+21, -0)
ansible/roles/mariadb/tasks/deploy.yml (+5, -0)
zuul.d/project.yaml (+6, -0)
setup.cfg (+1, -0)
etc/kolla/globals.yml (+1, -0)
zuul.d/jobs.yaml (+42, -0)
",-1.255457,1.657448,-1.278724,0.660847,-0.413105,-0.587291,0.153385,0.096638,0.188226,-0.328149,-0.088503,0.172006,0.370585,0.286883,0.029525
openstack/ironic-python-agent,I0fd6356f036d5ff17510fb838eaf418164cdfc92,1,0,1.0,6.6921,0.0708,8,20.88,1219,0,Feature,0,0,0,15,0.014286,1.0,0,1.0,4,2,0,0.9048,1.6377,2.62,20.5,19.85,0,0,0.7863,1,1.5124,0,0,0,0,0,"Multipath Hardware path handling

Removes multipath base devices from consideration by
default, and instead allows the device-mapper device
managed by multipath to be picked up and utilized
instead.

In effect, allowing us to ignore standby paths *and*
leverage multiple concurrent IO paths if so offered
via ALUA.

In reality, anyone who has previously built IPA with
multipath tooling might not have encountered issues
previously because they used Active/Active SAN storage
environments. They would have worked because the IO lock
would have been exchanged between controllers and paths.
However, Active/Passive environments will block passive
paths from access, ultimately preventing new locks from
being established without proper negotiation. Ultimately
requiring multipathing *and* the agent to be smart enough
to know to disqualify underlying paths to backend storage
volumes.

An additional benefit of this is active/active MPIO devices
will, as long as ``multipath`` is present inside the ramdisk,
no longer possibly result in duplicate IO wipes occuring
accross numerous devices.

Story: #2010003
Task: #45108
Resolves: rhbz#2076622
Resolves: rhbz#2070519
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+150, -3)
releasenotes/notes/multipath-handling-00a5b412d2cf2e4e.yaml (+18, -0)
ironic_python_agent/tests/unit/extensions/test_image.py (+2, -0)
ironic_python_agent/tests/unit/test_hardware.py (+477, -38)
ironic_python_agent/tests/unit/test_utils.py (+28, -8)
ironic_python_agent/tests/unit/test_agent.py (+15, -6)
ironic_python_agent/utils.py (+1, -0)
ironic_python_agent/tests/unit/samples/hardware_samples.py (+57, -2)
",-3.011804,-1.483932,3.283803,-0.815447,-0.16496,-0.14083,-0.708376,-0.011082,-0.053732,-0.335711,-0.482314,0.155517,0.109999,-0.100255,0.013976
openstack/octavia,I623aa9b42ea40bdf420f124b981b7755e6c630f8,1,0,1.0,1.9459,0.3333,1,13.0,438,0,Bug Fix,0,0,0,5,0.116279,1.0,0,1.0,3,1,0,0.5672,0.0,3.0,9.8,16.74,0,0,0.0,0,62.5714,0,0,0,0,0,"Passphrase parameters should be secret

Passphrase parameters are considered to be secret information and
should not appear in logs even when debug is enabled.

This change marks the following two passphrase parameters as secrets
and ensures actual values are hidden in oslo.config debug logs.
 - [certificates] server_certs_key_passphrase
 - [certificates] ca_private_key_passphrase
[SEP]
FILES CHANGED:
octavia/certificates/common/local.py (+4, -2)
",-1.788301,-0.300327,-0.296331,1.281864,1.299236,-0.32928,-0.467952,0.078316,0.380216,0.445697,0.026061,-0.461913,0.160132,-0.171869,-0.715585
openstack/kolla,I9d2dd025b2a4805ef1755ebbf10f15018d05f1c7,1,1,0.6327,0.6931,1.0,1,7.0,97,0,Bug Fix,0,0,0,49,0.028439,0.5714,0,0.3615,2,1,0,0.8043,0.0,2.0,-5.73,25.66,0,0,0.0,0,48.5,0,4,0,7,0,"build watcher images

Closes-bug: #1952944
[SEP]
FILES CHANGED:
kolla/image/build.py (+0, -1)
",2.240597,-0.45202,-0.375365,-1.641974,-0.709855,0.633719,-0.913533,0.163966,0.101991,-0.629432,0.437786,-0.29102,0.25702,0.230548,0.221189
openstack/charm-ceph-radosgw,I82634255ca3423fec3fc15c1e714dcb31db5da7a,1,1,0,3.2189,0.125,3,7.85,841,0,Bug Fix,0,0,1,0,0.0,0.2083,0,0.0,1,2,0,0,1.4506,0.67,38.79,10.98,1,0,0.4583,0,33.64,0,22,0,11,0,"Enable HAProxy HTTP Health Checks

Ceph radosgw supports [0] the swift health check endpoint
""/swift/healthcheck"". This change adds the haproxy
configuration [1] necessary to take the response of ""GET
/swift/healthcheck"" into account when determining the health
of a radosgw service.

For testing, I verified that:
- HAProxy starts and responds to requests normally with this
  configuration.
- Servers with status != 2xx or 3xx are removed from the
  backend.
- Servers that take too long to respond are also removed
  from the backend. The default timeout value is 2s.

[0] https://tracker.ceph.com/issues/11682
[1] https://www.haproxy.com/documentation/hapee/2-0r1/onepage/#4.2-option%20httpchk

Closes-Bug: 1946280
(cherry picked from commit 31a4584169c1c78e59dc505de4163d528d1cae0a)
[SEP]
FILES CHANGED:
unit_tests/test_ceph_radosgw_context.py (+5, -1)
test-requirements.txt (+4, -1)
hooks/ceph_radosgw_context.py (+12, -1)
",-3.250922,0.583247,2.325658,-1.184372,-0.324643,0.027003,-0.213054,0.373046,0.077158,0.065317,-0.306871,-0.020506,-0.033361,0.061444,-0.059349
openstack/octavia,I433e074c2eac5f6875ee5dace8faf86969b24f66,1,0,0.7162,4.6728,0.0943,3,23.0,590,0,Bug Fix,0,0,0,74,0.006842,0.4167,0,0.2984,6,2,0,0.5688,0.8749,4.0,41.88,16.59,0,0,0.1226,1,5.514,1,0,0,0,0,"Fix potential race conditions on update requests in the v2 worker

The v2 worker was not waiting for a resource to be set to PENDING_UPDATE
before updating it effectively. In some circumstances (loaded
server/slow DB for instance), the resources may have been updated with
old data from the DB, resulting in a no-op update.

This wait for a PENDING_UPDATE state exists in amphorav1 but it was not
moved to v2 when we switched the logic from the DB-based objects to
dict-based objects.

Story 2009887
Task 44645
Story 2009985
Task 45032
[SEP]
FILES CHANGED:
releasenotes/notes/fix-race-condiction-on-update-b5330c8fcf1800cd.yaml (+7, -0)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+12, -1)
octavia/controller/worker/v2/controller_worker.py (+77, -9)
",-1.31782,-1.405174,0.555452,0.04359,-0.207108,0.382349,0.133967,-0.063628,0.034391,0.147666,0.339548,0.188807,0.03384,0.127042,0.188408
openstack/kayobe,I3f499d63d19ba7f7372b401bd2da23ce627f18e5,1,0,0.8841,2.6391,0.0769,2,11.0,408,0,Feature,0,0,0,69,0.023719,0.0,0,0.0,4,2,0,0.9296,0.6194,3.0,31.08,14.58,0,0,0.0,1,29.1429,0,0,0,0,0,"kolla_passwords: add no_log for password overrides

The kolla_passwords module overrides parameter may contain sensitive
data, including passwords and SSH keys. It should be protected via
no_log. Without this, the parameter value may be exposed in Ansible
logs, or if level 3 verbosity is used, Ansible output.

This change adds no_log to the parameter.
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/library/kolla_passwords.py (+1, -1)
releasenotes/notes/kolla-passwords-overrides-no-log-57054ce64fae8143.yaml (+11, -0)
",-0.836412,-0.319984,-0.468947,1.369856,0.453521,-0.139506,-0.02052,-0.124322,0.501002,0.079057,0.192735,-0.296806,0.043981,-0.222805,-0.309126
openstack/openstack-ansible,Ia072069b9acf88c0642a0e3674324733626c050e,1,0,0.8667,2.0794,0.0,1,5.5,102,0,CI,1,0,0,15,0.023077,0.0,0,0.0,2,1,0,0.9091,0.0,2.0,24.36,16.75,0,0,1.0,0,12.75,0,0,0,0,0,"Mark OSA repository as safe in git.config in CI
[SEP]
FILES CHANGED:
zuul.d/playbooks/pre-osa-aio.yml (+7, -0)
",2.47449,0.459481,1.201283,0.666594,0.759351,-0.266278,0.491497,0.703236,-0.324357,0.137015,-0.044298,-0.279212,-0.157086,0.288885,-0.515431
openstack/kolla,I2cbf1f539880d512aa223c3ef3a4b19ee18854ac,1,1,0.64,3.091,0.0476,2,12.47,1239,1,Bug Fix,0,0,0,50,0.029002,0.6,0,0.384,2,2,0,0.8058,0.9852,2.0,53.48,11.19,0,0,0.0,1,56.3182,0,6,0,34,0,"Fix image builds with sources using a type=git

A recent change to git [1] introduced a new behaviour to work around a
CVE [2] that disallows any git operations in directories not owned by
the current user.

This may seem unrelated to installation, but it plays havoc with PBR,
which calls out to git to get to get revision history.  So if you are
""pip install""-ing from a source tree you don't own, the PBR git calls
in that tree now fail and the install blows up.

When using type=source, kolla clones the repository, then creates a
tarball from it, which is ADDed to the image. The ownership of the files
in the tarball is preserved, which in this case will be the user running
kolla-build. Since the Docker build runs as root, we hit the PBR issue.

Our solution is to make sure that any tarball we generate from git
sources have all files owned by root:root so that the root user is able
to use git commands when building container images.

[1] https://github.com/git/git/commit/8959555cee7ec045958f9b6dd62e541affb7e7d9
[2] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24765.

Closes-Bug: #1969096
Related-Bug: #1968877

Co-Authored-By: Mark Goddard <mark@stackhpc.com>
[SEP]
FILES CHANGED:
kolla/image/build.py (+11, -1)
releasenotes/notes/git-security-fix-fix-ea56c0071585237d.yaml (+9, -0)
",-2.995626,0.979446,3.818283,-1.334562,-0.62971,0.452265,0.047239,-0.452129,-0.310962,-0.254693,-0.338788,0.286959,0.035951,0.19781,-0.103157
openstack/octavia,I888a672b876e2914c56f882f8bb8cb67721506cf,0,0,0.72,0.6931,0.0,1,16.67,315,0,Bug Fix,1,0,0,75,0.006868,0.4118,0,0.2965,1,1,0,0.5704,0.0,1.0,66.4,9.87,0,0,1.0,1,157.5,0,0,0,0,0,"Fix grenade job by using dib git repo

A recent git update broke our jobs, diskimage-builder was updated to fix
this issue but the grenade job doesn't use dib from master (our other
jobs do).
This commit ensure that our grenade job pulls dib from the git repo.
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+1, -0)
",1.014574,-1.454609,-0.003509,0.541696,-0.338118,-0.182241,1.021644,-0.249386,-0.67105,-0.515277,0.148944,-0.314291,0.25875,0.35605,0.067031
openstack/charm-nova-compute,I7d3e7f9f5c69f7ad06191a20bdfcfd6b5dca50d3,1,1,0,3.989,0.0377,2,19.33,512,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.6573,1.0,6.34,18.77,1,0,0.8302,0,9.4815,0,12,0,14,0,"Use correct relation key for allocation defaults

The nova-cloud-controller charm passes allocation ratio defaults
in the format '{cpu,disk,ram}_allocation_ratio' on the cloud-compute
relation.

Ensure that later OpenStack releases (>= Stein) query using this
key rather than one prefixed with 'initial_' which is used for the
target Nova Compute configuration option.

Closes-Bug: 1961065
(cherry picked from commit 764adf7007b72c4c511686fe559802ee32075105)
[SEP]
FILES CHANGED:
hooks/nova_compute_context.py (+7, -2)
unit_tests/test_nova_compute_contexts.py (+44, -0)
",-1.714998,-0.702697,-0.140369,-0.580272,0.741158,-0.179222,0.169655,0.284422,0.436946,-0.040245,0.256455,0.049793,0.079893,-0.081171,-0.357386
openstack/kayobe,I6424fc405894514a63fb2b641637bbb9d5c070c0,1,0,0.9737,3.1355,0.4091,3,10.6,402,0,Bug Fix,0,0,0,38,0.062706,0.0,0,0.0,3,2,0,0.9306,1.5726,2.0,39.65,12.54,1,0,0.0,0,17.4783,0,0,0,0,0,"Fix no_proxy configuration

The no_proxy list should only contain domains, hostnames, IP addresses
and networks, but docker_registry is often in the form ip_address:port.

Use urlsplit to extract the hostname from the docker_registry variable
after prepending http:// to turn it into a valid URL.

Also add missing infra-vms to hosts in proxy.yml.
[SEP]
FILES CHANGED:
ansible/proxy.yml (+4, -4)
ansible/group_vars/all/proxy (+5, -3)
etc/kayobe/proxy.yml (+4, -2)
",-1.011444,-0.948898,-0.286169,0.835975,0.42824,-0.553981,0.021067,-0.069147,0.205692,0.073932,-0.16424,-0.765164,-0.157014,0.327402,-0.450179
openstack/ansible-collection-kolla,Ie7025342ff0c1a052ccbd449e278bc5d3424a0bf,1,0,0,1.0986,0.5,1,10.2,436,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0,0.0,3.0,-4.24,17.41,0,0,0.0,0,145.3333,0,0,0,0,0,"Adjust iscsi package removal on Red Hat hosts.

The host libvirt package should only be removed when the nova-libvirt
container is enabled. But, removal of iscsi-initiator-utils also causes
libvirt to be uninstalled because of its dependency on
libvirt-daemon-driver-storage-iscsi.

This modification prevents iscsi-initiator-utils from being removed
when nova-libvirt is disabled.
[SEP]
FILES CHANGED:
roles/baremetal/defaults/main.yml (+1, -1)
",-2.045722,-0.106805,-0.772551,1.046519,0.476495,-1.290829,0.047331,0.336547,-0.174546,-0.11588,0.073385,0.51168,0.291401,-0.059269,0.157771
openstack/kolla-ansible,Ie4f502f955dac5ae9ee8ddb4779c2fa2e26840d9,1,1,0,1.9459,0.5,2,8.25,260,0,Bug Fix,0,0,0,0,0.0,0.7,1,0.0,3,1,0,0.8409,0.9183,3.0,47.21,10.57,1,0,0.0,0,37.1429,0,6,0,9,0,"Fix ansible version in install command

There are no 5.* versions of ansible for CentOS 8 Stream yet.
One should use pip install 'ansible>=4,<6' according to the
current documentation.

Closes-Bug: #1969617
[SEP]
FILES CHANGED:
doc/source/user/quickstart.rst (+2, -2)
doc/source/user/virtual-environments.rst (+1, -1)
",0.379514,-1.370335,-0.507045,-0.214845,-0.505262,0.231225,-0.717672,0.19402,-0.226627,0.181181,-0.213289,-0.029397,0.232458,0.150524,0.16633
openstack/kayobe,I5273edc8265f115519f499e85fe12f8d22306c4b,1,0,0.7857,3.4012,1.0,1,7.14,479,0,Feature,0,0,0,14,0.028056,0.0,0,0.0,4,1,0,0.9315,0.0,4.0,3.31,17.26,1,0,0.0,0,15.9667,0,0,0,0,0,"Cleanup old and deprecated Swift configuration

This is old and deprecated configuration settings for Swift not needed
anymore because kolla-ansible correctly configure glance-api.conf and
glance-swift.conf since Idddbf2ce741e0486d60e1de88c77a7f0332a5a2b when
kolla_enable_swift variable set to true. This change can be backported
through all releases till the Train.
[SEP]
FILES CHANGED:
ansible/roles/kolla-openstack/templates/glance.conf.j2 (+0, -29)
",-1.08771,-0.756036,-0.97755,-0.60747,0.883272,-0.512179,0.400859,0.154906,0.060008,0.268085,-0.442002,-0.073556,-0.145366,0.19982,0.324127
openstack/octavia,I36acdee1f8782b17c234f6b250facc5c8d0aaf87,1,0,1.0,2.7726,0.1333,2,13.0,291,0,Bug Fix,0,0,0,5,0.035714,1.0,0,1.0,6,1,0,0.5683,0.7219,5.0,28.78,16.48,1,0,0.8,0,18.1875,0,0,0,0,0,"Fix AttributeError in exception handler

The exception handler of save_state() caused an AttributeError
because it tried to get the output attribute of the Exception,
which does not exist in general. Added a test to cover this
scenario.
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/haproxy_query.py (+1, -2)
octavia/tests/unit/amphorae/backends/utils/test_haproxy_query.py (+12, -0)
",0.432338,-1.685835,0.294342,0.435925,-0.359687,0.726757,-0.209325,-0.811384,0.315653,0.326165,-0.064051,-0.112991,-0.254204,0.122808,0.15895
openstack/kayobe,I9c6e261dbac067ca3f9218e6ea81813ddc2f6520,1,0,0.9744,2.0794,0.1429,2,7.67,197,0,Bug Fix,0,0,0,39,0.062102,0.8,0,0.7795,2,2,0,0.9324,0.8631,1.0,37.21,13.5,1,0,0.0,1,24.625,0,0,0,0,0,"Bump stackhpc.drac role

This new version fixes the evaluation of check_mode, which is causing
`kayobe overcloud bios raid configure` to fail.
[SEP]
FILES CHANGED:
releasenotes/notes/stackhpc-drac-check-mode-8097215f8eca9991.yaml (+5, -0)
requirements.yml (+1, -1)
",1.544513,-0.777758,-0.213566,-0.191852,0.076982,0.348771,0.163375,0.011173,0.154844,-0.672009,0.279502,0.136692,-0.690649,-0.296262,-0.051737
openstack/ironic,I35e0aa2a5e612e6e45c9489153dbb3ff3e500a66,1,0,1.0,2.7081,0.2857,3,26.33,525,0,CI,0,0,0,1,0.020833,1.0,0,1.0,6,2,0,0.9783,1.5306,4.0,36.61,17.62,1,1,0.2143,1,35.0,1,0,0,0,0,"[iRMC] Change the way to get irmc-info in raid

When using the node managed by the `irmc` hardware type,
if the port number of the bmc address is manually specified,
the following error will occur when configuring raid:

```
%d format: a number is required, not str
```

Change raid to call parse_driver_info to get irmc_info,
so that irmc-port can be converted to int type to avoid this error.

Story: #2010009
Task: #45151
[SEP]
FILES CHANGED:
releasenotes/notes/irmc-change-the-way-to-get-irmc-info-in-raid-8ef5f5f60d1f534a.yaml (+5, -0)
ironic/tests/unit/drivers/modules/irmc/test_raid.py (+2, -1)
ironic/drivers/modules/irmc/raid.py (+3, -3)
",-1.583958,-1.568144,0.387008,0.069318,0.054061,-0.340532,-0.315873,0.148243,0.434444,0.229452,0.15109,-0.403394,-0.180696,0.305479,-0.320679
openstack/octavia,Ib72f02450900654518cec9bef1b5dca397cbfb7a,1,0,0.0,3.7136,0.5,3,6.0,90,0,Bug Fix,0,0,0,1,0.5,0.5,0,0.0,2,1,0,0.5699,1.5129,2.0,-95.35,35.73,0,0,0.0,0,2.1951,0,0,0,0,0,"Remove unnecessary unicode prefixes
[SEP]
FILES CHANGED:
api-ref/source/conf.py (+4, -4)
doc/source/conf.py (+9, -9)
releasenotes/source/conf.py (+7, -7)
",2.481706,0.997297,1.85175,0.653582,1.921056,1.207947,-0.096108,-0.705351,0.250076,-0.301299,-0.570809,-0.461116,0.520016,-0.28044,-0.007959
openstack/octavia,I035c569b4feaa23b00c0cad50c36aaecf06f7848,0,0,1.0,4.5109,0.4444,8,3.67,433,0,Feature,0,0,0,6,0.03871,0.4615,0,0.4615,4,5,0,0.5714,2.7535,1.25,41.6,8.74,1,0,0.5111,1,4.7582,0,0,0,0,0,"Move to Python 3.8

Update Python base version from 3.6 to 3.8. For Zed the minimum
Python runtime versions are Python 3.8 and 3.9 [1]. As a third
Python version I also added 3.10 already.

Removed ThreadedHTTPServer and replaced it with ThreadingHTTPServer from
standard library, which is new in Python 3.7.

[1]: https://governance.openstack.org/tc/reference/runtimes/zed.html
[SEP]
FILES CHANGED:
releasenotes/notes/move-to-python-3.8-203249392fd1f1aa.yaml (+6, -0)
octavia/cmd/prometheus_proxy.py (+4, -13)
zuul.d/projects.yaml (+19, -2)
octavia/tests/unit/cmd/test_prometheus_proxy.py (+1, -4)
setup.cfg (+2, -3)
TESTING.rst (+2, -2)
tox.ini (+8, -8)
zuul.d/jobs.yaml (+8, -8)
",-1.456999,0.112396,-0.024544,0.198454,-0.450218,0.118757,-0.018658,0.935693,-0.240836,0.958302,-0.095544,0.019102,-0.333018,0.264729,-0.121777
openstack/ironic,I6a8f38934b475f792433be6f0882540b82ca26c1,1,1,1.0,3.912,0.0408,4,15.17,665,0,Bug Fix,0,0,0,1,0.066667,1.0,0,1.0,4,2,0,0.9787,1.8599,2.5,35.26,14.86,1,0,0.2041,1,13.3,0,6,0,5,0,"Exclude current conductor from offline_conductors

In some cases the current conductor may have failed to updated
the heartbeat timestamp due to failure of resource starvation.
When this occurs the dbapi get_offline_conductors method will
include the current conductor in its return value.

In this scenario the conductor may end up forcefully remove
node reservations or allocations from itself, triggering takeover
which fail on-going operations.

This change adds a wrapper to exclude the current conductor.
The wrapper will log a warning to raise the issue.

Related-Bug: #1970484
Stroy: 2010016
Task: 45204
[SEP]
FILES CHANGED:
ironic/conductor/manager.py (+4, -2)
ironic/tests/unit/conductor/test_utils.py (+10, -0)
ironic/conductor/utils.py (+21, -0)
releasenotes/notes/exclude-current-conductor-from-offline-conductors-2e2ef401a8b7d7e8.yaml (+12, -0)
",-1.622723,-1.324026,0.406748,0.228014,-0.179,0.429289,-0.307088,-0.272604,0.676352,-0.159344,0.246136,0.330956,-0.004639,0.002061,0.039496
openstack/kolla-ansible,I3f7b480519aea38c3927bee7fb2c23eea178554d,1,0,0.6471,5.4848,0.4333,9,6.53,1163,0,Doc,0,0,0,51,0.029226,1.0,0,0.6471,4,2,0,0.8416,2.3544,2.0,-4.05,11.26,1,0,0.9,1,4.8257,0,0,0,0,0,"Add CentOS Stream 9 / Rocky Linux 9 host support

Added c9s jobs are non voting, as agreed on PTG to focus on Rocky Linux 9.
Since both CS9 and RL9 have higher default fd limit (1073741816 vs
1048576 in CS8) - lowering that for:
* RMQ - because Erlang allocates memory based on this (see [1], [2], [3]).
* MariaDB - because Galera cluster bootstrap failed

Changed openvswitch_db healthcheck, because for unknown reason
the usual check (using lsof on /run/openvswitch/db.sock) is hanging
on ""Bad file descriptor"" (even with privileged: true).

[1]: https://github.com/docker-library/rabbitmq/issues/545
[2]: https://github.com/rabbitmq/cluster-operator/issues/959#issuecomment-1043280324
[3]: https://github.com/systemd/systemd/commit/a8b627aaed409a15260c25988970c795bf963812

Depends-On: https://review.opendev.org/c/openstack/tenks/+/856296
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/856328
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/856443
Needed-By: https://review.opendev.org/c/openstack/kolla/+/836664
Co-Authored-By: Micha≈Ç Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
tests/run-hashi-vault.yml (+5, -0)
ansible/group_vars/all.yml (+8, -1)
ansible/roles/openvswitch/defaults/main.yml (+1, -1)
roles/cephadm/tasks/pkg_redhat.yml (+7, -0)
tests/pre.yml (+15, -2)
zuul.d/project.yaml (+25, -26)
zuul.d/nodesets.yaml (+22, -22)
zuul.d/jobs.yaml (+50, -49)
ansible/roles/prechecks/vars/main.yml (+3, -3)
",-3.756362,4.339288,3.0097,-1.021793,-0.445636,0.857748,-0.262344,-0.5706,-0.625574,-0.444742,-0.387592,0.308097,0.197551,-0.189911,0.002616
openstack/octavia-lib,I4f0d640879da5afaa4694484ad4c52f25445a8ae,0,0,0.8571,2.9444,0.3333,4,3.35,502,0,Feature,0,0,0,7,0.028571,0.4528,0,0.3881,2,3,0,0.08,1.8911,0.75,22.36,9.76,1,0,0.2222,1,26.4211,0,0,0,0,0,"Move to Python 3.8

Update Python base version from 3.6 to 3.8. For Zed the minimum
Python runtime versions are Python 3.8 and 3.9 [1]. As a third
Python version I also added 3.10 already.

Removed ThreadedHTTPServer and replaced it with ThreadingHTTPServer from
standard library, which is new in Python 3.7.

[1]: https://governance.openstack.org/tc/reference/runtimes/zed.html

Depends-on: https://review.opendev.org/c/openstack/octavia/+/839604
[SEP]
FILES CHANGED:
releasenotes/notes/move-to-python-3.8-6a29d13144e8c378.yaml (+6, -0)
zuul.d/projects.yaml (+2, -2)
setup.cfg (+3, -3)
tox.ini (+1, -1)
",-1.872196,0.972431,0.255766,-0.162928,-0.734052,0.11019,-0.007927,0.680237,-0.19418,0.530211,-0.097538,0.099577,-0.37262,0.134691,-0.14294
openstack/octavia,I2f49cbb7f8d99ba2da878bbfc7081a3cc3b3aa07,0,0,0.75,3.2958,0.1538,7,9.5,177,0,Feature,0,0,0,8,0.030418,0.5882,0,0.4412,5,5,0,0.5693,2.5977,2.57,-3.18,22.75,1,0,0.2692,1,6.5556,0,0,0,0,0,"Make amphora timezone configurable

The new amp_timezone option allows to adjust the timezone of
amphora using cloud-init.
[SEP]
FILES CHANGED:
octavia/common/config.py (+4, -0)
octavia/common/jinja/templates/user_data_config_drive.template (+2, -0)
octavia/tests/unit/common/jinja/test_user_data_jinja_cfg.py (+4, -3)
devstack/plugin.sh (+1, -0)
octavia/common/jinja/user_data_jinja_cfg.py (+2, -1)
etc/octavia.conf (+3, -0)
releasenotes/notes/add-config-option-for-amp-timezone-6496a33a23d7520d.yaml (+6, -0)
",0.479996,-0.056911,-0.852772,0.995225,0.801805,0.041204,-0.230834,-0.121849,0.129367,-0.585533,-0.101196,0.414708,-0.746158,0.093934,0.136732
openstack/ironic-python-agent,I41ffe4f8e4c6e43182090b5aa2a2b4b34f32efd5,1,0,0.9524,4.5433,0.4086,3,12.33,276,0,Feature,0,0,0,21,0.013401,1.0,0,0.9524,3,2,0,0.9091,1.4832,2.0,22.83,17.91,1,0,0.3333,1,2.9362,0,0,0,0,0,"Use a pre-defined partition UUID to detect configdrive on GPT

Using partition numbers is currently broken for devicemapper devices.
Fortunately, GPT has partition UUIDs, so we can just generate one and
use it for lookup.
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/test_partition_utils.py (+7, -24)
releasenotes/notes/configdrive-partuuid-3259cfb7428c1483.yaml (+17, -0)
ironic_python_agent/partition_utils.py (+31, -14)
",0.157152,-0.53548,-0.351277,1.27855,0.225426,0.380311,0.174878,-0.318262,-0.350693,0.127522,-0.113189,0.31561,0.272103,-0.55434,-0.139667
openstack/kayobe,Id9418e4e88c52056412daa22462aa611bfcc59ae,1,0,0.8857,2.0794,0.0,2,11.0,326,0,Feature,0,0,0,70,0.023956,1.0,0,0.8857,2,2,0,0.9333,0.8631,1.5,39.93,14.4,0,0,0.0,1,40.75,0,0,0,0,0,"ironic: Set MTU on provisioning and cleaning Neutron networks

Previously we were not applying an MTU defined in Kayobe networks.yml to
the provisioning and cleaning networks in Neutron. This could lead to
issues when nodes communicate with the Ironic and Inspector APIs.
[SEP]
FILES CHANGED:
releasenotes/notes/provision-net-mtu-befdda04224f49a6.yaml (+5, -0)
ansible/provision-net.yml (+2, -0)
",-0.168228,-0.386381,-0.168911,1.324672,0.494247,0.312041,-0.051914,0.353228,-0.298083,-0.001391,-0.033413,0.223274,0.263822,-0.405377,-0.19858
openstack/octavia,I63474acbcea5106ea702d21cb238aa57cef5d96d,1,0,0.6667,2.4849,0.1818,3,7.0,268,0,Bug Fix,0,0,0,9,0.031142,0.5,0,0.3333,6,3,0,0.5673,1.3222,2.67,42.62,14.23,1,0,0.0,1,22.3333,0,0,0,0,0,"Remove unneeded sudo in lvs-masquerade.sh

Fixes issue with SELinux and the lvs-masquerade.sh script on the
amphora.
The script already runs with root permissions, so the use of sudo
inside the script is unneeded.
[SEP]
FILES CHANGED:
.gitignore (+1, -0)
elements/amphora-agent/static/usr/local/bin/lvs-masquerade.sh (+2, -2)
releasenotes/notes/fix-selinux-issue-with-lvs-masquerade.sh-ebbb89886148c70f.yaml (+6, -0)
",0.033645,-0.16054,-0.619666,0.763641,0.14497,0.018915,0.368939,-0.293708,-0.490131,-0.501276,0.323489,0.077575,0.003928,0.074281,0.240607
openstack/openstack-ansible-os_keystone,I1b9658a7ef4efc66c9ad5636474a19302589ecfb,1,0,0.8,0.6931,0.0,1,12.5,185,0,Feature,0,0,0,10,0.151515,1.0,0,0.8,1,1,0,1.0,0.0,1.0,45.25,13.0,0,0,0.0,0,92.5,0,0,0,0,0,"Set pki_dir when keystone calls the pki role

This is needed to use the deployment wide location for the CA and
certificate store.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",1.759978,-1.353449,-0.110677,0.690507,0.275122,-0.110672,0.941175,0.384936,0.114206,-0.690216,-0.017107,0.033598,-0.572474,-0.129688,-0.457742
openstack/ironic-python-agent,I9a445e847d282c50adfa4bad5e7136776861005d,1,0,0.9545,5.3033,0.29,5,8.75,240,0,Feature,0,0,0,22,0.013253,1.0,0,0.9545,4,2,0,0.913,1.8591,2.8,43.26,12.64,1,0,0.6,1,1.194,0,0,0,0,0,"Do not try to guess EFI partition path by its number

The logic of adding a partition number to the device path does not work
for devicemapper devices (e.g. a multipath storage device).
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/test_efi_utils.py (+51, -24)
ironic_python_agent/efi_utils.py (+56, -19)
ironic_python_agent/tests/unit/extensions/test_image.py (+19, -15)
releasenotes/notes/efi-partuuid-5fe933a462eeede1.yaml (+5, -0)
ironic_python_agent/tests/unit/samples/hardware_samples.py (+11, -0)
",0.962976,-0.746917,-0.071558,1.044124,0.265958,0.036555,0.870756,-0.228264,0.205005,0.007294,-0.097005,0.279884,0.086224,-0.320386,-0.523733
openstack/kolla,Iaf5ce2b7276b275b21d892d0044a126ab901507f,1,0,0.6538,0.6931,0.0,1,2.8,209,0,Feature,0,0,0,52,0.026196,0.625,0,0.4087,2,1,0,0.8071,0.0,2.0,-61.89,18.26,0,0,0.0,0,104.5,0,0,0,0,0,"cloudkitty: disable building for ubuntu/binary

There are no packages in UCA.

http://lists.openstack.org/pipermail/openstack-discuss/2022-May/028419.html
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -0)
",0.056506,2.893447,-1.634739,-0.063871,-1.134946,-0.042661,0.323556,-0.333409,-0.202859,-0.220745,-0.491178,-0.131577,0.111597,0.085189,0.19765
openstack/kolla,I09ea136c7354143f45f856d5e8d8ed1192879622,1,0,0.6604,1.6094,0.25,1,6.67,168,0,Bug Fix,0,0,0,53,0.026687,0.0,0,0.0,3,1,0,0.8085,0.0,3.0,52.02,8.67,0,0,0.0,0,33.6,0,0,0,0,0,"prometheus-libvirt-exporter: fix build with newer Go

I have no idea how Go works. This change make build happen.
[SEP]
FILES CHANGED:
docker/prometheus/prometheus-libvirt-exporter/Dockerfile.j2 (+3, -1)
",2.31407,-0.54837,0.332445,-0.495268,-1.136676,-0.235628,0.106809,-0.334229,-0.782124,0.216302,-0.165759,-0.041582,0.015977,-0.142283,0.14928
openstack/kolla-ansible,Ie92b6a27a656491601606b76e410e247f82b46b1,0,1,0.8372,4.7095,0.5909,13,9.8,337,0,Bug Fix,0,0,0,86,0.019426,1.0,0,0.8372,4,4,0,0.8423,3.1133,3.0,55.31,11.27,1,0,0.0182,1,3.036,0,18,0,5,0,"Get OVS assignment right

As reported in the linked bug, the OVS role has issues with actual
placement. This patch gets it right. It avoids the use of static
inventory entirely and is backwards compatible. Only correct hosts
will now have the OVS logic applied.

Closes-Bug: #1971488
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -5)
ansible/roles/neutron/defaults/main.yml (+2, -22)
ansible/roles/neutron/templates/linuxbridge_agent.ini.j2 (+1, -1)
ansible/roles/neutron/templates/openvswitch_agent.ini.j2 (+1, -1)
ansible/site.yml (+3, -7)
ansible/roles/openvswitch/tasks/precheck.yml (+0, -2)
ansible/inventory/all-in-one (+0, -5)
ansible/roles/openvswitch/tasks/post-config.yml (+1, -3)
releasenotes/notes/openvswitch-group-is-gone-05773dc7fe3fe618.yaml (+9, -0)
ansible/group_vars/all.yml (+23, -0)
ansible/roles/openvswitch/defaults/main.yml (+2, -18)
tests/templates/inventory.j2 (+2, -0)
ansible/roles/ovn/tasks/bootstrap.yml (+1, -1)
",-0.20349,-1.73551,-0.479336,0.217077,-0.663922,0.317831,-0.413916,0.05739,0.125248,0.234798,0.154712,0.110547,0.224586,-0.330461,0.218936
openstack/kolla-ansible,Ibaef3672c656213dd5ba1488379d686130e041c5,1,1,1.0,1.0986,0.5,1,8.4,402,0,Bug Fix,0,0,0,1,0.1,0.6667,0,0.6667,4,1,0,0.8386,0.0,4.0,4.94,13.84,1,0,0.0,0,134.0,0,6,0,9,0,"Fix malformed OIDCMemCacheServers

Change from comma separated list of memcache servers to space separated list.
Comma seperated list results in a 500 error response.
Upstream docs state this should be space separated and can be found here:
https://github.com/zmartzone/mod_auth_openidc/blob/master/auth_openidc.conf#L629-L631

Closes-Bug: #1972033
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -1)
",-1.861598,1.341772,-1.077604,0.48049,-0.125812,0.093778,-0.004732,0.137608,0.166488,0.299521,0.053484,-0.669923,0.332296,0.036626,-0.090189
openstack/kolla-ansible,I9e36b9169b6725bf6db953e464fc099087747778,1,1,1.0,3.2189,0.125,3,17.0,147,0,Bug Fix,0,0,0,1,0.047619,1.0,0,1.0,4,3,0,0.8393,1.3844,3.33,30.33,20.92,0,0,0.0,1,5.88,0,6,0,19,0,"Put openstack exporter behind HAproxy so only one is queried at a time

Closes-Bug: #1972818
[SEP]
FILES CHANGED:
releasenotes/notes/openstack-exporter-hammering-os-apis.yaml (+14, -0)
ansible/roles/prometheus/defaults/main.yml (+6, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+1, -3)
",1.404418,-0.135524,-0.236362,-0.224054,-0.507098,0.944245,0.088597,0.026181,-0.015086,-0.421277,0.56816,0.263769,-0.017205,-0.339712,0.305707
openstack/openstack-ansible-os_nova,Ib1c8f820ccfe00923fcbc7aec2457a94629673fe,1,0,0.875,1.6094,0.5,1,10.0,239,0,Bug Fix,0,0,0,16,0.024353,1.0,0,0.875,1,1,0,1.0,0.0,1.0,35.95,13.33,0,0,0.0,0,47.8,0,0,0,0,0,"Pass valid cert regen variable to pki role

Currently we're passing non-existant variable into PKI role
when defining whether to regen certificates or not.
This change fixes behaviour.
[SEP]
FILES CHANGED:
tasks/main.yml (+2, -2)
",1.072019,-1.242087,-0.11618,1.005025,0.30142,0.249892,0.247856,-0.591408,0.051585,-0.199937,-0.123261,-0.018209,-0.117148,-0.049799,-0.167323
openstack/kolla-ansible,Ib834a9f8b4a0238960dca65b2ebc1da840cec626,1,1,1.0,2.3979,0.1,3,10.0,196,0,Bug Fix,0,0,0,10,0.081967,1.0,0,1.0,4,3,0,0.84,1.371,3.33,-6.35,22.0,1,0,0.0,1,17.8182,0,6,0,15,0,"Fix AlertManager's external web url

Remove hard-coded internal address; introduce variable to control
external web url.

Closes-bug: #1972817
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus-alertmanager.json.j2 (+1, -1)
ansible/roles/prometheus/defaults/main.yml (+2, -0)
releasenotes/notes/fix-hardcoded-alertmanager-weburl-9413b9e82a8610ea.yaml (+6, -0)
",1.474778,-1.524241,-0.175392,-0.594465,-0.277298,-0.076588,-0.64853,0.461923,0.378168,-0.341393,-0.346958,-0.073446,0.219071,0.000271,-0.009159
openstack/openstack-ansible,I17d3f079ddbd4f0150c4b01f822818db52083d21,1,1,1.0,2.0794,0.1429,2,13.0,292,1,Bug Fix,0,0,0,7,0.107692,0.0,0,0.0,3,2,0,0.9167,0.8631,2.5,41.79,16.48,1,0,0.0,1,36.5,0,6,0,7,0,"haproxy: fix csp for glance image uploads via horizon

Connections to port 9292 by Horizon were blocked by content
security policy. This patch permits connections to API services
running on the same host as Horizon.

Related-Bug: #1971179
[SEP]
FILES CHANGED:
inventory/group_vars/haproxy/haproxy.yml (+1, -1)
releasenotes/notes/csp-image-uploads-0165e6fe76287a0c.yaml (+5, -0)
",0.413187,-1.674418,-0.591814,-0.093533,-0.483941,0.121121,-0.300565,0.448904,0.401041,-0.166101,-0.096352,-0.041921,0.385112,-0.219722,0.059539
openstack/openstack-ansible-os_octavia,Ic5c9b809f90dae415ccc72233342ea3242c0b78f,1,1,0.8182,1.0986,0.5,1,11.0,116,0,Bug Fix,0,0,0,11,0.164179,0.0,0,0.0,1,1,0,0,0.0,1.0,18.78,26.22,0,0,0.0,0,38.6667,0,6,0,14,0,"Fix condition for deleting old amp images

Closes-Bug: 1967270
[SEP]
FILES CHANGED:
tasks/octavia_amp_image.yml (+1, -1)
",1.676683,-0.72921,-0.336096,-1.123842,-0.449524,0.778456,-0.956093,0.140127,0.09657,-0.301978,0.564162,-0.091042,0.600408,0.117203,0.002811
openstack/kolla,I33dbca927062284fd7a06ab6db732dd5e2219c40,1,0,0.8276,2.0794,0.0,2,13.25,348,0,Bug Fix,0,0,0,87,0.019176,0.6471,0,0.5355,3,2,0,0.8099,0.8631,2.5,57.71,10.58,1,1,0.0,0,43.5,0,0,0,0,0,"[bifrost] Force Bifrost to use the correct git branch

Bifrost decides on the branches to use by itself.
Early in the cycle, they are often not set correctly and may
break our CI.
This patch ensures we force Bifrost to use the expected branches,
making us independent of Bifrost getting fixed.
[SEP]
FILES CHANGED:
kolla/image/build.py (+5, -0)
docker/bifrost/bifrost-base/Dockerfile.j2 (+2, -0)
",-0.566186,-0.84544,-0.347273,1.087548,0.082712,0.288719,0.248762,-0.722575,-0.471403,0.256033,0.265783,0.009121,0.052404,-0.386628,-0.228675
openstack/kolla,I46f03329853a2025bff20b7b60e35c06aba619eb,1,0,0.8295,1.9459,0.5,4,2.6,179,0,CI,1,0,0,88,0.019366,1.0,0,0.8295,1,1,0,0.8112,1.7925,1.0,-10.56,10.27,1,1,1.0,0,25.5714,0,0,0,0,0,"[CI] Move queue setting to project level

Per [1].

[1] http://lists.zuul-ci.org/pipermail/zuul-discuss/2022-May/001801.html
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+0, -1)
.zuul.d/centos.yaml (+0, -1)
.zuul.d/base.yaml (+3, -0)
.zuul.d/ubuntu.yaml (+0, -1)
",-0.225649,3.490482,-1.451339,0.363966,-1.133794,0.189012,-0.112288,-0.152464,0.21718,0.297513,-0.580716,-0.133977,0.010191,0.42119,-0.6713
openstack/kolla-ansible,I2197b5436a4b4d4220c916d2f3129f49f13b70ec,1,0,0.8315,1.0986,0.5,1,2.6,179,0,CI,1,0,0,89,0.01956,0.8,0,0.6652,1,1,0,0.8407,0.0,1.0,8.97,10.27,1,1,1.0,1,59.6667,0,0,0,0,0,"[CI] Move queue setting to project level

Per [1].

[1] http://lists.zuul-ci.org/pipermail/zuul-discuss/2022-May/001801.html
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+1, -1)
",-0.225649,3.490482,-1.451339,0.363966,-1.133794,0.189012,-0.112288,-0.152464,0.21718,0.297513,-0.580716,-0.133977,0.010191,0.42119,-0.6713
openstack/ansible-collection-kolla,I46f03329853a2025bff20b7b60e35c06aba619eb,1,0,0.8333,1.0986,0.5,1,2.6,179,0,CI,1,0,0,90,0.019772,0.8182,0,0.6818,1,1,0,1.0,0.0,1.0,-10.56,10.27,1,1,1.0,1,59.6667,0,0,0,0,0,"[CI] Move queue setting to project level

Per [1].

[1] http://lists.zuul-ci.org/pipermail/zuul-discuss/2022-May/001801.html
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+1, -1)
",-0.225649,3.490482,-1.451339,0.363966,-1.133794,0.189012,-0.112288,-0.152464,0.21718,0.297513,-0.580716,-0.133977,0.010191,0.42119,-0.6713
openstack/kolla,I77b0dcd2e9dfd8ea8390a471b80c8954b67ef91b,1,0,0.8352,3.091,0.4762,1,14.67,308,0,Bug Fix,0,0,0,91,0.019982,0.6667,0,0.5568,2,1,0,0.8125,0.0,2.0,45.82,13.14,1,0,0.0,0,14.0,0,0,0,0,0,"Fix local sources of git repositories

This is I2cbf1f539880d512aa223c3ef3a4b19ee18854ac extended to fix
the case when a git repository is used with a git repo.
This is probably a rarer use case but, still, we use it in CI
for in-review changes testing.
[SEP]
FILES CHANGED:
kolla/image/build.py (+11, -10)
",-0.073013,-1.648012,-1.043907,-1.008434,0.375935,-0.014528,0.682582,-0.37897,-0.02956,0.376625,-0.623697,0.239303,0.116311,0.015176,0.210642
openstack/openstack-ansible-ceph_client,I0d6014649307bb6556cdc189cf8d749e1ec9b20a,1,0,0.8824,1.0986,0.5,1,13.67,322,0,Bug Fix,0,0,0,17,0.025719,1.0,0,0.8824,1,1,0,0,0.0,1.0,21.7,17.17,0,0,0.0,0,107.3333,0,0,0,0,0,"Use global package_state

We missed upating ceph_client_package_state to use package_state
for default value, as other roles do.
So we're fixing it not to update ceph client packages every time, which
can lead to interesting consequences depending on the destination.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",0.046168,-1.296488,0.041054,0.873644,0.130282,-0.096333,-0.078278,-0.875705,-0.367457,0.097352,-0.148725,-0.515048,-0.209075,-0.171223,0.283353
openstack/octavia,Ie02b5164f3c1089f0d48101aab9e007bb4d132ea,1,0,0.4757,1.0986,0.5,1,4.5,271,0,CI,1,0,0,103,0.004107,0.0833,0,0.0396,1,1,0,0.5688,0.0,1.0,29.93,12.17,0,0,1.0,1,90.3333,0,0,0,0,0,"Update zuul queue configuration

Zuul is changing how queues are declared[1]. This patch updates Octavia for the new way to define the queue.

[1] https://lists.zuul-ci.org/pipermail/zuul-discuss/2022-May/001801.html
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+1, -1)
",-0.971875,2.306093,-1.436947,0.819671,-0.974459,0.02358,0.305059,-0.086683,0.102708,0.378887,-0.173475,-0.170445,0.035648,0.086998,-0.181753
openstack/ironic,Idf7991d8f8a8cebcdc0413f26ad31542f8ffa8a8,1,0,1.0,0.6931,1.0,1,3.0,177,0,Doc,1,0,0,16,0.008625,0.8333,0,0.8333,1,1,0,0.9792,0.0,1.0,-172.21,23.42,1,0,1.0,1,88.5,0,0,0,0,0,"CI: Removing ironic job queue

See: https://zuul-ci.org/docs/zuul/latest/releasenotes.html#relnotes-4-1-0-deprecation-notes
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -1)
",-0.111169,4.293576,-1.872014,0.581414,-0.90119,0.004783,0.137557,-0.583168,0.253059,-0.245591,-0.967407,0.231302,-0.114775,0.267849,-0.024512
openstack/ironic-python-agent,I341b8a2220a49c5a7c3f78fed3a1baa0f0638cde,1,0,1.0,0.6931,1.0,1,3.33,185,0,Doc,1,0,0,17,0.009159,0.8462,0,0.8462,1,1,0,0.9167,0.0,1.0,-151.87,21.33,1,0,1.0,1,92.5,0,0,0,0,0,"CI: Removing ironic job queue

Please see:
https://zuul-ci.org/docs/zuul/latest/releasenotes.html#relnotes-4-1-0-deprecation-notes
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -1)
",-0.823633,3.599933,-1.925508,0.460078,-0.909628,-0.108268,-0.363404,-0.539439,0.102162,-0.013551,-1.208803,0.060988,-0.135382,0.336376,-0.132247
openstack/kolla,I2cc79c476d089977b57006dd4ce2e9a8c6206aa1,1,0,0.837,1.0986,0.5,1,9.14,457,0,Feature,0,0,0,92,0.020109,0.3333,0,0.279,3,1,0,0.8138,0.0,3.0,48.18,11.16,1,1,0.0,0,152.3333,1,0,0,0,0,"[bifrost] Force Bifrost to use the correct u-c

Following up on [1], Bifrost also needs to use correct u-c and,
surprise-surprise, this is set via a third variable, this time
environment one for the bash script. Oh well. Let's do it.
This has the added benefit of not requiring additional
download of u-c as it reuses the already existing one.

[1] https://review.opendev.org/c/openstack/kolla/+/842276
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+1, -1)
",-0.935661,0.400719,0.210562,0.283392,-0.712006,0.299709,0.764727,-0.378061,-0.282432,0.197609,0.459828,-0.006398,-0.10469,-0.08127,-0.218204
openstack/ironic,I753c4b00c0a64bcdc89c9bc0afd46f1211f7847b,1,0,1.0,5.1059,0.0305,3,12.0,120,0,Bug Fix,0,0,0,7,0.0056,1.0,0,1.0,6,2,0,0.9796,0.9145,4.0,46.61,14.8,1,0,0.7744,1,0.7273,0,0,0,0,0,"Fix Redfish RAID to update raid_config

Story: 2003514
Task: 41940
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+31, -0)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+122, -5)
releasenotes/notes/fix-redfish-raid-config-9e868c3e069475a1.yaml (+6, -0)
",2.567854,0.272475,-0.545625,-0.874835,-0.149795,1.154063,-0.283318,0.26191,0.486719,-0.566785,0.542922,0.031389,-0.032967,0.554832,0.005284
openstack/python-ironicclient,Ia191ab32f0d4f8f50cb266332d4f4bc96619cb58,1,0,0.9565,3.7377,0.2195,2,13.0,362,0,Bug Fix,0,0,0,23,0.012366,1.0,0,0.9565,2,2,0,1.0,0.7593,1.5,60.23,10.58,1,0,0.0,1,8.619,0,0,0,0,0,"Fix logging in the baremetal CLI

* Ask openstacksdk to log to stderr instead of stdout, otherwise its
  warnings break parsing the output.
* Respect the --verbose flag (same as --debug but without tracebacks).
* Do not propagate log records that are handled by either openstacksdk's
  or ours logging code.
[SEP]
FILES CHANGED:
ironicclient/shell.py (+23, -9)
releasenotes/notes/logging-9c452e4869d80de9.yaml (+9, -0)
",-0.158128,-0.498836,-0.331889,0.877709,0.01661,-0.241851,0.432483,-0.4505,-0.497273,0.008371,0.243555,-0.323481,0.62213,-0.27403,-0.14236
openstack/kolla-ansible,I18a9559daeb3d124a03dcb735ebb01a2cf24f617,1,0,0.6667,2.1972,0.25,1,6.36,857,0,CI,0,0,0,54,0.027136,1.0,0,0.6667,2,1,0,0.8414,0.0,2.0,-43.76,12.83,0,0,0.0,0,95.2222,0,0,0,0,0,"genpwd: handle lack of password file nicer

From:

(kolla) 13:11 (s) marcin@puchatek:kolla-ansible$ kolla-genpwd
Traceback (most recent call last):
  File ""/home/marcin/.virtualenvs/kolla/bin/kolla-genpwd"", line 8, in <module>
    sys.exit(main())
  File ""/home/marcin/.virtualenvs/kolla/lib/python3.10/site-packages/kolla_ansible/cmd/genpwd.py"", line 135, in main
    genpwd(passwords_file, length, uuid_keys, ssh_keys, blank_keys,
  File ""/home/marcin/.virtualenvs/kolla/lib/python3.10/site-packages/kolla_ansible/cmd/genpwd.py"", line 59, in genpwd
    with open(passwords_file, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/etc/kolla/passwords.yml'

To:

(kolla) 13:17 (s) marcin@puchatek:kolla-ansible$ kolla-genpwd
ERROR: Passwords file ""/etc/kolla/passwords.yml"" is missing
[SEP]
FILES CHANGED:
kolla_ansible/cmd/genpwd.py (+6, -2)
",-3.820246,3.5347,2.704454,-0.717006,0.342798,0.206133,-0.404903,-0.19138,-0.310983,-0.694966,0.03574,-0.309282,-0.103669,0.397769,-0.138906
openstack/octavia,Id1dd029995d41e6913a07eeb120c889d71d583eb,1,0,0.7,2.9444,0.0,2,8.5,731,0,Doc,0,0,0,10,0.033333,1.0,0,0.7,6,2,0,0.5704,0.65,4.0,32.99,12.34,1,0,0.0,1,38.4737,0,0,0,0,0,"Set sensible nf_conntrack_max value in amphora

This sets the values of nf_conntrack_max and nf_conntrack_expect_max to
sensible values. Previously, the default values set by the kernel were
used, which limited net.netfilter.nf_conntrack_max to 32768. On the
other hand, Octavia sets nf_conntrack_buckets to 125000. A value of
nf_conntrack_max lower than half of that makes no sense.

The new values are calculated using the formula for the default value
in the kernel [1]:

nf_conntrack_max = nf_conntrack_buckets
nf_conntrack_expect_max = nf_conntrack_buckets / 256

[1]: https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.rst

Story: 2010050
Task: 45460
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/amphora-netns.systemd.j2 (+3, -0)
releasenotes/notes/fix-nf-conntrack-max-value-in-amp-0e16eb50b42e7b58.yaml (+15, -0)
",-4.345378,2.000725,1.749477,0.29463,1.227718,0.51578,-0.531599,-0.264121,0.493149,-0.409389,0.451473,-0.296396,-0.762953,-0.174714,0.233033
openstack/openstack-ansible-os_swift,If0e686352e08379027508c2939fae00db6ae6cb8,1,1,0.8889,1.7918,0.2,1,9.29,536,0,Bug Fix,0,0,0,18,0.027149,0.0,0,0.0,1,1,0,0,0.0,1.0,28.21,12.95,1,0,0.0,0,89.3333,0,6,0,19,0,"Sync rings to all swift hosts to build_files

In previous patch [1] I wrongly assumed that there's no reason to have
/etc/swift/ring_build_files/
on all hosts. However, there's another logic in the role, that assumes
having these files and verifying md5sum of them.

As an easy bugfix, we're returning sync to ring_build_files until we
change logic. It's also easily backportable.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_swift/+/765354

Closes-Bug: #1973045
[SEP]
FILES CHANGED:
tasks/swift_rings_distribute.yml (+4, -1)
",-1.016736,0.16202,0.62526,-0.387589,-0.898214,-0.148886,0.631164,-0.080439,-0.12708,-0.014134,0.202584,-0.385818,-0.283222,-0.217617,-0.002325
openstack/openstack-ansible,I2e7123881d7ff322f15f185a4df1f2923c44eae0,1,1,0.8947,1.0986,0.5,1,14.67,296,0,Bug Fix,0,0,0,19,0.028443,0.0,0,0.0,0,1,0,0.9231,0.0,0.0,57.36,12.23,1,0,0.0,0,98.6667,0,6,0,5,0,"Change unbound role source

Unbound role was unmaintained for a while, and missing features, like
Debain installation or CentOS 8/9

Role has been forked and CI was fixed on it. It can be moved to opendev
as a next step.

Closes-Bug: #1975719
[SEP]
FILES CHANGED:
ansible-role-requirements.yml (+1, -1)
",-0.061264,-2.194496,-0.512312,-0.348863,-0.729938,0.199592,-0.14915,0.252877,-0.268259,0.047113,0.293642,0.164717,-0.08784,0.355991,0.025568
openstack/openstack-ansible,Ia2814d6dc6faa509e98f7486fed12600e192ec8b,1,1,0.9,1.7918,0.4,2,9.33,262,0,Bug Fix,0,0,0,20,0.029851,0.0,0,0.0,1,2,0,0.9286,0.7219,1.0,13.05,15.16,1,0,0.0,0,43.6667,0,6,0,8,0,"Align collection_file naming

At the moment we're inconsistent in collection_file variable naming.
While we're passing `collection_file` to the play, inside it we use
`collections_file`.

Closes-Bug: #1975723
[SEP]
FILES CHANGED:
scripts/get-ansible-collection-requirements.yml (+2, -2)
scripts/bootstrap-ansible.sh (+1, -0)
",-0.192474,-0.514247,-0.55725,0.362971,0.107505,0.463781,-0.95545,-0.494565,0.086003,-0.200422,0.028342,-0.263908,-0.306128,-0.024924,0.102761
openstack/kolla-ansible,Ie468f5170c9df8a235953337753043f5b9f74578,1,0,0,1.7918,0.4,2,15.36,1002,0,Bug Fix,1,0,0,0,0.0,0.8571,0,0.0,1,1,0,0.8421,0.7219,1.0,59.59,10.64,1,0,1.0,1,167.0,0,0,0,0,0,"Cleanup zuul jobs a bit

These sorts of changes should likely be made across all of kolla. I'm
pushing the update to victoria because 843400 is a victoria change that
caused me to look into this.

First up kolla-ansible-centos8s-source-upgrade-ceph-ansible is a
multinode job that retries many times, is non voting, and a check only
job. The value of a job like this on a stable branch is likely minimal.

First we remove the non default attempts value on the base job. You
should set this per job instead only when necessary and after debugging
why jobs retry excessively. Please avoid overriding defaults like this
for all the jobs as it is easy for peopel to forget the setting is in
place.

Next move the job to the experimental queue. If it is non voting and
rarely passes it can be manually triggered by individuals that are
working to correct the job that rarely succeeds. Then once reliable the
job can be added back to the check pipeline.
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+0, -1)
zuul.d/project.yaml (+3, -1)
",-2.147888,-1.470152,2.871354,-0.848323,-0.626661,-0.101998,0.62754,-0.481813,-0.401653,-0.16666,0.159632,0.12153,-0.173836,-0.048173,0.141005
openstack/kolla-ansible,I32fc296083b4881e8f457f4235a32f94ed819d9f,1,0,0.8387,0.6931,1.0,1,11.89,744,0,CI,1,0,0,93,0.020319,0.6,0,0.5032,1,1,0,0.8428,0.0,1.0,46.92,10.36,1,1,1.0,1,372.0,0,0,0,0,0,"[CI] Nullify attempts

Per Clark Boylan's feedback [1], retries cause a retry not only
for pre playbook failures but also for cases where Ansible detects
network connectivity issues and they are caused by disks getting
filled to their fullest. This is an issue we experience that
sometimes results in a POST_FAILURE but certain FAILUREs are
retried which wastes CI resources.
The problematic jobs are ceph jobs. They are to be looked into.
Backport to all branches.
We can adjust retries for the core jobs that do not exhibit the
nasty behaviour but first we can try running without retries
to measure the troublesomeness.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/843536
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+0, -1)
",-1.780412,-0.681105,1.411504,-0.29752,-0.798516,0.167592,0.416731,-0.250644,0.012167,0.029742,0.074096,-0.063827,0.153113,-0.513542,-0.097936
openstack/kolla,I6bc8b489a810849744c8bead6b9e350c5d3e36b7,1,0,0.8404,3.6109,0.3889,3,5.0,110,0,Bug Fix,0,0,0,94,0.020533,0.6,0,0.5043,2,2,0,0.8151,1.2997,2.0,7.18,18.0,1,0,0.0,1,2.973,1,0,0,0,0,"Fix Ubuntu image builds

Regarding rabbitmq and erlang.
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+2, -2)
releasenotes/notes/rabbitmq-erlang-cloudsmith-c837bf4a450dd802.yaml (+10, -0)
kolla/template/repos.yaml (+10, -12)
",2.204144,-0.829969,0.095587,-0.875903,-0.110359,-0.406594,-0.434349,0.564868,-0.82548,-0.277699,-0.135739,-0.123322,-0.265595,0.204504,-0.280799
openstack/kolla-ansible,Id8573ad6727c62e355923b787c51766bc27ed848,1,0,0.8421,1.0986,0.5,1,7.0,91,0,Bug Fix,0,0,0,95,0.02059,0.7037,0,0.5926,2,1,0,0.8435,0.0,2.0,-17.81,19.94,1,0,0.0,0,30.3333,1,0,0,0,0,"Fix a comment on openstack_interface
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",2.81147,1.265202,1.443084,-0.101991,0.323615,0.171721,0.375171,-0.293879,0.755382,-0.135499,0.339207,-0.722399,-0.465026,0.057512,0.727049
openstack/openstack-ansible-os_neutron,I54dbd5c9690281af475312a277eab534403edf92,1,0,0,4.4998,0.0225,4,14.75,454,0,Feature,0,0,0,0,0.0,1.0,0,0.0,2,3,0,1.0,1.778,1.5,21.23,15.39,1,0,0.0,1,5.0444,0,0,0,0,0,"Allow to provide custom configuration for VPNaaS

As we need to monitor vpn connection detailes, the only way to config vpnaas to log states and connections of vpn
is to provide own templates for VPNaaS configuration. With that we enable deployers to provide custom configuration
files for using with any vpn drivers (stronswan/openswan).

Co-Authored-By: Dmitriy Rabotyagov <noonedeadpunk@gmail.com>
[SEP]
FILES CHANGED:
tasks/neutron_post_install.yml (+13, -0)
doc/source/configure-network-services.rst (+33, -2)
releasenotes/notes/neutron-vpnaas-custom-config-ad991bb02b9ed655.yaml (+33, -0)
defaults/main.yml (+8, -0)
",-0.925943,-0.479045,-0.470997,0.742635,-0.128968,-0.466017,0.561037,0.515364,-0.030714,-0.24051,0.280882,0.261114,0.266887,-0.276562,-0.51356
openstack/kayobe,I0658c0059867468d6032cb1bfa3d05ae0d01c422,1,0,0,1.7918,0.0,2,11.0,131,0,Feature,0,0,0,0,0.0,1.0,0,0.0,3,2,0,0.9342,0.7219,2.5,-11.98,18.95,0,0,0.0,1,21.8333,0,0,0,0,0,"Add missing declaration of kolla_enable_hacluster

Story: 2010069
Task: 45540
[SEP]
FILES CHANGED:
ansible/group_vars/all/kolla (+1, -0)
releasenotes/notes/fix-hacluster-variable-48d1370651a11cda.yaml (+4, -0)
",1.820052,0.516243,-0.98066,-0.909515,0.123855,0.912042,-0.933022,0.073119,0.647749,-0.735804,0.525837,0.111124,-0.405024,0.338145,0.086505
openstack/oslo.policy,If11fe2da1163d6d3f16d133aeb207a055cf30de4,1,1,0.0,0.6931,0.0,1,21.33,408,0,Bug Fix,0,0,0,1,0.00625,1.0,0,0.0,1,1,0,0.8333,0.0,1.0,38.45,16.66,1,0,0.0,0,204.0,0,6,0,4,0,"Fix deprecated rule logic if the rule was deleted in policy directory.

The bug scenario:
- define deprecated rule in policy folder
- start a service
- enforce policies
- remove the rule in policy folder
- enforce policies

New default is applied to the rule,
but new and old defaults should be applied
(OR logic)
The patch fixes it.

Closes-Bug: 1977549
[SEP]
FILES CHANGED:
oslo_policy/policy.py (+1, -0)
",-0.822862,-2.021214,0.216678,0.17488,-0.169625,-0.254605,-0.413183,0.105475,0.230462,-0.03708,-0.144284,-0.039789,0.599233,1.062617,-0.186877
openstack/openstack-ansible-os_horizon,Ia9fa3341dfa1386501bf74a558e418414a58fd1f,1,0,1.0,1.0986,0.5,1,2.0,165,0,Bug Fix,0,0,0,1,0.333333,0.0,0,0.0,1,1,0,1.0,0.0,1.0,-316.9,34.13,1,0,0.0,0,55.0,0,0,0,0,0,"Fix ALLOWED_HOSTS

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-haproxy_server/+/846473
[SEP]
FILES CHANGED:
templates/horizon_local_settings.py.j2 (+1, -1)
",-0.332576,4.362438,-1.8462,0.2032,-0.641791,0.31207,-0.369067,-0.400351,0.165872,-0.97848,-0.585606,-0.017284,-0.093366,-0.670218,0.175274
openstack/kolla-ansible,I89dd99b5f25502f5ebe15a9e90ccecc4bd6feafa,0,0,0.9143,3.4012,0.6207,5,9.0,225,0,CI,0,0,0,35,0.044814,0.8667,0,0.7924,2,3,0,0.8442,2.1172,1.4,22.23,13.97,0,0,0.931,1,7.5,0,0,0,0,0,"CI: Switch upgrades xena->yoga to yoga->master

R-17: Switch source images to current release

Disable rocky8 and openeuler jobs as master no longer works with
python3.6.
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
tests/run.yml (+3, -7)
tests/templates/globals-default.j2 (+1, -2)
zuul.d/base.yaml (+3, -5)
zuul.d/project.yaml (+3, -3)
",1.314552,-1.086118,-0.216164,-0.485478,-0.075129,-0.134699,-0.219189,0.609542,-0.631124,0.207685,-0.187802,0.013466,0.092344,0.217054,0.023813
openstack/kolla-ansible,I1b1068e84be7f7eaff1a4eab1ba9ddcd6f4241c7,0,0,0,2.3979,0.2,3,8.5,183,0,Bug Fix,0,0,0,0,0.0,0.6897,0,0.0,4,2,0,0.8405,1.371,2.67,-20.76,15.16,1,0,0.0,1,16.6364,0,0,0,0,0,"Fix typo in endpoint influxdb_internal_endpoint variable

This patch simply fix a typo in 'influxdb_internal_endpoint' variable.
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
ansible/roles/grafana/defaults/main.yml (+1, -1)
releasenotes/notes/rename-wrong-influxdb-variable-8a93d8fda8dce926.yaml (+6, -0)
",0.325508,2.033892,-0.387101,1.290434,1.518198,0.444281,0.494892,-0.4499,0.792621,-0.391327,0.535076,-0.327442,-0.870558,-0.299599,0.567847
openstack/kolla,I32bef531896777bfb463bb401ebba1d488a16bf9,0,0,0.6727,3.6636,0.5,1,9.0,283,0,CI,1,0,0,55,0.027528,0.8333,0,0.5606,1,1,0,0.8163,0.0,1.0,77.38,7.16,0,0,1.0,0,7.2564,0,0,0,0,0,"CI: drop CentOS Stream 8 jobs

We kept CS8 jobs while waiting to get CentOS Stream 9 support ready.

But we have situations where OpenStack projects fail due to lack of new
enough (3.8+) Python in CS8.

Time to make CS8 go away.
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+19, -19)
",0.234857,-1.393076,-0.344941,-0.009387,-0.290843,0.342141,-0.287685,0.264595,-1.132359,0.549755,-0.299665,-0.089321,0.416044,-0.247898,0.228629
openstack/octavia,I1633c2cacf1c4dc5c0aa605635545fae8085e296,1,0,0,3.091,0.1905,3,15.0,269,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,5,2,0,0.5719,1.41,3.33,5.49,18.0,0,0,0.1905,1,12.2273,0,0,0,0,0,"Fix update/delete listener CA/CRL error

Fixed ""Could not retrieve certificate"" error when updating/deleting the client_ca_tls_container_ref field of a listener after a CA/CRL was deleted.

Story 2010081
Task 45577
[SEP]
FILES CHANGED:
releasenotes/notes/fix-update-listener-ca-error-167464debc06cba2.yaml (+5, -0)
octavia/tests/unit/api/drivers/test_utils.py (+4, -0)
octavia/api/drivers/utils.py (+8, -4)
",0.175036,0.00995,-0.863453,0.445875,0.66447,0.763796,-0.31618,0.032382,0.794035,-0.389664,0.20342,-0.408409,-0.158605,-0.053845,0.021659
openstack/kolla,I9f9e381716611b71584ecf8b371f8b7f45c694ee,1,0,0.8,1.7918,0.0,1,6.17,339,0,CI,0,0,0,15,0.028409,0.5,0,0.4,3,1,0,0.8108,0.0,3.0,31.38,10.03,1,0,0.0,0,56.5,0,0,0,0,0,"Pin diskimage-builder version due to drop Python3.6

Since Ibdbcf459608711ac64e7fefb1707f6708d68e750 merged to master we
need to pin diskimage-builder to latest stable tag with support of
the Python3.6 until we move to CentOS9.
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+5, -0)
",-0.249186,-0.751567,-0.84333,-0.944527,0.892947,-0.174615,0.142924,0.415117,-0.239846,0.462629,-0.713483,0.378061,-0.224099,-0.154946,0.232864
openstack/kolla-ansible,Id5567fdedf52e8808400c181e90243fee7f3e136,0,0,0.6607,3.9318,0.5,1,8.0,166,0,CI,1,0,0,56,0.027505,0.8125,0,0.5368,1,1,0,0.8369,0.0,1.0,57.72,9.87,0,0,1.0,1,3.2549,0,0,0,0,0,"CI: drop all CentOS Stream 8 jobs

As in Kolla - we can not support CS8 anymore due to Python 3.8+
requirement.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+25, -25)
",1.8594,-0.956425,-0.175018,-0.608745,-0.71029,0.118618,-0.444832,0.479033,-0.958003,0.441898,-0.08455,0.258783,-0.253022,-0.133907,0.037224
openstack/ironic-python-agent,Ida4ed4646659b2ee3f8f92b0a4d73c0266dd5a99,1,0,0.0,4.3175,0.0135,4,19.0,181,0,Bug Fix,0,0,0,1,0.000463,0.0,0,0.0,4,3,0,0.92,1.5577,2.75,13.9,16.02,0,0,0.3784,1,2.4133,0,0,0,0,0,"Fix passing kwargs in clean steps

Pass kwargs to dispatch_to_managers method in execute_clean_step

Story: 2010123
Task: 45705
[SEP]
FILES CHANGED:
doc/source/contributor/hardware_managers.rst (+36, -0)
ironic_python_agent/tests/unit/extensions/test_clean.py (+28, -0)
ironic_python_agent/extensions/clean.py (+3, -1)
releasenotes/notes/bug-2010123-d4c38d8f6606d0e0.yaml (+6, -0)
",0.649889,-0.30681,-1.013069,-0.192076,0.437759,0.342843,-0.794942,-0.675246,0.208147,-0.794469,0.471942,-0.302099,-0.388895,0.368874,-0.019611
openstack/openstack-ansible,I75bdab29353f33fa009bf9a7ff1f565f1660ed59,1,0,0.9048,1.0986,0.0,1,6.2,326,0,Feature,0,0,0,21,0.031111,0.0,0,0.0,1,1,0,0.9333,0.0,1.0,-15.05,15.38,0,0,0.0,0,108.6667,0,0,0,0,0,"Define corosync interface for facts gathering

When moving facts gathering to independent play we forgot to
define variable that's being used for filtering. This makes playbook
fail.

Needed-By: https://review.opendev.org/c/openstack/openstack-ansible-os_masakari/+/845798
[SEP]
FILES CHANGED:
playbooks/os-masakari-install.yml (+2, -0)
",-0.758259,0.396119,-0.939188,-0.043182,-0.967032,-0.383496,0.136067,-0.034603,-0.038842,-0.130246,-0.320994,-0.410691,0.317793,-0.227409,0.121372
openstack/openstack-ansible-os_magnum,I986113491800f9432ebcc8ea82b8f4362671c5d2,1,0,0,1.0986,0.5,1,3.0,167,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,-115.81,23.42,1,0,0.0,0,55.6667,0,0,0,0,0,"Fixed dest typo in config_template

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/846145
[SEP]
FILES CHANGED:
tasks/magnum_post_install.yml (+1, -1)
",-0.103589,4.017524,-1.816494,-0.037909,-1.231073,0.406632,-0.072609,-0.742846,0.062992,-0.748157,-0.60212,0.070185,-0.116393,-0.34327,0.078191
openstack/kolla,If95a8a41d2caf6738d4ccb9ddb651a06018743f4,1,0,0.8873,1.3863,0.3333,1,9.75,248,0,Bug Fix,0,0,0,71,0.02424,0.6842,0,0.6071,2,1,0,0.8121,0.0,2.0,68.95,10.05,0,0,0.0,0,62.0,0,0,0,0,0,"Fix error message when git clone fails

1. There was no %s for the image.name
2. The image name is in the logger, so the source is more useful (which
   may be a plugin or addition)

TrivialFix
[SEP]
FILES CHANGED:
kolla/image/build.py (+2, -1)
",1.412164,-2.026448,-0.09365,-0.207699,-0.837152,0.365395,0.141596,-0.567619,0.083627,0.030119,-0.171191,-0.315301,-0.076004,0.781856,-0.529593
openstack/kolla,I177949b9319a977c9cd9121eb28b710256b72a5a,1,1,0,2.3026,0.1111,2,6.0,377,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,3,2,0,0.8133,0.7642,2.5,45.65,8.23,0,0,0.0,1,37.7,0,6,0,15,0,"Bump skydive version to 0.28

Skydive versions prior to 0.28.0 panic on newer versions of libc.
Fixed upstream in 0.28, see: https://github.com/skydive-project/skydive/issues/2329
This should be backported to at least xena and yoga, as skydive is
currently not working with centos 8 on these releases.

Closes-Bug: #1940862
[SEP]
FILES CHANGED:
docker/skydive/skydive-base/Dockerfile.j2 (+1, -1)
releasenotes/notes/bug-1940862-8fd12d669ab15299.yaml (+7, -0)
",-0.66259,0.808497,-0.658402,0.10173,-0.485994,0.145418,0.274317,0.116796,-0.488608,0.413173,0.215036,-0.174984,0.026494,-0.153525,0.620232
openstack/openstack-ansible,I4099c66fd37813b6a4c6e5b8a312a12647969e71,1,1,0.9091,3.5835,0.4,1,16.5,579,0,Bug Fix,0,0,0,22,0.032496,1.0,0,0.9091,1,1,0,0.9375,0.0,1.0,15.76,16.9,1,0,0.0,0,16.0833,0,6,0,37,0,"Return facts gathering to pre_tasks for masakari

We don't have pacemaker_corosync_ring_interface defined outside of
pacemaker_corosync_group and it won't be consistent across hosts.
As it might include mix of containers/bare metal hosts, so interface
name might be inconsistent.

So let's not bring too much complexity for default option and just
revert to old good working solution.

This partially reverts change Ie996262043edb8fb9c7221a5cd98e98a0111ac28
and I75bdab29353f33fa009bf9a7ff1f565f1660ed59

Closes-Bug: #1979145
[SEP]
FILES CHANGED:
playbooks/os-masakari-install.yml (+21, -14)
",-1.94432,-1.264683,0.565132,-1.751293,0.718844,-0.211411,0.486919,-0.205163,-0.256361,-0.108818,0.132458,-0.129008,-0.225117,-0.256528,-0.141604
openstack/kolla-ansible,I98c6ec5148d2e4051a6aa2f9f91e129a87e14c73,1,0,0.8889,1.0986,0.0,2,7.0,90,0,Bug Fix,0,0,0,36,0.044444,0.75,0,0.6667,2,2,0,0.8333,1.0,2.0,-54.07,19.94,0,0,0.5,0,30.0,0,0,0,0,0,"ovn: Fixup inventories after 842364
[SEP]
FILES CHANGED:
tests/templates/inventory.j2 (+1, -0)
ansible/inventory/all-in-one (+1, -0)
",2.817536,0.219307,0.947938,-1.042792,0.005609,0.698719,-0.343936,-0.238695,-0.250176,0.112705,-0.29376,-0.481034,0.007701,-0.481709,0.172269
openstack/octavia,Ief3d64a3b290676b121a2dcca0760ef2d91ce817,1,0,0.7273,1.6094,0.5,1,7.0,85,0,Feature,0,0,0,11,0.034591,1.0,0,0.7273,2,1,0,0.5735,0.0,2.0,-5.73,14.23,1,0,0.0,1,17.0,0,0,0,0,0,"Correct format of release note
[SEP]
FILES CHANGED:
releasenotes/notes/fixed-API-validation-for-L7-rules-and-session-cookies-cb88f3f1b90171f9.yaml (+2, -2)
",4.228514,1.450245,2.171837,0.793504,0.323472,0.987596,1.641055,-0.119504,1.44038,-0.393119,-0.167825,-0.073055,0.297762,0.602732,-0.135907
openstack/openstack-ansible,Ic7f6f2446ea5f1264c44493ca1b329fe07eb9e30,1,1,0.913,1.0986,0.5,1,10.0,182,0,Bug Fix,0,0,0,23,0.032303,0.0,0,0.0,1,1,0,0.9412,0.0,1.0,27.49,18.0,1,0,0.0,0,60.6667,0,6,0,24,0,"Fix facts gathering for zun

We have wrong/non-existing group defined for facts gathering in zun
playbook.

Closes-Bug: #1979208
[SEP]
FILES CHANGED:
playbooks/os-zun-install.yml (+1, -1)
",0.752931,-1.122828,-0.590572,-0.406893,-0.202029,0.283117,-1.15164,-0.067908,-0.088949,-0.463213,-0.108017,-0.028281,0.168311,0.248394,0.012338
openstack/ironic,Icd8c5378469887962ff32eea2f38697c539f7e95,1,0,1.0,4.9488,0.0571,3,14.4,555,0,Feature,0,0,0,1,0.018868,1.0,0,1.0,6,2,0,0.98,1.1668,4.0,30.07,16.32,1,0,0.6429,1,3.9362,0,0,0,0,0,"Prevent clear_job_queue and reset_idrac failures on older iDRACs

Currently, clear_job_queue and reset_idrac steps are only supported on
idrac-redfish driver on iDRAC9 hardware. However, Ironic still attempts
to run these steps on iDRAC8 BMCs configured with idrac-redfish driver
which results in verification failures. This change attempts to resolve
it by catching the related exception, logging a warning and continuing
verification. In case of cleaning, it still fails.

Story: 2010091
Task: 45630
[SEP]
FILES CHANGED:
ironic/drivers/modules/drac/management.py (+34, -8)
ironic/tests/unit/drivers/modules/drac/test_management.py (+90, -0)
releasenotes/notes/skip-clear-job-queue-idrac-reset-if-attr-missing-b2a2b609c906c6c4.yaml (+8, -0)
",-1.395932,-0.861332,0.326302,0.312573,0.46077,-0.011194,-0.426074,0.14837,0.178415,0.040888,0.279069,0.168364,0.124946,-0.481274,0.265295
openstack/kolla-ansible,I49b3bde8b2bd61b6c931a81542a0d89f8a303ffc,1,1,0.9167,2.1972,0.125,2,12.67,309,0,Bug Fix,0,0,0,12,0.015979,0.75,0,0.6875,4,2,0,0.834,0.5436,3.0,33.68,13.49,1,0,0.0,1,34.3333,0,6,0,13,0,"Fix nested mounts of /run/openvswitch

As kolla-toolbox is mounting /run:/run
there is no need to mount also /run/openvswitch.
This is causing /run/openvswitch is mounted
again and again up to 32767 times after kolla-toolbox
restart.

Closes-Bug: #1979295
[SEP]
FILES CHANGED:
ansible/roles/common/defaults/main.yml (+0, -1)
releasenotes/notes/bug-1979295-3088a4a1c7b391d7.yaml (+7, -0)
",-0.459973,-0.431035,-0.429041,0.172656,0.230876,-0.350254,-0.256707,-0.295257,-0.342448,-0.27733,0.065955,-0.348962,-0.024533,0.254929,0.416827
openstack/octavia,Ie6aae68e8126ad56f771ea0bc00d4005f2d27c4d,1,0,0.7105,4.0073,0.3148,3,17.0,276,0,Bug Fix,0,0,0,76,0.006958,0.3333,0,0.2368,7,2,0,0.575,1.036,4.67,42.77,16.21,0,0,0.7593,1,5.0182,0,0,0,0,0,"Restart rsyslog from cloud-init in amphorav1

This is a follow-up patch for commit [0], it fixes the same issue but in
amphorav1 (this part was missing in the initial patch).

[0] I550c7d2563a2d3ada07e2162383f59f104bcbbd5
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v1/tasks/test_compute_tasks.py (+27, -14)
releasenotes/notes/ensure-rsyslog-reloaded-amphorav1-a4ec5127a459f3bf.yaml (+7, -0)
octavia/controller/worker/v1/tasks/compute_tasks.py (+3, -3)
",-0.498433,-0.76501,-1.393121,-1.19906,0.283544,0.142046,1.030873,-0.148298,-0.097944,0.470872,0.290639,0.142767,0.109149,0.125444,-0.008178
openstack/octavia,I66ed18b9cd89f49a3ddb08ac4fbc1afff92ccac9,1,0,1.0,2.1972,0.75,1,13.0,267,0,Feature,0,0,0,6,0.122449,0.2143,0,0.2143,2,1,0,0.5765,0.0,2.0,1.66,17.51,1,0,0.0,0,29.6667,0,0,0,0,0,"Exclude invalid TLS version

This change ensures the agent_tls_protocol parameter accepts only
valid protocol names.

Story: 2009113
Task: 42994
(cherry picked from commit 0059f05aeb8b7bd1fb83d45148a9926d9dafaae0)
[SEP]
FILES CHANGED:
octavia/common/config.py (+2, -6)
",-0.749051,-0.329971,-1.897927,-1.117202,0.916837,0.390667,0.344139,-0.158005,0.717435,0.109215,-0.137614,-0.086336,0.162728,0.180293,-0.213251
openstack/openstack-ansible-os_manila,I6dcbae2896668f5fbb6f09bffc94cb6e90699e92,1,1,0.9167,1.0986,0.5,1,10.67,460,0,Bug Fix,0,0,0,24,0.033613,1.0,0,0.9167,1,1,0,0,0.0,1.0,43.99,14.89,1,0,0.0,0,153.3333,0,6,0,7,0,"Create backends when running against manila_share

For backends creation we verify that API is reachable. With that on real
deployments we disable container we're running against on haproxy.

This results in task failure. To avoid that we add backends when
share/data services for manila. This is done in separate play when
all API backends should be enabled and functioning properly.

Closes-Bug: #1979209
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
",-0.148747,-1.620359,0.035939,0.361917,-0.386689,-0.08947,0.332376,0.154583,-0.315794,-0.007755,-0.00015,-0.21004,0.392854,-0.391333,0.064243
openstack/openstack-ansible-os_zun,Ifb111105b63515449c07ffcd27b72bb9eceab83d,1,0,0.92,2.3979,1.0,1,3.0,167,0,Feature,0,0,0,25,0.034916,1.0,0,0.92,1,1,0,1.0,0.0,1.0,-106.41,23.42,0,0,0.0,0,15.1818,0,0,0,0,0,"Move etcd installation to playbook

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/847362
[SEP]
FILES CHANGED:
tasks/main.yml (+0, -10)
",-0.351909,4.37256,-1.938691,0.254787,-1.209487,0.472891,0.13211,-0.43059,-0.001802,-0.840949,-0.673709,0.321959,-0.137246,-0.262596,0.003123
openstack/kolla,I6df02a35510e56aa91b23617c5d15ce1884b0312,1,1,0.8919,1.0986,0.0,1,4.75,226,0,Bug Fix,0,0,0,37,0.045567,0.5455,0,0.4865,2,1,0,0.8146,0.0,2.0,-7.26,12.43,0,0,0.0,0,75.3333,0,16,0,8,0,"upper-constraints: remove neutron

Since https://review.opendev.org/c/openstack/requirements/+/846785
has landed - Kolla builds are failing - see bug.

Closes-Bug: #1979703
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+2, -0)
",0.780378,1.000488,-1.148196,-0.817982,-1.420429,0.181173,-0.337833,-0.016355,0.108331,-0.419634,-0.461525,-0.169698,-0.108882,-0.15374,0.190177
openstack/octavia,I5a749c751d184ec10957a31b569419d57fe8daf6,1,0,0,2.7081,0.2857,5,14.0,833,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,7,2,0,0.578,2.1281,5.2,33.24,13.1,1,0,0.2857,1,55.5333,0,0,0,0,0,"Fix HealthMonitorToErrorOnRevertTask revert method

So far, whenever we had to revert HealthMonitorToErrorOnRevertTask,
we called mark_health_mon_prov_status_error with the wrong parameter
(health_mon[constants.POOL_ID] == the pool id).

This would set the pool's provisioning status to ERROR.

Later in the revert task we call mark_pool_prov_status_active with the
correct argument (health_mon[constants.POOL_ID] == the pool id), so we
set it back to ACTIVE, and the task continues correctly.

This means we might have missed setting the health monitor's
provisioning status to ERROR, and therefore we might have missed some
errors.

This commit changes the parameter to be the correct one in both API
v1 and v2, and it modifies the tests accordingly.

Story 2010113
Task 45690
[SEP]
FILES CHANGED:
releasenotes/notes/fix-health-monitor-to-error-revert-task-feb38ba7641a4892.yaml (+6, -0)
octavia/controller/worker/v2/tasks/lifecycle_tasks.py (+1, -1)
octavia/controller/worker/v1/tasks/lifecycle_tasks.py (+1, -1)
octavia/tests/unit/controller/worker/v1/tasks/test_lifecycle_tasks.py (+1, -1)
octavia/tests/unit/controller/worker/v2/tasks/test_lifecycle_tasks.py (+1, -1)
",-3.09171,-0.040117,1.765661,0.136303,0.281839,0.655542,-0.461267,-0.241292,0.203837,-0.260664,0.630055,-0.077758,-0.417467,0.071873,-0.080569
openstack/ansible-role-python_venv_build,I492d17169538ad2768e28f7c48314bdec407ab36,1,1,0.9231,3.1781,0.087,3,16.6,602,0,Bug Fix,0,0,0,26,0.035813,1.0,0,0.9231,2,2,0,0,1.474,1.33,40.15,14.35,1,0,0.0,1,25.0833,0,6,0,6,0,"Run wheels build for each unique distro/arch

There may be multiple architecures and OS versions in
ansible_play_hosts. However, with run_once we build wheels only
for one selected distro and do not repsect multi-arch/multi-distro
setups.
Instead of run_once we need to select single (and first in play)
host of each architecture and distro and delegate wheels building
from it. That is needed, because venv_build_host is selected based
on the facts gathered for current inventory_hostname and will
depend on it's arch/distro.

Closes-Bug: #1964535
[SEP]
FILES CHANGED:
tasks/main.yml (+3, -2)
releasenotes/notes/fix_respect_multiarch_setup-6e4d0b2c48ff3a18.yaml (+6, -0)
vars/main.yml (+12, -0)
",-0.53084,-1.0829,1.04863,0.023241,0.129867,-0.532523,0.536218,0.067729,-0.184891,-0.505024,0.099142,-0.198953,-0.141287,-0.007186,-0.001794
openstack/charm-ceph-mon,Ibdad1fd5976fdf2d5f3384f1b120b0d5dda34947,1,1,0,4.4067,0.3457,4,8.5,533,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,2,0,0,1.1543,1.0,-7.49,16.73,1,0,0.1852,1,6.5,0,26,0,12,0,"Ensure broker requests are re-processed on upgrade-charm

When broker-request caching was added, it broke functionality
that ensured that clients were updated on charm-upgrade, this
change enables a bypass of that cache functionality and uses
it to re-process broker requests in the upgrade-charm hook.

Depends-On: https://review.opendev.org/c/openstack/charms.ceph/+/848311
Func-Test-Pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1066
Closes-Bug: #1968369
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+39, -21)
tests/tests.yaml (+2, -0)
unit_tests/test_ceph_hooks.py (+8, -5)
src/ceph_client.py (+4, -2)
",-1.662018,1.232532,0.025014,-0.135226,-0.749039,-0.393236,0.394299,0.153015,-0.027734,-0.302605,0.189239,0.041063,0.172767,-0.068757,0.321194
openstack/openstack-ansible,I00ac6c0ce83c952efa37640725296810ee11db1c,1,0,0.9259,1.0986,0.5,1,9.25,324,0,Feature,0,0,0,27,0.036048,1.0,0,0.9259,1,1,0,0.9444,0.0,1.0,23.67,9.11,1,0,0.0,0,108.0,0,0,0,0,0,"Do not install rally on first upgrade run

In order to save up some time for upgrade jobs, we avoid installing
rally during first run of upgrade (on branch-1) as rally is branchless.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-os_rally/+/848666
[SEP]
FILES CHANGED:
scripts/gate-check-commit.sh (+1, -1)
",-0.507464,1.497178,-0.822451,0.601235,-0.604709,0.043762,0.880699,-0.454409,-0.037144,-0.156223,-0.165619,-0.067116,0.331644,-0.187275,0.196862
openstack/ansible-role-python_venv_build,Ic86c19ca48fb55ad2c464c22f31ac41c5cc4c2e5,1,0,0.8333,0.6931,0.0,1,15.75,402,0,Feature,0,0,0,12,0.173913,1.0,0,0.8333,1,1,0,1.0,0.0,1.0,68.65,10.74,0,0,0.0,0,201.0,0,0,0,0,0,"Gather build hosts facts once.

In [1] the build host facts gathering was moved from a place in the
code which was covered by run_once to one that is not. The task is
now missing a run_once so it iterates over the repo_all group for
each host in the play which could be a very large number of tasks.

[1]  I79a10a3f774246ab9c57313f19f3804f9422e08c
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",-0.837806,-1.357691,0.11693,-0.559698,0.11948,0.082438,1.076456,-0.183646,0.269787,0.653023,0.096022,-0.049455,-0.098984,0.157662,0.163901
openstack/octavia,Ifbbe714c66117e57f96614534e6f20a9634c26eb,0,0,0.75,5.3279,0.2293,8,17.0,576,0,CI,0,0,0,12,0.037267,1.0,0,0.75,7,3,0,0.5795,2.2399,5.38,36.3,16.68,1,0,0.5366,1,2.7961,0,0,0,0,0,"Amphora vertical scaling optimization in Octavia

Uses the amphora agent for optimizing HAProxy for vertical scaling:

Set cpu_map setting so that HAProxy pins each of its worker threads to
one specific CPU (except CPU0, which remains reserved for other tasks).
In order not
to change previous behavior this feature will only be enabled if the
amphora image was built with vCPU vertical scaling enabled (the new
default).
This change assumes an amphora image with HAProxy version 1.5 or higher.

Story: 2010236
Task: 46043
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+35, -21)
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+5, -0)
octavia/amphorae/backends/agent/api_server/amphora_info.py (+18, -3)
octavia/common/jinja/haproxy/combined_listeners/templates/base.j2 (+4, -0)
releasenotes/notes/automatic-vertical-scaling-optimization-9604d53d60ca7b85.yaml (+9, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+71, -17)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+4, -1)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+12, -5)
",-1.23359,-1.674455,0.36753,0.34041,-0.032328,0.145194,-0.308271,0.56807,0.215075,0.144769,0.177768,0.358599,0.042598,-0.065088,-0.21896
openstack/octavia,I1a0591de79be867483a044705e866b2368b2a567,0,0,0.6923,5.2575,0.0052,13,11.5,635,0,Feature,0,0,0,13,0.024668,0.375,0,0.2596,6,8,0,0.5775,2.8357,2.92,36.08,15.47,1,0,0.0,1,3.3073,0,0,0,0,0,"Add cpu-pinning element

The new ""cpu-pinning"" element optimizes the amphora image for better
vertical scaling. When an amphora flavor with multiple vCPUs is
configured it will configure the kernel to isolate (isolcpus)
all vCPUs except the first one.
Furthermore, it uninstalls irqbalance and sets the IRQ affinity to the
first CPU. That way the other CPUs are free to be used by HAProxy
exclusively. A new customized TuneD profile applies some more tweaks
for improving network latency.

This new feature is disabled by default in diskimage-create.sh.

Story: 2010236
Task: 46042
[SEP]
FILES CHANGED:
elements/cpu-pinning/static/etc/tuned/amphora/tuned.conf (+67, -0)
elements/cpu-pinning/svc-map (+4, -0)
elements/cpu-pinning/README.rst (+6, -0)
elements/cpu-pinning/static/etc/tuned/amphora/script.sh (+23, -0)
diskimage-create/diskimage-create.sh (+13, -1)
elements/cpu-pinning/post-install.d/30-set-tuned-profile (+3, -0)
elements/cpu-pinning/post-install.d/20-enable-tuned (+11, -0)
diskimage-create/README.rst (+2, -0)
elements/cpu-pinning/environment.d/80-kernel-cpu-affinity (+36, -0)
elements/cpu-pinning/package-installs.yaml (+3, -0)
elements/cpu-pinning/element-deps (+2, -0)
elements/cpu-pinning/static/etc/tuned/active_profile (+1, -0)
releasenotes/notes/add-cpu-pinning-element-86617303b720d5a9.yaml (+19, -0)
",-1.692874,-1.505105,0.800138,0.287177,0.022565,-0.035085,-0.196373,0.276451,0.234423,-0.057181,0.121789,0.413766,-0.136471,0.036813,-0.237416
openstack/ironic-lib,I0c02d68fd82dc5c9d5fec32ca98f02e98228eca2,1,0,0.9583,2.7726,0.3333,2,4.0,98,0,Feature,0,0,0,24,0.012625,0.0,0,0.0,2,1,0,1.0,0.8366,2.0,12.43,16.6,1,0,0.2667,0,6.125,0,0,0,0,0,"json_rpc.client: log the URL and exceptions
[SEP]
FILES CHANGED:
ironic_lib/tests/test_json_rpc.py (+2, -2)
ironic_lib/json_rpc/client.py (+8, -3)
",2.71883,0.847351,0.920885,0.33507,0.080333,-0.380849,0.203838,0.259626,0.809393,-0.441303,-0.042517,-0.6839,-0.864006,0.502121,-0.018785
openstack/openstack-ansible-os_mistral,I25b622de40c02f3cc410070e04e2d5d0fd67abc9,1,0,1.0,2.3026,0.1111,2,14.67,343,0,Feature,0,0,0,2,0.4,1.0,0,1.0,1,2,0,0,0.9911,1.0,32.36,11.32,1,0,0.0,0,34.3,0,0,0,0,0,"Allow running Mistral API service without uWSGI

While running Mistral API service within uWSGI, Mistral's Cron
Triggers do not create Workflow Exectuions. This change would disable
Cron Triggers for all existing installations as running API service
within uWSGI stays enabled by default.
[SEP]
FILES CHANGED:
templates/mistral.conf.j2 (+4, -0)
defaults/main.yml (+4, -1)
",-0.403715,-0.745103,-0.238678,1.083462,0.589143,-0.063906,-0.251949,0.879788,-0.440072,-0.418409,-0.00249,0.068247,0.249897,-0.617465,0.252588
openstack/charm-nova-compute,Ic100528f9f38bbc0c83e4f563166113024e3db59,1,1,0,5.961,0.0,1,11.88,627,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,51.41,11.49,1,0,0.0,1,1.616,0,18,0,9,0,"Update nova.conf for OpenStack Yoga

This merge request focuses on fixing the VNC config for OpenStack Yoga
on the Focal and Jammy series. Originally, the Yoga version of this
charm was using a template nova.conf file from Train which did not use
the new [vnc] required for Yoga. Train had the VNC config in the
[DEFAULT] section, which is depreciated in Yoga.

Itemized changes to charm below:

 * Create templates/yoga
 * Move VNC config to [vnc] section in nova.conf
 * Rename VNC config keys to follow the Yoga specification.

Closes-Bug: #1974082
Closes-Bug: #1734683
[SEP]
FILES CHANGED:
templates/yoga/nova.conf (+387, -0)
",-1.865642,-0.100468,0.658958,0.237516,-0.038272,0.181881,-0.085845,0.68486,-0.190292,0.011242,0.547545,0.083825,-0.023928,0.067522,-0.08328
openstack/ironic,I49e1907b89a9096aa043424b205e7bd390ed1a2f,1,0,1.0,4.9053,0.1716,4,25.5,666,1,Feature,0,0,0,18,0.009693,1.0,0,1.0,6,3,0,0.9804,1.6361,4.0,36.63,17.65,0,0,0.1194,1,4.9333,0,0,0,0,0,"Redfish: Consider password part of the session cache

Previously, when a password change occured in ironic,
the session would not be invalidated, and this, in theory,
could lead to all sorts of issues with the old password
still being re-used for authentication.

In a large environment where credentials for BMCs may not
be centralized, this can quickly lead to repeated account
lockout experiences for the BMC service account.

Anyhow, now we consider it in tracking the sessions, so
when the saved password is changed, a new session is
established, and the old session is eventually expired out
of the cache.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/utils.py (+39, -22)
doc/source/admin/drivers/redfish.rst (+49, -1)
releasenotes/notes/redfish_consider_password_in_session_cache-1fa84234db179053.yaml (+7, -0)
ironic/tests/unit/drivers/modules/redfish/test_utils.py (+16, -0)
",-0.662809,-2.419656,1.256817,0.211135,-0.496939,-0.006287,0.521667,-0.574703,0.138195,0.127066,0.054647,0.270271,0.043304,0.121236,-0.042358
openstack/openstack-ansible-plugins,I9cfbf53a66f9488b6cbd22c880fb7e9dc1752ef6,1,0,0,1.9459,0.5,2,15.0,212,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0,0.9183,3.0,56.25,10.0,1,0,0.0,0,30.2857,0,0,0,0,0,"Fix gluster play_hosts

If using the last play host we cannot grow the cluster since the
`gluster peer probe` command needs to be executed on a running node.
[SEP]
FILES CHANGED:
roles/glusterfs/tasks/main.yml (+2, -2)
roles/glusterfs/vars/main.yml (+1, -1)
",0.88314,-0.951595,-0.264338,0.562542,0.376944,0.174402,-0.053387,-0.517583,-0.037273,-0.582,-0.086642,0.065584,-0.324152,0.094017,-0.115267
openstack/kayobe,I7e10b851016253bf85625e9daa89416c738242e8,1,0,0.8947,0.6931,0.0,1,14.0,183,0,Feature,0,0,0,38,0.046683,0.0,0,0.0,4,1,0,0.9351,0.0,4.0,-37.0,19.89,0,0,0.0,0,91.5,0,0,0,0,0,"ovn: add network group to neutron-ovn-metadata-agent

Follow up after I111df79f08eb76a735f33c6edf03b5a302fb6cc3 in kolla-ansible
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/overcloud-services.j2 (+1, -0)
",0.458139,0.890393,-2.372314,-1.46966,1.395705,-0.252355,0.883219,-0.386128,0.344233,-0.607552,-0.593707,0.676165,-0.153664,-0.094973,0.169245
openstack/kolla,If7955df1073adadad2d306c3d9b74d1479cd334a,0,0,0,2.3026,0.3333,2,3.3,294,0,CI,0,0,0,0,0.0,0.1316,0,0.0,2,2,0,0.8158,0.9911,1.0,26.59,7.38,1,0,0.0,1,29.4,0,0,0,0,0,"Drop support for python 3.6 and 3.7

In Zed cycle, we have dropped the python 3.6/3.7[1] testing
and its support. Updating the python classifier also to reflect the same.

[1] https://governance.openstack.org/tc/reference/runtimes/zed.html
[SEP]
FILES CHANGED:
releasenotes/notes/drop-pyhton-3-6-and-3-7-6cc88979aad423e8.yaml (+5, -0)
setup.cfg (+1, -3)
",-0.362294,1.142474,-0.547896,0.673655,-0.872588,0.197919,0.251841,0.439847,-0.258494,1.126582,-0.412031,-0.028726,-0.128123,-0.030191,0.133755
openstack/ironic,I3d848af284545a7a1fb1e065f09fe2df6a9114ac,0,0,1.0,3.3673,0.0357,2,24.0,470,0,Bug Fix,0,0,0,19,0.009543,0.0,0,0.0,2,2,0,0.9808,0.3712,2.0,34.43,16.82,0,0,0.0,1,16.2069,0,0,0,0,0,"Fix ilo boot interface order

This change aligns the boot interface order of the ilo
hardware type to match the other hardware type interface
order lists.

This change is a result of an operator reporting inconsistent
behavior of ironic when they are adding nodes using the ilo
hardware type, where they would default to use the ""pxe"" boot
interface, where as the other interfaces would end up defaulting
to ""ipxe"".
[SEP]
FILES CHANGED:
ironic/drivers/ilo.py (+1, -1)
releasenotes/notes/fix-ilo-boot-interface-order-238a2da9933cf28c.yaml (+26, -0)
",-1.037658,-1.827769,0.015418,1.07909,0.426351,-0.404853,0.057996,0.113834,0.174906,0.044419,-0.356456,0.402263,0.294841,0.016571,0.087378
openstack/openstack-ansible-lxc_hosts,I3e761c181c1bf3b736fff3bf9ac441e266bc4e2c,1,0,1.0,1.6094,0.5,2,7.5,300,0,Feature,0,0,0,8,0.111111,1.0,0,1.0,1,1,0,1.0,1.0,1.0,7.46,12.33,0,0,0.0,0,60.0,0,0,0,0,0,"Take account of lxc_apt_mirror in new debootstrap command

Without this change the mirror variable is ignored which can
cause issues on systems running behind a proxy.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/851233
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -1)
defaults/main.yml (+1, -1)
",-0.728662,1.10359,-0.955247,0.251643,-0.797097,-0.098262,0.124955,-0.323385,0.135193,-0.263043,-0.320088,-0.350358,0.180577,-0.380687,0.154378
openstack/openstack-ansible,I5a9f9855aa701d12bc3c9e2e7e9c651ff606c319,1,0,1.0,2.8332,0.125,3,12.8,459,0,CI,0,0,0,9,0.118421,1.0,0,1.0,3,2,0,0.9474,1.5052,2.67,37.86,13.24,0,0,0.0,1,27.0,0,0,0,0,0,"rabbitmq: default to using TLS for management user interface

The RabbitMQ role defaults change in Yoga to enable the management
UI with TLS/HTTPS. This implicitly disables the HTTP port.

This commit adjusts the HAProxy config to take account of this
change and switch the port used accordingly. The
rabbitmq_management_ssl variable is also set explicitly to ensure
it is defined with appropriate scope.
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-upgrade-management-ssl-d6a7f77f2a65ffa9.yaml (+7, -0)
inventory/group_vars/all/all.yml (+3, -0)
inventory/group_vars/haproxy/haproxy.yml (+4, -2)
",-0.252957,-1.559599,0.340331,0.804103,-0.171967,-0.124251,0.453011,0.638405,0.600149,0.182998,0.151298,-0.257177,-0.193193,-0.405618,-0.018341
openstack/openstack-ansible,I54a9e637c9575c32429d28b89541ba026580e511,1,0,0.8462,0.6931,0.0,1,9.75,340,0,CI,0,0,0,13,0.185714,0.0,0,0.0,1,1,0,0.95,0.0,1.0,16.89,12.11,0,0,0.0,0,170.0,0,0,0,0,0,"Increase ControlPersist timeout to 300 seconds

This ControlPersist socket periodically closing seems to be the
cause of intermittemt MODULE FAULIRE particularly in zuul CI
jobs. Extend the timout to make this less likley to happen.

See https://github.com/ansible/ansible/issues/78344
[SEP]
FILES CHANGED:
scripts/openstack-ansible.rc (+1, -0)
",-0.088844,0.258956,-0.515022,0.217086,-0.527531,0.413826,0.343171,-0.392036,-0.176415,-0.10375,0.120639,-0.263129,0.285327,-0.496173,0.155518
openstack/kolla-ansible,Id60046e0ddc7ec843f2e4ce7ddee7683470a88b2,1,0,0.8889,1.0986,1.0,1,35.0,285,0,Feature,0,0,0,72,0.024557,0.0,0,0.0,4,1,0,0.8347,0.0,4.0,-2.72,24.29,0,0,0.0,0,95.0,0,0,0,0,0,"haproxy-config: Drop project_name variable

This variable shadows the name of the actual project that calls this
role, so we end up with the following nonsense:

  TASK [haproxy-config : Copying over haproxy-config haproxy config]
[SEP]
FILES CHANGED:
ansible/roles/haproxy-config/vars/main.yml (+0, -2)
",1.109558,-0.365262,-0.087533,0.6862,0.21463,-0.036415,0.620563,-0.202847,-0.237064,-0.459471,0.380575,-0.266,-0.115439,-0.040406,-0.043925
openstack/ironic,I3594ac580c01454c70922a965a2a653a8b568cbb,1,1,0.95,3.6636,0.0526,3,24.17,861,0,Bug Fix,0,0,0,20,0.009906,1.0,0,0.95,6,2,0,0.9623,1.5365,4.0,52.78,15.18,0,0,0.4474,1,22.0769,0,6,0,6,0,"Suppress Chassis Not Found on API Operation

When you have a multi-db deployment, or even just many
different threads operating on the same server with different
transactions, you can run into a situation where one thread
initiates a transaction to get a list of nodes, and then
another triggers a delete of the chassis (and most likely node,
but hey, there is really no way to detect that and work.)

So as the API is processing the response and making the json
result set, the query to resolve a chassis_id on a node object
can begin to fail.

Before this patch, this would raise an exception to the client.

Now, we just suppress the error, and return the field value
as None.

In the grand scheme, the node is likely has also already
been deleted as well.

Closes-Bug: 1508995
Story: 1508995
Task: 10038
[SEP]
FILES CHANGED:
releasenotes/notes/suppress_chassis_not_found_error-99ee4b902d504ec7.yaml (+9, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+17, -0)
ironic/api/controllers/v1/node.py (+10, -2)
",-2.01845,-2.040552,2.316244,-0.675488,-0.845494,0.123854,0.118544,-0.479747,0.086072,0.029019,0.078205,0.04399,-0.030602,0.312317,-0.016258
openstack/ironic,If69ce1cf2789d9d60fb8e544596cf7d29eab514d,1,0,1.0,5.0752,0.0189,6,5.12,414,0,Bug Fix,0,0,0,1,0.038462,1.0,0,1.0,6,3,0,0.963,1.9896,4.67,-0.58,13.76,1,0,0.2956,1,2.5875,0,0,0,0,0,"Fix iRMC driver to use certification file in HTTPS

This patch modifies iRMC driver to use certification file
when it connects to iRMC via HTTPS

Depends-On: https://review.opendev.org/c/openstack/ironic/+/852250
Co-authored-by: Kobayashi Daisuke <kobayashi.da-06@fujitsu.com>
Co-authored-by: Song Shukun <song.shukun@jp.fujitsu.com>
Story: 2009801
Task: 44345
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/irmc/test_common.py (+42, -0)
ironic/drivers/modules/irmc/common.py (+52, -1)
ironic/tests/unit/drivers/modules/irmc/test_boot.py (+1, -0)
doc/source/admin/drivers/irmc.rst (+49, -0)
ironic/tests/unit/drivers/modules/irmc/test_raid.py (+2, -2)
releasenotes/notes/irmc-add-certification-file-option-34e7a0062c768e58.yaml (+10, -0)
",-2.383663,2.295365,-0.964401,0.097762,-0.592635,0.181316,-0.079662,0.132143,-0.180356,-0.235549,0.861176,0.219903,0.390834,0.32215,-0.367469
openstack/ironic,Ie2ec6e08214661f7dc61c92de646e2f4d5bb5469,1,0,1.0,1.0986,0.5,1,10.5,503,0,Bug Fix,0,0,0,2,0.010811,0.0,0,0.0,2,1,0,0.9636,0.0,2.0,21.61,14.36,1,0,0.0,0,167.6667,0,0,0,0,0,"Modify do_node_verify to avoid state machine stuck

do_node_verify function runs vendor-driver-defined verify_step.
However, when vendor verify_step fails, it causes stuck of state
machine at verifying.
This is because do_node_verify function tries to retrieve name
of verify_step through node.verify_step but node doesn't have
verify_step attribute and there is no way to handle exception.

This commit fixes this issue.

Story: 2010209
Task: 45942
[SEP]
FILES CHANGED:
ironic/conductor/verify.py (+1, -1)
",-1.380847,0.075738,-0.129548,0.741585,0.274304,0.217911,0.11086,-0.49269,0.125514,-0.325486,0.784702,-0.534254,-0.137274,0.282464,0.23084
openstack/openstack-ansible-os_horizon,I959f0f84b264ffc25481e9becb3059f28a233010,1,0,1.0,1.3863,0.0,2,16.0,226,0,Feature,0,0,0,10,0.108696,1.0,0,1.0,1,2,0,1.0,0.9183,1.0,45.19,11.4,0,0,0.0,0,56.5,0,0,0,0,0,"Add support for websso http referer variable added in yoga

This variable was added in the Yoga release to permit changes
to how Horizon contacts Keystone in an IDP setup.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -0)
templates/horizon_local_settings.py.j2 (+2, -0)
",1.203937,-1.254501,0.108166,0.302535,-0.536743,0.280899,0.418018,0.252036,-0.041103,0.090735,-0.176858,0.392112,-0.330774,-0.384883,0.075088
openstack/openstack-ansible,I69f90cf5da035777570a733644efa95a18634039,1,0,0.8571,2.1972,0.5,2,5.0,146,0,Doc,0,0,0,14,0.197183,0.5385,0,0.4615,2,1,0,0.9524,1.0,2.0,15.64,10.0,0,0,0.0,0,16.2222,0,0,0,0,0,"Correct series names for documentation.

The upgrade guide renders the wrong release names.
[SEP]
FILES CHANGED:
doc/source/conf.py (+2, -2)
deploy-guide/source/conf.py (+2, -2)
",2.408226,-0.898058,0.396887,0.539168,-0.272104,0.622885,0.26291,-0.103271,0.493508,-0.041585,-0.183553,0.151972,-0.260842,0.305129,-0.831446
openstack/kolla-ansible,I86331f78070cbe9b699061276ed0865c17d1fdfe,0,0,0,0.6931,0.0,1,9.0,100,0,Feature,0,0,0,0,0.0,0.6667,0,0.0,4,1,0,0.8354,0.0,4.0,19.1,21.38,0,0,0.0,0,50.0,0,0,0,0,0,"add amphora haproxy default max connect 50000
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -0)
",2.395146,-0.096464,0.647928,-0.338213,0.894622,0.114365,-0.030309,0.381642,-0.163684,-0.231723,0.053701,-0.501172,-0.120749,-0.33074,0.113448
openstack/ironic,I8791623be95e7e47739ee051753de97eb0e5e2a3,1,0,0.9524,4.4308,0.0723,3,11.33,246,0,Bug Fix,0,0,0,21,0.010209,1.0,0,0.9524,4,2,0,0.9643,1.0809,2.67,26.13,12.77,0,0,0.7229,1,2.9286,0,0,0,0,0,"Fix pxe image lookups

Image lookups in the PXE interface, for anaconda specific code,
were previously hard coded to try and invoke use of glance if
needed.

Except, not everything is glance.
[SEP]
FILES CHANGED:
ironic/common/pxe_utils.py (+11, -6)
releasenotes/notes/fix-pxe-glance-lookup-anaconda-86fe616c6286ec08.yaml (+6, -0)
ironic/tests/unit/common/test_pxe_utils.py (+60, -0)
",0.513668,-1.849663,-0.047325,0.16327,-0.438258,-0.202608,-0.296924,-0.226804,-0.578065,0.075246,-0.262267,0.134809,-0.041238,0.029237,-0.002474
openstack/ironic,I4bd8b1b4ea974834f1149fcaa79de85d24f5f7d1,1,0,1.0,5.5835,0.5019,9,9.29,520,0,CI,1,0,0,3,0.016043,1.0,0,1.0,6,1,0,0.9649,2.5065,5.22,33.42,13.56,1,0,1.0,0,1.9549,0,0,0,0,0,"Modify test code to avoid CONF modification affection

Few unit tests change attribute of  CONF variable via Python
assignment. This changes attribute of CONF, which is instance
of XxxOpt class defined in oslo_config, to Python literal value.

This affects result of another unit test.

To avoid this, we should change attribute of CONF variable with
set_override method.

Story: 2010214
Task: 45956
Depends-On: https://review.opendev.org/c/openstack/ironic/+/852253
[SEP]
FILES CHANGED:
ironic/tests/unit/api/test_audit.py (+3, -4)
ironic/tests/unit/drivers/modules/irmc/test_boot.py (+35, -33)
ironic/tests/unit/api/test_ospmiddleware.py (+2, -2)
ironic/tests/unit/drivers/modules/test_snmp.py (+1, -1)
ironic/tests/unit/common/test_molds.py (+44, -44)
ironic/tests/unit/drivers/modules/redfish/test_firmware_utils.py (+13, -13)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+5, -5)
ironic/tests/unit/drivers/modules/ilo/test_boot.py (+8, -10)
ironic/tests/unit/drivers/modules/ilo/test_common.py (+21, -21)
",-1.47792,-0.134148,0.384076,-0.053975,-0.383496,0.160664,-0.208553,0.00338,0.364521,-0.022174,0.132632,-0.265862,-0.118688,0.185831,-0.349198
openstack/oslo.messaging,I85f5b9d1b5d15ad61a9fcd6e25925b7eeb8bf6e7,1,1,0,2.7726,0.1333,2,7.31,749,0,Bug Fix,0,0,0,0,0.0,0.5833,0,0.0,2,2,0,0.5217,0.971,2.0,35.56,10.5,1,0,0.0,1,46.8125,0,82,0,60,0,"Change default value of ""heartbeat_in_pthread"" to False

As was reported in the related bug some time ago, setting that
option to True for nova-compute can break it as it's non-wsgi service.
We also noticed same problems with randomly stucked non-wsgi services
like e.g. neutron agents and probably the same issue can happen with
any other non-wsgi service.

To avoid that this patch changes default value of that config option
to be False.
Together with [1] it effectively reverts change done in [2] some time
ago.

[1] https://review.opendev.org/c/openstack/oslo.messaging/+/800621
[2] https://review.opendev.org/c/openstack/oslo.messaging/+/747395

Related-Bug: #1934937
Closes-Bug: #1961402
[SEP]
FILES CHANGED:
releasenotes/notes/do-not-run-heartbeat-in-pthread-by-default-42e1299f59b841f8.yaml (+9, -0)
oslo_messaging/_drivers/impl_rabbit.py (+4, -2)
",-3.042058,1.392048,1.561257,-0.209806,-0.834431,0.087302,0.1866,-0.267247,-0.110097,0.072782,0.165172,-0.059742,0.05334,-0.125622,0.040947
openstack/ironic,Iafedf2ec0326009585c1cac251ecae65c9e666ac,1,0,1.0,1.6094,0.5,1,6.29,346,0,CI,0,0,0,4,0.00885,0.0,0,0.0,2,1,0,0.9655,0.0,2.0,38.95,11.61,1,0,0.0,0,69.2,0,0,0,0,0,"Change molds option to appropriate class

At current, retry_attempt & retry_interval in ironic.conf [molds]
is instance of StrOpt. However it should be IntOpt class.
If it remains to StrOpt class, tenacity.retry wrapper in common/molds.py
will fail with TypeError.

Story: 2010215
Task: 45957
[SEP]
FILES CHANGED:
ironic/conf/molds.py (+2, -2)
",-0.59352,-0.5522,-0.659794,0.178313,0.040137,0.15495,-0.251334,-0.303787,0.287401,0.075802,0.404861,-0.499993,-0.429217,0.410311,-0.316787
openstack/openstack-ansible-os_keystone,Icb77fff4a2f823f4c2a84dc77c21e4ddf0c8e22c,1,0,0,1.6094,0.0,2,7.0,79,0,Feature,0,0,0,0,0.0,1.0,0,0.0,1,2,0,1.0,0.8113,1.0,30.53,14.23,1,0,0.0,0,15.8,0,0,0,0,0,"Add PKCE method for OIDC
[SEP]
FILES CHANGED:
templates/keystone-httpd.conf.j2 (+3, -0)
defaults/main.yml (+1, -0)
",3.804006,1.131483,1.967396,0.391498,0.837438,1.249864,0.33299,1.176582,0.758947,-0.105875,-0.313662,-0.389987,0.178562,-0.208904,0.160645
openstack/openstack-ansible-haproxy_server,I101f82c5e378596e76a160aacb34a9e1e7e0c123,1,0,0.9286,1.6094,0.25,1,13.0,264,0,Feature,0,0,0,28,0.037284,1.0,0,0.9286,1,1,0,0,0.0,1.0,46.13,11.35,0,0,0.0,0,52.8,0,0,0,0,0,"Do not add cacert when it does not exist

Right now we assume, that ca-cert is always present. Though, it might
not be the case for user-provided certs or let's encrypt, as they
are already in ca-certificates.
[SEP]
FILES CHANGED:
handlers/main.yml (+3, -1)
",1.004026,-1.269783,0.146375,0.712798,-0.261946,0.059424,0.616081,-1.313244,-0.333501,0.048663,0.017129,-0.050904,-0.144851,0.127647,-0.195039
openstack/octavia,Ib3f269cbe80222aafb22a36bb09444480a4bbb8d,1,0,1.0,2.4849,0.0,1,8.75,278,0,Bug Fix,1,0,0,1,0.055556,0.0,0,0.0,6,1,0,0.5754,0.0,6.0,36.01,10.36,1,0,1.0,0,23.1667,0,0,0,0,0,"Fix sporadic unit test failure

TestDriverListener.test_get_listener may fail if the serve_forever thread
takes too long to start.
Wait for up to 1 sec when checking that serve_forever was called.

Story: 2010218
Task: 45965
[SEP]
FILES CHANGED:
octavia/tests/unit/api/drivers/driver_agent/test_driver_listener.py (+11, -0)
",-0.544706,-1.039668,-0.887184,-0.178211,-0.313718,0.221826,-0.606735,-0.67763,0.246949,-0.077923,0.499173,-0.496364,-0.337985,0.217456,0.230631
openstack/oslo.log,Iac1b0891ae584ce4b95964e6cdc0ff2483a4e57d,1,1,1.0,5.9322,0.0,5,12.67,830,0,Bug Fix,0,0,1,1,0.010101,0.24,0,0.24,3,3,0,0,1.3389,1.4,41.85,12.79,1,0,0.5612,1,2.2016,0,14,0,27,0,"Fix logging in eventlet native threads

There is a bug in eventlet where logging within a native thread can lead
to a deadlock situation: https://github.com/eventlet/eventlet/issues/432

When encountered with this issue some projects in OpenStack using
oslo.log, eg. Cinder, resolve them by removing any logging withing
native threads.

There is actually a better approach. The Swift team came up with a
solution a long time ago [1], and in this patch that fix is included as
part of the setup method, but will only be run if the eventlet library
has already been loaded.

This patch adds the eventlet library as a testing dependency for the
PipeMutext unit tests.

[1]: https://opendev.org/openstack/swift/commit/69c715c505cf9e5df29dc1dff2fa1a4847471cb6

Closes-Bug: #1983863
[SEP]
FILES CHANGED:
oslo_log/tests/unit/test_pipe_mutex.py (+209, -0)
test-requirements.txt (+2, -0)
oslo_log/pipe_mutex.py (+142, -0)
oslo_log/log.py (+17, -0)
releasenotes/notes/native-threads-logging-cc84f7288c4835a0.yaml (+6, -0)
",-2.909571,0.212621,1.881568,-1.061124,-0.558224,0.075648,0.27097,0.111397,0.157387,0.000273,-0.033599,0.072587,0.053409,-0.224473,0.214081
openstack/octavia,I494ea357afc072360765d7a30a9488e08bfda52c,1,0,0.7143,3.8501,0.0435,5,23.67,427,0,Bug Fix,0,0,0,77,0.007015,0.7143,0,0.5102,5,2,0,0.5769,1.7877,4.0,60.08,13.97,0,0,0.8043,1,9.0851,0,0,0,0,0,"Fix bug when rolling back prov and op status for some API calls

POST l7rule API call and PUT pool API call had a bug that might have
kept a load balancer in provisioning_status when the call was rejected
by the provider.

The code didn't use the right locked DB session to set the statuses and
then to rollback them when an exception was caught.

Story 2010210
Task 45947
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_pool.py (+21, -0)
octavia/api/v2/controllers/pool.py (+1, -1)
octavia/tests/functional/api/v2/test_l7rule.py (+16, -0)
octavia/api/v2/controllers/l7rule.py (+1, -1)
releasenotes/notes/fixed-PENDING_UPDATE-on-provider-errors-40a03adc8ef82a54.yaml (+5, -0)
",-0.11876,-2.40124,0.333019,-0.057754,-0.429764,0.008326,0.208838,0.114981,0.105653,-0.099798,0.116514,-0.347842,0.062534,0.250448,0.256858
openstack/openstack-ansible-os_cinder,I0215bb17219745ab2c838a1999caf0a7baa4242d,1,0,1.0,1.6094,1.0,1,3.8,190,0,CI,0,0,0,1,0.333333,1.0,0,1.0,1,1,0,1.0,0.0,1.0,-19.65,18.36,1,0,0.0,0,38.0,0,0,0,0,0,"Remove oslo_policy section from cinder.conf

policy.json was deprecated.
Remove the oslo_policy configuration which was still using it.
[SEP]
FILES CHANGED:
templates/cinder.conf.j2 (+0, -4)
",1.313364,0.670664,-0.594127,0.884496,-0.105018,0.248278,0.503797,-0.111179,-0.105903,-0.536426,0.508024,-0.386981,-1.096938,0.484061,-0.08065
openstack/ironic,I589e9586d1279604a743746952aeabbc483825df,1,0,0.9545,5.2883,0.467,3,24.17,904,0,Bug Fix,0,0,0,22,0.01028,1.0,0,0.9545,4,2,0,0.9661,1.3104,2.67,44.61,15.46,0,0,0.5279,1,4.5657,0,0,0,0,0,"Correct Image properties lookup for paths

The image lookup process, when handed a path attempts
to issue a HEAD request against the path and gets a
response which is devoid of details like a content length
or any properties. This is expected behavior, however if
we have a path, we also know we don't need to explicitly
attempt to make an HTTP HEAD request in an attempt to
match the glance ``kernel_id`` -> ``kernel`` and similar
value population behavior.

Also removes an invalid test which was written before the
overall method was fully understood.

And fixes the default fallback for kickstart template
configuration, so that it uses a URL instead of a
direct file path.

And fix logic in the handling of image property result
set, where the code previously assumed a ``stage2``
ramdisk was always required, and based other cleanup
upon that.
[SEP]
FILES CHANGED:
releasenotes/notes/correct-source-path-handling-lookups-4ce2023a56372f10.yaml (+16, -0)
ironic/common/pxe_utils.py (+45, -32)
ironic/tests/unit/common/test_pxe_utils.py (+44, -60)
",-1.410888,-2.374547,2.323861,-0.37111,-0.289495,-0.225262,0.12588,-0.05317,0.456686,-0.007136,-0.38387,-0.123467,-0.18012,-0.068272,0.165319
openstack/openstack-ansible-os_keystone,Ibf7759eea63b7150aeae655c10eccc69cd3417ea,1,0,0.931,1.6094,0.5,1,21.0,657,0,Bug Fix,0,0,0,29,0.038411,1.0,0,0.931,1,1,0,1.0,0.0,1.0,12.29,14.75,0,0,0.0,0,131.4,0,0,0,0,0,"Fix keystone_secure_proxy_ssl_header logic

Previous commit [1] introduced logic that breaks proper service
discovery. Now we're fixing logic, following next rules/assumptiuons:
+----------+---------+---------------+
| HAProxy  | Apache  | RequestHeader |
+----------+---------+-- ------------+
| non-SSL  | non-SSL | http          |
| non-SSL  | SSL     | http          |
| SSL      | SSL     | https         |
| SSL      | non-SSL | https         |
+----------+---------+---------------+

[1] https://opendev.org/openstack/openstack-ansible-os_keystone/commit/6fae2bdade459c85dba55aae64c9f6f4e485a782
[SEP]
FILES CHANGED:
templates/keystone-httpd.conf.j2 (+2, -2)
",-3.474554,1.640496,1.9351,-0.717586,0.180052,0.240621,-0.136783,0.237587,-0.06323,0.184802,0.342133,-0.598021,0.488294,-0.081748,0.143803
openstack/ironic,Ibdfe0775065f3b27478305dd18929a291df3ee3c,1,0,0.96,4.2195,0.3582,4,14.0,352,0,Feature,0,0,0,25,0.013048,1.0,0,0.96,6,2,0,0.9667,1.6309,3.75,13.35,15.12,1,0,0.4776,1,5.1765,0,0,0,0,0,"Do not reboot into nowhere after BIOS settings with fast-track

Currently, the prepare_ramdisk implementation of the
redfish-virtual-media boot interface skips configuring an ISO in
fast-track mode. When rebooting after BIOS/RAID settings changes, we
need to enforce the correct ISO configuration.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/bios.py (+4, -20)
ironic/drivers/modules/deploy_utils.py (+5, -0)
releasenotes/notes/fast-track-bios-fa9ae685c151dd24.yaml (+6, -0)
ironic/tests/unit/drivers/modules/redfish/test_bios.py (+28, -4)
",0.610228,-0.931449,0.094535,0.745056,-0.014726,-0.137885,0.529179,0.307732,0.245093,-0.600832,-0.15083,0.324408,0.303212,-0.273084,0.348832
openstack/kolla,I077b7b5acf2c1f9beb6da06d3555e2ebe30831d1,1,0,0.6667,3.2581,0.96,3,8.29,384,0,Doc,0,0,1,6,0.083333,0.7,0,0.4667,2,2,0,0.8105,1.2178,1.33,61.31,8.83,1,0,0.64,0,14.7692,0,0,0,0,0,"Bump minimum docker-py version

With version 6.0.0 of the docker python module, their implementation of
versioning has changed, making our check for old versions fail. Since
version 3.0.0 is from 2018, we should be safe to assume that as a
minimum version though, so we can just get rid of the special handling
of older versions.
[SEP]
FILES CHANGED:
kolla/image/build.py (+0, -7)
requirements.txt (+1, -1)
kolla/tests/test_build.py (+0, -16)
",0.065382,-1.46045,0.005875,0.633697,-0.631157,0.1273,0.860392,-0.198166,-0.280699,1.044185,-0.257473,0.341968,-0.246582,-0.061314,0.653845
openstack/kayobe,I9dce73a8a205c0c0ad02eba3a10e02b82f5b191d,1,1,0.8904,2.4849,0.0,2,10.0,381,0,Bug Fix,0,0,0,73,0.024881,1.0,0,0.8904,4,2,0,0.9359,0.8454,3.0,30.87,14.4,0,0,0.0,1,31.75,0,8,0,14,0,"Fix passwords.yml generation when parent directory doesn't exist

Fixes an issue where generation of passwords.yml for Kolla Ansible
could fail if the directory containing the file does not exist. This is
typical in a multiple environment setup, when creating a new
environment.

Story: 2010293
Task: 46275
Closes-Bug: #2015093
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/library/kolla_passwords.py (+3, -0)
releasenotes/notes/fix-kolla-passwords-f1b5d051c494b4d8.yaml (+8, -0)
",-0.741333,-0.942784,-0.357456,0.007329,-0.339947,0.518953,-0.370137,-0.227122,0.074789,0.033461,0.443291,0.012899,0.463633,0.582109,0.142885
openstack/octavia,Id77ce36f59b71d309f153e5c1d44059f162ee440,1,0,0.7179,3.5835,0.4286,3,7.25,500,1,Bug Fix,0,0,0,78,0.007077,1.0,0,0.7179,6,2,0,0.5784,0.9937,4.0,20.07,13.93,1,0,0.0857,1,13.8889,0,0,0,0,0,"Fix barbican client with application credentials/trusts

It seems that keystoneauth1.identity.generic.token doesn't handle
properly the application credential/trust tokens passed by the context
of the requests. When using app credentials, Octavia failed to retrieve
the certificates from barbican.
Switching to keystoneauth1.token_endpoint fixes the issue, the
auth tokens are correctly passed to the barbican client.

Story: 2007619
Task: 39737
[SEP]
FILES CHANGED:
octavia/certificates/common/auth/barbican_acl.py (+14, -13)
releasenotes/notes/fix-application-credential-tokens-with-barbican-3b7d13283206c124.yaml (+5, -0)
octavia/tests/unit/certificates/common/auth/test_barbican_acl.py (+1, -2)
",-0.626445,-0.925416,-0.118439,0.508789,0.013272,-0.177021,0.252962,0.173161,0.289543,-0.28372,0.273139,-0.203895,0.053976,0.123645,0.06131
openstack/kolla-ansible,I8d7e0cbda3f55e2c96121e4d819385020f4e8aad,1,0,0.8438,1.7918,0.4,2,5.5,112,0,Doc,0,0,0,96,0.020797,1.0,0,0.8438,4,2,0,0.8319,0.7219,3.0,8.98,13.11,1,1,0.0,0,18.6667,0,0,0,0,0,"[docs] Align IPA images urls

To reflect stable branches.
[SEP]
FILES CHANGED:
doc/source/conf.py (+1, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+2, -2)
",2.317994,-0.983045,0.444841,-0.137154,-0.191715,0.017557,-0.585197,0.544153,-0.085346,0.544668,-0.336087,-0.266157,0.018146,-0.11681,-1.561559
openstack/octavia,Icc7dc9bb22187f908852c20415227574ded347aa,1,0,0.6429,4.5747,0.5521,9,7.17,376,0,Feature,0,0,0,14,0.019499,0.75,0,0.4821,7,3,0,0.5799,1.6397,5.11,18.56,14.03,1,0,0.7917,1,3.8763,0,0,0,0,0,"Handle feature compatibility of HAProxy server-state-file option

https://review.opendev.org/c/openstack/octavia/+/805955 introduced
a new feature that requires HAProxy 1.6 or higher to work. This change
ensures that with older HAProxy version this feature does not get
enabled to avoid errors.

Story: 2010254
Task: 46145
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+3, -1)
octavia/common/constants.py (+1, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_haproxy_compatibility.py (+0, -2)
releasenotes/notes/fix-haproxy-compatibility-about-server-state-file-df70e5ac859417e2.yaml (+7, -0)
octavia/common/jinja/haproxy/combined_listeners/templates/base.j2 (+2, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+25, -44)
octavia/common/jinja/haproxy/combined_listeners/templates/haproxy.cfg.j2 (+1, -1)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+3, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+1, -4)
",-0.247284,0.268052,-0.526583,-0.016711,-1.082376,0.209996,-0.012131,0.149642,0.416426,0.222631,-0.330135,-0.000164,0.089861,-0.208721,0.497665
openstack/kolla-ansible,I4cc4175ddc9b90847bf956007e2b9fe803960651,1,0,0.5714,1.7918,0.4,1,12.0,190,0,Doc,0,0,0,14,0.004826,0.5,1,0.2857,3,1,0,0.8326,0.0,3.0,53.66,13.13,1,1,0.0,0,31.6667,0,0,0,0,0,"[doc] Run docker registry with host network

As we disabled docker bridge network, we should run docker registry
with host network now.
[SEP]
FILES CHANGED:
doc/source/user/multinode.rst (+3, -2)
",1.364902,-0.491334,-0.073459,1.175145,0.056526,0.255836,0.374188,0.08936,-0.720851,-0.288177,-0.020093,0.447476,0.177097,-0.189996,-0.863358
openstack/octavia,I24ec7dc3b18111c126bcfdaa0780bfd7993020fb,1,0,0,4.3694,0.0897,3,30.75,761,0,Feature,0,0,0,0,0.0,0.625,0,0.0,5,2,0,0.5813,1.3312,3.67,41.5,17.18,1,0,0.5641,1,9.6329,0,0,0,0,0,"Cache subnets validation for batch member update

At the moment, we are actually going ahead and sending
an API request for every single member when doing a batch
update, this can be very expensive in large number of
members and will cause a big hit against the Neutron API,
it potentially also makes those API calls timeout.

This patch instead implements a simple cache (per batch
call) to simply store the subnets which are considered valid
which means that it will make significantly less calls,
potentially even one.

It also adjusts the behaviour so that it only runs this on newly
added members which should avoid running it for deleted and
updated members which won't have an effect in this change.
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/member.py (+19, -7)
octavia/tests/functional/api/v2/test_member.py (+44, -0)
releasenotes/notes/catch_validation-27ffe48ca187c46f.yaml (+8, -0)
",-0.962185,-2.726797,1.687535,0.048021,-0.523058,-0.261889,0.362026,-0.453731,-0.136946,0.375489,-0.416772,0.049862,0.106044,-0.178269,0.002308
openstack/kolla,Ia094cd1e29232c47d1fb26e00de569677bc5b8a1,1,0,0.8919,3.6109,0.3611,5,11.75,362,0,Bug Fix,0,0,0,74,0.025127,0.7143,0,0.6371,2,3,0,0.8117,2.2621,2.0,45.51,10.66,0,0,0.0,1,9.7838,0,0,0,0,0,"mariadb: Fix RPM repository URLs

The MariaDB project changed the location of the repositories, and the
old URLs no longer work.

Fix added for stable branches: Wrap version detection for docker module
since it can fail for docker >= 6.0.

(cherry picked from commit 94fad9f26bc056e9f049ff63fde5ef163eae43dc)
[SEP]
FILES CHANGED:
kolla/image/build.py (+8, -3)
docker/base/mariadb.repo (+3, -3)
docker/base/mariadb-aarch64.repo (+3, -3)
kolla/template/repos.yaml (+4, -4)
releasenotes/notes/docker-6-6d77b5ff7ec1daef.yaml (+5, -0)
",-2.234509,-1.191424,-0.3222,-2.00898,0.827013,-0.206389,0.569852,0.216766,-0.171661,0.542132,0.238325,-0.148881,0.302074,0.08641,-0.255255
openstack/ironic,I170d78bdb7ed0f6c36a80a9f2ceb9629f44394ed,1,0,0.9615,3.2958,0.3077,3,6.5,141,0,Bug Fix,0,0,0,26,0.013111,1.0,0,0.9615,6,2,0,0.9672,1.1842,4.0,-14.52,14.91,1,0,0.1154,1,5.2222,0,0,0,0,0,"redfish: fixes usage of ValueDisplayName

It's spelled this way, not DisplayValueName.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/bios.py (+11, -7)
releasenotes/notes/ValueDisplayName-13837c653277ff08.yaml (+5, -0)
ironic/tests/unit/drivers/modules/redfish/test_bios.py (+2, -1)
",1.871203,0.593896,0.293857,0.259399,-0.260532,1.062736,-0.567545,-0.789136,-0.476021,-0.00843,0.416612,-0.251325,-0.182783,0.219852,-0.103008
openstack/kolla,Ia094cd1e29232c47d1fb26e00de569677bc5b8a1,1,1,0.8974,3.6109,0.3611,5,13.5,453,0,Bug Fix,0,0,0,39,0.047853,1.0,0,0.8974,2,3,0,0.8129,2.2621,2.0,33.33,12.07,0,0,0.0,1,12.2432,0,6,0,12,0,"mariadb: Fix RPM repository URLs

The MariaDB project changed the location of the repositories, and the
old URLs no longer work.

Fix added for stable branches: Wrap version detection for docker module
since it can fail for docker >= 6.0.

Closes-Bug: #1988121

(cherry picked from commit 94fad9f26bc056e9f049ff63fde5ef163eae43dc)
(cherry picked from commit b3e72210851a2a9e3e066a85bbb2341bb9fadba5)
[SEP]
FILES CHANGED:
kolla/image/build.py (+8, -3)
docker/base/mariadb.repo (+3, -3)
docker/base/mariadb-aarch64.repo (+3, -3)
kolla/template/repos.yaml (+4, -4)
releasenotes/notes/docker-6-6d77b5ff7ec1daef.yaml (+5, -0)
",-2.234509,-1.191424,-0.3222,-2.00898,0.827013,-0.206389,0.569852,0.216766,-0.171661,0.542132,0.238325,-0.148881,0.302074,0.08641,-0.255255
openstack/ironic,I5e85df95a66aed9772ae0660b2c85ca3a39b96c7,0,0,1.0,5.656,0.014,4,15.33,326,0,Bug Fix,0,0,1,8,0.005658,1.0,0,1.0,6,3,0,0.9677,1.0411,3.0,42.3,13.96,1,0,0.6877,1,1.1399,0,0,0,0,0,"Fix idrac-redfish RAID controller mode conversion

PERC 9 and PERC 10 might not be in RAID mode with no or limited RAID
support. This fixes to convert any eligible controllers to RAID mode
during delete_configuration clean step or deploy step.

Story: 2010272
Task: 46199
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/drac/test_raid.py (+193, -3)
releasenotes/notes/fix-idrac-redfish-controller-mode-7b55c58d09240d3c.yaml (+5, -0)
ironic/drivers/modules/drac/raid.py (+82, -0)
driver-requirements.txt (+1, -1)
",0.676038,-1.268753,-0.262998,0.127764,0.098498,0.132763,-0.220098,0.604853,0.130217,-0.00715,-0.169899,0.188595,0.357365,0.091528,-0.189078
openstack/openstack-ansible,Ib1e3a47acc34ff6d8e6de9555aea59ee8aa244e7,1,0,0.9333,1.3863,0.0,1,13.17,537,0,Bug Fix,0,0,0,30,0.039526,0.0,0,0.0,2,1,0,0.9545,0.0,2.0,47.83,11.85,0,0,0.0,0,134.25,0,0,0,0,0,"Fix dynamic-address-fact gathering with tags

Right now an intermittent issue exists, since setup module does not run
when play is launched with --tags. dynamic-address-fact.yml is included
rather then imported thus tags should be properly applied in include
statement.

Because of that, facts were not gathered, and if facts are expired,
this would lead to changing config and all kind of nasty issues.

So we apply `always` tag to the facts gathering to ensure facts are
in place.
[SEP]
FILES CHANGED:
playbooks/common-tasks/dynamic-address-fact.yml (+3, -0)
",-0.9411,-1.616998,0.48986,0.307336,-0.26983,-0.34042,0.13555,-0.677308,-0.165128,0.194667,0.025052,-0.28196,0.334564,0.180608,-0.06237
openstack/charms.ceph,If58bde4d5445ed5de420abc007db6bf8b8e43269,0,0,0,3.4657,0.0968,2,15.33,365,0,Feature,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.9072,1.0,27.59,17.44,1,0,0.3226,0,11.4062,0,0,0,0,0,"Consider crimson-osds as well

This patchset modifies the 'get_running_osds' function so that
it also considers crimson-osds as valid OSD's. In addition, it
also modifies the 'get_local_osd_ids' to _not_ include Crimson
OSDs so that unsupported functionality doesn't make some hooks
fail in the ceph-osd charm.
[SEP]
FILES CHANGED:
charms_ceph/utils.py (+18, -3)
unit_tests/test_utils.py (+10, -0)
",-1.199578,-0.229623,-0.447463,1.076949,0.636827,-0.576622,-0.172547,-0.410408,-0.014918,-0.007165,-0.001352,-0.337569,-0.041951,-0.176402,0.125987
openstack/charm-ceph-osd,I59bf4e41f1f56c6bda2352b5613289ff73113342,0,0,0.0,4.625,0.0297,5,13.5,251,0,Feature,0,0,0,1,0.03125,0.4444,0,0.0,2,4,0,0,1.646,0.8,30.2,14.29,0,0,0.1881,1,2.4608,0,0,0,0,0,"Enable users to start/stop Crimson OSD's

This patchset modifies the add-disk action so that it now
can optionally start a Crimson OSD daemon.

Depends-On: If58bde4d5445ed5de420abc007db6bf8b8e43269
[SEP]
FILES CHANGED:
files/systemd/crimson-osd@.service (+9, -0)
unit_tests/test_actions_add_disk.py (+19, -0)
actions/add_disk.py (+59, -2)
tox.ini (+1, -1)
actions.yaml (+10, -0)
",0.525289,-0.801646,-1.170083,-0.975429,0.495425,-0.153797,0.802404,0.088033,0.212479,0.086418,-0.413957,0.101782,0.312813,0.120293,-0.076037
openstack/kolla,I66476a2b396e2cbe41e68ac51f57aae1806b2ed8,1,1,0.8454,4.3567,0.6883,5,6.0,94,1,Bug Fix,0,0,0,97,0.020991,1.0,0,0.8454,3,4,0,0.8141,2.1125,2.0,-38.95,22.4,1,0,0.2338,1,1.2051,0,272,0,29,0,"Fix CVE-2022-38060

Closes-Bug: #1985784
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+2, -17)
tests/test_set_config.py (+0, -18)
docker/base/sudoers (+2, -0)
doc/source/admin/kolla_api.rst (+4, -18)
releasenotes/notes/bug-1985784-59df54a10a004551.yaml (+16, -0)
",1.94272,1.479508,-0.559874,-1.666604,-0.887314,1.400119,-0.727578,0.207503,0.734086,0.0097,0.773882,0.105195,0.499404,0.092384,0.778258
openstack/octavia,I7fed37a9cd8cc0c3187f57a2551ab7a9d87d33c1,1,0,0,4.7958,0.4333,7,6.0,209,0,Bug Fix,1,0,0,0,0.0,0.8333,0,0.0,7,1,0,0.5828,2.3754,6.14,-10.75,17.96,1,0,1.0,0,1.7273,1,0,0,0,0,"Fix wrong assertion methods

Replace 'has_calls' with 'assert_has_calls'.

Story: 2010284
Task: 46255
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+12, -12)
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+4, -3)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+14, -14)
octavia/tests/unit/cmd/test_driver_agent.py (+19, -10)
octavia/tests/unit/controller/worker/v1/tasks/test_amphora_driver_tasks.py (+1, -1)
octavia/tests/unit/compute/drivers/test_nova_driver.py (+17, -11)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+1, -1)
",-0.378041,-0.033386,-1.031244,-0.178975,0.920889,0.785216,-2.045991,-0.890367,-0.045845,-0.290251,0.120185,-0.573266,-0.272546,0.358132,-0.157824
openstack/kolla-ansible,Ie315004715a1cb5a91dd54bc64b0a8fd0af650ec,0,0,0,5.2933,0.7273,4,5.62,368,0,Doc,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.8333,1.3364,2.0,30.05,14.69,0,0,0.2273,0,1.8492,0,0,0,0,0,"Remove ""distutils"" library

Library ""distutils"" is deprecated in Python 3.10:
https://peps.python.org/pep-0632/

The versions previously referenced using StrictVersion should be old
enough that they will not be used in a Dalmatian deployment:

- Ansible 2.11
- Docker API 1.42, included since Docker engine 23.0.0
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+7, -15)
tests/kolla_container_tests/test_docker_worker.py (+6, -39)
ansible/library/kolla_toolbox.py (+41, -87)
ansible/module_utils/kolla_container_worker.py (+0, -3)
",-1.006941,-0.301976,-0.601466,0.132326,-0.529844,-0.152447,-0.404571,0.679571,-0.257243,0.96048,-0.389841,0.023726,-0.289935,0.496655,0.121955
openstack/python-octaviaclient,I43010cc62d6398e5d6b9669a2231ab0404ce216d,1,0,1.0,2.1972,0.25,2,11.5,189,0,Bug Fix,0,0,0,1,0.066667,0.0,0,0.0,3,2,0,0.1489,1.0,2.5,44.35,16.77,1,0,0.0,1,21.0,0,0,0,0,0,"Fix pool protocols

This patch removes the TERMINATED_HTTPS from the pool protocols, as it
is not supported.

Story 2010290
Task 46263
[SEP]
FILES CHANGED:
releasenotes/notes/fix-pool-protocols-090b2a6f4e82516f.yaml (+4, -0)
octaviaclient/osc/v2/pool.py (+2, -2)
",0.938667,-1.971522,-0.516771,-0.349473,-0.230029,0.727769,-1.401229,0.073405,0.101925,-0.115015,-0.134518,0.180944,-0.31024,0.347819,-0.497366
openstack/ironic-python-agent,I434ce1bf1863ee0f11c4d09918d6d2d8dc065c02,1,0,1.0,3.912,0.0612,2,15.0,437,0,Bug Fix,0,0,0,5,0.010965,0.9167,0,0.9167,4,1,0,0.9231,0.1437,3.0,54.84,14.0,1,0,0.9796,0,8.74,0,0,0,0,0,"Fix failure of bind mount in _install_grub2

When IPA runs _install_grub2, IPA tries to bind mount /dev, /proc and /run
to <temporal directory path root partition mounted>/{dev,proc,run}.
However that bind mount fails because there aren't such mount point path
under temporal directory.
To fix this failure, this patch add mkdir command before bind mount.

Story: 2010292
Task: 46273
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_image.py (+45, -3)
ironic_python_agent/extensions/image.py (+1, -0)
",-0.475269,-0.548653,-0.20707,0.391019,0.259314,-0.01814,0.169703,-0.011725,-0.109005,0.02688,0.207423,-0.401248,0.012321,0.655658,-0.234276
openstack/ironic,If20de2ad4ae4177dea10b7ebfc9a91ca6fbabdb9,1,0,0,3.6109,0.1944,3,15.75,444,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.9524,1.0529,2.67,31.05,15.19,1,0,0.7222,1,12.0,0,0,0,0,0,"Fix nodes stuck at cleaning on Network Service issues

Ironic validates network interface before the cleaning process,
currently invalid parameter is captured but for not others.
There is chance that a node could be stucked at the cleaning
state on networking issues or temporary service down of neutron
service.

This patch adds NetworkError to the exception hanlding to cover
such cases.
[SEP]
FILES CHANGED:
ironic/tests/unit/conductor/test_cleaning.py (+20, -6)
ironic/conductor/cleaning.py (+1, -1)
releasenotes/notes/fix-cleaning-stuck-on-networkerror-4aedbf3673413af6.yaml (+8, -0)
",0.107598,-2.666334,0.385104,0.454182,-0.462754,-0.112954,0.183269,0.040942,0.156236,0.060613,-0.357036,-0.049727,0.363474,0.072825,0.093843
openstack/ansible-role-python_venv_build,I762e36acf76729fd61f28ca1b03bc9f562b5db0a,1,1,0.9355,3.2581,0.24,2,16.6,1221,0,Bug Fix,0,0,0,31,0.040682,1.0,0,0.9355,1,1,0,1.0,0.6343,1.0,37.6,14.11,0,0,0.0,0,46.9615,0,12,0,19,0,"Change default value for venv_wheel_build_enable

With fixing multi-distro support logic, venv_wheel_build_enable logic
stopped working for metal deployments, that have more then 1 host.
Currently, we were checking, that we are not building wheels if build_host
is the same as inventory_hostname. Which is now true for all metal
deployments. However, other hosts do expect wheels to present, which
results in installation failure.

According to the original idea we need to build wheels only when we have
more then 1 host with same arch/distro combination otherwise it does
not make sense to build wheels and faster to install tarball.

To achieve that we build mapping of all distro/arch combinations and
enable wheels building only when there distro-arch combination
is not unique for the host we're playing against.

Despite it might be overkill, as scenario of having only single host
with uniqe distro-arch combination, and overhead of building wheels for
it would be quite small, alternative would be to hardcode `True` for
venv_wheel_build_enable.

Closes-Bug: #1989506
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-os_placement/+/858258
[SEP]
FILES CHANGED:
defaults/main.yml (+3, -1)
vars/main.yml (+16, -5)
",-2.937914,-0.003777,3.301086,-0.69969,-0.239643,0.09322,-0.373005,-0.444298,-0.338321,-0.395332,-0.380034,0.074261,-0.152002,-0.344888,0.132764
openstack/openstack-ansible-os_placement,If1e3eec0c558d1472da7bc3a4e87825e36ba4fdc,1,1,0.9375,1.0986,0.0,2,14.0,244,0,Bug Fix,0,0,0,32,0.040661,1.0,0,0.9375,1,1,0,0,1.0,1.0,2.28,19.89,0,0,0.0,0,81.3333,0,12,0,19,0,"Install git into placement containers

If venv_wheel_build_enable is defined to False, placement will fail to
clone and install repositories due to missing git binary.

Related-Bug: #1989506
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
vars/debian.yml (+1, -0)
",-0.030717,-0.797283,-0.793354,-0.216279,-0.314812,-0.003039,-1.17147,0.020058,0.118259,-0.116187,-0.026598,-0.34023,0.130227,0.034517,-0.05501
openstack/openstack-ansible,If5a3cc712898b583a7e664f08c019a937d28e780,1,0,0.9394,1.0986,0.0,1,11.0,284,0,Feature,0,0,0,33,0.041825,0.0,0,0.0,1,1,0,0.9565,0.0,1.0,11.09,14.1,0,0,0.0,0,94.6667,0,0,0,0,0,"Include install_method variables for openrc

In keystone playbok we're trying to run openrc against
openstack_service_setup_host. However, we always fallback to default as
this variable is defined only in install_method var file.
[SEP]
FILES CHANGED:
playbooks/os-keystone-install.yml (+2, -0)
",1.0444,-1.340322,0.041908,0.052019,0.220141,-0.550104,0.350874,-0.176922,-0.19844,-0.533867,-0.03554,-0.431032,-0.591388,-0.422751,0.083947
openstack/openstack-ansible-os_nova,If33021bd0453be3ca18753777e82da12f470b278,1,1,0.9412,1.0986,0.5,1,14.5,262,0,Bug Fix,0,0,0,34,0.042984,1.0,0,0.9412,1,1,0,1.0,0.0,1.0,20.0,15.46,0,0,0.0,0,87.3333,0,6,0,12,0,"Add new line after proxyclient_address

Currently Jinja trim_blocks function does remove newline from end of
proxyclient_address which makes port_range option appearing on the same
line.

Closes-Bug: #1988337
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -1)
",1.029924,-0.939668,0.098477,-0.052744,-0.038775,0.317946,-0.53032,-0.203599,0.556329,-0.434907,-0.066753,-0.492187,-0.234057,0.121491,0.133886
openstack/openstack-ansible-galera_server,I4181691ba3b23c5195b3cee3699637ece94187db,1,0,0.9429,5.0876,0.9938,3,6.0,182,0,Feature,0,0,0,35,0.044136,1.0,0,0.9429,1,1,0,1.0,1.0827,1.0,52.7,10.73,0,0,0.0,0,1.1235,0,0,0,0,0,"Bump mariadb version to 10.6.10

With that we also able to use MariaDB provided repo for
Ubuntu 22.04 and CentOS Stream/Rocky 9
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+0, -76)
vars/ubuntu-22.04.yml (+0, -83)
defaults/main.yml (+1, -1)
",1.241098,-1.142248,-0.369828,-0.684243,-0.246899,-0.11575,0.053888,1.161325,-1.103221,0.43109,-0.368301,0.393078,-0.530528,0.010177,0.02178
openstack/octavia,I3fda3d18cea0e22e2999481551429122619b2144,1,0,0.6667,3.8712,0.0,2,4.0,69,0,Feature,0,0,0,15,0.018428,1.0,0,0.6667,0,2,0,0.5842,0.9035,0.0,-51.02,31.6,1,0,0.0,0,1.4375,0,0,0,0,0,"Add pre-commit
[SEP]
FILES CHANGED:
.pre-commit-config.yaml (+32, -0)
HACKING.rst (+15, -0)
",4.931648,2.579268,2.516441,0.25215,-0.15979,1.023201,1.093901,-0.342018,0.688262,-0.33512,-0.330499,0.3623,0.335492,1.058015,0.071645
openstack/openstack-ansible-os_ceilometer,Idb8555a98e412cde15a5a328a4a7471202aaf6c3,1,0,0,1.0986,0.5,1,9.67,228,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,16.15,14.9,1,0,0.0,0,76.0,0,0,0,0,0,"Fix wrong pathname in pre install task

/etc/cinder was used instead of /etc/ceilometer in the task
that removes config directory. So the config directory was
never removed.
[SEP]
FILES CHANGED:
tasks/ceilometer_pre_install.yml (+1, -1)
",1.463638,-0.894524,0.417392,0.250167,-0.195116,0.036575,0.550665,-0.299106,-0.50896,-0.443271,-0.121693,-0.366629,-0.564796,0.550316,0.059861
openstack/kolla-ansible,I35e7d3072c6340f4ecbe02f8961158bcb663954e,1,1,0.975,2.1972,0.125,2,4.2,309,0,Bug Fix,0,0,0,40,0.062992,0.0,0,0.0,4,2,0,0.8299,0.8113,3.0,-111.66,16.92,1,0,0.0,1,34.3333,0,6,0,24,0,"Fix interface option for ironic-neutron-agent

The correct option to use is valid_interfaces [1], not os_endpoint_type.

[1] https://docs.openstack.org/networking-baremetal/latest/configuration/ironic-neutron-agent/config.html#ironic

Closes-Bug: #1990675
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/ironic_neutron_agent.ini.j2 (+1, -1)
releasenotes/notes/ironic-neutron-agent-interface-75fd4fbb1d3eb843.yaml (+6, -0)
",-0.659918,2.301756,-1.298093,0.626719,-0.445357,-0.638057,0.22272,0.349602,0.312964,-0.316121,-0.238126,-0.27433,-0.055616,-0.043167,0.10174
openstack/kolla-ansible,I12c451077114b77b11810f25eb5b6187cdf08ad9,1,1,0.9756,2.0794,0.1429,2,11.0,119,0,Bug Fix,0,0,0,41,0.063764,0.5,0,0.4878,4,2,0,0.8306,0.8631,3.0,26.47,18.95,1,0,0.0,1,14.875,0,6,0,13,0,"Fix Ironic API healthcheck with backend TLS

Closes-Bug: #1990819
[SEP]
FILES CHANGED:
ansible/roles/ironic/defaults/main.yml (+1, -1)
releasenotes/notes/ironic-api-backend-tls-healthcheck-481b69116b072913.yaml (+5, -0)
",2.139337,-0.686615,-0.129876,-1.461966,-0.721152,0.638201,-0.98895,0.892662,0.160084,-0.286269,0.390582,-0.211255,0.361705,-0.613781,0.275229
openstack/charm-mysql-innodb-cluster,Ie3b71a60e4c7afda48114a53cce9cf713b933d71,1,1,0,1.9459,0.1667,2,18.83,860,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0,1.0,2.5,29.0,15.67,0,0,0.5,0,122.8571,0,6,0,7,0,"mysqldump: add --set-gtid-purged=COMMENTED to mysqldump command

The backup file taken from a charm-managed mysql instance contains
""@@GLOBAL.GTID_PURGED"" variable at the beginning, which causes
restore operation to fail with the following message: ""Cannot
update GTID_PURGED with the Group Replication plugin running"".
The workaround for this issue is to supply ""--set-gtid-purged=OFF""
to command, which omits the ""GTID_PURGED"" from the mysqldump output.

This patch fixes the issue by adding ""--set-gtid-purged=COMMENTED""
to mysqldump command, which causes  mysqldump to emit the GTID_PURGED
variable as a commented out line. In this way, we don't lose the
GTID_PURGED variable information which may be needed in some scenarios
and can be un-commented out before restoring if needed.

Closes-bug: 1989975
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+3, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+2, -1)
",-3.939759,1.09251,2.239002,-0.420918,0.98571,0.539807,-0.553044,-0.405279,0.042051,-0.325344,0.391724,0.187691,-0.138363,0.162469,0.37569
openstack/kolla-ansible,Ie4c2ac4d5e990ebdc30c3a94d855703d814f1fee,1,0,0.9231,2.1972,0.125,3,6.83,338,0,Bug Fix,0,0,0,13,0.017128,0.0,0,0.0,4,3,0,0.8313,1.2988,3.33,43.08,10.54,0,0,0.0,1,37.5556,0,0,0,0,0,"Specify number of threads for designate bind9 backend

Bind9 is running without limit for UDP listeners.
This patch is changing this behaviour and sets max 32
of UDP listeners. This is needed because of bug below [1].

[1] https://bugs.launchpad.net/ubuntu/+source/bind9/+bug/1827923
[SEP]
FILES CHANGED:
releasenotes/notes/new-variable-designate-backend-bind9-workers-cfd4676196410c6a.yaml (+5, -0)
ansible/roles/designate/defaults/main.yml (+1, -0)
ansible/roles/designate/templates/designate-backend-bind9.json.j2 (+1, -1)
",-0.592332,0.401755,-0.606317,0.44584,-0.87126,0.345336,0.181929,0.038494,0.19566,0.596538,-0.183377,-0.377967,0.465088,-0.319831,-0.111849
openstack/openstack-ansible-os_cinder,Ifceb2b816199339ec7725bd95cc890595eed95d9,1,0,0.9444,2.7081,0.0714,3,7.33,348,0,Bug Fix,0,0,0,36,0.037736,1.0,0,0.9444,1,2,0,1.0,1.1488,1.0,43.65,9.3,1,0,0.1429,1,23.2,0,0,0,0,0,"Add nfs and ceph jobs to templates

With changing cinder code we potentially can break some backends.
In order to detect this in time we are adding ceph and nfs scenarios.

We also fix lvm backend for use on RedHat.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/859339
[SEP]
FILES CHANGED:
tasks/cinder_post_install.yml (+10, -0)
vars/redhat.yml (+1, -1)
zuul.d/project.yaml (+2, -0)
",-0.708586,0.557831,-0.550925,0.267151,-0.928545,-0.394343,0.569627,0.010262,-0.195314,0.072255,-0.197923,-0.237817,0.477651,-0.290225,0.062935
openstack/ironic,I2860faa7322116ffef1255709fe12f806257b069,1,0,0,3.5553,0.3529,3,12.5,186,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.9531,1.0117,2.67,41.87,13.0,1,0,0.0882,1,5.3143,0,0,0,0,0,"Fix the anaconda deploy for the ISO mounted

Fix the anaconda deploy for the ISO mounted
on a webserver.

Story: 2010322
Task: 46429
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_images.py (+2, -1)
releasenotes/notes/fix_anaconda-70f4268edc255ff4.yaml (+5, -0)
ironic/common/images.py (+15, -11)
",0.434013,-1.138776,-0.645572,-0.107802,-0.052699,0.38353,-0.594304,0.183435,0.155098,-0.349744,0.226908,0.607928,0.013545,0.864546,-0.147747
openstack/charm-neutron-api-plugin-arista,I7e0867346e59a09ce6471739eea4bf2610722a91,1,1,0,1.3863,0.3333,1,8.0,155,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,18.94,18.2,1,0,0.0,1,38.75,0,6,0,9,0,"Charm use virtualenv

All reactive charms should use a venv wherever possible.

Related-Bug: #1991149
[SEP]
FILES CHANGED:
src/layer.yaml (+2, -1)
",1.248543,-0.947768,-0.393288,-0.326149,-0.36653,0.58795,-1.056841,0.025753,-0.146721,-0.191621,-0.014088,-0.007296,-0.097206,0.060549,-0.104705
openstack/kolla-ansible,Ife87ee0241d907a0c407eb21811a354ed1734408,1,1,0.8469,2.7081,0.0714,2,10.92,1097,0,Bug Fix,0,0,0,98,0.02086,0.75,0,0.6352,4,2,0,0.832,0.3712,3.0,27.74,10.85,1,0,0.0,1,73.1333,0,10,0,14,0,"Fix image from volume upload ERRORs and WARNINGs with Ceph RBD

By resetting image_upload_use_cinder_backend to upstream default.

When uploading volume to glance image, cinder looks at the backend's
image_upload_use_cinder_backend config knob to decide whether to try link
the glance image to a cloned volume made by cinder, i.e. by doing all work
locally and only updating glance's locations for the image (when the knob
is set to True). However, after all [1], [2] and [3], which happens since
Victoria, this option requires further config from user (using volume type
with image_service:store_id property (aka extra spec) set to the desired
glance store (even if there is only one cinder store configured).

Please read the bug report as to why the option removal is the
best option (TL;DR it is the most compatible approach).

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/708114
[2] https://review.opendev.org/c/openstack/glance_store/+/746556
[3] https://review.opendev.org/c/openstack/cinder/+/661676

Closes-Bug: #1991516
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1991516-cc280aa71e8dc417.yaml (+13, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -1)
",-3.276696,1.826478,3.028664,-0.454624,-0.315538,0.451988,0.024843,-0.220569,-0.143432,-0.410832,-0.163699,0.025091,-0.109172,-0.153253,-0.183804
openstack/charm-rabbitmq-server,I19e3d675ace7c669451ca40a20d21cef1aec6a95,1,1,0,4.7274,0.0357,5,21.0,425,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,2,0,1.0,2.0107,1.0,35.12,15.38,1,0,0.5089,0,3.7611,0,38,0,7,0,"Allow NRPE to collect stats in CIS hardened env

It removes the necessity to run the cron task as root user
and ensure the content created in /var/lib/rabbitmq belongs
to rabbitmq user and group solely.

Then giving access for nrpe user is done by adding its user
to rabbitmq group.
Also implemented in the upgrade-charm hook for ongoing
deployments

Closes-Bug: #1879524
[SEP]
FILES CHANGED:
unit_tests/test_rabbitmq_server_relations.py (+16, -1)
unit_tests/test_rabbit_utils.py (+40, -0)
files/collect_rabbitmq_stats.sh (+4, -2)
hooks/rabbitmq_server_relations.py (+10, -0)
hooks/rabbit_utils.py (+38, -1)
",-0.633378,-1.793229,0.066788,-0.091215,0.007085,-0.5532,0.176443,0.417087,-0.175509,-0.294516,-0.014709,-0.217108,-0.027398,0.198216,-0.0988
openstack/charm-octavia,I5cda72d55b7aba51d087bababa94435e53c2201b,1,1,1.0,1.3863,0.0,2,8.5,359,0,Bug Fix,0,0,0,1,0.5,0.0,0,0.0,2,1,0,0,0.9183,1.5,-10.8,17.52,1,0,0.6667,0,89.75,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit e237d6621eec7734a18dae52618030c30a21c9b8)
Depends-On: https://review.opendev.org/c/openstack/charm-octavia/+/858664
[SEP]
FILES CHANGED:
src/reactive/octavia_handlers.py (+1, -0)
unit_tests/test_octavia_handlers.py (+2, -0)
",-0.749938,-1.720504,-1.335149,-1.534905,0.354885,0.117831,0.147494,0.032414,0.150432,0.441131,-0.368554,0.176954,0.25613,0.160885,0.20846
openstack/charm-octavia,I5cda72d55b7aba51d087bababa94435e53c2201b,1,1,1.0,1.3863,0.0,2,16.0,285,0,Bug Fix,0,0,0,2,0.4,1.0,0,1.0,2,1,0,1.0,0.9183,1.5,10.82,18.9,1,0,0.6667,0,71.25,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit e237d6621eec7734a18dae52618030c30a21c9b8)
[SEP]
FILES CHANGED:
src/reactive/octavia_handlers.py (+1, -0)
unit_tests/test_octavia_handlers.py (+2, -0)
",-0.749938,-1.720504,-1.335149,-1.534905,0.354885,0.117831,0.147494,0.032414,0.150432,0.441131,-0.368554,0.176954,0.25613,0.160885,0.20846
openstack/charm-barbican,I3a9d0211bede8db43cd5ae8e0db51736155282f6,1,1,1.0,1.6094,0.0,2,16.0,285,0,Bug Fix,0,0,0,3,0.375,0.0,0,0.0,2,1,0,0,0.8113,1.5,18.75,18.9,1,0,0.75,0,57.0,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit 6d73c8263f5ad520a75c2fc6207bba65136ef6f3)
[SEP]
FILES CHANGED:
src/reactive/barbican_handlers.py (+1, -0)
unit_tests/test_barbican_handlers.py (+3, -0)
",-0.750856,-1.243766,-1.413069,-1.492148,0.314959,0.167731,0.352425,-0.00734,0.237278,0.322555,-0.299508,0.057093,0.228718,0.099937,0.205382
openstack/charm-barbican,I3a9d0211bede8db43cd5ae8e0db51736155282f6,1,1,1.0,1.6094,0.0,2,16.0,285,0,Bug Fix,0,0,0,4,0.333333,1.0,0,1.0,2,1,0,1.0,0.8113,1.5,18.75,18.9,1,0,0.75,0,57.0,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit 6d73c8263f5ad520a75c2fc6207bba65136ef6f3)
[SEP]
FILES CHANGED:
src/reactive/barbican_handlers.py (+1, -0)
unit_tests/test_barbican_handlers.py (+3, -0)
",-0.750856,-1.243766,-1.413069,-1.492148,0.314959,0.167731,0.352425,-0.00734,0.237278,0.322555,-0.299508,0.057093,0.228718,0.099937,0.205382
openstack/charm-barbican,I3a9d0211bede8db43cd5ae8e0db51736155282f6,1,1,1.0,1.6094,0.0,2,16.0,285,0,Bug Fix,0,0,0,5,0.3125,1.0,0,1.0,2,1,0,1.0,0.8113,1.5,18.75,18.9,1,0,0.75,0,57.0,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit 6d73c8263f5ad520a75c2fc6207bba65136ef6f3)
[SEP]
FILES CHANGED:
src/reactive/barbican_handlers.py (+1, -0)
unit_tests/test_barbican_handlers.py (+3, -0)
",-0.750856,-1.243766,-1.413069,-1.492148,0.314959,0.167731,0.352425,-0.00734,0.237278,0.322555,-0.299508,0.057093,0.228718,0.099937,0.205382
openstack/charm-barbican,I3a9d0211bede8db43cd5ae8e0db51736155282f6,1,1,1.0,1.6094,0.0,2,16.0,285,0,Bug Fix,0,0,0,6,0.3,1.0,0,1.0,2,1,0,1.0,0.8113,1.5,18.75,18.9,1,0,0.75,0,57.0,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit 6d73c8263f5ad520a75c2fc6207bba65136ef6f3)
[SEP]
FILES CHANGED:
src/reactive/barbican_handlers.py (+1, -0)
unit_tests/test_barbican_handlers.py (+3, -0)
",-0.750856,-1.243766,-1.413069,-1.492148,0.314959,0.167731,0.352425,-0.00734,0.237278,0.322555,-0.299508,0.057093,0.228718,0.099937,0.205382
openstack/charm-barbican,I3a9d0211bede8db43cd5ae8e0db51736155282f6,1,1,1.0,1.6094,0.0,2,16.0,285,0,Bug Fix,0,0,0,7,0.291667,1.0,0,1.0,2,1,0,1.0,0.8113,1.5,18.75,18.9,1,0,0.75,0,57.0,0,6,0,21,0,"Ensure upgrades are executed

Prior to this change, big bang upgrades were not being run
when openstack-origin was updated to a new release.

Closes-Bug: #1979553
(cherry picked from commit 6d73c8263f5ad520a75c2fc6207bba65136ef6f3)
[SEP]
FILES CHANGED:
src/reactive/barbican_handlers.py (+1, -0)
unit_tests/test_barbican_handlers.py (+3, -0)
",-0.750856,-1.243766,-1.413069,-1.492148,0.314959,0.167731,0.352425,-0.00734,0.237278,0.322555,-0.299508,0.057093,0.228718,0.099937,0.205382
openstack/kayobe,Ie9b9c49c3f382612a11a6184c30f11c57d40494d,1,0,1.0,2.1972,0.0,2,9.0,233,0,Feature,0,0,0,2,0.044444,1.0,0,1.0,4,2,0,0.9367,0.9544,3.0,37.9,12.49,0,0,0.0,1,25.8889,0,0,0,0,0,"Add prometheus-msteams group to kayobe

This adds the prometheus-msteams group into
overcloud-services.j2 as it's missing and has been added
in the yoga release to kolla-ansible.
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/overcloud-services.j2 (+3, -0)
releasenotes/notes/fix-add-msteams-group-to-kayobe--bfd2a5030b6955d2.yaml (+5, -0)
",0.940587,-0.120382,-0.766265,0.361994,-0.015309,-0.77055,0.73264,0.301257,-0.415518,-0.521646,0.111923,0.455317,-0.546297,0.326738,0.347246
openstack/charm-cinder,Iee99e9ab9777392f05c1a0db55951d97773bb0ba,1,0,1.0,4.0254,0.0909,2,16.33,652,0,CI,0,0,0,1,0.25,0.0,0,0.0,1,1,0,0,0.8921,1.0,38.32,13.47,1,0,0.3091,0,11.6429,0,0,0,0,0,"Retry online_data_migrations until exit code 0 or 2.

The command 'cinder-manage db online_data_migrations' has three possible
exit codes:

- 0: The migrations have been completed successfully.
- 1: Some migrations have been completed, but more objects need to be
  migrated.
- 2: Some migrations are generating errors and manual intervention is
  needed.

This change will run in a loop the command online_data_migrations in
batches of 5000 objects, when the exit code is 1 runs again, when the
exit code is 0 the loop is stopped, when the exit code is 2 a
CalledProcessError exception is raised.
[SEP]
FILES CHANGED:
unit_tests/test_cinder_utils.py (+15, -2)
hooks/cinder_utils.py (+35, -3)
",-2.405031,-0.68456,0.865065,0.432942,0.218074,0.283207,-0.375404,-0.148491,0.034518,0.456816,0.299637,0.047235,-0.055356,0.686657,0.244678
openstack/kolla,I3651576ee354364d639c187ff750491667ecab56,1,1,0.8125,2.3026,0.0,2,8.33,475,1,Bug Fix,0,0,0,16,0.030019,0.0,0,0.0,2,2,0,0.8153,0.7642,2.0,13.95,16.13,1,0,0.0,1,47.5,0,272,0,29,0,"Fix Swift deployment issue

Swift deployment is broken since CVE-2022-38060 fixed sudoers file in
the I66476a2b396e2cbe41e68ac51f57aae1806b2ed8. The kolla-toolbox
container have their own virtualenv path differs from all other
containers. This change adds the correct sudoers secure_path
configuration needed only for kolla-toolbox conainer.

Related-Bug: #1985784
[SEP]
FILES CHANGED:
releasenotes/notes/swift-sudo-issue-84d37919c980a373.yaml (+7, -0)
docker/kolla-toolbox/ansible_sudoers (+2, -0)
",-0.857623,-1.037757,-0.700393,-0.97763,0.526378,-0.444255,0.388286,0.538026,0.274089,0.009897,-0.227542,0.145014,0.044925,0.097398,0.218069
openstack/ironic,Id6262654bb5e41e02c7d90b9a9aaf395e7b6a088,1,0,1.0,3.6109,0.4722,4,19.0,176,0,Bug Fix,0,0,0,1,0.028571,1.0,0,1.0,5,2,0,0.9538,1.8512,3.25,-8.37,20.23,1,0,0.2778,1,4.7568,0,0,0,0,0,"Fixes Secureboot with Anaconda deploy

Fixes Secureboot with Anaconda deploy with PXE and iPXE

Story:2010356
Task: 46529
[SEP]
FILES CHANGED:
ironic/drivers/modules/pxe_base.py (+4, -3)
ironic/drivers/modules/pxe.py (+3, -12)
ironic/tests/unit/drivers/modules/test_pxe.py (+8, -2)
releasenotes/notes/fix_secure_boot_with_anaconda_deploy-84d7c1e3bbfa40f2.yaml (+4, -0)
",-0.188238,-0.189684,-1.156393,-0.250624,0.712662,0.600091,-1.367241,0.428651,-0.685193,-0.145797,0.490651,0.435475,0.463044,0.276509,-0.229564
openstack/ironic,I383cdd5c9d45b074d351ec98b1145fd68e2f3ac3,1,0,1.0,4.5643,0.0,3,26.0,213,0,Feature,0,0,0,2,0.028169,1.0,0,1.0,6,2,0,0.9545,0.8342,4.0,11.25,19.63,1,0,0.8211,1,2.2188,0,0,0,0,0,"Enables boot modes switching with Anaconda deploy for ilo driver

Enables boot modes switching with Anaconda deploy for ilo driver

Story: 2010357
Task: 46530
[SEP]
FILES CHANGED:
releasenotes/notes/fix_boot_mode_switch_with_anaconda_deploy_with_ilo_drivers-16637adb62f0ed2f.yaml (+5, -0)
ironic/drivers/modules/ilo/boot.py (+12, -0)
ironic/tests/unit/drivers/modules/ilo/test_boot.py (+78, -0)
",-0.309562,-0.557433,-0.780606,0.394699,0.794731,0.334136,-1.067946,0.465024,-0.500281,-0.099878,0.254901,0.567616,0.396019,-0.207659,-0.071794
openstack/kolla-ansible,Id6ef88bb8cd16120bf31da679d1129d99f4b9fd8,0,0,0.9,1.9459,0.1667,2,21.0,175,0,Feature,0,0,0,40,0.047004,0.0,0,0.0,4,2,0,0.8327,0.9183,2.0,28.41,19.83,0,0,0.0,0,25.0,0,0,0,0,0,"Skip ansible-lint fqcn for module actions and role-name

Add noqa for:
Object of type PosixPath is not JSON serializable
[SEP]
FILES CHANGED:
ansible/roles/elasticsearch/tasks/upgrade.yml (+1, -1)
.ansible-lint (+4, -0)
",2.452064,-1.428587,0.690671,-0.195708,-0.289728,-0.966987,0.211781,0.245328,0.59143,-0.386546,-0.340443,-0.263185,-0.284721,0.089859,-0.461722
openstack/kolla,Iec7e8461f9eb757e1576cf3898068306c5436239,1,0,0.6491,3.6376,0.5946,4,6.6,316,0,CI,0,0,0,57,0.027325,0.8333,0,0.5409,2,4,0,0.8165,1.7705,2.0,5.3,12.34,0,0,0.0,1,8.3158,0,0,0,0,0,"rabbitmq: use Erlang from PPA on Debian/Ubuntu

PPA from Team RabbitMQ [1] provides newer Erlang for Debian/Ubuntu.

This way we have latest Erlang on both distributions and both
architectures.

1. https://launchpad.net/~rabbitmq/+archive/ubuntu/rabbitmq-erlang
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+0, -6)
docker/base/apt_preferences.debian (+0, -6)
docker/base/Dockerfile.j2 (+3, -3)
kolla/template/repos.yaml (+12, -7)
",-1.043478,0.594597,-0.821073,0.225349,-0.310872,-0.314573,0.041322,1.013582,-0.679084,0.428127,-0.091386,-0.344197,0.050834,-0.274043,-0.142311
openstack/octavia,Ie739cd582103d1aab3021c56654e395b5919358f,1,1,0.7215,1.7918,0.2,2,7.8,379,0,Bug Fix,0,0,0,79,0.007145,0.0,0,0.0,3,2,0,0.5856,0.971,2.5,10.19,13.38,0,0,0.0,0,63.1667,0,8,0,19,0,"Fix prometheus-proxy service name in Red Hat-based distros

The prometheus-proxy service is called octavia-prometheus-proxy in RDO's
RPMs [0].
Add a svc-map for the service name to fix the amphora-agent element for
these distros.

[0] https://review.rdoproject.org/r/c/openstack/octavia-distgit/+/44152

Partial-Bug: 1992668
[SEP]
FILES CHANGED:
elements/amphora-agent/post-install.d/12-enable-prometheus-proxy-systemd (+1, -1)
elements/amphora-agent/svc-map (+3, -0)
",-0.972134,1.050264,-0.469565,-0.062754,-0.660019,-0.590067,0.356293,0.555087,-0.051811,-0.344785,0.286177,-0.269818,0.159717,0.066282,-0.241767
openstack/kayobe,Id48a63ba5a85d4745b7e0a905a9195ad0dc7a751,1,0,0.878,1.0986,0.5,1,2.0,171,0,Feature,0,0,0,41,0.047841,0.8333,0,0.7317,0,1,0,0.9375,0.0,0.0,-108.21,16.8,0,0,0.0,0,57.0,0,0,0,0,0,"Bump mrlesmithjr.lvm to skip swap resizes

See https://github.com/mrlesmithjr/ansible-manage-lvm/releases/tag/v0.2.7
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
",-0.149819,4.278585,-2.137395,0.731024,-0.171239,-0.159461,0.331696,-0.123381,0.005389,-0.353501,-0.386441,0.256472,-0.597645,-0.21108,0.488651
openstack/kolla-ansible,I6fc7842bcda18e417a3fd21c11e28979a470f1cf,0,0,0.8667,7.8575,0.983,79,13.0,633,0,Feature,0,0,0,15,0.014691,1.0,0,0.8667,6,6,0,0.8293,4.8558,4.05,37.46,13.55,1,0,0.0762,1,0.2449,0,0,0,0,0,"Remove support for deploying OpenStack Monasca

Kolla Ansible is switching to OpenSearch and is dropping support for
deploying ElasticSearch. This is because the final OSS release of
ElasticSearch has exceeded its end of life.

Monasca is affected because it uses both Logstash and ElasticSearch.
Whilst it may continue to work with OpenSearch, Logstash remains an
issue.

In the absence of any renewed interest in the project, we remove
support for deploying it. This helps to reduce the complexity
of log processing configuration in Kolla Ansible, freeing up
development time.
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron-logrotate-monasca.conf.j2 (+0, -3)
ansible/roles/horizon/defaults/main.yml (+0, -1)
README.rst (+0, -1)
ansible/site.yml (+0, -24)
ansible/roles/monasca/tasks/bootstrap.yml (+0, -108)
ansible/roles/monasca/tasks/pull.yml (+0, -3)
doc/source/reference/logging-and-monitoring/monasca-guide.rst (+5, -428)
ansible/roles/monasca/tasks/register.yml (+0, -8)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/cpu.yaml (+0, -5)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/disk.yaml (+0, -7)
ansible/roles/monasca/templates/monasca-agent-forwarder/agent-forwarder.yml.j2 (+0, -26)
ansible/roles/monasca/templates/monasca-agent-collector/monasca-agent-collector.json.j2 (+0, -24)
ansible/roles/cloudkitty/defaults/main.yml (+2, -5)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/monasca/templates/monasca-persister/monasca-persister.json.j2 (+0, -18)
ansible/roles/monasca/templates/monasca-thresh/storm.yml.j2 (+0, -1)
zuul.d/nodesets.yaml (+0, -16)
ansible/roles/monasca/tasks/precheck.yml (+0, -46)
etc/kolla/globals.yml (+6, -8)
ansible/roles/monasca/tasks/copy-certs.yml (+0, -6)
releasenotes/notes/deprecate-monasca-9f6075d447e939d4.yaml (+6, -1)
ansible/roles/monasca/templates/monasca-notification/monasca-notification.json.j2 (+0, -25)
ansible/roles/monasca/templates/monasca-thresh/thresh-config.yml.j2 (+0, -170)
ansible/roles/monasca/tasks/deploy.yml (+0, -13)
ansible/roles/elasticsearch/defaults/main.yml (+1, -1)
ansible/roles/common/tasks/config.yml (+2, -8)
ansible/roles/grafana/defaults/main.yml (+0, -9)
ansible/roles/monasca/tasks/loadbalancer.yml (+0, -7)
tests/templates/globals-default.j2 (+0, -6)
ansible/roles/monasca/tasks/check.yml (+0, -1)
ansible/roles/monasca/vars/main.yml (+0, -2)
ansible/roles/monasca/templates/monasca-persister/persister.conf.j2 (+0, -27)
doc/source/reference/rating/cloudkitty-guide.rst (+0, -8)
ansible/roles/monasca/templates/monasca-agent-statsd/monasca-agent-statsd.json.j2 (+0, -18)
ansible/roles/monasca/templates/monasca-log-persister/elasticsearch-template.json (+0, -56)
ansible/roles/monasca/templates/monasca-notification/notification.conf.j2 (+0, -24)
tests/templates/inventory.j2 (+0, -48)
ansible/roles/monasca/tasks/deploy-containers.yml (+0, -2)
zuul.d/jobs.yaml (+0, -7)
tests/test-monasca.sh (+0, -84)
ansible/roles/monasca/tasks/config.yml (+0, -331)
ansible/roles/monasca/tasks/reconfigure.yml (+0, -2)
ansible/roles/monasca/templates/monasca-agent-statsd/agent-statsd.yml.j2 (+0, -12)
ansible/roles/common/templates/conf/input/09-monasca.conf.j2 (+0, -12)
ansible/roles/monasca/tasks/check-containers.yml (+0, -18)
ansible/roles/monasca/tasks/upgrade.yml (+0, -27)
ansible/roles/kafka/templates/kafka.server.properties.j2 (+0, -4)
ansible/roles/monasca/tasks/bootstrap_service.yml (+0, -20)
tests/check-failure.sh (+0, -6)
ansible/roles/monasca/templates/monasca-thresh/monasca-thresh.json.j2 (+0, -29)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/ntp.yaml (+0, -5)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+0, -19)
ansible/roles/monasca/templates/monasca-api/monasca-api.json.j2 (+0, -32)
ansible/roles/common/templates/conf/filter/00-record_transformer.conf.j2 (+1, -24)
ansible/roles/monasca/defaults/main.yml (+10, -195)
ansible/roles/monasca/tasks/stop.yml (+0, -6)
ansible/roles/monasca/templates/monasca-api/api.conf.j2 (+0, -70)
ansible/roles/common/templates/conf/input/00-global.conf.j2 (+1, -3)
ansible/roles/monasca/tasks/main.yml (+0, -2)
ansible/roles/monasca/handlers/main.yml (+0, -148)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -56)
ansible/roles/monasca/templates/monasca-api/api-config.ini.j2 (+0, -14)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/load.yaml (+0, -5)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/monasca/templates/monasca-log-persister/log-persister.conf.j2 (+0, -47)
etc/kolla/passwords.yml (+0, -4)
tests/run.yml (+2, -9)
tests/setup_gate.sh (+0, -8)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/memory.yaml (+0, -5)
zuul.d/base.yaml (+0, -11)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+1, -6)
ansible/roles/common/templates/conf/output/02-monasca.conf.j2 (+0, -21)
ansible/roles/monasca/templates/monasca-agent-collector/agent-collector.yml.j2 (+0, -9)
ansible/roles/monasca/templates/monasca-agent-collector/plugins/network.yaml (+0, -6)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+0, -6)
ansible/group_vars/all.yml (+7, -33)
ansible/roles/monasca/templates/monasca-log-persister/monasca-log-persister.json.j2 (+0, -24)
ansible/roles/monasca/templates/monasca-api/wsgi-api.conf.j2 (+0, -35)
ansible/roles/monasca/templates/monasca-agent-forwarder/monasca-agent-forwarder.json.j2 (+0, -18)
",-1.139808,-1.445443,0.490697,0.417566,-0.358559,0.161786,0.250155,0.570925,-0.337903,0.096688,0.318851,0.516734,-0.141213,-0.686049,0.098974
openstack/kayobe,I4813a1f6ab9cb566596e806bd0ada6dff342d119,1,0,0.8235,4.1109,0.2333,4,8.17,476,0,Bug Fix,0,0,0,17,0.031365,1.0,0,0.8235,4,4,0,0.9383,1.6023,3.0,-12.09,12.25,1,0,0.0,1,7.8033,0,0,0,0,0,"Fix an issue when user forgot combine custom passwords

Fixes an issue when user forgot to combine
'kolla_ansible_custom_passwords',
'kolla_ansible_default_custom_passwords' and own dictionary with
custom passwords in configuration files. Now
'kolla_ansible_extra_custom_passwords' should provide only user
custom passwords to add or override in the passwords.yml.
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/kolla (+7, -1)
releasenotes/notes/kolla-passwords-overrides-065fd6bb8eb9689d.yaml (+14, -0)
etc/kayobe/kolla.yml (+4, -0)
doc/source/configuration/reference/kolla-ansible.rst (+21, -13)
",-2.398091,0.574572,-0.835232,1.231258,1.535901,-0.065447,-1.087987,-0.405803,-0.18531,-0.377012,-0.091394,-0.944202,-0.009037,0.401824,0.459924
openstack/charm-cinder,I757bf16d2604dd9ffda2ec45c3b98fe09f583d1c,1,0,0,5.8348,0.2463,18,9.25,527,0,CI,0,0,1,0,0.0,0.3333,0,0.0,4,5,0,1.0,3.3492,2.39,65.97,9.11,1,0,0.3226,1,1.5409,0,0,0,0,0,"Updates for zed stable branch creation

- Set default branch for git review/gerrit to stable/zed
- Switch tests to stable.
- Switch to using stable charm-helpers branch.
- Switch to using stable charm.openstack branch.
- Switch to using stable zaza, zaza-openstack-tests
  branch
- (reactive charms) Add build.lock file
- (classic charms) make sync
- (reactive: not reactive plugin): lock charm-tools < 3.1
- (reactive: with reactive plugin): lock charm snap to 3.x/stable
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+3, -3)
charmhelpers/contrib/openstack/ssh_migrations.py (+2, -2)
.gitreview (+2, -0)
test-requirements.txt (+2, -2)
charmhelpers/fetch/ubuntu.py (+16, -2)
charmhelpers/contrib/openstack/ha/utils.py (+29, -0)
charm-helpers-hooks.yaml (+1, -1)
tests/bundles/jammy-zed.yaml (+17, -21)
charmhelpers/contrib/storage/linux/utils.py (+18, -3)
tests/bundles/kinetic-zed.yaml (+17, -17)
charmhelpers/contrib/hahelpers/cluster.py (+1, -1)
charmhelpers/core/host.py (+1, -1)
charmhelpers/contrib/openstack/ip.py (+25, -0)
charmhelpers/contrib/openstack/templates/haproxy.cfg (+5, -0)
charmhelpers/contrib/openstack/context.py (+84, -13)
charmhelpers/contrib/charmsupport/nrpe.py (+16, -0)
charmhelpers/contrib/network/ip.py (+1, -1)
tests/bundles/jammy-yoga.yaml (+17, -17)
",-0.976895,-0.371226,0.541519,0.030207,0.481084,-0.799126,0.10454,0.818095,-0.543309,-0.008582,-0.020363,0.004592,0.83598,0.546798,-0.053189
openstack/octavia,I282fa6a4ce43f0d2cb9cba48b7149ef66ede44fc,1,0,0.725,2.4849,0.0909,2,16.25,834,0,Feature,0,0,0,80,0.007232,0.4615,0,0.3346,4,2,0,0.587,0.9457,3.0,51.08,12.04,0,0,0.0,1,69.5,0,0,0,0,0,"Filter ComputeWaitTimeoutException when jobboard is disabled

A commit [0] has changed the behavior of the task that waits for a
compute server to be active. The task used to have a loop that was
waiting until the server was active, it is now using a Retry feature in
taskflow: the task throws an exception if the server is not active,
taskflow marks the task as failed, but it retries to execute it later
(until a max number of retries).
The exception thrown by the task should be hidden to the user, it is not
a real error, but it is part of the workflow. The exception is correctly
filtered out when jobboard is enabled, but it is not when jobboard is
disabled.

[0] I174e63cfe176e1792d0bbcd348dbc9115544e297

Story https://storyboard.openstack.org/#!/story/2010369
Task 46595
[SEP]
FILES CHANGED:
releasenotes/notes/filter-bogus-exception-when-jobboard-disabled-6f1375463f5a71dc.yaml (+7, -0)
octavia/controller/worker/v2/controller_worker.py (+3, -1)
",-2.536764,-0.965279,1.912543,-0.747224,-0.278354,0.283176,0.670052,-0.277921,0.329137,0.068075,0.509958,0.209302,-0.206734,-0.030602,-0.163056
openstack/openstack-ansible,Iefd4143f83f4df44b917180000a1aa57161b2811,0,0,0.9459,5.7236,0.9115,30,16.67,336,0,Feature,0,0,0,37,0.038223,1.0,0,0.9459,4,8,0,0.9583,4.261,1.67,46.1,12.27,1,0,0.023,1,1.098,0,0,0,0,0,"Remove usage of rsyslog roles

We've switched all services to store logs to journald by default and
rsyslog roles are not used except really small amount of usecases that
also hardly valid as of today. With that we deprecate repos and remove
their usega to reduce maintenance load.
[SEP]
FILES CHANGED:
deploy-guide/source/configure.rst (+0, -3)
playbooks/rsyslog-install.yml (+0, -54)
playbooks/repo-install.yml (+0, -14)
doc/source/reference/architecture/service-arch.rst (+0, -6)
playbooks/ceph-install.yml (+0, -14)
playbooks/setup-infrastructure.yml (+0, -1)
playbooks/common-tasks/rsyslog-client.yml (+0, -22)
etc/openstack_deploy/openstack_user_config.yml.pod.example (+0, -5)
playbooks/os-tempest-install.yml (+0, -7)
releasenotes/notes/remove_rsyslog_roles-05893ed9f8534a39.yaml (+13, -0)
playbooks/containers-lxc-host.yml (+0, -7)
inventory/inventory.ini (+0, -4)
deploy-guide/source/run-playbooks.rst (+2, -2)
etc/openstack_deploy/env.d/aio_metal.yml.example (+0, -3)
playbooks/qdrouterd-install.yml (+0, -7)
scripts/log-collect.sh (+0, -1)
etc/openstack_deploy/openstack_user_config.yml.prod-ceph.example (+0, -5)
playbooks/ceph-rgw-install.yml (+0, -7)
inventory/env.d/rsyslog.yml (+0, -36)
inventory/group_vars/all/all.yml (+0, -5)
doc/source/contributor/role-maturity-matrix.html (+11, -16)
ansible-role-requirements.yml (+0, -12)
etc/openstack_deploy/openstack_user_config.yml.singlebond.example (+0, -5)
playbooks/healthcheck-infrastructure.yml (+1, -1)
etc/openstack_deploy/openstack_user_config.yml.prod.example (+0, -5)
etc/openstack_deploy/openstack_user_config.yml.multibond.example (+0, -5)
etc/openstack_deploy/openstack_user_config.yml.provnet-group.example (+0, -5)
inventory/group_vars/rsyslog.yml (+0, -19)
tests/test_inventory.py (+0, -3)
zuul.d/jobs.yaml (+0, -4)
",0.392283,-1.551058,-0.125011,0.70611,-0.217907,-0.218878,0.611052,-0.351533,-0.633975,0.071729,-0.308754,-0.055842,-0.044152,-0.549343,-0.088621
openstack/charm-ceph-dashboard,I95c02baa4869db4ef64a5c09a8b442b5fc07f4da,1,1,0,1.0986,0.5,1,6.5,214,0,Bug Fix,0,0,1,0,0.0,0.225,1,0.0,0,1,0,0,0.0,0.0,34.29,13.37,1,0,0.0,0,71.3333,0,8,0,4,0,"Pin operator library

The operator 1.5.3 testing harness doesn't work with this charms
tests; pinning operator until we have a proper fix.

Closes-Bug: #1993092
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
",1.265038,-1.683115,-0.202397,-0.772766,-0.971696,0.256993,-0.28756,0.143681,-0.426566,0.194045,0.006953,-0.081477,0.008165,-0.129737,0.504311
openstack/charm-ceph-radosgw,I38ed7b431b3454de0b332cd15a3abc02fb12b59e,1,0,1.0,3.8501,0.0435,10,4.0,73,0,Feature,0,0,0,1,0.04,0.0,0,0.0,5,4,0,1.0,3.1603,4.8,-51.02,31.6,1,0,0.0,1,1.5532,0,0,0,0,0,"charm-helpers sync
[SEP]
FILES CHANGED:
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend (+2, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+3, -0)
hooks/charmhelpers/contrib/openstack/utils.py (+6, -1)
hooks/charmhelpers/contrib/storage/linux/ceph.py (+3, -1)
hooks/charmhelpers/contrib/openstack/templates/haproxy.cfg (+4, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken (+3, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
hooks/charmhelpers/contrib/openstack/context.py (+9, -0)
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend.conf (+2, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",3.501926,1.620372,1.163207,-0.041102,0.248027,-0.736437,0.308286,0.061896,0.157114,-0.329003,0.084093,-0.519345,0.028941,0.844211,0.12554
openstack/kolla-ansible,I6d76f342a7cdbcc61d1522689ea489b60353adcd,1,0,0.8571,1.0986,0.5,1,6.6,301,0,Bug Fix,0,0,0,7,0.058333,0.6452,0,0.553,2,1,0,0.8259,0.0,2.0,7.86,15.97,0,0,0.0,0,100.3333,0,0,0,0,0,"designate: Enable Sink only when designate is enabled

A recent patch [1] enabled sink related changes to nova/neutron even
when designate is not enabled. This patch fixes that.

[1] - https://review.opendev.org/c/openstack/kolla-ansible/+/802301
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",-0.304242,1.291655,-0.921363,0.226241,-0.984897,-0.088185,0.420729,0.278114,-0.053678,0.371422,-0.018565,-0.183712,0.210602,-0.433974,-0.195127
openstack/openstack-ansible,I8c36196cd4b35de98cc3c1cabd8c8c2e03ecdae7,0,0,1.0,2.3979,0.5,2,7.0,342,0,CI,0,0,0,2,0.181818,0.0,0,0.0,3,2,0,0.92,1.0,2.5,-3.31,13.09,0,0,0.0,1,31.0909,0,0,0,0,0,"Do not enable glance_show_multiple_locations

According to my tests, ``glance_show_multiple_locations`` is not
needed neither for ceph nor horizon's direct image upload.

For safety reasons [1] it's better to keep this option disabled.

[1] https://wiki.openstack.org/wiki/OSSN/OSSN-0090
[SEP]
FILES CHANGED:
inventory/group_vars/all/glance.yml (+0, -5)
releasenotes/notes/glance_show_multiple_locations-da3713bd1da67b83.yaml (+5, -0)
",-1.383568,0.8428,-0.716105,0.912666,-0.314383,0.218945,-0.452264,-0.06938,0.039984,0.47082,0.224333,-0.692084,-0.145271,-0.404224,-0.22283
openstack/openstack-ansible-os_glance,I6d13e1e985f8e3bbb97b0af7063b469cb4b2dbca,0,0,0.6667,2.0794,0.1429,2,8.75,448,0,Feature,0,0,0,3,0.142857,1.0,0,0.6667,2,2,0,0,0.8631,1.5,-75.18,19.5,0,0,0.0,1,56.0,0,0,0,0,0,"Add external_lb_vip_address to glance_cors_allowed_origin by default

Since ``horizon_images_upload_mode`` is enabled by default and
``glance_show_multiple_locations`` is disabled by default(turns out
it's not really required), we should add ``external_lb_vip_address`` to
``glance_cors_allowed_origin`` as default.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/862167
[SEP]
FILES CHANGED:
releasenotes/notes/glance_cors_allowed_origin-fe355eb93169cf13.yaml (+5, -0)
defaults/main.yml (+1, -1)
",-2.828112,1.510908,-0.42276,0.613988,0.92538,-0.180466,-0.650422,-0.124546,0.331029,-0.542487,0.202473,-0.643077,-0.606228,-0.436349,0.138371
openstack/charm-nova-compute,I58f7f1148096d703384e089292959718fd413157,1,1,1.0,1.6094,0.25,1,50.0,395,0,Bug Fix,0,0,0,2,0.033898,1.0,0,1.0,2,1,0,1.0,0.0,2.0,0.42,31.2,1,1,0.0,1,79.0,0,6,0,10,0,"[s390x] Set pointer_model to ps2mouse

On s390x environments there is no usb controller, hence the default
pointer model (usbtable) produces failures when launching new instances
with the following error:

    unsupported configuration: USB is disabled for this domain,
    but USB devices are present in the domain XML

Closes-Bug: #1962381
[SEP]
FILES CHANGED:
templates/yoga/nova.conf (+3, -1)
",-0.265996,-1.528837,-0.03902,0.116331,-0.16275,0.190471,-0.264157,0.191713,0.098543,0.065042,0.118745,-0.323413,0.425649,0.002254,-0.355829
openstack/openstack-ansible,I3c1151449afe545780f98c01afa9fc6948f685a4,1,0,0.9211,2.4849,0.0909,2,7.8,295,0,CI,0,0,0,38,0.029851,0.0,0,0.0,3,2,0,0.8846,0.8454,2.5,31.89,14.4,0,0,0.0,1,24.5833,0,0,0,0,0,"Switch Ceph for Ubuntu Jammy to distro

Ubuntu Jammy repository is not available on download.ceph.com but
we still want/need to test out ceph deployment one way or another.
So instead of failing installation we install distro-provided ceph.
[SEP]
FILES CHANGED:
releasenotes/notes/jammy_ceph_experimental-7783ead1c07fe0ed.yaml (+8, -0)
inventory/group_vars/all/ceph.yml (+2, -1)
",0.703426,0.01635,-0.667395,0.835375,-0.129618,0.069426,1.354658,0.019944,-1.112333,-0.440998,0.318315,0.050933,0.025068,-0.136293,0.125603
openstack/charm-nova-compute,Ia60e46b8b2d35034767a2932176ec799c2e086bf,1,1,1.0,2.6391,1.0,3,9.67,478,0,Bug Fix,1,0,0,3,0.047619,1.0,0,1.0,2,1,0,1.0,1.5766,2.0,24.91,12.83,1,0,1.0,1,34.1429,0,6,0,7,0,"Update testing bundles.

- Drop extra-repositories from jammy-zed bundle. The repository
  ppa:openstack-charmers/swtpm is only needed when running on Focal,
  the Ubuntu Archive >= Jammy contains the needed packages.
- Drop 'source' config key from rabbitmq-server and
  mysql-innodb-cluster. The infrastructure support charm are sourced
  from 'distro' and they don't need to configure an UCA source.

Closes-Bug: #1994055
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -4)
tests/bundles/jammy-yoga.yaml (+0, -4)
tests/bundles/jammy-zed.yaml (+0, -5)
",-0.567459,-0.954882,-0.124336,-0.12465,-0.25192,-1.298412,0.925741,0.991203,-0.408879,-0.401255,0.113776,-0.029243,0.275255,0.470189,-0.079104
openstack/octavia,Ia0c1d4107161fff8d1f3071d57860bfd265f596f,0,0,0.6875,8.4876,0.9887,16,5.67,309,0,CI,0,0,0,16,0.018583,1.0,0,0.6875,7,3,0,0.5884,2.5042,5.0,14.47,12.85,1,0,0.7562,1,0.0637,0,0,0,0,0,"Remove support for split listener configuration

Remove support for Amphora API 0.5 or earlier.
During the PTG for the Antelope cycle it has been decided
to remove split listener configuration.[1]

[1]: https://etherpad.opendev.org/p/antelope-ptg-octavia
[SEP]
FILES CHANGED:
octavia/amphorae/driver_exceptions/exceptions.py (+5, -0)
octavia/amphorae/drivers/keepalived/vrrp_rest_driver.py (+0, -1)
octavia/tests/unit/common/jinja/haproxy/split_listeners/test_jinja_cfg.py (+0, -1157)
octavia/tests/unit/common/sample_configs/sample_configs_split.py (+0, -1139)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+32, -204)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver.py (+9, -0)
octavia/tests/unit/common/jinja/haproxy/split_listeners/__init__.py (+0, -0)
releasenotes/notes/remove-split-listeners-6a4ccdf66fe7b683.yaml (+6, -0)
octavia/common/constants.py (+0, -2)
octavia/common/jinja/haproxy/split_listeners/jinja_cfg.py (+0, -470)
octavia/common/jinja/haproxy/split_listeners/templates/macros.j2 (+0, -373)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_0_5.py (+0, -1359)
octavia/common/jinja/haproxy/split_listeners/templates/haproxy.cfg.j2 (+0, -40)
octavia/common/jinja/haproxy/split_listeners/__init__.py (+0, -0)
octavia/common/jinja/haproxy/split_listeners/templates/base.j2 (+0, -50)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+3, -3)
",-0.759291,0.726194,-0.917534,0.460232,-0.758915,0.083935,-0.06401,0.653114,0.200319,0.432026,-0.069149,0.355726,-0.312909,0.033744,-0.03931
openstack/charm-hacluster,I54a4f854f3e293503ec97d99a49b6dc51ee50c87,1,1,1.0,2.1972,0.25,2,10.67,479,0,Bug Fix,0,0,0,8,0.285714,0.0,0,0.0,1,1,0,0,1.0,1.0,45.31,10.52,0,0,0.5,0,53.2222,0,6,0,5,0,"Update 'crm node show' parsing to trim ': member'

The command 'crm node show' is used on jammy to retrieve the list of
nodes defined in a cluster. The output for nodes includes ': member'
which breaks ensuing commands that are using list_nodes() output.

For example:
juju-3f6cb6-zaza-4135aa8b2509-8.project.serverstack: member

This change trims everything including and after the ':' from the
output.

Closes-Bug: #1994160
[SEP]
FILES CHANGED:
unit_tests/test_pcmk.py (+3, -1)
hooks/pcmk.py (+3, -1)
",-0.929282,0.027114,-0.182105,-0.000378,0.05532,0.004767,0.681602,0.165608,0.370731,-0.12392,0.184915,-0.093549,0.317533,0.493996,-0.077515
openstack/charm-glance,I129713bb3845c1d0264bc4e17bb297724d23ac6b,1,0,1.0,2.5649,1.0,3,8.75,284,0,Feature,1,0,0,4,0.052632,1.0,0,1.0,2,1,0,0,1.585,2.0,52.93,11.5,1,0,1.0,1,21.8462,0,0,0,0,0,"Drop 'source' config key from support charms

Support charms (e.g. rabbitmq-server and mysql-innodb-cluster) source
their packages from distro and never from the cloud archive, this change
drops the set of that configuration key.
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -4)
tests/bundles/jammy-yoga.yaml (+0, -4)
tests/bundles/jammy-zed.yaml (+0, -4)
",0.260395,-0.869581,-0.406164,0.162969,0.37798,-1.020249,0.187711,0.212801,-0.759844,-0.431913,-0.676154,0.072957,0.174214,0.513141,-0.470416
openstack/charm-ironic-conductor,Ie2a1195a15a71da15ca61242a8badf479f140a76,0,0,1.0,0.6931,1.0,3,5.0,78,0,Feature,1,0,0,5,0.056818,0.0,0,0.0,4,1,0,0,0.0,4.0,-119.72,26.0,1,0,1.0,0,39.0,0,0,0,0,0,"Update overlay symlinks
[SEP]
FILES CHANGED:
src/tests/bundles/overlays/focal-yoga.yaml.j2 (+0, -1)
src/tests/bundles/overlays/jammy-zed.yaml.j2 (+0, -0)
src/tests/bundles/overlays/kinetic-zed.yaml.j2 (+0, -0)
",4.261712,1.504374,2.523709,0.519688,0.86441,0.102187,0.940072,0.389035,0.97248,-0.575707,-0.50363,-1.024981,0.280509,0.330764,-0.028646
openstack/charm-neutron-api-plugin-ironic,Ic743286f6fabf43718f25eccb7da6cf4f28557ea,0,0,0.8333,2.1972,1.0,10,5.0,78,0,Feature,1,0,0,6,0.067416,0.0,0,0.0,4,1,0,0,3.0,4.0,-52.04,26.0,1,0,1.0,0,8.6667,0,0,0,0,0,"Update overlay symlinks
[SEP]
FILES CHANGED:
src/tests/bundles/overlays/focal-wallaby.yaml.j2 (+0, -1)
src/tests/bundles/overlays/focal-yoga.yaml.j2 (+0, -1)
src/tests/bundles/overlays/hirsute-wallaby.yaml.j2 (+0, -1)
src/tests/bundles/overlays/bionic-ussuri.yaml.j2 (+0, -1)
src/tests/bundles/overlays/focal-ussuri.yaml.j2 (+0, -1)
src/tests/bundles/overlays/focal-victoria.yaml.j2 (+0, -1)
src/tests/bundles/overlays/jammy-zed.yaml.j2 (+0, -0)
src/tests/bundles/overlays/bionic-train.yaml.j2 (+0, -1)
src/tests/bundles/overlays/impish-xena.yaml.j2 (+0, -1)
src/tests/bundles/overlays/kinetic-zed.yaml.j2 (+0, -0)
",4.26171,1.504373,2.523708,0.519688,0.864411,0.102187,0.940071,0.389035,0.97248,-0.575706,-0.503631,-1.024981,0.280509,0.330764,-0.028645
openstack/charm-designate,I48a04ac619204ba109d87ca05de7cbe308592486,1,1,0,2.6391,0.1538,2,15.0,331,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0,0.9612,1.5,37.45,15.78,0,0,0.6154,0,23.6429,1,6,0,16,0,"Add check to expose internal endpoints

Currently, the charm ignores the use-internal-endpoints config
option that is being inherited from the Openstack Layer. This
patch adds a check to ensure that the internal endpoint is exposed
if this is set to True.

Closes-bug: #1995188
[SEP]
FILES CHANGED:
unit_tests/test_designate_handlers.py (+7, -1)
src/reactive/designate_handlers.py (+4, -1)
",-2.730703,-0.44067,-0.10423,-2.115006,1.419658,0.023135,0.704828,-0.111161,0.334673,0.296363,0.081151,0.31382,0.189904,-0.079062,-0.012805
openstack/kolla-ansible,I3906d7b9a2bebfe5c323cba5f80add3e932468c8,1,1,0.8933,2.1972,0.125,2,5.17,360,0,Bug Fix,0,0,0,75,0.025159,1.0,0,0.8933,4,2,0,0.8266,0.8113,3.0,-52.21,17.55,0,0,0.0,1,40.0,0,6,0,13,0,"Fix ironic interface option for ironic-inspector

The correct option to use is valid_interfaces [1], not os_endpoint_type.
The os_endpoint_type option was removed in Train.

[1] https://docs.openstack.org/ironic-inspector/wallaby/configuration/sample-config.html

Closes-Bug: #1995246
Related-Bug: #1990675
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -1)
releasenotes/notes/ironic-inspector-interface-dff250cfbce1df28.yaml (+6, -0)
",-1.05961,1.932057,-0.972545,0.578151,-0.405717,-0.270464,-0.02732,0.266915,0.406684,-0.153405,0.280133,-0.493458,-0.032563,0.088448,0.147545
openstack/charm-ceph-radosgw,I565e36b94d249d2cf0beccf1480189a19da008d9,1,0,1.0,5.9738,0.0026,8,10.0,143,0,Feature,0,0,0,1,0.012195,1.0,0,1.0,2,2,0,1.0,2.0805,0.88,-31.73,20.0,0,0,0.8903,1,0.3639,0,0,0,0,0,"Partial revert[1] to re-enable Focal support

1: 51f59879d381e44958970ada79a784d8cce9a92e
[SEP]
FILES CHANGED:
tests/bundles/focal-yoga-multisite.yaml (+99, -0)
tests/tests.yaml (+3, -0)
osci.yaml (+31, -0)
tests/bundles/focal-yoga-namespaced.yaml (+124, -0)
tests/bundles/focal-yoga.yaml (+123, -0)
config.yaml (+1, -1)
metadata.yaml (+1, -0)
tox.ini (+9, -0)
",0.558058,-0.370877,-1.627508,-2.415575,1.542258,0.793222,9e-06,-0.505295,0.294775,0.790159,-0.75908,0.92624,-0.13628,-0.075157,0.030847
openstack/charm-neutron-gateway,Ib468fb79ec5e00102a1a9fc43ab66078e37c1593,0,0,0.7143,2.5649,1.0,3,8.0,114,0,Feature,1,0,0,7,0.072165,1.0,0,0.7143,2,1,0,0,1.585,2.0,-55.08,23.2,1,0,1.0,1,8.7692,0,0,0,0,0,"Drop 'source' from mysql-innodb-cluster and rabbitmq-server
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -4)
tests/bundles/jammy-yoga.yaml (+0, -4)
tests/bundles/jammy-zed.yaml (+0, -4)
",0.762127,2.480945,-0.685655,0.638305,1.43496,-1.296593,0.369658,0.382221,-0.891566,-0.949466,0.108629,0.488979,-0.081104,0.427789,0.173058
openstack/charm-neutron-gateway,Ibd7d373305b608ff0349986d17ecba7f9dfaeb3c,1,1,0.625,0.6931,1.0,1,8.67,217,0,Bug Fix,0,0,0,8,0.073394,0.0,0,0.0,1,1,0,0.0,0.0,1.0,41.85,15.77,1,0,0.0,0,108.5,0,6,0,6,0,"Drop python-six

This charm doesn't need to support python 2.x anymore, and python-six
was dropped from the Ubuntu Archive on Kinetic (22.10)

Closes-Bug: #1995285
[SEP]
FILES CHANGED:
hooks/neutron_hooks.py (+0, -1)
",0.583532,-0.789255,-0.809712,-0.552566,-0.920892,0.278183,-0.594256,0.183773,-0.896748,0.289076,0.123894,0.387032,-0.088043,0.53025,0.218539
openstack/charm-ceph-radosgw,I565e36b94d249d2cf0beccf1480189a19da008d9,1,0,1.0,5.9738,0.0026,8,10.0,143,0,Feature,0,0,0,2,0.004219,1.0,0,1.0,2,2,0,1.0,2.0805,0.88,-31.73,20.0,0,0,0.8903,1,0.3639,0,0,0,0,0,"Partial revert[1] to re-enable Focal support

1: 51f59879d381e44958970ada79a784d8cce9a92e
[SEP]
FILES CHANGED:
tests/bundles/focal-yoga-multisite.yaml (+99, -0)
tests/tests.yaml (+3, -0)
osci.yaml (+31, -0)
tests/bundles/focal-yoga-namespaced.yaml (+124, -0)
tests/bundles/focal-yoga.yaml (+123, -0)
config.yaml (+1, -1)
metadata.yaml (+1, -0)
tox.ini (+9, -0)
",0.558058,-0.370877,-1.627508,-2.415575,1.542258,0.793222,9e-06,-0.505295,0.294775,0.790159,-0.75908,0.92624,-0.13628,-0.075157,0.030847
openstack/charm-hacluster,Ia405d4270f56c949f79167f8b75c1304b598b918,1,1,1.0,1.7918,0.6,2,12.8,449,0,Bug Fix,0,0,0,9,0.25,1.0,0,1.0,1,1,0,1.0,0.971,1.0,52.4,13.24,0,0,0.6,0,74.8333,0,6,0,5,0,"Only return hacluster nodes from list_nodes()

list_nodes() recently had some changes to run 'crm node show'
in jammy+ instead of 'crm node status'. The difference is that
'crm node show' returns the pacemaker-remote nodes in addition
 to the hacluster nodes. This change limits the nodes returned
by list_nodes() to the hacluster nodes (ie. the nodes that
have a node ID).

Closes-Bug: #1995295
[SEP]
FILES CHANGED:
unit_tests/test_pcmk.py (+1, -2)
hooks/pcmk.py (+1, -1)
",-0.886857,0.10244,0.04291,0.898813,0.527089,0.0378,0.475384,-0.12292,-0.287077,-0.46221,0.367818,-0.17323,0.214727,0.19662,-0.143723
openstack/charm-manila-netapp,I807edb61b6171cfd2260d1eba581019a130090c0,1,1,1.0,4.7536,0.0783,3,15.5,248,0,Bug Fix,0,0,0,1,0.002924,1.0,0,1.0,2,3,0,0,1.0032,1.0,35.55,13.94,1,0,0.0,1,2.1379,0,8,0,10,0,"Enable a standalone network for shares

The patch adds config options and template changes to enable a single
standalone network for serving shares from a NetApp appliance.

Closes-Bug: #1989216
[SEP]
FILES CHANGED:
templates/queens/manila.conf (+22, -9)
config.yaml (+81, -0)
src/charm.py (+3, -0)
",0.440214,-1.507107,-0.486048,0.28779,-0.464986,0.176381,-0.619337,0.572381,0.435891,-0.056368,-0.344929,0.383383,0.201619,-0.209878,0.162971
openstack/charm-ceph-mon,Ic389c840cc4253adaddcaa50d184db6ca66cb397,1,0,1.0,2.7081,0.0,1,14.0,304,0,CI,0,0,0,1,0.333333,1.0,0,1.0,1,1,0,1.0,0.0,1.0,35.51,12.27,1,0,0.0,0,20.2667,0,0,0,0,0,"Work around config initialisation behaviour change

The previous (classic) version of the charm initialised a Config
object in the install hook and let it go out of scope. Initialise
a config object explicitly in the install and upgrade charm hooks.
[SEP]
FILES CHANGED:
src/charm.py (+14, -0)
",-0.43212,-1.000414,-0.929489,-0.775454,0.721041,0.205828,1.172076,-0.308261,0.123207,0.361827,-0.085159,0.066058,0.328505,0.268789,-0.035722
openstack/openstack-ansible,I6119b0bfc27d173610657f39ebb717e0a18b247e,1,0,0.9231,4.0775,0.0345,3,16.0,571,0,Feature,0,0,0,39,0.030374,0.1282,0,0.1183,4,3,0,0.8889,0.8306,1.67,31.97,14.4,0,0,0.0,0,9.678,0,0,0,0,0,"Install dynamic-inventory as console_script

If you want to store openstack_deploy content you want it's content
to be relevant. However, at the moment it's quite hard to predict how
inventory will be generated if/when adding some new host to it.

Installing dynamic_inventory script as a console_script will allow you
to create quite simple tox env to update openstack_inventory.json
on local machine right after changing config and simplify life of
operator. Also this way you don't need to clone openstack-ansible
[SEP]
FILES CHANGED:
setup.cfg (+4, -0)
inventory/dynamic_inventory.py (+5, -1)
doc/source/reference/inventory/generate-inventory.rst (+47, -1)
",-1.083676,-1.790585,0.405387,0.422479,-0.201604,-0.457907,0.360992,-0.441454,-0.49709,-0.038854,-0.116882,-0.027876,-0.166034,0.24862,-0.119248
openstack/openstack-ansible-galera_server,I002a60cf1091e05bf1b0b5d066df97795b5123fc,0,0,0.925,0.6931,0.0,1,13.0,586,0,Feature,0,0,0,40,0.029806,1.0,0,0.925,1,1,0,1.0,0.0,1.0,35.29,13.92,0,0,0.0,0,293.0,0,0,0,0,0,"Remove mariadb-connector-c during upgrades

mariadb-connector-c package is being installed with native mariadb,
as CentOS 9 Stream support was added at times when MariaDB was not
providing repo for it's installation. Now, since we bumped version
to 10.6.10 and install MariaDB for CentOS from MariaDB repo, upgrade
path is broken, since mariadb-connector-c is conflicting with
MariaDB-shared that provides same functionality. We need to add
mariadb-connector-c to the packages that are removed during upgrade not
to break upgrades.
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
",-0.999782,-0.266915,0.655243,0.503193,0.525888,-0.682973,0.668022,0.503161,-0.732353,0.043283,0.443086,0.184716,-0.472478,0.11927,0.364953
openstack/ironic,I8e845d46ba0e13027aa1e628b0ad45eb24f9b387,1,0,0.963,5.7746,0.0,6,13.0,182,0,CI,0,0,0,27,0.01344,0.7778,0,0.749,2,1,0,0.9552,1.7851,1.67,47.22,12.89,1,0,0.0997,1,0.5652,0,0,0,0,0,"Add a non-voting metal3 CI job

We'll use only one node as we're limited in resources but that
should suffice for a basic test.
[SEP]
FILES CHANGED:
playbooks/metal3-ci/run.yaml (+39, -0)
playbooks/metal3-ci/fetch_pod_logs.yaml (+24, -0)
playbooks/metal3-ci/post.yaml (+194, -0)
zuul.d/project.yaml (+2, -0)
zuul.d/metal3-jobs.yaml (+30, -0)
playbooks/metal3-ci/fetch_kube_logs.yaml (+32, -0)
",2.259382,-1.905807,0.630031,0.164292,-0.858874,0.244651,0.783154,-0.790989,-0.435071,0.13271,-0.546391,0.401541,-0.173903,-0.406302,0.087132
openstack/kolla-ansible,Ic1eed7d19e9b583e22419625c92ac3507ea4614d,0,0,0,3.6109,0.0833,7,10.25,308,0,Doc,0,0,0,0,0.0,0.8,0,0.0,4,3,0,0.8273,1.9146,3.43,39.61,10.93,1,0,0.0,0,8.3243,0,0,0,0,0,"Add NVMe-RoCE Cinder driver support for Pure Storage

From OpenStack Zed the Pure Storage Cinder driver supports
NVMe-RoCE as a dataplane protocol. This patch adds support
for this new driver type.

Also amend a couple of documentation formatting typos.
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+2, -0)
doc/source/reference/storage/cinder-guide.rst (+3, -0)
ansible/roles/cinder/tasks/precheck.yml (+1, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+8, -0)
doc/source/reference/storage/cinder-guide-pure.rst (+17, -3)
etc/kolla/globals.yml (+1, -0)
",-0.306042,-0.650125,-0.58616,1.006588,0.128009,0.38355,-0.147227,1.092813,0.029286,0.33487,-0.023394,0.796778,0.299139,-0.589612,-0.08538
openstack/charm-ceph-mon,Ic389c840cc4253adaddcaa50d184db6ca66cb397,1,0,1.0,2.7081,0.0,1,15.67,373,0,CI,0,0,0,2,0.117647,1.0,0,1.0,1,1,0,1.0,0.0,1.0,28.93,13.08,1,0,0.0,0,24.8667,0,0,0,0,0,"Work around config initialisation behaviour change

The previous (classic) version of the charm initialised a Config
object in the install hook and let it go out of scope. Initialise
a config object explicitly in the install and upgrade charm hooks.

(cherry picked from commit d76dda4f5586b752451d5a9256097a620f1aade0)
[SEP]
FILES CHANGED:
src/charm.py (+14, -0)
",-0.43212,-1.000414,-0.929489,-0.775454,0.721041,0.205828,1.172076,-0.308261,0.123207,0.361827,-0.085159,0.066058,0.328505,0.268789,-0.035722
openstack/octavia,Ie5fb25e292461baca38499091e8f9b9a53e3ddcd,1,0,1.0,4.7185,0.4324,9,17.0,353,0,Bug Fix,0,0,0,2,0.086957,0.8333,0,0.8333,7,2,0,0.5864,2.7594,5.56,53.56,13.07,1,0,0.3333,1,3.1518,0,0,0,0,0,"Fix pool creation with single LB create call

So far, creating a populated LB (or an LB tree) with non attached pools,
left the pools on PENDING_CREATE provisioning_state.

This patch adds the option of marking non attached pools to be active on
the MarkLBActiveInDB task.

Story 2010426
Task 46823
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+8, -3)
octavia/controller/worker/v1/tasks/database_tasks.py (+10, -2)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+0, -1)
octavia/controller/worker/v2/tasks/database_tasks.py (+10, -2)
octavia/tests/unit/controller/worker/v1/tasks/test_database_tasks.py (+13, -11)
octavia/controller/worker/v1/flows/load_balancer_flows.py (+8, -14)
releasenotes/notes/fix-pool-prov-status-on-lb-single-create-897070aee0a42da6.yaml (+5, -0)
octavia/tests/unit/controller/worker/v1/flows/test_load_balancer_flows.py (+0, -1)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+9, -14)
",-0.108742,-1.456846,-0.255811,0.235054,-0.129734,0.393174,-0.305244,0.227907,0.529022,-0.15429,0.066333,-0.075642,0.050881,0.169952,0.031549
openstack/kolla-ansible,Ie62e9220bad56262cad602ca1480e6ca65827819,1,1,0.875,2.4849,0.0909,2,4.62,413,0,Bug Fix,0,0,0,8,0.065574,0.0,0,0.0,4,2,0,0.824,0.684,3.0,-17.36,16.99,0,0,0.0,1,34.4167,0,64,0,55,0,"Generate ovn-chassis-mac-mappings on ovn-controller group

Previously ovn-chassis-mac-mappings [1] has been added only to
ovn-controller-compute group. However external ports are being
scheduled on network nodes, therefore we need also do that there.

Closes-Bug: 1995078

[1] https://github.com/ovn-org/ovn/blob/v22.09.0/controller/ovn-controller.8.xml#L239
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1995078-2671a868c4fd27d3.yaml (+9, -0)
ansible/roles/ovn/tasks/bootstrap.yml (+1, -1)
",-1.503177,2.172718,-0.396884,0.669368,-0.265796,-0.511196,0.424247,0.260413,0.003699,-0.104386,0.187169,-0.069972,0.072263,0.303478,0.089528
openstack/openstack-ansible-os_heat,If1e3eec0c558d1472da7bc3a4e87825e36ba4fdc,1,1,0.9024,1.0986,0.0,2,15.0,265,0,Bug Fix,0,0,0,41,0.030529,1.0,0,0.9024,1,1,0,0,1.0,1.0,2.67,20.67,0,0,0.0,0,88.3333,0,12,0,19,0,"Install git into placement containers

If venv_wheel_build_enable is defined to False, placement will fail to
clone and install repositories due to missing git binary.

Related-Bug: #1989506
Closes-Bug: #1995536
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
vars/debian.yml (+1, -0)
",-0.030717,-0.797283,-0.793354,-0.216279,-0.314812,-0.003039,-1.17147,0.020058,0.118259,-0.116187,-0.026598,-0.34023,0.130227,0.034517,-0.05501
openstack/charm-nova-compute,Idc0602f95e5378be1243926aa88dc7b5282ee844,1,1,0,4.5326,0.4239,13,10.25,334,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,1.0,3.6995,2.0,23.1,14.83,1,0,0.0,1,3.5914,0,6,0,18,0,"Move default_ephemeral_format to [DEFAULT] section

The default_ephemeral_format line in nova.conf was not in the [DEFAULT]
section in the templates and has therefore been ignored ny nova-compute.
This change moves it to the correct section for all releases.

Closes-Bug: #1992386
[SEP]
FILES CHANGED:
templates/liberty/nova.conf (+4, -3)
templates/train/nova.conf (+4, -3)
templates/juno/nova.conf (+4, -3)
templates/pike/nova.conf (+4, -3)
templates/icehouse/nova.conf (+4, -3)
templates/queens/nova.conf (+4, -3)
templates/rocky/nova.conf (+4, -3)
templates/newton/nova.conf (+4, -3)
templates/yoga/nova.conf (+4, -3)
templates/ocata/nova.conf (+4, -3)
templates/stein/nova.conf (+4, -3)
templates/kilo/nova.conf (+5, -3)
templates/mitaka/nova.conf (+4, -3)
",-0.748917,0.244999,-1.074542,0.77411,0.173972,0.470651,0.149753,-0.098831,-0.079659,-0.249971,0.731736,-0.211102,-0.358528,0.163669,0.003067
openstack/kolla-ansible,Iaa1e687152db8351bc0e9b10e66f412860ac13a5,0,1,0.881,4.0775,0.0,5,8.0,356,0,Bug Fix,0,0,0,42,0.048894,1.0,0,0.881,4,4,0,0.8247,2.107,3.2,21.06,15.2,1,0,0.0517,1,6.0339,0,36,0,16,0,"Run ML2/OVS agents processes in separate containers

It's an experimental feature, disabled by default (but enabled
by default in our CI).

It's based on TripleO ,,version'' that was their fix for
the linked bug.

Closes-Bug: #1891469

Depends-On: https://review.opendev.org/c/openstack/kolla/+/946215
[SEP]
FILES CHANGED:
ansible/roles/neutron/handlers/main.yml (+7, -0)
ansible/roles/neutron/defaults/main.yml (+20, -0)
tests/templates/globals-default.j2 (+3, -0)
releasenotes/notes/bug-1891469-4f8a45c29bde55e5.yaml (+13, -0)
doc/source/reference/networking/neutron.rst (+15, -0)
",-0.256473,-0.176599,-0.1401,-0.632004,-1.716511,0.20177,0.180295,0.213097,-0.084554,0.01556,0.199281,-0.370211,0.289781,0.172845,0.0884
openstack/charm-nova-compute,I734e3ddf3c227a1c93beb753159ad90d2ee1b0d1,1,1,1.0,4.4543,0.4235,12,10.25,334,0,Bug Fix,0,0,0,1,0.010753,1.0,0,1.0,2,1,0,1.0,3.5839,2.0,21.04,14.83,1,0,0.0,1,3.8837,0,6,0,18,0,"Move default_ephemeral_format to [DEFAULT] section

The default_ephemeral_format line in nova.conf was not in the [DEFAULT]
section in the templates and has therefore been ignored ny nova-compute.
This change moves it to the correct section for all releases.

Closes-Bug: #1992386
[SEP]
FILES CHANGED:
templates/liberty/nova.conf (+4, -3)
templates/train/nova.conf (+4, -3)
templates/juno/nova.conf (+4, -3)
templates/pike/nova.conf (+4, -3)
templates/icehouse/nova.conf (+4, -3)
templates/queens/nova.conf (+4, -3)
templates/rocky/nova.conf (+4, -3)
templates/newton/nova.conf (+4, -3)
templates/ocata/nova.conf (+4, -3)
templates/stein/nova.conf (+4, -3)
templates/kilo/nova.conf (+5, -3)
templates/mitaka/nova.conf (+4, -3)
",-0.748917,0.244999,-1.074542,0.77411,0.173972,0.470651,0.149753,-0.098831,-0.079659,-0.249971,0.731736,-0.211102,-0.358528,0.163669,0.003067
openstack/charm-nova-compute,Id2db3a70b8d1287bda006f1bbc5442038f7070f1,1,1,0,1.6094,0.25,1,12.5,552,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.0,1.0,-13.97,17.8,0,0,0.0,0,110.4,0,12,0,17,0,"AppArmor policy update for os-brick and iSCSI

In iSCSI usecases including cinder-lvm, os-brick requires lock files
such as:
  - /run/lock/nova/os-brick-connect_volume
  - /run/lock/nova/os-brick-connect_to_iscsi_portal-192.168.0.1

and lsscsi requires following access to compose a rescan command such as
""/sys/bus/scsi/drivers/sd/2:0:0:0/rescan"":
  - /dev/
  - /sys/bus/scsi/devices/

Closes-Bug: #1979812
Related-Bug: #1939390
(cherry picked from commit b5e658d04571a7c3019b5c5b711aca632989248c)
[SEP]
FILES CHANGED:
templates/usr.bin.nova-compute (+3, -1)
",-3.241631,1.61525,0.899052,-0.91102,0.522401,-0.578681,-0.025679,0.424369,0.019414,-0.407906,-0.254362,-0.334081,0.351596,0.244446,0.246096
openstack/kolla-ansible,Ibd348e84a19456f97a77f082f44ef24ebaf6aa6c,0,1,0,2.7081,0.0714,2,2.62,273,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.8214,0.9852,2.5,-65.74,22.0,0,0,0.0,1,18.2,0,6,0,3,0,"Permit to customize keystone-startup.sh

Permit to customize keystone-startup.sh from keystone-startup.sh.j2 as
example config/keystone-startup.sh.j2

Closes-Bug: 1996939
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/config.yml (+5, -1)
releasenotes/bug-1996939-97943c9a8f51578b.yaml (+8, -0)
",-0.511246,2.035036,-1.40642,0.841305,0.569542,-0.449792,-0.065409,-0.002273,-0.5047,-0.560829,0.279877,-0.153441,-0.087668,0.873737,0.30211
openstack/octavia,I00e327e1d94e46aa13a38120df9865ec34eaa593,1,0,0.7284,2.4849,0.1818,3,18.0,768,0,Bug Fix,0,0,0,81,0.007315,1.0,0,0.7284,6,2,0,0.5878,1.3093,4.0,52.27,13.23,0,0,0.1818,1,64.0,0,0,0,0,0,"Add a newline when writing the server state file

Before restarting haproxy, the amphora-agent dumps the state of the
servers in a file, so when haproxy reloads, it can recover the operating
state of its backends' members.
But with haproxy 2.4 (in Centos 9 Stream), it fails with a ""corrupted
global server state file"" error when reading this file. It seems that
most recent haproxy releases have a more strict validation of the format
of the file and ensure that it is terminated with a newline.

This commit adds a newline to the file (all the responses to haproxy
queries are stripped in the amphora-agent). It fixes the issue on Centos
9 Stream (and turns off a warning on Ubuntu).

Story: 2010442
Task: 46873
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/haproxy_query.py (+1, -1)
octavia/tests/unit/amphorae/backends/utils/test_haproxy_query.py (+1, -1)
releasenotes/notes/fix-corrupted-global-server-state-file-325ab7c62e21ff14.yaml (+7, -0)
",-1.712286,-1.502984,1.72251,-0.330424,-0.577784,0.026052,0.288125,0.165929,0.112886,-0.129075,0.122722,0.348277,-0.119243,0.065897,-0.063947
openstack/kolla-ansible,I710b5364244d976020656e1ee68e89f337cb3086,1,0,0.9762,1.3863,0.6667,2,5.5,316,0,Bug Fix,0,0,0,42,0.064615,0.8333,0,0.8135,4,1,0,0.8182,0.9183,4.0,-8.97,15.53,1,0,0.0,0,79.0,0,0,0,0,0,"Fix some neutron configuration options

Move metadata_workers from neutron.conf to metadata_agent.ini.

Remove unknown option placement/os_region_name: we already have
placement/region_name which is the correct one.

This can be backported to previous releases.
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -2)
ansible/roles/neutron/templates/metadata_agent.ini.j2 (+1, -0)
",0.159771,-1.156193,-0.523333,0.562261,0.257533,-0.103017,-0.132098,-0.07167,0.017437,-0.305396,-0.22481,-0.540386,-0.593526,0.471179,-0.046914
openstack/octavia,Ia557ccb4b9d7576acce308e851ca742624f91d88,1,0,0.4808,5.6058,0.0111,8,19.0,393,0,Bug Fix,0,0,0,104,0.004146,1.0,0,0.4808,4,3,0,0.5892,2.1443,2.88,43.58,13.21,0,0,0.6273,1,1.4449,0,0,0,0,0,"Fix Octavia API HTTP Accept header handling

This patch improves the Octavia API handling of HTTP Accept headers and
ensures the response content type will always be application/json.
Prior to this fix, requests with wildcard Accept headers may have
received a response from the API in a format other than JSON.

Story: 2010447
Task: 46932
[SEP]
FILES CHANGED:
api-ref/source/v2/general.inc (+4, -2)
octavia/common/constants.py (+6, -0)
releasenotes/notes/EnforceApplicationJSONContentType-65ad696565eac75c.yaml (+12, -0)
octavia/api/common/hooks.py (+31, -1)
octavia/tests/unit/api/test_config.py (+35, -0)
octavia/api/config.py (+1, -0)
octavia/tests/functional/api/test_content_types.py (+135, -0)
octavia/api/common/utils.py (+44, -0)
",-0.944158,-1.202963,-0.76725,0.900129,0.033839,0.656016,-0.179751,0.148279,0.593557,0.268063,0.068819,0.443053,0.31994,-0.164094,-0.038982
openstack/charm-mysql-innodb-cluster,Ie3b71a60e4c7afda48114a53cce9cf713b933d71,1,1,1.0,1.9459,0.1667,2,19.67,929,0,Bug Fix,0,0,0,1,0.018519,1.0,0,1.0,4,1,0,1.0,1.0,2.5,26.99,16.0,0,0,0.5,0,132.7143,0,6,0,7,0,"mysqldump: add --set-gtid-purged=COMMENTED to mysqldump command

The backup file taken from a charm-managed mysql instance contains
""@@GLOBAL.GTID_PURGED"" variable at the beginning, which causes
restore operation to fail with the following message: ""Cannot
update GTID_PURGED with the Group Replication plugin running"".
The workaround for this issue is to supply ""--set-gtid-purged=OFF""
to command, which omits the ""GTID_PURGED"" from the mysqldump output.

This patch fixes the issue by adding ""--set-gtid-purged=COMMENTED""
to mysqldump command, which causes  mysqldump to emit the GTID_PURGED
variable as a commented out line. In this way, we don't lose the
GTID_PURGED variable information which may be needed in some scenarios
and can be un-commented out before restoring if needed.

Closes-bug: 1989975
(cherry picked from commit 82ebc349fab662d65366fa5958669d653958eaf8)
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+3, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+2, -1)
",-3.939759,1.09251,2.239002,-0.420918,0.98571,0.539807,-0.553044,-0.405279,0.042051,-0.325344,0.391724,0.187691,-0.138363,0.162469,0.37569
openstack/charm-mysql-innodb-cluster,Ie3b71a60e4c7afda48114a53cce9cf713b933d71,1,1,1.0,1.9459,0.1667,2,19.67,929,0,Bug Fix,0,0,0,2,0.033333,1.0,0,1.0,4,1,0,1.0,1.0,2.5,26.99,16.0,0,0,0.5,0,132.7143,0,6,0,7,0,"mysqldump: add --set-gtid-purged=COMMENTED to mysqldump command

The backup file taken from a charm-managed mysql instance contains
""@@GLOBAL.GTID_PURGED"" variable at the beginning, which causes
restore operation to fail with the following message: ""Cannot
update GTID_PURGED with the Group Replication plugin running"".
The workaround for this issue is to supply ""--set-gtid-purged=OFF""
to command, which omits the ""GTID_PURGED"" from the mysqldump output.

This patch fixes the issue by adding ""--set-gtid-purged=COMMENTED""
to mysqldump command, which causes  mysqldump to emit the GTID_PURGED
variable as a commented out line. In this way, we don't lose the
GTID_PURGED variable information which may be needed in some scenarios
and can be un-commented out before restoring if needed.

Closes-bug: 1989975
(cherry picked from commit 82ebc349fab662d65366fa5958669d653958eaf8)
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+3, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+2, -1)
",-3.939759,1.09251,2.239002,-0.420918,0.98571,0.539807,-0.553044,-0.405279,0.042051,-0.325344,0.391724,0.187691,-0.138363,0.162469,0.37569
openstack/openstack-ansible-os_designate,I3b3aaf48f990e229ba5ca3ec5127780fa70228d0,1,0,0.9048,4.3175,0.473,3,11.5,833,0,Bug Fix,0,0,0,42,0.031227,1.0,0,0.9048,1,1,0,0,0.5529,1.0,38.47,11.21,0,0,0.0,0,11.1067,0,0,0,0,0,"Fix race condition during designate setup

Right now when designate is being installed for the first time, role
tries to run pool update before database is being populated. That
happens due to flushing handlers early as db sync requires service
to run with relevant config. This regression has been implemented
with [1].

To resolve it we move copy of pools.yaml after handlers are flushed
first time and after db sync process.
We also move service_setup before first flush as otherwise service
won't be able to start properly anyway.

There's no need to copy pools.yaml to each designate container and run
pool update multiple times - it's enough to do that once.

[1] https://opendev.org/openstack/openstack-ansible-os_designate/commit/87eb5d46cd6a3266e6c459263829ee77260feffd
[SEP]
FILES CHANGED:
tasks/main.yml (+39, -27)
tasks/designate_post_install.yml (+0, -7)
handlers/main.yml (+0, -1)
",-2.45951,0.043274,1.837607,-0.69165,-0.172431,-0.051976,0.671963,-0.287568,-0.112999,-0.128852,-0.159554,-0.205881,-0.089199,-0.007514,0.017791
openstack/charm-rabbitmq-server,I345e3bb7be7492286daf9e5ab36506915f3daab9,1,1,0.6667,2.3979,0.6,3,6.0,285,0,Bug Fix,0,0,1,9,0.081818,1.0,0,0.6667,2,2,0,1.0,1.571,1.33,0.53,15.73,1,0,0.6,1,25.9091,0,6,0,23,0,"Drop 'source' config key override.

Drop configuration key 'source' override in rabbitmq-server and
mysql-innodb-cluster applications.

Add bindep.txt to install package dependencies needed to run unit tests.

Related-Bug: #1991528
[SEP]
FILES CHANGED:
bindep.txt (+4, -0)
tests/bundles/focal-yoga.yaml (+0, -3)
tests/bundles/jammy-yoga.yaml (+0, -3)
",0.689253,0.001978,-0.759542,0.237188,-0.066323,-0.636212,0.325147,0.550989,0.143937,-0.52608,-0.064712,-0.013575,0.122103,0.302143,0.265691
openstack/openstack-ansible,I259aeac054898d73d3c29056e979e26e723245d4,1,0,0.907,1.0986,0.5,1,9.5,425,0,Bug Fix,1,0,0,43,0.030303,0.0,0,0.0,4,1,0,0.8929,0.0,4.0,39.87,10.82,0,0,1.0,0,141.6667,0,0,0,0,0,"Disable sahara tempest tests

Sahara as of Zed is broken with u-c due to jsonschema version. There're
several fixes that were proposed for upstream service, like [1] but they
still never passed CI due to other issues in code. Thus we disable
running sahara-specific tests for now to make our role jobs passing.

[1] https://review.opendev.org/c/openstack/sahara/+/864728
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_sahara.yml.j2 (+1, -1)
",-0.433646,0.01348,-0.018286,0.189042,-0.939036,-0.265536,0.698822,0.091164,-0.489097,0.351765,0.031255,-0.130425,0.149358,-0.559266,0.092831
openstack/charm-ceph-radosgw,Ica234a5beaad238765930def8af271c7d178ddc7,1,0,1.0,3.8501,0.0435,10,5.0,78,0,Feature,0,0,0,2,0.028169,1.0,0,1.0,5,4,0,1.0,3.1603,4.8,-35.12,26.0,1,0,0.0,1,1.6596,0,0,0,0,0,"Sync with charm-helpers
[SEP]
FILES CHANGED:
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend (+2, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+3, -0)
hooks/charmhelpers/contrib/openstack/utils.py (+6, -1)
hooks/charmhelpers/contrib/storage/linux/ceph.py (+3, -1)
hooks/charmhelpers/contrib/openstack/templates/haproxy.cfg (+4, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken (+3, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
hooks/charmhelpers/contrib/openstack/context.py (+9, -0)
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend.conf (+2, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",3.232473,1.897178,1.408296,0.634915,0.358466,-0.025441,0.746717,0.11064,-0.253375,-0.624469,-0.1223,0.00327,0.415305,0.295303,0.136444
openstack/charm-ceph-radosgw,I82634255ca3423fec3fc15c1e714dcb31db5da7a,1,1,1.0,2.9957,0.1053,2,7.85,841,0,Bug Fix,0,0,0,3,0.025641,1.0,0,1.0,1,1,0,1.0,0.8997,1.0,38.79,10.98,1,0,0.3158,0,42.05,0,22,0,11,0,"Enable HAProxy HTTP Health Checks

Ceph radosgw supports [0] the swift health check endpoint
""/swift/healthcheck"". This change adds the haproxy
configuration [1] necessary to take the response of ""GET
/swift/healthcheck"" into account when determining the health
of a radosgw service.

For testing, I verified that:
- HAProxy starts and responds to requests normally with this
  configuration.
- Servers with status != 2xx or 3xx are removed from the
  backend.
- Servers that take too long to respond are also removed
  from the backend. The default timeout value is 2s.

[0] https://tracker.ceph.com/issues/11682
[1] https://www.haproxy.com/documentation/hapee/2-0r1/onepage/#4.2-option%20httpchk

Closes-Bug: 1946280
(cherry picked from commit 31a4584169c1c78e59dc505de4163d528d1cae0a)
[SEP]
FILES CHANGED:
unit_tests/test_ceph_radosgw_context.py (+5, -1)
hooks/ceph_radosgw_context.py (+12, -1)
",-3.250922,0.583247,2.325658,-1.184372,-0.324643,0.027003,-0.213054,0.373046,0.077158,0.065317,-0.306871,-0.020506,-0.033361,0.061444,-0.059349
openstack/charm-nova-compute,I4193c042f6b3a55dfb1dc57f0f4d3bc71e19006f,1,1,1.0,1.9459,0.6667,1,11.8,496,0,Bug Fix,0,0,0,1,0.017544,1.0,0,1.0,2,1,0,1.0,0.0,2.0,28.53,12.18,1,0,0.0,1,70.8571,0,24,0,11,0,"Use enabled option for vnc

vnc_enabled, novnc_enabled are depreacted but should
be in DEFAULT section. Commit [1] moved the deprecated
options under vnc group so they dont have any effect.
This leads to vnc as True which is default option
in nova.

Change the template to use enabled option instead of
deprecated ones

[1] https://opendev.org/openstack/charm-nova-compute/commit/73edc4f817d0a8c281284a0df850d93ea5427014

Closes-Bug: #1998300
[SEP]
FILES CHANGED:
templates/yoga/nova.conf (+2, -4)
",-1.820484,0.389341,0.139662,-0.802581,0.148961,-0.101104,0.546892,0.17075,0.084902,0.04746,0.226465,-0.1539,-0.087995,-0.171381,-0.136421
openstack/openstack-ansible,Id3af406a14e4b3106676b8da03128881b217edb7,1,0,0.9091,0.6931,0.0,1,8.4,371,0,CI,1,0,0,44,0.030964,0.0,0,0.0,4,1,0,0.8966,0.0,4.0,-3.12,16.69,1,0,1.0,0,185.5,0,0,0,0,0,"Define apmhora provider for tempest config

Despite octavia provider is a default setting, this is just a deprecated
alias for amphora. So we define it explicitly as we cut out octavia alias
from the list of available providers.

Needed-By: https://review.opendev.org/c/openstack/openstack-ansible-os_octavia/+/866058
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_octavia.yml.j2 (+1, -0)
",-0.919132,0.750785,-0.992218,0.478297,-0.621936,-0.268168,0.784288,-0.039915,0.086716,-0.168888,0.065601,-0.174172,0.177108,-0.286569,0.092496
openstack/charm-glance-simplestreams-sync,I980306269a68c04735811324f6b826622bc6647c,1,1,0,3.6376,0.4324,3,24.0,191,0,Bug Fix,0,0,0,0,0.0,0.4561,0,0.0,1,2,0,0,1.1522,0.67,23.85,19.6,0,0,0.4865,1,5.0263,0,10,0,23,0,"Add juju-exec for juju 3 compatibility

In juju3, juju-run is moved to juju-exec
gsss should be able to handle both

Closes-bug: #1993652
[SEP]
FILES CHANGED:
files/glance_simplestreams_sync.py (+11, -7)
unit_tests/test_glance_simplestreams_sync.py (+9, -9)
tox.ini (+1, -0)
",0.280964,0.024338,-0.974179,-0.057965,0.146393,-0.163062,-0.512038,-0.26895,-0.700603,-0.148631,0.071925,-0.055621,-0.26716,-0.070962,0.589584
openstack/kolla-ansible,I5524169b9567819d379726099bf70c692c85acc1,0,1,0.9767,2.8332,0.25,3,10.0,598,0,Bug Fix,0,0,0,43,0.06585,0.0,0,0.0,4,2,0,0.8189,1.4772,3.33,-21.87,19.33,1,0,0.0,1,35.1765,0,16,0,14,0,"Support CloudKitty deployment with internal TLS

Configure cloudkitty_influxdb_use_ssl automatically based on the value
of kolla_enable_tls_internal. Set cloudkitty_elasticsearch_cafile,
cloudkitty_influxdb_cafile and cloudkitty_prometheus_cafile to
openstack_cacert.

Disable certificate validation when bootstrapping the InfluxDB database:
the influxdb_database module and the InfluxDB 1.x Python client don't
support specifying a CA certificate file.

This fixes bootstrap and execution of CloudKitty with internal TLS.

Closes-Bug: #1998831
[SEP]
FILES CHANGED:
ansible/roles/cloudkitty/tasks/bootstrap.yml (+3, -0)
ansible/roles/cloudkitty/defaults/main.yml (+4, -4)
releasenotes/notes/cloudkitty-internal-tls-c3e18be2a9f95c5d.yaml (+5, -0)
",-2.536054,0.266337,-0.020854,0.592736,1.134764,-0.48939,-0.470512,0.827095,0.242319,-0.452052,0.380887,-0.458309,-0.578439,-0.377811,0.228305
openstack/kolla-ansible,I2df1eff4e9eda42127db5b0bfed4f84b6955c763,1,0,0.9545,1.6094,0.5,1,8.0,89,0,Bug Fix,0,0,0,44,0.06577,0.0,1,0.0,4,1,0,0.8157,0.0,4.0,8.37,18.2,1,0,0.0,0,17.8,0,0,0,0,0,"docs: Fix reference to Libvirt TLS
[SEP]
FILES CHANGED:
doc/source/reference/compute/libvirt-guide.rst (+2, -2)
",3.500651,0.545975,1.795195,-0.370473,-0.465699,0.625805,0.03551,0.584264,0.380806,0.288824,0.025473,-0.545439,0.330253,-0.439448,-0.327701
openstack/charm-keystone,Id2a92a134c2e663b3dca10dbc36dd7c7afc9c86b,1,0,1.0,1.7918,0.4,2,10.0,100,0,Feature,0,0,0,1,0.026316,0.4655,0,0.4655,1,2,0,0,0.7219,0.5,10.56,16.0,0,0,0.0,1,16.6667,0,0,0,0,0,"Use juju-exec in chron jobs for juju3 support
[SEP]
FILES CHANGED:
tox.ini (+1, -0)
templates/keystone-fernet-rotate-sync (+2, -2)
",2.371796,0.806613,1.102969,0.308707,0.924645,-0.704675,0.234048,0.239592,-0.750156,-0.075114,-0.35168,0.106628,0.087762,0.023909,0.943428
openstack/charm-designate,I48a04ac619204ba109d87ca05de7cbe308592486,1,1,1.0,2.6391,0.1538,2,20.0,538,0,Bug Fix,0,0,0,1,0.2,1.0,0,1.0,2,1,0,1.0,0.9612,1.5,22.98,17.33,0,0,0.6154,0,38.4286,0,6,0,16,0,"Add check to expose internal endpoints

Currently, the charm ignores the use-internal-endpoints config
option that is being inherited from the Openstack Layer. This
patch adds a check to ensure that the internal endpoint is exposed
if this is set to True.

Closes-bug: #1995188
(cherry picked from commit 8a4940bbb108124246ad3ae830964cf58dfc9ec3)
(cherry picked from commit 4d50f9ab40c8948771a7338949a84a3899c426d7)
(cherry picked from commit 1a0d3f4765ad359f6c9dd6d384377c859e7a36fe)
[SEP]
FILES CHANGED:
unit_tests/test_designate_handlers.py (+7, -1)
src/reactive/designate_handlers.py (+4, -1)
",-2.730703,-0.44067,-0.10423,-2.115006,1.419658,0.023135,0.704828,-0.111161,0.334673,0.296363,0.081151,0.31382,0.189904,-0.079062,-0.012805
openstack/ironic,Ic9dea4f51d82866be8ac16242a79237c789b9745,1,0,0.8667,1.9459,0.5,1,14.5,408,0,Bug Fix,0,0,0,15,0.189873,1.0,0,0.8667,2,1,0,0.9559,0.0,2.0,43.34,14.77,0,0,0.0,0,58.2857,0,0,0,0,0,"Fix debug log message argument formatting

The format string is expecting a dictionary with keys matching
those used in the format string. Any unused parameters will
cause an ""not all arguments converted during string formatting""
exception.

The quote style is also changed from double to single quotes to
match the other logging statements in the code.
[SEP]
FILES CHANGED:
ironic/conductor/steps.py (+3, -3)
",-0.457191,-2.347464,-0.123633,0.975325,0.137038,0.150748,-0.065142,-0.358958,0.831951,0.552819,-0.549244,0.021958,-0.079533,0.166161,-0.047161
openstack/ironic,I2a6bca3550819b98adbaffe315f77427b8a43d62,1,0,0.9565,2.6391,0.1538,2,12.5,539,0,CI,0,0,0,23,0.009842,1.0,0,0.9565,2,2,0,0.9565,0.9612,2.0,35.1,13.53,0,0,0.0,1,38.5,0,0,0,0,0,"Catch any exception for Cleaning

No exception is used to communicate back, the exceptions
are used to catch failures, and if we don't catch other
possible exceptions leaving cleaning states, we may not clean
up state properly.

So instead of specific exceptions, we just catch any exception
like is used earlier in the same method.

Inspired by https://review.opendev.org/c/openstack/ironic/+/866856
and investigation through the code base as a result of inability
to clean the node.
[SEP]
FILES CHANGED:
releasenotes/notes/catch-all-cleaning-exceptions-1317a534a1c9db56.yaml (+8, -0)
ironic/conductor/cleaning.py (+3, -2)
",-0.778736,-1.235038,0.651735,0.224814,-1.060641,-0.215981,0.640874,-0.501938,0.011582,0.223288,-0.126311,-0.177983,0.205296,0.075684,-0.088879
openstack/kolla-ansible,I9f845a7bdf5055165e199ab1887ed3ccbfb9d808,1,1,0,2.5649,0.0,3,7.56,623,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.8164,1.4591,3.33,1.35,14.2,1,0,0.0,1,47.9231,0,6,0,14,0,"Fix faulty precheck for RabbitMQ

When using externally managed certificates, according to [1],
one should set `kolla_externally_managed_cert: yes` and ensure
that the certificates are in the correct place.

However, RabbitMQ precheck still expects the certificates to be
available on the controller node. This is incorrect.

Fix by not running the tasks in question when `kolla_externally_managed_cert: yes`

[1] https://docs.openstack.org/kolla-ansible/latest/admin/tls.html

Closes-Bug: 1999081
Related-Bug: 1940286
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1999081-769f1012263a48fd.yaml (+6, -0)
ansible/roles/rabbitmq/defaults/main.yml (+2, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+4, -0)
",-2.120778,0.309621,0.25286,0.104109,-0.097483,0.155526,-0.573291,-0.156479,0.1248,0.057892,0.246333,-0.248166,-0.062641,-0.031058,-0.211677
openstack/taskflow,I048faf06d89ebf980efe0598e647f2ec89f65ada,1,1,0.7317,5.0499,0.0645,6,16.0,249,0,Bug Fix,0,0,0,82,0.007398,0.0,0,0.0,4,2,0,0.0,1.9653,2.83,34.61,12.65,0,0,0.7161,1,1.5962,0,6,0,8,0,"Fix parsing of zookeeper jobboard backend options

Fix the zookeeper backend options when values are passed as strings,
a ""False"" string is now treated as the False boolean.

Closes-Bug: #1999174
[SEP]
FILES CHANGED:
taskflow/persistence/backends/impl_zookeeper.py (+3, -1)
releasenotes/notes/fix-zookeeper-option-parsing-f9d37fbc39af47f4.yaml (+7, -0)
taskflow/jobs/backends/impl_zookeeper.py (+3, -1)
taskflow/tests/unit/test_utils_kazoo_utils.py (+67, -0)
taskflow/utils/kazoo_utils.py (+21, -8)
taskflow/tests/unit/jobs/test_zk_job.py (+44, -0)
",0.684297,-1.033892,-0.356592,0.245863,0.019447,0.266835,-0.325454,-0.039143,0.256496,-0.080658,-0.146458,-0.021457,0.308049,-0.074694,-0.058259
openstack/ironic,Ib1850c58d1670c3555ac9b02eb7958a1b440a339,1,0,0.8889,2.9957,0.1053,3,14.25,370,0,Bug Fix,0,0,0,9,0.005297,1.0,0,0.8889,6,2,0,0.9571,1.5294,4.0,55.82,11.31,1,0,0.2105,1,18.5,0,0,0,0,0,"Fix ""'NoneType' object is not iterable"" in RAID

Do not update `raid_configs` if operation is synchronous.
First, it is not needed, second, it will not be cleaned
up by async periodics. As the result the data remains
on the node and causes errors the next time node is in
cleaning state.

Story: 2010476
Task: 47037
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+6, -2)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+4, -0)
releasenotes/notes/fix-nonetype-object-is-not-iterable-0592926d890d6c11.yaml (+7, -0)
",0.405884,-1.883118,0.15371,-0.005852,-0.749425,0.228169,0.336408,-0.484482,0.233356,-0.092613,0.159094,-0.45531,-0.149334,0.399747,-0.326881
openstack/openstack-ansible-lxc_hosts,Ic54d160c7329aebb7769c407d3af7b0f66145bcc,1,0,0.9111,1.0986,0.0,2,9.25,386,0,Feature,0,0,0,45,0.031646,1.0,0,0.9111,1,1,0,1.0,1.0,1.0,16.81,10.19,0,0,0.0,0,128.6667,0,0,0,0,0,"Ensure tar is installed on LXC host

Tar is required for LXC to create base container using lxc-create. When
it's absent lxc-create exits with code 1 without any output on this
task [1]

[1] https://opendev.org/openstack/openstack-ansible-lxc_hosts/src/commit/ef721dbf13db8f3578b45791ac67c4815bd8c59a/tasks/lxc_cache_create.yml#L71
[SEP]
FILES CHANGED:
vars/debian-host.yml (+1, -0)
vars/redhat-host.yml (+1, -0)
",-1.891731,1.864811,-0.865379,-0.30927,0.334514,-0.62109,0.858386,0.325103,0.386976,0.350765,0.021227,-0.542921,0.145536,-0.097433,-0.031548
openstack/openstack-ansible-os_manila,I16848db3607a76519a8c4bf06494e2a82ab4f451,1,0,0.1579,0.6931,0.0,1,3.0,87,0,Feature,0,0,0,19,0.2375,0.5,0,0.0789,0,1,0,1.0,0.0,0.0,-50.01,27.87,1,0,0.0,0,43.5,0,0,0,0,0,"Update .gitreview for stable/zed
[SEP]
FILES CHANGED:
.gitreview (+1, -0)
",3.276268,1.764546,1.331442,0.018191,0.514761,0.306931,0.518673,-0.170778,-0.0832,-0.181158,-0.692165,-0.679638,0.056452,0.415495,0.367519
openstack/openstack-ansible-os_barbican,I7d61d990b973bea538c7ca2ae059f8bea1bb2039,1,0,0.913,0.6931,0.0,1,9.25,353,0,Feature,0,0,0,46,0.032303,0.0,0,0.0,1,1,0,0,0.0,1.0,21.39,10.19,0,0,0.0,0,176.5,0,0,0,0,0,"Add /healthcheck to main

With [1] we've updated barbican api paste file and added healthcheck
bit. However, it was missed to add /healthcheck to main, so it was not
working at the end.

[1] https://opendev.org/openstack/openstack-ansible-os_barbican/commit/78a1984517b6164dd92a9e23c81b78c18db17459
[SEP]
FILES CHANGED:
templates/barbican-api-paste.ini.j2 (+1, -0)
",-1.39108,1.010162,-1.12316,-0.626188,-0.14211,-0.183973,0.996086,-0.0378,0.049686,0.358949,0.100198,-0.379455,0.18195,-0.032852,0.048008
openstack/kolla-ansible,I51c8023b260eb40b2eaa91bd276b46890c215c25,1,0,0,4.7875,0.0,34,12.22,788,0,Feature,0,0,0,0,0.0,1.0,0,0.0,4,4,0,0.8171,4.9587,3.88,42.92,12.53,1,0,0.0,1,6.5667,0,0,0,0,0,"Add a flag to handle RabbitMQ high availability

A combination of durable queues and classic queue mirroring can be used
to provide high availability of RabbitMQ. However, these options should
only be used together, otherwise the system will become unstable. Using
the flag ``om_enable_rabbitmq_high_availability`` will either enable
both options at once, or neither of them.

There are some queues that should not be mirrored:
* ``reply`` queues (these have a single consumer and TTL policy)
* ``fanout`` queues (these have a TTL policy)
* ``amq`` queues (these are auto-delete queues, with a single consumer)
An exclusionary pattern is used in the classic mirroring policy. This
pattern is ``^(?!(amq\\.)|(.*_fanout_)|(reply_)).*``
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+3, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+3, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+3, -0)
ansible/roles/sahara/templates/sahara.conf.j2 (+3, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+3, -0)
ansible/roles/heat/templates/heat.conf.j2 (+3, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+3, -0)
ansible/roles/designate/templates/designate.conf.j2 (+3, -0)
ansible/roles/solum/templates/solum.conf.j2 (+3, -0)
ansible/roles/rabbitmq/templates/definitions.json.j2 (+8, -0)
releasenotes/notes/add-a-flag-to-handle-rabbitmq-high-availability-44c709318be6cb7b.yaml (+10, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+3, -0)
ansible/roles/nova/templates/nova.conf.j2 (+3, -0)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+3, -0)
ansible/roles/senlin/templates/senlin.conf.j2 (+3, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+3, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+3, -0)
ansible/roles/zun/templates/zun.conf.j2 (+3, -0)
ansible/roles/murano/templates/murano.conf.j2 (+3, -0)
ansible/roles/vitrage/templates/vitrage.conf.j2 (+3, -0)
ansible/roles/watcher/templates/watcher.conf.j2 (+3, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+3, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+3, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+3, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+3, -0)
ansible/roles/trove/templates/trove.conf.j2 (+3, -0)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+3, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+3, -0)
ansible/group_vars/all.yml (+2, -0)
doc/source/reference/message-queues/rabbitmq.rst (+9, -0)
ansible/roles/manila/templates/manila.conf.j2 (+3, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+3, -0)
",-2.774761,-0.259829,1.403998,0.48264,0.739973,0.254161,-0.519093,-0.149459,0.034649,0.085117,-0.271651,0.053032,0.190972,-0.29927,-0.21263
openstack/ironic-python-agent,Ic0e7daea7ec4ce0806cd126c27166f84690c5d9e,1,0,1.0,1.0986,0.0,1,17.67,368,0,Bug Fix,1,0,0,3,0.029412,1.0,0,1.0,3,1,0,0.9259,0.0,3.0,38.86,13.1,1,0,1.0,0,122.6667,0,0,0,0,0,"Fix create configuration unit tests

The unit tests for create_configuration give different result if
ran on a bios or uefi booted machine because they get the
partition table type value based on the utils function
get_node_boot_mode.
Let's mock the boot_mode as we do in other tests to get an
independent result.
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/test_hardware.py (+2, -0)
",-0.266033,-1.241596,-0.199774,0.9214,0.312137,-0.193549,0.413897,-0.321114,0.198249,-0.475745,-0.015034,-0.30882,-0.251598,-0.015335,0.17921
openstack/kolla,Iad83132b61efadbf09aa9aa2edf96235085764c6,1,1,0,2.7081,0.2857,2,7.0,392,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.8176,1.0,2.5,14.42,13.28,1,0,0.0,1,26.1333,0,6,0,13,0,"relay non-zero exit codes when creating openvswitch bridges

Calls to `ovs-vsctl` in `ovs_ensure_configured.sh` did not get checked
for errors.
This can cause false success statuses when
the script is run by automation tools such as ansible.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/870540

Closes-bug: #1999778
[SEP]
FILES CHANGED:
docker/openvswitch/openvswitch-db-server/ovs_ensure_configured.sh (+3, -4)
releasenotes/notes/bug-1999778.yaml (+7, -0)
",-1.010026,0.703757,-0.527755,-0.140322,-0.589356,-0.194898,0.316739,-0.116597,0.097029,-0.374667,0.240167,-0.623634,0.260015,-0.018229,0.043463
openstack/openstack-ansible,Ie1735103a7c60f73230ecac12ca996d845f5336b,0,0,0.875,2.0794,0.0,1,6.33,605,0,Doc,0,0,0,16,0.188235,1.0,0,0.875,3,1,0,0.9,0.0,3.0,-37.07,15.87,1,0,0.0,0,75.625,0,0,0,0,0,"Block unauthenticated Ironic API endpoints from untrusted networks

Ironic and Ironic inspector have some potentially unauthenticated
endpoints which are designed for the Ironic Python Agent to make
callbacks to the Ironic API during node deployment [1] [2] [3].

Ensure that these endpoints are never accessible from an untrusted
network.

[1] https://docs.openstack.org/api-ref/baremetal/#agent-lookup
[2] https://docs.openstack.org/api-ref/baremetal/#agent-heartbeat
[3] https://docs.openstack.org/api-ref/baremetal-introspection/#ramdisk-callback
[SEP]
FILES CHANGED:
inventory/group_vars/haproxy/haproxy.yml (+7, -0)
",-3.408512,2.696939,0.075978,1.032117,0.432115,-0.031839,-0.344671,-0.028874,-0.195594,-0.01363,-0.165295,0.355862,0.362442,-0.254491,-0.165224
openstack/openstack-ansible-rabbitmq_server,I968e6f1e9c72b0bf04b909f285495b0860279c77,1,0,0.5,2.8332,0.375,4,4.87,514,0,Feature,0,0,0,4,0.142857,1.0,0,0.5,2,3,0,0.5,2.0,1.0,57.03,9.07,0,0,0.0,1,30.2353,0,0,0,0,0,"Upgrade rabbitmq and erlang version

Erlang 24.2.2-1 has been completely removed from cloudsmith repo.
We are constantly hitting issues related to the fact that package
versions disappear from this repo.
Because Xena will move to 'Extended Maintenance' soon, I think the best
option would be to let OSA install any 24.3.* erlang version.

Because erlang 24.2.* is not available anymore and 24.3.* requires
RabbitMQ >=3.9.15, RabbitMQ must be upgraded as well.
[SEP]
FILES CHANGED:
releasenotes/notes/erlang_24_wildcard-f98bea4c7df0dc23.yaml (+4, -0)
vars/redhat.yml (+2, -2)
vars/debian.yml (+2, -2)
tox.ini (+2, -2)
",-0.68632,-1.006457,0.330954,0.043383,-0.365978,-0.115244,0.969677,0.671888,-0.63145,0.670176,0.442775,0.005194,-0.339057,-0.017926,0.325183
openstack/kolla,Ie810149de353e12655994ba9ef371c85dea7f7a8,1,0,0,1.6094,0.5,1,8.2,358,0,Feature,0,0,0,0,0.0,0.5,0,0.0,3,1,0,0.8187,0.0,3.0,2.49,14.99,1,0,0.0,0,71.6,0,0,0,0,0,"Change libvirt-exporter repo to Tinkoff

libvirt-exporter repo has been moved from
AlexZzz (https://github.com/AlexZzz/libvirt-exporter)
to Tinkoff organization and is maintained by this organization
now. The old link redirects to the new one.
This commit prevents unnecessary redirect and adds clarity.
[SEP]
FILES CHANGED:
docker/prometheus/prometheus-libvirt-exporter/Dockerfile.j2 (+2, -2)
",-0.345318,0.648494,-0.938317,0.845716,-0.292208,-0.015947,0.696049,0.20434,-0.630212,-0.393226,0.26602,0.115987,0.004783,0.20579,-0.283307
openstack/openstack-ansible,Ic0b125715527e4f3fba5238c3f7577e83c93e568,1,0,0.9149,3.7842,0.3488,2,17.2,553,0,Feature,0,0,0,47,0.032982,1.0,0,0.9149,1,1,0,0.871,0.5186,0.5,46.74,15.25,0,0,0.0,0,12.5682,0,0,0,0,0,"Define name for all collections in a-r-r

At the moment it's not possible to override collection, since we merge
user and default collections by name. So in case it's needed to
override git repo or user wants to use galaxy, they can only extend
installable collections. At the same time in envs with limited
connectivity it might be impossible to fetch data from third-party repos
and replacement is needed.

So to allow proper overrides we place collection name and source
keys regardless of type.
[SEP]
FILES CHANGED:
ansible-collection-requirements.yml (+25, -13)
scripts/get-ansible-collection-requirements.yml (+3, -2)
",-0.793878,-2.14684,0.503902,0.537488,-0.117424,-0.660484,0.494008,-0.259304,-0.404396,0.351022,-0.263596,-0.162832,0.312954,0.044853,-0.2849
openstack/openstack-ansible,I807985f68e1a090c5b3c055a78c16b79beeec8c5,1,0,0.9167,2.0794,0.1429,1,14.5,390,0,Bug Fix,0,0,0,48,0.032698,0.0,0,0.0,1,1,0,0.875,0.0,1.0,53.55,12.01,0,0,0.0,0,48.75,0,0,0,0,0,"Do not run dstat by default

Fixing dstat runtime in gate resulted in a side-effect, that dstat_graph
tries to run even outside of the gates, since GATE_EXIT_RUN_DSTAT
was always defaulted to True. Now we enable dstat only when ZUUL_PROJECT
variable is defined. In it's turn ZUUL_PROJECT is set only in zuul pre-run
tasks for our jobs.
[SEP]
FILES CHANGED:
scripts/scripts-library.sh (+6, -1)
",-1.32149,-0.785703,-0.02299,0.74511,0.462499,-0.000634,-0.42965,-0.391591,-0.237204,-0.135697,0.346192,-0.340005,-0.241685,-0.128211,0.3409
openstack/openstack-ansible,Id34fb425c76bef7615bcbf1334d7a84ac6422fa8,1,0,0.9184,1.6094,0.0,1,14.67,637,0,Bug Fix,0,0,0,49,0.03322,1.0,0,0.9184,1,1,0,0.8788,0.0,1.0,36.21,14.05,0,0,0.0,0,127.4,0,0,0,0,0,"Unset OSA-defined variables for bootstrap

We've introduced couple of new ENV vars that we define in
openstack-ansible.rc file. While they're working properly, we still don't
want them to be used during bootstrap process, as in case of
bootstrap failure somewhere in the middle of execution, like before
our plugins collection being installed, next bootstrap re-runs will fail
with smth like `Invalid play strategy specified: openstack.osa.linear`

In order to fix this we set default values for ANSIBLE_TRANSPORT and
ANSIBLE_STRATEGY that we clean out after bootstrap is completed.
[SEP]
FILES CHANGED:
scripts/bootstrap-ansible.sh (+4, -0)
",-1.150476,-0.945076,0.909822,0.33169,0.133485,-0.079796,0.590174,-0.196647,-0.093381,-0.210595,0.485686,-0.145626,-0.021926,-0.239291,0.035441
openstack/openstack-ansible,I86d44499073f0571a529d81ed3be713996e5f339,1,0,0.92,1.6094,0.5,2,16.75,529,0,Feature,0,0,0,50,0.033807,1.0,0,0.92,1,1,0,0.8824,1.0,1.0,10.53,15.06,0,0,0.0,0,105.8,0,0,0,0,0,"Prevent bootstrap failure when all roles/collections are overriden

At the moment we assume that scenario when all roles or collections
provided by ansible-role/collection-requirements won't be overwritten.
As if they do, previous set_fact will be skipped and
galaxy_collections_list/clone_roles will remain undefined.

To avoid failure and to allow to fully override roles/collections we
define default for the task that aims to merge default items with
user-provided ones.
[SEP]
FILES CHANGED:
scripts/get-ansible-role-requirements.yml (+1, -1)
scripts/get-ansible-collection-requirements.yml (+1, -1)
",-0.971375,-1.533687,0.380297,0.581688,0.357715,-0.576955,-0.070352,-0.373699,0.080222,-0.118427,-0.35963,-0.378224,-0.041762,-0.238609,0.1209
openstack/octavia,I9deaea182568a23e8c1104d806273dc87f5caa72,1,0,1.0,4.4886,0.0,4,17.0,333,0,Bug Fix,0,0,0,3,0.022388,0.6,0,0.6,7,2,0,0.5906,1.4152,4.75,51.9,14.64,1,0,0.5341,1,3.7416,0,0,0,0,0,"Fix hm operating status to ONLINE in single lb call

So far, Health Monitor was not set to ONLINE when single-call-creates
were used.

This patch adds a database task which sets the operating status of all
the enabled Health Monitors of a LB to ONLINE.

Story 2008400
Task 41333
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+47, -0)
octavia/controller/worker/v2/tasks/database_tasks.py (+33, -0)
releasenotes/notes/fix-hm-operating-status-online-in-single-lb-call-214a7ca22937a877.yaml (+5, -0)
octavia/controller/worker/v2/flows/listener_flows.py (+3, -0)
",-0.642139,-1.434779,-0.343245,0.43444,-0.085013,0.272661,-0.776963,0.222541,0.264841,0.218928,-0.104718,0.215833,0.259733,0.314753,0.145597
openstack/openstack-ansible-os_neutron,Ib6d69bb2ce340b50140216e2abf236a1da93e46b,1,0,0,0.6931,0.0,1,17.6,696,0,Feature,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,19.77,15.22,0,0,0.0,0,348.0,0,0,0,0,0,"Create separate lock path for neutron-ovn-metadata-agent

root user/group ownership of the neutron-ovn-metadata service caused
the neutron lock dir to be owned by root:root, which caused issues
with neutron-server's ability to write the OVN hash ring lock file
to /run/lock/neutron and prevented the creation of networks.

It appears neutron-ovn-metadata-agent needs access to the OVS DB
schema via unix:/var/run/openvswitch/db.sock, which is owned by root,
so a separate lock path has been created for the metadata agent to
workaround this.

FWIW, this issue manifested with upstream Neutron commit
536498a29a4e7662a4d0b1bb923e2521509ad77a.
[SEP]
FILES CHANGED:
vars/main.yml (+1, -0)
",-2.282589,-0.523331,1.340353,-0.630453,0.350066,-0.724516,0.510905,0.484059,-0.032351,-0.488806,-0.12466,-0.112802,-0.091658,0.174906,0.147535
openstack/octavia,I98cce51a2536bcf204e5753ce4984af57e7e69e3,1,0,0.7349,3.5835,0.2286,5,16.0,258,0,Bug Fix,0,0,0,83,0.007385,0.75,0,0.5512,7,2,0,0.592,2.2811,5.2,2.89,17.65,0,0,0.3429,1,7.1667,0,0,0,0,0,"Fix listener creation with fully-populated API

Creating a listener with the fully-populated API was broken in SINGLE
topology, one required parameter was missing from the flow.

Story 2010488
Task 47060
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+3, -3)
octavia/controller/worker/v1/flows/load_balancer_flows.py (+8, -1)
releasenotes/notes/fix-fully-populated-lb-with-listener-92a369ea8d57e8f5.yaml (+5, -0)
octavia/tests/unit/controller/worker/v1/flows/test_load_balancer_flows.py (+3, -3)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+8, -1)
",0.436056,-1.961731,-0.000385,0.010224,-0.441191,0.655172,-0.726913,0.040696,0.069389,-0.194929,-0.278768,0.45543,-0.061059,0.244595,0.35358
openstack/kolla,I08fe2827bc58baa95d396daf28de1079e3df4f77,1,0,0.8605,2.3026,1.0,2,6.0,86,0,Feature,0,0,0,43,0.046892,0.6,0,0.5163,2,1,0,0.8199,0.9911,2.0,-53.05,29.07,0,0,0.0,0,8.6,0,0,0,0,0,"grafana: remove SHA1 workaround
[SEP]
FILES CHANGED:
docker/grafana/Dockerfile.j2 (+0, -5)
docker/base/Dockerfile.j2 (+0, -4)
",2.415954,1.65832,1.12285,-0.574896,0.087608,0.786432,-0.191868,-0.396908,0.028118,0.532259,0.344315,0.046694,0.000471,-0.287847,0.073566
openstack/openstack-ansible-os_nova,I3220de5863c9c3af418e71774c103c4712b16086,1,0,0.9216,0.6931,0.0,1,9.2,419,0,Feature,0,0,0,51,0.03439,1.0,0,0.9216,1,1,0,1.0,0.0,1.0,8.07,12.38,0,0,0.0,0,209.5,0,0,0,0,0,"Enable rbd download when nova_glance_rbd is in use

With original patch [1] I somehow missed to define enable_rbd_download
along with adding rbd_user/pool/conf. However, neither of these
options are taken into account if enable_rbd_download is set to false,
which is the default value.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_nova/+/828897
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -0)
",-1.741357,1.370345,-0.443749,0.440889,-0.287673,-0.078015,0.258445,-0.208361,0.098141,-0.01219,0.275533,-0.206721,-0.28494,-0.24442,-0.009402
openstack/ironic,Id6723e92efb62f8ca03099f15c90580cec887ddd,1,0,0.9583,2.8332,0.0625,2,17.25,452,0,Bug Fix,0,0,0,24,0.010213,0.0,0,0.0,2,2,0,0.9577,0.5436,2.0,52.0,13.28,0,0,0.0,1,26.5882,0,0,0,0,0,"Fix grub config path default

Grub2 looks for files in different paths depending on the boot mode
of the binary. Previously the grub_config_path setting was defaulted
to the path used exclusively for BIOS booting, which meant anyone
using it had to override the setting. Now, we've set the default
to the default for UEFI booting, and the world should be a happier,
and less override filled place.
[SEP]
FILES CHANGED:
releasenotes/notes/fix-grub2-uefi-config-path-f1b4c5083cc97ee5.yaml (+14, -0)
ironic/conf/default.py (+1, -1)
",-0.474982,-1.721435,0.228913,0.950292,-0.119616,-0.017186,0.339999,-0.210652,0.01797,0.116435,-0.062444,-0.056471,-0.146861,0.007303,0.218506
openstack/charm-ceph-mon,Ic95aae6b5981a6df1e0b3c310bcef8018c494a24,1,1,0,2.3979,0.0,1,6.0,396,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,50.93,9.07,1,0,0.0,0,36.0,0,12,0,13,0,"Create a key for ceph-osd for crash module auth

This will be set on the osd relation,
so the ceph-osd charm can use this key for auth
by the crash reporting module.

ref. https://docs.ceph.com/en/latest/mgr/crash/

See https://review.opendev.org/c/openstack/charm-ceph-osd/+/869139
for how this key is used by ceph-osd.

Closes-Bug: #2000630
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+10, -0)
",-2.156745,0.877112,-0.037635,-1.008759,-0.107508,-0.382698,0.471372,0.106324,0.025661,-0.218129,-0.157003,-0.037249,-0.076967,-0.017683,-0.123248
openstack/charm-rabbitmq-server,I44849aac8ead5e3e660ccd9d1305cc991461d02d,1,0,1.0,3.7842,0.814,2,7.12,364,0,Bug Fix,0,0,0,2,0.004376,0.4833,0,0.4833,0,2,0,1.0,0.9808,0.0,66.02,9.87,1,0,0.0,1,8.2727,0,0,0,0,0,"Fix up the tox.ini to work with tox 4

* unpin the requires for pip, virtualenv and setuptools
* remove the pip.sh installer file.
* split the passenv to to have a var on each line (overcomes new ','
  requirement).
* switch charm-tools to 2.8.4 to remove ruamel requirement that doesn't
  work on Python 3.10
[SEP]
FILES CHANGED:
pip.sh (+0, -18)
tox.ini (+8, -17)
",0.023716,-1.335973,0.12862,0.09611,0.055821,-0.683804,0.387388,0.114317,-0.568489,0.512179,-0.214026,-0.379572,0.083504,0.488794,0.108026
openstack/kolla-ansible,Ic8624b2e956b1f48f5fb96d6d8a0150b67236d20,0,0,1.0,3.7136,0.05,5,6.0,1049,0,Doc,0,0,0,2,0.04,0.6471,0,0.6471,4,3,0,0.8178,2.151,3.2,-15.45,12.77,1,0,0.0,1,25.5854,0,0,0,0,0,"Add support to configure Huawei backends in Cinder

This change adds the ability to configure Huawei backends in Cinder
as described in [1] by adding the additional configuration XML files
to the cinder-volume containers. However,¬†this¬†change does not
provide the default configuration options for the cinder.conf due¬†to
the¬†wide range of Huawei hardware¬†that is¬†supported. Operators¬†may
also wish to configure multiple backends,¬†so¬†they¬†should use the
standard method¬†of¬†overriding¬†backend sections to use these XML
files,¬†as described in¬†[2].

1. https://docs.openstack.org/cinder/latest/configuration/block-storage/drivers/huawei-storage-driver.html
2. https://docs.openstack.org/kolla-ansible/latest/admin/advanced-configuration.html#openstack-service-configuration-in-kolla

Implements: blueprint cinder-huawei-backend
Co-Authored-By: Juan Pablo Suazo <jsuazo@whitestack.com>
Co-Authored-By: Maksim Malchuk <maksim.malchuk@gmail.com>
[SEP]
FILES CHANGED:
ansible/roles/cinder/templates/cinder-volume.json.j2 (+9, -2)
releasenotes/notes/feature_huawei-backend-a16124fb96d9c080.yaml (+10, -0)
ansible/group_vars/all.yml (+2, -0)
ansible/roles/cinder/tasks/external_huawei.yml (+11, -0)
ansible/roles/cinder/tasks/config.yml (+6, -0)
",-4.209866,2.839449,2.344819,0.215124,-0.103687,0.086459,-0.256058,0.125298,0.177106,-0.358501,-0.271473,0.755732,-0.121884,-0.257507,-0.157351
openstack/openstack-ansible-os_ironic,I0d32eb17594800d3df2b7197b002e9aac617185f,1,0,0.8235,1.0986,0.5,1,9.0,91,0,Feature,0,0,0,17,0.184783,0.9412,0,0.7751,1,1,0,0,0.0,1.0,28.5,12.49,0,0,0.0,0,30.3333,0,0,0,0,0,"Update IPA image for the Zed release
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",4.36086,0.067328,2.846844,-0.081541,-0.102274,0.903012,1.321805,1.51734,1.126408,-0.69987,-0.296822,0.365074,-0.310375,0.556598,-0.326404
openstack/openstack-ansible,I63af16c3deb8a66a4ba4aad56fa5ed5df988d7f8,1,0,0.9231,2.1972,0.5,1,14.0,276,0,CI,1,0,0,52,0.03504,0.0,0,0.0,4,1,0,0.8857,0.0,4.0,51.62,12.27,0,0,1.0,0,30.6667,0,0,0,0,0,"Sync ZFS pool names

Currently in AIO we have 2 possible path depending on presence of
second drive in CI VM. For ZFS scenario we have pool name desynced
that wasn't catched before as issue highly depends on CI providers.
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/tasks/prepare_data_disk.yml (+4, -4)
",0.542165,-1.84908,0.227571,0.574869,-0.220257,0.251011,0.329371,-0.050445,-0.415418,-0.126206,-0.291092,-0.023008,0.188262,-0.181243,0.080766
openstack/openstack-ansible,I577777e80e8543205138e058076ad65b3ed59871,1,0,1.0,2.1972,0.5,2,7.5,145,0,Doc,0,0,0,11,0.115789,1.0,0,1.0,2,1,0,0.8889,1.0,2.0,13.1,11.0,0,0,0.0,0,16.1111,0,0,0,0,0,"Correct series names for documentation

The upgrade guide renders the wrong release names.
[SEP]
FILES CHANGED:
doc/source/conf.py (+2, -2)
deploy-guide/source/conf.py (+2, -2)
",2.476333,-1.351899,0.740538,0.378764,-0.132647,0.519807,0.065346,0.032925,0.386915,-0.192736,-0.338388,0.085907,-0.228321,0.173595,-0.714608
openstack/ansible-role-systemd_networkd,I0ef53631989ea2dc12d2540edeed95d0a466353b,1,0,1.0,1.0986,0.5,1,17.5,255,0,Bug Fix,0,0,0,12,0.116505,0.0,0,0.0,1,1,0,0,0.0,1.0,39.21,13.86,0,0,0.0,0,85.0,0,0,0,0,0,"Fix static routes to use Destination rather than Source key

The current template results in a default route being added to the
routing table rather than a route specific to the destination
requested.
[SEP]
FILES CHANGED:
templates/systemd-network.j2 (+1, -1)
",0.538481,-1.263279,-0.15306,1.17571,0.466591,0.296339,-0.200899,-0.270687,0.447963,0.108928,-0.776372,0.331737,-0.276528,-0.060479,-0.380555
openstack/ansible-role-systemd_networkd,Iee71e9839d4c8d318c2c36152d966dd5a1b88111,1,0,1.0,1.6094,0.5,1,14.0,303,0,Feature,0,0,0,13,0.12381,1.0,0,1.0,1,1,0,1.0,0.0,1.0,43.57,14.17,0,0,0.0,0,60.6,0,0,0,0,0,"Handle omitted variables which appear as empty strings

Changes to external roles cause some variables to be passed in
as empty strings which result in invalid config and InvalidArgument
errors.

This could be addressed here or in the calling role.
[SEP]
FILES CHANGED:
templates/systemd-network.j2 (+2, -2)
",0.269148,-1.926281,0.065506,0.558092,0.029938,-0.029975,-0.396107,-0.835619,0.144268,0.521753,-0.458415,-0.1134,0.391418,-0.379579,-0.387562
openstack/openstack-ansible,Ic5570bfe9f0f54d1ea1e067834c11e6c390a2686,1,0,0.9245,5.989,0.2864,6,18.8,654,0,Feature,0,0,0,53,0.035523,0.0,0,0.0,4,3,0,0.8919,2.2901,2.5,38.35,16.46,0,0,0.1432,0,1.6391,0,0,0,0,0,"Add is_nest property for container_skel

The main purpose of that patch is to allow creation of ""virtual""
container_skel, that will not generate any containers in inventory,
but will contain all containers of corresponsive hosts. That might be
useful in usecases like AZs, or when deployer simply wants to create
custom groups and include all bare metal hosts along with all
containers on them to the same group. Such behaviour can be triggered
when empty belongs_to is provided for container_skel along with is_nest
property. Then container_skel item will contain host-containers and it's
children.
[SEP]
FILES CHANGED:
doc/source/reference/inventory/configure-inventory.rst (+125, -0)
etc/openstack_deploy/openstack_user_config.yml.pod.example (+21, -101)
doc/source/user/l3pods/example.rst (+16, -0)
etc/openstack_deploy/env.d/pods.yml.example (+44, -0)
tests/test_inventory.py (+57, -0)
osa_toolkit/generate.py (+21, -13)
",-1.444812,-1.462378,0.846517,0.564557,0.498902,-0.629968,0.09559,-0.254648,-0.066679,-0.308251,-0.207536,-0.149166,-0.034719,0.069783,-0.121738
openstack/openstack-ansible-haproxy_server,Ib1462c04d1a0820a37998f989e2ed16566f71f54,1,0,1.0,2.4849,0.3636,3,18.0,402,0,Bug Fix,0,0,0,14,0.12844,1.0,0,1.0,1,2,0,1.0,1.4354,1.0,14.67,19.05,0,0,0.0,0,33.5,0,0,0,0,0,"Fix dict object key error when haproxy interfaces not defined

The ternary options appear to be getting evaluated whether they
are used or not, so item['interface'] is always accessed.

This patch aims to check for the key's presence before performing
ternary operations, or use Ansible variables to postpone evaluation
until absolutely necessary.
[SEP]
FILES CHANGED:
templates/service.j2 (+1, -1)
handlers/main.yml (+2, -1)
vars/main.yml (+4, -2)
",-0.235738,-2.316918,-0.041211,0.694597,-0.017896,-0.232839,-0.309572,-0.631016,0.245869,0.385932,-0.485836,-0.368503,0.080175,-0.308238,-0.219622
openstack/openstack-ansible,I514b9352043bb84ae6061cd4d30433bb2376fb4c,1,0,1.0,1.6094,0.0,1,12.0,110,0,CI,1,0,0,15,0.125,0.0,0,0.0,3,1,0,0.8947,0.0,3.0,60.71,8.13,0,0,1.0,0,22.0,0,0,0,0,0,"Add Glance tempest plugin repo to testing SHA pins list
[SEP]
FILES CHANGED:
playbooks/defaults/repo_packages/openstack_testing.yml (+4, -0)
",2.220836,-0.053953,0.543183,0.384386,0.80765,-0.486983,0.50707,1.509018,0.07301,-0.485042,-0.059746,-0.386905,0.174189,0.017123,-0.491469
openstack/openstack-ansible-os_neutron,Ie532573cc04722d18915996c5148eecb180ee7ec,1,0,1.0,3.4965,0.1875,1,9.33,241,0,Doc,0,0,0,1,0.5,0.0,1,0.0,2,1,0,1.0,0.0,2.0,34.2,16.59,0,0,0.0,0,7.303,0,0,0,0,0,"Update OVN northd group documentation

Existing docs are missing mention of network-northd_hosts, which
is a required grouping for a successful OVN deployment. This patch
addresses that.
[SEP]
FILES CHANGED:
doc/source/app-ovn.rst (+26, -6)
",0.769962,-1.400027,-0.294817,0.529178,0.245461,-0.086676,-0.585428,0.439577,0.393915,-0.144082,-0.675186,0.533856,-0.319461,-0.053225,0.088842
openstack/openstack-ansible,I004f1a86b4dba3c6e356ac14bb70a43abc17f538,1,1,0.9259,2.9444,0.1111,2,16.5,527,0,Bug Fix,0,0,0,54,0.028571,1.0,0,0.9259,4,2,0,0.8974,0.65,2.5,15.76,18.12,0,0,0.0,0,27.7368,0,6,0,17,0,"Skip haproxy with setup-infrastructure for upgrades

As we've enabled /healtcheck URIs for services [1], that we want to
verify, we need to apply haproxy backend changes only when all services
are re-configured, otherwise haproxy will fail to poll them and
mark all backends as down, which would mean continious downtime until
corresponsive roles will run to fix service api-paste configuration.

[1] https://review.opendev.org/q/topic:osa/healthcheck
Closes-Bug: #2002645
[SEP]
FILES CHANGED:
doc/source/admin/upgrades/major-upgrades.rst (+14, -1)
scripts/run-upgrade.sh (+2, -1)
",-0.421041,-0.772274,0.490495,-0.045456,-0.688814,-0.704236,0.553434,-0.010164,-0.099915,0.050388,-0.094701,-0.416727,0.284444,-0.343028,0.120687
openstack/kayobe,Ic1dd075076ea186b0928bba1a235605c0cd2ec71,1,0,0.8947,3.9318,0.16,3,19.5,776,0,Bug Fix,0,0,0,76,0.025427,1.0,0,0.8947,4,2,0,0.939,1.2571,2.67,46.04,13.61,0,0,0.66,1,15.2157,0,0,0,0,0,"Generate local Kolla Ansible config in check mode

If running a command in check mode such as

    kayobe overcloud service deploy --check

Kayobe does not generate the local configuration for Kolla Ansible. This
can lead to an inaccurate result when comparing with the remote
configuration, if there are changes in kayobe-config.

For example:

* Run kayobe overcloud service deploy
* Change a file in etc/kayobe/kolla
* Run kayobe overcloud service deploy --check --diff

We would expect that the changed file results in a diff against the
remote config. However there is no diff displayed.

This change fixes the issue by always generating the local Kolla Ansible
config, even in check mode.

Story: 2010526
Task: 47132
[SEP]
FILES CHANGED:
kayobe/tests/unit/cli/test_commands.py (+30, -3)
kayobe/cli/commands.py (+5, -5)
releasenotes/notes/check-mode-local-config-3f8a4ba231a32c1f.yaml (+7, -0)
",-2.321894,-0.919439,1.484388,0.016077,0.033797,-0.102525,-0.052045,0.154874,-0.301234,-0.390598,0.296027,-0.011842,0.292739,0.257415,-0.232722
openstack/openstack-ansible-os_nova,I8316989a57ada71e72af114984ec25f227def7ba,1,0,0.9273,1.0986,0.5,1,3.33,295,0,Bug Fix,0,0,0,55,0.028826,1.0,0,0.9273,1,1,0,1.0,0.0,1.0,-118.03,15.33,0,0,0.0,0,98.3333,0,0,0,0,0,"Fix scheduler track_instance_changes option

There was a typo for track_instance_changes once it was moved
under filter_scheduler.

[1] https://docs.openstack.org/nova/latest/configuration/config.html#filter_scheduler.track_instance_changes
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -1)
",-1.845473,2.495571,-1.167882,0.998959,0.267567,0.134034,-0.586974,-0.31719,0.015396,-0.03427,-0.385747,-0.553842,-0.621864,-0.101191,0.340866
openstack/ansible-role-zookeeper,I7017bb4c2eea855464989bf10d7984e130cad4b3,1,0,1.0,2.1972,0.0,2,4.29,320,0,Doc,0,0,0,16,0.129032,0.9444,0,0.9444,1,2,0,0,0.9544,1.0,-14.66,15.05,0,0,0.0,0,35.5556,0,0,0,0,0,"Add configuration option for native Prometheus exporter

Zookeeper supports Prometheus metrics as documented in
https://zookeeper.apache.org/doc/r3.8.0/zookeeperMonitor.html#Prometheus

This patch adds configuration options to enable it and change
the default port.
[SEP]
FILES CHANGED:
templates/zoo.cfg.j2 (+5, -0)
defaults/main.yml (+3, -0)
",-0.189391,1.27663,-0.93598,0.803294,-0.550264,0.050625,-0.146576,0.376509,0.186735,0.191387,-0.889674,-0.136195,-0.470655,-0.220126,-0.038645
openstack/openstack-ansible-galera_server,If4729eca992a0e647e2f15b3d77ad6300bbf9c12,1,1,0.9286,1.0986,1.0,1,4.67,394,0,Bug Fix,0,0,0,56,0.029319,1.0,0,0.9286,1,1,0,0.75,0.0,1.0,12.76,13.3,0,0,0.0,0,131.3333,0,6,0,28,0,"Prevent mariadbcheck.socket to wait for network.target

As of today bare metal scenarion does contain systemd ordering cycle [1]
due to mariadbcheck.socket waiting for network.target while being
part of that target. Removing that dependency solves the cycle.

[1] https://paste.openstack.org/show/bE9UlN6dK8awqZl3uwrQ/
Closes-Bug: #2002653
[SEP]
FILES CHANGED:
tasks/galera_server_post_install.yml (+0, -2)
",-1.298842,0.334849,-0.468612,-0.119739,-0.34421,-0.068998,0.512452,0.106394,-0.095433,0.333276,0.536413,-0.56484,0.089363,-0.211224,-0.031601
openstack/ansible-role-pki,Ia7f4f4726bf4d73c6c0071bef52fd6eb58d662a3,1,0,0.9298,1.0986,0.5,1,23.0,460,0,Feature,0,0,0,57,0.029812,0.0,0,0.0,2,1,0,1.0,0.0,2.0,37.59,17.9,0,0,0.0,0,153.3333,0,0,0,0,0,"Create relative links to root instead of absolute

We don't really need to create an absolute links for root/intermediate
certificates since original file is placed at the same place. In case
of storing PKI dir in git these links are considered as  out-of-bound
which results in sanity checks failure.
Also we're eliminating risk of broken links in case when PKI directory
is being moved on the filesystem
[SEP]
FILES CHANGED:
tasks/standalone/create_ca.yml (+1, -1)
",0.087681,-1.920561,0.611977,0.521443,-0.145518,-0.186829,0.799648,-0.441181,-0.270785,-0.003855,-0.290391,-0.14812,0.415396,0.095814,-0.127257
openstack/charm-octavia,Ie42014b415324a3964a50e74cf04beeb298d7d06,1,1,1.0,0.6931,0.0,1,5.19,546,0,Bug Fix,0,0,0,10,0.243902,0.4918,0,0.4918,0,1,0,1.0,0.0,0.0,62.95,9.79,1,0,0.0,1,273.0,0,8,0,22,0,"Pin tox to < 4.0.0

Tox 4.0.0 was recently released and it has several breaking changes.
We pin to < 4.0.0 here. We are planning to move forward only on the
master charm branches.

Tox is also pinned to < 4.0.0 for stable branches in upstream
openstack-zuul-jobs as well as in zosci-config. However, the
requires= section in the charm's tox.ini file ends up installing
tox>4, wiping out the zuul-pinned tox<4 that was already installed
installed. This patch fixes that.

Related-Bug: #2002788
[SEP]
FILES CHANGED:
tox.ini (+1, -0)
",-1.564059,-0.520482,0.566904,-0.048587,-0.155309,-0.062474,0.248429,0.261137,-0.408994,0.49762,0.336268,0.21852,-0.202291,0.141152,0.418873
openstack/kolla-ansible,I2546d714d1e6a1b648a4c6242ece18a2108b9183,1,0,0.8636,3.4012,0.5517,1,2.5,78,0,CI,1,0,0,44,0.047516,0.0,0,0.0,1,1,0,0.8147,0.0,1.0,-49.5,17.0,0,0,1.0,0,2.6,0,0,0,0,0,"CI: improve get_logs.sh
[SEP]
FILES CHANGED:
tests/get_logs.sh (+13, -16)
",2.081925,2.100024,0.613141,0.126407,0.39453,-0.17063,-0.435832,-0.535367,-0.107636,-0.114199,0.084671,-1.064661,-0.67658,0.195436,0.391954
openstack/openstack-ansible-os_horizon,Iceedf6af9559d48c28e0ee782a44f9ceb480119d,1,1,0.931,1.7918,0.2,2,19.0,298,0,Bug Fix,0,0,0,58,0.030303,1.0,0,0.931,1,2,0,1.0,0.971,1.0,18.35,16.02,0,0,0.0,0,49.6667,0,20,0,24,0,"Allow to override supported_provider_types

Supported ML2 provided types depends on the ML2 driver
and we should make it configurable in order to reflect dropdown list
that appears for admin panel while creating a network.

Closes-Bug: #2002897
[SEP]
FILES CHANGED:
defaults/main.yml (+3, -0)
templates/horizon_local_settings.py.j2 (+1, -1)
",0.722341,-2.064083,-0.285864,0.014894,-0.340216,-0.244706,-0.080316,0.322385,0.231234,-0.135031,-0.471088,-0.080759,-0.158593,-0.353326,-0.063603
openstack/openstack-ansible-os_neutron,I58e94199a32ad300b3f70861dc7804f34518c8c2,1,0,1.0,3.6636,0.0526,3,8.0,177,0,Feature,0,0,0,1,0.142857,1.0,0,1.0,2,2,0,1.0,1.2674,1.33,-12.78,18.2,1,0,0.0,1,4.5385,0,0,0,0,0,"Disable dhcp-agent and metadata-agent for OVN

OVN doesn't need the neutron-metadata-agent and
neutron-dhcp-agent service.
[SEP]
FILES CHANGED:
releasenotes/notes/ovn_dhcp_metadata_agents-851b42a6923c811f.yaml (+10, -0)
tasks/main.yml (+24, -0)
vars/main.yml (+2, -2)
",-0.437331,2.324067,-1.502732,1.608038,1.268088,-0.880864,-0.506002,0.061591,-0.754863,-1.075814,-0.088563,0.877129,0.574383,0.79578,0.435639
openstack/openstack-ansible-os_neutron,I7a1c0e4cc034ac4818dfeeaaf1c6e4b497c787cf,0,0,1.0,1.0986,1.0,1,6.0,94,0,Bug Fix,0,0,0,2,0.044444,1.0,0,1.0,1,1,0,1.0,0.0,1.0,-109.45,22.4,0,0,0.0,0,31.3333,0,0,0,0,0,"Fix user for neutron-ovn-metadata-agent
[SEP]
FILES CHANGED:
vars/main.yml (+0, -2)
",2.25552,2.627798,0.645721,0.235903,0.581214,-1.197138,0.01117,0.280783,0.34875,-0.953615,-0.203076,0.53901,0.253801,0.438707,0.537124
openstack/charm-ceph-iscsi,I5e2f4ca47e5260c7bcc0e065e1eb3b2050e3f2a9,1,0,0.0,3.6376,0.5135,4,10.0,219,0,CI,0,0,1,2,0.015038,0.5,0,0.0,2,3,0,0,1.315,0.5,-19.04,12.0,1,0,0.2703,1,5.7632,0,0,0,0,0,"Pin tox < 4 (octopus)

This patchset works around issues with versions of tox > 4

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1013
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
test-requirements.txt (+1, -1)
tests/bundles/focal-ec.yaml (+6, -2)
tox.ini (+10, -15)
",-0.201277,2.677041,-1.448406,0.239,-0.524532,0.157521,-0.076324,-0.282856,-0.456899,-0.178156,-0.365033,0.239813,0.269428,-0.345005,0.30596
openstack/ironic,Ib04b66b0c7b1ef1c4175841689c16a7fbc0b1e54,0,0,1.0,6.2246,0.0,7,12.0,388,0,Feature,0,0,0,6,0.011881,1.0,0,1.0,6,3,0,0.9583,2.1073,4.29,43.08,11.47,1,1,0.4385,1,0.7683,0,0,0,0,0,"[iRMC] identify BMC firmware version

Since iRMC S6 2.00, iRMC firmware doesn't support HTTP
connection to REST API.

To deal with this firmware incompatibility, this commit adds
verify step to check connection to iRMC firmware REST API.

Story: 2010396
Task: 46745
(cherry picked from commit eae33a0acbfdbe30b5d79360e76668737866e371)
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/irmc/test_common.py (+129, -0)
releasenotes/notes/fix-irmc-s6-2.00-http-incompatibility-61a31d12aa33fbd8.yaml (+19, -0)
ironic/drivers/modules/irmc/common.py (+212, -0)
ironic/drivers/modules/irmc/management.py (+38, -0)
ironic/tests/unit/drivers/third_party_driver_mock_specs.py (+2, -0)
doc/source/admin/drivers/irmc.rst (+14, -0)
ironic/tests/unit/drivers/modules/irmc/test_management.py (+90, -0)
",-1.055515,-0.648249,-0.545852,-0.819793,0.272058,0.18881,0.437395,0.676783,0.175725,0.431163,0.27928,-0.011909,0.190068,0.017549,-0.19781
openstack/ironic,Ide2b205ade67a4090a0b9bfe1282d01f7605ceb9,1,0,0.96,1.6094,0.25,1,21.67,407,0,Bug Fix,1,0,0,25,0.010566,0.0,0,0.0,6,1,0,0.9452,0.0,6.0,49.48,15.44,0,0,1.0,0,81.4,0,0,0,0,0,"CI: Fix race prone unit test in networking

In the networking code stack, one of the methods
looks to identify if a change has occured, except
some of the other tests utilize the same value that
was previously asserted for the same base object.

Becaues of this, just use a unique value so we
don't risk the possibility of the test failing
erroneously.
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/network/test_common.py (+3, -1)
",-0.565811,-2.858063,0.192717,0.271821,-0.594096,0.002193,0.013171,-0.884163,0.162838,0.442678,-0.128978,0.047616,0.048436,0.032101,0.277393
openstack/charm-ceph-iscsi,I5d94f213ae4d734c75ef9c653d12cf25d5e0b977,1,1,1.0,3.6376,0.4595,6,5.0,629,0,Bug Fix,0,0,1,11,0.261905,0.6,0,0.6,2,4,0,1.0,2.1946,0.67,50.48,10.0,1,0,0.8108,1,16.5526,0,8,0,22,0,"Pin tox to < 4.0.0

Tox 4.0.0 was recently released and it has several breaking changes.
We pin to < 4.0.0 here. We are planning to move forward only on the
master charm branches.

Tox is also pinned to < 4.0.0 for stable branches in upstream
openstack-zuul-jobs as well as in zosci-config. However, the
requires= section in the charm's tox.ini file ends up installing
tox>4, wiping out the zuul-pinned tox<4 that was already installed
installed. This patch fixes that.

Related-Bug: #2002788
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1020
[SEP]
FILES CHANGED:
requirements.txt (+2, -2)
.gitreview (+2, -0)
test-requirements.txt (+3, -3)
tests/bundles/jammy-ec.yaml (+6, -6)
tests/bundles/jammy.yaml (+6, -6)
tox.ini (+1, -0)
",-2.309791,0.639815,0.954106,-0.255871,-0.28479,-0.16339,0.19471,0.22288,-0.357482,0.118417,0.140206,0.239242,-0.182092,0.035919,0.475068
openstack/charm-ceph-iscsi,Ib3af2849d6d9ee660f1bb641eb16ff3f1c384a61,1,1,1.0,4.3694,0.5128,8,5.0,629,0,Bug Fix,0,0,1,12,0.151899,1.0,0,1.0,2,4,0,1.0,2.5799,1.12,49.48,10.0,1,0,0.9359,1,7.962,0,8,0,22,0,"Pin tox to < 4.0.0

Tox 4.0.0 was recently released and it has several breaking changes.
We pin to < 4.0.0 here. We are planning to move forward only on the
master charm branches.

Tox is also pinned to < 4.0.0 for stable branches in upstream
openstack-zuul-jobs as well as in zosci-config. However, the
requires= section in the charm's tox.ini file ends up installing
tox>4, wiping out the zuul-pinned tox<4 that was already installed
installed. This patch fixes that.

Related-Bug: #2002788
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1019
[SEP]
FILES CHANGED:
requirements.txt (+2, -2)
test-requirements.txt (+1, -1)
tests/bundles/jammy-ec.yaml (+8, -8)
tests/bundles/focal-ec.yaml (+8, -10)
tests/bundles/focal.yaml (+8, -10)
tests/bundles/jammy.yaml (+7, -7)
tox.ini (+1, -0)
unit_tests/test_ceph_iscsi_charm.py (+3, -2)
",-2.319501,0.655795,0.954597,-0.273463,-0.274608,-0.159264,0.194546,0.212732,-0.364943,0.117357,0.140373,0.245623,-0.175273,0.023749,0.462237
openstack/kolla-ansible,I928af332b8658223444594f96417830233057284,1,1,1.0,1.7918,0.0,1,12.67,293,0,Bug Fix,0,0,0,1,0.111111,0.6667,0,0.6667,4,1,0,0.8154,0.0,4.0,31.46,15.59,1,0,0.0,0,48.8333,0,14,0,16,0,"Set scheduler.max_attempts for nova conductor

In order to honour configured max number of attempts
it has to be presented in nova.conf inside of
nova_conductor container, otherwise the default value
of 3 will be used

Closes-Bug: #2003587
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/templates/nova.conf.j2 (+5, -0)
",-0.367955,-1.069636,-0.848378,0.338782,0.136039,-0.046469,-0.36328,-0.121345,0.390346,-0.256206,-0.011762,-0.219439,-0.259042,-0.108714,-0.038882
openstack/charm-ceph-mon,I76d21ddd9da79535f68490b4231ae13705e27edb,1,1,0,1.3863,0.3333,1,9.17,408,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,48.33,12.39,1,0,0.0,0,102.0,0,10,0,16,0,"Ensure crushtool --test called correctly

Later Ceph releases require that the --test function of crushtool
is called with replica information for validation.

Pass in ""--num-rep 3"" as a basic check plus ""--show-statistics""
to silence a non-fatal warning message.

This can be clean cherry-picked back at least as far as
Ceph 12.2.x.

Closes-Bug: 2003690
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+2, -1)
",-1.756517,-0.881936,0.047138,-1.219105,0.276619,-0.110023,0.249329,-0.205453,-0.035859,0.341889,0.351581,-0.02847,0.147095,0.189511,0.034751
openstack/openstack-ansible,I8a5e817d024eef5453fa072d8fee5aeca9bed67b,1,1,0.9322,3.5553,0.5,6,10.5,537,0,Bug Fix,0,0,0,59,0.030745,0.0,0,0.0,3,1,0,0.9,2.0119,2.0,6.83,16.26,0,0,0.0,0,15.3429,0,6,0,17,0,"Ensure management_address is used instead of ansible_host

ansible_host in deployments is designed to represent SSH address.
In cases, when address that used for SSH is different from management
network, this might lead to undpredictable results on bare metal hosts.

Thus we're ensuring that management (container) address is used
for services to listen on and to interact through.

Related-Bug: #2002645
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/870113
[SEP]
FILES CHANGED:
scripts/upgrade-utilities/galera-cluster-rolling-restart.yml (+1, -1)
inventory/group_vars/memcached.yml (+1, -1)
playbooks/healthcheck-infrastructure.yml (+9, -9)
inventory/group_vars/galera_all.yml (+2, -2)
inventory/group_vars/all/infra.yml (+3, -3)
playbooks/common-tasks/unbound-clients.yml (+1, -1)
",-1.605494,0.24432,-0.069556,0.354501,-0.373543,-0.133751,0.15338,-0.118602,0.003024,-0.100468,-0.075892,-0.190752,0.182455,-0.339224,-0.262328
openstack/charm-ceph-mon,I76d21ddd9da79535f68490b4231ae13705e27edb,1,1,1.0,1.3863,0.3333,1,10.0,477,0,Bug Fix,0,0,0,1,0.25,1.0,0,1.0,1,1,0,1.0,0.0,1.0,37.36,12.67,1,0,0.0,0,119.25,0,10,0,16,0,"Ensure crushtool --test called correctly

Later Ceph releases require that the --test function of crushtool
is called with replica information for validation.

Pass in ""--num-rep 3"" as a basic check plus ""--show-statistics""
to silence a non-fatal warning message.

This can be clean cherry-picked back at least as far as
Ceph 12.2.x.

Closes-Bug: 2003690
(cherry picked from commit 58fc48ebbe8945ef28806da7b8a6cac7be9a3a09)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+2, -1)
",-1.756517,-0.881936,0.047138,-1.219105,0.276619,-0.110023,0.249329,-0.205453,-0.035859,0.341889,0.351581,-0.02847,0.147095,0.189511,0.034751
openstack/ansible-role-systemd_service,Ib456b4dc2d631bf81633035820444f13ec0f06cb,1,1,0.9333,1.0986,0.5,1,21.67,432,0,Bug Fix,0,0,0,60,0.030722,1.0,0,0.9333,1,1,0,0,0.0,1.0,52.09,13.59,0,0,0.0,0,144.0,0,6,0,24,0,"Ensure daemon is reloaded on socket change

At the moment our verification if socket has been changed
is not valid, since we're checking if string 'true' is presnet in the
list, while list consist of only boolean variables. So we replace
map filter with selectattr as it can apply truthy test to the elements
while selecting them and checking list length.

Related-Bug: #2003631
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
",-0.05756,-2.261257,0.120871,0.306073,-0.421287,-0.183656,0.567382,-0.669848,0.135897,0.210367,-0.002711,-0.475155,0.183161,0.113925,-0.25359
openstack/ansible-role-zookeeper,I678d60f922273ead46ad51360b6b60a1a13e1f60,1,0,0.9344,1.0986,0.5,1,14.5,235,0,Feature,0,0,0,61,0.031202,1.0,0,0.9344,1,1,0,1.0,0.0,1.0,25.83,16.83,0,0,0.0,0,78.3333,0,0,0,0,0,"Ensure zookeeper is not stopped after role re-run

Due to mis-usage of systemd_service role inlcude, zookeeper service
was stopped on sequental role runs, when nothing was changed.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
",0.856495,-0.701448,-0.088512,0.882395,-0.046343,0.192619,0.471088,-0.490534,-0.198145,-0.641533,0.122598,0.239873,-0.112579,-0.063045,0.466494
openstack/charm-ceph-mon,I30bc22ae8509367207004b90eb2c38ad0fae9ffe,1,1,1.0,2.3026,0.5556,2,6.5,512,0,Bug Fix,0,0,0,3,0.045455,1.0,0,1.0,1,1,0,1.0,0.9183,1.0,27.78,14.91,0,0,0.6667,0,51.2,0,18,0,8,0,"Make sure lockfile-progs package is installed

Also, drop python-dbus for simplicity since ""check_upstart_job"" in nrpe
is not enabled any longer. And the python-dbus package is no longer
available on jammy either.

    [on focal with systemd]
    $ ls -1 /etc/nagios/nrpe.d/
    check_ceph.cfg
    check_conntrack.cfg
    check_reboot.cfg
    check_systemd_scopes.cfg

Closes-Bug: #1998163
(cherry picked from commit df676a097f780679f73c441d7fb67cdacde634c6)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+1, -2)
unit_tests/test_ceph_hooks.py (+3, -3)
",-2.123703,0.397002,0.66881,-1.228993,0.339884,-0.315853,0.226116,-0.014628,-0.437274,-0.432913,0.491099,-0.355979,-0.310379,0.372015,0.025006
openstack/ironic,I916b96d1386d3b1f090df11a7a8d2ef70fe22559,1,0,1.0,1.0986,0.5,1,3.67,112,0,CI,0,0,0,4,0.038462,0.0,0,0.0,4,1,0,0.9459,0.0,4.0,26.22,12.38,1,0,0.0,0,37.3333,0,0,0,0,0,"Bump cirros to version 0.6.1

Use latest cirros available
[SEP]
FILES CHANGED:
devstack/tools/ironic/scripts/cirros-partition.sh (+1, -1)
",1.697966,0.660059,-0.465721,0.569497,0.309094,0.639338,0.478384,0.378777,-0.414725,0.822152,0.110412,0.318319,-0.773391,0.462096,0.403245
openstack/openstack-ansible-ceph_client,I176fbcd4901dfacd4b608fac4d4fbd256d263b2a,1,0,0.9355,1.9459,0.5,1,23.33,426,0,Feature,0,0,0,62,0.031681,0.0,0,0.0,1,1,0,1.0,0.0,1.0,59.88,11.05,0,0,0.0,0,60.8571,0,0,0,0,0,"Improve regexp for fetching nova secret from files

At the moment regexp we have does require keyring to contain only
key option. If that is full ceph authx file that does also contain
caps, regexp will grab them as well, which will result in a play failure

This patch does improve regexp to grab only key regardless of all other
content that can be present in the file.
[SEP]
FILES CHANGED:
tasks/ceph_get_keyrings_from_files.yml (+3, -3)
",-0.00341,-1.984579,0.319624,0.570456,-0.117749,-0.209375,0.772925,-0.483729,0.03457,0.061283,-0.233123,-0.215074,0.102222,-0.340706,-0.188806
openstack/ironic,I1a0b8347e960c6cff8aca10a22c67b710f7d617e,1,0,1.0,2.1972,0.125,2,23.0,448,0,Feature,0,0,0,1,0.027027,0.0,0,0.0,3,2,0,0.9467,0.8113,2.5,42.49,16.16,1,0,0.0,1,49.7778,0,0,0,0,0,"Relaxing console pid looking

Recently we hit an issue that the pid file is missing, current logic
simply removes pid file if the corresponding process is not found,
but if the pid file is lost then the console could never be stopped
and futher more, be restarted, regardless if the process is there or
not.
This patch captures FileNotFound to the exception handling to allow
console recovery.
[SEP]
FILES CHANGED:
releasenotes/notes/console-pid-file-6108d2775ef947fe.yaml (+6, -0)
ironic/drivers/modules/console_utils.py (+1, -1)
",-0.119955,-2.770486,0.280566,0.248352,-0.737861,-0.016588,0.58827,-0.688352,0.093832,-0.027662,0.201755,-0.084027,0.085367,0.467885,-0.08857
openstack/openstack-ansible-os_neutron,Ie870aa656c467b21441a38cebf7c6a075342d50f,1,0,0.9365,0.6931,0.0,1,12.0,206,0,Feature,0,0,0,63,0.032094,1.0,0,0.9365,1,1,0,0.8333,0.0,1.0,4.31,21.47,0,0,0.0,0,103.0,0,0,0,0,0,"Generate OVN certs only for OVN scenario

At the moment we're generating OVN certificates regardless of
the scenario which produces unnecesary changes.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",0.434958,-0.964311,0.342756,1.09561,0.711132,0.721358,-0.236193,-0.302183,-0.287597,-0.114352,-0.31421,0.414861,-0.063095,-0.408814,0.082234
openstack/charm-magnum-dashboard,Ie358e9c115273ae648c9bef2aedaae50e5ee179d,1,1,0.7,2.8332,0.125,3,6.88,468,0,Bug Fix,0,0,0,10,0.083333,0.0,0,0.0,4,1,0,0,1.1995,2.33,16.81,10.75,1,0,0.1875,0,27.5294,0,6,0,6,0,"Set container-infra API version to 1.9 for >=Ussuri,<=Wallaby.

Horizon needs to use container-infra 1.9 version, the openstack
client's default, to be able to resize k8s clusters, but by default
Horizon uses 1.1 until Xena (
https://opendev.org/openstack/magnum-ui/commit/1fc627fb ).

This change sets OPENSTACK_API_VERSIONS['container-infra'] to 1.9 for
U/V/W, and unsets the key for >=Xena

Closes-Bug: #1998509
[SEP]
FILES CHANGED:
src/reactive/magnum_dashboard_handlers.py (+1, -1)
src/lib/charm/openstack/magnum_dashboard.py (+11, -0)
unit_tests/test_magnum_dashboard_handlers.py (+2, -1)
",-1.974516,0.594892,0.033518,0.059323,-0.196891,-0.237734,-0.139729,0.683893,-0.249164,0.20793,0.13693,-0.125555,-0.016739,-0.163135,0.061916
openstack/kolla,I29dde2696ff81f3f48effdd6821d94d0d84ff536,1,1,0.8667,1.7918,0.4,1,7.0,100,0,Bug Fix,0,0,0,45,0.04712,0.0,0,0.0,3,1,0,0.821,0.0,3.0,30.53,19.94,0,0,0.0,0,16.6667,0,10,0,13,0,"ovsdpdk: add libdpdk-dev

Closes-Bug: #1980328
[SEP]
FILES CHANGED:
docker/ovsdpdk/ovsdpdk/Dockerfile.j2 (+3, -2)
",2.569908,0.64638,-0.316345,-1.335928,-0.736317,-0.043669,-0.452266,0.305674,-0.106356,-0.56309,0.259987,0.030073,0.034203,0.072404,0.260906
openstack/openstack-ansible-haproxy_server,I5c6d55ecfaa4e7442ebba80992808bdc33fda79b,0,0,0.8333,1.0986,0.5,1,11.75,608,0,Feature,0,0,0,18,0.191489,0.95,0,0.7917,1,1,0,1.0,0.0,1.0,55.41,9.38,0,0,0.0,0,202.6667,0,0,0,0,0,"Update SHA for hatop download

Downloads for hatop from github now appear to have identical content
but a very slightly smaller compressed file size. This makes the
checksum validation fail. Update the SHA to the current value.

Comparing a version of hatop 0.8.0 downloaded in June 2022 with a
version from end Jan 2023 shows that whilst the compressed sizes
differ, decompressing with gzip results in identical tar files
which have the same SHA256.

It appears that the compression used by github has changed but
the tar archive contents are the same.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",-1.160668,-1.734155,0.430357,0.322342,-0.209906,0.117825,0.430222,0.062444,0.073133,0.613044,0.170766,0.14875,0.022493,0.275586,-0.093764
openstack/openstack-ansible-os_nova,I4c1ae32ed078a4412ff44b7ac3f921b223d0cba3,1,0,1.0,0.6931,0.0,1,6.91,601,0,CI,0,0,0,2,0.058824,1.0,0,1.0,1,1,0,1.0,0.0,1.0,25.06,12.24,0,0,0.0,0,300.5,0,0,0,0,0,"Add authentication for [cinder] section of nova.conf

Nova complains about an inability to access endpoint list for block
storage. This patch updates nova.conf with the respective configuration.:

Example errors in nova-compute log:

1. The [cinder] section of your nova configuration file must be configured
for authentication with the block-storage service endpoint.

2. Delete attachment failed for attachment <UUID>. Error: Unknown auth type:
None (HTTP 401) Code: 401: cinderclient.exceptions.Unauthorized:
Unknown auth type: None (HTTP 401)
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -0)
",-1.434805,-0.558154,0.375589,0.35478,-0.147613,-0.364013,-0.047748,0.76276,0.532016,0.220367,0.274192,-0.094212,0.045826,0.492209,-0.484645
openstack/charm-ceph-mon,I84b306e84661e6664e8a69fa93dfdb02fa4f1e7e,1,1,1.0,5.8805,1.0,11,4.83,2333,0,Bug Fix,0,1,0,4,0.053333,1.0,0,1.0,2,4,0,1.0,2.9303,1.0,10.52,9.2,1,0,0.5434,1,6.5168,0,20,0,16,0,"Revert ""Create NRPE check to verify ceph daemons versions""

This reverts commit dfbda68e1add1e8a31ef0e14c043b584532fcd03.

Reason for revert:

The Ceph version check seems to be missing a consideration of users to
execute the nrpe check. It actually fails to get keyrings to execute the
command as it's run by a non-root user.

$ juju run-action --wait nrpe/0 run-nrpe-check name=check-ceph-daemons-versions
unit-nrpe-0:
  UnitId: nrpe/0
  id: ""20""
  results:
    Stderr: |
      2023-02-01T03:03:09.556+0000 7f4677361700 -1 auth: unable to find
      a keyring on
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin:
      (2) No such file or directory
      2023-02-01T03:03:09.556+0000 7f4677361700 -1
      AuthRegistry(0x7f467005f540) no keyring found at
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin,
      disabling cephx
      2023-02-01T03:03:09.556+0000 7f4677361700 -1 auth: unable to find
      a keyring on
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin:
      (2) No such file or directory
      2023-02-01T03:03:09.556+0000 7f4677361700 -1
      AuthRegistry(0x7f4670064d88) no keyring found at
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin,
      disabling cephx
      2023-02-01T03:03:09.560+0000 7f4677361700 -1 auth: unable to find
      a keyring on
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin:
      (2) No such file or directory
      2023-02-01T03:03:09.560+0000 7f4677361700 -1
      AuthRegistry(0x7f4677360000) no keyring found at
      /etc/ceph/ceph.client.admin.keyring,/etc/ceph/ceph.keyring,/etc/ceph/keyring,/etc/ceph/keyring.bin,
      disabling cephx
      [errno 2] RADOS object not found (error connecting to the cluster)
    check-output: 'UNKNOWN: could not determine OSDs versions, error: Command ''[''ceph'',
      ''versions'']'' returned non-zero exit status 1.'
  status: completed
  timing:
    completed: 2023-02-01 03:03:10 +0000 UTC
    enqueued: 2023-02-01 03:03:09 +0000 UTC
    started: 2023-02-01 03:03:09 +0000 UTC

Related-Bug: #1943628
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+0, -8)
files/nagios/check_ceph_status.py (+0, -75)
unit_tests/ceph_versions_diverged.json (+0, -19)
actions/ceph_ops.py (+0, -51)
actions/get-versions-report (+0, -1)
actions/get_versions_report.py (+0, -26)
unit_tests/test_actions_mon.py (+0, -40)
unit_tests/ceph_ls_node.json (+0, -35)
unit_tests/test_check_ceph_status.py (+0, -85)
actions.yaml (+0, -2)
unit_tests/ceph_versions_alligned.json (+0, -15)
",-4.109478,3.153959,2.625084,-0.585486,0.49191,0.774237,-1.204659,-0.690554,-0.856502,0.250936,-0.459249,0.164338,0.131583,0.791295,0.204423
openstack/kolla-ansible,I44841a6b6fa5bf659cace06295d18c093ad7f927,1,1,0,2.4849,0.0,2,16.0,312,0,Bug Fix,0,0,0,0,0.0,0.8571,0,0.0,4,2,0,0.8161,0.9457,3.0,-15.62,20.15,1,0,0.0,1,26.0,1,6,0,13,0,"Set HAProxy server timeout for openstack exporter

Set the openstack exporter HAProxy backend server timeout to
``prometheus_openstack_exporter_timeout`` to ensure that scrapes
that take longer than haproxy_server_timeout don't timeout.

Closes-Bug: #2006051
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2006051-135bd20d5c465517.yaml (+7, -0)
ansible/roles/prometheus/defaults/main.yml (+4, -0)
",-0.348053,0.619014,-0.996439,1.005369,0.891324,0.261136,-0.445491,0.271282,0.714231,-0.38384,0.213925,-0.445207,-0.258716,-0.412836,0.371992
openstack/octavia,Ifa2ba3a9ba7505c4da6e391c63ca3342a606e4ed,0,0,0.7381,1.0986,0.5,1,4.75,169,0,Feature,1,0,1,84,0.007451,0.3667,1,0.2706,0,1,0,0.5933,0.0,0.0,10.55,10.32,0,0,1.0,0,56.3333,0,0,0,0,0,"Pin pylint on stable/branches

pylint release 2.16.x adds new checkers, pin pylint to the previously
used version.
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
",1.502534,0.556115,-0.096974,0.564266,0.389789,-0.054639,0.403127,0.12152,-0.73794,0.263545,-0.148222,0.16133,-0.706158,0.01672,0.349168
openstack/octavia,I012ac70d511906a7401f92a3112c931b271dbefa,1,0,0.7294,2.3026,0.4444,1,7.5,155,0,Bug Fix,1,0,0,85,0.007538,0.3636,0,0.2652,1,1,0,0.5914,0.0,1.0,1.82,13.67,0,0,1.0,1,15.5,0,0,0,0,0,"Fix grenade job

devstack_localrc is not used in grenade jobs, use
grenade_devstack_localrc instead.
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+5, -4)
",-0.214052,1.183167,-0.892462,0.668888,1.351075,0.223657,-0.878676,-0.945091,-0.487166,-0.85917,0.394458,-0.579232,-0.691856,-0.004765,-0.078849
openstack/ironic,Ib8db915746228cd87272740825aaaea1fdf953c7,1,0,1.0,4.6151,0.08,4,23.75,707,0,Feature,0,0,0,4,0.020725,1.0,0,1.0,4,2,0,0.9474,1.7904,2.5,18.87,18.76,1,0,0.5,1,7.0,0,0,0,0,0,"On rpc service stop, wait for node reservation release

Instead of clearing existing reservations at the beginning of
del_host, wait for the tasks holding them to go to completion. This
check continues indefinitely until the conductor process exits due to
one of:
- All reservations for this conductor are released
- CONF.graceful_shutdown_timeout has elapsed
- The process manager (systemd, kubernetes) sends SIGKILL after the
  configured graceful period

Because the default values of [DEFAULT]graceful_shutdown_timeout and
[conductor]heartbeat_timeout are the same (60s) no other conductor
will claim a node as an orphan until this conductor exits.
[SEP]
FILES CHANGED:
ironic/common/rpc_service.py (+17, -1)
releasenotes/notes/graceful_shutdown_wait-9a62627714b86726.yaml (+15, -0)
ironic/conductor/base_manager.py (+14, -3)
ironic/tests/unit/common/test_rpc_service.py (+46, -4)
",-3.098388,-0.437274,1.548073,-0.745681,0.691286,0.196789,0.03439,-0.152717,0.288276,-0.011639,0.096269,0.058957,-0.180057,0.028648,-0.220507
openstack/oslo.utils,I1f88bdadc68bfa726eac1da1c5824c1ed352ad98,0,0,0.3571,2.7081,0.2857,3,8.0,1204,0,CI,0,0,1,14,0.016867,0.2955,0,0.1055,2,3,0,0.8889,1.4488,1.0,26.73,11.36,1,0,0.0,1,80.2667,0,0,0,0,0,"Implement zoneinfo support to drop dependency to pytz

Zoneinfo was introduced within python 3.9.

The support of pytz will be removed within RHEL 10 [1].

2023.2 (bobcat) will move our testing runtime to py3.9 and py3.10
so we want to see pytz removed within this series.

tzdata is required at runtime in our gates, because, by default,
zoneinfo uses the system‚Äôs time zone data if available; if no system
time zone data is available, the library will fall back to using the
first-party tzdata package available on PyPI. Apparently our gates have no
time zone data available nor tzdata installed by default because we get the
following error without tzdata installed [3]:
`ModuleNotFoundError: No module named 'tzdata'

So I prefer to add tzdata in our requirements to avoid runtime failure
related to time zone and ensure that time zone are always available.

[1] https://issues.redhat.com/browse/RHEL-219
[2] https://review.opendev.org/c/openstack/governance/+/872232
[3] https://zuul.opendev.org/t/openstack/build/0a1576775e894b09bc31269fea00ba03/log/job-output.txt#1445`

Depends-on: https://review.opendev.org/c/openstack/requirements/+/875854
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
oslo_utils/timeutils.py (+3, -3)
releasenotes/notes/implement-zoneinfo-to-remove-pytz-fba6f70db09ecdb8.yaml (+6, -0)
",-3.638449,2.413083,3.358437,-0.854369,-0.41467,0.541155,-0.194997,-0.345599,-0.327862,-0.002236,-0.566817,0.115746,-0.128924,-0.297118,0.072728
openstack/oslo.serialization,I8d87d54f6f5ded8caee6cb780bacb39afea0fea1,0,0,0.3333,3.5553,0.3824,4,8.0,1204,0,CI,0,0,1,15,0.017773,0.2889,0,0.0963,2,3,0,0,1.7131,1.25,26.73,11.36,1,0,0.4706,1,34.4,0,0,0,0,0,"Implement zoneinfo support to drop dependency to pytz

Zoneinfo was introduced within python 3.9.

The support of pytz will be removed within RHEL 10 [1].

2023.2 (bobcat) will move our testing runtime to py3.9 and py3.10
so we want to see pytz removed within this series.

tzdata is required at runtime in our gates, because, by default,
zoneinfo uses the system‚Äôs time zone data if available; if no system
time zone data is available, the library will fall back to using the
first-party tzdata package available on PyPI. Apparently our gates have no
time zone data available nor tzdata installed by default because we get the
following error without tzdata installed [3]:
`ModuleNotFoundError: No module named 'tzdata'

So I prefer to add tzdata in our requirements to avoid runtime failure
related to time zone and ensure that time zone are always available.

[1] https://issues.redhat.com/browse/RHEL-219
[2] https://review.opendev.org/c/openstack/governance/+/872232
[3]
https://zuul.opendev.org/t/openstack/build/0a1576775e894b09bc31269fea00ba03/log/job-output.txt#1445`

Depends-on: https://review.opendev.org/c/openstack/requirements/+/875854
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
oslo_serialization/tests/test_msgpackutils.py (+9, -7)
releasenotes/notes/implement-zoneinfo-to-remove-pytz-c136b33bbfbfe59f.yaml (+6, -0)
oslo_serialization/msgpackutils.py (+5, -5)
",-3.620826,2.359396,3.361716,-0.89124,-0.44781,0.527212,-0.213832,-0.334745,-0.318336,-0.007567,-0.577377,0.102547,-0.136125,-0.276585,0.064233
openstack/openstack-ansible,Ide828700bba5c2a3e8d49e4ea3591f2d458e7519,1,0,0.9375,3.7136,0.7,3,10.2,372,0,Doc,0,0,0,64,0.032587,0.0,0,0.0,4,2,0,0.9024,0.9922,2.67,23.96,14.28,0,1,0.0,0,9.0732,0,0,0,0,0,"[doc] Update Ubuntu 22.04 support status

We should not consider Ubuntu Jammy deployment as experimental anymore.
The only issue we have with it right now is version selection of ceph
packages, that is only one of many possible storage drivers.

We also update overview-requirements to have only relevant information.
[SEP]
FILES CHANGED:
deploy-guide/source/overview-requirements.rst (+5, -26)
doc/source/admin/upgrades/os-compatibility-matrix.html (+3, -1)
deploy-guide/source/targethosts-prepare.rst (+4, -1)
",1.333729,-1.847548,0.211102,0.227876,-0.808614,-0.059118,0.900412,0.177591,-0.390109,0.253203,-0.403594,0.061749,-0.127725,-0.273156,-0.112263
openstack/openstack-ansible-galera_server,Ia4cde2153813e68419d261cd94e3017523177142,1,1,0.9385,1.0986,0.0,1,7.71,763,0,Bug Fix,0,0,0,65,0.032435,1.0,0,0.9385,1,1,0,0.8,0.0,1.0,54.87,10.12,0,0,0.0,0,254.3333,0,6,0,24,0,"Allow maridbcheck socket to FreeBind

Once we've removed network.target from wanted targets for
mariadbcheck.socket, it started to fail to startup intermitently in LXC
deployments, since it was trying to bind on IP address that is not
brought up yet. At the same time we can't wait for IP being up, as
OVS while providing network, waits for socket.target as it needs
to have ovsdb started up, so waiting for network.target does
create circular dependency.

To avoid that we're allowing socket to bind on IP even when IP is not
UP yet. Other possible solution would be to bind on 0.0.0.0.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/872896
Closes-Bug: #2003631
Related-Bug: #2002653
[SEP]
FILES CHANGED:
tasks/galera_server_post_install.yml (+2, -0)
",-2.481752,-0.059641,1.722511,-0.406361,-0.542125,-0.02546,0.128059,-0.216757,-0.336484,-0.15277,0.113597,-0.205605,0.059047,-0.036738,0.104665
openstack/charm-nova-compute,Id34e9c6f85886dbf880df0b7002110a40ef41ad6,1,1,1.0,4.2195,0.0,4,5.67,269,0,Bug Fix,0,0,0,3,0.006,0.0,0,0.0,1,1,0,1.0,1.4807,1.0,-102.48,23.44,1,0,0.6269,0,3.9559,0,36,0,33,0,"Restart failed subordinate services

Resolved Conflicts:
	hooks/nova_compute_hooks.py
	unit_tests/test_nova_compute_hooks.py

Closes-Bug: #1947585
(cherry picked from commit 140be9d0a99f65769899a710ea9d378a29a29e80)
[SEP]
FILES CHANGED:
hooks/nova_compute_utils.py (+22, -0)
unit_tests/test_nova_compute_hooks.py (+5, -0)
hooks/nova_compute_hooks.py (+3, -0)
unit_tests/test_nova_compute_utils.py (+37, -0)
",-1.898577,-0.229619,-2.002793,-1.421618,1.053759,-0.055364,-0.510513,0.114364,0.073395,-0.317428,-0.164549,-0.540338,0.127559,0.497751,0.094693
openstack/charm-nova-compute,Iaf5b44be70ee108cbe88b4a26f0f15f915d507fe,1,1,1.0,5.2781,0.2051,14,13.89,970,0,Bug Fix,0,0,0,4,0.007055,1.0,0,1.0,5,6,0,1.0,2.353,3.64,26.92,16.12,1,0,0.5744,1,4.949,0,14,0,43,0,"Process subordinate releases packages map

For principal - subordinate plugin type relations where the
principal Python payload imports code from packages managed by a
subordinate, upgrades can be problematic.

This change will allow a subordinate charm that have opted into the
feature to inform its principal about all implemented release -
packages combinations ahead of time. With this information in place
the principal can do the upgrade in one operation without risk of
charm relation RPC type processing at a critical moment.

This makes use of
https://github.com/juju/charm-helpers/pull/643

This is similar to
https://review.opendev.org/c/openstack/charm-keystone/+/781822

Also fixed broken link to charm-guide.

Note, that this includes a ch sync as part of the cherry-pick to pick up
the charm-helpers functions.

Closes-Bug: #1927277
(cherry picked from commit 8fb37dc0c1f76754f9b94863317af03b770516cd)
[SEP]
FILES CHANGED:
hooks/nova_compute_utils.py (+19, -6)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+3, -0)
hooks/charmhelpers/contrib/openstack/templates/haproxy.cfg (+4, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken (+3, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
unit_tests/test_nova_compute_utils.py (+79, -31)
hooks/charmhelpers/contrib/openstack/context.py (+9, -0)
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend (+2, -0)
tests/README.md (+1, -1)
hooks/charmhelpers/contrib/openstack/utils.py (+17, -0)
hooks/charmhelpers/contrib/storage/linux/ceph.py (+3, -1)
tox.ini (+1, -1)
hooks/charmhelpers/contrib/openstack/templates/openstack_https_frontend.conf (+2, -0)
hooks/charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-2.562014,0.007922,2.548008,-1.264745,-0.457378,-0.117847,0.401954,0.239001,0.197974,-0.331187,-0.19867,0.320507,-0.024018,-0.14325,0.014024
openstack/openstack-ansible-haproxy_server,I3c6cfd7779e9ec9322e655cdda5bb6866bf695ca,1,1,0.9394,1.0986,0.5,1,13.0,214,0,Bug Fix,0,0,0,66,0.032901,0.0,0,0.0,1,1,0,0.6667,0.0,1.0,43.96,12.89,0,0,0.0,0,71.3333,0,6,0,15,0,"Use let's encrypt standalone flag only for http-01

In case of using dns-01 challange deployers might want
to avoid using
standalone flag.

Closes-Bug: #2006938
[SEP]
FILES CHANGED:
tasks/haproxy_ssl_letsencrypt.yml (+1, -1)
",0.95163,-1.648122,-0.192024,-0.335237,-0.311185,-0.313029,-0.553254,0.272485,-0.100897,-0.121336,-0.464016,-0.02308,0.279786,-0.169847,0.173393
openstack/charm-neutron-openvswitch,I6ddab6f3b39a8f0fa4db07450022d85ba60d72de,1,0,1.0,6.1696,0.1656,31,9.4,346,0,CI,0,0,1,13,0.082803,1.0,0,1.0,5,6,0,0,3.5512,3.19,38.89,13.12,1,0,0.0294,1,0.7238,0,0,0,0,0,"Add Antelope support

* sync charm-helpers to classic charms
* change openstack-origin/source default to antelope
* align testing with antelope
* add new antelope bundles
* add antelope bundles to tests.yaml
* add antelope tests to osci.yaml and .zuul.yaml
* update build-on and run-on bases
[SEP]
FILES CHANGED:
hooks/charmhelpers/contrib/hahelpers/cluster.py (+1, -1)
osci.yaml (+1, -1)
tests/bundles/lunar-antelope.yaml (+1, -1)
test-requirements.txt (+1, -0)
hooks/charmhelpers/contrib/openstack/templates/haproxy.cfg (+5, -0)
hooks/charmhelpers/contrib/openstack/ssh_migrations.py (+2, -2)
hooks/charmhelpers/contrib/openstack/context.py (+117, -32)
hooks/charmhelpers/fetch/ubuntu.py (+33, -5)
hooks/charmhelpers/contrib/network/ovs/ovsdb.py (+47, -13)
hooks/charmhelpers/contrib/openstack/deferred_events.py (+3, -1)
hooks/charmhelpers/contrib/openstack/templates/section-service-user (+11, -0)
hooks/charmhelpers/contrib/openstack/vaultlocker.py (+6, -1)
hooks/charmhelpers/core/host.py (+1, -1)
hooks/charmhelpers/contrib/network/ip.py (+1, -1)
hooks/charmhelpers/contrib/network/ovs/ovn.py (+13, -0)
hooks/charmhelpers/contrib/openstack/ip.py (+25, -0)
hooks/charmhelpers/core/unitdata.py (+6, -5)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+2, -0)
hooks/charmhelpers/contrib/storage/linux/utils.py (+18, -3)
hooks/charmhelpers/contrib/charmsupport/nrpe.py (+55, -1)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken (+2, -0)
.zuul.yaml (+1, -1)
hooks/charmhelpers/contrib/network/ovs/__init__.py (+1, -1)
hooks/charmhelpers/contrib/openstack/ha/utils.py (+29, -0)
hooks/charmhelpers/core/host_factory/ubuntu.py (+1, -0)
tests/tests.yaml (+5, -4)
hooks/charmhelpers/contrib/openstack/utils.py (+4, -3)
tests/bundles/jammy-antelope.yaml (+1, -1)
charmcraft.yaml (+3, -0)
metadata.yaml (+1, -0)
tox.ini (+1, -1)
",-1.675186,0.168612,-0.743246,0.807034,1.132784,-1.014112,-0.158055,0.32431,-0.599572,-0.165729,-0.260013,-0.256191,0.55349,0.509731,-0.118893
openstack/charm-nova-compute,I2aa74442ec25b21201a47070077df27899465814,1,1,0.7273,5.4806,0.1172,6,16.57,737,0,Bug Fix,0,0,0,11,0.080882,1.0,0,0.7273,1,1,0,1.0,1.8181,1.0,54.36,12.49,1,0,0.5105,0,3.0708,0,80,0,35,0,"Use a stable hostname to render nova.conf

OVS introduced a new service called ovs-record-hostname.service which
records the hostname on the first start in the ovs database to identify
the ovn chassis, this is how it achieved a stable hostname and be
resilient to the changes in the FQDN when the DNS gets available.

This change introduces the same approach for nova-compute charm. In the
first run of the NovaComputeHostInfoContext the value passed in the
context as host_fqdn is stored in the unit's kv db, and re-used on every
subsequent call.

This change affects only new installs since the hint to store (or not)
the host fqdn is set in the install hook.

Closes-Bug: #1896630
[SEP]
FILES CHANGED:
hooks/nova_compute_context.py (+95, -0)
hooks/nova_compute_utils.py (+2, -13)
unit_tests/test_nova_compute_hooks.py (+8, -4)
hooks/nova_compute_hooks.py (+3, -4)
unit_tests/test_nova_compute_utils.py (+0, -7)
unit_tests/test_nova_compute_contexts.py (+103, -0)
",-1.627386,-1.237316,1.891495,-0.135026,-0.273318,-0.265239,0.330941,0.200428,0.435526,-0.489451,-0.036482,0.16938,-0.485465,0.143087,0.125343
openstack/charm-nova-compute,I4468ef1a0619befc75c6af2bad8df316125a7cf5,1,0,0.75,5.7807,0.3808,8,20.33,1785,0,CI,0,0,0,12,0.032,1.0,0,0.75,1,1,0,1.0,2.5586,1.0,26.36,15.18,1,0,0.9412,0,5.5093,0,0,0,0,0,"Refactor unit tests to avoid leaks of mocks.

It was found that the modules test_actions_openstack_upgrade and
test_actions_package_upgrade were mocking different classes and
functions right before importing the modules under test
(openstack_upgrade and package_upgrade respectively), although these
mocks weren't being reset making tests executions coming after them to
get benefitted (or impacted) by the mocks in memory.

This patch takes advantage of mock.patch() decorator at the class level
and importlib.reload() to make sure the mocks don't outsurvive the
module.

When the teardown was in place it was found a different set of functions
that were relying on that mocking, so they were patched to allow the
tests run in the expected (mock'ed) environment.

Summary of changes:

 - Move get_availability_zone() to contexts module, nova_compute_utils
   depends on nova_compute_context, the latter shouldn't be importing
   code from the former since it breaks the layering, even when the
   import is being done within a function's body.
 - Mock env variable JUJU_UNIT_NAME per test case, the tests defined
   in the test_nova_compute_utils and test_nova_compute_contexts were
   relying on the leakage of mocks set by other test modules, this
   makes them run in an isolated fashion.
 - Move update_nrpe_config testing to its own class, the main class
   NovaComputeRelationsTests mocks the function update_nrpe_config()
   making it difficult to test it in a test method, hence making the
   test part of its own class it's posible to not mock the function
   and correctly runs its implementation.
 - Teardown mocks made at import level.

Func-Test-Pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/997
[SEP]
FILES CHANGED:
hooks/nova_compute_context.py (+6, -4)
hooks/nova_compute_utils.py (+0, -7)
unit_tests/test_nova_compute_hooks.py (+48, -20)
hooks/nova_compute_hooks.py (+1, -1)
unit_tests/test_nova_compute_utils.py (+22, -58)
unit_tests/test_actions_package_upgrade.py (+29, -14)
unit_tests/test_actions_openstack_upgrade.py (+36, -17)
unit_tests/test_nova_compute_contexts.py (+58, -2)
",-2.838392,0.242437,3.960099,-0.660266,-0.104335,0.363149,-0.858303,-0.672238,-0.7592,-0.415449,-0.645961,0.346111,-0.192034,-0.04285,0.179401
openstack/charm-masakari,I0821304b3f0e586e3a868e3c95294a688bae085a,1,1,1.0,1.6094,0.0,2,10.0,270,0,Bug Fix,0,0,0,2,0.285714,0.0,0,0.0,3,1,0,0,1.0,2.5,-0.72,17.33,1,0,0.0,1,54.0,0,8,0,17,0,"Add section-oslo-rabbitmq to templates

Ensure the RabbitMQ oslo.messaging section is used in all templates;
this configures SSL options when deployed in TLS secured configurations
with RabbitMQ.

Closes-Bug: 2007567
[SEP]
FILES CHANGED:
src/templates/stein/masakari.conf (+2, -0)
src/templates/masakari.conf (+2, -0)
",0.36876,-1.152864,-0.543807,-0.051386,-0.003819,-0.329723,-0.485385,0.677525,-0.016413,-0.397722,-0.132937,-0.253645,0.129168,0.032115,0.158522
openstack/kolla-ansible,I13ee17a96033da75cbb377bce483f027127d646d,1,0,0.8696,1.3863,0.3333,2,2.33,86,0,CI,0,0,1,46,0.047917,0.5385,0,0.4682,1,2,0,0.8168,0.9183,0.5,11.1,18.08,0,0,0.3333,1,21.5,0,0,0,0,0,"CI: Pin ansible-lint to <6.13.0
[SEP]
FILES CHANGED:
lint-requirements.txt (+1, -1)
zuul.d/base.yaml (+1, -0)
",2.129714,1.970281,0.182698,-0.301473,-0.089683,-0.363433,-0.623194,0.066952,-0.248519,1.577614,0.154519,0.323579,-0.554426,0.147698,0.594678
openstack/kolla-ansible,I292e8a10bfd0a0082cee1f9bea260b5f52089cee,1,0,0.8961,0.6931,0.0,1,10.33,277,0,Bug Fix,0,0,0,77,0.025337,0.0,0,0.0,4,1,0,0.8175,0.0,4.0,35.33,11.88,0,0,0.0,0,138.5,0,0,0,0,0,"Fix docker version precheck (bad backport)

The backport of I5219cb42c48d5444943a2d48106dc338aa08fa7c to yoga &
earlier branches lost a crucial failed_when condition on the Docker
version precheck. This change replaces it.
[SEP]
FILES CHANGED:
ansible/roles/prechecks/tasks/package_checks.yml (+1, -0)
",0.504589,-1.19196,-1.253696,-1.219059,0.894048,0.397461,0.476987,-0.543356,0.297876,-0.140012,-0.252389,0.247744,-0.053281,-0.210631,0.043885
openstack/octavia,I0e2d06b02c06b8c77fb1c2f94207d422066a0c6d,1,0,0.4857,3.091,0.0476,3,14.67,331,0,Bug Fix,0,0,0,105,0.004141,0.0,0,0.0,4,2,0,0.5927,1.206,2.67,53.51,12.23,0,0,0.6667,1,15.0455,0,0,0,0,0,"Fix text/plain mime type with healthcheck endpoint

Previously if you used an accept header of text/plain when querying the healthcheck endpoint, you would get a 406 Not Acceptable response.
This patch corrects that to allow requesting the healthcheck document in text format.
[SEP]
FILES CHANGED:
octavia/tests/functional/api/test_healthcheck.py (+14, -0)
octavia/api/root_controller.py (+1, -1)
releasenotes/notes/Fix-healthcheck-text-plain-mime-type-134485abb8bcea0c.yaml (+5, -0)
",0.303466,-0.216219,-0.621926,1.419275,0.189819,0.432476,1.005821,-0.611957,0.194968,-0.021984,0.261128,-0.020195,0.032266,-0.343935,-0.121548
openstack/python-octaviaclient,Iae5b09dc163e8a4e0ed51f065079301b7e4287d3,1,0,1.0,3.1781,0.3913,3,10.5,316,0,Feature,0,0,1,6,0.007092,0.2826,0,0.2826,5,2,0,0.1667,1.2088,2.67,31.01,16.58,1,0,0.5217,0,13.1667,0,0,0,0,0,"Remove munch dependency

This is not maintained and is no longer used by openstacksdk. There are
only three users of the library, one of which is incorrect and the
remainder of which we can easily replace.
[SEP]
FILES CHANGED:
requirements.txt (+0, -1)
octaviaclient/tests/unit/osc/v2/test_load_balancer.py (+8, -4)
octaviaclient/osc/v2/utils.py (+6, -4)
",0.947872,-1.813891,-0.137898,0.581697,-0.997058,0.500935,0.530023,-0.537543,-0.436926,0.129953,-0.321118,0.804642,-0.65071,-0.118559,0.119886
openstack/openstack-ansible-os_neutron,Iec4eacab8f6ddd2d3d2f59c0928f5e6455bbdbdd,1,0,0.6,1.0986,0.5,1,4.0,228,0,Bug Fix,0,0,0,5,0.113636,0.0,0,0.0,1,1,0,0.8571,0.0,1.0,-61.6,16.6,0,0,0.0,0,76.0,0,0,0,0,0,"Fix typo in ansible_facts['pkg_mgr']

In [1] we accidentally merged change containing typo.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_neutron/+/860480
[SEP]
FILES CHANGED:
vars/distro_install.yml (+1, -1)
",-0.02036,2.074668,-1.079299,-0.041977,-0.984096,-0.306597,0.209951,0.017981,0.088048,-0.293817,-0.303317,-0.567247,-0.337943,-0.321178,-0.22404
openstack/kolla,I6564886f68a997b82b49b6f975283a6d95831ce6,0,0,0.8723,1.7918,0.6,2,6.0,100,0,Feature,0,0,0,47,0.048806,0.6667,0,0.5816,2,2,0,0.8221,0.971,2.0,-81.25,22.4,0,0,0.0,0,16.6667,0,0,0,0,0,"toolbox: use ansible-collections-openstack >2
[SEP]
FILES CHANGED:
docker/kolla-toolbox/requirements.yml (+1, -1)
docker/kolla-toolbox/Dockerfile.j2 (+1, -2)
",2.017927,0.961411,0.475342,-0.398669,0.402758,-1.536748,-0.669521,-0.017759,-0.106636,0.076865,-0.088499,0.067228,-0.150247,0.116681,0.424409
openstack/kolla-ansible,I46985202dc8da22601357eefe2727599e7a413e5,1,0,0.9286,2.8332,0.0,3,15.0,282,0,Feature,0,0,0,14,0.018253,1.0,0,0.9286,4,3,0,0.8182,1.2476,2.67,-28.35,22.0,1,0,0.0,1,16.5882,0,0,0,0,0,"Configure coordination in default for masakari-api

This patch introduces distributed lock for masakari-api
service when handle the concurrent notifications for the same
host failure from multiple masakari-hostmonitor services.
[SEP]
FILES CHANGED:
releasenotes/notes/new-variable-masakari-coordination-backend-d3b742315a07aabc.yaml (+6, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+9, -0)
",1.075494,-0.786934,0.123827,0.697803,0.14614,-0.697988,0.351821,0.42734,0.075847,-0.711163,-0.271066,0.537314,-0.023761,-0.090843,0.390318
openstack/charm-rabbitmq-server,I540ea8da85b3b4326ccb8194f1d8b1050b04eae9,1,1,1.0,5.7991,0.0274,2,8.43,783,0,Bug Fix,0,0,0,5,0.006562,1.0,0,1.0,1,1,0,1.0,0.8787,1.0,60.63,10.49,1,0,0.7021,0,2.3727,0,6,0,5,0,"Fix focal to jammy series upgrade

This is a fix/workaround to the package upgrade bug that affects the
charm.  The post-inst package script updates the .erlang.cookie if it is
insecure during the upgrade of rabbit from 3.8 to 3.9.  This breaks the
series-upgrade resulting in a charm erroring on the post-series-upgrade
hook.

This fix works by checking if the .erlang.cookie has changed during the
post-series-upgrade hook and either updating the cookie in peer storage
(if it is insecure) or ensuring that the cookie from peer storage is
written to the .erlang.cookie if it isn't the leader. This ensures that
the cluster continues to work and that the series-upgrade can be
completed across the cluster.

Closes-Bug: #2006485
[SEP]
FILES CHANGED:
unit_tests/test_rabbitmq_server_relations.py (+230, -1)
hooks/rabbitmq_server_relations.py (+90, -8)
",-2.129298,-0.572825,1.632595,0.137283,-0.033396,0.009332,0.618923,0.12678,0.236707,-0.160061,0.460978,0.341564,-0.255788,0.047496,0.52214
openstack/ironic,Id21dd7eb44dad149661ebe2d75a9b030aa70526f,1,0,0.9643,4.6821,0.2523,9,16.29,734,0,Feature,0,0,0,28,0.012017,1.0,0,0.9643,4,2,0,0.9481,2.7713,2.67,55.98,12.13,1,0,0.4486,1,6.7963,0,0,0,0,0,"Do not move nodes to CLEAN FAILED with empty last_error

When cleaning fails, we power off the node, unless it has been running
a clean step already. This happens when aborting cleaning or on a boot
failure. This change makes sure that the power action does not wipe
the last_error field, resulting in a node with provision_state=CLEANFAIL
and last_error=None for several seconds. I've hit this in Metal3.

Also when aborting cleaning, make sure last_error is set during
the transition to CLEANFAIL, not when the clean up thread starts
running.

While here, make sure to log the current step in all cases, not only
when aborting a non-abortable step.

Story: #2010603
Task: #47476
[SEP]
FILES CHANGED:
ironic/conductor/manager.py (+2, -1)
ironic/tests/unit/conductor/test_utils.py (+23, -1)
releasenotes/notes/cleaning-error-5c13c33c58404b97.yaml (+8, -0)
ironic/tests/unit/conductor/test_manager.py (+2, -1)
ironic/conductor/utils.py (+5, -3)
ironic/tests/unit/conductor/test_cleaning.py (+11, -10)
ironic/common/states.py (+3, -0)
ironic/conductor/cleaning.py (+18, -8)
ironic/conductor/task_manager.py (+8, -3)
",-2.05598,-1.128311,1.342638,0.037146,-0.14137,0.456867,0.09053,-0.598849,0.012981,0.200655,0.560544,0.055996,0.111881,0.230836,0.181062
openstack/octavia,I914aaa2eb57cf4c7206909e8ea17af1033c54965,1,0,0.4906,1.0986,0.5,1,8.33,225,0,Bug Fix,0,0,0,106,0.004177,0.0,0,0.0,2,1,0,0.5941,0.0,2.0,8.87,12.93,0,0,0.0,1,75.0,0,0,0,0,0,"Fix example policy file system-reader role

This patch fixes the sample keystone_default_roles-policy.yaml file to use admin instead of reader for the system-reader role.
[SEP]
FILES CHANGED:
etc/policy/keystone_default_roles-policy.yaml (+1, -1)
",1.059412,0.842361,-0.611196,1.331617,0.582678,-0.266817,1.027779,0.465654,0.404962,-0.840095,0.421796,0.205516,-0.313478,0.246825,-0.008221
openstack/kolla-ansible,I3f593288a5c7bf45cca012ea6d0db18842980438,0,0,0.9556,2.9957,0.0,4,14.5,214,0,CI,0,0,0,45,0.066865,0.875,0,0.8361,4,3,0,0.8189,1.799,3.0,37.5,15.46,1,0,0.0,1,10.7,0,0,0,0,0,"Allow to specify ca_file for blackbox exporter

This can be used to monitor the public OpenStack endpoints when their
certificate is not signed by a public CA.
[SEP]
FILES CHANGED:
releasenotes/notes/prometheus-blackbox-exporter-cafile-ea1e5a282066b2e9.yaml (+9, -0)
ansible/roles/prometheus/defaults/main.yml (+2, -0)
etc/kolla/globals.yml (+4, -0)
ansible/roles/prometheus/templates/prometheus-blackbox-exporter.yml.j2 (+4, -0)
",1.504561,-1.386192,-0.330258,0.66932,0.134081,0.014733,0.630303,0.185519,0.380069,-0.516405,-0.189213,0.416866,-0.491149,-0.410341,-0.700262
openstack/ironic,I5efd3c9f79a021f1a8e613c3d13b6596a7972672,1,0,0,4.7449,0.0175,5,23.0,628,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,2,0,0.9487,1.7438,4.0,38.2,15.29,1,0,0.8158,1,5.4609,1,0,0,0,0,"Fix auth_protocol and priv_protocol for SNMP v3

SNMP driver was using the wrong dictionary key to retrieve auth_protocol
and priv_protocol from driver info.  As a result, the SNMP client was
created with empty strings for both those fields.  Any nodes configured
to use SNMP v3 with those fields failed because the SNMP driver was
unable to perform power related operations due to authentication error.

- Use correct keys for snmp auth_protocol and priv_protocol when
  creating SNMP client
- Sanitize snmp auth_key and priv_key in API results

Story: 2010613
Task: 47535
[SEP]
FILES CHANGED:
ironic/drivers/modules/snmp.py (+2, -2)
ironic/tests/unit/drivers/modules/test_snmp.py (+35, -0)
releasenotes/notes/bug-2010613-3ab1f32aaa776f28.yaml (+7, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+58, -0)
ironic/api/controllers/v1/node.py (+10, -0)
",-2.191721,-0.470743,0.570728,0.862603,0.964352,0.141048,-0.521998,0.037308,-0.060485,-0.223667,0.293532,-0.250796,0.21727,0.068789,0.069718
openstack/kolla-ansible,Ic153a91beb30daa334ccbb0430ce8340bd6c480f,1,0,0.8542,4.1109,0.9833,5,6.0,86,0,Feature,0,0,0,48,0.049587,1.0,0,0.8542,4,3,0,0.8158,1.999,3.0,-38.95,22.4,0,0,0.05,0,1.4098,0,0,0,0,0,"Remove keystone admin leftovers
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/upgrade.yml (+0, -11)
ansible/group_vars/all.yml (+1, -8)
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+0, -28)
ansible/roles/keystone/defaults/main.yml (+0, -9)
tests/upgrade.sh (+0, -3)
",3.242332,0.610666,1.481988,0.182705,0.871386,0.543433,0.341885,0.117059,0.006684,-1.027254,-0.153942,-0.295849,0.28968,0.022585,-0.149873
openstack/openstack-ansible-haproxy_server,I294e962bdb796190d1e7a2555708fbfaa8384a0a,1,0,0.9403,1.3863,0.0,1,10.0,258,0,Bug Fix,0,0,0,67,0.033367,1.0,0,0.9403,1,1,0,0.75,0.0,1.0,19.03,14.67,0,0,0.0,0,64.5,0,0,0,0,0,"Fix tags usage for letsencrypt setup

We haven't specified tags for let's encrypt task which resulted in task
not being executed when using them.

Co-Authored-By: Damian DƒÖbrowski <damian@dabrowski.cloud>
[SEP]
FILES CHANGED:
tasks/main.yml (+3, -0)
",0.237164,0.204459,-0.986395,0.141455,-0.551405,0.179174,0.074365,-0.291512,-0.25297,-0.443009,0.277064,0.111779,0.220789,0.170555,-0.499919
openstack/ironic,Ie89e8be9ad2887467f277772445d4bef79fa5ea1,1,0,0.9615,3.6636,0.0,3,33.0,637,0,Feature,0,0,0,26,0.01097,1.0,0,0.9615,4,2,0,0.9494,1.2675,2.67,21.23,20.47,0,0,0.6579,1,16.3333,0,0,0,0,0,"Clean out agent token even if power is already off

While investigating a very curious report, I discovered that
if somehow the power was *already* turned off to a node, say
through an incorrect BMC *or* human action, and Ironic were
to pick it up (as it does by default, because it checks before
applying the power state, then it would not wipe the token
information, preventing the agent from connecting on the next
action/attempt/operation.

We now remove the token on all calls to conductor
utilities node_power_action method when appropriate, even
if no other work is required.
[SEP]
FILES CHANGED:
ironic/tests/unit/conductor/test_utils.py (+25, -0)
ironic/conductor/utils.py (+7, -0)
releasenotes/notes/fix-power-off-token-wipe-e7d605997f00d39d.yaml (+6, -0)
",-0.362387,-2.070219,1.163843,0.182315,-0.671747,0.008735,0.793748,-0.632697,-0.084199,-0.072409,0.550688,-0.155605,-0.080987,0.121659,0.057169
openstack/openstack-ansible-haproxy_server,If8ae64bc01510d3570fa4c554463bd6121b21f86,1,0,0.7895,0.6931,0.0,1,25.25,701,0,CI,0,0,0,19,0.197917,1.0,0,0.7895,1,1,0,0.8,0.0,1.0,26.25,19.21,0,0,0.0,0,350.5,0,0,0,0,0,"Serialise initial issuing of LetsEncrypt certificates

Currently the role will run against all target hosts, and it is
possible that the calling playbook runs with a serial: setting
to control how many hosts are targetted simultaneously.

However, this is not sufficient to guarantee that each potential
haproxy server requests a LetsEncrypt certificate sequentially.
It is only possible for the loadbalancer to direct the challenge
from the ACME server to one certbot instance at a time, so this
patch enforces serialisation of the initial certificate generation
regardless of the number of target hosts and setting of serial:
outside this role.
[SEP]
FILES CHANGED:
tasks/haproxy_ssl_letsencrypt.yml (+1, -0)
",-1.308681,-2.074662,0.907431,0.745443,0.188714,-0.116743,0.195226,0.205026,0.514114,0.207259,-0.009079,0.321961,-0.33262,-0.204653,-0.231633
openstack/openstack-ansible-rabbitmq_server,I7ef7b3fed79933b4c8bbc39a63ca6db54532e10e,1,0,0.6667,1.6094,0.5,1,22.0,472,0,Feature,0,0,0,6,0.130435,0.0,0,0.0,1,1,0,0.6,0.0,1.0,23.0,19.71,0,0,0.0,0,94.4,0,0,0,0,0,"Do not use 'always' tag in inappropriate places

Using 'always' tag in combination with condition depending on
variables is not always a good idea because these variables may not be
defined at the moment.

Currently, rabbitmq_server role cannot be executed with tag limit,
because task containing 'always' tag has a condition operating on
variable(s) that are registered only when 'rabbitmq-config' tag is being
used.
[SEP]
FILES CHANGED:
tasks/rabbitmq_post_install.yml (+2, -2)
",-0.408214,-1.374999,0.363395,0.801997,0.21812,-0.382926,0.543178,-0.603587,0.112785,-0.071867,-0.104764,-0.087805,0.023942,-0.047192,-0.157813
openstack/octavia,Ibeb9132e65706b50706249df3e8b6c455863513c,0,0,0.7326,4.9767,0.5208,9,13.67,304,0,CI,0,0,0,86,0.007621,0.6,0,0.4395,7,1,0,0.5954,2.6002,5.22,32.02,17.17,1,0,0.6042,0,2.0966,0,0,0,0,0,"Remove specific handling of amphorav1 parameters

Some functions in the drivers accepted 2 different types for the same
parameters: provider dict or provider data models.
Now that amphorav1 is removed, we can remove the cases that handle both
types.
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/drivers/keepalived/jinja/test_jinja_cfg.py (+4, -4)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+2, -2)
octavia/amphorae/drivers/keepalived/jinja/jinja_cfg.py (+3, -12)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+6, -21)
octavia/tests/unit/amphorae/drivers/noop_driver/test_driver.py (+4, -1)
octavia/amphorae/drivers/noop_driver/driver.py (+3, -5)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+8, -11)
octavia/amphorae/drivers/driver_base.py (+1, -2)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+38, -17)
",0.658709,-1.568433,0.138207,0.770573,0.030297,-0.027474,0.278369,0.021683,-0.135278,0.039318,-0.574266,-0.010528,-0.19059,-0.344742,-0.099339
openstack/octavia,Iccae6ec561603653183911146a638272df631e92,1,0,0.7241,3.7377,0.5854,3,14.67,318,0,Feature,0,0,0,87,0.007612,0.75,0,0.5431,7,2,0,0.5934,1.4125,4.67,38.13,14.05,0,0,0.2683,1,7.5714,0,0,0,0,0,"Don't update the management port when calculating delta

CalculateDelta should be used to get the list of subnets/networks to
plug (or unplug) into the amphora for the VIP and the members.
It should never reconfigure the management port.

Story 2010623
Task 47564
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+0, -11)
octavia/controller/worker/v2/tasks/network_tasks.py (+10, -13)
releasenotes/notes/fix-bad-management-port-update-3fa157f74ee8c7b2.yaml (+7, -0)
",0.315759,-1.19373,-0.547884,0.402344,-0.065379,0.245297,0.10159,-0.18795,0.093113,-0.337949,-0.113758,0.017065,-0.11027,0.281852,-0.509993
openstack/octavia,I3706fd5e12e17be37edce974563c6806d4f09709,1,0,0,4.9767,0.2569,5,15.25,416,0,CI,0,0,0,0,0.0,0.625,0,0.0,6,2,0,0.5948,2.0815,4.2,31.86,16.59,1,0,0.5972,1,2.869,0,0,0,0,0,"allowed_cidr validation for additional_vips

The validation for the allowed_cidr parameter did not take into account
the IP version of additional vIPs. The parameter was rejected if the IP
version did not match the IP version of the primary vIP. As additional
vIPs can have a different IP version from the primary vIP all vIPs must
be checked during validation.
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+28, -3)
octavia/network/drivers/neutron/allowed_address_pairs.py (+13, -5)
releasenotes/notes/allowed_cidr-validation-for-additional_vips-175c32824cc7ee95.yaml (+7, -0)
octavia/tests/functional/api/v2/test_listener.py (+38, -17)
octavia/api/v2/controllers/listener.py (+21, -12)
",-0.962043,-0.213982,-0.14947,1.799379,1.085153,0.265426,0.317317,-0.058188,0.940349,-0.03083,0.13065,0.305339,-0.122464,0.094838,-0.066612
openstack/ansible-role-systemd_service,Ifce33fcf119b2b380a0234c60dab810ad9ac914a,0,1,0.9412,2.3026,0.1111,2,15.88,846,0,Bug Fix,0,0,0,68,0.033814,1.0,0,0.9412,2,2,0,1.0,0.7642,1.5,49.5,12.65,0,0,0.0,1,84.6,0,6,0,20,0,"Restart changed services if state is started

At the moment role will skip executing handlers if state of the service
is provided. It's made this way as role has a task that attempts
to ensure service state before handlers run. Thus, if state is
restarted, reloaded or stopped we should not execute handler.
But, if state is started this leads to skipping service restart when
unit file is changed. While this can be addressed by another handler
that listens for `systemd service changed` it's quite inconvenient.

As a negative side-effect services might be restarted multiple times if
there're some other changes/handlers from place where systemd_service
was called. So systemd_service will trigger a service restart and
your in-role handlers will be executed as well.

Closes-Bug: #2009029
[SEP]
FILES CHANGED:
releasenotes/notes/systemd_restart_if_started-7001522ab40ca804.yaml (+7, -0)
handlers/main.yml (+1, -1)
",-2.028932,-1.552822,1.492088,0.086721,-0.312452,0.051703,0.135561,-0.543932,-0.064886,0.15845,0.274214,0.039547,0.064677,-0.045521,0.016404
openstack/ironic,I236cdf6ddb040284e9fd1fa10136ad17ef665638,1,0,0.963,2.8904,0.1176,3,17.67,366,0,CI,0,0,0,27,0.011213,1.0,0,0.963,4,2,0,0.95,1.5486,2.67,37.26,14.61,0,0,0.3529,1,20.3333,0,0,0,0,0,"Wipe Agent Token when cleaning timeout occcurs

In a relatively odd turn of events, should cleaning
have started, but then timed out due to lost communications
or a hard failure of the machine, an agent token could
previously be orphaned preventing re-cleaning.

We now explicitly remove the token in this case.
[SEP]
FILES CHANGED:
ironic/tests/unit/conductor/test_utils.py (+6, -0)
ironic/conductor/utils.py (+2, -2)
releasenotes/notes/wipe-agent-token-upon-cleaning-timeout-c9add514fad1b02c.yaml (+7, -0)
",0.690452,-1.756127,0.248144,0.489922,-0.768248,0.497554,0.799678,-0.914781,0.285319,0.047924,0.266957,0.247719,0.188376,0.11197,0.117335
openstack/charm-ceph-dashboard,I975bbe00d27d10900503deb3e031b9b906ee8c70,1,0,1.0,1.0986,1.0,1,12.0,160,0,Feature,0,0,0,3,0.003464,0.0,1,0.0,0,1,0,1.0,0.0,0.0,-9.79,18.13,0,0,0.0,0,53.3333,0,0,0,0,0,"Remove note about tech-preview state

(cherry picked from commit f5cba486f71274a0f0a0e38c7fb5d853073f3aeb)
[SEP]
FILES CHANGED:
README.md (+0, -2)
",0.822588,0.258351,-2.298931,-2.37289,1.405052,0.56577,1.263983,-0.847964,0.146511,-0.176504,-0.542428,0.595065,-0.12209,-0.181878,-0.13899
openstack/octavia,I193b9149149bad41ab86ee5a68316338c20d87a3,0,0,0.2,0.6931,0.0,1,2.0,90,0,Feature,0,0,0,20,0.246914,0.6667,0,0.1333,0,1,0,0.5961,0.0,0.0,-34.89,20.8,1,0,0.0,0,45.0,0,0,0,0,0,"Update .gitreview for stable/2023.1
[SEP]
FILES CHANGED:
.gitreview (+1, -0)
",2.952155,0.57782,0.9316,-1.000785,-0.19948,0.06801,0.149744,0.880632,-0.161057,0.950569,-0.922943,-0.301239,-0.743306,0.701812,0.595393
openstack/octavia,Ic3bf59969b7cedd44b5168ca65fd25b5804fd56b,0,0,0.1905,2.7081,0.5,3,8.43,476,0,CI,0,0,0,21,0.256098,0.5373,0,0.1023,2,2,0,0.5942,1.3788,1.33,36.25,12.18,1,0,0.0,1,31.7333,0,0,0,0,0,"Update TOX_CONSTRAINTS_FILE for stable/2023.1

Update the URL to the upper-constraints file to point to the redirect
rule on releases.openstack.org so that anyone working on this branch
will switch to the correct upper-constraints list automatically when
the requirements repository branches.

Until the requirements repository has as stable/2023.1 branch, tests will
continue to use the upper-constraints list on master.
[SEP]
FILES CHANGED:
elements/octavia-lib/source-repository-octavia-lib (+1, -1)
elements/amphora-agent/source-repository-amphora-agent (+2, -2)
tox.ini (+4, -4)
",-1.331909,-0.185146,0.011163,1.1555,0.337371,-0.267003,0.076118,0.363829,0.107521,0.248222,-0.188249,0.048146,-0.093651,0.499983,0.153594
openstack/ansible-role-systemd_service,Id48457c43e38e19f781bfe11d1fb6eaeb9fdde6f,1,0,0.9275,2.5649,0.0,2,10.0,245,0,Bug Fix,0,0,0,69,0.034158,1.0,0,0.9275,1,1,0,0.5,0.9183,1.0,30.31,14.67,0,0,0.0,0,18.8462,0,0,0,0,0,"Fix tags usage for included tasks

With usage of include_tasks tags must be applied accordingly,
which was missing. That prevented running service load whenever
systemd-service tag was used.
[SEP]
FILES CHANGED:
tasks/main.yml (+4, -0)
handlers/main.yml (+8, -0)
",0.680201,-1.836006,0.393068,0.518779,0.156428,-0.30009,-0.525904,-0.212496,-0.007427,-0.296835,-0.500044,0.032362,0.078579,0.006357,-0.064385
openstack/kolla-ansible,I387c9d8f5c01baf6054381834ecf4e554d0fff35,0,0,0,4.8122,0.0984,4,13.8,502,0,Feature,0,0,0,0,0.0,1.0,0,0.0,4,4,0,0.8165,1.3983,3.0,37.11,13.64,1,0,0.0,1,4.0813,0,0,0,0,0,"Use friendly prometheus instance labels

Replaces the instance label on prometheus metrics with the inventory
hostname as opposed to the ip address. The ip address is still used as
the target address which means that there is no issue of the hostname
being unresolvable. Can be optionally enabled or set to FQDNs by
changing the prometheus_instance_label variable as mentioned in the
release notes.

Co-Authored-By: Will Szumski <will@stackhpc.com>
[SEP]
FILES CHANGED:
releasenotes/notes/friendly-hostnames-1bb1254b2b434a11.yaml (+10, -0)
doc/source/reference/logging-and-monitoring/prometheus-guide.rst (+37, -0)
ansible/group_vars/all.yml (+3, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+60, -12)
",-0.978913,-0.592652,0.264468,0.907937,-0.084818,0.137889,0.165924,-0.039046,0.784419,-0.024665,0.282855,0.124813,-0.187776,-0.049562,-0.437161
openstack/octavia,I16430fa52db02e7445203994220673c1037d764c,1,0,1.0,1.0986,1.0,1,20.25,551,0,Bug Fix,0,0,0,2,0.25,0.0,0,0.0,2,1,0,0.5922,0.0,2.0,39.01,16.0,0,0,0.0,0,183.6667,1,0,0,0,0,"Fix upgrade check not working

The octavia-status upgrade check command fails because
the initialization of Policy() requires oslo_config to
be initialized already which it isn't.

This can be reproduced in master by running:

  tox -e venv -- octavia-status upgrade check

I can observe this issue multiple relases back which
probably means this has been broken for a long time.

We shouldn't need to init Policy() because it just
loads policy rules which is not checked in upgrade
check anyway.
[SEP]
FILES CHANGED:
octavia/cmd/status.py (+0, -2)
",-0.876399,-2.136881,0.547545,-0.09322,-0.550544,-0.466357,0.15271,-0.580549,-0.501561,0.306335,0.382252,-0.501917,0.029787,0.346853,0.148738
openstack/charm-ceph-osd,I77c84c368e6665e4988ebe9a735f000f99d0b78e,1,1,1.0,3.0445,0.05,4,9.0,1008,0,Bug Fix,0,0,0,1,0.090909,0.0,0,0.0,2,2,0,0.0,1.6815,1.25,47.97,9.95,1,0,0.0,1,48.0,1,12,0,13,0,"Save the crash module auth key

Read the key set on the mon relation,
and use ceph-authtool to save it to a keyring,
for use by the crash module for crash reporting.

When this auth key is set, the crash module (enabled by default)
will update ceph-mon with a report.
It also results in a neat summary of recent crashes
that can be viewed by `ceph health detail`.
For example:

```
$ juju ssh ceph-mon/leader -- sudo ceph health detail

HEALTH_WARN 1 daemons have recently crashed
[WRN] RECENT_CRASH: 1 daemons have recently crashed
    osd.1 crashed on host node-3 at 2023-01-04T05:25:18.218628Z
```

ref. https://docs.ceph.com/en/latest/mgr/crash/

See also https://review.opendev.org/c/openstack/charm-ceph-mon/+/869138
for where the client_crash_key relation data set is implemented.

Depends-On: https://review.opendev.org/c/openstack/charm-ceph-mon/+/869138

Closes-Bug: #2000630
(cherry picked from commit 97be046f9b541067193c50323e00657110184f97)
[SEP]
FILES CHANGED:
hooks/utils.py (+11, -0)
hooks/ceph_hooks.py (+4, -0)
lib/charms_ceph/utils.py (+1, -1)
templates/ceph.conf (+3, -0)
",-3.339437,1.936913,3.194882,-1.425561,-0.486612,0.303265,-0.326556,-0.185329,-0.099447,-0.507502,-0.371315,0.187882,-0.016202,0.291288,-0.0635
openstack/charm-ceph-mon,Ic95aae6b5981a6df1e0b3c310bcef8018c494a24,1,1,1.0,2.3979,0.0,1,6.62,465,0,Bug Fix,0,0,0,2,0.064516,1.0,0,1.0,1,1,0,1.0,0.0,1.0,43.68,9.44,1,0,0.0,0,42.2727,1,12,0,13,0,"Create a key for ceph-osd for crash module auth

This will be set on the osd relation,
so the ceph-osd charm can use this key for auth
by the crash reporting module.

ref. https://docs.ceph.com/en/latest/mgr/crash/

See https://review.opendev.org/c/openstack/charm-ceph-osd/+/869139
for how this key is used by ceph-osd.

Closes-Bug: #2000630
(cherry picked from commit b2408e9dd7130e3edf977c62533e6ea408c589eb)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+10, -0)
",-2.156745,0.877112,-0.037635,-1.008759,-0.107508,-0.382698,0.471372,0.106324,0.025661,-0.218129,-0.157003,-0.037249,-0.076967,-0.017683,-0.123248
openstack/openstack-ansible-galera_server,Ia6712c8847389d6f439c6b768c08a47af91bc3ae,1,0,0,1.0986,0.5,1,6.0,84,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0.8333,0.0,1.0,-10.75,29.07,1,0,0.0,0,28.0,0,0,0,0,0,"fix indentation for condition
[SEP]
FILES CHANGED:
tasks/galera_client_main.yml (+1, -1)
",3.888154,1.580823,2.96002,0.722847,0.729044,0.68559,1.074137,-1.007924,0.930515,0.223621,-0.434113,-0.64867,0.361113,-0.297641,0.490187
openstack/ironic,I7bec6cfacb9d1558bc514c07386583436759f4df,1,0,0.9643,4.3175,0.1622,3,15.56,863,0,Bug Fix,0,0,0,28,0.011546,1.0,0,0.9643,4,2,0,0.9506,1.5099,3.0,56.89,12.22,0,0,0.3919,1,11.5067,0,0,0,0,0,"Fix online upgrades for Bios/Traits

... And tags, but nobody uses tags since it is not available
via the API.

Anyhow, the online upgrade code was written under the assumption
that *all* tables had an ""id"" column. This is not always true
in the ironic data model for tables which started as pure extensions
of the Nodes table, and fails in particular when:

1) A database row has data stored in an ealier version of the object
2) That same object gets a version upgrade.

In the case which discovered this, BIOSSetting was added at version
1.0, and later updated to include additional fields which incremented
the version to 1.1. When the upgrade went to evaluate and iterate
through the fields, the command failed because the table was designed
around ""node_id"" instead of ""id"".

Story: 2010632
Task: 47590
[SEP]
FILES CHANGED:
ironic/db/sqlalchemy/api.py (+24, -7)
ironic/tests/unit/db/test_api.py (+24, -5)
releasenotes/notes/fix-online-version-migration-db432a7b239647fa.yaml (+14, -0)
",-1.646088,-1.96481,2.352271,-0.70795,-0.747352,0.153704,0.168393,0.068032,0.06021,0.14161,-0.0855,0.12145,-0.26085,0.267483,0.116287
openstack/kolla-ansible,Icf94e5d6980ff238eac90e4f8cd8e530477a9c5b,0,0,0.75,2.6391,0.1538,4,15.0,268,0,CI,0,0,0,4,0.051948,1.0,0,0.75,4,2,0,0.8134,1.7381,3.0,-22.71,22.0,1,0,0.0,1,19.1429,0,0,0,0,0,"ironic: add enable_ironic_dnsmasq parameter

With the enable_ironic_dnsmasq parameter it is possible
to explicitly disable the ironic-dnsmasq service. By default,
the parameter is set to the value of enable_ironic
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -0)
releasenotes/notes/enable_ironic_dnsmasq-4288e3e2b5819f2d.yaml (+6, -0)
ansible/roles/ironic/defaults/main.yml (+1, -1)
ansible/roles/ironic/tasks/precheck.yml (+3, -1)
",-1.880678,0.988097,-1.243234,1.952277,1.219088,0.00134,-0.613546,-0.472605,0.49769,0.053868,0.395186,0.334302,-0.397117,0.048279,0.333912
openstack/kolla-ansible,Ic61fe981825c5fa6f50e53c9555b6a102f42f522,0,0,0.6,2.3979,0.1,3,11.33,283,0,Feature,0,0,0,5,0.055556,1.0,0,0.6,4,2,0,0.8104,1.371,2.67,8.71,13.95,1,0,0.0,1,25.7273,0,0,0,0,0,"mariadb: add mariadb_datadir_volume parameter

With the parameter ``mariadb_datadir_volume`` it is possible
to use a directory as volume for the mariadb service. By default,
a volume named mariadb is used (the previous default).
[SEP]
FILES CHANGED:
releasenotes/notes/mariadb_datadir_volum-c9a597766c2c8bc8.yaml (+6, -0)
ansible/group_vars/all.yml (+2, -0)
ansible/roles/mariadb/defaults/main.yml (+1, -1)
",-1.531647,1.211123,-1.272939,1.828177,1.199148,0.186852,-0.187608,-0.109902,0.495236,0.026641,0.56652,0.372281,-0.999684,-0.048816,-0.212504
openstack/kolla-ansible,I1649a389bdc3977b936402c3ce3e55056d74ba08,1,0,0.8571,2.0794,0.2857,2,8.0,89,0,Bug Fix,0,0,0,49,0.047665,0.5,0,0.4286,4,1,0,0.8074,0.9852,4.0,8.37,23.2,0,0,0.0,0,11.125,0,0,0,0,0,"ironic: fix dev mode for inspector
[SEP]
FILES CHANGED:
ansible/roles/ironic/defaults/main.yml (+3, -1)
ansible/roles/ironic/tasks/clone.yml (+2, -1)
",2.822853,1.009224,1.388739,0.042771,0.389075,0.217012,0.233884,-0.522272,-0.017294,0.120493,0.369207,-0.346704,0.408105,-0.469881,0.53085
openstack/charm-ceph-mon,Ic2e024371ff431888731753d29fff8538232009a,1,1,0.3333,3.3673,0.0357,2,20.33,430,0,Bug Fix,0,0,0,3,0.017647,1.0,0,0.3333,1,2,0,1.0,0.3712,0.5,46.12,15.35,1,0,0.0,1,14.8276,0,14,0,10,0,"Use a different name for the local key/value store

The operator framework and charmhelpers use the same path for the
local K/V store, which causes problems when running certain hooks
like 'pre-series-upgrade'. In order to work around this issue, this
patchset makes the charmhelpers lib use a different path, while
migrating the DB file before doing so.

Closes-Bug: #2005137
[SEP]
FILES CHANGED:
src/charm.py (+26, -0)
tox.ini (+1, -1)
",-1.40349,-1.243087,0.223048,-0.746875,0.271596,-0.304575,0.68328,0.019408,0.175502,0.131765,0.114599,-0.128575,0.094837,-0.071911,-0.009328
openstack/charm-ceph-mon,I57b685cb78ba5c4930eb0fa73d7ef09d39d73743,1,1,1.0,1.0986,0.5,1,11.0,478,0,Bug Fix,0,0,0,4,0.004608,1.0,0,1.0,1,1,0,1.0,0.0,1.0,20.32,13.85,1,0,0.0,0,159.3333,0,8,0,9,0,"Fix issue with ceph-client relation handling

A bug was introduced when changing ceph-client to
an operator framework library that caused the
fallback application_name handling to present
a class name rather than a remote applicaiton name.

This change updates the handling to get at an
`app.name` rather than an `app`.

Closes-Bug: #1995086
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1022
[SEP]
FILES CHANGED:
src/ceph_client.py (+1, -1)
",-0.886755,0.255616,0.216976,-0.007062,-0.534021,-0.427219,0.463371,0.234196,0.396527,-0.073809,0.154396,-0.093291,-0.063472,0.010738,0.297215
openstack/octavia,I556c89dbc3aa73415d084187eea21d1790decbd5,1,0,0.4953,2.7081,0.0,1,12.33,263,0,Feature,0,0,0,107,0.004216,0.3333,0,0.1651,2,1,0,0.5935,0.0,2.0,57.13,12.5,0,0,0.0,1,17.5333,0,0,0,0,0,"Purge some dev tools from the amphora image

Some of the image build time tools are not being uninstalled from the amphora
image during cleanup. This patch adds a package uninstall callout for those
packages.
[SEP]
FILES CHANGED:
elements/amphora-agent/package-installs.yaml (+14, -0)
",1.124435,-0.964747,0.043686,0.86456,-0.016966,0.145595,0.729224,0.016102,-0.330616,-0.518972,-0.037489,0.47459,-0.030382,0.403287,0.312286
openstack/octavia,Ibd4da09079e83789d6cfe3658fcf1f266f5cf8b4,1,0,0.7273,4.7005,0.2385,3,7.45,696,0,Bug Fix,0,0,0,88,0.007672,0.4545,0,0.3306,4,2,0,0.5949,1.0122,2.67,22.85,12.25,0,0,0.2202,1,6.3273,0,0,0,0,0,"Fix ORM caching for with_for_update calls

The SQLAlchemy recommends to use populate_existing() when using
with_for_update() [0], it fixed issues with the caching of the objects.

This patch precisely fixes a bug when locking of a loadbalancer in the
batch member update API call, the load balancer might not have been
locked correctly and race conditions could have occurred (processing
simultaneously 2 requests in the workers for the same load balancer).

[0] https://docs.sqlalchemy.org/en/14/orm/query.html#sqlalchemy.orm.Query.with_for_update

Story 2010646
Task 47642

Co-Authored-By: Gaudenz Steinlin <gaudenz.steinlin@cloudscale.ch>
[SEP]
FILES CHANGED:
octavia/tests/functional/db/test_repositories.py (+24, -0)
octavia/db/repositories.py (+54, -26)
releasenotes/notes/fix-batch-member-update-race-condition-09b82e2cc3121e03.yaml (+5, -0)
",-2.428024,0.404509,1.228093,-0.259869,-0.283696,0.174541,-0.257033,0.206511,0.260523,-0.184646,0.153958,0.174516,-0.350902,-0.008424,-0.302647
openstack/charm-ceph-mon,Ic2e024371ff431888731753d29fff8538232009a,1,1,1.0,3.2958,0.0,1,22.0,499,0,Bug Fix,0,0,0,5,0.005747,1.0,0,1.0,1,1,0,1.0,0.0,1.0,43.5,15.47,1,0,0.0,0,18.4815,0,14,0,10,0,"Use a different name for the local key/value store

The operator framework and charmhelpers use the same path for the
local K/V store, which causes problems when running certain hooks
like 'pre-series-upgrade'. In order to work around this issue, this
patchset makes the charmhelpers lib use a different path, while
migrating the DB file before doing so.

Closes-Bug: #2005137
(cherry picked from commit 616c4e3367f2816774d8629396340a5b3b48f680)
[SEP]
FILES CHANGED:
src/charm.py (+26, -0)
",-1.40349,-1.243087,0.223048,-0.746875,0.271596,-0.304575,0.68328,0.019408,0.175502,0.131765,0.114599,-0.128575,0.094837,-0.071911,-0.009328
openstack/openstack-ansible,Ie5a94966e0740f41b412ddf9bd79fbc5254829e9,1,0,0.8,0.6931,1.0,1,19.75,574,0,Bug Fix,0,0,0,20,0.206186,0.0,0,0.0,2,1,0,0.9048,0.0,2.0,20.8,20.05,0,0,0.0,0,287.0,0,0,0,0,0,"Remove nova-scheduler from ironic compute container_skel

There is no need to have instances of nova-scheduler in the
ironic_compute host group. Nova scheduler will already be running
in the nova_scheduler host group and extra instances of the
scheduler bring confusion when trying to reconfigure or
debug the main nova service.

This patch removes the definition of the scheduler from the
group - for an existing deployment the nova scheduler service
any extra instances should be stopped/disabled/masked with
systemd.
[SEP]
FILES CHANGED:
inventory/env.d/ironic.yml (+0, -1)
",-1.549227,-1.182374,0.312244,0.71871,0.673811,-0.495235,0.115632,0.147908,-0.177881,-0.73203,0.238996,0.264047,-0.177366,0.165213,0.139442
openstack/kolla,I650fcbc8f773fad8116338f6fb0cf7b4f4f17b33,1,1,0.86,4.0254,0.0182,3,8.0,208,0,Bug Fix,0,0,0,50,0.048309,0.6,0,0.516,2,1,0,0.8171,0.9353,2.0,36.56,13.2,0,0,0.7636,0,3.7143,0,258,0,16,0,"Test for unsafe files in tarfile.extractall

In addition to that, mark bifrost unbuildable since it's
failing on EPEL 9 enablement.

Closes-Bug: #1990432
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+2, -0)
kolla/image/tasks.py (+10, -1)
kolla/tests/test_build.py (+42, -0)
",1.222413,-1.514916,-0.317233,-0.753606,-0.72819,-0.059362,-0.204412,0.031968,-0.228983,-0.138529,-0.022651,-0.127962,-0.054422,-0.373709,0.143468
openstack/octavia,I579c1e7bd364b3c34e9a813f99c77d30753d288b,1,0,0.7303,1.9459,0.0,1,10.17,553,0,Bug Fix,0,0,0,89,0.007686,0.0,0,0.0,4,1,0,0.5962,0.0,4.0,-0.42,15.87,0,0,0.0,0,79.0,0,0,0,0,0,"Fix create_server_group in compute noop

When using Noop+ACTIVE_STANDBY+anti_affinity, create_server_group
doesn't return a value but the caller (NovaServerGroupCreate.execute)
accesses to the id attribute of the returned value, it triggers an
AttributeError:

File ""../worker/v2/tasks/compute_tasks.py"", line 319, in execute
        ""%s"", server_group.id, loadbalancer_id)
AttributeError: 'NoneType' object has no attribute 'id'

This commit adds a fake object that is returned by the noop driver.
[SEP]
FILES CHANGED:
octavia/compute/drivers/noop_driver/driver.py (+6, -0)
",-0.810844,-0.636955,0.937434,-0.336801,-0.253131,-0.019538,0.076597,0.194635,0.440788,-0.441319,0.312021,-0.452824,-0.547381,0.439372,-0.284793
openstack/openstack-ansible,I2abe15526b630cd7c68c3b79c148525e16fa2563,1,0,0.9286,1.0986,0.5,1,9.33,220,0,CI,0,0,0,70,0.034449,0.0,0,0.0,1,1,0,0.907,0.0,1.0,52.33,9.45,0,0,0.0,0,73.3333,0,0,0,0,0,"Drop `echo` from add-compute.sh script

Due to this `echo` that has been added during script testing,
reall commands are printed to stdout instead of being executed.
[SEP]
FILES CHANGED:
scripts/add-compute.sh (+1, -1)
",0.23455,-0.595233,-0.480708,0.694514,-0.08886,0.38859,-0.315036,-0.674398,-0.228721,0.071515,-0.362694,0.016492,-0.24445,0.258498,-0.137568
openstack/openstack-ansible-openstack_hosts,Ide65a7f362ee21fa07c729d04f592bf400bdc84e,1,0,0.9296,0.6931,0.0,1,11.5,183,0,Feature,0,0,0,71,0.034907,1.0,0,0.9296,1,1,0,0.6667,0.0,1.0,44.35,9.82,0,0,0.0,0,91.5,0,0,0,0,0,"Add openstack_hosts_file tag

This tag aimed to be used when a deployer only wants to refresh records
for their /etc/hosts file.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",0.857692,-1.016415,-0.359226,0.565262,0.129035,-0.356619,0.084171,-0.259938,0.067885,-0.383825,-0.588,-0.246279,-0.383427,0.230276,-0.305059
openstack/openstack-ansible,I494caa4a4104129781159ea924f3aeae94dad9a8,1,0,0.9306,2.1972,0.0,2,9.8,512,0,Doc,0,0,0,72,0.035381,1.0,0,0.9306,3,2,0,0.9091,0.5436,2.0,-8.57,12.9,0,0,0.0,0,56.8889,0,0,0,0,0,"Add documentation on refreshing hosts file

Since Yoga release we've wrongly have dropped hosts file refresh task
This task is still required, as despite /etc/hosts now are fully provisioned
on new computes, it still does not make old ones to recognize new
ones.

[1] https://opendev.org/openstack/openstack-ansible/commit/8cd65feae26f150bf0e39020598f37478e5761f3

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/877824
[SEP]
FILES CHANGED:
scripts/add-compute.sh (+1, -0)
doc/source/admin/scale-environment.rst (+7, -0)
",-2.020989,1.306781,-0.142425,-0.612344,-0.367682,-0.372702,0.652327,0.088624,0.001253,-0.082161,-0.161177,-0.177183,0.062344,-0.174197,-0.00635
openstack/octavia,I02804b7075edac72776b0377b7b283d0c7bfd8a2,1,0,0.5,3.2581,0.12,3,16.0,232,0,Bug Fix,0,0,0,108,0.004253,0.4,0,0.2,6,2,0,0.5974,1.4987,4.0,47.83,17.65,0,0,0.32,1,8.9231,0,0,0,0,0,"Fix failover when the last listener is deleted

This patch fixes an issue when deleting the last listener from a load balancer
may trigger a failover.

Story: 2010652
Task: 47683
[SEP]
FILES CHANGED:
octavia/amphorae/backends/health_daemon/health_daemon.py (+9, -3)
releasenotes/notes/Fix-listener-delete-causing-failover-251efdb79af24c0a.yaml (+5, -0)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_daemon.py (+8, -0)
",0.40456,-1.160686,-0.729674,0.16032,-0.292183,0.931844,-0.184957,-0.673162,0.510228,-0.109537,0.491395,0.554175,0.109071,0.319177,-0.095422
openstack/octavia,Ib1e00a0b45776cfab80b9effb2690e12fea63e78,1,0,0.9333,3.2958,0.0,3,16.67,351,0,Bug Fix,0,0,0,15,0.019157,0.0,0,0.0,6,2,0,0.5987,1.1401,4.0,39.33,15.47,1,0,0.6923,1,13.0,0,0,0,0,0,"Fix octavia to accept [ipv6]:port

A host identified by an Internet Protocol literal
address, version 6 [RFC3513] or later, is
distinguished by enclosing the IP literal
within square brackets (""["" and ""]"").

This patch fixes octavia to be able parse and
use this format.

Story 2010655
Task 47687
[SEP]
FILES CHANGED:
releasenotes/notes/fix-ipv6-address-enclosed-in-brackets-c1cfc4717465ba09.yaml (+6, -0)
octavia/amphorae/backends/health_daemon/health_sender.py (+2, -0)
octavia/tests/unit/amphorae/backends/health_daemon/test_health_sender.py (+18, -0)
",-0.045949,-1.688504,-0.2309,0.000139,-0.152807,0.056955,-0.51569,0.363263,0.641902,0.556657,-0.204375,0.09695,-0.082134,0.045249,-0.519323
openstack/charms.openstack,I76abbd29ca910fe4c4d62da09e2d2dd3b5c798a6,1,1,0,3.4657,0.0645,2,17.75,495,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0,0.9932,2.5,35.11,15.55,1,0,0.4516,0,15.4688,0,18,0,20,0,"Skip version caching for subordinate charms

Caching the charm OpenStack version will cause undesired behaviors
if the charm is a subordinate. The charm local cache is firstly
populated during the charm install. If the charm is a subordinate,
the version will remain the same regardless of future OpenStack
upgrades because today, the hook that updates the cache to the new
version in only called for principal charms.

Related-bug: #1949074
[SEP]
FILES CHANGED:
unit_tests/charms_openstack/charm/test_defaults.py (+14, -0)
charms_openstack/charm/defaults.py (+15, -2)
",-0.657109,-2.005617,0.0964,0.475582,-0.194228,0.132403,0.017324,-0.079679,0.549683,0.116392,0.137523,0.253608,-0.155967,0.163661,0.235976
openstack/charm-mysql-innodb-cluster,Ic6130a450bd1cf2fe3632145686fb1304b467afc,1,0,1.0,5.7621,0.041,8,9.83,569,0,CI,0,0,0,6,0.0055,1.0,0,1.0,4,3,0,1.0,2.1972,2.25,1.84,14.78,1,0,0.306,1,1.7893,0,0,0,0,0,"Add service user password rotation feature

This patch adds the service user rotation feature, which provides two
actions:

 - list-service-usernames
 - rotate-service-user-password

 The first lists the possible usernames that can be rotated.  The
 second action rotates the service.  The patch is dependent on the
 charm-helpers change [1], and is tested via the func-test-pr.

 [1] https://github.com/juju/charm-helpers/pull/765

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1027
[SEP]
FILES CHANGED:
src/actions/rotate-service-user-password (+1, -0)
src/actions.yaml (+19, -0)
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+92, -2)
src/actions/list-service-usernames (+1, -0)
src/lib/charm/openstack/exceptions.py (+28, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+100, -0)
src/actions/actions.py (+60, -11)
src/tests/tests.yaml (+3, -0)
",-2.345431,2.218644,-0.059367,0.986432,-0.20531,-0.641713,0.346386,0.232261,0.278339,-0.166297,0.10529,0.438364,0.175848,0.296551,-0.037722
openstack/charm-ceph-osd,I16b9d724930eacca42b9410c73931caceca8cca8,1,0,1.0,6.993,0.0386,15,37.0,269,0,CI,0,0,0,6,0.006696,1.0,0,1.0,4,3,0,0.5,2.5721,2.27,-2.21,23.45,1,0,0.875,1,0.247,0,0,0,0,0,"Add support for interim Ubuntu releases

- update bundles to include UCA pocket tests
- update test configuration
- update metadata to include lunar
- update snapcraft to allow run-on for lunar
- sync charm-helpers
[SEP]
FILES CHANGED:
hooks/charmhelpers/core/unitdata.py (+6, -5)
osci.yaml (+5, -0)
tests/bundles/lunar-antelope.yaml (+238, -0)
.zuul.yaml (+2, -1)
hooks/charmhelpers/contrib/openstack/context.py (+45, -31)
hooks/charmhelpers/core/host_factory/ubuntu.py (+1, -0)
hooks/charmhelpers/fetch/ubuntu.py (+17, -3)
tests/bundles/jammy-zed.yaml (+238, -0)
tests/bundles/kinetic-zed.yaml (+238, -0)
hooks/charmhelpers/contrib/openstack/deferred_events.py (+3, -1)
hooks/charmhelpers/contrib/openstack/vaultlocker.py (+6, -1)
hooks/charmhelpers/contrib/openstack/utils.py (+1, -0)
tests/bundles/jammy-antelope.yaml (+238, -0)
charmcraft.yaml (+6, -0)
metadata.yaml (+2, -0)
",-0.132606,-0.893424,-0.605507,0.292399,0.844711,-0.745956,-0.846852,0.126771,-0.578897,-0.333145,-1.000754,0.444887,1.032967,0.234895,0.082984
openstack/charm-ceph-mon,I6b229b502dd4ee9f1d219240b86f7826abf0c25d,1,0,1.0,6.9717,0.0009,7,41.0,332,0,CI,0,0,0,7,0.003528,1.0,0,1.0,2,2,0,1.0,2.0618,1.14,-6.04,27.13,1,0,0.9915,1,0.3114,0,0,0,0,0,"Add support for interim Ubuntu releases

- update bundles to include UCA pocket tests
- update test configuration
- update metadata to include kinetic and lunar
- update snapcraft to allow run-on for kinetic and lunar

(Cherry-pick from 1a81c4416c2bef7b91aff31b019c6730ed89a7dd)
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+265, -0)
osci.yaml (+1, -0)
tests/bundles/lunar-antelope.yaml (+265, -0)
.zuul.yaml (+1, -0)
tests/bundles/jammy-antelope.yaml (+263, -0)
charmcraft.yaml (+6, -1)
tests/bundles/jammy-zed.yaml (+263, -0)
",-1.374368,-0.990508,-1.430298,-0.979969,1.213389,-0.409445,-0.015723,-0.012455,-0.415189,0.336633,-0.56651,0.015466,1.115155,0.21645,-0.088634
openstack/charm-nova-cloud-controller,I8649ba727a75c8dcb86404ed4c3def12e0fdda01,1,1,0.7692,2.3979,0.5,1,3.12,249,0,Bug Fix,1,0,0,13,0.018625,0.0,0,0.0,1,1,0,0,0.0,1.0,31.08,10.85,1,0,1.0,0,22.6364,0,8,0,35,0,"Fix unittest

- Replace "".has_calls(...)"" with "".assert_has_calls(...)""
- Use ""self.Client()"" instead of ""self.Client"", because otherwise the
  wrong mock object is tested.

Related-Bug: #2012108
[SEP]
FILES CHANGED:
unit_tests/test_actions.py (+5, -5)
",-0.186125,-0.410579,-0.788793,-0.28543,-0.055079,0.328083,-1.30433,-0.51382,-0.235682,-0.173682,-0.17073,-0.66088,0.042571,0.553866,-0.026119
openstack/charm-rabbitmq-server,Ia94ab3d54cd8a59e9ba5005b88d3ec1ff87019b1,1,0,1.0,6.2344,0.0059,10,12.0,456,0,CI,0,0,0,7,0.004972,1.0,0,1.0,1,3,0,1.0,2.6987,0.9,-8.03,15.63,1,0,0.5874,1,0.8941,0,0,0,0,0,"Add service user password rotation feature

This patch adds the service user rotation feature, which provides two
actions:

 - list-service-usernames
 - rotate-service-user-password

The first lists the possible usernames that can be rotated.  The
second action rotates the service, and is tested via the func-test-pr.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1029
[SEP]
FILES CHANGED:
tests/tests.yaml (+1, -0)
unit_tests/test_rabbitmq_server_relations.py (+113, -0)
actions/actions.py (+42, -0)
unit_tests/test_rabbit_utils.py (+83, -0)
actions/list-service-usernames (+1, -0)
unit_tests/test_actions.py (+102, -0)
hooks/rabbitmq_server_relations.py (+73, -1)
actions/rotate-service-user-password (+1, -0)
hooks/rabbit_utils.py (+73, -2)
actions.yaml (+17, -0)
",-1.753122,1.151287,-0.519028,0.941254,-0.132905,-0.897152,0.234012,0.22749,0.492601,-0.265962,0.018984,0.33244,0.470644,0.7176,0.139502
openstack/charm-ceph-mon,I8d0a82e979d3a9486191b0809dda139823a827d0,0,0,1.0,1.0986,0.5,1,13.67,293,0,Bug Fix,0,0,0,8,0.002624,1.0,0,1.0,1,1,0,1.0,0.0,1.0,46.46,12.3,0,0,0.0,0,97.6667,0,0,0,0,0,"Fix mis-called function

In the rewrite from classic to operator, this function
was moved from a charmhelpers function to an apt lib
function and the signature should hve changed but did
not. This aligns with the correct method signature.
[SEP]
FILES CHANGED:
src/charm.py (+1, -1)
",0.800271,-2.3303,0.124179,0.037585,-0.695256,0.039179,0.354693,-0.409378,-0.222491,0.037659,-0.133905,0.214837,-0.527084,0.169969,0.196598
openstack/charm-mysql-innodb-cluster,Ifb5b48280430030eb39995ff884de53cd81ecdae,1,0,1.0,3.3673,0.0357,2,29.0,365,0,Bug Fix,0,0,0,8,0.004173,1.0,0,1.0,4,1,0,1.0,0.9852,2.5,47.58,16.43,1,0,0.5714,0,12.5862,0,0,0,0,0,"Fix bug in create_user where the local mysql may not be availble

The create_user function is supposed to return False if it can't create
the user, but it throws an error if it can't connect to the local mysql
instance; in this case, capture the error and return False; the next
hook will retry the connection.
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+16, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+11, -1)
",-0.000958,-1.107242,-0.308177,1.103664,-0.539869,0.21519,1.016776,-1.064714,0.079007,0.125922,0.565562,0.081516,-0.056025,0.188231,0.146265
openstack/kolla,If0f9b4dd058a257d0653332d1b663e150c717304,1,1,0.8333,4.3175,0.0135,2,9.0,547,0,Bug Fix,0,0,0,18,0.0299,1.0,0,0.8333,2,1,0,0.8182,0.1793,2.0,33.87,13.12,1,0,0.973,0,7.2933,0,258,0,16,0,"Fix test malicious tarball fail

Since I650fcbc8f773fad8116338f6fb0cf7b4f4f17b33 builds from git fails
on plugins with an exception: 'tarfile.ReadError: not a gzip file'
because the test checks only gzip compressed archives but plugins
created as plain tar files. This change fixes the issue using
transparent compression support and also adds some debug info.

Closes-Bug: #1990432
Co-Authored-by: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
kolla/image/tasks.py (+1, -1)
kolla/tests/test_build.py (+72, -0)
",-1.553055,-0.58738,-0.30928,-1.009835,0.046223,-0.054672,0.181198,0.026779,0.18485,0.119743,0.451669,0.08038,0.146532,-0.047809,-0.157746
openstack/charm-keystone,I37ed94d5937a9abf46fd12cd6f230ddb5a298b0e,1,0,1.0,2.7081,0.0714,1,22.5,316,0,Feature,0,0,0,9,0.004627,0.0,0,0.0,1,1,0,1.0,0.0,1.0,43.0,16.11,1,0,0.0,0,21.0667,0,0,0,0,0,"Restart keystone's apache2 if mysql passwd rotated

When the mysql password is changed via the shared-db relation, the
shared-db hook handler needs to restart keystone's apache2 so that the
password is picked up and used by keystone during the rest of the hook.
[SEP]
FILES CHANGED:
hooks/keystone_hooks.py (+13, -1)
",-0.439037,-0.370016,-0.600479,1.222327,0.521161,-0.130905,0.483263,-0.514571,-0.229485,-0.530475,0.339045,0.446692,-0.184245,0.063103,0.139035
openstack/openstack-ansible,I82275f208b6674ac9b528d01b738748965bfe46e,1,0,0.9315,4.5539,0.5,1,14.5,238,0,Feature,0,0,0,73,0.035732,1.0,0,0.9315,1,1,0,0.9111,0.0,1.0,37.5,16.83,0,0,0.0,0,2.5053,0,0,0,0,0,"Drop `else` condition in the container_skel_load loop

This cycle does contain `break` statement, thus there is no reason
to have `for/else` statement since `else` is always executed.
[SEP]
FILES CHANGED:
osa_toolkit/generate.py (+47, -47)
",0.71593,-0.850574,-0.263742,0.13451,0.106099,0.345983,0.259424,-0.921506,-0.10156,-0.427341,0.116393,-0.094718,-0.464802,0.015218,-0.371273
openstack/octavia,I59f1ed85383c078f505c654b1acf3e2a22d11faa,1,0,0.7333,2.5649,0.3333,3,6.0,88,0,Bug Fix,0,0,0,90,0.007769,0.5,0,0.3667,4,2,0,0.6,1.5546,2.67,-67.15,29.07,1,0,0.3333,1,6.7692,0,0,0,0,0,"Fix octavia-status with amphorav2
[SEP]
FILES CHANGED:
octavia/cmd/status.py (+1, -2)
octavia/tests/unit/cmd/test_status.py (+2, -2)
releasenotes/notes/fix-octavia-status-amphorav2-038fe77a2189b99f.yaml (+5, -0)
",2.304881,1.690739,0.404021,-0.170406,0.861339,-0.599499,0.486188,0.167574,-0.317186,-0.627654,0.422361,0.224588,-0.209663,-0.342637,0.579604
openstack/octavia,Ia8c35071f54e6988d9b2ff682a529bd477b93b74,0,0,0.6471,3.9703,0.1346,2,5.67,479,0,CI,1,0,0,17,0.002975,0.3913,0,0.2532,1,1,0,0.6013,0.5159,1.0,30.22,10.11,0,0,1.0,1,9.0377,0,0,0,0,0,"Add octavia-grenade-slurp CI job

Added new job according to [1] to test the new SLURP (a.k.a tick-tock)
upgrade strategy.

Compared to the original patch modifications to the job vars were
necessary because devstack's default is ML2/OVS in yoga
and ML2/OVN in 2023.1.

[1] https://lists.openstack.org/pipermail/openstack-discuss/2022-September/030654.html
(cherry picked from commit 5eb234b827fc630cbb19c432513601d3971cff34)
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+4, -2)
zuul.d/jobs.yaml (+41, -5)
",-1.595141,0.816294,0.134595,-0.910005,-0.168505,-0.173878,0.793829,0.381295,0.012333,0.141428,0.413087,0.156328,-0.140945,0.027736,-0.271344
openstack/charm-ceilometer-agent,I45bf4ef2d0fc1323132804c7a89cc42a768d18a8,1,0,1.0,5.79,1.0,2,42.0,357,0,CI,1,0,0,14,0.022082,1.0,0,1.0,2,1,0,0,0.0539,1.5,-23.12,30.13,1,0,1.0,1,1.0917,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -324)
tests/tests.yaml (+0, -2)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-cinder,Ieacd818299773e3ffee55ab3f7f052e2f57dd74a,1,0,1.0,5.5759,1.0,2,42.0,357,0,CI,1,0,0,15,0.015625,1.0,0,1.0,2,1,0,1.0,0.0645,1.5,-25.14,30.13,1,0,1.0,1,1.3523,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -261)
tests/tests.yaml (+0, -2)
",-0.84533,-0.285893,-0.45153,0.484904,0.626768,-0.798915,-0.153844,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332627
openstack/charm-cinder-ceph,Id4b79992d0a5220fa8013da03656e6b676d27967,1,0,1.0,6.4232,0.9967,4,42.0,357,0,CI,0,0,0,16,0.013083,1.0,0,1.0,2,1,0,0,1.1907,1.25,-23.12,30.13,1,0,0.9756,1,0.5795,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -293)
tests/tests.yaml (+0, -4)
osci.yaml (+2, -13)
tests/bundles/kinetic-zed-ec.yaml (+0, -303)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-designate,I3f9c253a89906b8f1dde4f60f1fdc30119a8d31c,1,0,1.0,4.9558,1.0,2,42.0,357,0,CI,1,0,0,17,0.009249,1.0,0,1.0,3,1,0,1.0,0.1074,2.5,-21.11,30.13,1,0,1.0,1,2.5141,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -139)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-glance,I9d44ab27409530e4690121e6ab7e3fdfeeda3071,1,0,1.0,5.2983,0.9698,5,51.0,419,0,Bug Fix,0,0,0,18,0.009096,1.0,0,1.0,4,3,0,1.0,0.384,2.6,-30.72,32.95,1,0,0.9598,1,2.095,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Sync charm-helpers to pick up fix for os_requires_version()
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/deferred_events.py (+3, -1)
tests/bundles/kinetic-zed.yaml (+0, -189)
tests/tests.yaml (+0, -2)
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+2, -0)
",-0.894741,-0.709675,-0.080538,0.172843,0.428063,-0.933847,0.061344,0.236253,-0.635504,-0.363106,0.137121,-0.098627,0.73431,-0.081869,0.377904
openstack/charm-glance-simplestreams-sync,I37c5aff2d71eae71015d1a1986fb73f64b864a94,1,0,1.0,4.92,1.0,2,42.0,357,0,CI,1,0,0,19,0.008724,1.0,0,1.0,2,1,0,1.0,0.1106,1.5,-23.12,30.13,1,0,1.0,1,2.6058,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -134)
tests/tests.yaml (+0, -2)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-gnocchi,I463ac3b04112941489a5211f75e8e24db0aa82e0,1,0,1.0,5.1874,0.9775,4,42.0,357,0,CI,0,0,0,20,0.008643,1.0,0,1.0,3,1,0,0,0.7492,2.0,-27.15,30.13,1,0,0.9326,1,1.9944,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
osci.yaml (+1, -11)
src/tests/bundles/jammy-antelope-s3.yaml (+3, -7)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -154)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-heat,I4e2f6e5d763b6fe216082b063d5dcc12e1aa3f62,1,0,1.0,5.4931,1.0,2,42.0,357,0,CI,1,0,0,21,0.008427,1.0,0,1.0,2,1,0,0,0.0691,1.5,-25.14,30.13,1,0,1.0,1,1.4691,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -240)
tests/tests.yaml (+0, -2)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-ironic-api,I25762c5e6b0ca4447d5f5b50ea77b8ff2048454f,1,0,1.0,5.7714,0.9938,3,29.5,456,0,Bug Fix,0,0,0,22,0.008047,1.0,0,1.0,3,1,0,0,0.1094,1.67,6.26,22.65,1,0,0.9938,1,1.4206,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -316)
",-0.81926,-0.860143,0.041876,0.112622,0.267949,-0.902802,0.18178,0.353284,-0.565521,-0.144367,0.157207,0.062209,0.68037,0.022612,0.275501
openstack/charm-keystone-saml-mellon,Ib27d8d5cd14493a619c784a348cf14e424992053,1,0,1.0,5.9965,0.995,4,15.0,558,0,Bug Fix,0,0,0,23,0.007531,1.0,0,1.0,4,2,0,0,0.1157,2.25,30.31,16.13,1,0,0.995,1,1.3881,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
* Add pkg-config to the charmcraft.yaml for builds. This
  is required by rust to build cryptography.
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/bundles/overlays/kinetic-zed.yaml.j2 (+0, -1)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -396)
",-1.109298,-0.70142,0.554143,0.000531,0.257648,-0.884309,0.266236,0.363095,-0.518638,-0.122112,0.207465,-0.015721,0.432174,0.033758,0.185617
openstack/charm-magnum,Id8e23d885d2bed9a7ace4b6e71fad890fce5b425,1,0,1.0,5.8551,0.9943,3,29.5,456,0,Bug Fix,0,0,0,24,0.006946,1.0,0,1.0,3,1,0,0,0.102,1.67,-0.91,22.65,1,0,0.9943,1,1.3066,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -344)
",-0.81926,-0.860143,0.041876,0.112622,0.267949,-0.902802,0.181779,0.353284,-0.565521,-0.144367,0.157207,0.062209,0.68037,0.022612,0.275501
openstack/charm-manila,I57df3d1f01049a9b4b12c970cf83abffb7b4ed64,1,0,1.0,5.8636,1.0,2,42.0,357,0,CI,1,0,0,25,0.006574,1.0,0,1.0,3,1,0,0,0.0507,2.5,-21.11,30.13,1,0,1.0,1,1.0142,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -349)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-manila-ganesha,I0236382ca3078c0434ad67fc33ba759baf066c93,1,0,1.0,5.8348,1.0,2,42.0,357,0,CI,1,0,0,26,0.006259,1.0,0,1.0,3,1,0,0,0.0519,2.5,-23.12,30.13,1,0,1.0,1,1.0439,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -339)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-manila-generic,I102ee0648ffbbed87df5b3de6cb964ee6fb90744,1,0,1.0,4.6052,0.9798,3,29.5,456,0,Bug Fix,0,0,0,27,0.006007,1.0,0,1.0,3,1,0,0,0.2845,1.67,4.82,22.65,1,0,0.9798,1,4.56,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -95)
",-0.819259,-0.860142,0.041877,0.112621,0.267949,-0.902802,0.181779,0.353284,-0.565521,-0.144367,0.157206,0.06221,0.68037,0.022612,0.275501
openstack/charm-masakari,If0beacfe04b08ea7460dd241d2247f2afa002652,1,0,1.0,6.0426,0.9952,3,29.5,456,0,Bug Fix,0,0,0,28,0.006095,1.0,0,1.0,3,1,0,1.0,0.0871,1.67,3.39,22.65,1,0,0.9952,1,1.0831,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -416)
",-0.819259,-0.860142,0.041877,0.112621,0.267949,-0.902802,0.181779,0.353284,-0.565521,-0.144367,0.157206,0.06221,0.68037,0.022612,0.275501
openstack/charm-neutron-api-plugin-ironic,Iaee9a3792f5ba1b39b1ea030938c84d107d7d227,1,0,1.0,5.7652,0.9937,7,24.0,537,0,Bug Fix,0,0,0,29,0.005784,1.0,0,1.0,4,2,0,0.0,0.2018,3.0,15.63,20.16,1,0,0.9937,1,1.6834,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
* Use local charm overlay for HA config instead of manually
  managing symlinks.
[SEP]
FILES CHANGED:
src/tests/bundles/overlays/local-charm-overlay.yaml.j2 (+0, -0)
charmcraft.yaml (+2, -0)
src/tests/bundles/overlays/jammy-zed.yaml.j2 (+0, -1)
src/tests/bundles/overlays/jammy-yoga.yaml.j2 (+0, -1)
src/tests/bundles/overlays/kinetic-zed.yaml.j2 (+0, -1)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -311)
",-1.074309,-1.111724,0.367242,-0.016843,0.230353,-0.969055,0.107999,0.425136,-0.55604,-0.119883,0.105142,-0.049246,0.663503,0.009983,0.156712
openstack/charm-neutron-gateway,I73f8f0d538701779ad570bc7565982a6b7e4f7af,1,0,1.0,5.6699,1.0,2,42.0,357,0,CI,1,0,0,30,0.005626,1.0,0,1.0,2,1,0,0.5,0.0596,1.5,-23.12,30.13,1,0,1.0,1,1.231,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -287)
tests/tests.yaml (+0, -2)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-neutron-openvswitch,I0d5d1e365cd5908a8d18f7f915474457d9f72025,1,0,1.0,5.4161,1.0,2,42.0,357,0,CI,1,0,0,31,0.005515,1.0,0,1.0,2,1,0,1.0,0.0736,1.5,-19.09,30.13,1,0,1.0,1,1.5867,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -222)
tests/tests.yaml (+0, -2)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-nova-cell-controller,I83b97c35b6e64050feaa94a2eee2b80fa49c2555,1,0,1.0,5.7526,0.9936,3,29.5,456,0,Bug Fix,0,0,0,32,0.005475,1.0,0,1.0,3,1,0,0,0.1112,1.67,3.39,22.65,1,0,0.9936,1,1.4476,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -310)
",-0.81926,-0.860143,0.041876,0.112622,0.267949,-0.902802,0.18178,0.353284,-0.565521,-0.144367,0.157207,0.062209,0.68037,0.022612,0.275501
openstack/charm-nova-cloud-controller,I367b12d6919747d987f30020575a467f1c473fef,1,0,1.0,5.5607,1.0,2,42.0,357,0,CI,1,0,0,33,0.005358,1.0,0,1.0,2,1,0,1.0,0.0653,1.5,-19.09,30.13,1,0,1.0,1,1.3731,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -257)
tests/tests.yaml (+0, -2)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-nova-compute-nvidia-vgpu,Ic3d462816f2a189e35406aa2fab6153ed8bb2e1d,1,0,1.0,5.4931,1.0,5,17.33,502,0,CI,1,0,0,34,0.005298,1.0,0,1.0,2,1,0,0,0.4317,1.8,-17.38,20.78,1,0,1.0,1,2.0658,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Drop source key for rabbitmq-server and mysql-innodb-cluster

Depends-On: https://review.opendev.org/c/openstack/charm-rabbitmq-server/+/880234
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -228)
tests/tests.yaml (+0, -2)
tests/bundles/lunar-antelope.yaml (+0, -4)
tests/bundles/jammy-antelope.yaml (+0, -4)
tests/bundles/jammy-zed.yaml (+0, -4)
",-1.80713,0.966251,0.015327,-0.184366,0.123863,-0.999404,0.075973,0.369554,-0.524794,-0.6598,0.14989,0.25313,0.485576,-0.044213,0.188888
openstack/charm-octavia,If0d46c9efe32c533fa79b5c52447f00ed3887a51,1,0,1.0,6.2086,0.996,4,42.0,357,0,CI,0,0,0,35,0.005255,1.0,0,1.0,3,1,0,1.0,1.29,2.0,-25.14,30.13,1,0,0.9516,1,0.7183,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
src/tests/bundles/kinetic-zed-ha-ovn.yaml (+0, -237)
osci.yaml (+2, -22)
src/tests/bundles/kinetic-zed-ha.yaml (+0, -231)
src/tests/tests.yaml (+0, -4)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-octavia-dashboard,I6e549bd4611517f363d7df905e3af0ccdf0727ba,1,0,1.0,4.9972,1.0,2,42.0,357,0,CI,1,0,0,36,0.005031,1.0,0,1.0,3,1,0,0,0.1038,2.5,-23.12,30.13,1,0,1.0,1,2.4122,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -145)
",-0.845329,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/charm-octavia-diskimage-retrofit,Icdba21a8865f3cdfd977d08a94386050b6c5a8c4,1,0,1.0,4.9053,0.9851,3,12.5,559,0,Bug Fix,0,0,0,37,0.005066,1.0,0,1.0,3,1,0,0,0.2235,1.67,31.72,15.13,1,0,0.9851,1,4.1407,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython.
* Add pkg-config to the charmcraft.yaml for builds. This
  is required by rust to build cryptography.
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -130)
",-1.055768,-0.651889,0.556552,0.023262,0.220621,-0.843797,0.336826,0.348885,-0.487798,-0.127087,0.242484,-0.010189,0.413839,0.038709,0.161514
openstack/charm-placement,I90a8235e29b42d6cd445ead387ae531988b578e6,1,0,1.0,5.5607,0.9923,3,29.5,456,0,Bug Fix,0,0,0,38,0.00511,1.0,0,1.0,3,1,0,0,0.1305,1.67,3.39,22.65,1,0,0.9923,1,1.7538,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
* Add libpython3-dev to allow the charm to be built. This
  fixes a missing dependency with Cython
[SEP]
FILES CHANGED:
charmcraft.yaml (+2, -0)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/kinetic-zed.yaml (+0, -255)
",-0.819259,-0.860142,0.041877,0.112621,0.267949,-0.902802,0.181779,0.353284,-0.565521,-0.144367,0.157206,0.06221,0.68037,0.022612,0.275501
openstack/charm-nova-compute,Ic290801451f6537e25dfb0330a81598bbafa7135,1,0,1.0,5.7526,1.0,2,42.0,357,0,CI,1,0,0,39,0.005068,1.0,0,1.0,2,1,0,1.0,0.0556,1.5,-23.12,30.13,1,0,1.0,1,1.1333,0,0,0,0,0,"Enable jammy-antelope voting and drop kinetic-zed tests

* Voting was turned on for jammy-antelope in the
  project-template for charm-functional-jobs in zosci-config
* Voting for jammy-antelope bundles with non-standard names
  is turned on in individual charms
* Kinetic-zed bundles/tests are removed
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -312)
tests/tests.yaml (+0, -2)
",-0.84533,-0.285893,-0.451529,0.484903,0.626768,-0.798915,-0.153843,0.107669,-0.748298,-0.397165,0.017665,0.234441,0.82752,0.011394,0.332626
openstack/openstack-ansible-ceph_client,I2bef98a695517c038cb9f0dcd09caa16611520b7,1,1,0.9324,3.4012,0.0,1,13.5,203,0,Bug Fix,0,0,0,74,0.034628,0.0,0,0.0,2,1,0,1.0,0.0,2.0,52.13,14.29,1,0,0.0,0,6.7667,0,6,0,28,0,"Add EPEL GPG key for RHEL 9

We've missed adding a GPG key that's required for installing
packages for RHEL9 distros from EPEL.

Closes-Bug: #2013276
[SEP]
FILES CHANGED:
files/gpg/RPM-GPG-KEY-EPEL-9 (+29, -0)
",1.23809,-0.463975,-0.57373,-0.0127,0.147868,0.624634,-0.385944,0.306983,-0.720105,-0.170072,0.11518,0.122807,0.355814,-0.222434,0.428153
openstack/openstack-ansible-ceph_client,Id2cd34bf88efbda9ba37710d1052a6f54249b5bf,1,1,0.9333,1.0986,0.5,1,12.0,259,0,Bug Fix,0,0,0,75,0.034626,0.0,0,0.0,1,1,0,1.0,0.0,1.0,46.61,13.69,1,0,0.0,0,86.3333,0,6,0,28,0,"Add thrift to includepkgs from EPEL

Latest ceph releases also require thrift package to be installed,
which is provided by EPEL. We add the package of allowed ones
to come from EPEL.

Closes-Bug: #2013276
[SEP]
FILES CHANGED:
tasks/ceph_preinstall_dnf.yml (+1, -1)
",0.572334,-1.274232,-0.484377,0.187359,-0.111301,-0.133624,-0.292206,0.204767,-0.384746,-0.035886,-0.207091,0.187179,0.114434,0.130941,0.001418
openstack/openstack-ansible-ceph_client,I407256dc6eee3365c4f8c191a1f50717f0b35fa8,0,1,0.9342,4.852,0.8661,6,25.0,520,0,Bug Fix,0,0,0,76,0.035055,1.0,0,0.9342,2,2,0,1.0,2.2959,1.5,35.95,17.47,1,0,0.0,0,4.0625,0,6,0,28,0,"Unify EPEL gpg key and repo provisioning

At the moment we do install EPEL repo in multiple other roles, like
lxc_hosts or systemd_mount. We're trying to be consistent in ways
of adding them, while ceph_client was slightly different, by carrying on
GPG keys in-repo instead of fetching them from `centos_epel_key` url.

With this patch we unify approach with other roles and reducing
maintenance costs of the repo when adding new distributions

Related-Bug: #2013276
[SEP]
FILES CHANGED:
vars/redhat.yml (+0, -5)
files/gpg/RPM-GPG-KEY-EPEL-9 (+0, -29)
defaults/main.yml (+4, -0)
files/gpg/RPM-GPG-KEY-EPEL-8 (+0, -28)
tasks/ceph_preinstall_dnf.yml (+13, -19)
files/gpg/RPM-GPG-KEY-EPEL-7 (+0, -29)
",-0.752081,-1.958458,0.580251,0.199705,-0.073468,-0.48001,0.221006,0.521106,-0.197974,-0.247576,-0.021194,-0.206155,-0.102747,-0.319982,0.00137
openstack/charm-ceph-osd,Ia6bf7a5b7abddb72c3ec61fd9e02daf42e94c2da,1,1,1.0,2.1972,0.25,1,16.5,381,0,Bug Fix,0,0,0,3,0.096774,1.0,0,1.0,1,1,0,0.6667,0.0,1.0,-32.95,21.15,1,0,0.0,0,42.3333,0,38,0,20,0,"Fix pristine status

Only check configured devices instead of all system devices and don't check already processed devices when computing pristine status

Closes-Bug: #1988088
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1032
(cherry picked from commit 22dfd2cc8f9f9a1bc14bfcb827fad47a9c97ac17)
[SEP]
FILES CHANGED:
hooks/ceph_hooks.py (+6, -2)
",-1.8641,1.046537,-1.613762,-0.840967,0.500611,-0.280075,0.732724,-0.174214,0.055327,0.0549,0.097147,-0.24968,0.66546,-0.001121,0.131834
openstack/charm-mysql-innodb-cluster,Ic46da9695f414317c539f9eef17a4cf5783c455c,1,0,1.0,2.1972,0.125,1,17.0,318,0,Bug Fix,0,0,0,10,0.005105,1.0,0,1.0,4,1,0,1.0,0.0,4.0,58.53,12.29,1,0,0.0,0,35.3333,0,0,0,0,0,"Fix issues when the leader is not in the cluster

Essentially, if GR is down and the unit is the leader it spends ages in
hooks trying to essentially check databases and users and essentially
doing nothing.  Get it to run the hook quicker as it can't do anything.
[SEP]
FILES CHANGED:
src/lib/charm/openstack/mysql_innodb_cluster.py (+7, -1)
",0.842681,-2.194008,0.11981,0.339801,-0.559036,0.00039,0.803513,-0.968611,-0.527169,-0.034845,0.207226,0.067898,0.030501,0.052023,-0.020903
openstack/openstack-ansible-os_glance,I48feac2ea789782e55bd49196e631cd4df9778ce,1,1,0.9221,1.3863,0.3333,1,14.5,204,0,Bug Fix,0,0,0,77,0.033551,0.8636,0,0.7963,1,1,0,0.0,0.0,1.0,55.01,9.94,0,0,0.0,0,51.0,0,54,0,29,0,"Disable uWSGI if ceph is used as a store

At the moment there's an issue with chunking in case uwsgi is used
with ceph backend.

Related-Bug: #1916482
[SEP]
FILES CHANGED:
defaults/main.yml (+2, -1)
",0.498037,-1.123376,-0.316096,0.063473,-0.38034,0.1863,-0.443146,-0.106422,-0.129073,0.085637,-0.119506,0.178884,0.118449,-0.402811,0.485459
openstack/charm-mysql-innodb-cluster,I9badf28a22edede19302ff5115b1dee16f2b17f7,1,1,1.0,3.9318,0.04,2,18.33,376,0,Bug Fix,0,0,0,11,0.005592,1.0,0,1.0,4,1,0,1.0,0.9815,2.5,42.1,13.88,1,0,0.42,0,7.3725,0,24,0,3,0,"Fix create_user() when unit is out of cluster

When a unit is configured for the cluster but not yet joined, the
create_user() function would write to the local database.  This would
then break the cluster; instead check for this condition and delay the
user creation until the the unit is clustered.

Closes-Bug: #2015256
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+20, -1)
src/lib/charm/openstack/mysql_innodb_cluster.py (+28, -1)
",0.098278,-1.120883,-0.115194,0.475626,-0.47377,0.652161,0.459061,-0.601607,0.332697,-0.409665,0.362514,0.238311,0.107993,0.306226,0.04955
openstack/magnum,Icee8be92ea3e3121934645049b81b79be9bd046a,1,1,1.0,1.6094,0.5,2,10.67,286,0,Bug Fix,0,0,0,1,0.0625,0.0,0,0.0,4,1,0,0.8824,1.0,4.0,5.66,21.77,0,0,0.0,1,57.2,0,6,0,11,0,"Missing load balancer health monitors fix

In api and etcd load balancer templates we define if Octavia
load balancer healthchecks should be enabled. Corrected
octavia_lb_healthcheck parameter value comparison.

Closes-bug: #2015393
[SEP]
FILES CHANGED:
magnum/drivers/common/templates/lb_api.yaml (+1, -1)
magnum/drivers/common/templates/lb_etcd.yaml (+1, -1)
",-0.209509,-0.961634,-0.678994,0.236855,0.570684,-0.286065,-0.915253,0.271591,0.261668,-0.449751,-0.142148,-0.206692,0.023249,-0.138102,0.122371
openstack/openstack-ansible-rabbitmq_server,Ifac1481b459707b289a9804aa4240ebbf55f6ab7,1,0,0.9231,4.654,0.3077,4,11.2,471,0,CI,0,0,0,78,0.033943,1.0,0,0.9231,2,2,0,0.6667,1.4402,1.5,30.8,10.91,0,0,0.0,0,4.4857,0,0,0,0,0,"Switch rabbitmq repo back to packagecloud

Due to decision made during PTG, we're switching back source for
RabbitMQ to packagcloud, since cloudsmith does rotate versions
too aggressively and we can't keep up with them.
With that we're leaving erlang source to be cloudsmith, since
there're simply no other good sources for Ubuntu/Debian.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/879671
[SEP]
FILES CHANGED:
vars/redhat.yml (+3, -3)
files/gpg/4D206F89 (+65, -0)
vars/debian.yml (+4, -4)
files/gpg/C072C960 (+0, -25)
",-1.001105,0.098146,-0.172328,0.106796,-0.983232,-0.175889,0.823318,-0.068157,-0.52041,0.037144,0.222461,-0.191285,0.185486,-0.329423,0.110152
openstack/octavia,Iecedb9e9c8f293cd4c067900e1696f5050769ee8,1,1,0.7363,4.4308,0.0361,5,18.0,368,0,Bug Fix,0,0,0,91,0.007847,0.5,0,0.3681,7,2,0,0.5994,1.9803,5.2,44.43,15.35,0,0,0.6265,1,4.381,0,6,0,18,0,"Send IP advertisements when plugging a new member subnet

When plugging a new subnet, the amphora sends a packet advertising the
IP address of the port. In case previously deallocated IP addresses are
re-used, it helps the other resources on the same L2 network to flush
the old ARP entries.

Closes-Bug: #2015572
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/plug.py (+4, -0)
releasenotes/notes/members-subnet-ip-advertisements-af2264844079ef6b.yaml (+6, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_plug.py (+14, -3)
octavia/tests/unit/amphorae/backends/agent/api_server/test_util.py (+35, -0)
octavia/amphorae/backends/agent/api_server/util.py (+21, -0)
",-0.318492,-1.882656,-0.116641,0.654316,-0.168571,0.234716,0.229432,0.238073,0.641483,-0.080756,-0.040774,0.299473,-0.013812,0.037831,-0.038009
openstack/charm-ceph-osd,I8264ad760d92da3faa384c8edca5566fc622c57d,1,1,1.0,2.3979,0.1,5,8.33,252,0,Bug Fix,0,0,0,5,0.011574,1.0,0,1.0,2,2,0,0.75,1.961,1.6,15.64,14.53,1,0,0.3,1,22.9091,0,8,0,12,0,"Tweak apparmor profile to access OSD volumes.

Plus add aa-profile-mode enforce option to the test bundles.

Closes-Bug: #1860801
(cherry picked from commit 38407abdd566b1e2cec7ab2b414e9382167cc318)
[SEP]
FILES CHANGED:
tests/bundles/focal-xena.yaml (+1, -0)
files/apparmor/usr.bin.ceph-osd (+1, -1)
tests/bundles/focal-yoga.yaml (+1, -0)
config.yaml (+5, -0)
tests/bundles/jammy-yoga.yaml (+1, -0)
",-0.0927,-0.972162,-1.761882,-1.706816,0.412155,-0.161139,0.470701,0.327614,0.38403,-0.029162,-0.197105,-0.076862,0.484657,-0.098998,-0.16881
openstack/openstack-ansible,I275f7ad0722c86a42eb6b29bed5068f4a33f0bff,1,0,0.7143,0.6931,0.0,1,8.17,567,0,Feature,1,0,0,7,0.14,0.0,0,0.0,4,1,0,0.913,0.0,4.0,-43.17,13.06,0,0,1.0,0,283.5,0,0,0,0,0,"Disable floating IP usage in magnum_cluster_templates

`is_floating_ip_enabled`(formerly `floating_ip_enabled`) is enabled
by default. When it's enabled, it's also required to define
`external_network_id`[1].

Since at the moment of Magnum provisioning we don't have any public
network created (yet), we disable usage of floating IP for the template.

[1] https://opendev.org/openstack/ansible-collections-openstack/src/commit/01e1742acf800cb5181ad6eae53d51db1801fcd9/plugins/modules/coe_cluster_template.py#L448
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_magnum.yml.j2 (+1, -0)
",-2.699662,1.653197,0.172286,-0.461465,0.574924,0.131543,-0.02871,-0.048975,0.347616,-0.302699,0.026533,0.03049,-0.579046,-0.538593,-0.395124
openstack/kolla,Ifa095a4a5a4a2476b356b082b9b57b491c9e29db,1,1,0.8421,1.9459,0.1667,1,5.0,179,0,Bug Fix,0,0,0,19,0.028107,0.0,0,0.0,3,1,0,0.8193,0.0,3.0,-29.48,20.67,1,0,0.0,0,25.5714,0,8,0,16,0,"Glance-api fails due to absent multipath tools

Closes-Bug: #2015500
[SEP]
FILES CHANGED:
docker/glance/glance-api/Dockerfile.j2 (+5, -1)
",1.301378,-0.584807,-0.490626,-0.985693,-0.559,0.448521,-0.888356,0.146669,-0.089647,-0.379558,0.446369,0.04727,0.39771,-0.31648,0.185538
openstack/charm-neutron-gateway,I3cf34dbf596c63484ada442c91aa51adab5a7fad,1,0,1.0,1.0986,0.5,1,9.0,174,0,Bug Fix,0,0,0,40,0.004994,0.0,0,0.0,1,1,0,0.6667,0.0,1.0,-18.5,19.16,0,0,0.0,0,58.0,0,0,0,0,0,"Fix comparison for Antelope wrap

Use CompareOpenStackReleases to ensure 'antelope' is greater
than 'zed', for example.
[SEP]
FILES CHANGED:
hooks/neutron_utils.py (+1, -1)
",0.614857,-0.051697,-0.325034,0.354998,0.598887,0.508242,-0.866632,-0.145347,-0.285788,-0.214668,-0.457402,0.106184,-0.33324,0.063863,-0.262158
openstack/kolla-ansible,I5ed40748439111e5986d6bf44ecb6b9fe7478dc9,0,0,0.0,5.7557,0.0,7,11.5,192,0,Feature,0,0,0,1,0.027027,0.6667,0,0.0,4,4,0,0.8081,0.6498,3.14,33.32,13.3,1,0,0.0,1,0.6076,0,0,0,0,0,"Add Pure Storage FlashBlade as Manila backend

Follow existing patterns to add support for the
Pure Storage FlashBlade NFS Manila driver.
[SEP]
FILES CHANGED:
ansible/roles/manila/defaults/main.yml (+6, -0)
doc/source/reference/storage/index.rst (+1, -0)
doc/source/reference/storage/manila-pure-guide.rst (+286, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+10, -0)
releasenotes/notes/pure-manila-flashblade-34668c3cd91ee3f0.yaml (+5, -0)
etc/kolla/globals.yml (+6, -0)
",1.859603,-0.068424,0.136192,0.870078,0.347682,0.598548,-0.038836,1.28203,0.118648,-0.466652,0.001356,0.887006,0.151141,-0.473407,-0.177216
openstack/openstack-ansible-os_masakari,Ife81410d59e8a646aab741bc1a5ef01784bf13b0,1,1,0.9241,2.3026,0.8889,2,12.5,230,0,Bug Fix,0,0,0,79,0.032889,0.0,0,0.0,1,1,0,0,0.9911,1.0,-15.66,22.6,0,0,0.4444,0,23.0,0,6,0,37,0,"Drop apt_package_pinning from role requirements

We don't pin packages in masakari role, so dependency on
apt_package_pinning role can be safely removed.

Related-Bug: #1979145
[SEP]
FILES CHANGED:
tests/ansible-role-requirements.yml (+0, -4)
meta/main.yml (+1, -4)
",0.529203,0.406253,-0.946547,0.670412,0.284064,0.266569,-0.25453,-0.346223,-0.281331,-0.433077,0.506174,-0.113926,-0.071933,-0.045302,0.177409
openstack/openstack-ansible,Ibb9dc3377a4de06af25281bf777b16faad16d261,1,1,0.925,1.9459,0.0,1,12.75,440,0,Bug Fix,0,0,0,80,0.033181,1.0,0,0.925,1,1,0,0.9149,0.0,1.0,14.74,15.3,0,0,0.0,0,62.8571,0,6,0,37,0,"Gather generic masakari facts

With commit [1] we moved extra facts gathering to pre_tasks
but with that we did not enable generic facts gathering, which
led to regression. So we cover this by ensuring that generic
facts are also gathered and not only extra ones.

[1] https://opendev.org/openstack/openstack-ansible/commit/8bc9b167ab9a4854aab5d49a10709c27e96ff833
Closes-Bug: #1979145
[SEP]
FILES CHANGED:
playbooks/os-masakari-install.yml (+6, -0)
",-1.455241,0.537314,-0.697221,-0.5174,0.001249,0.010987,0.868754,-0.028643,0.257511,0.473904,0.308225,-0.183541,0.30954,-0.278894,0.021408
openstack/openstack-ansible,I403e932b7b94bae4c4618df7fd36ad645356589d,1,0,0.9259,1.0986,0.5,1,10.67,255,0,Feature,0,1,0,81,0.033513,0.6667,0,0.6173,3,1,0,0.9167,0.0,3.0,32.1,14.27,0,0,0.0,0,85.0,0,0,0,0,0,"Revert using healtcheck for sahara

Sahara has healtcheck URI broken despite it's contained in api-paste.
URI claims on failed auth, which is not supposed to happen with properly
working /healthcheck.
[SEP]
FILES CHANGED:
inventory/group_vars/haproxy/haproxy.yml (+1, -1)
",0.499091,-1.325302,-0.323498,0.198557,-0.117509,-0.115479,0.021977,-0.310896,-0.652005,-0.179711,0.090678,0.090393,-0.044067,-0.5432,0.221492
openstack/charm-ceph-osd,I9a77f4a86412f9bf4d27c0d7e0a7fe34d5a403ff,1,0,1.0,0.6931,1.0,1,10.33,345,0,CI,1,0,0,4,0.102564,1.0,0,1.0,1,1,0,0.8,0.0,1.0,-5.6,14.46,1,0,1.0,1,172.5,0,0,0,0,0,"Remove relation test

The CephRelationTest class wasn't of much used and the test was
rather flaky, since it compared public IP addresses.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1034
(cherry picked from commit f1cdc830dcfeb8cda78021fd7ecdb510f20d84d8)
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -1)
",-1.234149,0.718142,-1.3734,-0.820349,0.084194,-0.303835,1.119536,0.017164,0.054662,0.15652,0.060858,-0.12038,0.225549,-0.032908,0.250279
openstack/charm-ceph-mon,Iba5aad1d895ba8b28ce364899a1e41275dc3003b,1,0,1.0,1.3863,1.0,1,10.33,345,0,CI,1,0,0,5,0.125,1.0,0,1.0,1,1,0,0.9286,0.0,1.0,-19.25,14.46,1,0,1.0,1,86.25,0,0,0,0,0,"Remove relation test

The CephRelationTest class wasn't of much used and the test was
rather flaky, since it compared public IP addresses.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1034
(cherry picked from commit f23d9e3d3eda7dda1775a3b0a600856bec42a1c4)
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -3)
",-1.201334,0.676887,-1.273246,-0.968786,-0.0409,-0.130019,1.188455,-0.072765,0.031323,0.237418,0.105466,-0.140272,0.209527,0.05127,0.16465
openstack/charm-placement,I63bfd9903057cbea2db8de4f1b612601aacb568d,1,1,0.7857,2.0794,0.1429,2,19.67,460,0,Bug Fix,0,0,0,14,0.019774,0.0,0,0.0,2,1,0,1.0,0.9852,1.5,24.84,17.36,1,0,0.5714,0,57.5,0,6,0,20,0,"Prevent update-status to run unrequired handlers

Before the update-status hook would run handlers that are expected to
run when the configuration changes or relations added/removed.

The update-status hook doesn't hold the machine lock which makes
concurrent hook executions possible and seen in the gate where for
example multiple ""apt-get"" executions trying to acquire dpkg's lock.

Closes-Bug: #2016893
[SEP]
FILES CHANGED:
unit_tests/test_placement_handlers.py (+3, -1)
src/reactive/placement_handlers.py (+3, -0)
",-0.615769,-1.345675,0.192196,0.431256,-0.2047,-0.280987,0.338173,-0.168318,0.113556,-0.021718,0.146864,-0.268654,0.423388,0.14241,0.484547
openstack/octavia,I0f2f2ff6b8c430b2dd06d707097af74bb608dcc9,0,1,0.6111,6.3733,0.0991,30,4.33,194,1,Bug Fix,0,0,1,18,0.003122,1.0,0,0.6111,7,8,0,0.6006,4.1046,3.73,-38.35,17.12,1,0,0.465,1,0.3311,0,6,0,5,0,"Add support for HTTP Strict Transport Security

Closes-Bug: #2017972
Depends-on: https://review.opendev.org/c/openstack/octavia-lib/+/880821
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+56, -0)
api-ref/source/v2/examples/listener-update-curl (+1, -1)
api-ref/source/v2/examples/listener-update-request.json (+14, -3)
octavia/db/migration/alembic_migrations/versions/632152d2d32e_add_http_strict_transport_security_.py (+42, -0)
octavia/tests/functional/api/test_root_controller.py (+3, -28)
octavia/tests/common/sample_data_models.py (+13, -1)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+10, -3)
octavia/common/validate.py (+35, -0)
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+10, -1)
requirements.txt (+1, -1)
api-ref/source/v2/examples/listener-create-response.json (+11, -2)
octavia/common/jinja/lvs/jinja_cfg.py (+4, -2)
octavia/tests/unit/common/test_validate.py (+67, -0)
octavia/tests/functional/api/v2/test_load_balancer.py (+4, -1)
api-ref/source/v2/examples/listener-update-response.json (+11, -2)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+3, -0)
octavia/tests/functional/api/v2/test_listener.py (+11, -2)
api-ref/source/v2/examples/listener-show-response.json (+11, -2)
doc/source/user/guides/basic-cookbook.rst (+7, -0)
octavia/db/models.py (+3, -0)
octavia/api/v2/types/listener.py (+15, -0)
api-ref/source/v2/examples/listener-create-request.json (+4, -1)
api-ref/source/v2/listener.inc (+18, -0)
api-ref/source/v2/examples/listener-create-curl (+1, -1)
api-ref/source/v2/examples/listeners-list-response.json (+14, -3)
octavia/common/data_models.py (+7, -1)
octavia/api/root_controller.py (+4, -1)
releasenotes/notes/add-hsts-support-91527398ba966115.yaml (+9, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+129, -0)
octavia/api/v2/controllers/listener.py (+9, -2)
",0.293928,2.648756,-1.395206,-0.594794,-1.508379,0.39802,-0.078348,0.159305,0.406659,-0.611639,-0.495621,0.098434,0.261874,-0.657701,0.395678
openstack/python-octaviaclient,I61882c844424a768d70b758e22d2aac979e3e3c6,0,1,0.5789,5.0876,0.0559,6,11.0,184,1,Bug Fix,0,0,0,19,0.002992,0.1667,0,0.0965,5,2,0,0.1837,1.6707,3.5,34.16,13.49,1,0,0.4099,1,1.1358,0,6,0,5,0,"Add support for HTTP Strict Transport Security

Changes needed in order to use new HSTS support in Octavia.

Partial-Bug: #2017972
[SEP]
FILES CHANGED:
octaviaclient/tests/unit/osc/v2/constants.py (+4, -1)
octaviaclient/tests/unit/osc/v2/test_listener.py (+56, -5)
releasenotes/notes/add-hsts-support-f612ec171e28a3b3.yaml (+7, -0)
octaviaclient/osc/v2/constants.py (+5, -1)
octaviaclient/osc/v2/listener.py (+77, -2)
octaviaclient/osc/v2/utils.py (+3, -0)
",1.192723,-0.784848,-0.54868,-0.288454,-0.803134,0.679068,-0.662882,0.859731,0.167248,0.077328,0.169558,0.532905,0.080498,-0.692711,0.243883
openstack/charm-vault,I240ebb4bd14932a6bf95f41da3f2cd7776742266,1,1,0,4.0943,0.4915,3,16.5,255,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0,1.0857,1.33,41.4,13.87,1,0,0.6949,1,4.25,0,22,0,17,0,"Improve snap channel refresh mechanism

- stop vault.service before refresing it
- added a warning note that changing the channel config option will
  cause the vault to be sealed

Related-Bug: 2007587
[SEP]
FILES CHANGED:
src/config.yaml (+3, -0)
unit_tests/test_reactive_vault_handlers.py (+19, -22)
src/reactive/vault_handlers.py (+8, -7)
",0.152888,-1.624304,-0.434866,0.106261,-0.265173,0.099025,-0.825657,-0.539149,0.349567,-0.035488,-0.123119,0.078516,0.507098,0.178087,0.113417
openstack/openstack-ansible-galera_server,Ib242e66cfb4a24b7e93144e382e50f124015e3bf,1,0,0.9268,2.3026,0.4444,2,8.43,454,0,Feature,0,0,0,82,0.033898,1.0,0,0.9268,1,1,0,0.8571,0.9911,1.0,24.78,9.47,0,0,0.0,0,45.4,0,0,0,0,0,"Define backup randomized delay in defaults

Omit can not be used in timer options, since this is simple mapping
that is passed to the unit file. With that, omit is resolved to a
randomly named omit_place_holder  that ends up in a template.

Se we define a delay to 0, which is default systemd behaviour [1]

[1] https://www.freedesktop.org/software/systemd/man/systemd.timer.html#RandomizedDelaySec=
[SEP]
FILES CHANGED:
tasks/galera_server_backups.yml (+2, -2)
defaults/main.yml (+3, -2)
",-0.895222,-0.36336,0.320426,0.299694,-0.522423,-0.088922,0.302897,-0.037617,0.455398,0.385342,0.016235,-0.428528,-0.195523,0.033528,-0.412637
openstack/kolla,I07ca5b82ecceda500e00260262c2a711c97b33bd,1,0,0.6552,2.5649,0.4167,1,9.0,105,0,Doc,0,0,0,58,0.02732,0.0,1,0.0,3,1,0,0.8204,0.0,3.0,-46.7,21.38,0,0,0.0,0,8.0769,0,0,0,0,0,"docs: we moved UNBUILDABLE_IMAGES to separate file
[SEP]
FILES CHANGED:
doc/source/contributor/adding-a-new-image.rst (+7, -5)
",0.721301,0.97006,0.075631,0.65638,1.003354,0.787046,-0.743592,-0.15118,-0.696731,0.29588,0.5949,-0.467322,-0.28327,0.006918,0.402464
openstack/kolla,Ib32baa3208e6bfc5520ff8537193c9a4d6cbada7,1,1,0.85,1.0986,0.0,1,9.33,267,0,Bug Fix,0,0,0,20,0.029326,0.0,0,0.0,2,1,0,0.8214,0.0,2.0,34.2,12.3,0,0,0.0,0,89.0,0,40,0,19,0,"https: remove dhparams.pem before running gencerts

On EL9 the file exists and script errors with wrong
permissions to it.

Closes-Bug: #2011716
(cherry picked from commit 12d431e3994023ce735a2352554a99a5cc9431c9)
[SEP]
FILES CHANGED:
docker/base/httpd_setup.sh (+2, -0)
",-0.358714,-1.15712,-1.246946,-1.747645,0.363511,0.030219,0.279376,-0.079179,0.080507,0.256729,-0.070513,-0.711263,0.394347,0.197809,-0.118613
openstack/charm-nova-cloud-controller,Ib08bf9b6e1ce2b69be4d99ffe0726b59d81f4bc9,1,1,0.8,3.5553,0.0,2,17.29,1078,0,Bug Fix,0,0,0,15,0.020979,0.0,0,0.0,1,1,0,1.0,0.3228,1.0,-9.97,18.82,1,0,0.9412,0,30.8,0,6,0,32,0,"Update nova relations data on ha-relation-changed

When taking the nova-cloud-controller from single unit to full HA by
increasing the number of units from 1 to 3 and relating it to hacluster,
the data set on the cloud-compute relation is not updated, because the
update_nova_relation() function is only called on
cloud-compute-relation-joined and config-changed, none of these hooks
are executed when scaling out the application.

This patch introduces a call to update_nova_relation() on
ha-relation-changed.

Test case on an environment deployed with a single unit of
nova-cloud-controller:

    export NOVA_CC_VIP=10.0.0.11
    juju config nova-cloud-controller vip=$NOVA_CC_VIP
    juju deploy --series jammy --channel 2.4/stable hacluster \
        nova-cloud-controller-hacluster
    juju add-unit -n 2 nova-cloud-controller
    juju deploy --series jammy memcached
    juju add-relation memcached nova-cloud-controller
    juju add-relation nova-cloud-controller nova-cloud-controller-hacluster

Closes-Bug: #2002154
[SEP]
FILES CHANGED:
unit_tests/test_nova_cc_hooks.py (+32, -0)
hooks/nova_cc_hooks.py (+2, -0)
",-4.392566,1.410876,3.512239,-0.634615,0.78359,-0.249188,-0.62778,0.0401,-0.350771,-0.752602,-0.046754,0.546878,0.136008,0.567356,0.385396
openstack/charm-ceph-radosgw,Id8bbaf1402935b88f14ecd6f736697694449e417,1,0,0.5,7.0353,0.0617,33,41.0,293,0,CI,0,0,1,4,0.020202,1.0,0,0.5,5,5,0,1.0,3.8887,2.91,0.15,26.16,1,0,0.6308,1,0.2579,0,0,0,0,0,"Add support for interim Ubuntu releases

- update bundles to include UCA pocket tests
- update test configuration
- update metadata to include kinetic and lunar
- update snapcraft to allow run-on for kinetic and lunar
- sync charm-helpers
[SEP]
FILES CHANGED:
hooks/charmhelpers/contrib/hahelpers/cluster.py (+1, -1)
osci.yaml (+64, -6)
tests/bundles/lunar-antelope.yaml (+123, -0)
tests/bundles/jammy-yoga-namespaced.yaml (+3, -3)
test-requirements.txt (+2, -2)
hooks/charmhelpers/contrib/openstack/templates/haproxy.cfg (+5, -0)
hooks/charmhelpers/contrib/openstack/ssh_migrations.py (+2, -2)
hooks/charmhelpers/contrib/openstack/context.py (+117, -32)
hooks/charmhelpers/fetch/ubuntu.py (+33, -5)
hooks/charmhelpers/contrib/openstack/deferred_events.py (+3, -1)
hooks/charmhelpers/contrib/openstack/templates/section-service-user (+11, -0)
hooks/charmhelpers/contrib/openstack/vaultlocker.py (+6, -1)
tests/bundles/focal-yoga-namespaced.yaml (+3, -3)
hooks/charmhelpers/core/host.py (+1, -1)
hooks/charmhelpers/contrib/network/ip.py (+1, -1)
hooks/charmhelpers/contrib/openstack/ip.py (+25, -0)
hooks/charmhelpers/core/unitdata.py (+6, -5)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken-mitaka (+2, -0)
hooks/charmhelpers/contrib/storage/linux/utils.py (+18, -3)
tests/bundles/lunar-antelope-multisite.yaml (+99, -0)
hooks/charmhelpers/contrib/charmsupport/nrpe.py (+16, -0)
hooks/charmhelpers/contrib/openstack/templates/section-keystone-authtoken (+2, -0)
.zuul.yaml (+1, -0)
hooks/charmhelpers/contrib/openstack/ha/utils.py (+29, -0)
hooks/charmhelpers/core/host_factory/ubuntu.py (+1, -0)
tests/tests.yaml (+8, -0)
tests/bundles/jammy-antelope-multisite.yaml (+99, -0)
hooks/charmhelpers/contrib/openstack/utils.py (+5, -4)
tests/bundles/jammy-antelope.yaml (+123, -0)
charmcraft.yaml (+6, -0)
tests/bundles/lunar-antelope-namespaced.yaml (+124, -0)
tests/bundles/jammy-antelope-namespaced.yaml (+124, -0)
metadata.yaml (+2, -0)
",0.307787,-0.624303,-0.447336,0.42527,0.921442,-0.577837,-0.402181,0.176729,-0.482971,-0.385747,-0.904814,0.432408,1.024495,0.030647,0.094369
openstack/kolla-ansible,I2d77e01637ecae0bd10319eac4bc75340dd6f61f,1,1,1.0,1.0986,0.5,1,5.57,411,0,Bug Fix,0,0,0,1,0.008333,1.0,1,1.0,4,1,0,0.8051,0.0,4.0,-7.07,11.46,1,0,0.0,0,137.0,0,12,0,15,0,"Correct glance.conf example in external Ceph guide

Under the Glance section of the external Ceph guide, to enable
copy-on-write the config heading should be ``[DEFAULT]``, rather than
``[GLOBAL]``. For reference, see the Glance docs:
https://docs.openstack.org/glance/latest/configuration/glance_api.html#DEFAULT.show_image_direct_url

Closes-Bug: #2017643
[SEP]
FILES CHANGED:
doc/source/reference/storage/external-ceph-guide.rst (+1, -1)
",-1.69623,0.969691,-0.771797,0.614358,-0.359795,0.019474,-0.010706,0.532554,0.475441,0.035409,0.045538,-0.228722,-0.145547,-0.074241,-0.231367
openstack/kolla-ansible,Ib2aabadd0ffd6a8dc2591245f29b4478e03d92fc,1,0,0.8571,3.8501,0.5,2,15.75,461,0,Bug Fix,0,0,0,21,0.030702,1.0,0,0.8571,4,1,0,0.8059,0.9321,4.0,40.45,12.65,1,0,0.0,0,9.8085,0,0,0,0,0,"Fix Bash variable expansion issues in openrc file

Sometimes passwords, URLs and other values of the variables can
contain special symbols, for example the dollar sign, using these
values can lead to unpredictable attempts of the variable expansions
in the Bash scripts, such as openrc file, so we need to use single
quotes for all variables values.
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia-openrc.sh.j2 (+8, -8)
ansible/roles/common/templates/admin-openrc.sh.j2 (+15, -15)
",-0.111615,-2.203487,0.452138,0.626114,0.183364,-0.533248,-0.027487,-0.425787,0.055913,0.37372,-0.743352,-0.37885,0.558843,-0.345135,-0.24733
openstack/ironic,I8a5221b7d8a44d73510efb9ad6a5f16d75a270f5,1,0,0,1.0986,0.5,1,9.0,98,0,Doc,0,0,0,0,0.0,0.625,0,0.0,2,1,0,0.9512,0.0,2.0,-9.1,21.38,0,0,0.0,0,32.6667,0,0,0,0,0,"Configure docs: we no longer use storyboard
[SEP]
FILES CHANGED:
doc/source/conf.py (+1, -1)
",3.924661,-0.535647,1.952142,-0.193338,-0.379772,0.170283,0.594838,-0.35866,-0.599125,-0.249748,-0.434646,-0.091518,-0.032588,-0.063793,-0.101422
openstack/openstack-ansible,Id018d7c552f9a31c9a6d89b93a07021d4e870609,1,0,0.75,1.9459,1.0,1,13.71,690,0,Bug Fix,1,0,0,8,0.156863,1.0,0,0.75,4,1,0,0.9184,0.0,4.0,41.34,10.9,0,0,1.0,0,98.5714,0,0,0,0,0,"Do not define cluster template labels

At the moment there is a bug [1] in coe_cluster_template ansible module,
that does label comparison without converting values to same type.
At the same time SDK always treat label values as strings, which leads
to module failure during comparison of labels.

Considering that magnum clusters are not created neither by os_magnum
role nor tempest tests, we don't need to define these labels.

I think it is reasonable to drop them to maintain less code and avoid
confusion due to the code that's not used anywhere.

[1] https://review.opendev.org/c/openstack/ansible-collections-openstack/+/882089
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_magnum.yml.j2 (+0, -6)
",-1.747572,-0.19467,0.857026,0.021213,-0.46008,-0.240907,0.434903,-0.372676,-0.168891,0.045827,0.074691,-0.036919,-0.07383,-0.471793,-0.346434
openstack/openstack-ansible-haproxy_server,Ibe0f13fc7308359d337fb382cb72998befb90d84,1,0,0.7778,4.3694,0.9103,5,4.86,396,0,Feature,0,0,0,9,0.157895,1.0,0,0.7778,2,4,0,0.8333,1.5951,1.4,-39.45,17.24,1,0,0.0,1,5.0127,0,0,0,0,0,"Deprecate certbot-auto

Certbot-auto is deprecated since 2020[1] and it is no longer available
under https://dl.eff.org/certbot-auto.
This change removes certbot-auto from haproxy_server role leaving
distro method as the only available option.

[1] https://community.letsencrypt.org/t/certbot-auto-deprecated-explanation-and-solutions/139821
[SEP]
FILES CHANGED:
tasks/haproxy_ssl_letsencrypt.yml (+1, -47)
templates/letsencrypt_renew_certbot_auto.j2 (+0, -13)
releasenotes/notes/certbot-auto-5ccf2184fb554c90.yaml (+5, -0)
doc/source/configure-haproxy.rst (+0, -1)
defaults/main.yml (+1, -10)
",-1.906516,2.189381,-0.764691,0.853166,-0.380966,-0.253135,0.172078,-0.034372,-0.002735,0.03093,0.240727,-0.095133,0.004275,0.062037,0.053789
openstack/kayobe,I209459ecf5b1a6e5f541cbc72d74aa7defb459d4,1,0,0.8636,3.2189,0.375,4,4.83,304,0,Bug Fix,0,0,0,22,0.030137,0.0,0,0.0,4,2,0,0.9398,1.4136,3.5,6.47,14.35,1,0,0.0,0,12.16,0,0,0,0,0,"CI: Fix kayobe-seed-images-* jobs

Followup on I0d7ab0d8ff5b16ac5de8e50e63400bd455996555.
Fix issue with 'permission denied' while doing stat files.
Also we collect kolla-build configs for CI.
[SEP]
FILES CHANGED:
roles/kayobe-diagnostics/tasks/pre.yml (+1, -0)
roles/kayobe-diagnostics/files/get_logs.sh (+5, -1)
ansible/roles/kolla-build/tasks/main.yml (+8, -7)
ansible/roles/kolla-build/defaults/main.yml (+1, -1)
",0.699399,-0.10784,-1.447448,-1.340695,0.625784,-0.227847,1.093712,-0.240468,0.075858,-0.45008,-0.164863,-0.091519,0.272144,-0.087495,-0.088246
openstack/octavia-lib,I2babd600516cfe98673627c68e97cb581ee54834,1,0,0.55,4.3567,0.013,2,12.33,288,0,Bug Fix,0,0,0,20,0.003071,0.0,0,0.0,5,1,0,0.0769,0.994,4.0,29.69,14.66,0,0,0.4545,0,3.6923,0,0,0,0,0,"Better __repr__() for data model

This greatly enhances debugability of data model objects as repr() and
objects contain now all attributes. Most subclasses implement their
own __str__() so it shows only the most relevant attributes.
[SEP]
FILES CHANGED:
octavia_lib/tests/unit/api/drivers/test_data_models.py (+35, -0)
octavia_lib/api/drivers/data_models.py (+41, -1)
",0.534191,-1.858448,0.423639,0.555461,0.297399,0.359523,-0.148615,-0.378623,0.003739,-0.062098,-1.214488,-0.3713,-0.336274,-0.490539,-0.000844
openstack/charm-ceph-mon,Ibf12a2b87736cb1d32788672fb390e027f15b936,1,1,0,2.7726,0.0,3,9.14,515,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,2,0,0.9333,1.231,1.0,44.22,10.53,1,0,0.4,1,32.1875,0,16,0,23,0,"Fix persistent config file not update bug

When ceph doing the version upgrade, it will check the previous ceph
from the `source` config variable which store in persistent file.
But the persistent file update is broken. It is because we use hookenv.Config
from ops framework, but the hookenv._run_atexit, which
save the change to file, is not been called.

Partial-Bug: #2007976
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1047
[SEP]
FILES CHANGED:
tests/tests.yaml (+1, -0)
src/charm.py (+9, -0)
unit_tests/test_charm.py (+5, -0)
",-1.659724,-0.145087,0.610182,-1.196658,-0.003469,-0.291324,0.632684,0.067192,0.021132,-0.465335,0.179932,-0.117012,-0.355807,0.163183,-0.192193
openstack/openstack-ansible,I2bfc271a52982577b94743e989a69d4a31fcd2d6,1,0,0.8,0.6931,1.0,1,6.67,606,0,Bug Fix,1,1,0,10,0.074074,1.0,0,0.8,4,1,0,0.92,0.0,4.0,-10.02,14.67,0,0,1.0,0,303.0,0,0,0,0,0,"Revert ""Add magnum tempest URL""

This reverts commit 03353d998a2cc0fe8fdac358c16e70a47f1ff029.

Reason for revert:
Hardcoded protocol is problematic because from now on, backends may be
listening on TLS.
In [1] there was an attempt to leverage
`openstack_service_internaluri_proto` variable.
Unfortunately due to issues with config_template[2] we decided to
abandon it and avoid defining magnum_url(at least for now).


[1] https://review.opendev.org/c/openstack/openstack-ansible/+/763049
[2] https://bugs.launchpad.net/openstack-ansible/+bug/1649381
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_magnum.yml.j2 (+0, -1)
",-1.963032,1.196622,0.660813,-0.891028,-0.304976,0.223382,0.669537,-0.070992,0.255715,-0.148488,0.258044,-0.051168,-0.346232,-0.385026,-0.091474
openstack/charm-ironic-conductor,I266c1fb92d531aded2f3253766de0a79accd9577,1,1,1.0,5.037,0.0065,5,6.2,492,0,Bug Fix,0,0,0,41,0.005117,1.0,0,1.0,2,2,0,0.0,1.2238,1.2,38.16,10.87,0,0,0.9739,0,3.1948,0,8,0,14,0,"Fix exception in set-temp-url-secret action

There are two issues fixed in this bug. The first is that the
keystone_session exception block does not return on failure. The
second, and the reason that create_keystone_session is failing,
is due to the use of setuptools 60.9.0+ with the
importlib-metadata in wheelhouse.txt that is pinned to <3.0.0.
For more details see: https://github.com/pypa/setuptools/issues/3452

Closes-Bug: #2018018
[SEP]
FILES CHANGED:
unit_tests/test_utils.py (+99, -0)
unit_tests/test_actions.py (+46, -0)
src/wheelhouse.txt (+2, -1)
unit_tests/__init__.py (+4, -0)
src/actions/actions.py (+1, -0)
",-1.418801,0.235183,-0.022778,0.069156,-0.695706,0.042592,0.543506,0.096421,0.168744,0.313677,0.552279,-0.107142,-0.145216,0.160701,0.378741
openstack/openstack-ansible,I9ee59c9feb76fc44cdd2e37bb54485e2788ecbbb,0,0,0.9277,1.0986,0.5,1,7.71,543,0,Bug Fix,1,0,0,83,0.034185,1.0,0,0.9277,4,1,0,0.9216,0.0,4.0,-10.93,11.23,0,0,1.0,0,181.0,0,0,0,0,0,"Ensure magnum_cluster_templates labels contain only strings

At the moment there is a bug [1] in coe_cluster_template ansible module,
that does label comparison without converting values to same type.
At the same time SDK always treat label values as strings, which leads
to module failure during comparison of labels.

[1] https://review.opendev.org/c/openstack/ansible-collections-openstack/+/882089

Needed-By: https://review.opendev.org/c/openstack/openstack-ansible-os_magnum/+/880484
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables_magnum.yml.j2 (+1, -1)
",-2.680032,2.084649,-0.077294,0.495548,-0.139406,-0.23666,0.158674,-0.157689,0.070674,0.054946,0.07506,-0.001949,0.048411,-0.395668,-0.142443
openstack/kolla-ansible,I4b50053ced9150499d1d09fd4a0ec2e243cf938b,1,1,0.8696,4.4188,0.0366,7,4.86,365,0,Bug Fix,0,0,0,23,0.030504,1.0,0,0.8696,2,3,0,0.8066,2.3779,1.71,-7.11,20.77,1,0,0.0366,1,4.3976,0,0,0,0,0,"Fix passwords.yml permissions

The kolla-genpwd, kolla-mergepwd, kolla-readpwd and kolla-writepwd
commands now creates or updates passwords.yml with correct
permissions. Also they display warning message about incorrect
permissions.

Closes-Bug: #2018338
[SEP]
FILES CHANGED:
tests/run-hashi-vault.yml (+1, -0)
kolla_ansible/cmd/mergepwd.py (+23, -1)
tests/run.yml (+2, -0)
kolla_ansible/cmd/readpwd.py (+18, -1)
kolla_ansible/cmd/genpwd.py (+18, -1)
kolla_ansible/cmd/writepwd.py (+10, -0)
releasenotes/notes/fix-passwords-yml-permissions-ca73638b71aeadf4.yaml (+7, -0)
",-1.491873,0.98336,-1.27967,1.011737,0.845682,-0.293833,-0.803843,-0.515193,-0.344307,-0.220887,0.253467,-0.02974,0.518822,0.532251,-0.010181
openstack/ironic,Ib8db915746228cd87272740825aaaea1fdf953c7,0,0,1.0,4.6151,0.08,4,25.0,776,0,Feature,0,0,0,5,0.017065,1.0,0,1.0,4,2,0,0.9518,1.7904,2.5,16.49,19.2,1,0,0.5,1,7.6832,0,0,0,0,0,"On rpc service stop, wait for node reservation release

Instead of clearing existing reservations at the beginning of
del_host, wait for the tasks holding them to go to completion. This
check continues indefinitely until the conductor process exits due to
one of:
- All reservations for this conductor are released
- CONF.graceful_shutdown_timeout has elapsed
- The process manager (systemd, kubernetes) sends SIGKILL after the
  configured graceful period

Because the default values of [DEFAULT]graceful_shutdown_timeout and
[conductor]heartbeat_timeout are the same (60s) no other conductor
will claim a node as an orphan until this conductor exits.

(cherry picked from commit 6a9e319fbeb0851c51bb14b9c4c3c5fa4685b14d)
[SEP]
FILES CHANGED:
ironic/common/rpc_service.py (+17, -1)
releasenotes/notes/graceful_shutdown_wait-9a62627714b86726.yaml (+15, -0)
ironic/conductor/base_manager.py (+14, -3)
ironic/tests/unit/common/test_rpc_service.py (+46, -4)
",-3.098388,-0.437274,1.548073,-0.745681,0.691286,0.196789,0.03439,-0.152717,0.288276,-0.011639,0.096269,0.058957,-0.180057,0.028648,-0.220507
openstack/kolla-ansible,I252ae973429be8dabf8290c9c8e9eab5156f9843,0,1,0.875,2.7081,0.0,3,4.88,368,0,Bug Fix,0,0,0,24,0.028708,1.0,0,0.875,2,2,0,0.8073,0.9464,1.33,15.33,17.33,1,0,0.2143,0,24.5333,0,256,0,26,0,"Abort on bad passwords.yml permissions

The passwords.yml file contains sensitive information so it should
have restricted permissions. This change adds an error message and
stop processing if passwords.yml is world readable/writeable.

Closes-Bug: #2018338
[SEP]
FILES CHANGED:
tests/run-hashi-vault.yml (+1, -0)
tests/run.yml (+2, -0)
kolla_ansible/cmd/genpwd.py (+11, -0)
",-0.05095,-0.616384,-0.574551,0.709781,-0.294313,0.20959,0.224093,-0.3881,0.286528,0.322843,0.251887,-0.333035,0.219,0.092496,-0.193349
openstack/kolla,Id627edcc2a42643ad3ae6184d972aca760474634,1,0,0.8627,2.0794,0.2857,1,3.33,178,0,Feature,0,0,0,51,0.046789,0.0,0,0.0,3,1,0,0.8225,0.0,3.0,-126.49,17.33,0,0,0.0,0,22.25,0,0,0,0,0,"mariadb: log bootstrap output to file

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/882344
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-server/extend_start.sh (+5, -2)
",0.582362,2.983445,-1.401017,-0.412721,-1.277488,-0.182922,0.345741,-0.209729,0.186253,-0.914274,-0.688005,0.1107,-0.042598,-0.291047,-0.009067
openstack/openstack-ansible,If3e5020c22882e95ec2649915e92de994288f13a,1,0,0.8182,1.0986,0.5,1,13.43,705,0,Feature,1,0,0,11,0.080882,1.0,0,0.8182,4,1,0,0.9038,0.0,4.0,34.81,14.73,0,0,1.0,0,235.0,0,0,0,0,0,"Add internal_lb_vip_address to no_proxy

Traffic from containers to internal VIP should not be proxied, however
it was not added to no_proxy before.

When trying to implement [1] it was noticed that this change breaks
glance uploads in proxy jobs with errors:

Error reading 13584 bytes. Content-Length: 21233664 consumed: 12831472
left: 8402192 message: Connection reset by peer
Failed to upload image data due to internal error: OSError: error during
read(65536) on wsgi.input

It can be solved by just adding internal VIP to no_proxy which looks
like a reasonable thing to do.

[1] https://review.opendev.org/c/openstack/openstack-ansible/+/881967
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables.aio.yml.j2 (+1, -1)
",-2.093452,-0.226594,1.288753,-0.560368,-0.63029,0.176462,0.104255,0.00385,0.26725,-0.194932,0.208829,-0.310452,-0.110448,-0.009429,-0.247138
openstack/openstack-ansible-os_ceilometer,I2ad3f748d18bf571dc7b82422fbcd8269cbe168e,1,1,0.9167,3.091,0.2381,3,11.67,288,0,Bug Fix,0,0,0,84,0.034568,0.8889,0,0.8148,2,3,0,1.0,1.519,1.33,16.12,17.24,0,0,0.0,1,13.0909,0,6,0,15,0,"Fix logic of defining polling_namespaces

Previous logic did excluded possibility for ceilometer-polling agent
to poll multiple namespaces at the same time. This resulted
in a wrong config for AIO metal scenario.

Closes-Bug: #2018619
[SEP]
FILES CHANGED:
releasenotes/notes/ceilometer_polling_namespaces-a21da7a655f4c922.yaml (+5, -0)
templates/ceilometer.conf.j2 (+1, -5)
vars/main.yml (+10, -0)
",0.459209,-1.434113,-0.124019,0.057103,-0.341476,0.292684,-0.332909,0.039772,0.278942,-0.317179,0.043756,0.008312,0.210884,-0.256585,0.210481
openstack/kolla-ansible,Iefbce8223806298274521c6807bf419b99f3536b,0,0,0,7.5443,0.4876,43,3.0,352,0,Doc,0,0,1,0,0.0,1.0,0,0.0,4,4,0,0.8043,4.1239,1.07,-50.01,14.53,1,0,0.6072,1,0.1862,1,0,0,0,0,"Run shellcheck on scripts

Shellcheck has way more checks than openstacks own bashate.

Comparison
- https://gist.github.com/nicerobot/53cee11ee0abbdc997661e65b348f375
- https://docs.openstack.org/bashate/latest/readme.html#currently-supported-checks
[SEP]
FILES CHANGED:
tests/check-logs.sh (+18, -15)
tests/check-config.sh (+9, -9)
tests/test-mariadb.sh (+5, -5)
tests/test-zun.sh (+22, -20)
lint-requirements.txt (+1, -0)
tests/check-failure.sh (+6, -6)
tests/setup_disks.sh (+12, -12)
tests/test-bifrost.sh (+6, -7)
tests/test-dashboard.sh (+10, -11)
tests/test-prometheus-opensearch.sh (+33, -32)
tests/deploy-bifrost.sh (+3, -4)
tests/get_logs.sh (+94, -87)
tests/link-module-utils.sh (+5, -6)
tests/test-hashicorp-vault-passwords.sh (+3, -3)
tests/test-skyline.sh (+9, -7)
tools/run-bashate.sh (+2, -2)
tests/test-magnum.sh (+49, -43)
tests/test-masakari.sh (+7, -5)
tools/pre-commit-hook (+1, -1)
tools/kolla-ansible (+206, -212)
tests/upgrade.sh (+3, -4)
tools/run-shellcheck.sh (+5, -0)
tests/test-octavia.sh (+33, -31)
tests/reconfigure.sh (+4, -5)
tests/test-swift.sh (+5, -5)
tests/deploy.sh (+22, -12)
tools/diag (+2, -2)
tests/deploy-tenks.sh (+14, -13)
tests/setup_gate.sh (+8, -6)
tests/test-scenario-nfv.sh (+12, -11)
ansible/roles/ovs-dpdk/files/ovs-dpdkctl.sh (+105, -100)
tests/test-ovn.sh (+21, -19)
tools/validate-docker-execute.sh (+1, -1)
tests/upgrade-bifrost.sh (+3, -4)
tests/test-core-openstack.sh (+129, -127)
tests/test-ironic.sh (+11, -10)
contrib/dev/vagrant/bootstrap.sh (+39, -40)
tests/init-swift.sh (+16, -17)
tools/cleanup-containers (+6, -6)
tools/validate-all-yaml.sh (+2, -2)
tox.ini (+6, -0)
tests/init-core-openstack.sh (+6, -6)
tests/test-venus.sh (+14, -13)
",-1.415997,2.054205,-1.731418,-0.374101,-0.106746,-0.281094,0.218398,-0.056105,-0.102536,0.092076,-0.828781,-0.288712,0.390325,0.135648,-0.088239
openstack/kolla,I3d10973a9857355e68007d70258e8d7b0ab36b85,1,0,0,1.0986,0.0,1,7.0,272,0,Feature,0,0,0,0,0.0,0.5,0,0.0,3,1,0,0.8235,0.0,3.0,12.4,11.37,1,0,0.0,0,90.6667,0,0,0,0,0,"Support qemu block rbd in nova-compute (source)

Corrects backport of change 860230: Support qemu block rbd in nova-compute | https://review.opendev.org/c/openstack/kolla/+/860230 to also consider source install type.
[SEP]
FILES CHANGED:
docker/nova/nova-compute/Dockerfile.j2 (+2, -0)
",-0.42742,2.19421,-1.155537,0.606874,0.088709,-0.161639,0.489562,0.141148,-0.252822,-0.334618,-0.146985,0.072472,0.318103,-0.506735,0.003198
openstack/charm-guide,Ia627c39c48b21d2807c930312a3f354a031d5d99,1,0,0,1.0986,0.5,1,16.5,268,0,Bug Fix,0,0,0,0,0.0,0.0,1,0.0,4,1,0,0,0.0,4.0,26.01,17.51,0,0,0.0,0,89.3333,0,0,0,0,0,"Correct openstack release name in upgrade example

When upgrading from ussuri to victoria, we should refresh the charm
channel to victoria/stable, not yoga/stable. This contribution
fixes this error in the example
[SEP]
FILES CHANGED:
doc/source/admin/upgrades/openstack.rst (+1, -1)
",1.461624,-1.308968,-0.008089,0.013658,-0.322902,-0.122562,0.27204,-0.032049,-0.438889,-0.262692,-0.337372,0.081789,-0.511606,0.362841,-0.102959
openstack/kolla-ansible,I2189dafca070accfd8efcd4b8cc4221c6decdc9f,1,1,1.0,3.7136,0.0,4,11.0,680,1,Bug Fix,0,0,0,1,0.043478,0.75,0,0.75,4,2,0,0.8014,1.9132,3.5,11.09,14.7,1,0,0.0,1,16.5854,0,294,0,294,0,"always add service_user section to nova.conf

As of I3629b84d3255a8fe9d8a7cea8c6131d7c40899e8 nova
now requires the service_user section to be configured
to address CVE-2023-2088. This change adds
the service user section to the nova.conf template in
the nova and nova-cell roles.

Related-Bug: #2004555
(cherry picked from commit a77ea13ef1991543df29b7eea14b1f91ef26f858)
(cherry picked from commit 03c12abbcc107bfec451f4558bc97d14facae01c)
(cherry picked from commit cb105dc293ff1cdb11ab63fa3e3bf39fd17e0ee0)
(cherry picked from commit efe6650d09441b02cf93738a94a59723d84c5b19)
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova.conf.j2 (+13, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+13, -0)
releasenotes/notes/cve-2023-2088-51e7e050be2139bf.yaml (+9, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+5, -0)
",-4.176416,0.244445,1.019623,-2.693879,1.566585,0.221885,0.789201,-0.056921,0.070391,0.113693,0.003835,0.339445,0.083647,0.12256,-0.035689
openstack/ironic,Ib258bc9650496da989fc93b759b112d279c8b217,1,1,0.9655,5.1985,0.2167,6,26.67,1024,1,Bug Fix,0,0,0,29,0.011605,0.7895,0,0.7623,4,3,0,0.9405,2.0944,2.17,33.3,18.92,0,0,0.3722,1,5.6575,0,294,0,294,0,"Fix Cinder Integration fallout from CVE-2023-2088

In the recent change to cinder, to address CVE-2023-2088,
cinder changed the policy rules and behavior for unbinding,
or ""detaching"" a volume. This was because of a vulnerability
in compute nodes where a volume which was in use by a VM
could be detached outside of Nova, and nova wouldn't become
aware the volume was detached, and the volume could be accessible
to the next VM.

This vulnerability doesn't apply to bare metal operations as
volumes are attached to whole baremetal nodes with Ironic.

We now generate and use a service token when interacting with
Cinder which allows cinder to recognize ""this request is
coming from a fellow OpenStack service"", and by-pass
checking with Nova if the ""instance"" is managed by Nova,
or Not. This allows the volumes to be attached, and detached
as needed as part of the power operation flow and overall
set of lifecycle operations.

Related-Bug: 2004555
Closes-Bug: 2019892
[SEP]
FILES CHANGED:
ironic/common/keystone.py (+21, -3)
devstack/lib/ironic (+1, -1)
ironic/common/cinder.py (+58, -13)
zuul.d/project.yaml (+2, -11)
ironic/tests/unit/common/test_cinder.py (+43, -11)
releasenotes/notes/cinder-2019892-6b5a9de5c5f05aa6.yaml (+16, -0)
",-2.684474,-1.034738,2.545515,-0.351041,-0.337527,0.135304,-0.032879,0.097245,0.067749,-0.118295,0.07438,0.459579,0.12541,0.029342,0.083481
openstack/octavia,I8ef0bbca3c344a8b43f1560bc4ceef8ddec7d9ef,1,0,0.7391,3.1355,0.0909,2,6.2,336,0,Feature,1,0,0,92,0.007877,0.375,0,0.2772,1,1,0,0.5987,0.9457,1.0,-15.05,14.09,0,0,1.0,1,14.6087,0,0,0,0,0,"Splitting scenario jobs in 2

Splitting octavia-v2-dsvm-scenario and octavia-v2-dsvm-scenario-jobboard
in 2 jobs.
It would reduce the duration of the jobs and avoid potential timeouts on
slow hosts.

Depends-On: https://review.opendev.org/c/openstack/octavia-tempest-plugin/+/882807
[SEP]
FILES CHANGED:
zuul.d/projects.yaml (+6, -2)
zuul.d/jobs.yaml (+14, -0)
",-1.464829,1.574512,-0.914136,0.365026,-0.433084,-0.566792,0.464147,0.081353,-0.030267,-0.401191,-0.113517,0.291039,0.397943,0.220543,0.20009
openstack/kolla,I2f879e59a64b9039a8a27c40bd462fde4df73f43,1,0,0.8654,1.0986,0.5,1,2.62,398,0,Feature,0,0,0,52,0.047402,0.0,0,0.0,2,1,0,0.8246,0.0,2.0,-22.25,10.46,0,0,0.0,0,132.6667,0,0,0,0,0,"toolbox: pin ansible.posix to <1.5.4

ansible.posix 1.5.4 has been released and it broke the way
we use JSON callback plugin (it requires play.path) - see [1] and [2].

[1]: https://github.com/ansible-collections/ansible.posix/commit/3bbf2e3cd56775096fc8ce69e281142472b73cac
[2]: https://github.com/ansible-collections/ansible.posix/issues/461
[SEP]
FILES CHANGED:
docker/kolla-toolbox/requirements.yml (+1, -1)
",-2.566876,3.070517,-0.834279,0.017807,0.160051,-0.184995,0.576356,-0.074452,-0.408472,0.760733,0.322993,-0.258096,0.241447,0.161402,-0.114367
openstack/kayobe,I201faf14da5d143670250052ab15fc285f24868c,1,1,0.8974,1.6094,0.5,1,36.0,297,0,Bug Fix,0,0,0,78,0.025658,0.0,0,0.0,4,1,0,0.9405,0.0,4.0,1.1,29.96,0,0,0.0,0,59.4,0,6,0,13,0,"Fix firewalld configuration for monitoring hosts

There was a stray double quote in the firewalld config for monitoring
hosts, resulting in the following error when firewalld is enabled:

  ValueError: No closing quotation

Closes-Bug: 2019867
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/monitoring/firewall (+2, -2)
",0.131291,-1.169479,-0.653646,0.261188,-0.062723,0.663727,-0.62535,-0.269843,0.373213,0.036594,0.243329,-0.214058,0.177435,-0.257181,0.217813
openstack/charm-mysql-innodb-cluster,I5df4fd5ecbdd2b7bce525a9930dcffbc5868cbb8,1,1,1.0,3.9703,0.2115,2,26.5,691,0,Bug Fix,0,0,0,12,0.005949,1.0,0,1.0,4,1,0,1.0,0.8404,2.5,37.08,17.39,1,0,0.2692,0,13.0377,0,6,0,3,0,"Wait for Group Replication to finish; 3100 before commit error

The bug is triggered, as a race, usually by the
prometheus-relation-joined hook, when it tries to create a user whilst
Group Replication is recovering during a rolling restart.  This patch
alters the create_user() method so that it detects the failure condition
and then retries for up to a minute (6 times, every 10 seconds) for the
Group Replication to recover before giving up and returning False
(indicating the the user was not created).  This will usually result in
the handler not completing during the hook, and then retrying on the
next hook.

Closes-Bug: #2018385
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+11, -3)
src/lib/charm/openstack/mysql_innodb_cluster.py (+30, -8)
",-1.281835,-1.949408,1.006557,-0.160562,-0.57311,0.229856,0.238376,-0.092141,0.291936,0.166897,0.599366,0.114114,-0.086914,0.07283,0.10056
openstack/openstack-ansible,I186e7c814c0f6f867605ffa321a616cd8a20283f,1,0,0.9176,1.3863,0.3333,1,5.5,102,0,Doc,0,0,0,85,0.03468,0.0,1,0.0,4,1,0,0.9057,0.0,4.0,39.74,16.75,0,1,0.0,0,25.5,0,0,0,0,0,"[doc] Add Ubuntu 22.04 as supported in AIO docs
[SEP]
FILES CHANGED:
doc/source/user/aio/quickstart.rst (+2, -1)
",2.358203,0.33712,0.855366,0.031378,-0.160223,0.380408,-0.299933,0.950798,-0.387456,1.231784,-0.47755,0.340296,-0.280878,-0.240029,-0.66836
openstack/kolla-ansible,I002db50cbad5a90e479498e605bdeab343e129c7,1,1,0.84,2.8332,0.3125,3,5.4,529,0,Bug Fix,0,0,0,25,0.029412,0.75,0,0.63,4,3,0,0.8022,1.4056,3.33,-2.31,14.75,1,0,0.0,1,31.1176,0,12,0,21,0,"Fix the Cyborg service

According to the documentation [1] type of the Cyborg service should
be 'accelerator' and description 'Acceleration Service'. Also, this
change fixes incorrect endpoint URLs, and not configures an admin
endpoint [2] because the documentation [1] not updated yet.

1. https://docs.openstack.org/cyborg/latest/install/common.html
2. Icf3bf08deab2c445361f0a0124d87ad8b0e4e9d9

Closes-Bug: #2020080
[SEP]
FILES CHANGED:
releasenotes/notes/fix-cyborg-service-5bc5bf8748daf504.yaml (+6, -0)
ansible/roles/cyborg/defaults/main.yml (+4, -4)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -1)
",-1.559806,0.192734,-0.344393,-0.702573,0.106857,0.083241,0.861421,0.362353,0.450243,0.542887,0.090363,-0.214493,-0.028127,0.114036,-0.356252
openstack/kolla-ansible,Iaa6c5a092b471728eec6f89d05546091aa4b17d9,1,0,0,1.9459,1.0,1,13.5,206,0,Doc,0,0,0,0,0.0,0.0,1,0.0,3,1,0,0.8029,0.0,3.0,55.27,11.33,1,0,0.0,0,29.4286,0,0,0,0,0,"docs: Remove redundant section about vagrant-vbguest

The section just after this one says the exact same thing with more details, so
we can remove it.
[SEP]
FILES CHANGED:
doc/source/contributor/vagrant-dev-env.rst (+0, -6)
",1.630387,-1.514948,-0.063995,-0.008219,-0.625752,0.299374,0.521868,-0.914249,-0.568992,-0.046082,0.102384,-0.013081,-0.488778,0.344374,-0.027971
openstack/openstack-ansible-os_nova,I81cd6431fec94f56b0ebd66c94e90c9623ba0e38,1,0,0.9186,1.3863,0.0,1,13.5,217,0,Feature,0,0,0,86,0.035045,1.0,0,0.9186,1,1,0,1.0,0.0,1.0,8.27,15.77,0,0,0.0,0,54.25,0,0,0,0,0,"Define service_user for nova services

In order to cover OSSA-2023-003, a requirement to define service_user
section for all nova services has been added by nova.
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+3, -0)
",0.022906,-0.591989,-0.635174,0.696357,0.493909,-0.075939,-0.610753,0.050836,-0.035336,0.155267,-0.364086,0.296262,-0.368729,-0.188131,0.216099
openstack/ironic-python-agent-builder,I6128fbad5d9db2ea6469f196f3ee13b6fab76837,1,0,0.8333,2.0794,0.0,2,10.25,428,0,Feature,0,0,0,6,0.015267,0.0,0,0.0,3,2,0,1.0,0.5917,3.0,-22.29,15.81,1,0,0.0,0,53.5,0,0,0,0,0,"Add checksum generation support

DIB_CHECKSUM is set by the disk-image-create --checksum flag, and for
other images results in checksum files being generated for the
image[1].

This change ensures checksum files are generated for built
ramdisk/kernel as well.

[1] https://opendev.org/openstack/diskimage-builder/src/branch/master/diskimage_builder/lib/common-functions#L68
[SEP]
FILES CHANGED:
dib/ironic-ramdisk-base/environment.d/10-checksum.bash (+1, -0)
dib/ironic-ramdisk-base/cleanup.d/99-ramdisk-create (+6, -0)
",-1.798328,1.057168,-0.271859,0.491849,-0.195719,-0.714055,-0.006441,0.438643,0.399272,0.041192,-0.271999,-0.454554,0.099544,0.032005,-0.208547
openstack/ironic,I6ae9e4442bcb473ab5ccff6e167bf61f3daa0f7e,1,0,0.9667,2.5649,0.3333,1,20.8,656,0,CI,0,0,0,30,0.011198,1.0,0,0.9667,3,1,0,0.9412,0.0,3.0,42.55,15.63,0,0,0.0,0,50.4615,0,0,0,0,0,"CI: DB: Don't return inside of node get wrappers

Previously, we did query object handlers with model_query
where we woudl then return the handler, however that was problematic
because we returned ORM objects.

Now we have selects, but the data has to be extrated to a set before
we close out the reader session with the database. Returning the
overall object means that the call seems to sometimes not completely
execute on newer python versions in unit tests, which create unit
test failures.

We now hold off the database query and operation to a variable,
exit the reader, and return the variable.
[SEP]
FILES CHANGED:
ironic/db/sqlalchemy/api.py (+8, -4)
",-0.418917,-2.647718,1.354864,-0.121094,-0.559825,-0.313256,0.616469,-0.373492,-0.319861,-0.060989,-0.030947,-0.409406,-0.050548,0.211401,-0.079223
openstack/charm-mysql-innodb-cluster,Ife6235bab82bb828c943ba1215bf938238d4b257,1,1,1.0,3.8067,0.0455,2,11.0,258,0,Bug Fix,0,0,0,13,0.006283,1.0,0,1.0,4,1,0,1.0,0.9985,2.5,41.85,9.25,1,0,0.4773,0,5.7333,0,12,0,3,0,"Improve handling of errors in update status hook

The update status hook can error during logging on cluster status. This
just prevents it from going into error during update-status.

Closes-Bug: #2015368
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_mysql_innodb_cluster.py (+21, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+21, -2)
",0.916725,-1.566878,0.032022,-0.031044,-0.439419,0.272482,-0.276916,-0.282535,0.17107,-0.090529,-0.350654,-0.053819,0.311931,-0.055996,0.3699
openstack/kolla-ansible,I6908f52f824a97a5a4a2bead92b7b2e5cdebdb9f,1,0,0.8679,2.9444,0.5,3,5.67,221,0,Feature,0,0,0,53,0.048226,0.0,0,0.0,4,1,0,0.8036,0.9864,4.0,-62.67,21.09,0,0,0.0,0,11.6316,0,0,0,0,0,"opensearch: alter path after using rpm/deb packaging

opensearch-dashboards now use a dedicated user

Depends-On: https://review.opendev.org/c/openstack/kolla/+/883941
[SEP]
FILES CHANGED:
ansible/roles/opensearch/templates/opensearch.json.j2 (+1, -1)
ansible/roles/opensearch/templates/opensearch_dashboards.yml.j2 (+1, -1)
ansible/roles/opensearch/templates/opensearch-dashboards.json.j2 (+7, -7)
",0.496881,1.704356,-0.882629,-0.289612,-0.980257,-0.276391,0.072955,-0.057363,-0.296084,-0.536572,-0.802963,-0.231403,0.070274,-0.362148,0.068028
openstack/charm-vault,I0cca13d2042d61ffc6a7c13eccb0ec8c292020c9,1,1,1.0,7.2724,0.0167,5,10.6,906,0,Bug Fix,0,0,0,2,0.111111,1.0,0,1.0,3,2,0,1.0,1.7737,1.8,14.9,14.43,0,0,0.6164,1,0.6292,0,42,0,24,0,"Implement cert cache for vault units (v4)

This cache is used to store certificates and keys
issued by the leader unit. Non-leader units read
these certificates and keep data in their
""tls-certificates"" relations up to date.
This ensures that charm units that receive certs
from vault can read from relation data of any
vault unit and receive correct data.

This patch is mostly the same as
I18aa6c9193379ea454851b6f60a8f331ef88a980
but improved to avoid LP#1896542 by removing
the section where a certificate can be reused
from cache during create_certs.

Co-Authored-By: Rodrigo Barbieri <rodrigo.barbieri@canonical.com>
Co-Authored-By: Alex Kavanagh <alex.kavanagh@canonical.com>

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1084

Closes-Bug: #1940549
Closes-Bug: #1983269
Closes-Bug: #1845961
Related-Bug: #1896542
[SEP]
FILES CHANGED:
unit_tests/test_reactive_vault_handlers.py (+243, -17)
src/lib/charm/vault_pki.py (+448, -0)
src/reactive/vault_handlers.py (+98, -6)
src/tests/tests.yaml (+1, -0)
unit_tests/test_lib_charm_vault_pki.py (+625, -1)
",-4.276504,1.842175,2.986704,-2.424233,0.720405,0.967944,-0.731137,-0.665021,-0.248208,0.012875,-0.660287,0.854647,0.1968,0.186499,-0.045075
openstack/ansible-hardening,I7c02cf6b7575a9ab753d85cdd6582f209f39be1b,1,0,0.9195,2.0794,1.0,1,8.67,212,0,Feature,0,0,0,87,0.035409,0.0,0,0.0,1,1,0,0,0.0,1.0,32.09,14.24,0,0,0.0,0,26.5,0,0,0,0,0,"Remove commandkey from chrony config

Since version 2.2 chorny has removed commandkey options and
it's not a valid option for any currently supported distro.
[SEP]
FILES CHANGED:
templates/chrony.conf.j2 (+0, -7)
",1.256968,-0.756356,-0.184982,0.688912,-0.187827,0.161742,0.815802,0.074106,-0.45916,0.295077,-0.001853,0.347188,-0.731501,-0.421965,0.225898
openstack/ironic,Id51419bc50af5a756bb7b0ca451df1936dd6f904,1,0,0.9677,3.0445,0.25,2,27.67,538,0,CI,0,0,0,31,0.01152,1.0,0,0.9677,3,2,0,0.9419,0.9928,2.5,36.05,18.78,0,0,0.0,1,25.619,0,0,0,0,0,"Explicitly use a session for DB version check

The db field value version check, which is a preflight to
major upgrades (to detect if a prior upgrade was not completed)
was using model_query, which could orphan an open transaction in
the same process until the python interpretter went and took out
the perverable trash.

We now use an explicit session which structurally ensures we close
any open transactions which allows a metadata lock to be obtained
to perform a schema update..
[SEP]
FILES CHANGED:
ironic/db/sqlalchemy/api.py (+6, -5)
releasenotes/notes/remove-model-query-from-upgrade-af227b6c8a5d654a.yaml (+9, -0)
",0.275219,-2.878901,0.820374,0.104746,-0.5132,-0.229433,1.03708,-0.223586,0.175029,0.14096,0.043642,-0.013262,0.003419,0.026587,0.366269
openstack/ansible-role-python_venv_build,If478ab0f0c0a5acc8974a69a11453377c98c28be,1,0,0.9205,2.3979,0.5,2,11.67,271,0,Feature,0,0,0,88,0.035714,0.9,0,0.8284,1,1,0,1.0,0.7219,1.0,42.71,13.81,0,0,0.0,0,24.6364,0,0,0,0,0,"Align distro_arch naming in the role

At the moment we have 2 slightly different variations of merging
distro_arch - one through `-` and another through `_`. This patch
aligns usage and re-use  _venv_build_dist_arch.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
vars/main.yml (+4, -4)
",-0.141387,-0.414963,-0.259357,0.505782,0.490163,0.154088,-0.59774,-0.448453,-0.257902,-0.28771,-0.439852,-0.176499,-0.591157,-0.17768,0.273918
openstack/kolla-ansible,I8e48b7827b33bdd2061d0e89c905bea8e29f60e8,0,0,0.8987,3.0445,0.5,3,16.25,475,0,Feature,0,0,0,79,0.025953,1.0,0,0.8987,4,2,0,0.8043,1.5813,3.33,25.05,17.58,0,0,0.0,1,22.619,0,0,0,0,0,"Apply public firewalld rules immediately

Previously, firewalld rules were applied to configuration, then
firewalld reloaded to pick up all the new rules. Reloading firewalld can
be disruptive because it sets all chains to a DROP policy while building
up its firewall rules, breaking open connections.

This change switches to applying rules both permanently (to config) and
immediately, such that no reload is required.
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/handlers/main.yml (+0, -6)
ansible/roles/haproxy-config/tasks/main.yml (+3, -4)
releasenotes/notes/firewalld-immediate-c2abf09977c455a9.yaml (+7, -0)
",-1.137255,-1.412621,0.034679,1.217442,0.284617,0.051698,0.272499,-0.126302,-0.206949,0.288531,-0.097549,0.207361,0.238645,-0.15678,0.032198
openstack/kolla,I169e51c0f5c691518ada1837990b5bdd2a3d1481,1,1,1.0,2.7081,0.2143,2,6.67,185,0,Bug Fix,0,0,0,1,0.033333,0.6,0,0.6,2,2,0,0.8256,0.9403,2.0,35.1,10.67,1,0,0.0,1,12.3333,0,6,0,18,0,"Improve kolla-toolbox offline support.

  * Use structure that allow for custom package version and base URL.

Closes-bug: #2020761
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2020761-c31f28c922ebcf84.yaml (+5, -0)
docker/kolla-toolbox/Dockerfile.j2 (+6, -3)
",1.807982,-1.069021,-0.184841,-0.549237,-0.598471,-0.107174,-0.366668,0.546495,0.192366,-0.240312,-0.332785,0.112675,0.095712,-0.155126,0.131282
openstack/kolla-ansible,I15af98faedd81cccbc10e2cc7dab4205a35684be,1,0,0.8704,0.6931,0.0,1,11.0,105,0,CI,0,0,0,54,0.048344,0.0,0,0.0,3,1,0,0.8014,0.0,3.0,18.78,15.31,0,0,0.0,0,52.5,0,0,0,0,0,"CI: cephadm - set rbd application on pool creation
[SEP]
FILES CHANGED:
roles/cephadm/templates/commands.sh.j2 (+1, -0)
",1.961876,0.284303,0.589998,-0.765011,0.651664,0.229009,-0.58996,0.025462,0.095549,-0.235514,0.337987,-0.016043,-0.12757,-0.005882,-0.257202
openstack/openstack-ansible-rabbitmq_server,I361757b8f76a6c2d087989a36d8f7543aba69e16,1,1,0,4.7622,0.6207,5,12.0,420,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,3,0,0.7143,1.7782,1.6,13.12,15.63,1,0,0.0,1,3.5897,1,12,0,24,0,"Change to CloudSmith repos from PackageCloud for RabbitMQ

Upstream has notified us[1] about the immediate deprecation and removal
of the PackageCloud repositories we are using. Thus, we must move to the
CloudSmith repos already being used for the erlang dependency for
RabbitMQ.

[1] https://github.com/rabbitmq/rabbitmq-server/discussions/8386

Closes-Bug: 2021410
[SEP]
FILES CHANGED:
vars/redhat.yml (+4, -3)
files/gpg/4D206F89 (+0, -65)
vars/debian.yml (+4, -4)
files/gpg/C072C960 (+25, -0)
releasenotes/notes/rabbitmq-switch-to-cloudsmith-instead-of-packagecloud-deprecated-5ee62da847ccae1f.yaml (+11, -0)
",-0.260655,0.43911,-0.129688,0.307206,-0.74773,-0.082666,0.74716,0.792692,-0.189604,0.090894,0.231392,-0.104848,0.028267,-0.310079,0.096326
openstack/kolla,If0161219cd463794a201644b5edd3234284da383,0,0,1.0,2.3026,0.5556,2,6.17,703,0,Bug Fix,0,0,0,1,0.008547,1.0,0,1.0,2,1,0,0.8266,0.9911,2.0,9.65,13.82,1,0,0.0,0,70.3,1,0,0,0,0,"Change from PackageCloud.io to CloudSmith mirrors for rabbitmq/erlang

Upstream has notified us[1] about the immediate deprecation and removal
of the PackageCloud repositories we are using. Thus, we must move to the
CloudSmith repos. While as of 2023-05-29, the PackageCloud mirrors are
still available, they are likely going away. Thus, it is recommended to
switch to the CloudSmith mirrors.

Additionally, use el/9 repos as they are available.

[1] https://github.com/rabbitmq/rabbitmq-server/discussions/8386

Depends-On: https://review.opendev.org/c/openstack/kolla/+/884677

Closes-Bug: https://bugs.launchpad.net/openstack-ansible/+bug/2021410
[SEP]
FILES CHANGED:
docker/base/rabbitmq_rabbitmq-server.repo (+2, -2)
docker/base/rabbitmq_rabbitmq-erlang.repo (+2, -3)
",-2.549278,1.609056,1.180908,-0.296136,-1.011731,-0.024652,0.331278,0.371163,-0.240842,-0.097629,0.019987,0.081858,-0.075217,-0.30757,0.011216
openstack/openstack-ansible,I92953a14dd311a60b169165c5a8e61dd98466033,1,0,1.0,2.5649,0.5,5,16.67,1007,0,Doc,0,0,0,3,0.214286,1.0,0,1.0,3,1,0,0.9074,2.2516,2.4,-48.65,18.27,1,0,0.0,0,77.4615,0,0,0,0,0,"Restore an ability for HAProxy to bind on interal IP

According to the docs [1], there is an ability for HAProxy to bind
specifically on IP-address, ""while preserving the names for TLS-
certificates and endpoint URIs"".

For internal endpoint this supposed to be done by setting
`internal_lb_vip_address` and `haproxy_bind_internal_lb_vip_address`
but was broken due to the fact that for:
* `haproxy_galera_service`
* `haproxy_opendaylight_neutron_service`
* `haproxy_opendaylight_websocket_service`
* `haproxy_nova_api_metadata_service`
* `haproxy_rabbitmq_service`
* `haproxy_repo_service`
`haproxy_bind` was explicitly set to `[internal_lb_vip_address]` and
overriding `haproxy_bind_internal_lb_vip_address` would result in
wrong certificate paths (with FQDN in names, which does not exist)
for these frontends.

[1] https://docs.openstack.org/openstack-ansible-haproxy_server/latest/configure-haproxy.html#overriding-the-address-haproxy-will-bind-to
[SEP]
FILES CHANGED:
inventory/group_vars/repo_all.yml (+1, -1)
inventory/group_vars/galera_all.yml (+1, -1)
inventory/group_vars/nova_all/haproxy_service.yml (+1, -1)
inventory/group_vars/neutron_all/haproxy_service.yml (+2, -2)
inventory/group_vars/rabbitmq_all.yml (+1, -1)
",-4.219241,1.996222,2.821272,-0.346088,0.861086,0.15429,-1.230641,-0.043388,0.067452,-0.889874,-0.346135,0.033763,-0.670832,-0.290774,-0.062342
openstack/openstack-ansible-rabbitmq_server,I70c13f7f882ce8666b12314a31f76fe63599677c,1,0,0.5,3.1781,0.5652,1,33.5,752,0,Feature,0,0,0,2,0.015873,0.7778,0,0.3889,1,1,0,0.75,0.0,1.0,44.67,17.88,1,0,0.0,0,31.3333,0,0,0,0,0,"Use el/9 repo urls instead of el/8 since a repo is available for it

As we target el9 and not el8, we should use the el/9 repo as it is
available, even though it provides RPMs with an `el8` dist tag. This can
help prevent confusion for users who see a repo on the system configured
with `el/8` in the repourl.

There should be no impact on existing installations, as the same repo
content is provided in both repos in almost all cases--namely, a few
early versions of erlang are unavailable, but as we pin to a version
that exists in both repos, there is no impact to this change: at worst,
the erlang package will be upgraded to a newer minor version if a user
somehow has an older one installed.
[SEP]
FILES CHANGED:
vars/redhat.yml (+10, -13)
",-1.487178,-1.280086,1.835899,0.041534,-0.179993,-0.260898,0.785073,-0.354222,-0.523087,0.166276,0.015044,0.085821,-0.146435,-0.320797,-0.024279
openstack/charm-ceph-radosgw,I940f9b2f424a3d98936b5f185bf8f87b71091317,1,1,1.0,4.7622,0.0948,3,12.71,617,0,Bug Fix,0,0,0,3,0.073171,1.0,0,1.0,1,2,0,1.0,0.2444,1.0,48.49,11.83,1,0,0.9655,1,5.2735,0,10,0,8,0,"Enable rgw trust forwarded https when https proxy

This option is required for server-side encryption to be allowed
if radosgw is behind a reverse proxy,
such as here when certificates are configured and apache2 is running.

ref. https://docs.ceph.com/en/latest/radosgw/encryption/

It is safe to always enable when https is configured in the charm,
because it will be securely behind the reverse proxy in the unit.
This option must not be enabled when https is not configured in the charm,
because this would allow clients to spoof headers.

Closes-Bug: #2021560
[SEP]
FILES CHANGED:
unit_tests/test_ceph_radosgw_context.py (+101, -11)
hooks/ceph_radosgw_context.py (+1, -0)
templates/ceph.conf (+3, -0)
",-1.524299,-0.958027,0.48231,0.170298,-0.394756,-0.271685,0.256249,0.012318,-0.04379,0.161435,0.02955,-0.052074,0.108711,-0.047729,-0.108202
openstack/openstack-ansible,Iafe7fefeb181f0556ef3790019ed00a9c53e5fff,1,0,0.9213,3.3322,0.0,1,4.0,93,0,Feature,0,0,0,89,0.035974,1.0,0,0.9213,4,1,0,0.9091,0.0,4.0,-40.45,16.6,0,0,0.0,0,3.3214,0,0,0,0,0,"Add 2023.1 to the compatability matrix
[SEP]
FILES CHANGED:
doc/source/admin/upgrades/os-compatibility-matrix.html (+27, -0)
",2.326926,0.281116,0.754732,0.389583,0.245132,0.728442,0.484975,0.671333,1.000937,1.149503,-0.598855,0.163564,-0.96301,0.375032,-0.014721
openstack/charm-ceph-dashboard,I743e50663ee85c91af4962d7d100e2fd48efa48c,1,1,0,4.0254,0.4545,8,10.67,236,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,2,0,1.0,2.6071,1.88,50.6,10.52,1,0,0.8,1,4.2143,0,38,0,19,0,"Adds skip logic to non-leader units

Non leader units will skip the event handling if Ceph dashboard
is not enabled by the leader yet.

Some test bundle fixes.

Partial-Bug: #1952282
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+1, -1)
tests/bundles/lunar-antelope.yaml (+8, -8)
tests/bundles/focal-yoga.yaml (+6, -6)
tests/bundles/focal.yaml (+1, -1)
tests/bundles/jammy-antelope.yaml (+3, -3)
src/charm.py (+8, -3)
tests/bundles/jammy-yoga.yaml (+1, -1)
tests/bundles/jammy-zed.yaml (+2, -2)
",0.620753,-1.653974,-0.299636,-0.048455,-0.583579,0.329546,-0.629844,0.062224,0.048381,-0.137283,-0.148651,0.183737,0.416896,0.181625,-0.027899
openstack/kolla,I8afb1ccddaa527378b7fd833bd51fb9bb9c4c58c,0,1,0,2.3979,0.1,2,9.0,235,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.8218,0.8813,2.5,-13.8,21.38,0,0,0.0,1,21.3636,0,6,0,3,0,"Adds TAAS Neutron plugin to support OVS port mirrors

Related-Bug: #2022375
Depends-On: I7b48770709bd0fb9ea5072ce6c8673074c39ab2b
[SEP]
FILES CHANGED:
docker/neutron/neutron-base/Dockerfile.j2 (+2, -1)
releasenotes/notes/feature_neutron_install_tap-as-a-service-bdf99544a319ce7b.yaml (+7, -0)
",0.385627,0.141651,-1.913185,-1.856467,1.043921,0.319545,-0.000758,0.2418,0.434431,-0.254692,-0.605611,0.365726,0.379617,-0.397238,0.156264
openstack/charm-ceph-dashboard,I7b623d210ddc2fac1ea889c778fc5cc744c0e354,1,0,1.0,6.142,0.0172,9,41.0,332,0,CI,0,0,1,6,0.139535,1.0,0,1.0,3,3,0,1.0,2.2581,1.22,-12.23,27.13,0,0,0.9677,1,0.714,0,0,0,0,0,"Add support for interim Ubuntu releases

- update bundles to include UCA pocket tests
- update test configuration
- update metadata to include kinetic and lunar
- update snapcraft to allow run-on for kinetic and lunar

cherry-pick from I72ab8b2ec96cf78df8a84e0686a33229a6270fb3
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+104, -0)
osci.yaml (+1, -1)
requirements.txt (+2, -1)
tests/bundles/lunar-antelope.yaml (+104, -0)
tests/bundles/overlays/focal.yaml.j2 (+0, -5)
tests/bundles/jammy-antelope.yaml (+118, -0)
charmcraft.yaml (+7, -1)
metadata.yaml (+2, -0)
tests/bundles/jammy-zed.yaml (+118, -0)
",-0.704394,-0.468446,-1.422058,-0.866432,1.241418,-0.274651,0.46568,0.01485,-0.047131,-0.049465,-0.560361,0.121774,0.986287,0.097328,0.10388
openstack/ironic,I774c459a5e11b7cd01f7a65754d5a2c7cc573476,1,0,0.8571,4.1109,0.0,3,27.0,561,0,Bug Fix,0,0,0,7,0.006938,0.5,0,0.4286,6,2,0,0.9425,1.1568,4.0,40.52,17.22,1,1,0.7,1,9.1967,0,0,0,0,0,"[iRMC] Fix parse_driver_info bug enforcing SNMP v3 under FIPS mode

This patch fixes a condition where iRMC driver interfaces would have
the FIPS enforcement logic check applied if the SNMP version was not
set to SNMP v3, even if the interfaces did not use SNMP.

With this patch, if FIPS enabled, iRMC driver enforces SNMP
version to be version 3 only when any xxx_interface of iRMC
driver actually uses SNMP.

Story: 2010713
Task: 47879
(cherry picked from commit 3f09bdcf952621b75e7a0dfc9e001542b2bcc94f)
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/irmc/test_common.py (+42, -0)
ironic/drivers/modules/irmc/common.py (+12, -0)
releasenotes/notes/fix-irmc-enforcing-snmpv3-with-fips-e45971d363925ec3.yaml (+6, -0)
",-2.319141,-0.728478,0.52689,-0.703459,0.784487,0.166005,-0.206922,0.334301,0.080059,0.072365,0.347807,0.119567,-0.062588,-0.322001,-0.037008
openstack/charm-ceph-rbd-mirror,I6bd784b41995e78175869bf2d8cf6789e8f9dd58,1,1,1.0,6.3117,0.8618,13,13.4,559,0,Bug Fix,0,0,1,7,0.013807,1.0,0,1.0,4,4,0,0,2.4562,1.46,30.35,12.52,0,0,0.7018,1,1.0145,0,14,0,11,0,"Bypass charm going into blocked due to a bug

After Octopus, the reporting about image states fails because of a
permission issue in Ceph. This change disables that status reporting
to allow a deployment to be healthy even when some tools cannot query
status.

Also modernize build and func testing: remove python 3.9 and xena from
tests

Related-Bug: #1879749
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1063
cherry picked from Id86fc043495b89609cf6873ec58aee1e2e388578
[SEP]
FILES CHANGED:
osci.yaml (+3, -6)
src/tests/bundles/impish-xena.yaml (+0, -186)
src/tox.ini (+10, -16)
src/tests/bundles/focal-xena.yaml (+0, -187)
src/metadata.yaml (+1, -1)
src/lib/charm/openstack/ceph_rbd_mirror.py (+6, -2)
src/tests/bundles/focal-yoga.yaml (+2, -2)
requirements.txt (+8, -11)
src/tests/bundles/jammy-yoga.yaml (+2, -2)
bindep.txt (+3, -0)
unit_tests/test_lib_charm_openstack_ceph_rbd_mirror.py (+4, -1)
charmcraft.yaml (+16, -15)
tox.ini (+21, -45)
",-1.53121,0.097998,0.26299,-1.02439,-0.050197,-0.24973,0.547212,0.107143,0.137117,-0.057385,0.323312,0.000617,0.141716,-0.246765,0.098743
openstack/openstack-ansible-os_nova,I56aee80180804b8a3e3316cffc6fa8115513b8f1,1,0,0.8333,1.6094,0.0,1,9.25,574,0,Bug Fix,0,0,0,12,0.086957,1.0,0,0.8333,1,1,0,1.0,0.0,1.0,23.67,12.89,1,0,0.0,0,114.8,0,0,0,0,0,"Apply always tag to nova_virt_detect.yml

Running nova playbook with tag limit may lead to an error:

The conditional check 'nova_virt_type != 'ironic'' failed. The error
was: error while evaluating conditional (nova_virt_type != 'ironic'):
'nova_virt_type' is undefined\n\nThe error appears to be in
'/etc/ansible/roles/os_nova/tasks/main.yml': line 289, column 3, but
may be elsewhere in the file depending on the exact syntax problem.

It can be easily fixed by applying always tag to tasks from
nova_virt_detect.yml
[SEP]
FILES CHANGED:
tasks/main.yml (+4, -0)
",-2.480707,-0.345426,0.251887,0.057727,0.184597,-0.294326,-0.215508,-0.051721,0.208498,-0.199411,0.465991,-0.568747,-0.45437,0.389952,-0.15149
openstack/kolla-ansible,Ia09e1f8b423d43c0466fe2d6605ce383fd813544,0,0,0.6667,4.1271,0.0,7,7.6,410,0,CI,0,0,0,3,0.033333,0.5854,0,0.3902,4,3,0,0.8021,2.462,3.43,-25.74,16.72,0,0,0.0,1,6.6129,0,0,0,0,0,"Configures the tap-as-a-service neutron plugin

Adds the needed changes and configurations in
order to use the neutron plugin, tap-as-a-service,
to create port mirrors using `openstack tap` commands.

Implements: configure-taas-plugin
Depends-On: https://review.opendev.org/c/openstack/kolla/+/885151
[SEP]
FILES CHANGED:
releasenotes/notes/feature_configure-taas-plugin-3753573f8fd2305e.yaml (+9, -0)
ansible/roles/neutron/templates/neutron_taas.conf.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-openvswitch-agent.json.j2 (+8, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/neutron/defaults/main.yml (+6, -0)
ansible/roles/neutron/templates/neutron-server.json.j2 (+8, -0)
ansible/roles/neutron/tasks/config.yml (+23, -0)
",-1.740074,1.981718,-1.116548,0.960472,-0.370318,-0.568505,-0.263889,0.022221,0.150404,-0.172414,-0.125297,0.323774,0.715012,0.4387,-0.039411
openstack/openstack-ansible-os_octavia,I7afeaca12dd65e5455359e22c21a77191381bc73,1,0,0.9222,1.0986,1.0,1,4.4,331,0,Feature,0,0,0,90,0.035986,0.8846,0,0.8158,1,1,0,1.0,0.0,1.0,-74.5,18.12,0,0,0.0,0,110.3333,0,0,0,0,0,"Remove obsoleted provider drivers

amphorav1 driver has been dropped from octavia early in 2023.2 cycle [1]

[1] https://opendev.org/openstack/octavia/commit/6c0515c9880b5310dd0647a5881233f07898d812

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/900399
[SEP]
FILES CHANGED:
defaults/main.yml (+0, -2)
",-1.418255,2.267585,-1.557159,-0.802121,-0.186133,-0.068751,0.718798,0.25337,0.125046,0.425848,-0.143433,-0.23496,0.112985,-0.2745,-0.055109
openstack/kolla-ansible,I8bee27882c15e39a3d2946787d56bc90db994887,1,0,0.8462,4.9904,0.5,3,6.38,498,0,Bug Fix,0,0,0,26,0.030023,1.0,0,0.8462,4,1,0,0.7993,1.5193,4.0,9.6,13.53,1,0,0.0,0,3.3878,0,0,0,0,0,"Fix Venus containers start issue

The venus containers failed to start with an error
(venus_api container):
/usr/local/bin/kolla_start: line 24: exec: venus-api: not found
because of [1] and also changes the encoding of the files form
dos to unix introduced in [2].

1. https://opendev.org/openstack/venus/src/branch/master/setup.cfg#L29-L30
2. If3562bbed6181002b76831bab54f863041c5a885
[SEP]
FILES CHANGED:
ansible/roles/venus/templates/venus-manager.json.j2 (+19, -19)
ansible/roles/venus/templates/venus.conf.j2 (+35, -35)
ansible/roles/venus/templates/venus-api.json.j2 (+19, -19)
",-1.830233,0.304725,-0.294258,-1.053705,-0.120162,-0.506187,0.271899,0.273377,0.217808,0.316024,-0.077659,-0.459532,-0.094283,0.292713,-0.238849
openstack/charm-ceph-mon,Ibf12a2b87736cb1d32788672fb390e027f15b936,1,1,1.0,2.7726,0.0,3,9.86,584,0,Bug Fix,0,0,0,1,0.0625,1.0,0,1.0,1,2,0,0.9375,1.231,1.0,42.34,10.9,1,0,0.4,1,36.5,0,16,0,23,0,"Fix persistent config file not update bug

When ceph doing the version upgrade, it will check the previous ceph
from the `source` config variable which store in persistent file.
But the persistent file update is broken. It is because we use hookenv.Config
from ops framework, but the hookenv._run_atexit, which
save the change to file, is not been called.

Partial-Bug: #2007976
func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1047
(cherry picked from commit e99c38ae4cc6c89aa7818d38990cc9b2dfb5060d)
[SEP]
FILES CHANGED:
tests/tests.yaml (+1, -0)
src/charm.py (+9, -0)
unit_tests/test_charm.py (+5, -0)
",-1.659724,-0.145087,0.610182,-1.196658,-0.003469,-0.291324,0.632684,0.067192,0.021132,-0.465335,0.179932,-0.117012,-0.355807,0.163183,-0.192193
openstack/kolla,Ic86e6c22840f658bb68387aac688918d4db1f766,1,1,0,1.0986,0.5,1,13.0,230,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,3,1,0,0.8171,0.0,3.0,27.69,20.58,0,0,0.0,0,76.6667,0,6,0,13,0,"Fix an issue with zun-cni-daemon building images in aarch64

In the aarch64 image build,
use debian_arch to determine packages of different architectures.

Closes-Bug: #2036874
[SEP]
FILES CHANGED:
docker/zun/zun-cni-daemon/Dockerfile.j2 (+1, -1)
",0.446572,-0.764894,-0.667617,-0.396528,-0.234481,-0.496053,-0.202474,0.441578,-0.259289,-0.256024,-0.187688,0.325668,0.12897,-0.005377,0.444487
openstack/octavia,I43416b32b9bef359f7ae7885353721e73a48e006,1,1,0,1.0986,0.0,1,9.6,445,0,Bug Fix,1,0,0,0,0.0,0.4,0,0.0,7,1,0,0.6,0.0,7.0,-12.65,16.34,1,0,1.0,0,148.3333,0,6,0,4,0,"Mock access to tuned active_profile file in unittests

In some environments /etc/tuned/active_profile may be present, and then
running unittests in such an environment can result in an failure. This
patch mocks access to /etc/tuned/active_profile. file in two test cases
test_compile_amphora_details{_for_ipvs}

Closes-Bug: #2023384
[SEP]
FILES CHANGED:
octavia/tests/unit/amphorae/backends/agent/api_server/test_amphora_info.py (+2, -0)
",-1.178298,-0.29719,-0.212721,0.253841,0.306558,-0.168703,-0.414536,-0.094468,0.045088,-0.13753,0.103425,-0.577544,-0.101738,0.142658,0.247859
openstack/charm-ceph-mon,Ia964a8c2049282df9655268272fbcf8117d160e4,1,0,1.0,4.7875,0.5294,5,20.0,326,0,CI,0,0,0,8,0.007569,1.0,0,1.0,2,1,0,0.9412,1.4977,1.2,42.72,15.0,0,0,0.9748,1,2.7167,0,0,0,0,0,"Testing: use mysql and rabbitmq from LTS

For better stability use LTS series for rabbitmq and mysql when
testing instead of interim releases.

Also remove xena (non-lts) from tests and yoga as a source default

cherry-pick from: Ie443c55dc4cc1b7f63eacfee79b28f210f1277e4
[SEP]
FILES CHANGED:
osci.yaml (+0, -1)
tests/bundles/lunar-antelope.yaml (+36, -34)
tests/bundles/jammy-antelope.yaml (+13, -17)
config.yaml (+1, -1)
tests/bundles/jammy-zed.yaml (+6, -10)
",-0.889155,-1.049574,-1.047555,-0.991617,0.869655,-0.747463,0.516024,0.117788,-0.343204,0.260145,-0.292333,-0.33587,0.551219,0.022553,0.032104
openstack/charm-ceph-mon,I2f5ac561120b1abe52ea0621bb472bc78495fa97,1,1,1.0,2.4849,0.0909,1,22.5,347,0,Bug Fix,0,0,0,9,0.007653,1.0,0,1.0,1,1,0,0.9444,0.0,1.0,31.72,17.0,1,0,0.0,0,28.9167,0,10,0,5,0,"rbd mirror relation: be persistent in getting pool info

Auth for getting pool details can fail initially if we set up a rbd
mirror relation at cloud bootstrap. Add some retry to give it another
chance

Partial-Bug: #2021967
(cherry picked from commit af2323c4578ff7f4b352acfe350279eddd1ce0aa)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+10, -1)
",-0.594913,-1.2746,-0.97657,-1.092062,0.464714,0.049593,0.90554,-0.202781,0.19223,0.044372,0.297894,-0.313824,0.544823,0.011325,0.11032
openstack/octavia-dashboard,I882869ef0f5b6381372e3447af7ca1981ca02d65,1,1,0.5714,5.4889,0.527,5,9.67,263,0,Bug Fix,0,0,1,21,0.003187,0.32,0,0.1829,3,3,0,0.2903,1.5462,1.8,4.49,20.42,1,0,0.0,1,1.0868,0,10,0,7,0,"Fix error related to barbicanclient

Octavia Dashboard used protected barbicanclient API that seems to be
broken now. Fixing that by replacing barbicanclient by future-proof
openstacksdk.

Closes-Bug: #2023534
[SEP]
FILES CHANGED:
octavia_dashboard/sdk_connection.py (+50, -0)
requirements.txt (+0, -1)
octavia_dashboard/api/rest/lbaasv2.py (+50, -89)
releasenotes/notes/remove-barbicanclient-6b48fcc36afafb62.yaml (+6, -0)
octavia_dashboard/api/rest/barbican.py (+8, -37)
",0.176607,-1.237773,-0.652963,-0.398003,-0.482779,-0.023403,-0.479866,0.413763,-0.220196,-0.171816,0.103106,-0.009359,0.029576,-0.617635,0.580391
openstack/kolla,I76ac61604f5b0739ec27973a233a65e4c55c8c32,1,1,0.8519,1.6094,0.75,1,5.0,179,0,Bug Fix,0,0,0,27,0.02668,0.0,0,0.0,2,1,0,0.8182,0.0,2.0,-12.56,18.0,1,0,0.0,0,35.8,0,8,0,21,0,"Fix Venus containers built from correct branch

Closes-Bug: #2023628
[SEP]
FILES CHANGED:
kolla/common/sources.py (+1, -3)
",2.312835,-0.843474,0.092055,-1.608068,-0.924135,0.772662,-0.954394,0.527809,-0.023495,-0.419156,0.283436,-0.165012,0.276313,0.135836,0.176616
openstack/charm-cinder-purestorage,I3cdcea3a6bcadd38680a30553649dc6ed5202dd5,1,1,1.0,1.0986,0.0,2,7.33,344,0,Bug Fix,0,0,0,14,0.006626,1.0,0,1.0,0,2,0,0,1.0,0.0,35.96,15.66,1,0,0.0,1,114.6667,0,6,0,19,0,"Add pkg-config to charmcraft.yaml for binary builds

Depending on the build platform (e.g. s390x, ppc64el), sometimes
pkg-config is required, and sometimes it isn't.  Add it to make sure it
is available depending on the availability of binary wheels for
architectures.

Closes-Bug: #2023777
[SEP]
FILES CHANGED:
charmcraft.yaml (+1, -0)
tox.ini (+1, -0)
",-0.773691,-0.518436,-0.479611,0.202567,0.107075,-0.091355,-0.323799,-0.240621,-0.528193,0.106042,-0.035281,-0.270079,0.169812,0.040211,-0.010666
openstack/octavia-dashboard,Idb009295495c1d8c732e792a72d58912e0e8d3a7,1,1,0.7419,2.8332,0.3125,2,14.0,220,0,Bug Fix,0,0,0,93,0.007947,1.0,0,0.7419,7,2,0,0.3125,0.9544,4.5,29.47,17.03,0,0,0.0,1,12.9412,0,36,0,78,0,"Fix popover attributes in member add dialog

Using popovers in the member table is broken in chrome 114, because of
their new ""popover"" feature.

Closes-Bug: #2024188
[SEP]
FILES CHANGED:
releasenotes/notes/fix-chrome-member-dialog-154981a7794d5fb4.yaml (+6, -0)
octavia_dashboard/static/dashboard/project/lbaasv2/workflow/members/members.html (+5, -5)
",0.707964,-1.04336,-0.501975,-0.298418,-0.356387,0.450794,-0.632492,-0.147774,-0.056957,-0.159507,-0.083455,-0.082032,0.214463,-0.118078,0.385628
openstack/openstack-ansible-os_neutron,I122a7e2df0d546c18e4ec607abeb36cb0cec196f,1,0,0.6667,1.0986,0.5,1,5.0,122,0,Feature,0,0,0,3,0.06383,1.0,0,0.6667,1,1,0,0.875,0.0,1.0,-52.04,22.0,1,0,0.0,0,40.6667,0,0,0,0,0,"Stop haproxy on ovn-controller nodes

include ovn-controller nodes.
[SEP]
FILES CHANGED:
tasks/neutron_post_install.yml (+1, -1)
",2.405301,0.527652,0.99183,0.53996,0.83137,-0.556172,0.085477,0.151861,-0.647142,-0.599037,-0.352795,0.271846,0.692053,0.305765,-0.367372
openstack/kolla-ansible,I608b84905fa69346a33a1cef10f159b3412cbfd7,1,1,0.8571,1.0986,0.5,1,5.0,175,0,Bug Fix,0,0,0,28,0.027559,0.0,0,0.0,4,1,0,0.8,0.0,4.0,-12.56,15.33,1,0,0.0,0,58.3333,1,6,0,10,0,"Fix Bifrost: remove an extra curly bracket

Closes-Bug: #2024314
[SEP]
FILES CHANGED:
ansible/roles/bifrost/tasks/deploy-servers.yml (+1, -1)
",2.639504,-0.091737,0.136037,-1.284902,-0.575262,1.122631,-0.362039,-0.086697,0.2827,-0.088714,0.58221,-0.238187,0.157176,-0.213957,0.454128
openstack/charm-ceph-rbd-mirror,I752d3d62a2191c6996786a75f68f46c9e2db69cd,1,0,1.0,6.8046,0.0766,16,22.0,460,0,CI,0,0,1,10,0.008425,1.0,0,1.0,3,5,0,1.0,2.6333,1.06,-21.23,20.62,0,0,0.919,1,0.51,0,0,0,0,0,"Add support for interim Ubuntu releases

- update bundles to include UCA pocket tests
- update test configuration
- update metadata to include kinetic and lunar
- update snapcraft to allow run-on for kinetic and lunar

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1074

cherry-picked from
Ie39cef6965c30f2adb78b4be568ced17a140115b
Ia2ad44152cf620e9812bfbd58276735a7491949c
[SEP]
FILES CHANGED:
src/tests/bundles/lunar-antelope.yaml (+246, -0)
osci.yaml (+1, -5)
test-requirements.txt (+1, -17)
build-requirements.txt (+0, -7)
.zuul.yaml (+2, -1)
src/metadata.yaml (+2, -0)
src/test-requirements.txt (+0, -3)
src/tests/tests.yaml (+6, -4)
src/tests/bundles/kinetic-zed.yaml (+184, -0)
bindep.txt (+1, -0)
pip.sh (+0, -18)
src/wheelhouse.txt (+1, -1)
charmcraft.yaml (+11, -1)
src/tests/bundles/jammy-zed.yaml (+183, -0)
tox.ini (+10, -12)
src/tests/bundles/jammy-antelope.yaml (+184, -0)
",-2.443488,0.598966,-0.80732,-1.634882,1.090374,-0.519174,0.359042,0.094256,0.056101,0.106076,-0.158744,0.184839,0.609658,0.019441,-0.009565
openstack/octavia,Ie4763e97b1414e9871f222c20efd0f532b3dfc9f,1,0,0.6,2.3026,0.2222,2,7.67,200,0,Bug Fix,0,0,0,15,0.005162,1.0,0,0.6,6,2,0,0.6012,0.9911,4.0,48.24,10.02,0,0,0.0,1,20.0,0,0,0,0,0,"Fix the issue of losing nf_conntrace* values after a reboot.

Loading ip_vs module before setting nf_conntrace_* opts.

Story: 2010795
Task: 48247
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/amphora-netns.systemd.j2 (+2, -2)
releasenotes/notes/load-ipvs-before-setting-opts-c5b2f0871bc38c27.yaml (+5, -0)
",-0.145012,0.153131,-0.857209,0.295753,0.777229,0.852641,-1.120202,-0.481717,0.163119,-0.405563,0.548928,-0.659641,-0.225744,-0.120873,0.313174
openstack/kolla,If4e346c2db841aad9b2ddac049dbbbc1ba5782ec,1,0,1.0,3.7842,1.0,4,5.25,173,0,Feature,0,0,0,7,0.122807,0.0,0,0.0,3,3,0,0.8192,1.3981,3.0,44.39,11.62,0,0,0.0,1,3.9318,0,0,0,0,0,"Swift: Remove unused rootwrap

Swift does not use oslo.rootwrap. Thus the command and its config file
is just useless.
[SEP]
FILES CHANGED:
docker/swift/swift-base/rootwrap.conf (+0, -27)
docker/swift/swift-base/swift_sudoers (+0, -1)
docker/swift/swift-base/swift-rootwrap (+0, -10)
docker/swift/swift-base/Dockerfile.j2 (+0, -5)
",1.394477,-0.230079,0.295419,0.628601,-0.214207,0.375248,-0.335928,-0.374843,-0.379335,-0.223231,-0.110081,-0.117706,-0.342297,0.188914,-0.387353
openstack/openstack-ansible-ceph_client,I711b32a5951357b726c4b4b64e534bcd72e6c4f4,1,0,0.8095,1.6094,0.5,1,11.0,191,0,Bug Fix,0,0,0,21,0.214286,0.8889,0,0.7196,1,1,0,0.8,0.0,1.0,30.32,18.95,0,0,0.0,0,38.2,0,0,0,0,0,"Fix permissions for ceph cache directories

These difrectories very specific permissions to match up with the user
and group membership.
[SEP]
FILES CHANGED:
defaults/main.yml (+2, -2)
",2.622792,-2.070371,0.852748,0.065053,-0.200832,-0.298823,0.646202,0.191719,-0.003574,-0.43208,-0.921211,-0.145448,0.054795,-0.063787,-0.349103
openstack/openstack-ansible-ceph_client,Icfc16ca25f0b6b45a0de0bcdf4eac71ab302a120,1,1,0.9231,1.0986,0.5,1,9.0,359,0,Bug Fix,0,0,0,91,0.036356,1.0,0,0.9231,1,1,0,0.8333,0.0,1.0,2.65,12.49,0,0,0.0,0,119.6667,0,6,0,11,0,"Fix retrievement keyrings from files

With [1] usage of custom owner/group has been introduced. It
converted client to be a list of mappings but it was missed in 1 place.

[1] https://opendev.org/openstack/openstack-ansible-ceph_client/commit/fdd2aaa00b3753b393be5768f730f58d0a1e3b04
Closes-Bug: #2024339
[SEP]
FILES CHANGED:
tasks/ceph_get_keyrings_from_files.yml (+1, -1)
",-0.988012,0.576535,-0.878012,-0.869123,-0.300805,-0.047907,1.069043,0.291811,0.523731,0.287397,-0.118996,-0.280233,0.163933,-0.133531,0.014618
openstack/kolla,I84c7633765749a5e9ced983505ef290c32154ccc,1,1,0.8621,0.6931,0.0,1,5.0,184,0,Bug Fix,0,0,0,29,0.028487,0.5,0,0.431,3,1,0,0.8202,0.0,3.0,-23.84,18.0,1,0,0.0,0,92.0,0,6,0,21,0,"Fix cinder-volume: add missing nvme-cli rpm package

Closes-Bug: #2024390
[SEP]
FILES CHANGED:
docker/cinder/cinder-volume/Dockerfile.j2 (+1, -0)
",1.888627,-0.530029,-0.72392,-1.080569,-0.447463,-0.387266,-0.578685,0.544513,-0.217932,-0.425404,0.317581,-0.015964,0.081415,0.047592,0.362357
openstack/kolla,Iafeb9093340621d65a9c9cd126d65679d981dfb1,1,0,0.8667,2.8904,0.2941,1,3.33,241,0,Feature,0,0,0,30,0.029441,1.0,0,0.8667,2,1,0,0.8212,0.0,2.0,-8.05,13.33,1,0,0.0,0,13.3889,0,0,0,0,0,"Disable build of Gnocchi containers

Revert this commit when [1] is solved.

1. https://github.com/gnocchixyz/gnocchi/issues/1304
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+12, -5)
",0.545619,2.704407,-0.887086,0.362304,-0.768113,0.539165,-0.139629,-0.019502,-0.101711,0.263383,-0.101332,-0.209298,-0.371026,-0.256422,-0.021116
openstack/openstack-ansible-plugins,I11b1046ea91cef7de0b2f6433baabbb144e07700,1,1,0.9239,2.8332,0.0625,2,15.75,454,0,Bug Fix,0,0,0,92,0.036727,0.0,0,0.0,3,2,0,1.0,0.5436,2.5,35.08,14.55,0,0,0.0,1,26.7059,0,6,0,7,0,"Skip updating service password by default

At the moment we always do attempt to reset passwords for the
keystone services, which in some cases leads to race conditions in
services. Thus, running a role is not idempotent which we fix by
introducing a `service_update_password` variable. So whenever password
needs to be reseted/updated, the variable should be supplied for that.

Closes-Bug: #2023370
[SEP]
FILES CHANGED:
releasenotes/notes/service_password_update-3bdd2bb5ed3a99b5.yaml (+14, -0)
roles/service_setup/tasks/main.yml (+1, -1)
",-0.997788,-1.124835,-0.144928,0.778267,-0.1835,0.267968,-0.173766,-0.536714,0.251018,0.474004,0.123979,-0.269251,0.236684,-0.528725,0.275153
openstack/openstack-ansible-os_cinder,I711241af8f7520b97f2b1cafd1406ff705fb78a6,1,0,0.8182,1.0986,0.5,1,6.67,378,1,Doc,0,0,0,22,0.215686,1.0,0,0.8182,1,1,0,1.0,0.0,1.0,9.72,11.67,0,0,0.0,0,126.0,0,0,0,0,0,"Use v3 service type in keystone_authtoken config

The service type in this config section must match the service
type in the service catalog, otherwise limited scope application
credentials will not work with the cinder API [1].

[1] https://docs.openstack.org/keystone/2023.1/user/application_credentials.html#access-rules
[SEP]
FILES CHANGED:
templates/cinder.conf.j2 (+1, -1)
",-0.449029,0.606689,-0.480772,0.773229,-0.303964,-0.819745,0.565554,0.700569,0.64887,0.06474,-0.388367,-0.39067,-0.136032,-0.153414,-0.36473
openstack/kolla-ansible,Ic8e2dd42b95a8f5c2141a820c55642a3ed7beabd,1,1,0,5.0814,0.0312,3,24.0,359,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,2,0,0.8007,1.2729,2.0,23.85,21.27,1,0,0.4437,1,2.2298,0,6,0,12,0,"Fix the docker container dimensions comparison for short notation

When using short notations like `1g` or `512m` to define the
container dimensions, we are always getting the container to
being restarted in each kolla-ansible run, even with no real
changes in the container configs.

Closes-Bug: #2070494
[SEP]
FILES CHANGED:
tests/kolla_container_tests/test_docker_worker.py (+70, -1)
ansible/module_utils/kolla_container_worker.py (+75, -4)
releasenotes/notes/fix-restarting-container-even-with-no-changes-when-using-dimensions-ad94b657b6c29cfc.yaml (+10, -0)
",0.330312,-1.537729,-0.158286,0.171226,-0.263459,-0.140827,-0.048539,-0.029476,0.132639,-0.083293,-0.44535,-0.112603,0.3026,-0.05744,-0.006188
openstack/kolla-ansible,Id6eae798784126d4dd53adef15bdce6b47b4601f,1,1,0,2.4849,0.1818,3,16.0,148,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.8014,1.3093,3.33,21.4,18.9,1,0,0.0,1,12.3333,0,8,0,25,0,"Adding mariadb_port to wsrep sync status so alterative ports can be used

Closes-Bug: #2024554
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2024554-6eb811364536f1e8.yaml (+7, -0)
ansible/roles/mariadb/tasks/precheck.yml (+1, -1)
ansible/roles/mariadb/tasks/restart_services.yml (+1, -1)
",1.483501,-0.724456,-0.806772,-0.520533,-0.288584,0.199361,-0.251724,0.341186,0.098863,-0.550476,0.433846,-0.196728,-0.390735,-0.399783,-0.190633
openstack/kolla-ansible,Ie678d90f88034a079f3284ab5a509be24e8eb42b,1,1,1.0,2.0794,0.1429,2,3.67,135,0,Bug Fix,0,0,0,1,0.083333,0.0,0,0.0,5,2,0,0.8021,0.8631,3.5,-19.92,23.28,1,0,0.0,1,16.875,0,8,0,25,0,"Updating proxysql.yaml.j2 to use mariadb_port for backends

Related-Bug: #2024554
[SEP]
FILES CHANGED:
releasenotes/notes/proxysql-template-mariadb-port-cf8f2d88c0962b75.yaml (+5, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+1, -1)
",1.16492,0.017171,-1.012171,-0.623938,-0.063347,-0.371234,-0.531432,0.654965,-0.319835,-0.220063,0.334459,-0.30365,-1.036502,-0.238856,0.177444
openstack/kolla,I7e289bd5ce52319604717e0b319d0642a8e598db,1,1,0.8727,2.8332,0.75,3,9.0,325,0,Bug Fix,0,0,0,55,0.049195,0.8571,0,0.7481,2,3,0,0.8222,1.5,2.0,-5.97,13.97,1,0,0.0,1,19.1176,0,70,0,48,0,"rabbitmq: use erlang-25 ppa on Debian/Ubuntu

RMQ team is now maintaining erlang-24, erlang-25 ppas, see [1].

[1]: https://github.com/rabbitmq/erlang-debian-package/discussions/33

Closes-Bug: #2023668
(cherry picked from commit 0e881148d0036f27b95c5a27459e527fb3b0476d)
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+0, -4)
docker/base/apt_preferences.debian (+0, -4)
kolla/template/repos.yaml (+4, -4)
",-1.371402,0.997488,-1.157844,-1.096466,0.11919,-0.35455,0.698853,0.410554,-0.059753,0.397589,0.470613,-0.266683,0.269893,0.018995,-0.033611
openstack/openstack-ansible,I5932e8b66bb4674fb1b39442fea467c075b30989,1,0,0.9247,0.6931,0.0,1,14.75,454,0,Feature,0,0,0,93,0.03689,0.0,1,0.0,0,1,0,0.9107,0.0,0.0,35.57,14.04,0,0,0.0,0,227.0,0,0,0,0,0,"Pin version of setuptools

We used to pin version of setuptools in global-requirements-pins
until it got defined in upper-constraints. Since setuptools no longer
kept in u-c since Zed, it makes sense to return pinning back.

On top of that a major setuptools version was released recently with
breaking changes, that affect gnocchi at least [1]

[1] https://github.com/gnocchixyz/gnocchi/issues/1304
[SEP]
FILES CHANGED:
global-requirement-pins.txt (+1, -0)
",-0.811062,-0.05172,0.309776,0.137999,-0.618423,-0.445395,0.219272,0.108953,-0.550606,0.545689,0.137057,-0.019515,-0.182193,-0.192448,0.25662
openstack/charm-ceph-radosgw,Id74fa86d80e6e7bf16ee048bb6277f082705e8d7,1,0,1.0,1.3863,0.0,1,3.0,141,0,Feature,0,0,0,1,0.017857,1.0,0,1.0,0,1,0,1.0,0.0,0.0,-87.61,23.42,0,0,0.0,1,35.25,0,0,0,0,0,"Adds focal to charmcraft
[SEP]
FILES CHANGED:
charmcraft.yaml (+3, -0)
",3.279383,1.484656,1.203438,0.61557,0.705356,0.699003,0.552644,0.001635,0.66643,-0.059251,-0.030826,-0.062814,0.058187,0.349866,-0.200099
openstack/openstack-ansible,Iaf81f778ffd9fcf6572e03e8ce73ffef46bd98aa,1,0,1.0,2.5649,0.3333,2,20.5,550,1,Bug Fix,0,0,0,3,0.085714,0.0,0,0.0,1,1,0,0.9123,1.0,1.0,35.4,15.52,1,0,0.0,0,42.3077,0,0,0,0,0,"Use include_role in task to avoid lack of access to vars

This patch updates the security hardening playbook to use include_role
within a task versus using 'roles' directly to fix cases where
apply_security_hardening is set to False. Some change to Ansible
appears to limit access to vars when the role is skipped, resulting
in failures. The side effect of this change is the role is skipped
entirely (when applicable) versus the individual tasks being skipped,
which speeds up deployment times.
[SEP]
FILES CHANGED:
playbooks/infra-journal-remote.yml (+4, -2)
playbooks/security-hardening.yml (+4, -2)
",-1.815189,-1.123869,-0.061452,1.222717,0.621145,0.003226,-0.116607,-0.57728,0.303482,0.411025,0.054684,-0.041281,0.088702,-0.522236,-0.047018
openstack/openstack-ansible-os_neutron,If87cf7cfa1788d68c9a4013d7f4877692f2bb11c,1,0,1.0,2.4849,0.5455,3,7.05,1236,0,Bug Fix,0,0,0,4,0.153846,0.8929,0,0.8929,2,2,0,0.8889,1.3093,1.33,34.3,10.82,1,0,0.0,0,103.0,0,0,0,0,0,"Configure OVN NB and SB DB Connection probes

Allow configuration of `inactivity_probe` in Connection table in NB and
SB for new installations.

Issues, which successfully resolve by using this as a workaround:
1. https://www.mail-archive.com/ovs-discuss@openvswitch.org/msg07431.html
2. https://bugs.launchpad.net/kolla-ansible/+bug/1917484

According to the OVN ML, specifically this part [1], there is no other
way to set `inactivity_probe` other than using Connection table. And the
only valid option for it would be `0.0.0.0`, so that it could be applied
to all connections.

`ovn-ctl` forces `ovsdb-server` to look for addresses to listen on in
Connection table with `db-nb-use-remote-in-db` and
`db-sb-use-remote-in-db` options which are enabled by default.

If `db-nb-create-insecure-remote` and `db-sb-create-insecure-remote` are
set to `yes` (when `neutron_ovn_ssl` is `False`), this would result in
flooding OVN logs with `Address already in use` errors.

So we will rely on default value `no` for them from now on and only
listen on and with whatever options are provided in Connection tables.

[1] https://www.mail-archive.com/ovs-discuss@openvswitch.org/msg07476.html
[SEP]
FILES CHANGED:
templates/ovn-northd-opts.j2 (+0, -2)
defaults/main.yml (+2, -0)
tasks/providers/ovn_cluster_setup.yml (+3, -4)
",-3.910557,2.486194,3.019802,-0.399506,-0.027705,0.36922,-0.951002,-0.514992,-0.22748,-0.405598,-0.485082,0.159332,-0.014995,0.085995,-0.015421
openstack/charm-neutron-api-plugin-ovn,Ia1f48d86330d6e357ae3b35ce28bbb036788ac4a,1,1,0,3.8286,0.0,4,9.45,853,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0,1.9724,2.0,20.72,16.47,1,0,0.5778,0,18.5435,0,6,0,4,0,"It sets ‚Äúrestart-trigger‚Äù key on neutron-plugin relation on upgrade-charm event.

When neutron-api-plugin-ovn charm is upgraded (juju refresh ...) some configuration parameters in ml2_conf.ini may have also updated.
It was observed that sometime those changes are not taken in to account by neutron service because it was not restarted after file content modification.
This change introduces rising of ‚Äúrestart-trigger‚Äù key on neutron-plugin relation databag when upgrade-charm event is generated.
With every new ‚Äúcharm-upgrade‚Äù event value for ‚Äúrestart-trigger‚Äù is updated: f.e. ‚Äúrestart-trigger cf2697c8-f5f0-44b5-8dae-32d893fb209c‚Äù.
Principal charm ‚Äúneutron-api‚Äù has implemented logic which triggers neutron service restart as soon as ‚Äúrestart-trigger‚Äù key value is changed.

Closes-Bug: #2019798
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_ovn.py (+14, -0)
src/reactive/neutron_api_plugin_ovn_handlers.py (+8, -0)
src/lib/charm/openstack/neutron_api_plugin_ovn.py (+11, -0)
unit_tests/test_reactive_neutron_api_plugin_ovn_handlers.py (+12, -0)
",-3.702816,1.913779,1.405342,0.217184,0.885307,0.344495,0.347739,-0.232182,0.39096,-0.581651,0.217986,0.450659,0.013576,0.150445,-0.001865
openstack/openstack-ansible-os_rally,I016e457c0e4b7819d6d65af3bc35e06061f92d1c,1,0,0.8462,1.0986,0.5,1,6.0,406,0,Bug Fix,0,0,0,13,0.091549,0.8966,0,0.7586,1,1,0,0,0.0,1.0,-20.15,12.4,0,0,0.0,0,135.3333,0,0,0,0,0,"Include proper commit in rally_upper_constraints_url

Currently, rally_upper_constraints_url always points to master branch.
It is not a valid behavior because u-c from master may not work for
stable branches.
This change fixes rally_upper_constraints_url.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/887592
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",-2.035644,1.522357,-0.767113,0.387373,0.021636,-0.188969,0.193441,-0.027252,0.109861,-0.320414,0.432453,-0.404233,-0.224633,-0.037671,0.161203
openstack/charm-ceph-dashboard,I8edfa2d41d5fea048f14b7b50558a40dc555799e,1,0,1.0,4.1897,0.1385,4,16.0,177,0,CI,1,0,0,11,0.005268,1.0,0,1.0,2,1,0,1.0,1.9213,2.0,37.26,13.9,0,0,1.0,1,2.6818,0,0,0,0,0,"Adds source for application in test bundles

Also set channels

cherry pick from I21d7865c41898551f3f1b1859388139b4cff2bd1
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+16, -0)
tests/bundles/lunar-antelope.yaml (+16, -0)
tests/bundles/focal-yoga.yaml (+7, -2)
tests/bundles/jammy-yoga.yaml (+17, -7)
",0.931458,-0.645797,-1.630887,-2.41066,1.41028,0.132883,0.404272,-0.520566,0.240797,-0.186577,-0.861892,0.091541,-0.103834,0.103603,-0.124919
openstack/openstack-ansible-rabbitmq_server,I99683a031f935b579d38ae457c484c9a150344c6,1,0,0.8571,2.1972,0.5,2,7.06,941,0,CI,0,0,0,14,0.097222,1.0,0,0.8571,1,1,0,0.7778,1.0,1.0,27.47,10.97,0,0,0.0,0,104.5556,0,0,0,0,0,"Use wildcards to specify rabbit/erlang versions

For a long time we were struggling with disappearing packages on
packagecloud/cloudsmith repos.
We were told to use {ppa1,yum1}.novemberain.com because packages should
not disappear from there[1].
Unfortunately it just happened causing Rocky jobs to fail with error
message: ""No package erlang-25.3.2-1.el9.x86_64 available.""

Because we had this issue for a long time and we have not found any
proper solution so far, I think the best we can do is to use wildcards
for version definitions.
Wildcards are used only for build numbers(number after 3th dot) if they
are present. It should minimize a chance to install incompatible erlang
and rabbitmq versions.

[1] https://github.com/rabbitmq/rabbitmq-server/discussions/8386#discussioncomment-6022021

Required-By: https://review.opendev.org/c/openstack/openstack-ansible-os_rally/+/887528
[SEP]
FILES CHANGED:
vars/redhat.yml (+2, -2)
vars/debian.yml (+2, -2)
",-2.477745,0.648878,2.535881,-1.073944,-0.824607,-0.142745,0.570193,-0.048969,-0.385678,0.014662,0.050053,-0.057864,-0.078013,-0.053032,0.060672
openstack/kolla,I42e7c4bfd6865388603a0fccaf29f2850a3a481e,0,1,0,2.8332,0.75,3,9.0,325,0,Bug Fix,0,0,0,0,0.0,0.875,0,0.0,2,3,0,0.8232,1.5,2.0,-5.97,13.97,1,0,0.0,1,19.1176,0,70,0,48,0,"rabbitmq: use erlang-25 ppa on Debian/Ubuntu

RMQ team is now maintaining erlang-24, erlang-25 ppas, see [1].

[1]: https://github.com/rabbitmq/erlang-debian-package/discussions/33

Closes-Bug: #2023668
(cherry picked from commit 0e881148d0036f27b95c5a27459e527fb3b0476d)
[SEP]
FILES CHANGED:
docker/base/apt_preferences.ubuntu (+0, -4)
docker/base/apt_preferences.debian (+0, -4)
kolla/template/repos.yaml (+4, -4)
",-1.371402,0.997488,-1.157844,-1.096466,0.11919,-0.35455,0.698853,0.410553,-0.059753,0.397589,0.470613,-0.266683,0.269892,0.018995,-0.033611
openstack/charm-ceph-dashboard,Iec2f200963c3ed1e4d9bff86d62b49ddc91d0578,1,1,1.0,3.912,0.449,8,11.67,296,0,Bug Fix,0,0,0,12,0.005574,1.0,0,1.0,2,2,0,1.0,2.68,1.88,45.13,12.67,0,0,0.7755,1,5.92,0,38,0,19,0,"Adds skip logic to non-leader units

Non leader units will skip the event handling if Ceph dashboard
is not enabled by the leader yet.

Some test bundle fixes.

Partial-Bug: #1952282
cherry-pick from I743e50663ee85c91af4962d7d100e2fd48efa48c
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+1, -1)
tests/bundles/lunar-antelope.yaml (+5, -5)
tests/bundles/focal-yoga.yaml (+6, -6)
tests/bundles/focal.yaml (+1, -1)
tests/bundles/jammy-antelope.yaml (+3, -3)
src/charm.py (+8, -3)
tests/bundles/jammy-yoga.yaml (+1, -1)
tests/bundles/jammy-zed.yaml (+2, -2)
",-0.647535,-1.163309,-1.301664,-1.223205,0.477362,0.027394,0.397886,0.026387,0.293527,0.139988,-0.017686,-0.127088,0.568854,0.191441,0.129462
openstack/openstack-ansible,I1553ba549ba36ab23f999cb256e731520cbb5d09,1,0,0.8667,1.6094,0.5,2,9.0,238,0,Bug Fix,0,0,0,15,0.098684,0.0,0,0.0,3,1,0,0.9138,1.0,3.0,28.5,11.01,1,0,0.0,0,47.6,0,0,0,0,0,"Adjust default value for *_backend_ssl

I forgot to set a proper(openstack_service_backend_ssl) default value
for *_backend_ssl variables in a few places.
This patch fixes my mistake.
[SEP]
FILES CHANGED:
inventory/group_vars/horizon_all/haproxy_service.yml (+1, -1)
inventory/group_vars/blazar_all/haproxy_service.yml (+1, -1)
",0.200385,0.514674,-0.459158,0.69882,0.822984,0.576886,-0.14391,-1.063009,-0.093722,-0.274788,0.360144,-0.48348,-0.479962,-0.213859,0.394201
openstack/kayobe,I2085f9d1fd457e5b54b17f37a5e725990a60e8bc,1,1,1.0,3.091,0.1429,3,21.0,185,0,Bug Fix,0,0,0,1,0.166667,1.0,0,1.0,4,2,0,0.9412,1.519,2.33,16.32,19.83,1,0,0.0,1,8.4091,0,6,0,19,0,"Fix for seed-containers being unable to use password protected registry

Update old code to use truthy filter

Closes-bug: #2026276
[SEP]
FILES CHANGED:
ansible/roles/deploy-containers/tasks/main.yml (+10, -0)
ansible/container-image-build.yml (+2, -3)
releasenotes/notes/kayobe_docker_login-495a424c2da479a7.yaml (+6, -0)
",1.138173,-1.419804,-0.542962,-0.54769,-0.424001,0.090637,-0.693974,-0.09069,0.01063,-0.145498,0.045712,-0.071701,0.227561,-0.217429,0.106055
openstack/charm-ceph-mon,I1ca4316aaf4f0b855a12aa582a8188c88e926fa6,1,1,1.0,4.4308,0.0241,3,25.5,380,0,Bug Fix,0,0,1,13,0.005904,1.0,0,1.0,1,2,0,0.9474,1.2231,0.67,33.32,14.91,1,0,0.6506,0,4.5238,0,16,0,14,0,"Fix ceph-mon upgrade path

This PR makes some small changes in the upgrade path logic by
providing a fallback method of fetching the current ceph-mon
version and adding additional checks to see if the upgrade can
be done in a sane way.

Closes-Bug: #2024253
(cherry picked from commit 1a41aa24ce82c411da936ef3f21c61a57c059155)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+28, -1)
test-requirements.txt (+4, -1)
unit_tests/test_upgrade.py (+49, -0)
",-1.102604,-0.871901,-0.690086,-0.709601,0.446452,0.141899,0.849589,-0.128567,0.310117,0.490942,0.067541,0.057471,0.337,-0.165153,0.408381
openstack/openstack-ansible,I27073a1bf85294ff65bde24cae939f28f5c69bd7,1,0,0.875,4.8203,0.5366,6,10.54,1142,1,Bug Fix,0,0,0,16,0.102564,0.0,0,0.0,2,1,0,0.9153,2.5795,1.5,9.65,14.73,1,0,0.0,0,9.2097,0,0,0,0,0,"Gather facts before including common-playbooks

For nova, neutron and cinder, haproxy service is configured before
playbooks from common-playbooks/ are included(and facts for these hosts
are gathered). Eventually, haproxy config tasks are executed without
common facts.

It may lead to several corner cases. For example, after facts cache
expires and user runs os-nova-install.yml, haproxy config('Create
haproxy service config files' task) will fail because
`haproxy_service_configs` uses `nova_console_type` variable which needs
`ansible_facts['architecture']`. It can be easily reproduced with:
```
rm -rf /etc/openstack_deploy/ansible_facts/ && \
openstack-ansible /opt/openstack-ansible/playbooks/os-nova-install.yml
```

As a solution, this change gathers facts at the beginning of
os-<service>-install.yml playbooks, instead of doing this inside
common-playbooks/<service>.yml.

This bug was not detected by CI because during deployment process,
hardware facts are gathered for all hosts (at least) by
security-hardening.yml. As long as they exists in cache everything works
fine.
[SEP]
FILES CHANGED:
playbooks/os-neutron-install.yml (+19, -4)
playbooks/common-playbooks/neutron.yml (+0, -19)
playbooks/os-nova-install.yml (+19, -1)
playbooks/os-cinder-install.yml (+19, -4)
playbooks/common-playbooks/cinder.yml (+0, -19)
playbooks/common-playbooks/nova.yml (+0, -19)
",-3.766612,0.447253,3.034211,-0.761518,0.168072,-0.462888,-0.841436,0.012519,-0.3337,-0.594768,-0.515111,-0.081864,-0.235896,0.089855,-0.315492
openstack/openstack-ansible-lxc_hosts,I42f5b43f09d3c530813dd7fd334eafce7a5eaf39,1,0,0.9255,3.4012,0.3793,4,13.25,347,0,Feature,0,0,0,94,0.037272,0.9,0,0.833,2,2,0,1.0,1.8486,1.25,49.73,15.11,0,0,0.0,1,11.5667,0,0,0,0,0,"Refactor LXC image expiration

Right now we write output of `date -d @{{ timestamp }} to
the expiry file, and then attempt to comapre with timestamp.
However, output of  `date -d` is datetime and not timestamp,
so these 2 things can not be properly compared. So image cache
was valid forever.
[SEP]
FILES CHANGED:
releasenotes/notes/fix_lxc_cache_expiration-1656b5758c4ec24e.yaml (+10, -0)
tasks/lxc_cache.yml (+2, -2)
tasks/lxc_cache_create.yml (+2, -9)
defaults/main.yml (+4, -0)
",-0.108695,-1.525471,0.050478,0.407466,-0.249138,0.12915,0.124318,-0.691729,-0.131235,0.223991,-0.433947,-0.352955,0.091291,0.589222,-0.386571
openstack/openstack-ansible,I337796c8dab4eeb1552971c270f0c83809241199,1,0,0.9263,2.1972,0.25,2,3.33,181,0,Feature,0,0,0,95,0.03724,1.0,0,0.9263,3,1,0,0.9167,0.8113,1.5,-118.03,17.33,0,0,0.0,0,20.1111,0,0,0,0,0,"Update SHAs for Gnoochi and plugins

Needed-By: https://review.opendev.org/c/openstack/openstack-ansible-os_ceilometer/+/888476
[SEP]
FILES CHANGED:
ansible-collection-requirements.yml (+1, -1)
inventory/group_vars/gnocchi_all/source_git.yml (+5, -1)
",0.433065,3.097399,-1.39373,-0.145573,-1.001476,-0.139762,0.06763,0.035756,0.15152,-0.990099,-0.787939,0.198645,-0.041401,-0.427569,0.058928
openstack/octavia,I1c51a5d6d6593108f431809868dcdb3d4142df45,1,1,0,2.5649,0.25,3,16.67,352,0,Bug Fix,0,0,0,0,0.0,0.4545,0,0.0,7,3,0,0.6025,1.4591,5.0,57.94,13.87,0,0,0.1667,1,27.0769,0,6,0,9,0,"Fix IPv6 session persistence failed

When an IPv6 load balancer is created, and the pool is enabled with
SOURCE IP session persistence, it does not work because the stick
table only records IPv4 addresses. However, an IPv6 stick table can
record both IPv4 and IPv6 addresses.

Closes-Bug: #2027934
[SEP]
FILES CHANGED:
releasenotes/notes/fix-ipv6-session-persistence-failure-d649656a44fc3bbb.yaml (+6, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+1, -1)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+2, -2)
",-0.434015,-1.631734,-0.336402,0.495983,-0.007147,-0.036124,-0.363646,0.480209,0.402,0.150788,-0.089295,0.235098,0.272146,-0.262283,-0.100146
openstack/kolla-ansible,I7ea236f59a7ede1f5a9ab4c60e7e5aba907ea5b8,1,0,0.9375,1.0986,0.0,1,7.0,97,0,Feature,0,0,0,16,0.019778,0.0,0,0.0,4,1,0,0.8028,0.0,4.0,-114.5,19.94,0,0,0.0,0,32.3333,0,0,0,0,0,"Trivial: Add deploy-containers for skyline
[SEP]
FILES CHANGED:
ansible/roles/skyline/tasks/deploy-containers.yml (+2, -0)
",2.289931,0.545596,1.122325,0.350972,0.26117,0.049338,-0.412446,0.43143,0.207829,-0.185895,-0.234688,0.186755,0.555105,0.43902,-0.080923
openstack/ironic,I0bb0ad5df613df86cd8a7686f9c32e902826cd20,1,1,1.0,4.5747,0.0417,3,27.25,709,0,Bug Fix,0,0,0,2,0.010363,1.0,0,1.0,6,2,0,0.9432,1.3274,4.0,34.81,17.14,1,0,0.4896,1,7.3093,0,6,0,3,0,"Retry connecting vmedia through a DVD device if available

Currently, it is not possible to use virtual media based provisioning on
servers that only support DVD MediaTypes and do not support CD
MediaTypes. This change adds support for DVD-only virtual media. In
addition to this, it adds hanling of BadRequestException on attempt to
insert virtual media, so that instead of giving up on the first failure
encountered, the code continues to iterate through the list of other
virtual media devices available on the system and attempts to insert
media into the next suitable device till it either suceeds or runs out of
devices to try.

Closes-Bug: #2031595
[SEP]
FILES CHANGED:
releasenotes/notes/handle-dvd-only-vmedia-f4971a013a8aafd0.yaml (+8, -0)
ironic/tests/unit/drivers/modules/redfish/test_boot.py (+47, -0)
ironic/drivers/modules/redfish/boot.py (+37, -4)
",-1.380771,-1.286813,1.008982,0.506245,-0.221758,-0.085811,0.513393,0.161416,0.325852,0.40259,0.184935,0.233505,0.158389,-0.485971,0.024615
openstack/openstack-ansible-plugins,I3129b75af1127c62a0bd1cee39586730c5f6589c,1,0,0.9271,1.0986,0.5,1,5.14,321,0,Bug Fix,0,0,0,96,0.037515,0.0,0,0.0,3,1,0,1.0,0.0,3.0,20.67,14.28,1,0,0.0,0,107.0,0,0,0,0,0,"Installing systemd-udev with NVR

Due to the bug [1] in CentOS packaging, systemd-udev is substituted with
systemd-boot-unsigned. So you need to use NVR to properly
install systemd-udev until the bug is fixed.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=2183279
[SEP]
FILES CHANGED:
roles/glusterfs/vars/redhat.yml (+1, -1)
",-1.238324,2.065182,-0.826186,0.82981,-0.408062,0.161878,0.290726,-0.392508,-0.258417,0.428522,0.433142,-0.062899,0.056642,0.034335,0.191504
openstack/ansible-role-systemd_mount,I3c112b74b4777b9443f3c3041a51ecb770d48021,1,0,0.9278,1.0986,0.5,1,5.14,321,0,Bug Fix,0,0,0,97,0.037876,0.8182,0,0.7591,1,1,0,0,0.0,1.0,23.02,14.28,1,0,0.0,0,107.0,0,0,0,0,0,"Installing systemd-udev with NVR

Due to the bug [1] in CentOS packaging, systemd-udev is substituted with
systemd-boot-unsigned. So you need to use NVR to properly
install systemd-udev until the bug is fixed.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=2183279
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -1)
",-1.238324,2.065182,-0.826186,0.82981,-0.408062,0.161878,0.290726,-0.392508,-0.258417,0.428522,0.433142,-0.062899,0.056642,0.034335,0.191504
openstack/charm-mysql-innodb-cluster,Ib3549bd65c29f6887cda12fe0669474c13fbe399,1,0,0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,61.91,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.041091,-1.305827,-0.054085,0.935444,-0.046069,0.262639,0.159748,-0.095679,0.624556,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-mysql-router,I803a39bbddf129b0b8e2a882fcab5b7afedbbd68,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,1,0.5,1.0,0,1.0,1,1,0,0,0.0,1.0,58.06,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.041091,-1.305827,-0.054086,0.935445,-0.046068,0.262639,0.159747,-0.095679,0.624555,-0.062676,0.022837,0.408058,-0.154157,0.448036,-0.490639
openstack/charm-rabbitmq-server,Idd4eb37dd413b49a99b8b81fd15d0b45f75ae97e,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,2,0.666667,1.0,0,1.0,0,1,0,1.0,0.0,0.0,61.91,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.04109,-1.305827,-0.054085,0.935444,-0.046069,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-ceph-mon,I173cadb5a8208283883e1119dbfc5d661809cc5f,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,3,0.75,1.0,0,1.0,0,1,0,0.95,0.0,0.0,61.91,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.668412,-1.034481,-0.105478,-0.369961,0.444964,0.27116,0.542646,-0.08335,0.575666,0.034753,0.243114,0.362867,-0.074504,0.294674,-0.52263
openstack/charm-ceph-osd,I0fb5e14bd2e58d4abdcce6e230d5c4c1a1d00af7,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,4,0.8,1.0,0,1.0,0,1,0,0.8333,0.0,0.0,56.78,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.775137,-1.171615,-0.092775,-0.39453,0.456126,0.235718,0.462645,-0.085497,0.529864,0.036271,0.268875,0.37703,-0.096295,0.326562,-0.546823
openstack/charm-ceph-radosgw,Id759ee81cea83fe9b18671ce5bc19a31db319a77,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,5,0.833333,1.0,0,1.0,0,1,0,1.0,0.0,0.0,58.06,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.041091,-1.305827,-0.054085,0.935445,-0.046068,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-ceph-rbd-mirror,Ia36919df21c55bfc40497f7c174ba5919f44a394,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,6,0.857143,1.0,0,1.0,1,1,0,1.0,0.0,1.0,63.19,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.67761,-0.958732,-0.115792,-0.35956,0.424634,0.26426,0.50177,-0.114931,0.547433,-0.036492,0.274474,0.328173,-0.084941,0.268575,-0.531008
openstack/charm-ceph-dashboard,I4c9f607213138adff0af434a417048c9d40af2a4,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,7,0.875,1.0,0,1.0,0,1,0,1.0,0.0,0.0,59.34,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.041091,-1.305827,-0.054085,0.935445,-0.046068,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/openstack-ansible-os_horizon,Ida72c712153dcda4cd06e0959f98ade4fee8dfbd,1,0,0.9286,1.6094,0.5,2,12.25,316,0,Bug Fix,0,0,0,98,0.038236,1.0,0,0.9286,1,2,0,1.0,1.0,1.0,68.36,8.17,0,0,0.0,0,63.2,0,0,0,0,0,"Fix wrong neutron_ml2_drivers_type

neutron_ml2_drivers_type is a string, not a list, while default
value for it is a list. Local settings also assume that it is a list.

So we ensure that the falue is a string by default now and
treat it as string in the code.
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
templates/horizon_local_settings.py.j2 (+1, -1)
",-0.140332,-0.690414,-0.230912,1.060806,0.082507,-0.147898,0.70427,-0.722989,0.069398,0.063137,0.469198,-0.491106,-0.500889,0.203034,0.191338
openstack/kolla-ansible,I3ec1af6353c3ecc64589599abe375b0ae9b14d5c,1,1,0.871,2.7081,0.0,3,13.6,546,0,Bug Fix,0,0,0,31,0.029923,1.0,0,0.871,4,2,0,0.8034,1.4926,3.33,13.88,17.79,1,0,0.0,1,36.4,0,256,0,22,0,"Deny access to public /server-status in http Openstack services

This change block access to the public /server-status url on all
http services exposed by HAProxy, also fixes an issue with Horizon
where 'Require all granted' open access to the /server-status in
the HAProxy-less configurations. Without this change the issue
affects only Ubuntu/Debian installations where mod_status in Apache2
enabled by default.

Closes-Bug: #1996913
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/horizon.conf.j2 (+4, -0)
releasenotes/notes/http-services-deny-server-status-39d0259664053e59.yaml (+7, -0)
ansible/roles/haproxy-config/templates/haproxy_single_service_split.cfg.j2 (+3, -0)
",-1.01487,-1.193222,0.195898,0.263533,-0.035988,-0.390309,-0.146912,0.487429,-0.038974,0.063376,-0.006043,-0.109,0.470588,-0.082824,0.175954
openstack/kolla-ansible,I0b437a77aeb61bc5ae9238f900a1fa00cbc34e18,1,1,0.8125,2.0794,0.0,2,12.67,299,0,Bug Fix,0,0,0,16,0.004438,0.0,0,0.0,4,2,0,0.8041,0.5917,3.0,38.14,14.54,0,0,0.0,1,37.375,0,6,0,8,0,"Fix OpenSearch Dashboards health check

The OpenSearch Dashboards container does not have a health
check defined when created. This causes the container to always
restart when reconfigured, even if no change has been made.

Partial-Bug: #2028362
[SEP]
FILES CHANGED:
releasenotes/notes/fix-os-dashboards-health-check-bf56027f8c3369ea.yaml (+6, -0)
ansible/roles/opensearch/handlers/main.yml (+1, -0)
",0.04355,-0.56492,-0.824989,0.581863,-0.153213,0.758511,-0.135013,-0.323761,0.15817,0.119586,0.419165,0.179607,0.21559,-0.052351,0.078232
openstack/oslo.messaging,Ib8dba833542973091a4e0bf23bb593aca89c5905,1,1,0.0,3.7842,0.093,2,11.22,719,0,Bug Fix,0,0,0,1,0.012195,0.6154,0,0.0,2,2,0,0.5417,0.7401,2.0,43.0,10.83,1,0,0.0,1,16.3409,0,14,0,14,0,"Auto-delete the failed quorum rabbit queues

When rabbit is failing for a specific quorum queue, the only thing to
do is to delete the queue (as per rabbit doc, see [1]).

So, to avoid the RPC service to be broken until an operator eventually
do a manual fix on it, catch any INTERNAL ERROR (code 541) and trigger
the deletion of the failed queues under those conditions.
So on next queue declare (triggered from various retries), the queue
will be created again and the service will recover by itself.

Closes-Bug: #2028384
Related-bug: #2031497

[1] https://www.rabbitmq.com/quorum-queues.html#availability
[SEP]
FILES CHANGED:
releasenotes/notes/auto-deleted-failed-quorum-ca6a3923c3ed999a.yaml (+9, -0)
oslo_messaging/_drivers/impl_rabbit.py (+30, -4)
",-2.389006,-0.383255,1.489103,-1.111572,-0.174335,0.297781,0.33334,-0.257984,0.232061,-0.073197,-0.017401,0.091475,0.106044,0.036942,0.018993
openstack/ironic,I5f88d3b1da1c17bc26d49370cc6ce74644d13679,1,0,0,3.989,0.4528,1,8.38,551,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,0.9438,0.0,2.0,8.93,14.1,1,0,0.0,0,10.2037,0,0,0,0,0,"Fix ks_template property to be processed only for anaconda deploy

Ramdisk and anaconda deploys share image processing by
ironic.common.pxe_utils.get_instance_image_info(). This method
unnecessarily processes ks_template property when ramdisk
deploy is in use, and by itself calls _get_image_properties()
which requires image_source property to exist.
For ramdisk deploy it is enough to have kernel and ramdisk.
This patch adds conditions to process ks_template property only
for anaconda deploy.
[SEP]
FILES CHANGED:
ironic/common/pxe_utils.py (+29, -24)
",-1.523814,-0.353925,0.338366,0.566833,0.604409,-0.4498,-0.12633,0.01973,0.075404,-0.610909,0.134576,-0.19379,-0.320652,0.047657,-0.229138
openstack/charm-ceph-osd,I805b28bf625d69626fcf663530ac93073d298732,1,0,1.0,4.7791,0.5,3,12.5,189,0,Bug Fix,1,0,0,14,0.006127,1.0,0,1.0,2,1,0,0.8571,1.5749,2.0,48.64,9.8,1,0,1.0,1,1.5882,0,0,0,0,0,"Fix: test bundles for jammy and lunar

Series and UCA pockets were off. Also deploy supporting charms for
lunar on jammy for stability
[SEP]
FILES CHANGED:
tests/bundles/lunar-antelope.yaml (+27, -19)
tests/bundles/jammy-antelope.yaml (+16, -20)
tests/bundles/jammy-zed.yaml (+16, -20)
",0.807793,-1.151131,-0.646098,-0.154044,0.144096,-0.35178,-0.247259,0.384182,-1.357619,-0.250661,0.089912,-0.026964,0.249632,-0.461131,0.175421
openstack/charm-ceph-mon,I173cadb5a8208283883e1119dbfc5d661809cc5f,1,0,0.8125,1.0986,0.5,2,17.75,507,0,Doc,0,0,0,16,0.021362,1.0,0,0.8125,0,2,0,0.9524,1.0,0.0,56.56,12.73,1,0,0.0,1,169.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.

(cherry picked from commit 3eb5898a655cf9b6221bd3ec74d0a98947b08092)
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
tox.ini (+0, -1)
",-1.668412,-1.034481,-0.105478,-0.369961,0.444964,0.27116,0.542646,-0.08335,0.575666,0.034753,0.243114,0.362867,-0.074504,0.294674,-0.52263
openstack/charm-ceph-radosgw,Id759ee81cea83fe9b18671ce5bc19a31db319a77,1,0,0.8235,3.5553,0.8824,4,16.5,438,0,Doc,0,0,1,17,0.022636,1.0,0,0.8235,0,3,0,1.0,0.9298,0.0,58.06,12.05,1,0,0.0,1,12.5143,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
osci.yaml (+0, -28)
requirements.txt (+3, -0)
metadata.yaml (+1, -0)
tox.ini (+0, -2)
",-1.041091,-1.305827,-0.054085,0.935445,-0.046068,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/openstack-ansible,Ieef7cd417d8a8f7b81ed41c069aa30e0fae940da,1,0,1.0,1.6094,0.5,1,18.0,297,0,Bug Fix,0,0,0,17,0.128788,1.0,0,1.0,3,1,0,0.918,0.0,3.0,-8.84,21.64,0,0,0.0,0,59.4,0,0,0,0,0,"nova/haproxy: fix typo in detection of 'serialconsole'

'nova_console_type' is defined in os_nova and elsewhere in
group_vars with a 'serialconsole' value, but 'serial' is currently
used here to determine whether to enable the haproxy config.
[SEP]
FILES CHANGED:
inventory/group_vars/nova_all/haproxy_service.yml (+2, -2)
",0.39904,-0.251476,-0.511449,0.664806,0.212986,-0.415843,0.314085,-0.293146,0.215925,-0.359279,-0.067758,-0.589004,-0.442033,-0.241313,0.200204
openstack/charm-ceilometer,I3cbd3c8f3a57be26a599b32973d319f3994377f2,1,0,0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,0,0.0,1.0,0,0.0,0,1,0,0,0.0,0.0,61.91,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
metadata.yaml (+1, -0)
",-1.04109,-1.305827,-0.054085,0.935444,-0.046069,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-designate,I2836aadfe6b9a035c6838b144e3f65436e4c184e,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,1,0.5,1.0,0,1.0,1,1,0,1.0,0.0,1.0,59.34,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.04109,-1.305827,-0.054085,0.935444,-0.046069,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-octavia,I50e457e3b9affdd0ca83602c1e580b75c6aa5434,1,0,1.0,0.6931,0.0,1,16.5,438,0,Doc,0,0,0,2,0.666667,1.0,0,1.0,1,1,0,1.0,0.0,1.0,58.06,12.05,1,0,0.0,1,219.0,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.04109,-1.305827,-0.054085,0.935444,-0.046069,0.262639,0.159748,-0.095679,0.624555,-0.062677,0.022837,0.408058,-0.154158,0.448036,-0.490639
openstack/charm-ceph-osd,I0fb5e14bd2e58d4abdcce6e230d5c4c1a1d00af7,1,0,0.8333,1.9459,0.3333,3,17.75,507,0,Doc,0,0,1,18,0.02293,1.0,0,0.8333,0,3,0,0.875,1.4591,0.0,51.79,12.73,1,0,0.5,1,72.4286,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.

(cherry picked from commit af700cf3261c99e826070f19bf70da3b516ee99c)
[SEP]
FILES CHANGED:
test-requirements.txt (+3, -0)
metadata.yaml (+1, -0)
tox.ini (+0, -2)
",-1.775137,-1.171615,-0.092775,-0.39453,0.456126,0.235718,0.462645,-0.085497,0.529864,0.036271,0.268875,0.37703,-0.096295,0.326562,-0.546823
openstack/kayobe,I6a9c521d43b21ab6b6c01e4688cab697608a667c,1,0,1.0,2.0794,0.1429,2,4.25,207,0,Bug Fix,0,0,0,11,0.083333,0.8571,0,0.8571,2,2,0,0.9419,0.8631,1.0,-41.33,15.82,0,0,0.0,1,25.875,0,0,0,0,0,"Fix CentOS / Rocky route options

Updates interfaces role to a fixed version.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/890198
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
releasenotes/notes/fix-rhel-route-options-94b7dd3712a0c6d3.yaml (+5, -0)
",0.065031,2.327838,-1.446857,-0.059786,-1.273451,0.272399,-0.009294,-0.008611,0.229762,-0.606812,-0.710119,0.057314,0.008261,-0.230816,-0.083091
openstack/ironic,I46ece586c254c58b80723bc905cad3144691fc5d,1,0,0.9688,4.0431,0.0893,3,16.33,328,0,CI,0,0,0,32,0.011804,1.0,0,0.9688,6,2,0,0.9444,1.3831,4.0,41.78,14.7,0,0,0.4286,1,5.7544,0,0,0,0,0,"Reset parent_node values to uuids instead of names

So, I got myself nice and confused with testing parent_node logic
when I used a name, but the ironic internals are modeled around
queries involving UUID matching.

We now identify names, and reset the values to be a UUID.
[SEP]
FILES CHANGED:
releasenotes/notes/constrain-parent-node-to-uuids-51642cacfea0714d.yaml (+6, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+24, -0)
ironic/api/controllers/v1/node.py (+21, -5)
",-0.106829,-1.688215,0.087047,0.612518,0.121224,0.200835,0.108701,-0.934953,-0.587014,0.176986,-0.060994,-0.31918,0.242532,-0.271312,-0.010884
openstack/charm-ceph-radosgw,I63697f594ebcdfd10e2dc1315360b2d28fc48846,1,0,0,3.2581,0.44,2,6.33,197,0,CI,0,0,0,0,0.0,1.0,0,0.0,2,1,0,1.0,0.5294,2.0,-4.41,21.48,1,0,0.0,0,7.5769,0,0,0,0,0,"Sync charms.ceph helpers (pacific)

currently ceph-radosgw can't upgrade from victoria to wallaby
because UCA_CODENAME_MAP is missing wallaby.
[SEP]
FILES CHANGED:
lib/charms_ceph/utils.py (+12, -10)
lib/charms_ceph/broker.py (+2, -1)
",0.842127,-0.338101,-1.069678,-0.300963,0.590003,-0.13747,-0.170583,0.169819,-0.889753,-0.863937,0.233556,-0.162367,-0.799697,0.002188,-0.423399
openstack/kayobe,I35eaa92f4243af00697306aa801e5a733885ce4f,1,1,0.8889,4.1589,0.0159,7,18.67,372,0,Bug Fix,0,0,0,9,0.067669,1.0,0,0.8889,5,4,0,0.9425,2.3234,3.14,47.39,13.9,0,0,0.1587,1,5.8125,0,8,0,13,0,"Add STP option for bridge interfaces

For Rocky Linux 9, Kayobe will now disable STP on a bridge by default,
to preserve compatibility with network scripts, as Network Manager
enables STP on all bridges by default.
Enabling STP can lead to port down event if BPDU guard is enabled
on the switch.

Closes-Bug: #2028775
[SEP]
FILES CHANGED:
kayobe/plugins/filter/networkd.py (+3, -0)
kayobe/tests/unit/plugins/filter/test_networkd.py (+5, -1)
playbooks/kayobe-overcloud-host-configure-base/overrides.yml.j2 (+2, -0)
releasenotes/notes/add-bridge-stp-option-9be6bf35f6425548.yaml (+12, -0)
kayobe/plugins/filter/networks.py (+27, -0)
playbooks/kayobe-overcloud-host-configure-base/tests/test_overcloud_host_configure.py (+4, -0)
doc/source/configuration/reference/network.rst (+9, -0)
",-0.71713,-1.620819,-0.030261,0.420248,-0.0335,0.10366,-0.683469,0.287688,-0.06134,0.284628,-0.029943,-0.058741,0.395756,-0.351743,-0.072305
openstack/ironic,I0b68f054c951655b01f0cd776feb5a8c768471ab,1,1,0.9697,1.9459,0.1667,1,4.7,837,0,Bug Fix,0,0,0,33,0.011926,1.0,0,0.9697,3,1,0,0.9451,0.0,3.0,21.16,9.97,0,0,0.0,0,119.5714,0,6,0,7,0,"DB: Select upon delete for allocations

When an allocation has been created, it is still being created
in the background. The client may request deletion of the
allocation *prior* to the creation of the allocation is entirely
completed. That is fine, but the challenge is we may encounter a
locked row if we're asked to delete while in process.

So, we'll query with with_for_update[0] which should be held until
the lock is released, which is only released when the original
locking transaction closes out[1][2].

[0]: https://docs.sqlalchemy.org/en/14/core/selectable.html#sqlalchemy.sql.expression.GenerativeSelect.with_for_update
[1]: https://dev.mysql.com/doc/refman/5.7/en/select.html
[2]: https://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html

Closes-Bug: #2028866
[SEP]
FILES CHANGED:
ironic/db/sqlalchemy/api.py (+5, -1)
",-3.498818,1.939628,2.054528,-0.247932,-0.628982,0.397113,0.008946,-0.355563,0.138274,0.126074,-0.282107,0.007391,-0.184923,0.106318,-0.133241
openstack/kolla-ansible,I4ec34511b022707d0069d7a07f2f92b34acf0085,1,0,0.875,0.6931,0.0,1,12.5,202,0,Bug Fix,0,0,0,56,0.049383,1.0,0,0.875,3,1,0,0.8048,0.0,3.0,45.25,16.2,0,0,0.0,0,101.0,0,0,0,0,0,"cephadm: log to file

Currently we don't gather mon/mgr logs, which are essential for
debugging Ceph integration issues - this patch improves that.
[SEP]
FILES CHANGED:
roles/cephadm/tasks/main.yml (+1, -0)
",1.498526,-1.133514,0.048473,0.15164,-0.016285,-0.147868,0.049995,-0.439898,-0.466936,-0.273324,-0.206382,0.075461,-0.14957,-0.365662,0.113261
openstack/openstack-ansible-haproxy_server,I39c2dab5108a815ef966bab0d708d6300eb1a4d1,1,0,1.0,1.0986,0.5,1,5.0,326,1,Doc,0,0,0,18,0.132353,0.9062,0,0.9062,1,1,0,0.8571,0.0,1.0,22.89,13.43,0,0,0.0,0,108.6667,0,0,0,0,0,"Correct default Content-Type for security.txt

The security.txt RFC specifies a Content-Type of text/plain and
charset of utf-8 [1]. This adjusts the defaults so line breaks are
rendered correctly in a browser.

[1] https://datatracker.ietf.org/doc/html/rfc9116#section-3
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",-1.352209,1.300044,-0.875552,1.061136,-0.263779,0.164226,-0.063425,0.201829,0.606692,0.941555,-0.098503,-0.209344,0.110526,0.227621,-0.51814
openstack/kolla-ansible,I0a03e509ce228a50e081fcab44d2b4831251190c,1,1,0.8772,3.4012,0.2759,4,24.2,813,0,Bug Fix,0,0,0,57,0.05022,0.5,0,0.4386,2,2,0,0.8055,1.6939,1.75,36.84,16.29,1,0,0.3103,0,27.1,0,16,0,7,0,"systemd: handle running container without systemd unit

MariaDB bootstrap has a phase where the first MariaDB container
is running with Galera bootstrap - after a check that WSREP
is synced is successful - we restart the container.

The bootstrap container is named mariadb and running with
docker_restart_policy: ""no"" - the restarted container should be running
in systemd.

Before this patch the code created a systemd unit but it was initially
stopped - so stopping was always a success - and the container would be
killed with SIGKILL on removal (which obviously breaks MariaDB).

This patch also improves docker/systemd stops by waiting for real
unit/container stop and adds failing CI for containers that are
killed with signal 9.

Closes-Bug: #2029613
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+3, -4)
tests/check-logs.sh (+8, -0)
tests/kolla_docker_tests/test_docker_worker.py (+1, -0)
ansible/module_utils/kolla_systemd_worker.py (+9, -4)
",-1.984226,-1.93547,1.364787,-0.507651,-0.287153,-0.207678,0.03466,0.161765,-0.196511,-0.317936,0.378461,0.196781,0.056787,0.245093,0.041796
openstack/charm-mysql-router,Icfca352f29e089aeccd1434d33a573ca1682339a,1,1,0.0,3.6636,0.0789,4,12.33,523,0,Bug Fix,0,0,0,1,0.25,1.0,0,0.0,4,2,0,1.0,1.8474,1.75,36.55,13.58,1,0,0.2105,1,13.4103,0,6,0,26,0,"Add cleanup of configuration files on `stop`

When this subordinate is removed from a unit it leaves its configuration
files behind. This can become an issue if the subordinate is added back
to the unit as pointed out in #2004088.

This change adds a cleanup step to the `stop` hook so that those
configuration files are removed on the removal of the subordinate charm.

Closes-Bug: #2004088
Closes-Bug: #2004089
[SEP]
FILES CHANGED:
src/lib/charm/openstack/mysql_router.py (+16, -0)
unit_tests/test_mysql_router_handlers.py (+7, -1)
charmcraft.yaml (+2, -2)
src/reactive/mysql_router_handlers.py (+10, -0)
",-0.827939,-0.466681,0.03749,0.625748,-0.13826,0.831523,0.445927,-0.235815,0.692601,0.234035,0.423198,0.04156,0.026091,0.302114,0.190598
openstack/kolla,I3ca4e10508c26b752412789502ceb917ecb4dbeb,1,0,0.875,2.3026,0.8889,2,4.1,485,0,Bug Fix,0,1,0,32,0.030476,1.0,0,0.875,2,1,0,0.8187,0.7642,2.0,-3.67,10.42,1,0,0.0,0,48.5,0,0,0,0,0,"Revert ""Disable build of Gnocchi containers""

This reverts commit 5505cd000ce7f12c272c5b62074c9cc6bf1bb7a7.
Reason: Closed #1304 [1] as completed.
Also build from master until new tag releases since #1304 fixed
in master [2] only.

1. https://github.com/gnocchixyz/gnocchi/issues/1304
2. https://github.com/gnocchixyz/gnocchi/commit/b52f7414d595e8d765fde50992f2776a77b98de6
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+0, -7)
kolla/common/sources.py (+1, -1)
",-2.019811,1.924936,-0.836986,-1.228002,0.596754,0.225955,0.936111,0.007675,0.01033,0.274784,0.406564,0.007823,-0.279262,-0.141732,-0.124833
openstack/openstack-ansible-os_ironic,I3952a4e5514824381410d87ed6d535f13ec40498,1,0,1.0,1.9459,0.6667,1,20.67,810,0,Bug Fix,0,0,0,19,0.137681,0.9091,0,0.9091,1,1,0,1.0,0.0,1.0,43.27,16.33,0,0,0.0,0,115.7143,0,0,0,0,0,"Fix lack of constraints for ironic-inspector

OSA playbooks only call this role once for all Ironic containers
(API and inspector). As a result, the wheel builds only happen
once. If the first host (which is responsible for wheel builds)
is an API container, these vars would prevent Ironic inspector
requirements being accounted for, and as such no matching
constraints will be generated.

When the venv is deployed to the Ironic inspector container,
the lack of constraints can cause dependencies which are too new
to be installed, causing the service to fail.

Alternatively this role could be called twice by the playbook
for differing container/host roles, but as inspector is expected
to be merged into ironic at some point this feels equally valid.
[SEP]
FILES CHANGED:
vars/main.yml (+2, -4)
",-1.171158,-1.893339,1.520756,0.227739,-0.242914,-0.321997,0.384821,-0.133528,-0.064386,-0.035058,-0.07425,0.320784,0.03909,-0.143388,-0.294084
openstack/kolla,Ibbf75fa73b8397ea3686b42cec6cad6d8f6d3858,1,1,0,2.6391,0.1538,3,17.0,273,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,3,2,0,0.8197,1.3347,3.0,20.38,19.74,0,0,0.0,0,19.5,0,6,0,10,0,"Adding db sync script for venus

The script for database synchronization is missing in the venus-api image,
which makes it impossible to create the required database tables during
venus deployment.

Closes-Bug: #2029915
[SEP]
FILES CHANGED:
docker/venus/venus-manager/Dockerfile.j2 (+0, -2)
docker/venus/venus-api/Dockerfile.j2 (+3, -0)
docker/venus/venus-api/extend_start.sh (+8, -0)
",0.11731,-1.13546,-0.533313,0.310762,-0.211074,0.227795,-0.626387,0.097121,-0.087741,-0.161084,-0.138057,0.392903,0.057903,-0.016173,0.261325
openstack/openstack-ansible,Icfced9e28aa34406e175d7ccb95c16dbe2aa65d6,1,0,1.0,1.0986,0.5,1,15.0,300,0,Bug Fix,0,0,0,20,0.138889,0.75,0,0.75,3,1,0,0.9194,0.0,3.0,50.61,13.11,1,0,0.0,0,100.0,0,0,0,0,0,"haproxy: fix csp issue preventing embedded serial console

When CSP is enabled, it isn't currently possible to view the
serial console unless you use the link to view it in a new window.

This patch adjusts the CSP to permit the required access.
[SEP]
FILES CHANGED:
inventory/group_vars/haproxy/haproxy.yml (+1, -1)
",0.413662,-1.662845,-0.235267,0.480119,-0.444618,0.049248,0.128726,-0.262445,-0.027043,0.090946,0.030375,0.312811,-0.107475,-0.220453,-0.327465
openstack/openstack-ansible,Ie2e06c99b9c99435e29a321b373d6a937f4123f4,1,0,1.0,1.0986,0.5,1,18.5,458,0,Bug Fix,0,0,0,21,0.143836,1.0,0,1.0,3,1,0,0.9206,0.0,3.0,60.01,11.72,1,0,0.0,0,152.6667,0,0,0,0,0,"haproxy: fix health checks for serialconsole in http mode

The serialconsole proxy appears to be a very simple WebSocket
proxy with no obvious support for many HTTP methods. As such
a HEAD or GET to / returns a 405.

This patch adjusts the expected status code to ensure the service
isn't marked as down, but it is worth noting that the health
checks do make the serialproxy service logs a little noisy.
[SEP]
FILES CHANGED:
inventory/group_vars/nova_all/haproxy_service.yml (+1, -1)
",-0.593691,-2.075635,-0.013392,0.530994,-0.472995,-0.131872,0.330999,-0.243901,0.126563,0.606016,0.072154,-0.346047,0.339839,-0.319994,0.179216
openstack/openstack-ansible-os_keystone,Ia9e2e35d3898727af67c4d07115bad6d0582dda4,1,0,0.75,0.6931,0.0,1,11.0,248,0,Feature,0,0,0,4,0.081633,1.0,0,0.75,1,1,0,1.0,0.0,1.0,44.42,12.88,1,0,0.0,0,124.0,0,0,0,0,0,"Install libldap-common for keystone

Is the package is not installed it's not possible to validate the
tls cert of the ldap-server.

This package went from depends to suggests in jammy release.
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",1.338037,-1.886136,-0.179349,0.012085,-0.701412,-0.817388,0.546863,0.237808,-0.521697,-0.188793,-0.084291,0.105379,-0.591533,0.28657,0.032463
openstack/kolla-ansible,I7646f929b7edc2684102ae1b5927bcc75f0c87c9,1,1,0,2.5649,0.0,1,9.0,101,0,Bug Fix,0,0,0,0,0.0,0.8,0,0.0,4,1,0,0.8061,0.0,4.0,37.9,16.93,0,0,0.0,0,7.7692,0,14,0,16,0,"Add nova conf for cyborg

Closes-Bug: #2030467
[SEP]
FILES CHANGED:
ansible/roles/cyborg/templates/cyborg.conf.j2 (+12, -0)
",1.93972,-0.250545,-0.494672,-1.453438,-0.647532,0.992008,-0.968439,0.291745,-0.107473,-0.576238,0.529348,-0.000602,0.008189,-0.00663,0.238857
openstack/kolla,Idbb16f373260735e9650be57042952258a2ee3f9,0,0,1.0,2.9444,0.0,4,3.5,94,0,Feature,0,0,0,1,0.071429,1.0,0,1.0,3,4,0,0.8207,1.6961,2.25,-50.52,29.97,0,0,0.0,1,4.9474,0,0,0,0,0,"Add venus-dashboard into horizon image.
[SEP]
FILES CHANGED:
releasenotes/notes/add-venus-dashboard-1d4a5093ad233c6e.yaml (+4, -0)
kolla/common/sources.py (+4, -0)
docker/horizon/extend_start.sh (+9, -0)
roles/kolla-build-config/defaults/main.yml (+1, -0)
",2.970746,1.023449,0.497351,0.252421,0.460727,-0.129336,1.010052,0.580635,0.293128,-0.962684,0.160764,0.522109,-0.030811,0.537033,-0.117644
openstack/kolla-ansible,I72238959940b125348aef0d2509f9a13d98ce73b,0,0,0.5,2.0794,0.0,4,8.0,141,0,Feature,0,0,0,2,0.0625,0.625,0,0.3125,4,2,0,0.8068,1.6645,2.5,-65.66,33.2,0,0,0.0,1,17.625,0,0,0,0,0,"Add venus-dashboard into horizon

Depends-on: Idbb16f373260735e9650be57042952258a2ee3f9
[SEP]
FILES CHANGED:
ansible/roles/horizon/defaults/main.yml (+1, -0)
ansible/group_vars/all.yml (+1, -0)
releasenotes/notes/add-venus-dashboard-a8efe1a93dca9f0e.yaml (+4, -0)
etc/kolla/globals.yml (+1, -0)
",1.234278,0.757562,-1.885766,-2.321627,1.261083,0.488298,0.621859,-0.651583,0.466403,-0.399619,-0.748235,0.891227,-0.124422,0.032087,0.047079
openstack/kolla-ansible,I9d0b332420d97f4c5b02d50ce153fabd4bfd6b10,1,1,1.0,3.2189,0.0,3,30.0,240,0,Bug Fix,0,0,0,1,0.076923,1.0,0,1.0,4,2,0,0.8041,1.3844,2.67,24.11,22.67,0,0,0.0,1,9.6,0,34,0,19,0,"set haproxy for cyborg module

fix bug: cyborg-api in controller does not work at kolla_external_fqdn with
port 6666, there is no haproxy setting for cyborg module

Closes-Bug: #2020088
[SEP]
FILES CHANGED:
ansible/roles/cyborg/defaults/main.yml (+14, -0)
releasenotes/notes/fix-cyborg-haproxy-missing-variables-2f00c677a7003005.yaml (+6, -0)
ansible/group_vars/all.yml (+4, -0)
",1.061716,-0.903565,-0.42361,-0.430713,0.089255,-0.122425,-0.133286,0.101471,-0.016104,-0.737475,0.071014,-0.385721,-0.184599,-0.330345,0.242896
openstack/openstack-ansible-galera_server,I99d993a7c466cb744136bd06f4ab2e21c2569151,1,1,1.0,0.6931,0.0,1,20.67,453,0,Bug Fix,0,0,0,22,0.148649,1.0,0,1.0,1,1,0,0.875,0.0,1.0,27.57,19.23,1,0,0.0,0,226.5,0,8,0,8,0,"Remove galera-4 package during upgrades to force version up

Current upgrades leave the galera-4 package in place which
can cause incompatibilities when the mariadb binaries are
updated.

By forcing removal of this package during upgrades it should
be re-installed with a version matching the rest of the
mariadb packages.

RHEL distros already have a removal step for galera-*

Closes-Bug: #2028946
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",-1.110972,-1.452274,0.025662,0.224093,0.273719,-0.018491,-0.140327,0.165523,-0.235514,0.219138,0.022162,0.207427,0.162018,-0.165023,0.174489
openstack/ansible-role-pki,Id999ccf5f42ee7f6b6b08db67276bb77bc9a21d8,1,1,1.0,3.9318,0.4,5,25.0,417,0,Bug Fix,0,0,0,23,0.154362,1.0,0,1.0,2,1,0,1.0,2.0187,1.2,15.64,19.6,1,0,0.0,0,8.1765,0,6,0,5,0,"Add defaults for owner/group/mode on pki_install_host

Reverts the default user/group from
I4a90479261b2721c08e9034fbae0d56de9308676

Adds global default options so user/group etc can
be overridden on the setup host

Some cases of 'omit' for file modes are changed to a
role-defined default which will override any system umask
preferences.

Related-Bug: #2029253
[SEP]
FILES CHANGED:
tasks/main_certs.yml (+3, -2)
tasks/main_ca.yml (+3, -2)
vars/standalone_cert.yml (+4, -4)
tasks/standalone/create_ca.yml (+12, -12)
defaults/main.yml (+8, -0)
",-0.94677,-1.53487,-0.406206,-0.714738,0.671502,-0.082319,0.174821,0.071423,0.385228,-0.146673,-0.203915,-0.34161,0.122436,-0.086028,-0.111725
openstack/kolla-ansible,I3ad8be70a0d19df2f40959c36739a72cdf8e8260,1,1,0.3333,3.2958,0.1538,5,9.0,104,0,Bug Fix,0,0,0,3,0.076923,1.0,0,0.3333,4,2,0,0.8047,2.1199,3.6,9.7,16.93,0,0,0.0,1,3.8519,0,6,0,4,0,"cyborg: support for dev mode

Closes-Bug: #2030849
[SEP]
FILES CHANGED:
ansible/roles/cyborg/defaults/main.yml (+10, -0)
releasenotes/notes/cyborg-dev-mode-74dcc234d996db42.yaml (+5, -0)
ansible/roles/cyborg/tasks/bootstrap_service.yml (+1, -1)
ansible/roles/cyborg/tasks/deploy.yml (+3, -0)
ansible/roles/cyborg/handlers/main.yml (+3, -3)
",2.261,-0.536135,-0.093068,-1.60301,-0.997588,0.982619,-0.958295,0.388651,0.02604,-0.303579,0.551491,-0.119611,0.19965,-0.169529,0.493355
openstack/oslo.messaging,Ic94323658c89df1c1ff32f511ca23502317d0f00,1,1,1.0,5.5175,0.1008,3,20.0,452,0,Bug Fix,0,0,0,1,0.333333,1.0,0,1.0,3,1,0,0.56,1.2392,2.67,17.34,18.0,0,0,0.8065,0,1.8153,0,14,0,66,0,"Only allow safe context fields in notifications

Publishing a fully hydrated context object in a notification would give
someone with access to that notification the ability to impersonate the
original actor through inclusion of sensitive fields.

Now, instead, we pare down the context object to the bare minimum before
passing it for serialization in notification workflows.

Related-bug: 2030976
[SEP]
FILES CHANGED:
oslo_messaging/tests/notify/test_notifier.py (+159, -7)
oslo_messaging/tests/notify/test_listener.py (+17, -17)
oslo_messaging/notify/notifier.py (+47, -1)
",-0.644386,-1.402355,-0.294006,0.796751,-0.020285,0.516582,0.052617,-0.815461,0.212805,-0.021003,-0.246795,0.144141,0.229757,-0.161351,-0.059389
openstack/kolla,I14ba7e0319b7eb0390361d397d4baad0e9a3f0b1,1,0,0.8788,2.3026,0.0,1,8.2,379,0,Feature,0,0,0,33,0.031161,1.0,0,0.8788,2,1,0,0.8162,0.0,2.0,0.42,15.96,1,0,0.0,0,37.9,0,0,0,0,0,"Add server-status handler to Rocky/Centos Apache conf

This added to make Rocky/Centos similar to Ubuntu/Debian
to provide /server-status handler for local monitoring of the Apache.
Since I3ec1af6353c3ecc64589599abe375b0ae9b14d5c is merged it safe
to add this change.
[SEP]
FILES CHANGED:
docker/base/httpd_setup.sh (+9, -0)
",-0.733103,-1.283341,-1.428381,-0.734976,0.642958,-0.369284,0.580585,0.33475,-0.10278,0.215289,-0.543167,0.092596,0.282621,0.139953,0.002326
openstack/charm-ceph-rbd-mirror,Ia36919df21c55bfc40497f7c174ba5919f44a394,1,0,1.0,1.3863,0.0,3,17.75,507,0,Doc,0,0,1,3,0.75,1.0,0,1.0,1,3,0,1.0,1.585,0.33,57.75,12.73,1,0,0.0,1,126.75,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.

(cherry picked from commit 3ac03519788ee52797d06e2cc0ad7d773615dc91)
[SEP]
FILES CHANGED:
bindep.txt (+1, -0)
.gitreview (+1, -0)
src/metadata.yaml (+1, -0)
",-1.67761,-0.958732,-0.115792,-0.35956,0.424634,0.26426,0.50177,-0.114931,0.547433,-0.036492,0.274474,0.328173,-0.084941,0.268575,-0.531008
openstack/kayobe,I4830500d3c927b0689b6f0bca32c28137916420b,1,1,0.8875,5.112,0.0242,5,11.75,725,0,Bug Fix,0,0,0,80,0.02611,1.0,0,0.8875,3,2,0,0.9432,1.9673,2.0,41.01,13.64,1,0,0.7273,1,4.3675,0,6,0,13,0,"Fix configuration dump with inline encrypted variables

If inline Ansible vault encryption is used to define an encrypted
variable in kayobe-config, running 'kayobe configuration dump -l <host>'
fails with the following:

  Failed to decode config dump YAML file /tmp/tmp_fg1bv_j/localhost.yml:
  ConstructorError(None, None, ""could not determine a constructor for
  the tag '!vault'"", <yaml.error.Mark object at 0x7f1e5c7404c0>)

This change fixes the error by using the Ansible YAML loader which
supports the vault tag. Any vault encrypted variables are sanitised in
the dump output. Note that variables in vault encrypted files are not
sanitised.

Closes-Bug: #2031390
[SEP]
FILES CHANGED:
kayobe/ansible.py (+16, -2)
kayobe/tests/unit/test_utils.py (+54, -0)
releasenotes/notes/config-dump-vault-edc615e475f234ac.yaml (+7, -0)
kayobe/tests/unit/test_ansible.py (+65, -1)
kayobe/utils.py (+19, -1)
",-1.653286,-0.289351,1.475559,-0.498068,-0.056694,-0.233541,0.312692,0.328094,0.627252,-0.115453,0.393252,-0.21659,-0.163342,0.170411,-0.099961
openstack/openstack-ansible-openstack_hosts,Idedf39312df718a7d815eebb3642f75207348afb,1,0,0.8261,2.3979,0.5,4,15.0,241,0,Feature,0,0,0,23,0.221154,1.0,0,0.8261,1,1,0,0.75,1.9219,1.0,30.87,15.33,0,0,0.0,0,21.9091,0,0,0,0,0,"Rename internal variable _package_list

This var is renamed _openstack_hosts_package list so that it
does not collide with a variable of the same name used in the
python_venv_build role.
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+1, -1)
vars/ubuntu-22.04.yml (+1, -1)
vars/debian.yml (+1, -1)
defaults/main.yml (+2, -2)
",0.494406,-0.367831,-0.219348,0.69661,0.315568,-0.018185,-0.159743,-0.472242,0.423287,-0.566059,-0.208243,-0.320818,-0.992166,-0.008624,0.071024
openstack/kolla,I788fbb76af3cd2fc4bd1cafb6004ba09c2362db6,0,0,0,5.4765,0.0126,16,12.2,475,0,Feature,0,0,0,0,0.0,1.0,0,0.0,3,7,0,0.8172,3.3637,2.06,33.57,16.03,1,0,0.0,1,1.9874,0,0,0,0,0,"Add ovn-bgp-agent / FRR / Horizon BGPVPN dashboard

ovn-bgp-agent [1] is a new component that exposes VMs/containers
through BGP on OVN environments.

This change extends kolla to be also able to build images for
ovn-bgp-agent and FRR, as this is a requirement for ovn-bgp-agent.
Furthermore, it also extends the horizon integration to enable the
BGPVPN dashboard plugin.

[1] https://opendev.org/openstack/ovn-bgp-agent
[SEP]
FILES CHANGED:
docker/neutron/ovn-bgp-agent/Dockerfile.j2 (+64, -0)
kolla/common/sources.py (+8, -0)
README.rst (+1, -0)
docker/horizon/extend_start.sh (+13, -0)
docker/neutron/ovn-bgp-agent/extend_start.sh (+14, -0)
docker/frr/frr_sudoers (+4, -0)
kolla/template/repos.yaml (+28, -0)
docker/neutron/ovn-bgp-agent/ovn_bgp_agent_sudoers (+4, -0)
kolla/common/config.py (+2, -0)
releasenotes/notes/add-ovn-bgp-agent-frr-87d09857bbd66ba0.yaml (+9, -0)
kolla/common/users.py (+8, -0)
docker/frr/extend_start.sh (+23, -0)
kolla/image/unbuildable.py (+11, -3)
docker/base/Dockerfile.j2 (+2, -0)
docker/base/frr.repo (+11, -0)
docker/frr/Dockerfile.j2 (+33, -0)
",-1.53546,1.185952,-0.149949,0.684727,0.032384,-0.774652,0.359313,0.745479,-0.178059,-0.211681,0.154409,0.466259,-0.022257,-0.208871,-0.094637
openstack/kolla-ansible,I4fde95dccd036e371239e21596c05ecfd5342270,0,0,0.0,6.5876,0.0041,48,12.0,939,0,Feature,0,0,0,1,0.004184,0.8333,0,0.0,6,6,0,0.8054,4.8873,3.62,29.69,16.13,1,0,0.0138,1,1.2934,0,0,0,0,0,"WIP: Add ovn-bgp-agent / FRR / neutron-bgpvpn / Horizon BGPVPN dashboard support

ovn-bgp-agent [1] is a new component that exposes VMs/containers through BGP on OVN environments.

This change extends kolla-ansible to deploy ovn-bgp-agent and FRR, as this is a requirement for
ovn-bgp-agent.
The neutron-server is extended to be able to enable the networking-bgpvpn plugin.
The openvswitch deployment is modified to allow for br-ex without connected physical ports as
the traffic is routed instead.
Furthermore, it also extends the horizon integration to enable the BGPVPN dashboard plugin,
that is also required for certain scenarios with ovn-bgp-agent.

This change is part of a set of changes in several projects that are nessecary to fully
implement ovn-bgp-agent.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/891617

[1] https://opendev.org/openstack/ovn-bgp-agent
[SEP]
FILES CHANGED:
ansible/roles/ovn-bgp-agent/templates/bgp-agent.conf.j2 (+19, -0)
ansible/roles/horizon/defaults/main.yml (+1, -0)
ansible/roles/common/templates/conf/input/13-ovn-bgp-agent.conf.j2 (+15, -0)
README.rst (+1, -0)
ansible/site.yml (+30, -0)
ansible/roles/ovn-bgp-agent/tasks/main.yml (+2, -0)
ansible/roles/ovn-bgp-agent/vars/main.yml (+6, -0)
ansible/roles/common/templates/cron-logrotate-frr.conf.j2 (+3, -0)
ansible/roles/frr/tasks/deploy.yml (+9, -0)
ansible/roles/frr/defaults/main.yml (+46, -0)
ansible/roles/ovn-bgp-agent/tasks/upgrade.yml (+9, -0)
ansible/roles/ovn-bgp-agent/tasks/pull.yml (+3, -0)
etc/kolla/globals.yml (+16, -0)
ansible/roles/frr/tasks/check-containers.yml (+18, -0)
ansible/roles/frr/templates/start-frr.j2 (+18, -0)
ansible/roles/frr/vars/main.yml (+2, -0)
ansible/roles/common/tasks/config.yml (+5, -0)
ansible/roles/frr/tasks/upgrade.yml (+9, -0)
ansible/roles/ovn-bgp-agent/tasks/config-host.yml (+41, -0)
ansible/roles/frr/tasks/config-host.yml (+22, -0)
ansible/roles/frr/tasks/pull.yml (+3, -0)
ansible/roles/ovn-bgp-agent/handlers/main.yml (+17, -0)
tests/templates/inventory.j2 (+8, -0)
ansible/roles/common/templates/conf/input/14-frr.conf.j2 (+15, -0)
ansible/roles/frr/handlers/main.yml (+17, -0)
ansible/inventory/multinode (+8, -0)
ansible/roles/neutron/defaults/main.yml (+4, -0)
ansible/roles/ovn-bgp-agent/tasks/precheck.yml (+20, -0)
ansible/inventory/all-in-one (+8, -0)
ansible/roles/frr/tasks/config.yml (+95, -0)
ansible/roles/frr/tasks/precheck.yml (+15, -0)
releasenotes/notes/add-ovn-bgp-agent-frr-965eacdacab95c0d.yaml (+19, -0)
ansible/roles/ovn-bgp-agent/tasks/deploy.yml (+9, -0)
ansible/roles/frr/tasks/main.yml (+2, -0)
tests/setup_gate.sh (+1, -1)
ansible/roles/ovn-bgp-agent/defaults/main.yml (+48, -0)
ansible/roles/ovn-bgp-agent/tasks/stop.yml (+6, -0)
ansible/roles/ovn-bgp-agent/tasks/check-containers.yml (+18, -0)
ansible/roles/ovn-bgp-agent/templates/ovn_bgp_agent.json.j2 (+23, -0)
ansible/roles/openvswitch/tasks/post-config.yml (+3, -2)
ansible/roles/ovn-bgp-agent/tasks/reconfigure.yml (+2, -0)
ansible/roles/frr/tasks/reconfigure.yml (+2, -0)
ansible/group_vars/all.yml (+11, -0)
ansible/roles/frr/tasks/deploy-containers.yml (+2, -0)
ansible/roles/frr/tasks/stop.yml (+6, -0)
ansible/roles/ovn-bgp-agent/tasks/config.yml (+43, -0)
ansible/roles/ovn-bgp-agent/tasks/deploy-containers.yml (+2, -0)
ansible/roles/frr/templates/frr.json.j2 (+40, -0)
",-2.981704,1.89027,2.295431,-0.081064,-0.252965,-0.40647,0.213704,0.431068,-0.082431,-0.532026,-0.011395,0.664746,-0.14494,-0.318511,0.120481
openstack/charm-ceph-mon,Ie86f007d76fe75cc07cf7a973eff3f535a11dbe7,1,1,0.6,3.8712,0.5957,1,16.33,363,0,Bug Fix,0,0,0,5,0.003751,1.0,0,0.6,1,1,0,0.9545,0.0,1.0,34.87,13.88,1,0,0.0,0,7.5625,0,12,0,3,0,"Return previous result of processed broker requests

Instead of returning an empty dict for already processed
broker requests, store the result and return it. This works
around issues in charms like ceph-fs that spin indefinitely
waiting for the response to a request that never arrives.

Closes-Bug: #2031414
[SEP]
FILES CHANGED:
src/ceph_client.py (+19, -28)
",-0.192738,-1.66178,-0.428785,0.222158,-0.161433,0.224489,-0.209242,-0.500269,0.13204,-0.125416,-0.263735,-0.148374,0.394976,0.038243,0.111773
openstack/openstack-ansible,I247ce2a808076ff55347db54327a1e4913ea3006,1,1,0.9293,1.9459,0.5,3,15.67,369,0,Bug Fix,0,0,0,99,0.038566,1.0,0,0.9293,1,1,0,0.9219,1.585,1.0,23.53,16.48,0,0,0.0,0,52.7143,0,6,0,16,0,"Define install_method default when hosts resolution depend on it

In some playbooks we try to fetch openstack_service_setup_host based on
install_method variable. However, if variable is not defined,
and it is not by default, playbooks will run against localhost,
which will result in failure.

Closes-Bug: #2031647
[SEP]
FILES CHANGED:
playbooks/healthcheck-infrastructure.yml (+1, -1)
playbooks/os-keystone-install.yml (+1, -1)
playbooks/ceph-rgw-keystone-setup.yml (+1, -1)
",-0.60439,-1.752782,-0.373669,0.256885,-0.155052,-0.094066,-0.382617,-0.390677,0.251859,-0.199023,0.131534,-0.458181,-0.133311,0.06467,-0.200835
openstack/charm-guide,I2869b1b0e85eea99ecd8910896d501a179f938c2,1,1,1.0,0.0,0,1,7.6,309,0,Bug Fix,0,0,0,4,0.571429,0.0,0,0.0,3,1,0,1.0,0.0,3.0,34.37,12.51,1,0,0,0,309.0,0,6,0,4,0,"Update release cycle image

This PR is a follow-up to a recent PR that neglected
to include the new upstream naming scheme (SLURP).

This change will get backported to 2023.1

Closes-Bug: #2025354
[SEP]
FILES CHANGED:
doc/source/media/ubuntu-openstack-release-cycle.png (+0, -0)
",0.50616,-1.455284,-0.663908,-0.46668,-0.959116,0.729194,-0.344951,0.243526,0.047882,0.236072,-0.019728,0.292044,-0.245645,0.141281,0.346356
openstack/kolla-ansible,I5799f7a6fa4f52c2904b14fc02ed18443f4194bd,1,1,0.5,1.0986,0.5,1,11.2,495,0,Bug Fix,0,0,0,4,0.02649,1.0,0,0.5,4,1,0,0.8027,0.0,4.0,24.76,14.48,1,0,0.0,0,165.0,0,20,0,12,0,"Fixes WEBSSO_KEYSTONE_URL Value

Change I60162b54bc06e158534d29311d4474b34750c64d
removed the `/v3` prefix from the WEBSSO_KEYSTONE_URL
variable. However, keystone endpoints do in fact
have the `/v3` prefix, and Horizon expects the
WEBSSO_KEYSTONE_URL variable to already contain
the prefix.

This patch adds the prefix again so that SSO
works with Horizon again.

Closes-Bug: #2028921
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/local_settings.j2 (+1, -1)
",-2.133169,-0.132523,-0.368202,-0.327487,0.990772,0.32123,-0.808887,0.024837,0.007476,-0.089411,0.166254,-0.220728,-0.150442,0.136277,0.158808
openstack/octavia-lib,I9079030a5fef9dc44da242adab3c568666777451,1,1,0.5046,3.7842,0.1163,3,11.0,243,0,Bug Fix,0,0,0,109,0.004289,0.0,0,0.0,5,2,0,0.1111,1.3863,3.33,49.54,9.25,0,0,0.5116,1,5.5227,0,6,0,21,0,"Fix a possible receive timeout

This patch fixes a possible receive timeout caused by a slow response from the
driver agent. For example if the database is very slow.

Closes-Bug: #2032890
[SEP]
FILES CHANGED:
octavia_lib/api/drivers/driver_lib.py (+12, -4)
octavia_lib/tests/unit/api/drivers/test_driver_lib.py (+21, -1)
releasenotes/notes/Fix-possible-receive-timeout-error-f6d2454c48eb10cf.yaml (+5, -0)
",0.804166,-1.234413,-0.314419,-0.098868,-0.841601,0.96682,0.180191,-0.041572,0.723486,0.055035,0.244389,0.411773,0.151692,-0.205499,0.291537
openstack/openstack-ansible-os_glance,I755822089bf406f532a718db5b84df553cbc2084,1,1,0.93,1.0986,0.5,1,10.75,436,0,Bug Fix,0,0,0,100,0.038865,0.9167,0,0.8525,1,1,0,0.5,0.0,1.0,3.11,15.46,0,0,0.0,0,145.3333,0,6,0,20,0,"Use correct default for glance_mount_points

Back in Yoga we've refactored way of mounting remote filesystems
for glance while keeping backwards compatibiltiy [1]

However, there was a copy/paste error made while defining
glance_mount_points with old format of glance_nfs_client.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_glance/+/837550

Closes-Bug: #2032771
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",-1.218011,0.308507,-0.159338,-0.214609,-0.557988,-0.277574,0.215856,0.287322,-0.017496,-0.029295,0.209662,-0.453811,-0.093225,-0.475752,0.323832
openstack/openstack-ansible,If99ddc47d32acf41cdb542b4e56d90b6e3589a56,1,0,0.9307,1.9459,0.1667,2,19.67,381,0,CI,0,0,0,101,0.039223,0.0,0,0.0,2,2,0,0.9231,0.65,2.0,46.35,14.65,0,0,0.0,1,54.4286,0,0,0,0,0,"Do not add all computes as OVN gateways

At the moment all compute nodes are explicitly added as
OVN gateway nodes. At the same time one of recommended setups
are to not pass public networks to compute hosts and have
standalone network nodes that are running ovn gateways which is
not possible to configure with current setup.
[SEP]
FILES CHANGED:
inventory/env.d/nova.yml (+0, -1)
releasenotes/notes/ovn_gateway_computes-a9509fd25e8d25db.yaml (+5, -0)
",-0.030075,-2.167735,0.078447,1.242695,0.205637,-0.534682,0.393334,0.25396,-0.135538,0.240902,-0.548738,0.44823,0.222979,-0.28398,-0.18077
openstack/kolla-ansible,Ief8dca4e27197c9576e215cbd960da75f6fdc20c,1,1,1.0,0.6931,1.0,1,13.25,465,0,Bug Fix,0,0,0,1,0.012048,0.6667,0,0.6667,4,1,0,0.8033,0.0,4.0,5.03,15.87,0,0,0.0,0,232.5,0,8,0,25,0,"Fix designate-producers not running properly

Kolla is setting the producer tasks to None, and this
disables all producer tasks.

Starting with the next release of Designate a new task
was added to the producer named increment_serial that
is now critical path for incrementing the serial for each zone.
https://github.com/openstack/designate/commit/fb9c2da977a36afc695b1e75a81aa85d8e56ef0a

Closes-Bug: #1879557
[SEP]
FILES CHANGED:
ansible/roles/designate/templates/designate.conf.j2 (+0, -1)
",-1.581804,0.089966,-0.625298,-0.538068,0.149353,0.248429,0.722712,-0.028813,0.458198,0.287949,0.151954,-0.111379,0.217787,0.009823,0.157572
openstack/charm-manila-ganesha,Ic6dc3887bc3ca31e32acf81f7a0b6e6e3e73ba1c,1,1,1.0,2.4849,0.0,1,16.0,479,0,Bug Fix,0,0,0,6,0.013575,1.0,0,1.0,1,1,0,1.0,0.0,1.0,13.46,18.28,1,0,0.0,1,39.9167,0,6,0,3,0,"Don't expose no-op options for OpenStack API service

Manila-ganesha inherits layer:openstack-api on purpose to configure the
manila-share and related services, but the units won't have OpenStack
API endpoints by nature. We already have some config options excluded in
layers.yaml but we should extend the list to exclude more no-op options
related to OpenStack APIs so we can avoid confusing operators.

Closes-Bug: #2032869
[SEP]
FILES CHANGED:
src/layer.yaml (+11, -0)
",-0.439554,-1.12234,0.011151,0.295288,-0.336607,-0.687193,0.311901,0.134865,-0.420889,-0.175906,0.193051,-0.145729,0.396117,-0.213146,0.217308
openstack/charm-ceph-fs,I4b117272f68a27732809d0dddc31ac9cf69c60d9,1,0,1.0,0.6931,0.0,1,17.75,507,0,Doc,0,0,0,5,0.714286,1.0,0,1.0,1,1,0,0,0.0,1.0,56.56,12.73,1,0,0.0,1,253.5,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.

(cherry picked from commit 4210d634e7169a0c499eecd49b0f4825f28de81e)
[SEP]
FILES CHANGED:
src/metadata.yaml (+1, -0)
",-1.683677,-1.056085,-0.045239,-0.417946,0.430665,0.251712,0.651039,-0.061529,0.59804,0.029219,0.289786,0.370394,-0.150546,0.288548,-0.511409
openstack/kolla-ansible,Id8bf642a57b54ecafe0ee6981e044b1aba872ef7,1,0,0.8824,1.0986,1.0,1,6.75,314,0,Bug Fix,0,0,0,34,0.031835,0.6667,0,0.5882,4,1,0,0.804,0.0,4.0,-38.15,23.44,1,0,0.0,0,104.6667,1,0,0,0,0,"Drop useless DUMMY_ENVIRONMENT environment for cron container

Since I033c51704bfb806f6515db26b8159fae12469ba5 the DUMMY_ENVIRONMENT
environment for cron container is useless, lets drop it.

Trivial-Fix
[SEP]
FILES CHANGED:
ansible/roles/common/defaults/main.yml (+0, -2)
",-1.478322,-0.096164,-1.910758,-0.476535,1.824183,0.319025,-0.58624,-0.4902,-0.045002,-0.069217,-0.069703,0.187848,-0.054036,-0.093312,0.159229
openstack/kolla-ansible,Iae8a937bb2c35d2eb83e2c4522d829a6cfe25f0d,1,1,0.6,2.0794,0.1429,2,14.6,493,0,Bug Fix,0,0,0,5,0.03268,0.0,0,0.0,4,2,0,0.8046,0.8631,3.0,44.84,13.51,1,0,0.0,1,61.625,0,14,0,13,0,"Fixes task name in notify module to the actual task name

An OVS-DPDK task had part of its name capitalized,
presumably due to the newly added ansible linter,
but this change was not reflected in the notify
module which calls the task. This results in an
inability to deploy openstack with OVS-DPDK.

This commit fixes the name of the task in the
notify module.

Closes-Bug: #2033413
[SEP]
FILES CHANGED:
releasenotes/notes/ovs-dpdk-task-name-bugfix-099b386886a40236.yaml (+5, -0)
ansible/roles/ovs-dpdk/handlers/main.yml (+1, -1)
",-0.799698,-1.689057,0.173396,0.375965,-0.318141,-0.030027,0.050531,0.182047,0.058011,0.074216,0.308772,0.207247,0.066818,0.258527,0.079372
openstack/openstack-ansible,I3ac3bfce67bc614c72dec0a6a57a7df7717e0e8e,1,0,0.8333,1.0986,0.5,1,10.0,217,0,Bug Fix,0,0,0,24,0.210526,1.0,0,0.8333,2,1,0,0.9242,0.0,2.0,52.87,13.33,0,0,0.0,0,72.3333,0,0,0,0,0,"Fix container bridge name for octavia

This should be br-lbaas not br-octavia. There is no coverage for
this in CI tests as the role tests run without containers.
[SEP]
FILES CHANGED:
etc/openstack_deploy/openstack_user_config.yml.aio.j2 (+1, -1)
",0.816777,-0.354339,-0.63857,0.331426,0.075336,-0.084713,0.287303,-0.352005,-0.687295,-0.285956,0.315231,0.293914,0.112106,-0.122845,-0.194568
openstack/charm-ceph-dashboard,I2f4d4dfa890fc79f7f5d5b1273a11907b60e8255,1,1,1.0,2.9444,0.1111,1,4.33,187,0,Bug Fix,0,0,0,2,0.033898,0.9,0,0.9,1,1,0,1.0,0.0,1.0,-70.89,23.27,1,0,0.0,0,9.8421,0,20,0,15,0,"Adds dashboard enablement/deferral logic improvements

Closes-Bug: 2033886
[SEP]
FILES CHANGED:
src/charm.py (+16, -2)
",2.754826,-0.170767,0.257557,-1.006763,-0.390674,0.805567,-0.054493,0.256737,0.475715,-0.42407,0.156683,0.150806,0.23523,-0.732435,0.291358
openstack/charm-ceph-proxy,I782890f44628a634c7adcf9cdace753c62d6c262,1,0,1.0,6.0913,0.9932,4,14.6,591,0,Doc,0,0,0,6,0.75,1.0,0,1.0,2,1,0,0,1.1799,1.0,41.36,11.87,1,0,0.9683,1,1.3371,0,0,0,0,0,"Add docs key and point at Discourse

Add the 'docs' key and point it at a Discourse topic
previously populated with the charm's README contents.

When the new charm revision is released to the Charmhub,
this Discourse-based content will be displayed there. In
the absense of the this new key, the Charmhub's default
behaviour is to display the value of the charm's
'description' key.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1108

(cherry picked from commit 9abe25f182cbb307aeb3d828e59fb26afb499334)
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+0, -199)
osci.yaml (+2, -11)
tests/bundles/kinetic-zed-ec.yaml (+0, -228)
metadata.yaml (+1, -0)
",-2.183087,0.21819,0.251083,-0.592922,0.182528,0.104069,0.354585,-0.073507,0.378076,-0.291784,0.111807,0.425745,-0.214334,0.144885,-0.395009
openstack/openstack-ansible-os_nova,Id2da29464359b4845c7d05e3bec53759341f4bad,1,0,0.8,2.8904,0.3529,3,3.0,248,0,Doc,0,0,0,5,0.1,1.0,0,0.8,2,3,0,1.0,1.5486,1.33,-33.9,12.63,1,0,0.0,1,13.7778,0,0,0,0,0,"Config has changed for pci passthrough.

updating the config for pci devices since the old config is deprecated.
https://docs.openstack.org/nova/latest/configuration/config.html#pci.device_spec
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+3, -3)
releasenotes/notes/nova_device_spec-0175a30b2295b768.yaml (+4, -0)
defaults/main.yml (+4, -3)
",0.015364,2.172769,-1.089533,1.037448,-0.592723,0.149558,0.783522,0.019119,0.365322,-0.465376,-0.914303,-0.197659,-0.383935,-0.277745,0.098904
openstack/openstack-ansible-os_neutron,Ia5b44729858dd9f742f1094f46e3cde1ceb70495,1,0,0.9314,1.0986,0.5,1,11.33,306,0,Bug Fix,0,0,0,102,0.03952,1.0,0,0.9314,1,1,0,0.9,0.0,1.0,16.18,18.65,0,0,0.0,0,102.0,0,0,0,0,0,"Fix typo for  vpnaas_custom_config distribution

Accidentally condition was to check a group against `group_name`,
while this should be `group_names`. Right now in case of definition
neutron_vpnaas_custom_config role will fail with undefined variable.
[SEP]
FILES CHANGED:
tasks/neutron_post_install.yml (+1, -1)
",-0.370313,-1.1934,-0.223177,0.17034,0.570823,0.093653,-0.822533,-0.454256,0.061765,-0.524514,-0.121573,-0.54102,-0.704664,-0.02526,-0.110823
openstack/octavia,Icf607cc9b00926b437c51c426ab5c994d79b6e45,1,0,1.0,1.3863,0.3333,1,9.0,170,0,Bug Fix,0,0,0,8,0.08,0.75,0,0.75,2,1,0,0.6037,0.0,2.0,14.4,16.93,0,0,0.0,0,42.5,0,0,0,0,0,"Fix remaining usage of [neutron] endpoint_type

This option was deprecated in favor of the valid_interfaces option.
[SEP]
FILES CHANGED:
octavia/common/clients.py (+2, -1)
",0.910069,0.173485,-0.515726,1.024464,0.393167,0.471473,-0.446329,-0.253269,0.154547,-0.034854,0.379388,0.249662,-0.858396,-0.409597,-0.299117
openstack/charm-magnum,I4cd2765e179af7b4b7237b5f1830a7bbd0ca2bc0,0,1,0.8421,2.4849,0.0,2,12.5,420,1,Bug Fix,0,0,0,19,0.02402,1.0,0,0.8421,3,2,0,1.0,0.4395,2.0,26.64,12.2,1,0,0.0,1,35.0,0,6,0,21,0,"Add cluster-user-trust config option

Clusters created with the option cloud_provider_enabled, volume_driver
and/or registry_enabled set to true need this flag set to True as well
to instruct Magnum to assign trust to the cluster user.

This option defaults to False due to security concerns (see
https://bugs.launchpad.net/bugs/cve/2016-7404 )

Closes-Bug: #1996237
[SEP]
FILES CHANGED:
src/config.yaml (+10, -0)
src/templates/ussuri/magnum.conf (+1, -0)
",-1.071897,0.094884,-0.498677,0.596081,-0.135368,-0.030669,-0.174548,-0.177837,0.335967,0.336038,-0.042462,-0.43846,0.401304,0.079414,-0.168987
openstack/openstack-ansible-lxc_container_create,I5307fe00a8cf875b622f8b077242596648d52182,1,0,0.932,2.1972,0.0,1,7.0,92,0,Feature,0,0,0,103,0.039876,1.0,0,0.932,1,1,0,0,0.0,1.0,-5.73,25.66,0,0,0.0,0,10.2222,0,0,0,0,0,"Properly apply tags for include_tasks
[SEP]
FILES CHANGED:
tasks/main.yml (+8, -0)
",2.5603,0.871841,1.156381,0.789571,0.914161,0.141618,-0.250976,-0.789648,0.668584,-0.037776,0.127893,-0.352625,-0.109138,-0.302791,0.136298
openstack/kolla-ansible,If8648d8e85ab3dbcbb4ecba674b2e34b06898327,1,1,1.0,1.9459,0.0,2,15.0,273,0,Bug Fix,0,0,0,5,0.119048,0.0,0,0.0,4,2,0,0.8053,0.65,3.0,-22.71,22.0,0,0,0.0,1,39.0,0,6,0,3,0,"Support customising Nova config at the individual service level

For example, an operator may wish to customise the
nova-compute-ironic service configuration without affecting
other Nova services.

Closes-Bug: #2034949
[SEP]
FILES CHANGED:
releasenotes/notes/support-customising-nova-service-config-26af64a9e03f1d4c.yaml (+5, -0)
ansible/roles/nova-cell/tasks/config.yml (+1, -0)
",0.790128,-0.636289,-0.417682,0.557161,-0.018128,0.270871,-0.246859,0.123866,0.315133,-0.482085,-0.2953,0.619026,0.251246,-0.223234,0.180435
openstack/openstack-ansible-os_keystone,Ic9d37a8463d137508d20de20b10af806a223f852,1,0,1.0,4.7449,0.0,3,7.86,393,0,Bug Fix,0,0,0,24,0.120603,1.0,0,1.0,2,3,0,1.0,0.4336,1.33,43.5,11.87,0,0,0.0,1,3.4174,0,0,0,0,0,"oidc: fix recognition of x forwarded headers from v2.4.11

The Apache mod_auth_openidc requires explicit configuration in
order to read the X-Forwarded-Proto from the reverse proxy as
of version v2.4.11 which comes in from Ubuntu Jammy.

Eventually this will need to become the default and the
variable added in this patch can be removed.
[SEP]
FILES CHANGED:
templates/keystone-httpd.conf.j2 (+3, -0)
vars/ubuntu-22.04.yml (+106, -0)
releasenotes/notes/keystone-oidc-forwarded-proto-92471121e3949428.yaml (+5, -0)
",-0.072142,-1.209508,-0.068251,0.278993,-0.520907,0.063936,0.280347,0.438924,0.144902,0.698539,-0.002839,0.068675,-0.472607,0.112671,0.227341
openstack/kayobe,If62fe0db3c107c52f80a481aa267335224456064,1,0,0.9348,2.5649,0.5,2,4.2,230,0,Feature,0,0,0,46,0.066474,1.0,0,0.9348,4,2,0,0.9438,0.9183,4.0,1.14,15.01,1,0,0.3333,0,17.6923,0,0,0,0,0,"Complete Skydive removal and Skyline addition

Some mentions of skydive were forgotten in the original change [1].

[1] https://review.opendev.org/c/openstack/kayobe/+/884471.
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/kolla (+4, -4)
ansible/roles/kolla-ansible/tests/test-extras.yml (+2, -2)
",-0.204827,1.70573,-1.312726,0.011063,-1.132262,0.446447,0.156601,0.117685,0.008496,0.017294,-0.301545,-0.139803,-0.221911,-0.167989,-0.472357
openstack/kayobe,I9dd5b97dec93c0e5393a1e7d9640f85003651b56,1,1,0.9362,3.3322,0.0,2,8.92,806,0,Bug Fix,0,0,0,47,0.066761,1.0,0,0.9362,2,2,0,0.9444,0.6913,1.5,30.96,11.79,1,0,0.0,1,28.7857,0,16,0,21,0,"Fix data file path detection with new pip

Using an editable installation of Kayobe fails on Rocky Linux 9 or
Ubuntu with an error such as:

    ERROR! The requirements file '/home/rocky/kayobe/kayobe/requirements.yml' does not exist.
    Failed to install Ansible roles from /home/rocky/kayobe/kayobe/utils.py/../requirements.yml via Ansible Galaxy: returncode 1
    Control host bootstrap failed - likely Ansible Galaxy flakiness. Sleeping 5 seconds before retrying

This is caused by recent changes to how pip manages editable
installations. The egg-link file that Kayobe was using to find the
source path does not exist anymore. Instead, there is a direct_url.json
file under the kayobe dist-info directory that can be parsed.

Closes-Bug: #2020135
[SEP]
FILES CHANGED:
releasenotes/notes/editable-install-data-file-path-743b7a85a5f5db6d.yaml (+5, -0)
kayobe/utils.py (+22, -0)
",-2.602897,0.34057,1.177482,-0.076029,-0.285609,-0.09603,0.482277,0.372599,-0.159595,-0.232724,0.485964,-0.315298,0.100695,0.067572,0.055843
openstack/openstack-ansible-os_neutron,I7a63a79e8b9012c9f32b9316d9590ccd9e641c01,1,0,1.0,1.3863,0.3333,1,13.5,224,0,Bug Fix,0,0,0,25,0.079872,1.0,0,1.0,1,1,0,0.9091,0.0,1.0,33.33,14.29,0,0,0.0,0,56.0,0,0,0,0,0,"Fix conditional for non-OVN deployments

In an LXB environment, the neutron_ovn_controller group still
contains all of the compute nodes, which causes this task to
fail.
[SEP]
FILES CHANGED:
tasks/neutron_post_install.yml (+2, -1)
",0.250324,-1.435986,-0.111137,0.17391,0.109555,-2.8e-05,-0.512388,-0.39778,-0.211609,-0.457486,-0.196814,0.567319,-0.104406,0.116015,-0.218967
openstack/kolla-ansible,Icd058af7af6ef04d865aff82f0d8f7a743298b07,1,0,0,1.0986,0.5,1,9.0,97,0,Feature,0,0,0,0,0.0,0.3333,1,0.0,0,1,0,0.8059,0.0,0.0,9.7,16.93,1,0,0.0,0,32.3333,0,0,0,0,0,"README: link to the meetings page directly
[SEP]
FILES CHANGED:
README.rst (+1, -1)
",2.769116,1.040581,1.419967,0.510752,-0.181918,0.761387,0.461097,-0.676001,-0.207906,-0.220101,0.44392,-0.194084,0.142205,-0.044504,-0.195512
openstack/octavia,I453ff385620f488a3e43d4fda01634cdce3be5d4,1,1,0.7447,2.6391,0.0769,2,22.25,556,0,Bug Fix,0,0,0,94,0.008022,0.375,0,0.2793,4,2,0,0.6049,0.9957,3.0,50.22,14.29,0,0,0.0,1,39.7143,0,6,0,22,0,"Fix race condition in members batch update API call

Fix a potential race condition, the member batch update API call
computes a delta between the current state of the members in the DB and
the members in the requests. But it fetches the members from the DB
before locking the load balancer, it means that another Octavia service
may still update the list of members, then the computation of the
changes may be incorrect.

The list of members is now queried in the locked section.

Closes-Bug: #2036156
[SEP]
FILES CHANGED:
octavia/api/v2/controllers/member.py (+5, -1)
releasenotes/notes/fix-race-condition-member-batch-update-1aed0e06004c5dad.yaml (+7, -0)
",-0.904803,-1.983508,0.871018,0.494235,-0.327613,-0.090797,0.410635,-0.052685,0.343227,0.129373,0.169619,-0.051779,0.091137,0.412868,-0.016034
openstack/ironic,Icefd96d6873474b4cfb7fbf3d8337cd42fd63ca6,1,1,1.0,3.2581,0.12,4,7.0,362,0,Bug Fix,0,0,0,2,0.03125,1.0,0,1.0,6,1,0,0.9457,1.9133,4.0,32.54,12.32,1,0,0.56,0,13.9231,0,6,0,19,0,"redfish_address - wrap_ipv6 address

When parsing redfish driver info wrap IPv6 address in brackets
before appending default scheme/authority.

Updated common.utils.wrap_ipv6() to ignore ValueError, e.g
simply return the string if ip is not an ipv6 address string.

Related: RHBZ#2239356
Closes-Bug: #2036454
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/utils.py (+2, -1)
ironic/tests/unit/common/test_utils.py (+6, -0)
ironic/common/utils.py (+6, -2)
ironic/tests/unit/drivers/modules/redfish/test_utils.py (+8, -0)
",-0.272664,-0.737788,-0.367144,0.020922,-0.062399,0.061193,-0.102523,0.121501,0.631585,-0.131021,0.311742,-0.66061,0.109179,0.015019,-0.177862
openstack/oslo.db,Ia6821ee0099dabcfa76c5b3ed5bca4728d145141,1,0,1.0,1.3863,0.3333,2,9.67,268,0,Doc,0,0,1,7,0.008055,0.3462,1,0.3462,1,1,0,0.3333,0.9183,0.5,7.4,16.28,1,1,0.0,0,67.0,0,0,0,0,0,"[stable-only] Move sqlalchemy-migrate to doc requirements

Since we don't have unit tests for this stuff, this is only needed for
building documentation now.
[SEP]
FILES CHANGED:
requirements.txt (+0, -1)
doc/requirements.txt (+2, -0)
",1.772641,-0.797681,-0.161011,0.227419,-0.66892,-0.21834,0.254248,-0.460317,-0.787191,0.244056,-0.298166,0.361271,-0.366209,-0.242606,0.021335
openstack/charm-ceph-dashboard,I9993b8d8bc55fa1b4c7d61931bfdb6ee4ee3c7b4,1,0,1.0,1.7918,1.0,1,5.4,309,0,CI,0,0,0,15,0.006242,0.5658,0,0.5658,0,1,0,1.0,0.0,0.0,-30.51,14.01,1,0,0.0,1,51.5,0,0,0,0,0,"Remove unused tox target

The func-dev target is unused and indeed fails since we don't define
any dev bundles.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1137
[SEP]
FILES CHANGED:
tox.ini (+0, -5)
",-0.283594,1.717371,-1.460071,0.309284,-0.614116,-0.353504,-0.181728,-0.40409,-0.39665,-0.442293,-0.443324,0.072766,0.126578,0.073136,0.191946
openstack/charm-ceph-dashboard,I71e01b556771a46d531e1d9029088730471d4e2a,0,0,1.0,7.6473,0.0029,5,11.0,219,0,Feature,0,0,0,16,0.006645,1.0,0,1.0,4,3,0,1.0,0.2815,1.2,-8.14,22.58,1,0,0.011,1,0.1045,0,0,0,0,0,"COS-Lite support

Support integration with COS lite grafana via a new relation
grafana-k8s-dashboard relation implemented through the grafana_k8s
dashboard library.
[SEP]
FILES CHANGED:
lib/charms/grafana_k8s/v0/grafana_dashboard.py (+2013, -0)
.gitignore (+0, -2)
src/charm.py (+51, -3)
metadata.yaml (+2, -0)
unit_tests/test_ceph_dashboard_charm.py (+22, -1)
",-0.24936,0.063088,-0.982006,0.359721,1.084399,-0.898334,-0.561819,0.983091,-0.311058,-1.017789,-0.302681,1.046062,-0.14238,0.042143,0.236002
openstack/kolla-ansible,I986c5192fe96b9c480a2d8fa87d719a50ce78186,1,0,0.5,3.9318,0.04,4,10.0,605,0,Feature,0,0,0,6,0.06,0.0,0,0.0,4,3,0,0.8066,1.7029,3.5,0.9,14.29,1,0,0.0,1,11.8627,0,0,0,0,0,"magnum: support kubeconfig configuration file

If a file {{ node_custom_config }}/magnum/kubeconfig exists, it is
copied to /var/lib/magnum/.kube/config in all Magnum Service Containers.
At this location, the vexxhost/magnum-cluster-api will loo for the Kubeconfig
configuration file to control the Cluster API Control Plane. If the
vexxhost/magnum-cluster-api is installed in the Magnum container images,
control of a cluster API control plane can then take place via the Magnum API.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/902101
[SEP]
FILES CHANGED:
ansible/roles/magnum/templates/magnum-api.json.j2 (+8, -1)
releasenotes/notes/magnum-kubeconfig-71934a2980c7e74f.yaml (+5, -0)
ansible/roles/magnum/tasks/config.yml (+27, -0)
ansible/roles/magnum/templates/magnum-conductor.json.j2 (+8, -1)
",-2.491342,1.590477,0.345274,0.396394,0.197226,-0.541312,0.35132,0.621472,0.030581,-0.690406,-0.021959,0.233946,-0.524862,-0.031908,-0.012271
openstack/charm-ops-interface-ceph-client,I5fff482e849b0d47ebc9b759a1559ccbad73af4d,1,0,0,3.0445,0.0,2,7.83,367,0,CI,0,0,0,0,0.0,0.5714,0,0.0,1,2,0,0,0.8113,0.5,42.28,9.09,1,0,0.0,1,17.4762,0,0,0,0,0,"Update stored state

In a k8s deployment the stored state is lost when a pod is
refreshed. When this happens the charm reports it is not ready
this is because the pools_available state has been lost. This
patch updates the stored state.

Tested here:
https://review.opendev.org/q/topic:test-ceph-client-interface
[SEP]
FILES CHANGED:
tox.ini (+5, -0)
interface_ceph_client/ceph_client.py (+15, -0)
",-0.908094,0.385588,-0.53463,0.547885,-0.912706,0.033103,0.3884,-0.544431,0.368007,0.089791,0.059492,-0.027053,-0.101776,0.362158,-0.006998
openstack/python-magnumclient,Ia11d9e1ba20dbb37cd6467c2ae0555ddf25df5d3,1,1,0,1.0986,0.5,1,8.0,223,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,1.0,0.0,3.0,25.99,16.53,1,0,0.0,0,74.3333,0,6,0,3,0,"Bugfix: master_lb_enabled flag now works as intended.

The value for master_lb_enabled resulted in it being treated the
same as master_lb_disabled.

Closes-Bug: #2039040
[SEP]
FILES CHANGED:
magnumclient/osc/v1/clusters.py (+1, -1)
",-0.621787,-0.331008,-0.793132,0.233996,0.429696,0.838783,-1.341962,-0.711718,0.275117,-0.06712,0.392987,-0.131593,-0.347651,-0.158176,0.399868
openstack/octavia,I1dd3227e8f06b4e2b1888614979c97fd116f6a31,0,0,0,2.1972,1.0,1,5.0,75,0,Feature,0,0,1,0,0.0,0.0,0,0.0,0,1,0,0.6062,0.0,0.0,-1.28,18.0,0,0,0.0,0,8.3333,0,0,0,0,0,"Cleanup py27 support
[SEP]
FILES CHANGED:
setup.py (+0, -8)
",3.283344,2.414516,2.514962,0.105713,0.632947,1.380983,0.307911,-0.477222,-0.166327,-0.132355,-0.026076,-0.079476,0.406861,0.027297,1.273638
openstack/openstack-ansible-haproxy_server,If1b6d6e46a4b2941198b0f57c858d415fbbdc8d1,1,0,0.9327,2.0794,0.0,1,15.0,229,0,CI,0,0,0,104,0.040139,1.0,0,0.9327,1,1,0,0.875,0.0,1.0,33.69,16.67,0,0,0.0,0,28.625,0,0,0,0,0,"Add tags to PKI include

When rotating certificates for HAProxy it's quite neat to have
tags that will allow to run specifically certificate rotation without
any extra steps.
[SEP]
FILES CHANGED:
tasks/main.yml (+7, -0)
",0.883496,-2.179612,-0.115334,0.505528,-0.035586,0.097957,-0.497662,-0.55776,-0.450823,0.303172,-0.829709,-0.097297,0.046145,-0.408396,-0.308889
openstack/charm-ceph-dashboard,I2ad140b23a5d3e2e078d923afd039c4c904e0652,1,1,0.9412,6.9007,0.2923,11,12.5,405,0,Bug Fix,0,0,0,17,0.003776,1.0,0,0.9412,2,2,0,0.9,1.6645,1.64,26.64,14.6,1,0,0.1139,1,0.4079,0,38,0,19,0,"Fixes SSL conflicts between relation and config data.

The fix adds event based handling of SSL configuration using charm
config and cleanup of SSL for relation and config based key/certs.
It also adds logical abstractions to analyse SSL setup and emit
relevant events.

Closes-Bug: 1952282
Cherry-pick from: Ic486434526f639f5985cfe355e303c1d6ff5fa0d
[SEP]
FILES CHANGED:
tests/bundles/kinetic-zed.yaml (+1, -1)
src/charm_option.py (+108, -0)
tests/bundles/lunar-antelope.yaml (+4, -2)
tests/bundles/focal-yoga.yaml (+1, -1)
tests/bundles/focal.yaml (+1, -1)
tests/bundles/jammy-antelope.yaml (+1, -1)
src/charm.py (+371, -248)
src/ceph_dashboard_commands.py (+152, -0)
tests/bundles/jammy-yoga.yaml (+1, -1)
unit_tests/test_ceph_dashboard_charm.py (+61, -34)
tests/bundles/jammy-zed.yaml (+1, -1)
",-0.821331,-1.052161,-0.736137,-0.785273,0.649334,-0.264267,0.808752,0.269444,0.585461,0.135833,-0.015809,-0.50373,0.724389,-0.250442,0.035627
openstack/charm-interface-hacluster,I12c561057372c11632b2d97fa1763fc92d89f479,1,1,1.0,1.6094,0.5,1,8.14,405,0,Bug Fix,0,0,0,4,0.025478,0.0,0,0.0,1,1,0,0,0.0,1.0,53.12,11.68,1,0,0.0,0,81.0,0,8,0,3,0,"Use the passed arguments in remove_dnsha

This appears to be a typo, where self.service_name and self.endpoint_type
was used in the same way as seen in other methods,
but self.service_name or self.endpoint_type is not defined in this class,
or any subclasses of it.
So we can use the passed name and endpoint_type arguments here.

Closes-Bug: #2037515
[SEP]
FILES CHANGED:
interface_hacluster/common.py (+2, -2)
",-1.083132,-0.415071,-0.147523,1.050457,0.020413,0.222521,-0.040343,-0.696933,0.333436,0.141678,0.149461,-0.087398,-0.027877,0.52906,0.167255
openstack/openstack-ansible,I4e72e81d05d8d70e76730a46687dd06f3e66ebc6,1,0,0.9333,2.1972,0.0,1,9.71,481,0,Feature,0,0,0,105,0.040416,1.0,0,0.9333,1,1,0,0.9254,0.0,1.0,40.22,14.47,0,0,0.0,0,53.4444,0,0,0,0,0,"Gather extra networking facts for keepalived

By default keepalived pingable check tries to verify the gateway which
in it's turn requires to have appropriate facts defined.

At the moment re-running haproxy playbook as a standalone instance
when facts are outdated will lead to re-configuration of keepalived
to check 127.0.0.1 as a track script.

So we gather extra network facts to identify the gateway for
pingable script.
[SEP]
FILES CHANGED:
playbooks/haproxy-install.yml (+8, -0)
",-0.842439,-1.827405,0.499895,0.539741,-0.006784,-0.208221,0.277382,-0.03207,0.008525,0.154123,-0.161198,-0.076499,-0.049494,-0.275919,0.063168
openstack/charm-ceph-osd,Id7de1723a4bbfcff02dd606be650b4410f897913,1,0,0.9444,5.7236,0.0689,8,10.25,298,0,CI,0,0,0,18,0.003276,1.0,0,0.9444,2,1,0,0.8889,1.3611,1.62,58.18,11.9,1,0,0.9607,1,0.9739,0,0,0,0,0,"Add upgrade func testing

Change functional testing to also test upgrades from charmhub version
to the locally built charm. Include a new test for installing a locally built charm from scratch.

Also pin some support charms to specific tracks.
[SEP]
FILES CHANGED:
tests/tests.yaml (+14, -2)
osci.yaml (+12, -0)
tests/bundles/lunar-antelope.yaml (+2, -1)
tests/bundles/focal-yoga.yaml (+9, -8)
tests/bundles/jammy-antelope.yaml (+2, -1)
tests/bundles/local-jammy-antelope.yaml (+234, -0)
tests/bundles/mantic-bobcat.yaml (+2, -1)
tests/bundles/jammy-bobcat.yaml (+9, -8)
",0.504997,-1.815094,0.032276,0.617295,0.071402,-0.013743,0.059542,0.084791,-0.121823,0.237218,-0.431368,0.282795,0.0716,0.299206,-0.224114
openstack/charm-manila,I436452208aaeaf08d1655da4fccbd7a89549b404,1,1,1.0,5.1059,0.189,7,11.5,640,0,Bug Fix,0,0,1,15,0.007092,0.4444,0,0.4444,4,3,0,1.0,1.3736,2.43,42.51,12.43,1,0,0.4451,1,3.8788,0,10,0,14,0,"Fix local/remote assumptions in manila charm

When the remote plugin was developed it made the assumption that the
`enabled_share_backends` included the remote backends. This assumption
is wrong, and it should only contain the locally defined drivers; i.e.
ones that have a [driver] section in the manila.conf file. The cephfsnfs
driver doesn't have a local configuration as the share-server is runs on
the manila-ganesha unit and so shouldn't be local.

This patch splits the config in local/remote and then uses the local and
remote config in the correct places.

Closes-Bug: #2012457
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -0)
src/templates/rocky/manila.conf (+1, -1)
src/templates/queens/manila.conf (+1, -1)
src/templates/mitaka/manila.conf (+1, -1)
src/templates/pike/manila.conf (+1, -1)
src/lib/charm/openstack/manila.py (+68, -15)
unit_tests/test_lib_charm_openstack_manila.py (+60, -12)
",-1.254203,-1.298516,0.82246,0.048777,-0.152937,-0.353169,0.05135,0.073398,-0.060145,-0.293964,0.223932,-0.015252,-0.201632,0.146914,0.006267
openstack/charm-guide,I6bb90762ad5cb5ca97ca311501b1ff7d3d9a3ccb,1,0,1.0,6.0426,0.5,30,9.4,624,0,Feature,0,0,0,7,0.01559,1.0,1,1.0,4,1,0,1.0,3.8335,3.37,55.99,9.29,1,0,0.0,0,1.4822,0,0,0,0,0,"Remove wait option from all run commands

The Charm Guide was recently updated for Juju 3.x. However, it was not
known at the time that the semantics of the --wait option for the `juju
run` command had changed.

In 3, the run command by default stays in the foreground (a --background
option has been added to achieve previous 2.9 default behaviour). The
--wait option is now a timeout and, if used, requires a value. Since
the previous PR simply substituted commands, all `juju run --wait`
commands will fail.
[SEP]
FILES CHANGED:
doc/source/admin/storage/ceph-rbd-mirror.rst (+16, -16)
doc/source/admin/ops-replace-control-plane-service-ha.rst (+1, -1)
doc/source/admin/security/tls.rst (+7, -7)
doc/source/admin/storage/cinder-replication.rst (+4, -4)
doc/source/project/procedures/percona-series-upgrade-to-focal.rst (+5, -5)
doc/source/admin/ops-config-tls-vault-api.rst (+1, -1)
doc/source/admin/ops-live-migrate-vms.rst (+2, -2)
doc/source/admin/ops-auto-glance-image-updates.rst (+1, -1)
doc/source/admin/networking/load-balancing.rst (+2, -2)
doc/source/admin/ha.rst (+2, -2)
doc/source/admin/trilio.rst (+1, -1)
doc/source/project/procedures/ovn-migration.rst (+7, -7)
doc/source/admin/deferred-events.rst (+3, -3)
doc/source/admin/ops-replace-vault-node.rst (+1, -1)
doc/source/admin/ops-reissue-tls-certs.rst (+1, -1)
doc/source/admin/vgpu.rst (+1, -1)
doc/source/admin/managing-power-events.rst (+48, -48)
doc/source/admin/upgrades/openstack-example.rst (+26, -26)
doc/source/admin/upgrades/series-openstack.rst (+15, -15)
doc/source/project/procedures/placement-charm.rst (+2, -2)
doc/source/admin/ops-scale-back-nova-compute.rst (+2, -2)
doc/source/admin/ops-repair-rabbitmq-node.rst (+3, -3)
doc/source/project/support-notes.rst (+9, -9)
doc/source/admin/ops-scale-back-ovn-central.rst (+1, -1)
doc/source/admin/ops-remove-mysql8-node.rst (+5, -5)
doc/source/admin/storage/cinder-replication-dr.rst (+4, -4)
doc/source/getting-started/deploy.rst (+1, -1)
doc/source/admin/ops-replace-hyperconverged-compute-node.rst (+6, -6)
doc/source/admin/ops-start-innodb-from-outage.rst (+1, -1)
doc/source/admin/upgrades/openstack.rst (+32, -32)
",-1.262033,-1.388516,0.5606,0.489731,-0.301477,0.218651,0.000401,-0.037312,-0.094894,0.562113,0.174708,0.384607,-0.140262,0.138072,0.101647
openstack/charm-ceph-dashboard,I74f42b38acc02b0377c245f813ff50d11be538bc,0,1,1.0,4.5218,0.011,3,19.0,514,0,Bug Fix,0,0,0,16,0.007021,0.9412,0,0.9412,1,2,0,0.9091,0.8461,0.67,43.95,17.07,1,0,0.8022,1,5.587,0,16,0,17,0,"Ensure non-leader ceph-dashboard units configure themselves

This is to provide the non-leader ceph-dashboard units an extra hook to
configure themselves after the leader has configured the ceph manager
module. This is done by adding a peer relation with a nonce (set by the
leader) when it has enabled the dashboard in ceph. It is possible that
non leader units will 'run out' of hooks and thus leave themselves in an
unconfigured state.

Closes-Bug: #2032971
[SEP]
FILES CHANGED:
src/charm.py (+15, -0)
metadata.yaml (+3, -0)
unit_tests/test_ceph_dashboard_charm.py (+72, -1)
",-1.241703,-0.830547,-0.023385,0.832017,0.46548,0.174306,0.288762,-0.358879,0.139055,-0.253731,0.420346,0.612395,0.294217,0.083298,0.130693
openstack/charm-ceph-dashboard,I63fbe0776c92419d8b047bab151e01c4f1f3f45e,1,1,0.9474,2.9444,0.1111,1,12.0,191,0,Bug Fix,0,0,0,19,0.003276,0.7857,0,0.7444,1,1,0,0.8333,0.0,1.0,-59.14,28.13,0,0,0.0,0,10.0526,0,20,0,15,0,"Adds dashboard enablement/deferral logic improvements

Closes-Bug: 2033886
cherry-picked from: I2f4d4dfa890fc79f7f5d5b1273a11907b60e8255
[SEP]
FILES CHANGED:
src/charm.py (+16, -2)
",0.457728,-0.065579,-2.21903,-2.163714,1.014646,0.372052,0.93732,-0.298815,0.701507,-0.084305,-0.562852,0.390227,0.032896,-0.281486,0.435468
openstack/kolla-ansible,Iafc4f184da727e40fb4952d96aa2e0be8feaca75,1,0,0.5714,1.6094,0.25,1,10.0,113,0,Feature,0,0,0,7,0.046667,0.0,0,0.0,4,1,0,0.8072,0.0,4.0,-40.19,24.0,1,0,0.0,0,22.6,0,0,0,0,0,"ironic: only bootstrap ironic-tftp when service is enabled
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/bootstrap_service.yml (+3, -1)
",1.77485,0.257901,0.608959,0.466579,0.659025,-0.943275,0.272562,-0.016386,-0.523063,-0.007937,0.275351,-0.138234,-0.113588,-0.231572,0.497555
openstack/charm-ceph-radosgw,I57937f55526f531cb807a876fd074f5f589b00ed,1,0,0.95,4.9488,0.05,3,10.25,298,0,CI,1,0,0,20,0.003438,1.0,0,0.95,2,1,0,1.0,0.695,1.67,60.25,11.9,1,0,1.0,1,2.1135,0,0,0,0,0,"Add upgrade func testing

Change functional testing to also test upgrades from charmhub version
to the locally built charm. Include a new test for installing a locally built charm from scratch.

Also pin some support charms to specific tracks.
[SEP]
FILES CHANGED:
tests/tests.yaml (+6, -0)
tests/bundles/jammy-antelope.yaml (+6, -7)
tests/bundles/local-jammy-antelope.yaml (+121, -0)
",0.504997,-1.815094,0.032276,0.617295,0.071402,-0.013743,0.059542,0.084791,-0.121824,0.237218,-0.431368,0.282795,0.0716,0.299206,-0.224114
openstack/charm-ceph-mon,I12a1bcd32be2ed8a8e5ee0e304f716f5a190bd57,1,0,0.9524,4.0254,0.3091,3,13.75,380,0,Bug Fix,0,0,0,21,0.003525,1.0,0,0.9524,2,2,0,0.9565,1.3663,1.33,42.14,13.5,1,0,0.4727,1,6.7857,0,0,0,0,0,"Fix version retrieval

During cluster deployment a situation can arise where there are
already osd relations but osds are not yet fully added to the cluster.
This can make version retrieval fail for osds. Retry version retrieval
to give the cluster a chance to settle.

Also update tests to install OpenStack from latest/edge
[SEP]
FILES CHANGED:
src/utils.py (+25, -4)
tests/bundles/jammy-bobcat.yaml (+10, -10)
unit_tests/test_ceph_utils.py (+3, -3)
",-2.109188,-0.58635,-0.298819,-1.18307,0.469783,-0.099593,0.441023,-0.040007,0.079914,0.143778,0.187312,-0.14219,0.11296,0.173366,-0.034091
openstack/octavia,I020ded6e1735ea56da46c5170292ba88ad639103,1,1,0.7474,3.7377,0.1463,3,23.5,335,0,Bug Fix,0,0,0,95,0.008098,0.625,0,0.4671,6,2,0,0.6043,1.4131,4.0,28.18,18.76,0,0,0.5366,1,7.9762,0,20,0,14,0,"Fix error when deleting LB with broken amp

If a load balancer has some broken amps (amphora was unsuccessfully
created, entry exists in the DB but with missing fields), the deletion
of the load balancer fails because octavia is calling delete_port with
None.

Closes-Bug: #2037951
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+22, -0)
releasenotes/notes/fix-error-on-delete-with-broken-amp-10d7f4e85754d7ee.yaml (+6, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+7, -6)
",0.054901,-1.91535,-0.308029,-0.242394,-0.406107,0.091933,-0.200315,-0.099809,0.101654,-0.289707,-0.005808,-0.201308,0.237607,0.165669,-0.098953
openstack/octavia,Iad78de1764bc3a3f699b5feef9e58999d2efe613,1,1,0.75,2.9957,0.3158,3,23.75,595,0,Bug Fix,0,0,0,96,0.008155,0.0,0,0.0,6,2,0,0.6055,1.509,4.0,43.81,16.66,0,0,0.2105,1,29.75,0,6,0,10,0,"Fix incorrect masquerade rules in multivip LBs

The up scripts of the interface files were called only when the
interface moved from down to up, it means that they were not called
during the update of the configuration of an interface. So if during an
update, if an ipv6 subnet was plugged while the ipv4 subnet was already
there, the up script that sets the masquerade rules was not called.

It broke connectivity for either ipv4 or ipv6 between the client and the
members in UDP listeners in multivip load balancers.

Closes-Bug: #2037943
[SEP]
FILES CHANGED:
octavia/amphorae/backends/utils/interface.py (+4, -5)
releasenotes/notes/fix-missing-masquerade-rules-in-dualstack-lbs-94f97606c5804b36.yaml (+6, -0)
octavia/tests/unit/amphorae/backends/utils/test_interface.py (+3, -1)
",-1.409365,-1.668462,0.757597,0.404415,0.181904,-0.004549,0.180777,0.015438,0.106768,0.013407,0.248854,0.088388,-0.034758,0.117613,0.265448
openstack/charm-vault,I64f1c2c9ced8ae4dff2bf232c6e673b596f84a14,1,1,0,1.3863,1.0,1,7.57,388,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,47.51,10.58,1,0,0.0,0,97.0,0,12,0,5,0,"Remove 'tls_insecure_skip_verify' in vault config

This commit removes the tls_insecure_skip_verify field in the vault
config template. This was added as a workaround for a bug in the vault's
etcd client before 1.4.0 release. Since all channels now uses 1.5 or
newer versions of vault, this line can be removed.


Closes-Bug: #1979582
[SEP]
FILES CHANGED:
src/templates/vault.hcl.j2 (+0, -3)
",-1.416198,0.505467,-0.752824,0.878543,0.194671,0.398419,-0.180634,0.006157,0.407505,0.629385,0.335768,-0.17494,-0.284047,-0.003572,0.582289
openstack/charm-ceph-mon,Iee13e9a88f047f5835aee8e5a308ce2035d28891,1,0,0.9545,1.0986,0.5,1,8.0,93,0,Bug Fix,0,0,0,22,0.003659,1.0,0,0.9545,1,1,0,0.9583,0.0,1.0,-2.21,13.2,1,0,0.0,0,31.0,0,0,0,0,0,"Fix: increase timeout for get versions
[SEP]
FILES CHANGED:
src/utils.py (+1, -1)
",2.969853,0.707453,2.231624,0.255142,0.453389,0.698695,-0.043703,-0.412691,0.611691,0.576133,-0.6259,-0.698798,0.757731,-0.243683,0.386155
openstack/openstack-ansible-ceph_client,I7810881a01b9d2f3d98a6c3ad590b9ea63358011,1,0,0.934,1.3863,0.0,3,20.0,508,0,Feature,0,0,0,106,0.040675,1.0,0,0.934,1,1,0,0.8571,1.585,1.0,59.64,11.5,0,0,0.0,0,127.0,0,0,0,0,0,"Allow to distribute custom key with the role

Right now we have quite strong assumption that `nova_ceph_client` should be
present among clients to fetch. At the same time, in case the role is
included outside of the OSA context, ceph_client_filtered_clients might
not contain all users we expect to see.

With that we alter the logic to fetch nova key not only when role is launched
against compute host, but also when the client is present in the list.
[SEP]
FILES CHANGED:
tasks/ceph_auth.yml (+1, -0)
tasks/ceph_get_keyrings_from_mons.yml (+1, -0)
tasks/ceph_get_keyrings_from_files.yml (+1, -0)
",-0.703006,-1.718394,0.272609,0.765941,-0.113357,-0.259955,0.48181,-0.330836,0.266887,-0.227782,-0.061863,0.002397,-0.305594,-0.004081,-0.21683
openstack/ironic,I1aeeda89a8925fbbc2dae752742f0be4bc23bee0,1,1,0.9655,3.6109,0.1111,3,19.6,638,0,Bug Fix,0,0,0,29,0.0119,0.5,0,0.4828,2,2,0,0.9462,1.097,2.0,54.0,12.74,1,0,0.0,1,17.2432,0,6,0,8,0,"Bump workers_pool_size to 300 and remove queueing of tasks

Especially in a single-conductor environment, the number of threads
should be larger than max_concurrent_deploy, otherwise the latter cannot
be reached in practice or will cause issues with heartbeats.

On the other hand, this change fixes an issue with how we use futurist.
Due to a misunderstanding, we ended up setting the workers pool size to
100 and then also allowing 100 more requests to be queued.

To be it shortly, this change moves from 100 threads + 100 queued to
300 threads and no queue.

Partial-Bug: #2038438
[SEP]
FILES CHANGED:
ironic/conf/conductor.py (+1, -1)
releasenotes/notes/workers-20ca5c225c1474e0.yaml (+25, -0)
ironic/conductor/base_manager.py (+6, -3)
",-1.887905,-1.498617,0.800046,0.211965,-0.065727,0.38144,-0.165622,-0.364345,0.175829,0.45564,0.092945,0.012517,-0.157581,-0.36761,0.238813
openstack/charm-ceph-iscsi,I92d02b1385dec1a047ed67d162ef860ccb15b061,1,0,0.9565,5.4161,0.9643,7,5.0,77,0,Feature,0,0,0,23,0.003824,1.0,0,0.9565,2,1,0,1.0,1.751,1.29,-52.04,26.0,1,0,0.9152,1,0.3422,0,0,0,0,0,"Remove kinetic support
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -2)
osci.yaml (+0, -18)
tests/bundles/jammy-ec.yaml (+4, -3)
tests/bundles/jammy.yaml (+4, -3)
tests/bundles/kinetic-ec.yaml (+0, -94)
metadata.yaml (+0, -1)
tests/bundles/kinetic.yaml (+0, -95)
",4.633876,2.533902,3.056969,0.577881,0.23443,1.641629,0.744273,-0.20684,0.603643,-0.316852,-0.460608,-0.225816,0.560762,0.26074,0.076057
openstack/charm-ceph-nfs,Ifc5f04ce2259d19cb120a1434a2f80b178bd4dc3,1,0,0.9583,4.7095,0.0273,5,21.0,170,0,CI,0,0,1,24,0.003847,1.0,0,0.9583,2,3,0,0,1.5631,0.8,32.43,16.02,1,0,0.4818,1,1.5315,0,0,0,0,0,"Add reef functests to CI

Via the jammy-bobcat UCA

Don't rely on feature branch, vendor in context adapter instead
[SEP]
FILES CHANGED:
tests/tests.yaml (+2, -1)
osci.yaml (+8, -0)
requirements.txt (+1, -1)
src/charm.py (+46, -1)
tests/bundles/jammy-reef.yaml (+50, -0)
",2.090677,-1.131736,-0.377175,-0.417539,-0.338079,-0.432287,0.220517,-0.041162,-0.836413,-0.952943,-0.053064,0.134291,-0.009302,0.013312,-0.348156
openstack/oslo.policy,If67f629dfd6b07ed198155bec43a128369b7affa,1,0,1.0,1.0986,0.5,1,12.5,195,0,Bug Fix,0,0,0,9,0.087379,0.6471,0,0.6471,2,1,0,0.8571,0.0,2.0,38.48,16.2,0,0,0.0,0,65.0,0,0,0,0,0,"Fix doc build error

This fixes the following error in the doc job.

```
TypeError: not all arguments converted during string formatting
```
[SEP]
FILES CHANGED:
doc/source/conf.py (+1, -1)
",1.275474,-2.308909,0.258795,-0.431192,-0.621346,0.553157,-1.213519,-0.279224,0.569349,0.349409,-0.473435,-0.294453,-0.222643,0.437416,-0.318908
openstack/openstack-ansible-os_octavia,Ib6b8547b69949f7af0ba0f7f436b4286d3baccb7,1,0,0.9346,3.1781,0.0,1,7.0,376,1,Feature,0,0,0,107,0.041012,0.0,0,0.0,1,1,0,1.0,0.0,1.0,-27.48,18.8,0,0,0.0,0,15.6667,0,0,0,0,0,"Add security rule for octavia healthmanager

Amphora does report back it's status to Octavia healthmanager through
octavia_health_manager_port. This outgoing traffic from Amphora must be
allowed to show LB stats and operational_status.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/896017
[SEP]
FILES CHANGED:
tasks/octavia_security_group.yml (+23, -0)
",-0.608348,1.507548,-0.965029,0.662172,-0.432424,-0.212549,0.596253,0.220101,0.41225,-0.658116,0.077135,-0.127018,0.06548,-0.278059,0.064836
openstack/openstack-ansible,Ic381b98f92c12899da4cd64873989522151cb7eb,0,1,0.8824,1.0986,0.5,1,3.57,1008,0,Bug Fix,0,0,0,17,0.060932,1.0,0,0.8824,1,1,0,0.9265,0.0,1.0,-8.29,11.83,1,0,0.0,0,336.0,0,8,0,10,0,"Bump ansible-core to 2.12.8

On 30.09.2023, ""old"" ansible galaxy(galaxy.ansible.com) was replaced
with ""galaxy ng""[1].
There was a bug [2][3][4] that was fixed only in a supported
ansible-core versions, so:
- v2.12.8
- v2.13.3
- v2.14.0 (and all newer versions)

All openstack-ansible versions up to Yoga are using older ansible-core
versions.
As a result, bootstrap-ansible.sh script fails with an error:

```
Skipping Galaxy server https://galaxy.ansible.com/api/. Got an
unexpected error when getting available versions of collection
ansible.netcommon:
'/api/v3/plugin/ansible/content/published/collections/index/ansible/netcommon/versions/'
```

This patch bumps ansible-core version to 2.12.8 that includes required
fix.

[1] https://www.ansible.com/blog/new-ansible-galaxy
[2] https://github.com/ansible/ansible/issues/81830
[3] https://github.com/ansible/ansible/issues/77911
[4] https://github.com/ansible/ansible/pull/78325

Closes-Bug: #2038315
[SEP]
FILES CHANGED:
scripts/bootstrap-ansible.sh (+1, -1)
",-4.518008,2.793075,2.808559,-0.987955,-0.372069,0.173224,-0.878727,-0.069387,-0.672623,0.183568,-0.605154,0.229427,0.054137,0.314535,0.015102
openstack/oslo.utils,Iae22a544ff69069b1b82b6ab3a885f3a19869287,1,1,0,1.0986,0.5,1,8.33,285,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,0.8,0.0,1.0,8.87,17.73,0,0,0.0,0,95.0,0,6,0,4,0,"Mask chapsecret

Doesn't mask chapsecre
>>> strutils.mask_password(""'chapsecre' : 'aaaaa'"")
""'chapsecre' : 'aaaaa'""

Masks chapsecret
>>> strutils.mask_password(""'chapsecret' : 'aaaaa'"")
""'chapsecret' : '***'""

Closes-Bug: #2038466
[SEP]
FILES CHANGED:
oslo_utils/strutils.py (+1, -1)
",-2.386836,0.699481,-1.225013,-0.459815,1.386128,0.639861,-1.585179,-0.718527,-0.192112,-0.003629,0.314006,-0.719604,0.24763,0.682518,0.281961
openstack/octavia,I4a6e4830d0e916b1af1a11dd10097980a57d97ea,1,1,0.7526,3.1781,0.2609,3,16.25,498,0,Bug Fix,0,0,0,97,0.008227,0.5714,0,0.43,5,2,0,0.6067,1.3709,4.0,17.24,18.81,0,0,0.0,1,20.75,0,12,0,22,0,"Fix race condition in cascade delete

update_vip was called multiple times concurrently when cascade deleting
a load balancer with many listeners, it may trigger a race condition
when fetching, computing and updating the SGs.
Calling update_vip for each listener is not necessary, it's now called
only once, that fixes the race condition and optimize the delete flow.

Closes-Bug: #2038529
[SEP]
FILES CHANGED:
releasenotes/notes/fix-potential-race-conditions-in-cascade-delete-1e100213445a17ec.yaml (+7, -0)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+10, -3)
octavia/controller/worker/v2/flows/listener_flows.py (+0, -3)
",-1.210132,-1.389753,0.180581,-0.885855,0.358795,0.014321,0.71049,-0.216187,0.362354,0.084102,0.217238,-0.182245,0.058429,-0.151527,0.289816
openstack/octavia,Ia914ad89b6fdf3606c3d4bff0a4c425348c15e0c,1,1,0,4.3944,0.0125,3,11.43,565,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,6,2,0,0.6079,0.5934,4.0,35.55,15.07,1,0,0.8875,1,6.9753,0,6,0,13,0,"Fix health monitor information retrieval in API response

Closes bug: #2038367

Behavior: In the response body of the LB API when creating
a new load balancer, the information about the health
monitor is always null, even though it has been configured.

Reproduce: Using the Octavia API to create a new LB with
all components. You cannot see any information about the
health monitor that will be returned.

Proposed Fix: Modify the assignment to use
`data_model.health_monitor` instead of `pool.healthmonitor`.
[SEP]
FILES CHANGED:
octavia/api/v2/types/pool.py (+1, -1)
octavia/tests/unit/api/v2/types/test_pool.py (+71, -0)
releasenotes/notes/fix-health-monitor-info-retrieval-in-api-response-d3b2e02a3a966f60.yaml (+7, -0)
",-1.190381,-1.32142,0.673506,0.342918,-0.30295,0.131685,-0.3791,0.401047,0.728797,0.029199,0.042916,0.075727,-0.317389,0.232489,-0.292361
openstack/charm-ceph-osd,I9609bc0222365cb1f4059312b466a12ef4e0397f,1,0,0.96,5.5452,0.5647,9,11.5,193,0,Feature,0,0,0,25,0.003938,1.0,0,0.96,2,3,0,0.9,2.214,1.0,29.64,15.03,1,0,0.251,1,0.7539,0,0,0,0,0,"Remove FileStore support

Remove support for creating FileStore OSDs. Also prevent upgrade
attempts to Reef if a FileStore OSD is detected
[SEP]
FILES CHANGED:
hooks/utils.py (+23, -0)
hooks/ceph_hooks.py (+10, -3)
unit_tests/test_ceph_hooks.py (+0, -16)
lib/charms_ceph/utils.py (+38, -98)
templates/ceph.conf (+2, -7)
unit_tests/test_actions_add_disk.py (+2, -6)
actions/add_disk.py (+0, -1)
config.yaml (+0, -9)
unit_tests/test_upgrade.py (+36, -4)
",1.136408,-0.496758,0.317233,0.722709,0.212103,0.45204,-0.172315,0.207572,0.067472,0.117143,-0.079541,0.066714,0.402283,-0.295228,-0.262361
openstack/openstack-ansible-os_magnum,I36cf9f4b71daa107e27e966ebe25816c7bffa42a,1,0,0.8333,2.5649,0.0833,2,12.0,882,0,Bug Fix,0,0,0,18,0.064057,0.0,0,0.0,1,1,0,1.0,0.9183,1.0,42.38,9.8,0,0,0.0,0,67.8462,0,0,0,0,0,"Wait for magnum endpoint before creating cluster templates

Magnum playbook flushes handlers(that cause service restart) and then
it starts creating magnum resources right away.

In some cases(for ex. magnum tls upgrade job), magnum haproxy endpoint
is down before playbook flushes handlers. It means that after flushing
them, haproxy healthchecks need some time to rise magnum endpoint.
In this case, there is a high chance that playbook will try to connect
to magnum endpoint before haproxy marks it as alive.

To solve this issue, this patch implements an extra task to ensure
that magnum endpoint is reachable before playbook tries to reach it.

This patch also fixing linters issue in an example playbook to resolve
circular dependency.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/896017
[SEP]
FILES CHANGED:
tasks/magnum_resources.yml (+8, -0)
examples/playbook.yml (+3, -1)
",-2.407147,-0.463254,1.839911,-0.213828,-0.301427,-0.073782,0.249214,-0.206015,-0.239938,-0.23059,-0.013582,0.001697,0.203511,-0.237905,0.021632
openstack/openstack-ansible-os_nova,I8ae3e263185b1cd8036a4fde12d9c950f2ce8b98,1,0,0.9352,1.3863,0.0,1,10.33,275,0,Feature,0,0,0,108,0.041033,1.0,0,0.9352,1,1,0,1.0,0.0,1.0,-5.6,19.62,0,0,0.0,0,68.75,0,0,0,0,0,"Add barbican_service_user section

Defining barbican_service_user is required for succesfull attachement
of ecnrypted volumes to VMs. Without it being in place nova-compute
fails with not being able to get service_token.
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+3, -0)
",-0.586613,-0.786028,-0.545823,0.762707,0.557612,-0.110455,-0.216739,-0.17995,0.221344,-0.441713,0.07872,-0.10312,-0.269899,-0.236417,-0.171426
openstack/openstack-ansible-ceph_client,I2dff4bf54191b763e25625aa7a10bceaa1f6e595,1,0,1.0,3.3673,0.0,2,18.0,290,0,Feature,0,0,0,26,0.082278,1.0,0,1.0,1,1,0,0.875,0.2223,1.0,12.31,19.42,0,0,0.0,0,10.0,0,0,0,0,0,"Add AppArmor configuration for ceph read/write caching

When Ceph read/write caching uses paths which aren't already
covered by the libvirt/qemu apparmor rules then additional
configuration is required to ensure VMs don't fail to boot.
[SEP]
FILES CHANGED:
tasks/main.yml (+27, -0)
defaults/main.yml (+1, -0)
",0.190476,-0.777665,-0.127915,0.861541,0.579296,-0.3278,-0.09711,-0.079474,-0.303151,-0.056959,-0.710748,-0.051951,0.156836,-0.533835,-0.112272
openstack/ansible-role-zookeeper,Id95dbed736553b24341eb15c74b4a194369dda9f,1,1,0.6667,1.3863,0.6667,2,8.33,396,0,Bug Fix,0,0,0,3,0.020134,1.0,0,0.6667,1,1,0,1.0,0.9183,1.0,32.56,9.73,1,0,0.0,0,99.0,0,8,0,10,0,"change to using archive.apache.org for source downloads

archive.apache.org contains all the released versions, whereas dlcdn
only has the latest minor revision. using the archive link will allow
branches to continue to work indepdendently of the upstream's CDN and
release schedule

also, fix linter for example playbook

Closes-Bug: 2038826
[SEP]
FILES CHANGED:
examples/playbook.yml (+0, -1)
defaults/main.yml (+1, -1)
",0.151601,-1.578134,-0.109447,-0.0742,-0.343695,-0.578674,0.15398,0.393641,-0.224371,-0.135713,-0.324268,-0.222399,0.030239,0.276442,0.059961
openstack/ansible-role-python_venv_build,Iaf6ed4dd5e01b25b5935b959c73ab657cfefef47,1,0,0.9358,3.091,0.1429,1,8.89,628,0,CI,0,0,0,109,0.041366,0.9231,0,0.8638,1,1,0,1.0,0.0,1.0,34.96,9.56,0,0,0.0,0,28.5455,0,0,0,0,0,"Use distribution_major_version for Debian and CentOS

Debian does include minor versioning into distribution_version facts
causing versions to look like ""12.2"" or ""11.4"", which is causing issues
once debian is minorly updated since there might be no repo container
to satisfy such specific request across the board (ie having repo 11.3
while compute reports 11.4). Thus we're taking into account only major
versions for these distros. Same approach has been taken for building
wheels in project-config [1]

[1] https://review.opendev.org/c/openstack/project-config/+/897545
[SEP]
FILES CHANGED:
vars/main.yml (+18, -3)
",-1.23031,0.154703,0.442562,-0.004195,-0.194411,-0.107788,0.331572,-0.020172,-0.441083,0.38376,-0.154667,-0.136704,-0.028651,-0.25608,0.112858
openstack/charm-ceph-mon,Id3f21f8ab68fb88529b6cbd78217e27772c2739c,1,0,1.0,3.1355,0.0909,1,14.0,181,0,Feature,0,0,0,5,0.031056,1.0,0,1.0,1,1,0,0.96,0.0,1.0,-6.79,19.89,1,0,0.0,0,7.8696,0,0,0,0,0,"Configure ceph with osd-memory-target from ceph-osd charm

(cherry picked from commit 87da61b687ce43ad565beb764c43dd875b99cde9)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+20, -2)
",0.116718,-0.148752,-2.227899,-1.905554,1.746355,0.007529,0.441421,-0.383158,-0.318929,-0.421834,-0.459493,0.372963,-0.062519,-0.14047,-0.385032
openstack/charm-ceph-osd,I22dfc25c4ac2737f5d872ca2bdab3c533533dbff,1,1,1.0,5.3423,0.0048,3,6.33,268,0,Bug Fix,0,0,0,6,0.032787,1.0,0,1.0,1,2,0,0.9091,1.3702,0.67,-40.04,17.27,1,0,0.5385,1,1.2823,0,8,0,13,0,"Add config option for tuning osd memory target

Closes-Bug: #1934143

Depends-On: https://review.opendev.org/c/openstack/charm-ceph-mon/+/897724

(cherry picked from commit ba6186e5de0ad82250599e90347a4c8cf121475e)
[SEP]
FILES CHANGED:
hooks/ceph_hooks.py (+71, -1)
unit_tests/test_ceph_hooks.py (+112, -0)
config.yaml (+24, -0)
",-0.810627,1.394869,-1.936187,-1.434877,-0.179927,0.079384,0.795543,0.128703,0.411483,-0.121302,-0.162977,-0.284821,0.408488,-0.063074,0.14218
openstack/charm-ceph-mon,I34dd33e54193a9ebdbc9571d153aa6206c85a067,1,1,1.0,2.8904,0.6471,1,19.0,574,0,Bug Fix,0,0,0,7,0.017903,1.0,0,1.0,1,1,0,0.9615,0.0,1.0,27.26,16.02,1,0,0.0,0,31.8889,0,8,0,13,0,"Don't clear osd_memory_target unconditionally

The charm can now set osd_memory_target, but it's not per device class
or type by the nature of how the charm works. Resetting
osd_memory_target always when osd_memory_target is not passed over the
relation is a bit risky behavior since operators may have set
osd_memory_target by hand with `ceph config` command out side of the
charm. Let's be less disruptive on the charm upgrade.

Closes-Bug: #1934143
(cherry picked from commit b31de1f027b32fa2ebe8ab62756819de466bbbf2)
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+6, -11)
",-1.965807,-0.321051,0.437494,-0.512619,0.745725,0.150908,0.278207,-0.36303,-0.031001,-0.321752,0.548813,-0.132326,-0.362301,-0.217048,0.09052
openstack/charm-keystone,Ie5b97eadf29206f9a289caded0f90e78b5898828,1,1,0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,0,0.0,1.0,0,0.0,4,4,0,1.0,2.2709,2.2,16.51,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,I7bbf1443ff02515e24c8f7e0b6b21c986636ddce,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,1,0.034483,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,21.3,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,Ic2d8cd94713161e79e907de3b3031191fa8d1c31,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,2,0.035088,1.0,0,1.0,4,4,0,0,2.2709,2.2,18.11,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-keystone,I9b7d5452c08f43362ed3d1144ef7ef89699f3872,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,3,0.035294,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,19.7,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,I34258c46c839db1c70a3967b7e1ee6889db8a7fd,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,4,0.036036,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,18.11,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.16279,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,I58ff6da6a916ce11314b63b5762569ae385e0a5b,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,5,0.036496,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,14.91,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.16279,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-cinder,Iefaea961e054bfcce8185b7d51062fb41c56e302,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,6,0.03681,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,18.11,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.16279,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-keystone,If109d4873fe728526b97478c93f01482b8b3199d,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,7,0.037037,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,22.9,15.37,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,I4e2ffb1d1883d039899c7b1db3e713a54d20ba5e,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,8,0.037209,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,18.11,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,Ic89feaf34f6f9060fa1fde4a9dacb7446dd7b532,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,9,0.037344,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,16.51,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/ansible-role-python_venv_build,I663bdb1bcc60fec0d9efc55cbb1b2a0c566ab2ab,1,0,0.9364,1.6094,1.0,3,19.0,388,0,Feature,0,0,0,110,0.041416,0.0,0,0.0,1,1,0,1.0,1.5,1.0,30.22,16.02,0,0,0.0,0,77.6,0,0,0,0,0,"Drop unneeded become overrides

We add become overrides on the task level which neglect provided by
user options in favor of quite narrow usecase. As a result, role can not
be run as a non-root user in cases where venv_build_host is not localhost

Removing become override potenially unblocks running OSA with non-root
user on hosts.
[SEP]
FILES CHANGED:
tasks/python_venv_set_facts.yml (+0, -2)
tasks/python_venv_wheel_build.yml (+0, -1)
tasks/python_venv_install.yml (+0, -1)
",-0.282064,-1.719713,-0.219301,0.750779,0.234581,-0.210809,0.175188,-0.310969,-0.008188,-0.408222,-0.180639,0.241318,0.042203,-0.370947,-0.217453
openstack/openstack-ansible-os_nova,I4fe88fdb0e185a01e00cf0655cd96b8986dd17ff,1,0,0.9369,0.6931,0.0,1,4.82,483,0,Bug Fix,0,0,0,111,0.041729,1.0,0,0.9369,1,1,0,1.0,0.0,1.0,10.4,11.74,0,0,0.0,0,241.5,0,0,0,0,0,"Install libvirt-deamon for RHEL systems

CentOS has upgraded their libivrt to version 9.3, where libvirt-daemon
is not installed as a dependency anymore. So we need to explicitly
install this package to restore functionality.

That is a follow-up patch to [2] which fixed only EL8 but not EL9.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=2209936
[2] https://review.opendev.org/c/openstack/openstack-ansible-os_nova/+/884380
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+1, -0)
",-1.17317,1.379084,0.021217,-0.211833,-0.994438,-0.176705,0.955774,0.111227,-0.162081,0.286022,0.434828,-0.059897,-0.214672,-0.217404,0.104218
openstack/openstack-ansible,I426c78157a17fd4524e48437c6f632a8551223d0,1,0,0.9375,4.7622,0.0259,4,9.8,441,0,Doc,0,0,0,112,0.042089,1.0,1,0.9375,4,1,0,0.913,0.7801,3.5,10.42,14.53,0,1,0.0,0,3.7692,0,0,0,0,0,"[doc] Add documentation on running as non-root

Right now our documentation assumes that users must run
OpenStack-Ansible as root users. With that it's not a
strict requirement and there is a pretty much
straightforward way on running playbooks as non-root
user by leveraging Ansibles' `become`.

Depends-On: https://review.opendev.org/c/openstack/ansible-role-python_venv_build/+/897948
[SEP]
FILES CHANGED:
doc/source/user/security/non-root.rst (+99, -0)
doc/source/reference/architecture/security.rst (+6, -0)
deploy-guide/source/targethosts-prepare.rst (+7, -3)
doc/source/user/security/index.rst (+1, -0)
",-0.987755,0.538115,-0.40306,0.212524,-0.852198,-0.349296,0.589402,-0.067521,0.022333,-0.176588,0.215088,0.18567,0.279704,-0.40147,-0.003802
openstack/openstack-ansible,Ied031501bc1da4d1a3c4f9ad101aba355ecd364f,1,0,1.0,1.6094,1.0,1,12.0,384,0,Feature,0,0,0,4,0.085106,0.0,0,0.0,1,1,0,0.9143,0.0,1.0,20.17,18.97,0,0,0.0,0,76.8,0,0,0,0,0,"Stop ignoring hostnames without underscores

The inventory management script was ignoring hostnames without underscores,
which lends its roots to all LXC containers having underscores. In bare
metal deployments, hosts likely won't have underscores, and new containers
might even have hyphens. Group listing now works as expected.
[SEP]
FILES CHANGED:
osa_toolkit/manage.py (+0, -4)
",-0.488734,-1.709112,-0.462945,0.865743,0.316814,-0.108498,-0.31424,-0.506038,-0.354096,0.422584,-0.463989,0.052107,0.452086,-0.054033,-0.361733
openstack/openstack-ansible-os_neutron,I04742324ff472b3c40ee4c7d333305c67046aba2,1,1,0.9381,1.0986,0.5,1,9.67,227,0,Bug Fix,0,0,0,113,0.040691,0.8333,0,0.7817,1,1,0,0.9167,0.0,1.0,51.16,12.14,0,0,0.0,0,75.6667,0,6,0,17,0,"Update VPNaaS package for RHEL

OpenSwan Package for IPSec has been replaced with libreswan in EL9.
We missed to reflect that while adding EL9 support.

Closes-Bug: #2039098
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -1)
",0.354932,-1.22597,-0.668526,-0.655715,-0.57751,0.232022,-0.790158,0.797711,-0.34044,-0.052047,0.180909,0.084247,-0.101529,-0.490914,0.504804
openstack/kayobe,I3fa96f0276e08a6678e5d743399d01bc19a8dd1b,1,0,0.8889,3.8286,0.4222,8,6.6,366,0,Bug Fix,0,0,0,81,0.025085,1.0,0,0.8889,4,4,0,0.9451,2.8494,3.25,-22.9,17.19,0,0,0.0,1,7.9565,0,0,0,0,0,"Remove unsupported kolla_docker_registry_insecure variable

This variable is not supported since
I61a61ca59652b13687c2247d5881012b51f666a7, but was not removed from
etc/kayobe/kolla.yml in that change.

This change also adds the replacement variable docker_registry_insecure
to etc/kayobe/docker.yml.

TrivialFix
[SEP]
FILES CHANGED:
etc/kayobe/docker.yml (+5, -0)
ansible/inventory/group_vars/all/kolla (+0, -5)
ansible/inventory/group_vars/all/docker (+5, -0)
etc/kayobe/kolla.yml (+0, -5)
doc/source/configuration/reference/kolla-ansible.rst (+0, -4)
releasenotes/notes/remove-kolla-docker-registry-insecure-9d92a2c7c8bdc99c.yaml (+13, -0)
doc/source/configuration/reference/hosts.rst (+3, -0)
ansible/roles/kolla-ansible/defaults/main.yml (+0, -5)
",-1.920866,0.400548,-1.333916,-0.368352,0.85329,0.113107,-0.344609,-0.315217,0.167015,0.111107,0.077859,-0.128818,-0.391078,0.121493,0.253116
openstack/charm-nova-compute,Ia23fbf341d5b7ad469337d8a0c65c18ec519a891,1,1,0.8,1.3863,0.0,1,15.0,283,0,Bug Fix,0,0,0,20,0.024938,1.0,0,0.8,1,1,0,1.0,0.0,1.0,13.95,19.33,1,0,0.0,0,70.75,0,20,0,17,0,"AppArmor policy update for NVMeoF

When using NVMeoF feature with nova-compute apparmor in enforce
mode, nova-compute is denied from running /usr/sbin/nvme and
/usr/sbin/blkid, and reading /etc/nvme/hostnqn.

Closes-Bug: #2039161
[SEP]
FILES CHANGED:
templates/usr.bin.nova-compute (+3, -0)
",-1.155442,0.339887,-1.176536,0.592083,0.535921,-0.346329,-0.028406,0.30386,-0.399328,-0.395488,0.21117,-0.096503,0.349594,-0.050894,-0.049696
openstack/charm-keystone-k8s,I0a02be6d0d9382bacbd53aaa18a2f6d4a6d126c0,1,0,0,2.4849,0.4545,1,14.0,287,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0,0.0,4.0,41.55,13.22,1,0,0.0,0,23.9167,0,0,0,0,0,"Only emit process_op event when there's a request

On relation creation / change, there's a timeframe where the request is
empty. In this case, the previous code returned an empty dict, that
could not be decoded by the json library.
[SEP]
FILES CHANGED:
lib/charms/keystone_k8s/v0/identity_resource.py (+6, -5)
",1.075838,-1.981396,0.340448,0.336296,-0.800152,0.597982,0.959926,-0.94024,0.126013,-0.005564,-0.054669,0.189153,-0.221188,0.11245,-0.081688
openstack/kolla-ansible,I9e3eb3aca01fb94a92153e26659c2c412de98093,0,0,0.3333,1.6094,0.5,1,14.0,182,0,Feature,0,0,0,9,0.070312,0.5769,0,0.1923,0,1,0,0.8078,0.0,0.0,56.66,8.46,1,0,0.0,1,36.4,0,0,0,0,0,"Use py3 as the default runtime for tox

Moving on py3 as the default runtime for tox to avoid to update this at
each new cycle.
[SEP]
FILES CHANGED:
tox.ini (+2, -2)
",1.329168,-0.798728,0.296606,0.934782,0.096492,0.39149,0.10282,-0.440457,-0.445032,0.167759,-0.30136,0.366195,-0.299826,-0.084021,0.384875
openstack/charm-ceph-fs,Ia885ce41043a4cb04a6d92993474c44e9b994c55,1,0,1.0,2.3979,0.0,1,13.67,273,0,Doc,0,0,0,8,0.019608,0.0,1,0.0,1,1,0,1.0,0.0,1.0,48.52,15.22,1,0,0.0,0,24.8182,0,0,0,0,0,"Document rationale for erasure coded pools

This addresses the questions:

- Why doesn't the charm let me use an erasure coded pool as the default?
- How do I use the secondary erasure coded pool once it is configured?
[SEP]
FILES CHANGED:
src/README.md (+10, -0)
",-0.832525,-1.486015,-0.452063,0.74712,0.433785,0.286894,-0.436338,-0.534354,-0.606792,0.377898,-0.028056,0.392799,0.270638,0.173861,0.092418
openstack/charm-keystone,I8d738b4aa89ba2e01236ae4dfd109864e53747a7,1,1,1.0,3.6109,0.1111,7,17.67,413,0,Bug Fix,0,0,0,10,0.037453,1.0,0,1.0,4,3,0,1.0,2.6416,2.86,14.91,16.12,1,0,0.0,1,11.1622,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,Ib89f6124b81ffb2579f9bd6c4bf25337ad2d4d19,1,1,1.0,3.6109,0.1111,7,17.67,413,0,Bug Fix,0,0,0,11,0.036304,1.0,0,1.0,4,3,0,1.0,2.6416,2.86,22.9,15.37,1,0,0.0,1,11.1622,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-cinder,Ibbba1aaafb82da9fa5f28125bf459ffca3b84888,1,1,1.0,3.6109,0.1111,7,17.67,413,0,Bug Fix,0,0,0,12,0.035398,1.0,0,1.0,4,3,0,1.0,2.6416,2.86,16.51,16.12,1,0,0.0,1,11.1622,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,Ic826edf55267f2f73364ff54e8c6a8bf7bc097b4,1,1,1.0,3.6109,0.1111,7,17.67,413,0,Bug Fix,0,0,0,13,0.034667,1.0,0,1.0,4,3,0,1.0,2.6416,2.86,19.7,16.12,1,0,0.0,1,11.1622,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,If1f41ae2c3048540f9bcace4bbb9d24200cfb427,1,1,1.0,3.6109,0.1111,7,17.67,413,0,Bug Fix,0,0,0,14,0.034063,1.0,0,1.0,4,3,0,1.0,2.6416,2.86,19.7,16.12,1,0,0.0,1,11.1622,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+1, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,Ifb0452bbfa9c80312a3a300b0730a102202d397f,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,15,0.033557,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,18.11,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,I57bbff08cd2ef8ac8aef58675aefa6dfea11f167,1,1,1.0,3.2958,0.0385,5,17.67,413,0,Bug Fix,0,0,0,16,0.033827,1.0,0,1.0,4,3,0,1.0,2.1997,2.6,14.91,16.12,1,0,0.0,1,15.2963,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,Ifbe2f230dfe0fead4d9d1751eb7ed77009e819ab,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,17,0.034068,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,13.32,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/kolla-ansible,Ib8d7182cc4b8a0c7d320ba2c51b2157782030317,0,0,0.9375,4.6151,0.12,7,3.25,186,0,Feature,0,0,0,48,0.065663,0.6667,0,0.625,4,4,0,0.8052,2.3889,3.14,-37.25,19.76,1,0,0.0,1,1.8416,0,0,0,0,0,"Add support for OpenSearch 2.x as CloudKitty storage backend

Depends-On: https://review.opendev.org/c/openstack/cloudkitty/+/880739
[SEP]
FILES CHANGED:
doc/source/reference/rating/cloudkitty-guide.rst (+13, -5)
ansible/roles/cloudkitty/tasks/bootstrap.yml (+34, -2)
ansible/roles/cloudkitty/defaults/main.yml (+12, -2)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+11, -1)
ansible/group_vars/all.yml (+1, -1)
releasenotes/notes/cloudkitty-opensearch-2ea5cb46eeb31847.yaml (+16, -0)
etc/kolla/globals.yml (+1, -1)
",-0.207371,3.083754,-1.419015,0.083465,-0.971598,0.244546,-0.159229,0.179388,-0.120247,-0.391002,-0.859759,0.224274,-0.038255,-0.576654,0.218659
openstack/charm-ceph-mon,Ib21ded8f4a977b4a2d57c6b6b4bb82721b12c4ea,1,1,0,3.2581,0.04,3,21.5,368,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,5,1,0,0.963,0.7943,2.33,13.85,18.83,0,0,0.84,0,14.1538,0,14,0,7,0,"Add profile-name parameter in create-pool action

This change adds a profile name parameter in the create-pool action that
allows a replicated pool to be created with a CRUSH profile other than
the default replicated_rule.

Closes-Bug: #1905573

(cherry picked from commit da798bdd95f8fa19ce42363be6bfb268d62fe690)
[SEP]
FILES CHANGED:
actions/create_pool.py (+2, -0)
hooks/charmhelpers/contrib/storage/linux/ceph.py (+1, -1)
unit_tests/test_ceph_ops.py (+21, -0)
",-0.75126,-0.724984,-0.901328,-0.584937,0.5869,0.083434,0.559966,0.091509,0.788155,0.011931,0.11334,0.061799,0.463383,0.351264,-0.061691
openstack/openstack-ansible-os_nova,I3deea859a4017ff96919290ba50cb375c0f960ea,1,1,0.9386,2.5649,0.0833,3,16.29,770,0,Bug Fix,0,0,0,114,0.041022,0.9286,0,0.8716,1,1,0,1.0,1.0409,1.0,43.37,13.88,0,0,0.0,0,59.2308,0,14,0,21,0,"Fix logic of discovering hosts by service

For quite some time, we relate usage of --by-service flag for
nova-manage cell_v2 discover_hosts command to the used nova_virt_type.
However, we run db_post_setup tasks only once and delegating to the
conductor host. With latest changes to the logic, when this task in
included from the playbook level it makes even less sense, since
definition of nova_virt_type for conductor is weird and wrong.

Instead, we attempt to detect if ironic is in use by checking hostvars
of all compute nodes for that. It will include host_vars, group_vars,
all sort of extra variables, etc.

Thus, ironic hosts should be better discovered now with nova-manage
command.

Related-Bug: #2034583
[SEP]
FILES CHANGED:
tasks/nova_db_post_setup.yml (+1, -1)
defaults/main.yml (+1, -0)
vars/main.yml (+9, -0)
",-1.963593,-1.4555,1.810128,-0.07137,-0.066637,-0.413518,0.236276,0.047409,0.148153,-0.448972,-0.054252,-0.023395,-0.165528,-0.189109,0.04469
openstack/kolla-ansible,Idede07a5f0fd1a3ee63e1c54a263e358e95b3a86,1,0,0.8793,0.0,0,2,4.67,172,0,Bug Fix,0,0,0,58,0.049828,0.0,0,0.0,4,1,0,0.8026,0.0,4.0,-63.79,16.15,0,0,0,0,172.0,0,0,0,0,0,"Rename per role filters files

Related to ansible-core bug [1].

[1]: https://github.com/ansible/ansible/issues/81945
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/filter_plugins/kolla_nova_cell_filters.py (+0, -0)
ansible/roles/common/filter_plugins/kolla_common_filters.py (+0, -0)
",-0.185239,2.511303,-1.115712,0.36679,-0.734339,0.152713,-0.722406,-0.129168,-0.035874,0.266136,-0.390802,-0.046258,0.150913,-0.115644,-0.349021
openstack/openstack-ansible-os_nova,Iaa14a9bf80d2e02197e74d67e812afc518fe1b65,1,0,0,0.6931,0.0,1,17.5,257,0,Feature,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,29.54,15.0,1,0,0.0,0,128.5,0,0,0,0,0,"Use internal endpoint for barbican API

Nova defaults to using public endpoint for Barbican API which would
require internet access from the compute node so change this to
use the internal API endpoint.
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -0)
",0.88793,-1.258918,0.211872,1.102571,0.084586,0.107077,0.330869,0.332121,-0.229875,-0.142946,-0.357512,0.213795,-0.068619,-0.421948,-0.172393
openstack/openstack-ansible-os_keystone,I27c612cf8537b401c1195ae0892bf5569e2f3858,1,0,1.0,3.4965,0.2188,4,10.67,418,0,Bug Fix,0,0,0,27,0.078488,1.0,0,1.0,2,4,0,1.0,1.782,1.5,57.21,10.52,0,0,0.0,1,12.6667,0,0,0,0,0,"oidc: fix overloading of redirect_uri for cli client

The redirect URI specified in the Apache config for OIDC
was unintentionally serving a dual purpose as a redirect
URI and a handler for command line auth.

As of mod_auth_openidc v2.4.9 this no longer works.
This change splits the paths for command line auth and
the redirect URI into two to work around this.
[SEP]
FILES CHANGED:
doc/source/configure-federation-sp.rst (+5, -5)
templates/keystone-httpd.conf.j2 (+6, -1)
releasenotes/notes/oidc-fix-redirect-uri-5909172a1db5457f.yaml (+13, -0)
defaults/main.yml (+1, -1)
",-0.251977,-1.229882,0.23038,0.550983,-0.262437,0.017322,0.610875,0.363048,0.218724,0.305552,-0.062966,-0.0451,-0.189414,-0.177101,0.497302
openstack/charm-ceilometer,Ie14df0f5fc7ee18072091dbdb3ada817615a6670,1,0,0,1.9459,0.0,3,16.0,598,1,Feature,0,0,0,0,0.0,0.0,0,0.0,2,2,0,1.0,1.2516,1.33,20.34,14.4,1,0,0.6667,1,85.4286,0,0,0,0,0,"Add missing region setting in service_credentials

This change adds the missing region setting in service_credentials. In a
shared keystone multi region setup, this setting is mandatory in order
for ceilometer to properly find the services it relies upon from the
same region it resides in. Without this setting, the ceilometer-upgrade
action will fail (along with any other calls made to ceilometer) if the
first endpoint returned by keystone is from a different region.
[SEP]
FILES CHANGED:
templates/rocky/ceilometer.conf (+1, -0)
unit_tests/test_ceilometer_contexts.py (+4, -0)
lib/ceilometer_contexts.py (+1, -0)
",-1.464794,-0.990934,0.12539,1.24974,0.568652,-0.173963,0.087147,-0.165599,0.377243,-0.014026,0.168589,0.341354,-0.023684,0.006626,0.222195
openstack/openstack-ansible-repo_server,I900a55a6f4edce3d3fe419821c47cf56d641192f,1,0,0.9391,0.6931,0.0,1,17.0,411,0,Feature,0,0,0,115,0.041204,0.0,0,0.0,1,1,0,1.0,0.0,1.0,63.92,12.09,0,0,0.0,0,205.5,0,0,0,0,0,"Ensure mounts are present only when they are expected to exist

At the moment there is a check, which ensures for race condition to
not happen between asking for a mount and mounting the point.
However, it tries to check for the mount when there is no mount
defined for the directory.

We add extra check to wait for the mount only when mounts are defined.
[SEP]
FILES CHANGED:
tasks/repo_pre_install.yml (+1, -0)
",0.201421,-2.33442,0.395044,0.852923,-0.416607,0.16288,0.873432,-0.870823,0.120759,0.624921,-0.193681,-0.038657,0.145339,0.092377,0.034697
openstack/openstack-ansible-os_nova,I7be8c41bd52b955d83c4452e67ef323abe00969e,1,0,0.9397,1.0986,0.5,1,6.67,370,0,Doc,0,0,0,116,0.041547,1.0,0,0.9397,1,1,0,1.0,0.0,1.0,1.26,11.67,0,0,0.0,0,123.3333,0,0,0,0,0,"Drop until-complete  flag for db purge

Flag --until-complete is not valid for the nova-manage db purge command,
it is working only for archive_deleted_rows [1]. Suposedly it was a
copy/paste mistake to keep the flag in place.

[1] https://docs.openstack.org/nova/latest/cli/nova-manage.html#db-archive-deleted-rows
[SEP]
FILES CHANGED:
tasks/nova_db_post_setup.yml (+1, -1)
",-1.446366,1.116095,-0.55793,0.770416,-0.131682,-0.309477,0.311784,-0.144356,0.060621,0.184085,0.209196,-0.116422,0.224156,0.143744,0.069506
openstack/charm-cinder,I6807128492cb184de3ef5f454d0ea745246b242e,1,0,0.9412,2.5649,0.0,1,4.43,280,0,CI,1,0,0,17,0.007173,1.0,0,0.9412,1,1,0,1.0,0.0,1.0,30.41,9.51,1,0,1.0,0,21.5385,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+12, -0)
",-0.230233,-0.20967,-0.458607,0.808968,0.47224,-0.416138,-0.352098,-0.017304,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/kolla-ansible,Ibcffa5d8922c470f655f447558d4a9c73b1ba361,0,1,0.0,3.5553,0.0294,3,18.25,530,0,Bug Fix,0,0,0,1,0.00813,0.5,0,0.0,4,2,0,0.8032,1.2141,3.33,28.38,16.62,1,0,0.0,1,15.1429,0,6,0,7,0,"Remove the `grafana` volume

Fixes not being able to add additional plugins at build time due to the
`grafana` volume being mounted over the existing `/var/lib/grafana`
directory. This is fixed by copying the dashboards into the container
from an existing bind mount instead of using the ``grafana`` volume.
This however leaves behind the volume which should be removed with
`docker volume rm grafana` or by setting `grafana_remove_old_volume` to
`True`.

Closes-Bug: #2039498
[SEP]
FILES CHANGED:
releasenotes/notes/grafana-volume-81d569128d9e020f.yaml (+23, -0)
ansible/roles/grafana/tasks/post_config.yml (+7, -0)
ansible/roles/grafana/defaults/main.yml (+3, -1)
",-1.36524,-0.260146,0.031503,0.523703,0.307396,0.087011,0.017151,0.200014,0.283967,-0.267887,0.302383,-0.237036,-0.370487,-0.067709,-0.091275
openstack/charm-nova-cloud-controller,I25df688c9ec07168b825815b1e1c27ecf2673d2b,1,0,0.9444,2.8904,0.0588,2,4.43,280,0,CI,1,0,0,18,0.007557,1.0,0,0.9444,1,1,0,1.0,0.874,1.0,30.41,9.51,1,0,1.0,0,15.5556,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+12, -0)
unit_tests/test_nova_cc_contexts.py (+4, -1)
",-0.230233,-0.20967,-0.458607,0.808968,0.47224,-0.416138,-0.352098,-0.017304,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-neutron-api,I2cc91999ccad52c8e42797a3d5ffbf65f9cb36d2,1,0,0.9474,2.8332,0.125,2,4.43,280,0,CI,1,0,0,19,0.00792,1.0,0,0.9474,1,1,0,0,0.8113,1.0,30.41,9.51,1,0,1.0,0,16.4706,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+12, -0)
unit_tests/test_neutron_api_context.py (+2, -2)
",-0.230233,-0.20967,-0.458607,0.808968,0.47224,-0.416138,-0.352098,-0.017304,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-openstack-dashboard,I9c5beab362cbf747eb757645fa3704043a2f14c7,1,0,0.95,2.6391,0.0,1,4.43,280,0,CI,1,0,0,20,0.008282,1.0,0,0.95,1,1,0,1.0,0.0,1.0,27.68,9.51,1,0,1.0,0,20.0,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+13, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-swift-proxy,Ic558fa7bab80b0dabc3e5a06d7494e2688c027b3,1,0,0.9524,2.7726,0.0,1,4.43,280,0,CI,1,0,0,21,0.008649,1.0,0,0.9524,1,1,0,0,0.0,1.0,22.22,9.51,1,0,1.0,0,17.5,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+15, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-keystone,I4fbfa8fba84b11c4e30e4db9a0c358db1e8c94f1,1,0,0.9545,2.6391,0.0,1,4.43,280,0,CI,1,0,0,22,0.009005,1.0,0,0.9545,1,1,0,1.0,0.0,1.0,22.22,9.51,1,0,1.0,0,20.0,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+13, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-glance,I7b0d02c915e2f7ae1d6d86cd829895530643de45,1,0,0.9565,2.6391,0.0,1,4.43,280,0,CI,1,0,0,23,0.009365,1.0,0,0.9565,1,1,0,1.0,0.0,1.0,30.41,9.51,1,0,1.0,0,20.0,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+13, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-glance-simplestreams-sync,Ic35061597a52dda749f2e6e3f3d255f831c82a06,1,0,0.9583,2.7081,0.0,1,4.43,280,0,CI,1,0,0,24,0.009721,1.0,0,0.9583,1,1,0,1.0,0.0,1.0,24.95,9.51,1,0,1.0,0,18.6667,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+14, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-ceilometer,I89fd1e19dd946f037615f9115e08aba8d78826db,1,0,0.96,2.7081,0.0,1,4.43,280,0,CI,1,0,0,25,0.010068,1.0,0,0.96,1,1,0,1.0,0.0,1.0,27.68,9.51,1,0,1.0,0,18.6667,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+14, -0)
",-0.230233,-0.20967,-0.458606,0.808968,0.472241,-0.416138,-0.352098,-0.017305,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-ceilometer-agent,I7116d1232d19996e39665f5e6f15dae7b8e74118,1,0,0.9615,2.7081,0.0,1,4.43,280,0,CI,1,0,0,26,0.010412,1.0,0,0.9615,1,1,0,1.0,0.0,1.0,27.68,9.51,1,0,1.0,0,18.6667,0,0,0,0,0,"Improve platform mocking

Patch out charmhelpers.osplatform.get_platform() and
charmhelpers.core.host.lsb_release() globally in the unit tests to
insulate the unit tests from the platform that the unit tests are being
run on.
[SEP]
FILES CHANGED:
unit_tests/__init__.py (+14, -0)
",-0.230233,-0.20967,-0.458607,0.808968,0.47224,-0.416138,-0.352098,-0.017304,0.133427,-0.853526,-0.60995,0.164809,-0.769078,0.502163,-0.020105
openstack/charm-ceph-iscsi,I781a2e33b3de9f55b97fddd661214f601fc6134e,1,1,0.6667,1.9459,0.1667,1,10.5,191,0,Bug Fix,0,0,0,6,0.004348,0.8125,0,0.5417,1,1,0,1.0,0.0,1.0,39.06,15.63,1,0,0.0,0,27.2857,0,6,0,13,0,"Set iscsi pools' application

This patchset sets the default application name for the charm-created
pools to 'rbd'.

Closes-bug: #2040274
[SEP]
FILES CHANGED:
src/charm.py (+5, -1)
",-0.703627,-1.183539,-1.755399,-1.455657,0.778582,-0.121304,0.300883,0.153213,0.46543,0.096934,-0.379923,-0.175005,0.272321,0.353716,-0.028225
openstack/octavia,Ifdcfcaea679d0ddb6b7b0e3c88586a61a5d627cc,0,0,0.5909,2.8332,0.5,7,14.0,129,0,Doc,0,0,0,22,0.003221,0.0,0,0.0,4,2,0,0.6091,2.75,3.86,5.3,22.74,1,0,0.0,1,7.5882,0,0,0,0,0,"Run codespell on doc directory

Result of running:

$ codespell -w octavia
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+1, -1)
doc/source/user/feature-classification/feature-matrix-pool.ini (+1, -1)
doc/source/user/guides/basic-cookbook.rst (+2, -2)
doc/source/contributor/guides/providers.rst (+1, -1)
doc/source/user/guides/l7.rst (+1, -1)
doc/source/user/feature-classification/feature-matrix-listener.ini (+1, -1)
doc/source/user/guides/monitoring.rst (+1, -1)
",0.363368,-0.401001,-0.494612,-0.114235,0.562685,0.110182,-1.461881,-0.280089,-0.286517,-0.310332,-0.12811,0.037623,0.14884,0.960659,-0.258165
openstack/octavia,I85354ddafc61f2ab064330ae4b630366dfed0cbb,0,0,0.5652,4.1744,0.5,27,15.0,141,0,Feature,0,0,0,23,0.00336,1.0,0,0.5652,6,2,0,0.6073,4.6875,3.67,-5.79,24.67,1,0,0.1562,0,2.1692,0,0,0,0,0,"Run codespell on octavia package directory

Result of running:

$ codespell -w octavia
[SEP]
FILES CHANGED:
octavia/api/common/pagination.py (+2, -2)
octavia/common/config.py (+1, -1)
octavia/tests/common/sample_haproxy_prometheus (+1, -1)
octavia/tests/functional/api/test_healthcheck.py (+2, -2)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+1, -1)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+1, -1)
octavia/db/migration/alembic_migrations/versions/55874a4ceed6_add_l7policy_action_redirect_prefix.py (+1, -1)
octavia/common/validate.py (+2, -2)
octavia/cmd/house_keeping.py (+1, -1)
octavia/db/migration/alembic_migrations/versions/6742ca1b27c2_add_l7policy_redirect_http_code.py (+1, -1)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+1, -1)
octavia/controller/worker/v2/controller_worker.py (+2, -2)
octavia/db/repositories.py (+1, -1)
octavia/controller/worker/v2/tasks/lifecycle_tasks.py (+1, -1)
octavia/amphorae/backends/agent/api_server/lvs_listener_base.py (+1, -1)
octavia/network/drivers/neutron/allowed_address_pairs.py (+1, -1)
octavia/distributor/drivers/driver_base.py (+1, -1)
octavia/cmd/health_manager.py (+1, -1)
octavia/common/tls_utils/cert_parser.py (+1, -1)
octavia/db/prepare.py (+1, -1)
octavia/common/base_taskflow.py (+1, -1)
octavia/amphorae/backends/utils/interface.py (+1, -1)
octavia/db/migration/alembic_migrations/versions/5a3ee5472c31_add_cert_expiration__infor_in_amphora_table.py (+1, -1)
octavia/cmd/driver_agent.py (+1, -1)
octavia/controller/worker/v2/tasks/compute_tasks.py (+1, -1)
octavia/amphorae/drivers/health/heartbeat_udp.py (+2, -2)
octavia/tests/unit/amphorae/backends/utils/test_keepalivedlvs_query.py (+1, -1)
",0.148229,0.076358,-0.679761,0.382886,0.92088,0.139119,-1.281143,-0.107804,-0.328424,-0.317024,0.048469,0.259359,0.196437,0.78671,-0.059417
openstack/charm-ceph-iscsi,Ida720e5381d0ff3446cf88405452f8a3778c7efc,1,1,0.7143,3.6889,0.1538,2,11.0,212,0,Bug Fix,0,0,0,7,0.005051,1.0,0,0.7143,1,1,0,1.0,0.7321,1.0,7.24,20.76,1,0,0.2051,0,5.3,0,8,0,6,0,"Reject invalid username and password

This patchset checks that the username and password parameters
comply with ceph-iscsi requirements.

Fixes-bug: #2040328
[SEP]
FILES CHANGED:
src/charm.py (+29, -2)
unit_tests/test_ceph_iscsi_charm.py (+4, -4)
",-0.673272,-0.88117,-1.616665,-1.433192,0.790028,-0.072312,0.353504,-0.120593,0.50579,0.161209,-0.364995,-0.129247,0.324658,0.101364,0.071563
openstack/charm-swift-proxy,Ib5f446d617c11c9c9046c33335c1099b21b5166e,1,1,1.0,3.2189,0.8333,1,7.5,325,0,Bug Fix,0,0,0,42,0.005144,1.0,0,1.0,3,1,0,1.0,0.0,3.0,-6.64,19.0,0,0,0.0,0,13.0,0,6,0,30,0,"Enable swift payload upgrades for wallaby+

Sync charm-helpers to pick up fix for openstack_upgrade_available
that enables successful payload upgrades. This will need backporting
to stable/wallaby.

https://github.com/openstack-charmers/zaza/pull/619
Closes-Bug: #2040606
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/utils.py (+4, -20)
",0.139123,0.191339,-0.783288,-0.299015,-0.662248,-0.418879,-0.011786,0.430588,-0.074914,-0.158051,-0.337208,-0.398096,0.045918,-0.346099,0.545898
openstack/openstack-ansible,Idc924d4ee485c8e6efc15b90df90ba5021a106e4,1,0,0.9402,1.0986,0.5,1,16.17,641,0,Feature,0,0,0,117,0.041875,0.5,0,0.4701,3,1,0,0.9155,0.0,3.0,38.67,15.54,0,0,0.0,0,213.6667,0,0,0,0,0,"Map default value of rabbitmq_management_ssl to haproxy_ssl

At the moment all haproxy backends are defined if TLS should be used by
using `haproxy_ssl` variable. If deployer don't want to have SSL, they
are supposed to use the variable for that. However, the only service that
is not respecting that is RabbitMQ management interface.

As a result haproxy fails with the invalid configuration, since
certificates are not provisioned when `haproxy_ssl` is False.
So configuration at the end is invalid as reffer to the certificate
that does not exist on the host and was not even issued.
[SEP]
FILES CHANGED:
inventory/group_vars/all/all.yml (+1, -1)
",-1.438254,-1.468243,0.749273,0.729291,-0.022258,-0.06534,0.349042,-0.332437,-0.057873,0.110391,0.302469,-0.14686,-0.404916,-0.202056,-0.22653
openstack/octavia,I16622add64076370dad85620043f71077bc9acbb,0,0,0.5091,6.6451,0.1771,38,9.0,94,0,Feature,0,0,0,110,0.004321,0.8,0,0.4073,7,6,0,0.6054,4.2645,3.87,37.9,16.93,1,0,0.4167,1,0.1222,0,0,0,0,0,"Add support for SR-IOV ports in Octavia
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+8, -0)
octavia/controller/worker/v2/flows/flow_utils.py (+6, -5)
doc/source/admin/index.rst (+1, -0)
octavia/api/v2/controllers/load_balancer.py (+7, -0)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+28, -2)
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+105, -0)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+44, -34)
doc/source/admin/sr-iov.rst (+89, -0)
octavia/compute/drivers/nova_driver.py (+23, -5)
octavia/api/drivers/amphora_driver/flavor_schema.py (+6, -1)
octavia/common/constants.py (+13, -0)
octavia/controller/worker/v2/controller_worker.py (+2, -2)
api-ref/source/v2/examples/loadbalancer-create-response.json (+2, -1)
api-ref/source/v2/examples/loadbalancers-list-response.json (+2, -1)
octavia/tests/functional/db/test_models.py (+2, -1)
octavia/network/base.py (+3, -1)
octavia/network/data_models.py (+4, -1)
octavia/network/drivers/noop_driver/driver.py (+9, -5)
octavia/network/drivers/neutron/allowed_address_pairs.py (+19, -7)
octavia/tests/functional/api/v2/test_load_balancer.py (+17, -0)
octavia/controller/worker/v2/flows/amphora_flows.py (+24, -10)
octavia/common/exceptions.py (+5, -0)
octavia/tests/unit/compute/drivers/test_nova_driver.py (+22, -0)
octavia/db/migration/alembic_migrations/versions/db2a73e82626_add_vnic_type_for_vip.py (+36, -0)
octavia/db/models.py (+1, -0)
api-ref/source/v2/examples/loadbalancer-full-create-response.json (+2, -1)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+44, -19)
api-ref/source/v2/examples/loadbalancer-update-response.json (+2, -1)
octavia/tests/functional/db/test_repositories.py (+2, -1)
octavia/api/v2/types/load_balancer.py (+5, -1)
octavia/common/data_models.py (+3, -1)
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+27, -33)
api-ref/source/v2/loadbalancer.inc (+4, -0)
octavia/api/root_controller.py (+4, -1)
octavia/controller/worker/v2/tasks/network_tasks.py (+57, -0)
octavia/tests/unit/network/drivers/neutron/test_utils.py (+2, -0)
setup.cfg (+0, -1)
api-ref/source/v2/examples/loadbalancer-show-response.json (+2, -1)
",2.287208,1.097255,0.952909,0.206888,0.424486,-0.087936,0.056137,1.228653,-0.322702,0.216566,-0.115244,0.631382,0.576301,-0.765303,0.141579
openstack/charm-ceph-dashboard,Ic24b5885c1289c2653f4280f7fe2815b1c2afb15,1,1,0.9615,3.4965,0.375,2,14.0,180,0,Bug Fix,0,0,0,26,0.003938,0.8333,0,0.8013,1,1,0,0.8462,0.8571,1.0,-6.79,19.89,1,0,0.2812,0,5.4545,0,8,0,11,0,"Fix status handling for non-leaders

Closes-bug: 2039763

(cherry picked from commit 4ee08c02972ba174ba379728e9ab1f045bacd1a4)
[SEP]
FILES CHANGED:
src/charm.py (+20, -3)
unit_tests/test_ceph_dashboard_charm.py (+0, -9)
",-0.237693,-0.689137,-2.271506,-2.44739,1.12047,0.422834,0.052562,-0.572652,0.216651,-0.158558,-0.229822,0.465224,0.204095,-0.066497,-0.0678
openstack/kolla-ansible,I4b1da63e8f0cc2774f1a9ab2e0414746108f7e12,1,1,0.8902,2.3979,0.5,1,16.71,756,0,Bug Fix,0,0,0,82,0.025046,1.0,0,0.8902,1,1,0,0.8006,0.0,1.0,51.76,13.52,0,0,0.0,0,68.7273,0,10,0,13,0,"fact gathering: Group hosts before gathering facts

If not using --limit, each host runs the setup module for itself only.
Hosts should be able to fail at this point and drop out of execution
without affecting others. However, there is a bug that causes us to hit
the --limit code path for an unreachable host and therefore become
subject to its limitations.  These include the use of delegated fact
gathering, and failing the delegated host when the delegating host is
unreachable.

This change fixes the issue by reversing the order of two tasks in the
gather-facts.yml playbook, ensuring that we check the ansible_play_batch
variable before any hosts have had a chance to fail.

Closes-Bug: #2041859
[SEP]
FILES CHANGED:
ansible/gather-facts.yml (+5, -5)
",-1.813194,-1.627811,1.139029,0.209273,-0.265235,0.032151,0.040211,-0.396245,0.265058,0.054157,0.22568,0.293041,-0.013109,-0.216149,0.038424
openstack/kolla-ansible,I207ca56362de00d8ec578333eab9e1a72e7bcd19,0,1,0.8916,4.9488,0.1143,5,23.46,1930,0,Bug Fix,0,0,0,83,0.025274,1.0,0,0.8916,4,4,0,0.8013,1.9525,2.8,38.23,17.38,1,0,0.4643,1,13.6879,0,8,0,11,0,"prometheus: Support overriding address of scrape targets

In many cases we use the kolla_address filter to look up the IP address
of the current host or another host on a particular network interface.
This filter uses the host's facts to determine the IP, meaning that we
must have gathered facts for the host, even if it is outside of a
requested --limit. This is a limitation, since it requires that all
hosts must be reachable, even if we are not directly configuring them.

Most instances of this cross-host fact referencing involve a controller,
since they host clustered services. The only instance found to affect
compute nodes is in the prometheus role, where Prometheus server needs
to know the IP address of all targets in its scrape configs.

If we are able to specify the address of the scrape targets as a static
variable such as a host variable, then facts would not be required for
compute nodes outside of the --limit.

Removing the requirement to have facts for all compute nodes has
benefits for performance (gathering facts for all hosts can take a long
time) and fault tolerance (we can operate when some compute hosts are
unreachable).

This change modifies the kolla_address filter to accept an optional
override_var argument which can be used to specify the name of a host
variable that may override the returned IP address. This is used in the
Prometheus server configuration to allow specifying the IP address used
by Prometheus server when collecting metrics from exporter using
a 'prometheus_target_address' host variable. If specified, this takes
precedence over the API interface address currently used. This makes it
possible to statically override prometheus_target_address and avoid the
cross-host fact reference.

This is not a complete solution because it is not yet possible to skip
the cross-host fact gathering step.

Partial-Bug: #2041860
[SEP]
FILES CHANGED:
kolla_ansible/kolla_address.py (+24, -1)
releasenotes/notes/prometheus-target-address-4d2d5624ee6ae5a0.yaml (+6, -0)
doc/source/reference/logging-and-monitoring/prometheus-guide.rst (+13, -0)
kolla_ansible/tests/unit/test_address_filters.py (+65, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+16, -15)
",-2.603387,-0.935522,4.311567,-0.419122,-0.251437,0.312186,-0.658435,-0.569546,0.133129,-0.192369,-1.007627,0.652018,-0.147299,-0.267697,-0.047651
openstack/kolla-ansible,I25e5450d1caeebd9c900c190fc0079988f1ca574,1,1,0.881,2.7081,0.0,2,10.0,258,0,Bug Fix,0,0,0,84,0.024533,0.6667,0,0.5873,4,2,0,0.7987,0.9852,3.0,2.11,22.0,0,0,0.0,1,17.2,0,6,0,4,0,"prometheus: Add friendly instance labels for ironic and alertmanager

These were omitted from I387c9d8f5c01baf6054381834ecf4e554d0fff35 and
I387c9d8f5c01baf6054381834ecf4e554d0fff35.

Closes-Bug: #2041855
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus.yml.j2 (+8, -0)
releasenotes/notes/prom-friendly-label-fix-dc665f81a0aa1081.yaml (+6, -0)
",-1.996055,0.003128,-2.128832,-1.227106,1.690995,0.131147,-0.334811,-0.157382,0.018072,0.625591,0.119342,0.024718,0.520666,-0.012991,0.56606
openstack/kolla-ansible,I2e799290a57ebfacbc0ff9a0b1ca3dc956c513df,1,1,0,2.0794,0.0,2,11.33,309,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7994,0.8631,3.0,3.74,17.47,1,0,0.0,1,38.625,0,6,0,13,0,"Fix images pull in ovs-dpdk role

This patch fixes ovs-dpdk images pull by adding
the variable kolla_role_name to the ovs-dpdk vars, so
services-image-pull can work correctly.

Closes-Bug: #2041864
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2041864-f19f9a6afd0955e8.yaml (+5, -0)
ansible/roles/ovs-dpdk/vars/main.yml (+2, -0)
",-0.034671,0.280247,-0.893644,0.549507,0.201719,-0.54707,-0.359013,-0.010758,0.220881,-0.590884,0.15174,-0.062962,0.03048,0.235277,0.343139
openstack/openstack-ansible-os_nova,I697234bda1601b534ce1b6ab186fa98f83179ee8,1,1,0.8421,2.4849,0.5455,1,13.8,504,0,Bug Fix,0,0,0,19,0.064846,0.0,0,0.0,3,1,0,1.0,0.0,3.0,30.98,14.22,0,0,0.0,0,42.0,0,264,0,11,0,"Always disable libvirt default network

Currently, autostart for libvirt default network is disabled only when
this network is active during nova playbook execution.
It's an incorrect behavior because in some cases this network may not be
active from the beginning.
Autostart should be always disabled to ensure that this network will not
be unexpectedly marked as active in the future(during package upgrade,
host reboot etc.).

Closes-Bug: #2042369
[SEP]
FILES CHANGED:
tasks/drivers/kvm/nova_compute_kvm_virsh_net_remove.yml (+5, -6)
",-0.462754,-1.7545,0.320389,0.458494,-0.440238,0.075414,0.457404,-0.113186,0.127196,0.227128,0.260914,0.056887,0.176006,-0.046166,0.043392
openstack/openstack-ansible-os_ironic,I5eee7d054bb4eda70acbaab9885c3985efb04002,1,0,1.0,1.0986,0.5,1,31.0,258,0,Feature,0,0,0,28,0.074468,0.0,0,0.0,1,1,0,1.0,0.0,1.0,36.19,17.56,0,0,0.0,0,86.0,0,0,0,0,0,"Use common value for inspector callback URL

It appears this was missed in patch
Ib8d53b394937405c821687b1c46b2b19112267dd

This patch conforms the other pxe config to use the same
inspector callback URL
[SEP]
FILES CHANGED:
templates/pxelinux-default.j2 (+1, -1)
",-0.43567,-1.257288,-1.454503,-1.180128,1.077012,0.202487,-0.132537,-0.317286,0.139006,0.056254,-0.508828,0.346333,-0.070272,0.013205,-0.097323
openstack/charm-cinder,Ib249be7f03ed3156c81fffb6cbac251c502e9b80,1,1,1.0,3.5553,0.0294,6,17.67,413,0,Bug Fix,0,0,1,18,0.034156,1.0,0,1.0,4,4,0,1.0,2.4692,2.17,18.11,16.12,1,0,0.2353,1,11.8,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+8, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-keystone,Ib489997a054cdfb3161c84281fa62bf7a7c8d623,1,1,1.0,3.434,0.0333,6,17.67,413,0,Bug Fix,0,0,1,19,0.033868,1.0,0,1.0,4,4,0,1.0,2.4729,2.17,19.7,16.12,1,0,0.1333,1,13.3226,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,Icd8dd674b6b5767a5db766dc1ba79bb216bbce3a,1,1,1.0,3.434,0.0333,6,17.67,413,0,Bug Fix,0,0,1,20,0.033841,1.0,0,1.0,4,4,0,1.0,2.4729,2.17,18.11,16.12,1,0,0.1333,1,13.3226,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,Ic97928e48866d5e32c6be20490159a47c0bacf6e,1,1,1.0,3.434,0.0333,6,17.67,413,0,Bug Fix,0,0,1,21,0.033816,1.0,0,1.0,4,4,0,1.0,2.4729,2.17,16.51,16.12,1,0,0.1333,1,13.3226,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-cinder,Ib9d8bae0aaf49f836c0165c82fd5e66b3fbe64cb,1,1,1.0,3.4012,0.0345,5,17.67,413,0,Bug Fix,0,0,1,22,0.033794,1.0,0,1.0,4,4,0,1.0,2.2528,2.2,18.11,16.12,1,0,0.1379,1,13.7667,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -1)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-keystone,I54bc6a95bdb46f9e25516e941c53e5f03710e374,1,1,1.0,3.4965,0.0,5,17.67,413,0,Bug Fix,0,0,1,23,0.033824,1.0,0,1.0,4,4,0,1.0,2.2806,2.2,16.51,16.12,1,0,0.25,1,12.5152,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+8, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,Ib0037e3966ef300edc3473268d57f3f7a3b9c260,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,24,0.033708,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,18.11,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,I0d71fde094f8c7e34e0ab5c3bd0adb9cb795c234,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,25,0.033784,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,16.51,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,Ic80f7cbd4f92f988699f27d1c4c58ba724851a77,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,26,0.033854,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,21.3,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306227,-0.037259,-0.376211,0.495221,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-cinder,Icfbdfca30d515698558cae27dadd6ce9e680a861,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,27,0.03392,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,14.91,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-keystone,I4c9fddd4785dfd7244a391638de41c76fcd75dba,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,28,0.033981,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,19.7,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-nova-cloud-controller,I29685c8931a20eef4ad44aa130bb0198fbcb9885,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,29,0.034038,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,18.11,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-openstack-dashboard,I1f96d5d5663404af8ce26afe31402996f6f321ab,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,30,0.034091,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,16.51,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-ceilometer,I31784eb76cb20df63a63ed61ed7e6311dafe9184,1,1,1.0,3.3673,0.0,5,17.67,413,0,Bug Fix,0,0,1,31,0.034141,1.0,0,1.0,4,4,0,1.0,2.2709,2.2,13.32,16.12,1,0,0.1429,1,14.2414,0,12,0,84,0,"Support disabling apache wsgi socket rotation

Bug LP 1863232 introduced a new Apache configuration option called
WSGISocketRotation which allows users to disable wsgi socket
rotation. This patch makes this configurable with a new
wsgi-socket-rotation config option that defaults to the Apache
default and can optionally be set to False.

Closes-Bug: #2021550
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+6, -0)
test-requirements.txt (+4, -0)
charmhelpers/contrib/openstack/context.py (+4, -0)
config.yaml (+8, -0)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+6, -0)
",-1.162791,-0.254722,-0.838177,0.962333,0.306228,-0.037259,-0.376211,0.49522,0.644526,0.302833,0.341182,0.093597,0.201163,-0.36324,0.48602
openstack/charm-cinder-ceph,Id86b01a79f7dade25b3bd0a25c8c0bde55360c7a,1,0,0.8095,5.7268,0.0065,2,6.0,89,0,CI,0,0,0,21,0.026087,1.0,0,0.8095,2,1,0,1.0,0.0795,1.0,-67.15,22.4,0,0,0.9902,1,0.2899,0,0,0,0,0,"Add jammy-bobcat-ec testing bundle
[SEP]
FILES CHANGED:
osci.yaml (+1, -2)
tests/bundles/jammy-bobcat-ec.yaml (+303, -0)
",2.634079,2.124308,0.31168,-0.455468,0.373966,-1.186267,0.943457,0.432206,-0.688332,-0.63411,0.74373,0.347972,-0.352894,0.505541,0.346509
openstack/octavia,Ic81e98c54c4bce100e3f44ff1a2fe6ce7b7f4256,0,1,1.0,4.382,0.443,5,7.8,333,0,Bug Fix,0,0,1,10,0.095238,1.0,0,1.0,5,2,0,0.6036,1.8632,2.8,16.7,15.43,1,0,0.0759,0,4.1625,0,6,0,11,0,"Use cryptography to load PKCS12 certificates

... because implementation in PyOpenSSL has been derprecated, according
to the following warning.

```
DeprecationWarning: PKCS#12 support in pyOpenSSL is deprecated. You
should use the APIs in cryptography.
```

Closes-Bug: #2042787
[SEP]
FILES CHANGED:
requirements.txt (+0, -1)
octavia/certificates/common/pkcs12.py (+9, -9)
octavia/certificates/manager/barbican.py (+20, -15)
octavia/certificates/manager/castellan_mgr.py (+12, -7)
octavia/tests/unit/certificates/manager/test_barbican.py (+3, -3)
",-0.526682,-1.204629,-0.445279,-0.096071,-0.457316,0.657613,-0.878944,0.258172,0.020813,0.416527,0.078818,-0.24072,-0.160576,-0.257904,-0.004207
openstack/charm-ceph-mon,I2252163533a312f0f53165f946711ab20bb0e3c9,1,1,1.0,4.4427,0.0119,6,6.25,270,0,Bug Fix,0,0,0,9,0.021531,1.0,0,1.0,1,2,0,0.9643,1.5964,0.83,-19.47,18.5,1,0,0.6667,1,3.1765,0,6,0,16,0,"Add config option for rbd_stats_pools

This allows configuration RBD IO statistics collection for RBD pools.

Co-authored-by: Yoshi Kadokawa <yoshi.kadokawa@canonical.com>

Closes-Bug: #2042405

Related-Bug: #1989648
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+5, -0)
unit_tests/test_ceph_hooks.py (+54, -1)
src/ceph_metrics.py (+2, -0)
unit_tests/test_ceph_metrics.py (+1, -0)
config.yaml (+10, -0)
src/utils.py (+11, -0)
",-1.081875,0.744316,-1.686125,0.034986,-0.374726,0.159356,-1.186327,0.441982,0.221781,-0.267795,0.379179,0.128219,0.259867,0.326701,-0.250059
openstack/charm-ceph-iscsi,I781a2e33b3de9f55b97fddd661214f601fc6134e,1,1,1.0,1.9459,0.1667,1,13.0,260,0,Bug Fix,0,0,0,7,0.015453,0.8421,0,0.8421,1,1,0,1.0,0.0,1.0,27.69,15.97,1,0,0.0,0,37.1429,0,6,0,13,0,"Set iscsi pools' application

This patchset sets the default application name for the charm-created
pools to 'rbd'.

Closes-bug: #2040274
(cherry picked from commit ab6d598ddce6b1d0b758d5fa7888d8dc56e15de0)
[SEP]
FILES CHANGED:
src/charm.py (+5, -1)
",-0.703627,-1.183539,-1.755399,-1.455657,0.778582,-0.121304,0.300883,0.153213,0.46543,0.096934,-0.379923,-0.175005,0.272321,0.353716,-0.028225
openstack/charm-ceph-iscsi,Iec275190854edcc85915d93db233f444c92fbb17,1,1,1.0,2.1972,0.625,3,21.2,704,0,Bug Fix,0,0,0,8,0.017429,1.0,0,1.0,1,2,0,1.0,1.5,0.67,42.45,13.01,1,0,0.25,1,78.2222,0,6,0,10,0,"Don't set the default pool as ""iscsi""

""iscsi"" is the name of the metadata pool by default in the charm and not
to be used for tenant data. The charm can fill out the data pool name
automatically with `def data_pool_name` or can accept a user specified
value. After fixing the issue, the ""iscsi"" pool will be used only for
hosting gateway.conf as a rados object so reflect the purpose into the
application name for the pool too.

Also, update the command syntax not to print the deprecation warning:
""rbd: --user is deprecated, use --id""

Closes-Bug: #2042419
Related-Bug: #2040274
(cherry picked from commit 82779e5ff9a579610f2e1b4af557ee4ef2ede202)
[SEP]
FILES CHANGED:
src/charm.py (+2, -2)
unit_tests/test_ceph_iscsi_charm.py (+1, -1)
actions.yaml (+0, -2)
",-1.859178,-0.491258,1.641779,-0.733825,-0.063858,0.014051,0.7064,0.13858,0.515811,-0.298895,0.134513,-0.127371,-0.341645,0.067877,0.014928
openstack/charm-ceph-iscsi,I819f0d4456530ace8162456dec1f2fcb7fa95e7f,1,1,1.0,1.0986,0.0,1,7.8,370,0,Bug Fix,0,0,0,9,0.019272,0.75,0,0.75,0,1,0,1.0,0.0,0.0,21.04,12.35,1,0,0.0,1,123.3333,0,6,0,10,0,"Fix key errors for rbd-pool-name and ec-rbd-metadata-pool

The existing code assumes event.params['rbd-pool-name'] and
event.params['ec-rbd-metadata-pool'] have a key. Set an empty string by
default to be filled by other part of the code.

Follow-up of Iec275190854edcc85915d93db233f444c92fbb17

Closes-Bug: #2042419
[SEP]
FILES CHANGED:
actions.yaml (+2, -0)
",-2.017959,1.043533,-0.864739,-0.134186,0.930214,0.023722,0.18133,-0.264622,0.332593,-0.155467,0.463675,-0.138467,0.378017,0.446977,0.075421
openstack/charm-glance,I57c5fa293b421483b0879f24ddac260e47c7cbef,1,1,0,3.7612,0.119,3,7.0,258,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.9814,1.0,12.4,17.09,1,0,0.7143,0,6.0,0,30,0,21,0,"Restore original paste files if glance-common
re-installation does not restore them.

Implemented a unit test function for the above
scenario.

Call apt_update from upgrade_charm().

Closes-Bug: #2042792
[SEP]
FILES CHANGED:
hooks/glance_utils.py (+10, -1)
unit_tests/test_glance_utils.py (+26, -4)
hooks/glance_relations.py (+1, -0)
",0.6424,-1.859612,-0.160181,-0.652638,-0.662319,-0.202896,-0.618882,0.352117,0.283485,-0.348825,0.093399,-0.177937,-0.296728,0.537606,0.419294
openstack/charm-masakari,I31ae1e011354fc9ded114babcb92f366256fadea,1,1,1.0,1.6094,0.0,1,11.5,383,0,Bug Fix,0,0,0,1,0.142857,1.0,0,1.0,3,1,0,1.0,0.0,3.0,13.09,15.03,1,0,0.0,1,76.6,0,6,0,3,0,"Add os_region_name config option

In a multi-region shared keystone deployment, we must set the
os_region_name config option. Without it, Masakari will try to connect
to the wrong API endpoints when it needs to talk to other services.

Closes-Bug: #2042924
[SEP]
FILES CHANGED:
src/templates/stein/masakari.conf (+4, -0)
",-0.267054,-0.490554,-0.621923,0.769136,-0.13677,-0.046883,-0.08069,-0.166041,0.146333,-0.242805,0.213768,-0.187014,0.080237,-0.068381,-0.052427
openstack/ironic-python-agent,I11180e5d61d893a78583ace555f6e90ba8845950,1,0,0,2.0794,0.1429,2,12.0,110,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.9286,0.8631,1.5,18.41,18.13,1,0,0.0,1,13.75,0,0,0,0,0,"Fix referencing to the raid_device var which is not set
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+1, -1)
releasenotes/notes/fix-raid_device-not-set-8b03688ce83ce22e.yaml (+5, -0)
",2.526394,0.199597,0.939159,0.819792,0.6407,0.525865,0.748052,-0.741379,0.233541,-0.092451,0.331775,-0.546163,-0.672971,-0.209213,-0.112476
openstack/openstack-ansible-os_cinder,Ib091cc11a16fcd31ef351d9ec21d070d25829791,1,0,0.9407,0.6931,0.0,1,19.5,1065,0,CI,0,0,0,118,0.042203,1.0,0,0.9407,1,1,0,1.0,0.0,1.0,35.2,15.49,0,0,0.0,0,532.5,0,0,0,0,0,"Restart cinder-purge-deleted service only on abnormal exit

Default value of Restart for any service which type is not `oneshot` is
`on-failure`. While this suits most usecases, this leads to unexpected
consequences for cinder-purge-deleted.service.

In case there're some historical inconsistencies in the database which
make impossible to flush deleted volumes from the database
(ie due to prior manual intervention), cinder-manage exists with code 1
which triggers systemd to restart the service and attempt cleanup again.

The troublesome part is the transactional behaviour of the script. With
each run it locks records in it's transaction that is failing and being
reverted in a loops with 2 sec delay, that not only causes unnecessary
load for database itself, but also causes deadlocks during operations
with volumes that are not being re-tryed and fail with 500 return code
in cinder-api.

Changing Restart to `on-abnormal` will leave service in a failed state
and systemd won't attempt to restart it.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",-2.26361,-1.042285,2.627973,-0.431003,-0.275321,-0.207018,0.401491,-0.250036,-0.067929,-0.205267,0.00566,0.005126,0.054283,-0.103117,-0.069211
openstack/charm-octavia,I290f543827d63bb685209d615c9f448c2ff9d31e,1,1,1.0,3.7136,0.025,1,15.43,819,0,Bug Fix,0,0,0,43,0.005251,0.0,0,0.0,3,1,0,1.0,0.0,3.0,34.51,13.95,0,0,0.0,1,19.9756,0,14,0,6,0,"Update octavia.conf auth config for bobcat

As noticed in bobcat testing, the [service_auth] section requires
more configuration than it did in the past. Additionally, as noted
in I686cfdef78de927fa4bc1921c15e8d5853fd2ef9, Octavia will no longer
take the authentication settings for Neutron from the [service_auth]
as a fallback. It will instead require them to be in the [neutron]
section. However, [service_auth] settings will still be used for
other services like Nova and Glance.

This change adds auth config options to the [service_auth] and
[neutron] sections, moves the auth_section config option to the
[keystone_authtoken] section, and sets the auth_section config
option to point to the [service_auth] section.

Closes-Bug: #2043095
Related-Bug: #2043129
[SEP]
FILES CHANGED:
src/templates/bobcat/octavia.conf (+39, -1)
",-3.049738,0.443098,1.564825,-0.153759,0.56582,0.023006,-0.026743,0.072256,0.114631,-0.132116,0.194251,0.092135,-0.100584,-0.198837,-0.220229
openstack/charm-ceph-osd,Ib50414756165f2587f0127e572675c7ca8e31ef9,1,1,0,2.9444,0.3333,1,14.0,150,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.9167,0.0,2.0,11.34,22.74,0,0,0.0,0,7.8947,0,22,0,9,0,"Refactor cache validation for the ceph-osd NRPE check

Closes-Bug: #2019251
Closes-Bug: #2021507
[SEP]
FILES CHANGED:
files/nagios/check_ceph_osd_services.py (+12, -6)
",-0.063091,-0.425276,-1.507862,-1.692594,0.459331,0.045975,0.677203,0.198312,0.163933,0.014179,0.177823,-0.350077,0.428499,0.118049,0.26769
openstack/openstack-ansible-galera_server,Ie997393935e04e127893643e4c72d7af07e993ff,1,0,1.0,1.6094,0.25,1,11.2,462,0,Bug Fix,0,0,0,29,0.07672,1.0,0,1.0,1,1,0,0.8889,0.0,1.0,11.16,15.19,0,0,0.0,0,92.4,0,0,0,0,0,"Fix ignored database directories configuration

Confusingly, the variable ignore_db_dirs is set by passing it
multiple times in the configuration file, once per directory.
It is then read as a comma separated list, but cannot be set
in this way.
https://mariadb.com/kb/en/server-system-variables/#ignore_db_dirs

Without this, the mariadb-upgrade script can fail as it attempts
to process invalid databases.
[SEP]
FILES CHANGED:
templates/my.cnf.j2 (+3, -1)
",-1.193634,0.665274,-0.193794,1.12314,-0.307038,-0.168041,0.508175,-0.377233,0.331331,0.30043,0.048031,-0.230258,-0.124259,0.073622,-0.259814
openstack/oslo.messaging,Ib8dba833542973091a4e0bf23bb593aca89c5905,1,1,0.9091,3.7842,0.093,2,11.78,788,0,Bug Fix,0,0,0,11,0.059783,1.0,0,0.9091,2,2,0,0.5769,0.7401,2.0,39.25,11.13,1,0,0.0,1,17.9091,0,14,0,14,0,"Auto-delete the failed quorum rabbit queues

When rabbit is failing for a specific quorum queue, the only thing to
do is to delete the queue (as per rabbit doc, see [1]).

So, to avoid the RPC service to be broken until an operator eventually
do a manual fix on it, catch any INTERNAL ERROR (code 541) and trigger
the deletion of the failed queues under those conditions.
So on next queue declare (triggered from various retries), the queue
will be created again and the service will recover by itself.

Closes-Bug: #2028384
Related-bug: #2031497

[1] https://www.rabbitmq.com/quorum-queues.html#availability

(cherry picked from commit 8e3c523fd74257a78ceb384063f81db2e92a2ebd)
[SEP]
FILES CHANGED:
releasenotes/notes/auto-deleted-failed-quorum-ca6a3923c3ed999a.yaml (+9, -0)
oslo_messaging/_drivers/impl_rabbit.py (+30, -4)
",-2.389006,-0.383255,1.489103,-1.111572,-0.174335,0.297781,0.33334,-0.257984,0.232061,-0.073197,-0.017401,0.091475,0.106044,0.036942,0.018993
openstack/openstack-ansible-os_glance,I4ee3fc33fdbeb50fc7b102bf62d6134f83c5925f,1,1,0.9412,2.5649,0.0,2,16.25,491,0,Bug Fix,0,0,0,119,0.042546,0.9333,0,0.8784,1,1,0,0.6667,0.4138,1.0,23.74,16.96,0,0,0.0,0,37.7692,0,6,0,14,0,"Add glance_bin to rootwrap defenition

At the moment rootwrap can not find privsep-helper binary as it's located
in glance bin directory, which is inside the virtual environemnt.
In order to properly use privsep we must define venv bin directory in
allowed exec_dirs of rootwrap.

This also introduces new variable  `glance_rootwrap_conf_overrides`
that allows to manage some extra overrides for rootwrap if needed.

Closes-Bug: #2043503
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -0)
vars/main.yml (+11, -0)
",-0.856341,-1.25418,0.337723,0.225651,0.372455,-0.539441,0.276212,0.294542,0.173837,-0.397464,0.141352,-0.353151,-0.258693,-0.052226,0.005457
openstack/kolla-ansible,I4fca47e16e87db8b655ff5571fba568ef4edb95c,1,0,0.8824,2.8904,1.0,1,12.0,219,0,Feature,0,0,0,85,0.024724,1.0,0,0.8824,1,1,0,0.8,0.0,1.0,14.88,14.8,0,0,0.0,0,12.1667,0,0,0,0,0,"fact gathering: Remove gathering of package facts

These were added in I20e65a6771ebeee462a3aaaabaa5f0596bdd0581 but not
used in the final version of the changeset.
[SEP]
FILES CHANGED:
ansible/gather-facts.yml (+0, -17)
",0.304608,-1.19121,-1.353998,-1.277444,0.820274,0.339984,0.141342,-0.333217,0.136176,0.316557,-0.670582,0.576687,-0.602698,-0.008962,-0.044671
openstack/charm-ceph-iscsi,Ida720e5381d0ff3446cf88405452f8a3778c7efc,1,1,1.0,3.6889,0.1538,2,13.5,281,0,Bug Fix,0,0,0,10,0.01992,1.0,0,1.0,1,1,0,1.0,0.7321,1.0,5.13,20.21,1,0,0.2051,0,7.025,0,8,0,6,0,"Reject invalid username and password

This patchset checks that the username and password parameters
comply with ceph-iscsi requirements.

Fixes-bug: #2040328
(cherry picked from commit eec2d0d5eab1b1dd27673b5ca338f369f204c1ae)
[SEP]
FILES CHANGED:
src/charm.py (+29, -2)
unit_tests/test_ceph_iscsi_charm.py (+4, -4)
",-0.673272,-0.88117,-1.616665,-1.433192,0.790028,-0.072312,0.353504,-0.120593,0.50579,0.161209,-0.364995,-0.129247,0.324658,0.101364,0.071563
openstack/octavia,I5698558857cbaa585f8a3d7ac37aaa31c0189d46,1,1,0.7551,3.8918,0.375,3,5.0,355,0,Bug Fix,0,0,0,98,0.008295,0.4783,0,0.3611,7,3,0,0.6018,1.2479,5.0,38.91,10.0,0,0,0.6667,1,7.2449,0,6,0,38,0,"Fix health-monitors with ALPN members

Using HTTP or HTTPS health-monitor on a ALPN pool failed with SSL
errors.
haproxy doc mentions that when using ""check"" with ALPN servers, the
check-alpn option must be enabled.

[0] https://docs.haproxy.org/2.8/configuration.html#5.2-check

Closes-Bug: #2043812
[SEP]
FILES CHANGED:
releasenotes/notes/fix-http-https-healthmonitor-with-alpn-pools-82249b2b9a025068.yaml (+7, -0)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+16, -16)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+7, -2)
",-1.177261,0.322299,-0.374921,0.359275,-0.423165,-0.28125,-0.419286,0.485199,0.296382,0.514634,-0.135572,-0.350707,0.244269,-0.107784,-0.094407
openstack/ansible-role-python_venv_build,I62f69bc31ed04ab65a167d07de44067fcaa74a66,1,0,0.9417,2.9444,0.5,1,18.33,397,0,Feature,0,0,0,120,0.04272,0.9375,0,0.8828,1,1,0,1.0,0.0,1.0,26.72,13.88,0,0,0.0,0,20.8947,0,0,0,0,0,"Use distribution_major_version for all distros except Ubuntu

That is a follow-up patch for Rocky, that as EL derivative also follows
naming convention, where distribution_version contains also minor
version, while we need to build only against major versions of distros.
With that the only distro we need to use distro version for is Ubuntu.
[SEP]
FILES CHANGED:
vars/main.yml (+9, -9)
",0.008561,-1.419991,-0.302883,0.728471,0.196043,-0.028703,0.509907,-0.138859,-0.460126,0.040698,-0.196683,-0.019973,-0.073768,-0.239478,0.176511
openstack/octavia,I06911f42b9bf29cf9a5f2e76d8333d8a2f1bc60b,1,1,0.5045,5.2832,0.0255,5,15.67,576,0,Bug Fix,0,0,0,111,0.004232,0.6111,0,0.3083,5,2,0,0.603,1.5939,3.0,55.03,13.08,0,0,0.8163,1,2.9239,0,6,0,20,0,"Fix issue with certificates with no subject or CN

This patch fixes an issue where if the user attempts to use a
certificate that does not have a subject or CN, we would fail to create
a listener using the certificate.
Per the x.509 specification, a blank subject is allowed as long as the
subjectAltName extension is present in the certificate.
Octavia will now check for the a valid subAltName if the subject CN can
not be retrieved. If both are missing an appropriate error is raised for
the user.

Closes-Bug: #2043582
[SEP]
FILES CHANGED:
octavia/common/tls_utils/cert_parser.py (+21, -5)
releasenotes/notes/Handle-blank-cert-subjects-b660d403ce56b0b8.yaml (+4, -0)
octavia/tests/functional/api/v2/test_listener.py (+45, -0)
octavia/common/exceptions.py (+6, -0)
octavia/tests/common/sample_certs.py (+115, -0)
",-1.364233,-1.356192,0.21912,0.673659,-0.080583,0.518119,0.122316,-0.348869,0.79863,0.386945,0.411124,0.255827,0.038524,0.124811,-0.054896
openstack/openstack-ansible-plugins,Icef8c89a1c0daf01cfc1abd53322333ba2f06d92,1,0,0.9421,0.6931,0.0,1,11.5,192,0,Feature,0,0,0,121,0.042802,1.0,0,0.9421,3,1,0,1.0,0.0,3.0,18.61,13.3,0,0,0.0,0,96.0,0,0,0,0,0,"Add no_log to setup_roles inlcude

During include we're iterating over users, which also exposes user
actual password to stdout and logs.
[SEP]
FILES CHANGED:
roles/service_setup/tasks/main.yml (+1, -0)
",2.253539,-1.324513,0.116654,0.246292,0.001527,0.004653,0.33966,-0.646012,0.019747,-0.63744,-0.304989,-0.520651,-0.41788,0.101979,-0.285252
openstack/charm-octavia-diskimage-retrofit,Ia0d69f3376ae63907df2a5d40f8d4155b8aeaeda,1,1,1.0,2.0794,0.2857,2,4.5,118,0,Bug Fix,0,0,0,1,0.023256,0.0,0,0.0,4,1,0,1.0,0.9852,2.5,-32.73,24.02,0,0,0.4286,0,14.75,0,10,0,10,0,"Fixed missing image architecture property.

Closes-Bug: #2016344
[SEP]
FILES CHANGED:
src/lib/charm/openstack/octavia_diskimage_retrofit.py (+3, -1)
unit_tests/test_lib_charm_openstack_octavia_diskimage_retrofit.py (+2, -1)
",2.197818,-0.279761,-0.415995,-1.108134,-0.768688,1.093949,-0.937877,0.548142,0.602824,-0.108512,0.654452,-0.062941,0.071947,-0.03375,0.388954
openstack/kayobe,Ic2c47ae4514d98ff18c5d17ba62b50c47f3929c1,1,0,0.9184,2.8332,1.0,2,5.6,221,0,Bug Fix,0,0,0,49,0.058965,1.0,0,0.9184,1,1,0,0.9457,1.0,1.0,41.02,13.67,1,0,0.0,0,13.0,0,0,0,0,0,"Remove libgcrypt package update

This fix was added when upgrading from CentOS Linux 8.2 to 8.3. This is
likely not required on currently supported operating systems.
[SEP]
FILES CHANGED:
ansible/overcloud-ipa-build.yml (+0, -8)
ansible/seed-ipa-build.yml (+0, -8)
",0.238388,-0.663808,-0.406507,0.688945,-0.020289,0.634621,-0.090651,0.160411,-0.351025,0.810114,-0.064927,0.369014,-0.428659,-0.012132,0.337839
openstack/charm-ceph-mon,I0df8bc0238349b5f03179dfb8f4da95da48140c7,1,1,1.0,1.6094,0.5,1,26.29,1190,0,Bug Fix,0,0,0,10,0.021322,0.0,0,0.0,2,1,0,0.9655,0.0,2.0,38.08,15.51,1,0,0.0,0,238.0,0,18,0,20,0,"Don't expect a static job name

A job name passed via the prometheus_scrape library doesn't end up as a
static job name in the prometheus configuration file in the COS world
even though COS expects a fixed string. Practically we cannot have a
static job name like job=ceph in any of the alert rules in COS since the
charms will convert the string ""ceph"" into:

> juju_MODELNAME_ID_APPNAME_prometheus_scrape_JOBNAME(ceph)-N

Let's give up the possibility of the static job name and use ""up{}"" so
it will be annotated with the model name/ID, etc. without any specific
job related condition. It will break the alert rules when one unit have
more than one scraping endpoint because there will be no way to
distinguish multiple scraping jobs. Ceph MON only has one prometheus
endpoint for the time being so this change shouldn't cause an immediate
issue. Overall, it's not ideal but at least better than the current
status, which is an alert error out of the box.

The following alert rule:
> up{} == 0
will be converted and annotated as:
> up{juju_application=""ceph-mon"",juju_model=""ceph"",juju_model_uuid=""UUID""} == 0

Closes-Bug: #2044062
[SEP]
FILES CHANGED:
files/prometheus_alert_rules/prometheus_alerts.yml.default (+2, -2)
",-3.194114,-0.083095,3.894602,-1.398897,0.061615,0.527771,-0.379299,-0.402871,-0.142923,-0.319396,-0.212121,0.264715,-0.276769,-0.062284,0.082838
openstack/kolla,I7d08ebb65e2de82e3edba7bd9307b2b6ac8cb7a8,0,0,0.8814,1.6094,0.25,2,5.0,76,0,Feature,0,0,0,59,0.050687,0.6,0,0.5288,2,1,0,0.8128,1.0,2.0,-102.8,26.0,0,0,0.0,0,15.2,0,0,0,0,0,"Remove setuptools pin
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+2, -0)
docker/openstack-base/Dockerfile.j2 (+1, -1)
",2.83131,1.933131,1.599293,0.74909,1.261659,0.800404,0.12672,0.22291,-0.019682,-0.552411,0.426333,-0.465219,0.128556,0.309691,0.21809
openstack/charm-ceph-osd,Ie9d485e89bd97d10774912691d657428758300ae,0,1,0.75,1.0986,0.5,1,9.75,283,0,Bug Fix,0,1,0,8,0.005614,1.0,0,0.75,0,1,0,0.9231,0.0,0.0,58.11,12.11,0,0,0.0,1,94.3333,1,8,0,10,0,"Revert default source to 'yoga'

The Openstack libs don't recognize Ceph releases when specifying
the charm source. Instead, we have to use an Openstack release.
Since it was set to quincy, reset it to yoga.

Closes-Bug: #2044052
[SEP]
FILES CHANGED:
config.yaml (+1, -1)
",0.385891,-0.687605,-0.964909,0.551036,-0.390187,0.40572,0.213432,-0.094602,-0.206636,0.190883,0.479212,0.23739,-0.019211,-0.070554,0.102844
openstack/openstack-ansible-haproxy_server,I4e52378d8c5b3eaa6863ecaf0d04554d082e3dc0,1,0,0.9426,1.0986,0.5,1,13.2,552,0,Bug Fix,0,0,0,122,0.04314,0.0,0,0.0,1,1,0,0.8889,0.0,1.0,17.83,16.19,0,0,0.0,0,184.0,0,0,0,0,0,"Fix haproxy_stats SSL path defenition

Neither `vip_interface` nor `vip_address` are defined or available in
the context they're being used.
Thus we need to refer to available variables in order to render base config
properly

Current version fail with ""AnsibleUndefinedVariable: 'vip_interface' is undefined""
on ""Drop base haproxy config"" task.

This fix the issue that was introduced with [1] and backported back to Zed

[1] https://review.opendev.org/q/Ib8be6b7fc3dada9d20905b0f07d90ddce0335605
[SEP]
FILES CHANGED:
templates/haproxy.cfg.j2 (+1, -1)
",-1.614879,0.151008,0.57133,-0.69321,0.311065,0.127546,0.257324,-0.066477,0.342701,-0.024505,-0.054143,-0.248984,-0.396732,-0.24512,-0.321203
openstack/ironic,I3026a5c69930825ea2b88587e62b36e8824fa91e,1,0,0.9667,2.5649,0.0,3,10.0,115,0,Feature,0,0,0,30,0.012131,0.0,0,0.0,4,3,0,0.9468,1.4834,2.67,-31.73,16.0,1,0,0.0,1,8.8462,0,0,0,0,0,"Add missing compatibility between idrac and redfish firmware
[SEP]
FILES CHANGED:
ironic/drivers/drac.py (+5, -0)
releasenotes/notes/idrac-firmware-3839648d729d9c7c.yaml (+5, -0)
doc/source/admin/drivers/idrac.rst (+2, -0)
",2.521523,0.375262,1.196547,0.054499,1.030486,0.151151,0.955878,0.990175,-0.496237,-0.150267,-0.499296,0.604913,0.286169,-1.055959,0.401125
openstack/kayobe,Ifd9f9cd389ac09448fc91dba74f8f09595698b55,1,1,1.0,2.1972,0.125,2,8.83,457,0,Bug Fix,0,0,0,4,0.105263,0.0,0,0.0,2,2,0,0.9462,0.8113,1.5,30.27,15.61,1,0,0.0,1,50.7778,0,6,0,15,0,"Fix gateway assignment when seed SNAT is disabled

Fix a logic issue when seed SNAT is not enabled. In this circumstance
Bifrost was generating ConfigDrive data with the default gateway unset
even when one is available on the admin network. This regression was
introduced in Ib847d3420dee374cec067cd8af519b510be04120 [1].

[1] https://review.opendev.org/c/openstack/kayobe/+/898434

Closes-Bug: #2045926
[SEP]
FILES CHANGED:
releasenotes/notes/fix-bifrost-gateway-b4bc8a0396dfa935.yaml (+6, -0)
ansible/kolla-bifrost-hostvars.yml (+1, -1)
",-0.95628,-0.114583,-0.378645,-0.874271,-0.376144,0.308881,0.54379,0.350889,0.317282,0.190639,0.401942,-0.131118,0.093668,-0.19367,-0.209703
openstack/kolla-ansible,I4b91d184485aa52b3c06011f9dbb6b34bcad3ca8,0,0,1.0,2.0794,0.0,3,5.25,243,0,Doc,0,0,0,12,0.086331,0.7143,0,0.7143,4,3,0,0.8006,1.1488,2.67,-24.09,19.24,0,0,0.0,1,30.375,0,0,0,0,0,"Adjust Ceph metrics scrape interval in Prometheus

Enables modifying the interval and sets the recommended default value.

[1] https://docs.ceph.com/en/latest/mgr/prometheus/#configuration
[SEP]
FILES CHANGED:
releasenotes/notes/add-ceph-metrics-scrape-interval-3ee39fba696860e9.yaml (+5, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+1, -0)
",-0.076613,1.733333,-0.859944,0.866966,-0.647816,0.235629,-0.022998,0.292469,0.353052,0.163242,-0.575111,-0.091405,-0.310985,-0.485946,-0.481645
openstack/openstack-ansible-os_magnum,Iece3498eba9ee41f2008500e983cf3355bcd17fb,1,0,1.0,1.9459,0.3333,2,7.0,90,0,Feature,0,0,0,30,0.078534,1.0,0,1.0,1,1,0,1.0,1.0,1.0,-17.81,19.94,0,0,0.0,0,12.8571,0,0,0,0,0,"Add missing libxml2 distro packages
[SEP]
FILES CHANGED:
vars/redhat.yml (+2, -1)
vars/debian.yml (+2, -1)
",3.138881,0.379846,1.542576,-0.028345,0.763589,-0.43405,0.82021,0.935385,-0.291931,-0.134482,-0.571733,-0.570792,-0.091616,0.00955,0.143638
openstack/charm-vault,I2d44ec0c43c1ecffd9ac77a1162ead4e4a01aabe,0,0,1.0,3.2189,0.0417,2,12.6,613,0,Bug Fix,0,0,0,1,0.03125,1.0,0,1.0,3,1,0,1.0,0.9544,2.0,11.42,13.29,1,0,0.625,0,24.52,0,0,0,0,0,"Fix broken v4 caching due to leader-get asymmetry

leader-get decodes using json, but leader-set just sets the keys. This
wasn't taken into consideration when fetching all the keys to filter for
cached keys when a relation is leaving.  This is resolved in this patch.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1153

(cherry picked from commit d925ac756638ed043e33a7b47a2681dfcd8900ce)
(cherry picked from commit 0a18ac23ce295c14789e99f7802efc51438d10aa)
(cherry picked from commit 9c32533a82f3731e90d32918152605776404cd06)
[SEP]
FILES CHANGED:
src/lib/charm/vault_pki.py (+8, -1)
unit_tests/test_lib_charm_vault_pki.py (+15, -0)
",-3.598104,0.897526,1.18246,-2.173018,1.119821,0.192621,0.73746,-0.268527,0.000576,-0.041108,0.032698,0.138002,0.259191,-0.111691,-0.055339
openstack/charm-vault,I0cca13d2042d61ffc6a7c13eccb0ec8c292020c9,0,1,0.5,7.2759,0.0173,5,12.1,1113,0,Bug Fix,0,0,0,2,0.035714,1.0,0,0.5,3,2,0,0.75,1.7982,1.8,9.27,14.76,1,0,0.6177,1,0.7702,0,42,0,24,0,"Implement cert cache for vault units (v4)

This cache is used to store certificates and keys
issued by the leader unit. Non-leader units read
these certificates and keep data in their
""tls-certificates"" relations up to date.
This ensures that charm units that receive certs
from vault can read from relation data of any
vault unit and receive correct data.

This patch is mostly the same as
I18aa6c9193379ea454851b6f60a8f331ef88a980
but improved to avoid LP#1896542 by removing
the section where a certificate can be reused
from cache during create_certs.

Co-Authored-By: Rodrigo Barbieri <rodrigo.barbieri@canonical.com>
Co-Authored-By: Alex Kavanagh <alex.kavanagh@canonical.com>

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1153

Closes-Bug: #1940549
Closes-Bug: #1983269
Closes-Bug: #1845961
Related-Bug: #1896542
(cherry picked from commit 1a1953b0ef23f724e9295505b100eca22ef9a6cd)
(cherry picked from commit 56ca825332964a58961f6df3a1ca52df394f2d2c)
(cherry picked from commit a3ff39641b0d9d4ebd58ef10a0560de5c2bcf9a7)
[SEP]
FILES CHANGED:
unit_tests/test_reactive_vault_handlers.py (+243, -17)
src/lib/charm/vault_pki.py (+448, -0)
src/reactive/vault_handlers.py (+98, -6)
src/tests/tests.yaml (+5, -1)
unit_tests/test_lib_charm_vault_pki.py (+625, -1)
",-4.276504,1.842175,2.986704,-2.424233,0.720405,0.967944,-0.731137,-0.665021,-0.248208,0.012875,-0.660287,0.854647,0.1968,0.186499,-0.045075
openstack/charm-vault,I2d44ec0c43c1ecffd9ac77a1162ead4e4a01aabe,0,0,0.3333,3.2189,0.0417,2,13.6,682,0,Bug Fix,0,0,0,3,0.002,0.3333,0,0.1111,3,1,0,0.6,0.9544,2.0,5.17,13.68,0,0,0.625,0,27.28,0,0,0,0,0,"Fix broken v4 caching due to leader-get asymmetry

leader-get decodes using json, but leader-set just sets the keys. This
wasn't taken into consideration when fetching all the keys to filter for
cached keys when a relation is leaving.  This is resolved in this patch.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1153

(cherry picked from commit d925ac756638ed043e33a7b47a2681dfcd8900ce)
(cherry picked from commit 0a18ac23ce295c14789e99f7802efc51438d10aa)
(cherry picked from commit 9c32533a82f3731e90d32918152605776404cd06)
(cherry picked from commit 15e3aec0fdef1a8616ae395ec332c0e98abdf634)
[SEP]
FILES CHANGED:
src/lib/charm/vault_pki.py (+8, -1)
unit_tests/test_lib_charm_vault_pki.py (+15, -0)
",-3.598104,0.897526,1.18246,-2.173018,1.119821,0.192621,0.73746,-0.268527,0.000576,-0.041108,0.032698,0.138002,0.259191,-0.111691,-0.055339
openstack/charm-vault,I0cca13d2042d61ffc6a7c13eccb0ec8c292020c9,0,1,0.25,7.2717,0.0167,4,12.6,1182,0,Bug Fix,0,0,0,4,0.002625,0.6667,0,0.1667,3,1,0,0.5,1.7667,1.75,8.06,14.88,0,0,0.6161,0,0.8214,0,42,0,24,0,"Implement cert cache for vault units (v4)

This cache is used to store certificates and keys
issued by the leader unit. Non-leader units read
these certificates and keep data in their
""tls-certificates"" relations up to date.
This ensures that charm units that receive certs
from vault can read from relation data of any
vault unit and receive correct data.

This patch is mostly the same as
I18aa6c9193379ea454851b6f60a8f331ef88a980
but improved to avoid LP#1896542 by removing
the section where a certificate can be reused
from cache during create_certs.

Co-Authored-By: Rodrigo Barbieri <rodrigo.barbieri@canonical.com>
Co-Authored-By: Alex Kavanagh <alex.kavanagh@canonical.com>

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1153

Closes-Bug: #1940549
Closes-Bug: #1983269
Closes-Bug: #1845961
Related-Bug: #1896542
(cherry picked from commit 1a1953b0ef23f724e9295505b100eca22ef9a6cd)
(cherry picked from commit 56ca825332964a58961f6df3a1ca52df394f2d2c)
(cherry picked from commit a3ff39641b0d9d4ebd58ef10a0560de5c2bcf9a7)
(cherry picked from commit 74c67c37ace083e42b62d10ee75b7d5c5799e270)
[SEP]
FILES CHANGED:
unit_tests/test_reactive_vault_handlers.py (+243, -17)
src/lib/charm/vault_pki.py (+448, -0)
src/reactive/vault_handlers.py (+98, -6)
unit_tests/test_lib_charm_vault_pki.py (+625, -1)
",-4.276504,1.842175,2.986704,-2.424233,0.720405,0.967944,-0.731137,-0.665021,-0.248208,0.012875,-0.660287,0.854647,0.1968,0.186499,-0.045075
openstack/ironic,I676f48de6b6195a69ea76b4e8b45a034220db2fa,1,0,0.9677,3.1781,0.1304,3,11.83,493,0,Feature,0,0,0,31,0.012475,1.0,0,0.9677,6,2,0,0.9474,1.325,4.0,47.07,11.49,1,0,0.1304,1,20.5417,0,0,0,0,0,"Handle internal server errors while configuring secure boot

At least on some Dell machines, the Redfish SecureBoot resource is
unavailable during configuration, GET requests return HTTP 503.
Sushy does retry these, but not for long enough (the error message
suggests at least 30 seconds, which would be too much to just integrate
in Sushy). This change treats internal errors the same way as
mismatching ""enabled"" value, i.e. just waits.
[SEP]
FILES CHANGED:
releasenotes/notes/redfish-500-fea3a8f86c0aecc7.yaml (+6, -0)
ironic/drivers/modules/redfish/management.py (+11, -3)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+3, -0)
",-0.388278,-2.121961,0.512941,0.349291,-0.641355,-0.208835,0.637529,-0.143217,-0.069399,0.60568,0.204157,-0.184981,0.187983,-0.320486,0.001942
openstack/ironic,I12fccda8fee73430fee03a91134fd559ebf40cc9,1,0,0,3.3673,0.2857,3,9.0,94,0,Feature,0,0,0,0,0.0,1.0,0,0.0,6,2,0,0.9479,1.2871,4.0,9.7,16.93,1,0,0.6429,1,3.2414,0,0,0,0,0,"Add volume name to Redfish RAID volumes
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+3, -1)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+11, -7)
releasenotes/notes/redfish-raid-set-volume-name-76205f8bb7dd2bb8.yaml (+6, -0)
",3.368539,1.093558,1.387882,1.106763,0.986057,0.517938,0.857175,1.061144,0.474633,-0.318466,-0.323346,0.226444,0.402299,0.03796,-0.632925
openstack/kolla-ansible,Ib08c159dadd69a1f44924d658f4afe1e794a18b0,1,1,0.8857,1.7918,0.4,2,12.25,396,0,Bug Fix,0,0,0,35,0.03271,1.0,0,0.8857,4,2,0,0.7981,0.971,3.0,45.92,13.06,1,0,0.0,1,66.0,1,8,0,25,0,"Fix wsrep sync status task while switched to TCP/IP

Followup on Id6eae798784126d4dd53adef15bdce6b47b4601f to fix an issue
when a client with provided port set tries to connect 'localhost', so
while we switch to TCP/IP we need to explicitly provide the host too.

Partial-Bug: #2024554
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2024554-6eb811364536f1e8.yaml (+1, -1)
ansible/roles/mariadb/tasks/restart_services.yml (+2, -1)
",-0.046707,-1.231443,-0.736025,-0.961177,0.343721,0.092402,0.550258,-0.176204,0.173711,0.101037,-0.043558,-0.328855,0.131247,-0.174791,0.277172
openstack/kayobe,I90b61dfe03d53c58327d2b15e70b7b8489bdfb47,1,1,1.0,3.1355,0.0,2,4.8,252,0,Bug Fix,0,0,0,2,0.016393,0.0,0,0.0,4,2,0,0.9468,0.8454,3.0,4.56,20.25,1,0,0.0,1,10.9565,0,6,0,26,0,"Stop NetworkManager from overriding resolv.conf

When ``resolv_is_managed`` is set, Kayobe templates resolv.conf. This
patch stops NetworkManager from overriding these changes.

Closes-Bug: #2044537
[SEP]
FILES CHANGED:
ansible/roles/network-redhat/tasks/main.yml (+16, -0)
releasenotes/notes/fix-resolv-conf-management-141788e64d0e82a0.yaml (+6, -0)
",0.28321,0.348656,-0.969251,0.497541,0.224767,0.239116,-0.721939,0.073989,0.138321,-0.37328,0.568137,-0.53287,-0.853124,-0.110552,0.084676
openstack/charm-swift-storage,I9c585c91c5527a61e4a8dbcba0a8a01108cd9b2e,1,1,1.0,3.3673,0.6786,1,23.0,337,0,Bug Fix,1,0,0,44,0.005347,0.0,0,0.0,1,1,0,0,0.0,1.0,27.16,19.63,0,0,1.0,0,11.6207,0,6,0,13,0,"Mock datetime instead of redefining standard library

This fixes up the test to mock the datetime calls specifically in
the test that needs to mock them, rather than the prior approach
which was redefining the behavior of the standard library function
globally.

Closes-Bug: #2045588
[SEP]
FILES CHANGED:
unit_tests/test_check_swift_storage.py (+9, -19)
",0.476502,-1.854997,0.112456,0.411162,-0.427837,0.202057,0.214588,-0.234575,-0.002508,-0.025281,0.015779,-0.003108,-0.118618,-0.19976,0.461988
openstack/kolla-ansible,I91a2101ff26cb8568f4615b4cdca52dcf09e6978,1,1,1.0,2.3026,0.1111,2,11.67,515,0,Bug Fix,0,0,0,1,0.027027,0.0,0,0.0,4,2,0,0.7987,0.7642,3.0,29.42,15.52,1,0,0.0,1,51.5,0,8,0,14,0,"Fix broken list concatenation in horizon role

Starting with ansible-core 2.13, list concatenation format is changed
and does not support concatenation operations outside of the jinja template.

The format change:

  ""[1] + {{ [2] }}"" -> ""{{ [1] + [2] }}""

This affects the horizon role that iterates over existing policy files to
override and concatenate them into a single variable.

Co-Authored-By: Dr. Jens Harbott <harbott@osism.tech>

Closes-Bug: #2045660
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2045660-inability-to-override-horizon-policy-files-c405906a9faf8f3b.yaml (+7, -0)
ansible/roles/horizon/tasks/policy_item.yml (+1, -1)
",-1.616544,-0.304424,0.465188,-0.162254,-0.27664,-0.033288,-0.326983,0.222124,0.139022,0.222132,0.274275,0.155835,0.052517,0.175476,-0.591236
openstack/ironic,I91d2decab19e352ca3560227d17acfaa1a1dca94,1,1,0,5.4116,0.5022,3,23.5,344,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,2,0,0.9485,0.6669,4.0,20.98,17.06,0,0,0.8655,1,1.5357,0,6,0,10,0,"Fixes Raid creation in iLO6 and other BMC with latest schema

This commit removes 'VolumeType' which param has long been
deprecated in DMTF Redfish schema, also removes 'Encrypted'
param as per discussion, and places 'Drives' inside 'Links'
as per the new DMTF schema.

Closes-Bug: 2045645
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+9, -15)
releasenotes/notes/redfish-fix-raid-creation-f437066b1301c032.yaml (+6, -0)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+96, -97)
",-0.273496,-1.123388,-0.328284,0.057033,-0.255751,0.169365,-0.445171,0.462125,-0.075157,-0.119431,0.125104,-0.074108,0.222816,0.108813,-0.106793
openstack/kolla-ansible,Ibafdcd58618d97251a3405ef9332022d4d930e2b,1,1,1.0,3.8286,0.0444,3,5.0,337,0,Bug Fix,0,0,0,3,0.020833,1.0,0,1.0,4,3,0,0.7994,1.2419,2.33,20.47,11.14,1,0,0.1333,1,7.3261,0,6,0,9,0,"Add precheck for RabbitMQ quorum queues

Adds a precheck to fail if non-quorum queues are found in RabbitMQ.

Currently excludes fanout and reply queues, pending support in
oslo.messaging [1].

[1]: https://review.opendev.org/c/openstack/oslo.messaging/+/888479

Closes-Bug: #2045887
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-add-precheck-for-quorum-queues-ba10f58538959112.yaml (+9, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+30, -0)
tests/upgrade.sh (+4, -2)
",-0.949332,0.471476,-0.606488,0.078207,-0.776232,-0.273742,-0.19768,0.387889,0.205068,0.108733,-0.040981,-0.41252,0.334716,-0.076151,-0.064987
openstack/ironic,Iea65575f540a89a0de280fb730e430647c5733dc,1,0,0.9688,3.7377,0.0976,4,15.0,290,0,Bug Fix,0,0,0,32,0.012759,1.0,0,0.9688,6,2,0,0.949,1.9463,3.5,58.13,12.22,1,0,0.3171,1,6.9048,0,0,0,0,0,"Fix GET for conductors with a port or IPv6 address

Our validation does not expect a host-port pair, not having colons in
the hostname. We don't need to verify all possible cases: we will return
404 for a conductor that does not exist.
[SEP]
FILES CHANGED:
ironic/tests/unit/api/controllers/v1/test_conductor.py (+13, -0)
ironic/api/controllers/v1/conductor.py (+4, -4)
ironic/common/args.py (+13, -0)
releasenotes/notes/port-in-conductor-a354a2665effca2e.yaml (+7, -0)
",1.14214,-1.79516,0.085034,0.581301,-0.26785,0.002765,0.697916,-0.926546,0.047901,0.335937,-0.251712,-0.147975,0.266822,-0.043615,-0.00346
openstack/charm-ceph-osd,Ib50414756165f2587f0127e572675c7ca8e31ef9,1,1,0.963,3.3322,0.2963,4,26.0,261,0,Bug Fix,0,0,0,27,0.004069,1.0,0,0.963,2,4,0,0.8571,1.3823,0.5,11.25,21.17,0,0,0.1481,1,9.3214,0,22,0,9,0,"Refactor cache validation for the ceph-osd NRPE check

Also update test env, remove zed testing

Closes-Bug: #2019251
Closes-Bug: #2021507
(cherry picked from commit 1494d9a24527769064b819d5e1da4fdaebf6dcd2)
[SEP]
FILES CHANGED:
osci.yaml (+0, -1)
test-constraints.txt (+4, -0)
files/nagios/check_ceph_osd_services.py (+12, -6)
tox.ini (+3, -1)
",-0.063091,-0.425276,-1.507862,-1.692594,0.459331,0.045975,0.677203,0.198312,0.163933,0.014179,0.177823,-0.350077,0.428499,0.118049,0.26769
openstack/kolla-ansible,I91671dda2242255e789b521d19348b0cccec266f,1,1,1.0,3.6636,0.0,5,11.0,267,0,Bug Fix,0,0,0,1,0.333333,0.5319,0,0.5319,4,2,0,0.8,1.2049,2.8,31.6,14.1,1,0,0.0,1,6.8462,0,8,0,14,0,"Update keystone service user passwords

Service user passwords will now be updated in keystone if services are
reconfigured with new passwords set in config. This behaviour can be
overridden.

Closes-Bug: #2045990
[SEP]
FILES CHANGED:
ansible/roles/magnum/tasks/register.yml (+1, -0)
ansible/group_vars/all.yml (+4, -0)
ansible/roles/service-ks-register/tasks/main.yml (+1, -0)
releasenotes/notes/update-keystone-passwords-7507119213391652.yaml (+29, -0)
etc/kolla/globals.yml (+3, -0)
",0.430593,-1.156932,-0.369474,0.485387,-0.178294,0.37937,-0.162089,-0.280852,0.264475,-0.22545,-0.117034,0.044816,-0.055158,-0.140508,-0.005418
openstack/ironic,Iaa242ca6aa6138fcdaaf63b763708e2f1e559cb0,1,0,0.9697,3.5553,0.2647,3,15.67,682,0,Bug Fix,0,0,0,33,0.012946,1.0,0,0.9697,4,2,0,0.9495,1.4298,2.67,42.43,11.8,1,0,0.0,1,19.4857,0,0,0,0,0,"Fix two severe errors in the firmware caching code

First, it tries to create components even if the current version is not
known and fails with a database constraint error (because the initial
version cannot be NULL). Can be reproduced with sushy-tools before
https://opendev.org/openstack/sushy-tools/commit/37f118237a5e7788301968ad123f19f2600c1418

Second, unexpected exceptions are not handled in the caching code, so
any of them will cause the node to get stuck in cleaning forever.

On top of that, the caching code is missing a metrics decorator.

This change does not update any unit tests because none currently exist.
[SEP]
FILES CHANGED:
ironic/conductor/utils.py (+6, -1)
releasenotes/notes/firmware-fail-c6f6c70220373033.yaml (+8, -0)
ironic/drivers/modules/redfish/firmware.py (+11, -8)
",-1.67451,-0.641815,0.433735,-0.387522,-0.358407,0.09385,0.694349,-0.351993,0.211045,0.313824,0.096877,0.044891,0.055564,-0.16054,0.03878
openstack/ansible-role-systemd_networkd,I01aa44dcdc85e32d18dd52bcd4878a9017fb6ead,1,1,0.9431,3.8501,0.1739,4,10.78,767,0,Bug Fix,0,0,0,123,0.043463,1.0,0,0.9431,2,3,0,1.0,1.9227,1.25,22.33,14.21,0,0,0.0,1,16.3191,0,6,0,11,0,"Fix defenition of multiple static routes for network

Current logic was relying on iteration inside the template. However,
since config_template module was used to deliver network configuration
it was merging sections having same name together.

While this behaviour is correct one for config_template as all sections
must be unique from ConfigParser perspective and in order to apply
overrides properly, it was not suiting the way how routes should be
defined in networkd configuration.

To workaround the issue we place routes separately under <network>.d
directory, which should be supported by systemd [1]

[1] https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html

Closes-Bug: #2045819
[SEP]
FILES CHANGED:
tasks/main.yml (+18, -0)
templates/systemd-network-routes.j2 (+9, -0)
releasenotes/notes/networkd_multiple_routes-becb9e691f38987a.yaml (+11, -0)
templates/systemd-network.j2 (+0, -8)
",-2.061253,-1.060435,1.345806,-0.251442,-0.538231,-0.181616,-0.183995,0.160859,-0.049826,-0.059639,-0.30137,-0.171777,-0.227575,-0.035173,-0.217017
openstack/charm-ceph-iscsi,Ia473b2793a60172645713b722cbab80dcdbf93b6,1,1,0.9643,2.7726,0.3333,4,12.0,119,0,Bug Fix,0,0,1,28,0.004203,1.0,0,0.9643,2,3,0,1.0,1.7819,1.0,39.56,18.13,0,0,0.6667,1,7.4375,0,8,0,13,0,"Fix: enable GW services once we have config

Closes-Bug: #2045828
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -0)
src/charm.py (+5, -0)
tests/bundles/kinetic.yaml (+1, -5)
unit_tests/test_ceph_iscsi_charm.py (+3, -0)
",2.063952,-0.454416,-0.229803,-0.860361,-0.722099,0.763259,-0.73789,0.116977,-0.191941,-0.060815,0.351778,-0.379775,0.336191,-0.244939,0.488677
openstack/openstack-ansible-haproxy_server,Ie9ed322ab9c4a04d42cab4456567ac5d1f5c966b,1,1,0.9435,1.3863,0.0,1,7.8,365,0,Bug Fix,0,0,0,124,0.043115,1.0,0,0.9435,1,1,0,0.9,0.0,1.0,25.38,13.38,0,0,0.0,0,91.25,0,6,0,11,0,"Add httpchk option when httpcheck_options are defined

In order for http-check to work, option httpchk must be loaded first. Otherwise
regular L4 check will be issued and all `http-check` will be simply ignored.

Closes-Bug: #2046223
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/903488
[SEP]
FILES CHANGED:
templates/service.j2 (+3, -0)
",-0.986343,1.633153,-0.625599,0.246873,-0.536627,0.090344,0.098969,-0.315584,0.390376,-0.011394,0.272059,-0.569636,0.175462,-0.025993,0.090309
openstack/openstack-ansible,I6153e1ba5a4c45e2ed78d69da73e6524e3911db0,1,1,0.944,2.3979,0.6,4,8.2,420,0,Bug Fix,0,0,0,125,0.043418,1.0,0,0.944,3,1,0,0.9167,1.571,3.0,-24.34,16.94,0,0,0.0,0,38.1818,0,6,0,11,0,"Fix http-check ordering for services

Despite not being documented, order of http-check options are important

Defining `expect` before `check` leads to configuration error. In order to
avoid that we fix some defenitions of haproxy_services variable.

Related-Bug: #2046223

Needed-By: https://review.opendev.org/c/openstack/openstack-ansible-haproxy_server/+/903463
[SEP]
FILES CHANGED:
inventory/group_vars/zun_all/haproxy_service.yml (+1, -1)
inventory/group_vars/murano_all/haproxy_service.yml (+0, -1)
inventory/group_vars/blazar_all/haproxy_service.yml (+0, -1)
inventory/group_vars/nova_all/haproxy_service.yml (+3, -3)
",-1.512881,0.69939,-0.508526,0.168807,-0.602215,-0.106645,-0.146288,-0.108875,0.32696,-0.013982,-0.10807,-0.436985,0.333927,-0.370741,0.062696
openstack/kolla-ansible,I5a5d4f227205e811732331ee6e020ccea67b6fab,1,1,0.92,2.0794,0.1429,2,8.5,157,0,Bug Fix,0,0,0,50,0.059032,0.0,0,0.0,4,2,0,0.8006,0.8631,3.0,29.01,12.81,1,0,0.0,1,19.625,0,6,0,15,0,"Fix Docker health check for sahara_engine

The wrong process name was being used.

Closes-Bug: #2046268
[SEP]
FILES CHANGED:
ansible/roles/sahara/defaults/main.yml (+1, -1)
releasenotes/notes/fix-sahara-engine-healthcheck-cfc635de9e4f56bc.yaml (+5, -0)
",2.153404,-1.05372,-0.060682,-0.985714,-1.031853,0.481758,-0.525367,0.340922,0.136956,-0.535166,0.367468,-0.172649,-0.242114,0.017756,0.152912
openstack/charm-ceph-mon,Ibac09d2bf77eeba69789434eaa6112c2028fbf64,0,1,0.6667,1.0986,0.5,1,9.75,287,0,Bug Fix,0,1,0,9,0.006307,0.9756,0,0.6504,0,1,0,0.9667,0.0,0.0,51.6,13.13,1,0,0.0,1,95.6667,0,12,0,11,0,"Revert default source to 'bobcat'

The Openstack libs don't recognize Ceph releases when specifying
the charm source. Instead, we have to use an Openstack release.
Since it was set to quincy, reset it to bobcat.

Closes-Bug: #2026651
[SEP]
FILES CHANGED:
config.yaml (+1, -1)
",0.230813,-0.672523,-0.90095,0.51144,-0.345639,0.302144,0.243409,-0.049276,-0.180703,0.158541,0.458867,0.224496,-0.034765,-0.115602,0.119711
openstack/charm-ceph-radosgw,I5b82c876184025a790e2b0cab84348c71a8a4a55,0,0,0.6,1.0986,0.5,1,9.25,266,0,CI,0,1,0,10,0.006998,0.9524,0,0.5714,0,1,0,1.0,0.0,0.0,48.82,12.35,1,0,0.0,1,88.6667,0,0,0,0,0,"Revert default source to 'bobcat'

The Openstack libs don't recognize Ceph releases when specifying
the charm source. Instead, we have to use an Openstack release.
Since it was set to quincy, reset it to bobcat.
[SEP]
FILES CHANGED:
config.yaml (+1, -1)
",0.476412,-0.465019,-0.789138,1.054942,-0.008855,0.240824,0.570422,-0.304324,-0.371908,0.135572,0.361269,0.416304,-0.269112,-0.123768,0.052261
openstack/kolla-ansible,I79ec11c013fb1d7381fc152ab92e3d607ae822b9,0,0,0.8667,5.4424,0.4304,3,4.33,160,0,CI,1,0,0,60,0.05137,0.5714,0,0.4952,1,3,0,0.8012,1.4036,1.0,-25.33,20.19,1,0,1.0,1,0.6926,0,0,0,0,0,"CI: Template out kolla-build.conf using Ansible role
[SEP]
FILES CHANGED:
tests/run.yml (+18, -10)
tests/setup_gate.sh (+0, -89)
zuul.d/base.yaml (+113, -0)
",2.17475,1.256927,-0.049733,0.047438,0.42696,-0.662214,-0.176028,0.439295,-0.422021,-0.47505,0.329189,-0.061644,-0.078194,0.427865,-0.433853
openstack/kolla-ansible,Ic9bd25a09b860838910dbe3d55f94421a0461c57,1,0,0.8525,2.8904,0.5294,1,6.0,84,0,Feature,0,0,0,61,0.043634,1.0,0,0.8525,4,1,0,0.7988,0.0,4.0,3.34,15.73,0,0,0.0,0,4.6667,0,0,0,0,0,"Rework quorum queues precheck
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/precheck.yml (+8, -9)
",3.009482,0.509932,1.517419,0.611686,2.00642,0.606127,0.358653,-0.012623,0.024649,-0.504167,-0.456426,-0.676503,0.065116,-0.082815,0.395136
openstack/kolla-ansible,Ibf9a9a0c18938f638c8e8b00b6017c64f1523b23,1,0,0.8548,1.9459,0.0,2,8.0,95,0,Feature,0,0,0,62,0.043816,1.0,0,0.8548,4,1,0,0.7994,1.0,4.0,-12.78,23.2,0,0,0.0,0,13.5714,0,0,0,0,0,"quorum: add missing octavia and masakari
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia.conf.j2 (+3, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+3, -0)
",2.130513,1.197955,0.380581,0.151627,1.563131,0.193987,0.369762,-0.491488,-0.36801,-0.217595,0.263908,0.555134,0.545452,-0.288039,-0.055218
openstack/networking-baremetal,Ib53386f34f75f994cbe116bb37e3a82e61960da6,0,1,0.5,2.3979,0.1,2,18.5,568,0,Bug Fix,0,0,0,2,0.025974,0.0,0,0.0,2,2,0,0,0.971,2.0,31.43,16.05,0,0,0.0,1,51.6364,0,12,0,9,0,"don't force amqp_auto_delete for quorum queues

this feature is not compatible with quorum queues
This was introduced with Ie51d0a0b02ed5ea336f3280d84d77cf8fec90ccb
I'm not sure if this kind of behaviour is needed
in case of quorum queues. If it is, it might be necessary
to adjust the TTL of the quorum queues, however afaik oslo_messaging
does not expose this directly.

It might be possible to emulate this with `rabbit_quorum_delivery_limit`

Closes-Bug: #2046962
[SEP]
FILES CHANGED:
releasenotes/notes/fix_autodelete_for_quorum_queues-e001f2d8d8ae780b.yaml (+6, -0)
networking_baremetal/agent/ironic_neutron_agent.py (+3, -1)
",-1.322144,-1.318467,-0.037759,-0.766314,0.423647,-0.169304,0.096286,-0.305196,0.041957,0.029006,0.164307,-0.158477,-0.292437,-0.407216,0.257628
openstack/openstack-ansible-plugins,Iaec4534ebd8ff80cf7c7e3a1c8f187dd3990e4bc,1,0,1.0,4.5643,0.0105,6,12.67,317,0,CI,0,0,0,1,0.006897,0.0,0,0.0,2,2,0,1.0,1.5271,1.67,11.42,18.75,1,0,0.9789,0,3.3021,0,0,0,0,0,"Ensure consistent ordering of network_mappings

The provider_networks module returned the network_mappings in a random
order changing with every invocation. This returns the entries sorted
and adds a test to ensure the ordering is consistent between
invocations.
[SEP]
FILES CHANGED:
tests/inventory (+3, -0)
plugins/modules/provider_networks (+1, -1)
tests/group_vars/hosts.yml (+2, -0)
tests/group_vars/all_containers.yml (+2, -0)
tests/group_vars/all.yml (+50, -0)
tests/test-modules.yml (+36, -0)
",0.391823,-0.640676,0.115912,1.469488,0.471941,0.536639,0.315902,-0.341702,0.673237,-0.186949,-0.425418,0.053715,-0.387752,-0.067433,0.202382
openstack/kolla-ansible,Ia6db7d6a41ddbda8fcbf563dc55a0c65ef8db9be,1,0,0.8571,1.3863,0.3333,2,10.0,103,0,Bug Fix,0,0,0,63,0.044335,0.5333,0,0.4571,6,2,0,0.8,0.9183,3.5,35.95,12.0,0,0,0.3333,1,25.75,0,0,0,0,0,"fluentd: Fix LE pos_file path after version bump
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
ansible/roles/common/templates/conf/input/11-letsencrypt.conf.j2 (+1, -1)
",2.496727,0.345043,1.37006,-0.321859,0.692013,-0.368453,-0.055766,0.038357,0.33459,-0.181042,-0.071324,-0.750918,-0.389296,-0.040959,0.005849
openstack/kolla,I635d2bc20d897d037739702bf15cbb2e2bdcb0b1,0,0,0.8594,1.0986,0.5,1,10.5,211,0,Feature,0,1,0,64,0.044944,0.4615,0,0.3966,2,1,0,0.8085,0.0,2.0,39.06,9.91,1,0,0.0,0,70.3333,0,0,0,0,0,"Revert ""[release] Use Bobcat sources by default""

This reverts commit 033286f4c15bb80a91b4e8dcb9a0be283daf9535.

Reason for revert: Let's get back to master
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",0.917033,-0.066371,-1.892398,-1.758255,0.839227,0.813342,1.259606,-0.537531,-0.021065,0.035525,-0.109348,0.242042,-0.331378,-0.050892,-0.530269
openstack/kolla,I6a56639d9b61944cf2ea5efd1063ebd3c8950113,1,0,0.7143,1.0986,0.5,1,4.25,137,0,Feature,0,0,0,7,0.072165,0.5,0,0.3571,2,1,0,0.8042,0.0,2.0,63.18,8.76,1,0,0.0,0,45.6667,0,0,0,0,0,"Bump gnocchi version to 4.6.1

Gnnochi has made a new patch release, let's use it.
[SEP]
FILES CHANGED:
kolla/common/sources.py (+1, -1)
",1.826454,0.0353,-0.647376,0.170926,-0.580296,0.587643,0.944629,-0.160101,-0.816201,0.475281,0.603403,0.507229,-1.070801,0.328527,0.223351
openstack/openstack-ansible,I65d3fa2e3d6d38f0a51ce1f402ac25d976b67b89,1,1,0.9444,0.6931,1.0,1,17.25,498,0,Bug Fix,1,0,0,126,0.043614,0.0,0,0.0,4,1,0,0.9178,0.0,4.0,44.65,14.44,0,0,1.0,0,249.0,0,6,0,44,0,"Skip installing curl for EL

Due to the bug in Ansible [1] it does not resolve requirement of /usr/bin/curl
properly, always trying to install `curl-minimal`, which would fail on systems with
already installed `curl`.

Since `curl` presence is essential for DNF, we should be able to skip installation
of curl to EL systems, as they are all shipped with it as of today.

[1] https://github.com/ansible/ansible/issues/82461

Closes-Bug: #2046172
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/vars/redhat.yml (+0, -1)
",-1.09516,0.0797,0.27666,0.250459,-0.487044,-0.009601,0.02756,-0.081685,-0.17512,0.436274,0.10575,-0.269847,0.066639,-0.351884,-0.132671
openstack/kolla-ansible,I73490d84da39a74ea7ac493c7dd41fe7bfe2f578,1,1,0.8462,1.7918,0.0,1,11.0,127,0,Bug Fix,0,0,0,65,0.045582,1.0,0,0.8462,4,1,0,0.8006,0.0,4.0,-27.37,18.95,0,0,0.0,0,21.1667,0,42,0,16,0,"magnum: Disable CAPI driver when kubeconfig missing

Closes-Bug: #2047360
[SEP]
FILES CHANGED:
ansible/roles/magnum/templates/magnum.conf.j2 (+5, -0)
",2.109002,-0.861257,-0.272114,-1.128449,-0.583694,0.191294,-0.533314,0.622125,0.033264,-0.370193,0.589181,-0.087003,-0.366851,-0.196755,0.24308
openstack/openstack-ansible-openstack_hosts,If1840530a54aa9ae22eda1d3094f0c40ab66ddde,1,0,0.9449,2.5649,0.0833,2,9.67,491,0,CI,0,0,0,127,0.043945,0.0,0,0.0,2,2,0,0.8,0.9183,1.5,17.61,14.21,0,0,0.0,1,37.7692,0,0,0,0,0,"Remove `localhost` record from hosts file

After adding `localhost` to inventory explicitly [1] this caused an interesting
side-effect, where a record for `localhost` is being added to the managed block
in /etc/hosts file, which might override FQDN defenition for the host.

This also makes healthcheck-hosts.yml fail the test, since expected record is not present.

[1] https://review.opendev.org/c/openstack/openstack-ansible/+/899523
[SEP]
FILES CHANGED:
releasenotes/notes/do_not_add_localhost_to_hosts-36e365b95dc9da42.yaml (+8, -0)
tasks/openstack_update_hosts_file.yml (+3, -1)
",-0.548551,0.571767,0.257626,0.230724,-0.61779,-0.197047,0.891913,-0.065132,0.36038,-0.21372,0.050879,-0.58998,-0.002109,0.099506,-0.285067
openstack/openstack-ansible-ceph_client,I89b67f0f0545d799194d8486a6bb25227279af84,1,1,0.9453,3.091,0.1429,3,9.6,445,0,Bug Fix,0,0,0,128,0.044108,0.9412,0,0.8897,2,3,0,0.8889,1.2678,1.67,-0.31,14.67,1,0,0.0,1,20.2273,0,14,0,14,0,"Add backwards compatibility of ceph_components format

With [1] we have broken compatibility of potentially provided extra components
config without any notice.

In order to handle this now we fix backwards compatibility along with
adding a deprecation note on the format of ``client``.

[1] https://review.opendev.org/c/openstack/openstack-ansible-ceph_client/+/882827

Closes-Bug: #2047783
[SEP]
FILES CHANGED:
doc/source/configure-ceph.rst (+1, -1)
releasenotes/notes/ceph_components_format-3a947aa47ed2ff71.yaml (+13, -0)
vars/main.yml (+4, -2)
",-0.612528,0.342508,-0.346665,0.03421,-0.935174,-0.125159,0.470585,0.415259,0.382409,0.300669,-0.064217,-0.310537,-0.0112,-0.502899,0.148487
openstack/kolla-ansible,I638ba32e97234900745df62056710dcc37e7db77,1,0,0.8485,1.0986,0.5,1,10.0,215,0,Bug Fix,0,0,0,66,0.046122,0.0,0,0.0,5,1,0,0.8012,0.0,5.0,14.8,18.0,0,0,0.0,0,71.6667,0,0,0,0,0,"haproxy: Fix single frontend after LE cert path change

I35317ea0343f0db74ddc0e587862e95408e9e106 changed certificate path but omitted
single frontend template.
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/haproxy/haproxy_external_frontend.cfg.j2 (+1, -1)
",0.139466,-0.65282,-1.373806,-1.727177,1.792476,0.317378,-0.168016,-0.340694,0.243277,0.055526,-0.871547,0.159397,-0.090637,-0.379038,0.195006
openstack/kolla-ansible,Ie3ddf7819934d2b100867f29ac9a9395c854d9f7,1,0,0.8507,0.6931,0.0,1,11.0,106,0,CI,1,0,0,67,0.046755,0.6667,0,0.5672,1,1,0,0.8018,0.0,1.0,64.92,11.67,0,0,1.0,0,53.0,0,0,0,0,0,"CI: add a message for fluentd string match function
[SEP]
FILES CHANGED:
tests/check-logs.sh (+1, -0)
",3.210055,-0.42213,1.505937,0.186001,0.261508,-0.362133,0.241148,0.291439,0.701574,0.426926,-0.640457,-0.162721,0.236453,-0.076334,-0.054941
openstack/openstack-ansible,I8a32736239c6326d817c620451799c13d5d8938c,1,1,0.9457,4.2341,0.2206,2,15.29,872,0,Bug Fix,0,0,0,129,0.044133,0.0,0,0.0,2,2,0,0.9189,1.0,2.0,20.54,16.58,1,0,0.0,1,12.6377,0,14,0,25,0,"Modify RGW client format

With changes to config_template module that restored usage of {% raw %} tags [1]
renderring of mapping keys, if they're defined as variables, was broken.

Ansible, by design [2], does not render mapping keys. Moreover, it was not
working as intended anyway, since renderring happened in post-copy stage
so same records were not merged together, which resulted in #1812245

As such behaviour is expected by Ansible design, instead of adding some
workaround in config_template module, I suggest working around issue
by defining troublesome mapping with Jinja, that will allow it to render properly.

[1] https://review.opendev.org/c/openstack/ansible-config_template/+/881887
[2] https://github.com/ansible/ansible/issues/17324#issuecomment-685102595

Closes-Bug: #2048036
Related-Bug: #1812245
[SEP]
FILES CHANGED:
releasenotes/notes/config_overrides_dict_key_vars-962b4bebca02c477.yaml (+34, -0)
inventory/group_vars/ceph-rgw.yml (+19, -15)
",-3.04431,0.411355,1.848074,-0.630701,-0.758146,0.01108,-0.235923,0.032017,0.007783,0.104544,-0.010803,-0.200552,0.068384,-0.252261,-0.045474
openstack/openstack-ansible-lxc_hosts,Ied402f4f22ac333573c7144877da669251eccf8c,1,1,0.9462,1.0986,0.5,1,7.75,311,0,Bug Fix,0,0,0,130,0.043464,0.0,0,0.0,1,1,0,1.0,0.0,1.0,10.67,14.71,1,0,0.0,0,103.6667,0,6,0,41,0,"Fix permissions for base directories

With fixing linters [1] I have accidentally set incorrect mode for base directories
to 0644 while it should be 0755.

[1] https://review.opendev.org/c/openstack/openstack-ansible-lxc_hosts/+/888180

Closes-Bug: #2047593
[SEP]
FILES CHANGED:
tasks/lxc_pre_install.yml (+1, -1)
",-0.31065,0.83911,-0.896929,-0.115911,-0.917403,-0.29746,0.133282,0.172886,0.143078,0.14293,-0.243075,-0.647399,0.341053,-0.231575,-0.048872
openstack/kolla-ansible,Ia8c85d03404cfb368e4013066c67acd2a2f68deb,1,1,0.9412,1.9459,0.0,2,3.71,703,0,Bug Fix,0,0,0,17,0.020962,1.0,0,0.9412,2,2,0,0.8024,0.65,2.0,-91.41,16.1,0,0,0.0,1,100.4286,0,8,0,24,0,"Fix long service restarts while using systemd

Some containers exiting with 143 instead of 0, but
this is still OK. This patch just allows
ExitCode 143 (SIGTERM) as fix. Details in
bugreport.

Services which exited with 143 (SIGTERM):

kolla-cron-container.service
kolla-designate_producer-container.service
kolla-keystone_fernet-container.service
kolla-letsencrypt_lego-container.service
kolla-magnum_api-container.service
kolla-mariadb_clustercheck-container.service
kolla-neutron_l3_agent-container.service
kolla-openvswitch_db-container.service
kolla-openvswitch_vswitchd-container.service
kolla-proxysql-container.service

Partial-Bug: #2048130
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_systemd_worker.py (+1, -0)
releasenotes/notes/bug-2048130-23b8174396bd3c69.yaml (+5, -0)
",-4.490414,2.106654,0.994772,-0.175985,0.962091,-0.487254,-1.155094,0.084592,-0.133898,-0.679635,0.497844,0.141946,0.206404,0.759678,0.080013
openstack/kolla-ansible,I89c62a45b1f358aafadcc0317ce882f4609543e7,1,1,0.8837,2.3026,0.1111,2,11.9,848,0,Bug Fix,0,0,0,86,0.024891,0.7778,0,0.6873,4,2,0,0.803,0.7642,3.0,36.93,15.85,0,0,0.0,1,84.8,0,6,0,14,0,"cadvisor: Set housekeeping interval to Prometheus scrape interval

The prometheus_cadvisor container has high CPU usage. On various
production systems I checked it sits around 13-16% on controllers,
averaged over the prometheus 1m scrape interval. When viewed with top we
can see it is a bit spikey and can jump over 100%.

There are various bugs about this, but I found
https://github.com/google/cadvisor/issues/2523 which suggests reducing
the per-container housekeeping interval. This defaults to 1s, which
provides far greater granularity than we need with the default
prometheus scrape interval of 60s.

Reducing the housekeeping interval to 60s on a production controller
reduced the CPU usage from 13% to 3.5% average. This still seems high,
but is more reasonable.

Closes-Bug: #2048223
[SEP]
FILES CHANGED:
ansible/roles/prometheus/defaults/main.yml (+1, -1)
releasenotes/notes/bug-2048223-bb66fa11c6b36c5e.yaml (+7, -0)
",-2.351634,-1.032006,1.911418,-0.375532,-0.419274,0.166515,0.064636,0.00915,-0.10503,0.17909,0.078038,0.001539,0.088175,-0.342738,0.345788
openstack/openstack-ansible-lxc_hosts,I23529b0dd032cbb6ba59acc3d3b668c06847da08,1,0,0.85,1.0986,0.5,1,3.12,311,0,Bug Fix,0,0,0,20,0.065789,0.0,0,0.0,2,1,0,1.0,0.0,2.0,-50.14,17.25,0,0,0.0,0,103.6667,0,0,0,0,0,"Fix resolved config on Debian

Currently, file /etc/systemd/resolved.conf.d/openstack-ansible.conf has
incorrect format and is being ignored:

```
systemd-resolved[740]:
/etc/systemd/resolved.conf.d/openstack-ansible.conf:2:
Missing '=', ignoring line.
```
[SEP]
FILES CHANGED:
templates/prep-scripts/debian_prep.sh.j2 (+1, -1)
",-1.884479,1.988366,-1.386437,0.857458,0.25817,-0.36494,-0.24916,-0.020216,-0.023162,0.121887,-0.096322,-0.633594,-0.253229,0.754376,-0.131288
openstack/openstack-ansible,Ief4e81d6b6708d5830d753408d279bd6dea8fd52,1,0,0.9466,3.6109,0.5,16,4.71,732,0,Bug Fix,0,0,0,131,0.043769,1.0,0,0.9466,3,1,0,0.92,3.9477,3.0,-31.24,14.01,0,0,0.0,0,19.7838,0,0,0,0,0,"Return back /healtcheck URI verification

With [1] we have implemented monitoring of helatcheck middleware [2]
for services that does support it. However during refactoring [3] URI was missed
which potentially might have regression for some services. Due to another bug [4] this could be easily missed previously, since only L4 checks
were issued rather then L7.

[1] https://review.opendev.org/c/openstack/openstack-ansible/+/864424
[2] https://docs.openstack.org/oslo.middleware/latest/reference/healthcheck_plugins.html
[3] https://review.opendev.org/c/openstack/openstack-ansible/+/887285
[4] https://review.opendev.org/c/openstack/openstack-ansible-haproxy_server/+/903463
[SEP]
FILES CHANGED:
inventory/group_vars/cinder_all/haproxy_service.yml (+1, -1)
inventory/group_vars/swift_all/haproxy_service.yml (+1, -1)
inventory/group_vars/keystone_all/haproxy_service.yml (+1, -1)
inventory/group_vars/glance_all/haproxy_service.yml (+1, -1)
inventory/group_vars/neutron_all/haproxy_service.yml (+1, -1)
inventory/group_vars/octavia_all/haproxy_service.yml (+1, -1)
inventory/group_vars/heat_all/haproxy_service.yml (+2, -2)
inventory/group_vars/barbican_all/haproxy_service.yml (+1, -1)
inventory/group_vars/manila_all/haproxy_service.yml (+1, -1)
inventory/group_vars/horizon_all/haproxy_service.yml (+1, -1)
inventory/group_vars/zun_all/haproxy_service.yml (+1, -1)
inventory/group_vars/ironic_all/haproxy_service.yml (+2, -2)
inventory/group_vars/murano_all/haproxy_service.yml (+1, -1)
inventory/group_vars/cloudkitty_all/haproxy_service.yml (+1, -1)
inventory/group_vars/magnum_all/haproxy_service.yml (+1, -1)
inventory/group_vars/gnocchi_all/haproxy_services.yml (+1, -1)
",-3.381591,3.19808,0.881448,0.187369,-0.700352,-0.04522,0.325482,0.075112,-0.051127,0.167458,-0.233674,0.117526,-0.014926,-0.428225,-0.030965
openstack/ironic,Id91ec6afcf89642fb3069918e768016b8b657a31,1,1,0.9706,2.9957,0.0526,3,25.5,667,1,Bug Fix,0,0,0,34,0.012261,1.0,0,0.9706,4,2,0,0.95,1.1674,2.67,33.32,17.26,0,0,0.0526,1,33.35,0,6,0,27,0,"Fix system scoped manageable node network failure

Before this change, if a user requested a node to be cleaned
or ""managed"" with cleaning enabled when the user is in the
system scope, Ironic would attempt to user's token to
make the request to Neutron.

This, unfortunately, does not work, as the neutron client explicitly
requires a project ID to make the request to Neutron. As a result,
Ironic now falls back to it's internal credential configuration to make
the forward request, which matches the behavior if a node has been
unprovisioned and the cleaning has been started automatically.

Closes-Bug: 2048416
[SEP]
FILES CHANGED:
releasenotes/notes/fix-system-scope-triggered-clean-22ada9b920c08365.yaml (+12, -0)
ironic/tests/unit/common/test_neutron.py (+1, -0)
ironic/common/neutron.py (+5, -1)
",-1.05166,-1.993523,0.879918,0.36243,-0.589101,0.015208,0.396567,0.087697,0.306634,-0.083727,0.404652,0.489271,-0.056647,0.133004,-0.042209
openstack/ironic,I0feefc273a2d18e7812139f59df3f43aba7d7936,1,1,0.9714,3.434,0.0333,3,20.2,638,0,Bug Fix,0,0,0,35,0.012536,1.0,0,0.9714,6,2,0,0.9505,1.5179,4.0,46.45,15.6,0,0,0.3667,1,20.5806,0,6,0,8,0,"RBAC: Fix allocation check

The tl;dr, is when the allocation owner support was added,
it was done so to try and use the same exception
being raised for two distinct cases. An invalid request,
and a mismatch. The reality is, we should be raising them
separately because there are two different cases we need
to guard against.

This was discovered when changing Ironic's default RBAC
policy enforcement so that the legacy policy is no longer
enabled, which meant the default path on the owner logic was
thus triggered, resulting in the failure and need to fix it.

Closes-Bug: #2048698
[SEP]
FILES CHANGED:
releasenotes/notes/fix-allocation-exception-on-list-c04e93fb9cace218.yaml (+6, -0)
ironic/api/controllers/v1/allocation.py (+12, -1)
ironic/tests/unit/api/controllers/v1/test_allocation.py (+11, -0)
",-0.963472,-2.68514,1.066579,-0.241513,-1.097798,0.181067,0.219432,-0.06377,0.152478,0.428036,0.401089,0.154302,-0.073056,-0.103183,0.332763
openstack/kolla-ansible,I523018cb98944de60d7b95404deb7cebd641f33a,0,1,0.8529,4.1589,0.9365,5,9.8,421,0,Bug Fix,0,0,0,68,0.04742,0.0,0,0.0,4,2,0,0.8036,1.9968,4.0,22.51,14.53,1,0,0.0,0,6.5781,0,8,0,24,0,"openvswitch: Stop using intermediate scripts

This will fix exit codes - details in bug.

Basically openvswitch treats TERM as something fatal (exits
with 143) and the only solution for graceful exit is using
ovs-appctl and sending exit command, just like ovs-ctl utility
does.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/905189

Partial-Bug: #2048130
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/tasks/config.yml (+0, -28)
ansible/roles/openvswitch/templates/openvswitch-vswitchd.json.j2 (+2, -9)
ansible/roles/openvswitch/templates/start-ovsdb-server.j2 (+0, -11)
ansible/roles/openvswitch/templates/openvswitch-db-server.json.j2 (+2, -9)
ansible/roles/openvswitch/templates/start-ovs.j2 (+0, -2)
",-0.83375,-0.350594,-0.222428,-0.376252,-1.032989,-0.335847,0.132703,0.102398,-0.106001,-0.044304,0.338194,-0.533321,0.440519,0.090528,0.155865
openstack/kolla-ansible,Ib971b694c12ccb51e0893978dd5962040f2fbd22,0,1,0.8406,1.0986,0.5,1,3.33,183,0,Bug Fix,0,0,0,69,0.046092,0.0,0,0.0,4,1,0,0.8012,0.0,4.0,-75.73,21.33,1,0,0.0,0,61.0,0,8,0,24,0,"mariadb-clustercheck: Use socat wrapper

Depends-On: https://review.opendev.org/c/openstack/kolla/+/904981

Partial-Bug: #2048130
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/mariadb-clustercheck.json.j2 (+1, -1)
",0.592564,2.121011,-1.409098,-0.858026,-1.486719,0.134922,-0.013876,0.032936,0.25573,-0.694738,-0.261198,-0.044781,0.005872,-0.238938,0.194789
openstack/kolla-ansible,I39fe2db9182de23c1df814d911eec15e86317702,0,1,0.9444,2.3979,0.2,3,5.75,231,0,Bug Fix,0,0,0,18,0.022032,0.8,0,0.7556,4,2,0,0.7988,1.371,3.33,-23.38,21.43,1,0,0.0,1,21.0,0,8,0,17,0,"Enable instance usage audit only when ceilometer is enabled

This patch disables periodic compute.instance.exists
notifications when designate is enabled.

Related-Bug: #2049503
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova.conf.j2 (+1, -1)
ansible/roles/nova-cell/templates/nova.conf.j2 (+1, -1)
releasenotes/notes/disable-usage-audit-notifications-6e63588bdcc48603.yaml (+6, -0)
",0.987635,-1.228841,-0.083397,-0.10492,-0.454756,0.058312,-0.776672,0.236483,0.54495,-0.178555,-0.084174,0.09239,-0.085644,0.081866,0.041966
openstack/sunbeam-charms,I85ef251709b96520e9b6054e86ea3a7cb5940c55,1,0,0,1.0986,0.5,1,5.0,213,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0,0.0,3.0,35.94,11.6,0,0,0.0,0,71.0,0,0,0,0,0,"Expand VLAN range

Changes VLAN range to the full allowed range.
The values of 0 and 4095 are reserved.
[SEP]
FILES CHANGED:
charms/neutron-k8s/src/charm.py (+1, -1)
",1.014092,-0.759438,-0.40521,0.988516,0.582949,0.875241,-0.214296,0.489792,0.897126,0.224076,-0.263256,0.682681,-0.024792,0.329439,-0.848997
openstack/kolla,If10006bf7f037a44b9b664b70ad423f7c6c08f45,0,1,1.0,2.3026,0.0,3,17.75,479,0,Bug Fix,0,0,0,9,0.045455,0.8333,0,0.8333,3,2,0,0.8053,1.2244,2.67,50.6,14.42,0,0,0.0,0,47.9,0,6,0,3,0,"Support collecting libvirt qemu domain logs

This change causes the logs to be collected in /var/log/kolla.
Unfortuantly, it was not possible to change the log directory via a
config option, so we need to symlink the hardcoded path to a directory
under /var/log/kolla. The consequence of this is that the logs are
collected in the kolla logs volume where other programs, such as
fluentd, can read them.

Partial-Bug: #2049389
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+2, -0)
docker/nova/nova-libvirt/extend_start.sh (+6, -0)
docker/fluentd/Dockerfile.j2 (+1, -0)
",-1.517944,-0.614693,-0.249038,0.838241,-0.036823,-0.044623,0.433503,-0.140459,-0.033301,0.144619,0.342008,-0.0452,0.044838,0.010026,0.032735
openstack/kolla-ansible,I0b36d3338d5dc6f553aba3ac631832b549b5ca68,0,1,0.9,3.6109,0.0278,8,9.8,395,0,Bug Fix,0,0,0,10,0.048309,1.0,0,0.9,6,2,0,0.7964,2.4566,4.75,36.32,12.08,0,0,0.0,0,10.6757,0,6,0,3,0,"Support collecting libvirt domain logs

This makes use of the linked kolla patch which exposes the logs
in /var/log/kolla. The log file is some what unstructured, so
we are using the concat filter to merge some output that is split
over serveral lines.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/905580
Partial-Bug: #2049389
[SEP]
FILES CHANGED:
ansible/roles/common/defaults/main.yml (+2, -0)
ansible/roles/common/templates/cron-logrotate-nova-libvirt.conf.j2 (+3, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
ansible/roles/common/tasks/check-containers.yml (+1, -0)
ansible/roles/common/handlers/main.yml (+1, -0)
ansible/roles/common/templates/conf/filter/00-record_transformer.conf.j2 (+9, -1)
ansible/roles/common/templates/conf/filter/00-concat.conf.j2 (+7, -0)
ansible/roles/common/templates/conf/input/05-libvirt.conf.j2 (+11, -0)
",-0.856549,-0.197746,-0.483717,-0.148068,-1.085657,-0.360226,0.356507,-0.007892,0.01382,-0.195707,-0.11479,-0.435877,0.232496,0.031223,0.008353
openstack/octavia,I80a266e500958415a70d462ddfe57e9e03e6ef13,1,1,1.0,2.9957,0.1053,2,6.0,123,0,Bug Fix,0,0,0,1,0.012658,0.8,0,0.8,2,2,0,0.6042,0.7425,2.0,3.34,12.4,1,0,0.0,1,6.15,0,10,0,14,0,"fix: specify endpoint info. for neutron client

Closes bug: #2049551
[SEP]
FILES CHANGED:
octavia/common/clients.py (+13, -2)
releasenotes/notes/add-neutron-client-interface-info-06faaaad92886b8c.yaml (+4, -0)
",2.571867,-1.440062,0.488293,-1.233658,-0.741318,0.413998,-0.518647,0.506964,0.177239,-0.091036,0.095432,-0.536862,-0.027308,-0.21508,0.414779
openstack/kolla-ansible,Icccfc1c509179c3cfd59650b7917a637f9af9646,1,1,0,3.091,0.0,3,14.0,221,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.794,1.5751,3.33,56.66,12.74,1,0,0.0,1,10.0455,0,24,0,18,0,"Add conditionals for IPv6 sysctl settings

This way the playbooks won't try to set ipv6 systemctl options
unless ipv6 is available on the system.

Closes-bug: #1906306
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1906306-640d5085576656f9.yaml (+8, -0)
ansible/roles/loadbalancer/tasks/config-host.yml (+7, -0)
ansible/roles/neutron/tasks/config-host.yml (+6, -0)
",0.087903,-1.494401,-0.13852,-0.02737,-0.075208,-0.122719,-0.70737,-0.122625,-0.081812,0.026857,-0.183846,-0.268111,0.309951,-0.112002,0.244275
openstack/kolla-ansible,Ie766d04c666dedfa47ece9b605ccd7976fc7fcbb,0,0,0,3.434,0.0667,5,7.71,419,0,Doc,0,0,0,0,0.0,0.5,0,0.0,2,1,0,0.7946,1.75,1.8,21.97,13.46,0,0,0.0333,0,13.5161,0,0,0,0,0,"WIP: Add action for getting container names list

This patch adds a new action to kolla_container module,
which retrieves list of names of all containers.
It is intended to be an alternative to using
""docker ps -a"" type of commands in the Ansible code.
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+4, -1)
tests/test_kolla_container.py (+1, -0)
ansible/library/kolla_container.py (+2, -0)
ansible/module_utils/kolla_container_worker.py (+17, -0)
ansible/module_utils/kolla_podman_worker.py (+4, -1)
",0.663623,-1.53089,-0.11553,0.724721,-0.421668,-0.270621,0.468141,0.169716,0.33254,0.102454,-0.348124,0.005924,0.075123,0.169883,-0.18846
openstack/kolla-ansible,Ia03ba23bfbde7d50a88dc16e4f117dec3c98a448,1,1,1.0,4.4188,0.4268,3,18.8,616,0,Bug Fix,0,0,0,4,0.021164,0.5,0,0.5,4,2,0,0.7923,1.3003,3.33,44.65,16.88,1,0,0.0,1,7.4217,0,8,0,13,0,"Fix OpenSearch upgrade tasks idempotency

Shard allocation is disabled at the start of the OpenSearch upgrade
task. This is set as a transient setting, meaning it will be removed
once the containers are restarted. However, if there is not change in
the OpenSearch container it will not be restarted so the cluster is left
in a broken state: unable to allocate shards.

This patch moves the pre-upgrade tasks to within the handlers, so shard
allocation and the flush are only performed when the OpenSearch
container is going to be restarted.

Closes-Bug: #2049512
[SEP]
FILES CHANGED:
releasenotes/notes/fix-opensearch-upgrade-idempotency-4d20a8102717cc56.yaml (+6, -0)
ansible/roles/opensearch/tasks/upgrade.yml (+0, -35)
ansible/roles/opensearch/handlers/main.yml (+41, -0)
",-1.147275,-1.597242,0.648945,0.402765,-0.213164,0.204758,-0.018569,-0.109517,0.27122,0.161816,0.344631,0.42872,-0.100547,0.160759,0.043994
openstack/kolla-ansible,I84cc5ce25da2fcfe4f284d8b3197f40d3a6d7ce1,0,0,0,3.7612,0.2857,2,7.0,97,0,Feature,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7929,0.7025,3.0,-78.24,25.66,1,0,0.0,1,2.2558,0,0,0,0,0,"Allow customizing of Skyline configuration
[SEP]
FILES CHANGED:
ansible/roles/skyline/tasks/config.yml (+22, -12)
releasenotes/notes/skyline-customize-config-a877dc747028bf07.yaml (+8, -0)
",2.638018,1.444321,1.787811,1.196046,1.038601,1.057872,0.470563,0.146329,0.583441,-0.3517,-0.326072,0.215156,0.238298,-0.444791,-0.071592
openstack/openstack-ansible-ceph_client,I5fe0fff9616e0829b83f61bd1b062cfd978543d6,1,0,0.947,1.0986,0.5,1,12.8,527,0,CI,0,0,0,132,0.043579,0.0,0,0.0,1,1,0,0.9,0.0,1.0,28.61,12.62,0,0,0.0,0,175.6667,0,0,0,0,0,"Align extra conf files mode

When placing ceph_extra_confs files to their destination, they're being
assigned mode 0644 with root:root ownership. However, when we're overriding
some sections in config files, we also accidentally change mode of these
files to 0640 which makes issues while reading them by clients and
makes role not idempotent.

This issue was introduced by this commit [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible-ceph_client/+/888216
[SEP]
FILES CHANGED:
tasks/ceph_config_extra.yml (+1, -1)
",-1.509457,-0.377324,0.281882,-0.114816,-0.525174,-0.375896,0.140754,0.058248,-0.083055,0.223398,0.016532,-0.417877,0.023513,-0.129344,-0.246748
openstack/openstack-ansible-os_glance,I0a6a96a70f05815871a499935a61af9993186edb,1,0,0.9474,1.0986,0.5,1,9.0,328,0,Bug Fix,0,0,0,133,0.04388,0.0,0,0.0,1,1,0,0.75,0.0,1.0,-2.05,13.6,0,0,0.0,0,109.3333,0,0,0,0,0,"Fix iteration over backends config

Backend config is a dictionary and it's attempted to be iterated as dict,
however it was missing items() call.

Issue has been introduced with the patch [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_glance/+/901034
[SEP]
FILES CHANGED:
templates/glance-api.conf.j2 (+1, -1)
",-1.068316,0.587341,-0.611724,0.230841,-0.886637,-0.070888,0.164688,-0.115307,0.164272,0.367828,-0.252555,-0.218908,0.006222,-0.06738,-0.167588
openstack/magnum,I2b88a14cc67a4fba35fcfc187a91771e1d714844,1,1,0,2.0794,0.5714,1,9.5,178,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.8889,0.0,4.0,23.54,16.43,1,0,0.0,0,22.25,0,256,0,17,0,"Move the chmod function before the write and flush functions to prevent sensitive information leakage.

Closes-Bug: #2047690
[SEP]
FILES CHANGED:
magnum/conductor/handlers/common/cert_manager.py (+3, -4)
",1.422133,-0.082917,-0.498078,-0.044016,-0.127645,1.019894,-0.051526,-0.362525,0.453686,-0.294144,0.485743,0.032372,0.143325,-0.246515,0.106967
openstack/kolla-ansible,I60ab4634bf4333c47d00b12fc4ec00570062bd18,0,0,0.8947,6.2106,0.9658,5,3.71,337,0,Doc,0,0,0,19,0.022975,0.0,0,0.0,4,4,0,0.7906,0.3834,3.6,-44.23,19.95,1,0,0.0,1,0.6767,0,0,0,0,0,"Rework horizon role to support local_settings.d

This patch implements horizon's preferred way how
to configure itself described in docs [1],

[1] https://docs.openstack.org/horizon/latest/configuration/settings.html

Depends-On: https://review.opendev.org/c/openstack/kolla/+/906339
[SEP]
FILES CHANGED:
releasenotes/notes/horizon-local-settings-d-32c9ad3d40ca23f4.yaml (+9, -0)
ansible/roles/horizon/templates/horizon.json.j2 (+4, -4)
ansible/roles/horizon/tasks/config.yml (+2, -2)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+0, -472)
doc/source/reference/shared-services/horizon-guide.rst (+2, -2)
",-1.007403,1.829482,-0.765197,0.179008,-1.326104,0.062094,0.046411,0.204522,0.09439,0.174494,-0.513591,-0.600941,-0.086953,-0.086304,-0.266292
openstack/openstack-ansible-os_ironic,I0a2c3f3019f20c18dcfbc82847c432e656eda051,1,1,0.9478,1.0986,0.5,1,7.0,304,0,Bug Fix,0,0,0,134,0.044181,0.9444,0,0.8951,1,1,0,1.0,0.0,1.0,-23.86,15.66,0,0,0.0,0,101.3333,0,6,0,12,0,"Fix a typo in pxe_redfish definition

This typo leads for drivers misconfiguration and being unable to register
redfish as a proper driver.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-os_tempest/+/907180
Closes-Bug: #2050835
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",-0.629429,1.33924,-1.210388,0.007887,-0.783011,0.026327,0.358166,0.00248,0.298818,-0.417616,0.035038,-0.312221,0.293312,-0.419019,0.455712
openstack/kolla,I2a4df6121236379d88d0d7f2f7a888feab273003,1,1,0.9231,2.0794,0.1429,2,11.0,113,0,Bug Fix,0,0,0,13,0.089041,0.0,0,0.0,3,2,0,0.801,0.8631,2.5,26.47,22.58,0,0,0.0,1,14.125,0,6,0,7,0,"Use full binary path when invoking ip

Closes-bug: #2051111
[SEP]
FILES CHANGED:
releasenotes/notes/fix-letsencrypt-ip-command-not-found-3c455acaf743409e.yaml (+5, -0)
docker/letsencrypt/letsencrypt-lego/letsencrypt-certificates.sh (+1, -1)
",2.162686,-1.003278,0.197868,-0.975947,-0.471701,0.376584,-0.861931,0.067869,0.073659,-0.278149,0.10188,-0.402186,0.224999,-0.001793,0.128936
openstack/ansible-hardening,I73babb2431d4fda5aa90d9a1e230c1796449c0fc,1,0,0.9481,2.0794,0.5714,1,13.0,392,0,Feature,0,0,0,135,0.044481,0.0,0,0.0,2,1,0,1.0,0.0,2.0,30.95,14.43,0,0,0.0,0,49.0,0,0,0,0,0,"Use replace module instead of lineinfile for disabling dynamic motd

Lineinfile module can manage only single occurance of line in the file,
while pam.d/sshd contains multiple occurances of pam_motd which
results in not disabling it fully.

In order to properly comment out/uncomment all occurances replace module
should be used instead.
[SEP]
FILES CHANGED:
tasks/rhel7stig/sshd.yml (+3, -4)
",-0.502461,-1.501394,-0.182686,0.775407,0.360946,-0.445061,0.276991,-0.349496,-0.038158,-0.069605,-0.355855,-0.406782,0.157014,0.089398,-0.059283
openstack/ansible-collection-kolla,I05efda2a9699336136dce8cfa99ada77b9b2a17b,1,1,1.0,2.4849,0.1818,3,10.71,625,0,Bug Fix,0,0,0,5,0.01845,0.0,0,0.0,3,2,0,1.0,1.3093,2.67,16.61,14.42,1,0,0.0,1,52.0833,0,6,0,14,0,"Fix: include missing docker log-opts in config

The default docker config options, which specify the ``log-opts`` under
``roles/docker/vars/main.yml``, were not included in the
``docker_config`` combinations when the docker role was extracted from
the baremetal role in the Zed release. This means that
``docker_log_max_file`` and ``docker_log_max_size`` are not written into
the docker daemon.json.

The var name needs to be changed, as it can't be recursively defined
within the ``docker_config`` definition under
``roles/docker/tasks/config.yml`.

Closes-Bug: #2040105
[SEP]
FILES CHANGED:
roles/docker/vars/main.yml (+1, -1)
roles/docker/tasks/config.yml (+1, -1)
releasenotes/notes/fix-include-docker-log-opts-15607fb5a4ad3ed5.yaml (+7, -0)
",-2.09728,-0.349696,0.739448,0.230917,0.512581,-0.240117,-0.355451,0.275616,0.245183,-0.486214,-0.08461,-0.4377,-0.603642,0.357858,0.015504
openstack/kolla-ansible,I2593b6df737b384f1a5fba22f69e851c575990b4,1,0,0.85,5.9162,0.4108,24,9.75,991,0,Doc,0,0,0,20,0.015106,1.0,0,0.85,5,4,0,0.7882,2.9616,3.75,3.88,15.18,1,0,0.0,1,2.6712,0,0,0,0,0,"Enhance Ceph Integration for Multiple Clusters

This patch enhances Kolla-Ansible's existing support for
multiple Ceph clusters by improving the management of
custom users, pools, and cluster names. It aligns
the Ceph integration more closely with the official Ceph
user management guidelines [1].

Keyrings now follow the format `$cluster.client.$user.keyring`,
and configurations are easier to handle when multiple Ceph
clusters are in use, especially in environments with multiple
availability zones.

Previously, workarounds were needed for keyrings and config
files, which this patch eliminates, providing a cleaner and
more structured configuration approach which follows the
Ceph best practices.

The default Kolla setup remains unaffected by these changes,
ensuring backward compatibility.
Updated documentation and examples are included.

[1] https://docs.ceph.com/en/latest/rados/operations/user-management/#keyring-management
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+9, -2)
ansible/roles/gnocchi/tasks/external_ceph.yml (+5, -5)
ansible/roles/cinder/tasks/external_ceph.yml (+7, -7)
ansible/roles/cinder/templates/cinder.conf.j2 (+10, -6)
ansible/roles/cinder/defaults/main.yml (+4, -2)
ansible/roles/manila/defaults/main.yml (+2, -2)
ansible/roles/nova-cell/tasks/external_ceph.yml (+9, -9)
ansible/roles/glance/tasks/external_ceph.yml (+4, -2)
ansible/roles/glance/templates/glance-api.conf.j2 (+2, -2)
ansible/roles/glance/defaults/main.yml (+3, -1)
doc/source/user/operating-kolla.rst (+1, -2)
etc/kolla/globals.yml (+0, -6)
ansible/roles/gnocchi/defaults/main.yml (+0, -2)
ansible/roles/manila/tasks/external_ceph.yml (+2, -2)
doc/source/reference/storage/external-ceph-guide.rst (+124, -75)
releasenotes/notes/enhance-ceph-multiple-clusters-integration-d29815a12c223152.yaml (+17, -0)
ansible/group_vars/all.yml (+2, -8)
ansible/roles/nova-cell/templates/nova.conf.d/libvirt.conf.j2 (+3, -3)
ansible/roles/nova-cell/templates/nova-compute.json.j2 (+4, -4)
ansible/roles/zun/tasks/external_ceph.yml (+2, -2)
ansible/roles/nova-cell/templates/nova-libvirt.json.j2 (+2, -2)
ansible/roles/zun/templates/zun-compute.json.j2 (+4, -4)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+2, -2)
ansible/roles/zun/defaults/main.yml (+0, -2)
",-3.01025,-0.438802,2.091607,0.091246,-0.213406,-0.034835,-0.47314,0.72645,0.340866,0.030827,-0.47498,0.303093,-0.039162,-0.467283,-0.202474
openstack/kolla-ansible,I17a16ce746faa8898a457cadbb6f996f964a5b6f,0,0,0.8571,2.8332,0.5,3,30.0,372,0,Feature,0,0,0,21,0.012397,0.0,0,0.0,4,2,0,0.7889,0.0,4.0,43.85,18.0,1,0,0.0,0,21.8824,0,0,0,0,0,"Rename horizon settings filenames

The purpose of this patch is to make it easier to
review changes, because renaming and changing the
file in one patch will generate diff when the entire
file will be deleted on the one hand and new file
(actually just renamed) will be new on the other hand,
which is hard to review.
[SEP]
FILES CHANGED:
ansible/roles/horizon/tasks/config.yml (+8, -8)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+0, -0)
ansible/roles/horizon/templates/_9999-custom-settings.py.j2 (+0, -0)
",-1.129817,-1.222216,-0.271607,1.114369,0.176046,0.24166,-0.283349,-1.148122,-0.530459,0.46345,-0.255325,0.018811,0.066753,0.253078,-0.207107
openstack/kayobe,I0465eafa9e4ff37c96064ea8395f0bd461035b40,1,1,1.0,3.7612,0.2857,5,17.0,584,0,Bug Fix,0,0,0,6,0.021277,0.0,0,0.0,4,2,0,0.9474,2.1106,3.6,42.28,14.8,1,0,0.0,1,13.5814,0,14,0,14,0,"Fix: configure etc-hosts for overcloud group

Change the etc-hosts role to run on the overcloud group, as using
``ansible_play_hosts_all`` would exclude hosts when running with a
limit.

Also change the gather-facts-delegated role to run on the overcloud
group. The delegated task needs to be included separately as the hostvar
``ansible_host`` cannot be set dynamically based on a loop item in one
task. We loop over the batch indices here so that the tasks are included
in parallel, rather than in series.

Closes-Bug: #2051714
[SEP]
FILES CHANGED:
ansible/roles/gather-facts-delegated/tasks/main.yml (+7, -7)
ansible/roles/gather-facts-delegated/defaults/main.yml (+4, -4)
ansible/roles/etc-hosts/defaults/main.yml (+1, -1)
ansible/roles/gather-facts-delegated/tasks/gather-facts-delegated.yml (+12, -0)
releasenotes/notes/fix-etc-hosts-management-6b33748ab37d6273.yaml (+6, -0)
",-1.319247,-1.237915,0.473533,0.400542,0.182114,-0.470433,0.015402,-0.020497,0.304449,-0.272073,0.269655,-0.262405,-0.157575,-0.070302,-0.182332
openstack/openstack-ansible-os_keystone,I92434276aef54805e5cee56e1d22821e11245fe4,1,0,1.0,3.7377,0.0244,1,18.75,502,1,Feature,0,0,0,31,0.079897,0.0,0,0.0,1,1,0,1.0,0.0,1.0,40.04,16.57,0,0,0.0,0,11.9524,0,0,0,0,0,"Re-distribute fernet keys when re-building the primary

Currently when re-building the keystone primary node, a new set
of fernet keys will be created as none exists, despite keys
existing on the secondary nodes.

This patch uses a similar approach to the credential key
distribution where other nodes are checked for keys if none exist
on the first play host. In this case an rsync is performed to
distribute the keys correctly before proceeding.
[SEP]
FILES CHANGED:
tasks/keystone_fernet_keys_create.yml (+40, -1)
",-0.589678,-1.920649,0.662238,0.96353,0.065464,-0.154897,0.55541,-0.042453,0.526597,-0.017663,-0.279026,0.188538,0.108366,-0.060739,-0.07511
openstack/kolla-ansible,I6a17e689d62ab467b7dcc2650e7f63813ce84a12,1,1,0.8889,1.9459,0.0,2,3.6,255,0,Bug Fix,0,0,0,36,0.033488,0.7778,0,0.6914,4,2,0,0.7865,0.65,3.0,-60.02,21.44,1,0,0.0,1,36.4286,0,6,0,13,0,"Fix 'cinder-backup' service when Swift with TLS enabled

Closes-Bug: #2051986
Depends-On: https://review.opendev.org/c/openstack/cinder/+/907494
[SEP]
FILES CHANGED:
releasenotes/notes/fix-cinder-backup-tls-swift-cb694ed1df8caa26.yaml (+5, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -0)
",-0.185773,2.509879,-1.509775,-0.377671,-1.178171,0.252342,-0.224187,-0.119378,0.070156,-0.59973,-0.305373,-0.245477,0.317302,-0.419235,0.301121
openstack/kolla-ansible,Iab40eb92c7e4a9092471bef9d4477a4fa34f1c85,0,0,0.8286,4.4067,0.4938,9,3.0,98,0,Feature,0,0,1,70,0.046698,0.75,0,0.6214,4,6,0,0.7872,2.8569,1.89,6.39,14.53,0,0,0.5062,1,1.1951,0,0,0,0,0,"Bump ansible-core versions to 2.15 and 2.16
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+4, -3)
tests/run.yml (+0, -20)
doc/source/user/quickstart.rst (+4, -3)
lint-requirements.txt (+2, -2)
doc/source/conf.py (+9, -0)
zuul.d/base.yaml (+13, -8)
releasenotes/notes/ansible-core-2-16-257dc4502ede5b88.yaml (+5, -0)
tools/kolla-ansible (+2, -2)
ansible/roles/prechecks/vars/main.yml (+2, -2)
",0.442914,2.603988,-0.234353,0.887521,1.433054,0.350181,-0.140276,0.418976,-0.851831,1.610507,-0.113944,0.522704,-0.235426,0.56434,0.623697
openstack/ansible-role-systemd_networkd,If82946b7f5ad3c618606110576c586632f9bbd08,1,1,0.9485,1.0986,0.5,1,4.08,532,0,Bug Fix,0,0,0,136,0.044707,0.0,0,0.0,1,1,0,1.0,0.0,1.0,1.57,11.44,0,0,0.0,0,177.3333,0,18,0,14,0,"Use OriginalName instead of Name in systemd.link

Name option is not a valid one for systemd.link [1] while it is for systemd.network [2]
though having same meaning.

This basically resulted in link files being just ignored by udevadm
and were not loaded properly after reboot

[1] https://www.freedesktop.org/software/systemd/man/latest/systemd.link.html#OriginalName=
[2] https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html#Name=

Closes-Bug: #1896589
[SEP]
FILES CHANGED:
templates/systemd-link.j2 (+1, -1)
",-2.441466,2.299327,-0.077198,0.703028,-0.252573,0.322913,0.075427,-0.034862,-0.253989,0.355921,0.06546,-0.356425,0.119341,0.128056,-0.4212
openstack/kolla,Ie12c43dc1de122c203edc28181366457ccd67834,1,0,0.8169,4.5326,0.5326,11,3.0,207,0,Feature,0,0,1,71,0.044937,1.0,0,0.8169,3,9,0,0.8021,3.0802,1.73,-38.73,19.87,1,0,0.3043,1,2.2258,0,0,0,0,0,"Switch to Ubuntu 24.04 LTS

Add setuptools because Python3.12 dropped distutils

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/925581
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+1, -1)
requirements.txt (+1, -0)
tests/playbooks/pre.yml (+0, -8)
docker/nova/nova-libvirt/Dockerfile.j2 (+0, -6)
.zuul.d/base.yaml (+4, -4)
releasenotes/notes/ubuntu-24-04-585855b7d4753ce3.yaml (+5, -0)
.zuul.d/ubuntu.yaml (+6, -6)
kolla/template/repos.yaml (+14, -12)
docker/base/sources.list.ubuntu.aarch64 (+5, -5)
kolla/common/config.py (+2, -2)
docker/base/sources.list.ubuntu (+5, -5)
",0.181269,2.045354,-1.389955,-0.345352,-1.193024,0.025394,0.107397,0.244424,-0.386705,-0.243115,-0.402225,-0.10867,-0.155211,-0.09866,0.315576
openstack/octavia,Ib2a1c3f49a26690d2e0e9c7330e047748c0b5105,0,0,0.5089,6.1203,0.0485,17,11.0,297,0,Feature,0,0,0,112,0.004239,1.0,0,0.5089,7,4,0,0.6053,2.9555,4.12,68.77,8.95,1,0,0.5925,1,0.6527,1,0,0,0,0,"Add nftables support for SR-IOV VIPs

This patch adds the initial nftables support in the amphora for SR-IOV
VIPs. Followup patches will add rules to the nftables chain. As this
point in the patch chain, SR-IOV VIPs will not pass any traffic.
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/plug.py (+3, -2)
octavia/amphorae/backends/agent/api_server/server.py (+2, -1)
octavia/tests/unit/amphorae/backends/utils/test_interface.py (+142, -0)
diskimage-create/diskimage-create.sh (+1, -1)
doc/source/admin/sr-iov.rst (+15, -0)
octavia/tests/unit/amphorae/backends/agent/api_server/test_osutils.py (+4, -2)
octavia/amphorae/backends/utils/interface_file.py (+9, -6)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+7, -3)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+5, -3)
diskimage-create/README.rst (+5, -0)
octavia/common/constants.py (+10, -0)
octavia/amphorae/backends/utils/interface.py (+48, -0)
octavia/tests/unit/amphorae/backends/utils/test_nftable_utils.py (+106, -0)
octavia/amphorae/backends/utils/nftable_utils.py (+63, -0)
releasenotes/notes/Use-nftables-is-now-True-e1da3f92a4907b8c.yaml (+4, -0)
octavia/amphorae/backends/agent/api_server/osutils.py (+3, -2)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+5, -2)
",-0.774185,0.032646,-0.337799,1.607619,0.69353,-0.001945,0.148713,0.399078,0.104447,0.12092,0.028584,0.458644,0.511458,-0.34998,0.122978
openstack/kayobe,I4f79b1b0887df72b11b768593ba45d89e75ce0d6,1,1,0.8182,2.3026,0.0,2,13.0,204,0,Bug Fix,0,0,0,11,0.045267,1.0,0,0.8182,4,2,0,0.9479,0.9911,3.0,43.96,17.51,0,0,0.0,1,20.4,0,6,0,7,0,"Build letsencrypt images

These are currently not included in the regex we generate so aren't
built as part of the complete set.

Closes-Bug: #2052428
[SEP]
FILES CHANGED:
releasenotes/notes/build-letsencrypt-images-448f235a27b0f2e4.yaml (+5, -0)
ansible/inventory/group_vars/all/kolla (+4, -0)
",1.156786,-1.385463,-0.393652,-0.279714,-0.737205,0.453744,-0.387728,-0.659046,-0.217971,-0.031174,-0.065559,-0.008862,0.021058,-0.028933,0.071165
openstack/kayobe,I5644ab2595a30cfff82f03d5ca4aa501a8b36ef8,1,1,0.9,2.3026,0.0,1,5.17,328,0,Bug Fix,0,0,0,10,0.05102,1.0,0,0.9,4,1,0,0.9485,0.0,4.0,-19.46,16.26,1,0,0.0,0,32.8,0,6,0,26,0,"Reload NetworkManager on DNS config change

Initial fix [1] was not reloading NetworkManager config, which caused
MichaelRigart.interfaces role to clean up resolv.conf after interface
bounce.

[1] https://review.opendev.org/c/openstack/kayobe/+/902561
Related-Bug: #2044537
[SEP]
FILES CHANGED:
ansible/roles/network-redhat/tasks/main.yml (+9, -0)
",-0.077385,0.867366,-0.654185,-0.186154,-1.062651,-0.01442,0.369074,0.4486,0.12441,-0.151116,0.138582,-0.765545,-0.03431,0.029847,-0.079034
openstack/kolla,I9c723b666897883bf5b3343fe92e06aaa0c89d81,0,0,0.8194,3.4657,0.8065,3,1.75,171,0,Feature,0,0,0,72,0.043062,1.0,0,0.8194,5,3,0,0.8031,1.1569,3.67,-230.03,34.99,0,0,0.0,1,5.3438,0,0,0,0,0,"openvswitch: Drop ovs_ensure_configured.sh

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/901695
[SEP]
FILES CHANGED:
docker/openvswitch/openvswitch-db-server/releasenotes/notes/drop-ovs-ensure-configured-7973d36969e157fa.yaml (+5, -0)
docker/openvswitch/openvswitch-db-server/Dockerfile.j2 (+1, -3)
docker/openvswitch/openvswitch-db-server/ovs_ensure_configured.sh (+0, -22)
",-0.396971,3.300698,-1.920671,-0.157109,-1.025882,0.025256,-0.357196,-0.374609,0.109839,-0.908554,-0.487171,-0.134339,-0.401356,-0.23745,0.128198
openstack/openstack-ansible-os_nova,I12b38e45d7b41fbf4786d3320e511eb9127fe216,1,0,1.0,2.8904,0.3529,2,11.0,345,0,Bug Fix,0,0,0,32,0.074592,1.0,0,1.0,1,2,0,1.0,0.9975,1.0,34.16,11.67,0,0,0.0,0,19.1667,0,0,0,0,0,"Fix nova device_spec to support multiple values

It appears there was a change to remove the list option when
moving from pci_passthrough_whitelist. Instead device_spec
can be specified multiple times in the file.

This patch aims to resolve this whilst maintaining backwards
compatibility.
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+7, -1)
defaults/main.yml (+4, -5)
",-0.086251,-1.49978,-0.362504,0.440229,-0.384789,0.169891,-0.480502,-0.462083,0.113585,0.178782,-0.045577,-0.313845,-0.423297,-0.262848,0.316377
openstack/kolla-ansible,I2fd14de7268171efb336abf808647c9e81b8f101,0,0,0.9091,0.6931,1.0,1,6.0,160,0,Feature,0,0,0,11,0.053659,1.0,0,0.9091,4,1,0,0.7849,0.0,4.0,-38.95,25.73,0,0,0.0,0,80.0,0,0,0,0,0,"Keystone: Remove duplicate CLI --os-system-scope line
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/register_identity_providers.yml (+0, -1)
",2.224302,0.248713,0.893553,0.076247,0.43572,-0.194412,-0.808217,0.202216,0.253059,-0.339401,0.028699,-0.010121,0.471598,0.323041,0.263224
openstack/kolla-ansible,If8d7cf1663145d0398a2e936486e2b316d4df5e0,1,1,0.8333,2.7081,0.0,2,5.86,1003,0,Bug Fix,0,0,0,12,0.058252,0.8,0,0.6667,4,2,0,0.7826,0.5917,3.0,-53.94,14.05,1,0,0.0,1,66.8667,0,8,0,15,0,"Ironic: enable elevated access for project scoped service role

Ironic recently started to enforce new policies and scope [1].
And Ironic is one of the sole openstack project which need
system scope for some admin related api calls [2].
However Ironic also started to allow project-scope behaviour
for service role with setting
``rbac_service_role_elevated_access``[3] [4]. This change enables
this setting to get similar behaviour of service role as other
openstack projects.

[1] https://review.opendev.org/c/openstack/ironic/+/902009
[2] https://opendev.org/openstack/governance/src/commit/e2a47de10a689a78c31765fd1b020f17c0d3109c/goals/selected/consistent-and-secure-rbac.rst?display=source#L261
[3] https://review.opendev.org/c/openstack/ironic/+/907148
[4] https://opendev.org/openstack/ironic/src/commit/8ec56066223301230ac0ed0f0c471a10d366b474/releasenotes/notes/service-project-service-role-fix-e4d1a8c23856926a.yaml

Related-Bug: #2051837
[SEP]
FILES CHANGED:
releasenotes/notes/ironic-rbac-elevated-6804dab4061ab236.yaml (+12, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+2, -0)
",-4.10734,3.736718,2.465633,-1.178646,0.167973,0.418601,0.313655,-0.223016,0.156274,-0.580028,-0.579959,0.433263,-0.074243,-0.277772,-0.05186
openstack/charm-ceph-iscsi,Ia535b0500d39409f939f0aa58271866efbcd55fb,0,0,0,3.6636,0.0,8,14.75,401,0,CI,1,0,0,0,0.0,1.0,0,0.0,2,1,0,1.0,2.799,2.0,52.78,10.65,1,0,1.0,1,10.2821,0,0,0,0,0,"Update bundles to specify source config option

The ceph-mon and ceph-osd charms changed the default source config
option to be bobcat in the master branches. This breaks focal tests
as the focal-bobcat cloud archive is not a valid source repository.
Update the config options for the test bundles to be explicit in the
source of package updates.
[SEP]
FILES CHANGED:
tests/bundles/jammy-reef-ec.yaml (+1, -0)
tests/bundles/jammy-ec.yaml (+6, -0)
tests/bundles/lunar-ec.yaml (+6, -0)
tests/bundles/focal-ec.yaml (+6, -0)
tests/bundles/focal.yaml (+6, -0)
tests/bundles/jammy.yaml (+6, -0)
tests/bundles/lunar.yaml (+6, -0)
tests/bundles/jammy-reef.yaml (+1, -0)
",0.053478,-1.538153,-0.411326,0.899803,0.287792,-0.936164,0.690823,0.543012,-0.001835,-0.207349,-0.253834,0.221483,-0.044801,0.063912,-0.039039
openstack/kolla,I736fcfd766a378783dbfe06ab8ac58858e84aba7,1,0,0.8082,2.1972,0.5,2,10.0,99,0,Doc,0,0,0,73,0.042866,1.0,0,0.8082,2,2,0,0.799,0.8113,2.0,10.56,12.0,0,0,0.0,0,11.0,0,0,0,0,0,"ceph: Update EL9 version to Reef, adapt docs
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
doc/source/ceph_versions.csv (+3, -3)
",2.300876,0.981151,0.939593,-0.047048,0.770114,0.437137,-0.081496,0.364827,-0.47747,0.238696,0.104804,-0.055623,0.14841,-0.400199,-0.394374
openstack/kolla-ansible,If89e94356de515b40ca4e8c023979cd498146303,1,1,0.8182,3.5264,0.0606,4,13.33,322,0,Bug Fix,0,0,0,22,0.012865,0.6,0,0.4909,4,3,0,0.7832,1.616,2.0,21.99,18.33,1,0,0.0,1,9.4706,0,6,0,9,0,"Do not remove inventory file if placed in /etc/kolla

This patch fix issue when inventory file is deleted
by kolla-ansible -i /etc/kolla/inventory destroy call.

Now, inventories are available in tools/cleanup-host
so we can ignore their removal.

Closes-Bug: #2052706
[SEP]
FILES CHANGED:
ansible/roles/destroy/tasks/cleanup_host.yml (+1, -0)
releasenotes/notes/bug-2052706-dfbbc75fc72c74d1.yaml (+7, -0)
tools/cleanup-host (+15, -2)
tools/kolla-ansible (+8, -0)
",-0.039065,-0.929879,-0.545866,-0.161136,-0.5917,-0.536948,-0.170163,-0.119752,-0.363452,-0.387614,-0.203019,-0.619882,0.284283,0.617319,0.108922
openstack/ironic,If4c43e353eb4bba7ae62def84d74877039b170b0,1,0,1.0,3.2581,0.04,2,7.0,214,0,Bug Fix,0,0,0,2,0.007968,0.0,0,0.0,4,1,0,0.951,0.4022,3.0,48.66,8.51,0,0,0.08,0,8.2308,0,0,0,0,0,"Fix release mappings for 2023.2

We added servicing and did not update release mappings, nor did we
update release mappings for final Ironic release of 2023.2.
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_release_mappings.py (+1, -1)
ironic/common/release_mappings.py (+23, -0)
",0.931196,-0.015565,0.00232,0.69995,0.578741,0.513065,0.114451,-0.056594,-0.482907,0.833206,-0.400533,0.032517,-0.151334,0.087579,0.460868
openstack/openstack-ansible,I38b2ff6887382164e4b28852274ec6dfee4d7d78,1,1,0.9489,1.0986,0.5,1,18.5,285,0,Bug Fix,0,0,0,137,0.045007,1.0,0,0.9489,3,1,0,0.9211,0.0,3.0,37.15,19.29,0,0,0.0,0,95.0,1,6,0,7,0,"Fix formatting issue for SPICE HAProxy httpcheck

Due to the issue in formatting healthcheck address was merged with meth
which resulted in invalid haproxy configuration, when SPICE is being used
as a console.

Closes-Bug: #2052891
[SEP]
FILES CHANGED:
inventory/group_vars/nova_all/haproxy_service.yml (+1, -1)
",1.124237,-1.634814,0.050002,-0.106667,-0.473207,0.31202,-0.058242,0.275658,0.280813,-0.241656,0.018215,-0.103445,0.141853,-0.337973,0.325013
openstack/openstack-ansible-os_nova,I454b53713ecacf844ac14f77b6d1e1adc1322c0e,1,1,0.9493,3.1781,0.4783,3,19.67,420,0,Bug Fix,0,0,0,138,0.045305,1.0,0,0.9493,1,2,0,1.0,1.3378,1.0,37.75,14.65,0,0,0.0,0,17.5,1,0,0,0,0,"Evaluate my_ip address once

Instead of evaluating same condition of my_ip in multiple places across
the role this patch suggests doing this once in vars and using the
resulting variable afterwards.

This not only reduce amount of evaluations made throughout the role runtime,
but also solves possible corner cases where some syntax may go off.

Closes-Bug: #2052884
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+5, -5)
defaults/main.yml (+5, -6)
vars/main.yml (+2, -0)
",-0.608887,-2.273001,0.133059,0.274374,-0.174583,0.070077,-0.043788,-0.446916,0.081649,0.237018,-0.170733,-0.247859,0.171307,-0.067227,0.096159
openstack/openstack-ansible,Ic708385ce2a75e42e9a70fa53dbd6030ba318a7c,1,0,1.0,4.585,0.1134,2,6.0,112,0,Doc,0,0,0,33,0.073991,0.0,0,0.0,4,2,0,0.9221,0.9938,3.0,10.4,12.4,0,1,0.0,0,1.1429,0,0,0,0,0,"[doc] Update dist upgrade guide for 2023.1 / Ubuntu Jammy
[SEP]
FILES CHANGED:
scripts/upgrade-utilities/nova-restore-compute-id.yml (+44, -0)
doc/source/admin/upgrades/distribution-upgrades.rst (+42, -11)
",2.442461,0.436113,0.506143,-0.777804,-0.263354,0.191998,0.184961,1.357761,-0.754438,0.766977,-0.116844,0.044561,-0.055244,-0.261662,-0.688245
openstack/openstack-ansible,I608202d665417682ce7309bb9bf4b52a2cf4373e,1,0,1.0,2.5649,1.0,1,15.75,430,0,Doc,0,0,0,34,0.062615,1.0,1,1.0,4,1,0,0.9231,0.0,4.0,52.53,13.28,0,1,0.0,0,33.0769,0,0,0,0,0,"[doc] Remove guidance to drain RMQ which can result in failures

oslo_messaging isn't set up to handle this situation and appears
to expect the node to come back (as would happen during a version
upgrade). As a result, client processes don't attempt to re-create
queues which lived on the node being upgraded. This situation
doesn't auto-recover which can be very disruptive.
[SEP]
FILES CHANGED:
doc/source/admin/upgrades/distribution-upgrades.rst (+0, -12)
",-0.141132,-1.747225,0.252674,0.457837,-0.559084,-0.135982,0.533266,-0.72207,-0.275027,0.334866,0.086013,0.132872,0.189915,-0.344866,0.036085
openstack/openstack-ansible-ceph_client,If9c46d22f42bc3765b217b0fbc736331bf337557,1,0,1.0,0.6931,0.0,1,22.33,445,0,Feature,0,0,0,35,0.063063,0.0,0,0.0,1,1,0,0.9091,0.0,1.0,46.53,14.31,0,0,0.0,0,222.5,0,0,0,0,0,"Don't load systemd parent service for object cache

We use the systemd_service role to load a drop-in for all
services which fall under the 'ceph-immutable-object-store'
banner, but this isn't a service in its own right.

Attempting to load the service on Ubuntu Jammy results in
an error, so we prevent loading it, and leave enabling of the
individual service up to an existing later task.
[SEP]
FILES CHANGED:
tasks/ceph_immutable_object_cache.yml (+1, -0)
",0.082716,-1.500706,0.19953,0.350717,-0.509292,-0.60714,0.797592,-0.386721,-0.184856,-0.200568,0.006655,0.14692,0.350909,0.058814,0.259788
openstack/charm-glance,I383a0794e924db3c7f4ce47d1e3b88355c2475e4,1,1,1.0,1.0986,0.5,1,17.0,281,0,Bug Fix,0,0,0,3,0.272727,0.0,0,0.0,1,1,0,1.0,0.0,1.0,17.89,17.39,1,0,0.0,0,93.6667,0,12,0,34,0,"Fix check for internal endpoint enablement

For cinder volume backend sections, ensure that enabling internal
endpoint usage for service access does not completely clear the
existing content of the section.

Closes-Bug: 2052726
[SEP]
FILES CHANGED:
hooks/glance_contexts.py (+1, -1)
",0.599094,-1.618486,-0.332612,0.258867,-0.05707,0.006581,-0.737301,0.119007,0.622347,-0.165165,-0.471446,0.151248,0.507986,-0.278797,0.204168
openstack/ironic,Ic6584479a47146577052d17fa3f697eef64ac73c,1,1,0.9722,4.5433,0.0215,5,16.5,254,0,Bug Fix,0,0,0,36,0.012757,1.0,0,0.9722,5,2,0,0.9515,2.2645,3.6,28.58,16.3,0,0,0.4946,1,2.7021,0,0,0,0,0,"Special case lenovo UEFI boot setup

Special cases boot/uefi record setup to focus on UEFI
nvram updates instead of attempting nvram updates *and*
setting the boot device to disk.

Closes-Bug: 2053064
[SEP]
FILES CHANGED:
ironic/drivers/modules/pxe_base.py (+13, -0)
ironic/drivers/modules/agent_base.py (+19, -2)
ironic/tests/unit/drivers/modules/test_agent_base.py (+27, -0)
ironic/tests/unit/drivers/modules/test_pxe.py (+19, -0)
releasenotes/notes/limit-boot-to-disk-calls-lenovo-39763bfc98f602d8.yaml (+13, -0)
",1.018705,-1.27352,-0.220246,-0.111694,0.114584,0.01588,-0.160215,0.463095,-0.080948,-0.59143,-0.26972,-0.249048,0.234792,-0.175734,0.17612
openstack/ansible-hardening,I957dc9b98f1de23ea66ea0e225989e4f907a02cb,1,1,0.9496,1.0986,0.5,1,11.67,274,0,Bug Fix,0,0,0,139,0.045292,0.95,0,0.9022,1,1,0,1.0,0.0,1.0,28.21,14.95,0,0,0.0,0,91.3333,0,0,0,0,0,"Use valid value for CREATE_HOME

At the moment we pass boolean value to CREATE_HOME instead of yes/no.
Leveraging ternary allows to always supply expected values despite of
variable type in ansible.

Closes-Bug: #1850200
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",-0.112251,-1.570565,-0.553109,0.158586,-0.063865,0.236688,-0.672406,-0.259345,0.071556,0.268396,-0.002449,-0.206038,-0.01018,-0.56387,-0.035042
openstack/openstack-ansible-plugins,I7127cb86e81abc982290681d24b8a6554a46f58b,1,0,1.0,4.0254,0.2545,3,13.25,684,0,Bug Fix,0,0,0,36,0.064748,1.0,0,1.0,3,1,0,1.0,0.4487,3.0,56.11,11.34,0,0,0.0,0,12.2143,0,0,0,0,0,"Add override for gluster host used for bootstrap operations

This change permits overriding of the host used to bootstrap the
cluster. This is necessary when the cluster already exists and
a new (or upgraded) host needs to join an existing cluster. This
only works when actions are performed from an existing cluster
member.

This patch additionally resolves an issue where the volume
creation step can fail if the bootstrap host's peer names don't
exactly match those being passed to it (such as when they end with
.openstack.local). A restart of the service fixes this by reading
the correct hostnames back from the peer files.
[SEP]
FILES CHANGED:
roles/glusterfs/tasks/main.yml (+38, -13)
roles/glusterfs/defaults/main.yml (+2, -0)
roles/glusterfs/vars/main.yml (+1, -1)
",-1.501835,-1.748395,0.947463,0.689056,0.106502,-0.0934,0.291618,-0.111975,0.417337,0.150271,-0.07074,0.299294,0.026212,0.14491,-0.097548
openstack/openstack-ansible-openstack_hosts,I48274de908fc6dc4a2e22a789e8355c7ba263599,1,0,0.95,1.9459,0.5,1,18.8,670,0,CI,0,0,0,140,0.045588,1.0,0,0.95,1,1,0,0.8333,0.0,1.0,28.45,16.03,0,0,0.0,0,95.7143,0,0,0,0,0,"Resolve custom hosts records on hosts

In order to save quite some time during the role execution, we apply
run_once when defining /etc/hosts content.

While this good for ""static"" content which is based on the inventory,
resolving openstack_host_custom_hosts_records once may lead to
unexpected behaviour. For instance, if host record depends on some specific
group or other variables defined in host/group variables.

In order to resolve it accordingly, we merge status and custom records together
in blockinfile, which allows to resolve record individually for each host
and not having penalty for most usecases.
[SEP]
FILES CHANGED:
tasks/openstack_update_hosts_file.yml (+3, -3)
",-0.944048,-2.103425,1.111185,0.295519,0.03658,-0.413256,0.108782,-0.222893,0.079939,-0.183957,-0.517182,-0.483748,-0.01043,-0.259368,-0.058909
openstack/kolla-ansible,Ib6c725880caaa7f39bb269bd8398f3894eb033c5,1,1,0.0,1.6094,0.0,1,10.0,117,0,Bug Fix,0,0,0,1,0.023256,0.0,0,0.0,4,1,0,0.7839,0.0,4.0,2.11,20.0,1,0,0.0,0,23.4,1,16,0,43,0,"Fix Skyline API Server TLS configuration

Closes-Bug: #1998417
[SEP]
FILES CHANGED:
ansible/roles/skyline/templates/gunicorn.py.j2 (+4, -0)
",2.232508,-0.676769,-0.187498,-1.358704,-1.0064,0.767889,-1.022562,1.412799,0.305576,-0.340514,0.66325,-0.082113,0.088104,-0.132324,0.03645
openstack/kolla-ansible,I8609cf211316d8224c925d57a5e832ccff37b906,0,0,0.8108,2.0794,0.0,1,9.0,91,0,Doc,0,0,0,74,0.04325,1.0,1,0.8108,3,1,0,0.7845,0.0,3.0,47.3,16.93,0,0,0.0,0,11.375,0,0,0,0,0,"doc: Add a note about SLURP upgrades
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+7, -0)
",2.844946,0.595563,1.541358,0.27222,-0.303508,0.80125,0.827868,0.56975,0.559863,0.487784,0.057299,0.252018,-0.182032,-0.324658,-0.115181
openstack/kayobe,I2c6befbdda7e684228065103feea7250a0ea3826,1,0,0.8333,7.0067,0.2539,76,6.5,205,0,Feature,0,0,0,12,0.047619,1.0,0,0.8333,4,7,0,0.949,5.532,2.66,34.29,11.83,1,0,0.0481,1,0.1857,0,0,0,0,0,"Add podman support

Adds support for Podman as an alternative container engine. This builds
on the support added in kolla-ansible in the 2023.2 cycle.
[SEP]
FILES CHANGED:
etc/kayobe/container-engine.yml (+80, -0)
ansible/roles/docker-registry/defaults/main.yml (+2, -4)
ansible/overcloud-host-configure.yml (+1, -1)
ansible/inventory/group_vars/all/container-engine (+76, -0)
ansible/roles/swift-rings/tasks/main.yml (+2, -1)
ansible/overcloud-inventory-discover.yml (+2, -1)
roles/kayobe-diagnostics/files/get_logs.sh (+39, -21)
ansible/roles/docker-registry/tasks/pull.yml (+2, -2)
ansible/roles/inspection-store/handlers/main.yml (+4, -2)
doc/source/configuration/reference/hosts.rst (+39, -3)
ansible/kolla-bifrost-hostvars.yml (+2, -1)
ansible/roles/kolla-build/tasks/main.yml (+3, -2)
doc/source/configuration/reference/docker-registry.rst (+4, -4)
ansible/inventory/group_vars/all/kolla (+8, -1)
ansible/roles/docker-registry/tasks/deploy.yml (+2, -1)
doc/source/administration/seed.rst (+20, -3)
ansible/action_plugins/kayobe_container_login.py (+24, -0)
ansible/roles/inspection-store/tasks/stop.yml (+2, -1)
ansible/infra-vm-host-configure.yml (+1, -1)
ansible/inventory/group_vars/all/infra-vms (+24, -3)
ansible/kolla-ansible-user.yml (+8, -2)
doc/source/configuration/reference/bifrost.rst (+5, -0)
ansible/roles/opensm/tasks/stop.yml (+2, -1)
ansible/seed-credentials.yml (+4, -2)
ansible/inventory/group_vars/all/controllers (+24, -3)
ansible/container-engine.yml (+37, -0)
doc/source/deployment.rst (+26, -5)
ansible/docker.yml (+0, -19)
ansible/roles/inspection-store/defaults/main.yml (+2, -3)
dev/ovs-vsctl (+6, -1)
ansible/roles/inspection-store/tasks/pull.yml (+2, -2)
ansible/roles/docker-registry/tasks/stop.yml (+2, -1)
doc/source/configuration/reference/kolla.rst (+2, -1)
ansible/roles/docker-registry/tasks/destroy.yml (+6, -18)
etc/kayobe/docker.yml (+0, -43)
ansible/inventory/group_vars/all/seed (+24, -3)
ansible/seed-host-configure.yml (+1, -1)
releasenotes/notes/adds-support-for-podman-8ff158369905c077.yaml (+20, -0)
ansible/roles/inspection-store/tasks/destroy.yml (+7, -14)
ansible/kayobe-ansible-user.yml (+2, -2)
ansible/overcloud-introspection-data-save.yml (+2, -1)
zuul.d/jobs.yaml (+43, -0)
ansible/overcloud-bios-raid.yml (+4, -2)
ansible/overcloud-provision.yml (+10, -5)
ansible/action_plugins/kayobe_container.py (+25, -0)
ansible/roles/kolla/tasks/install.yml (+3, -0)
ansible/inventory/group_vars/all/docker (+0, -39)
ansible/action_plugins/kayobe_container_volume.py (+17, -0)
ansible/container-image-build.yml (+5, -2)
ansible/inventory/group_vars/all/compute (+28, -4)
ansible/roles/inspection-store/tasks/start.yml (+2, -1)
etc/kayobe/compute.yml (+18, -1)
ansible/overcloud-hardware-inspect.yml (+8, -4)
ansible/roles/opensm/defaults/main.yml (+1, -1)
roles/kayobe-diagnostics/tasks/pre.yml (+1, -0)
ansible/roles/manage-containers/tasks/deploy-container.yml (+4, -3)
ansible/overcloud-host-image-build.yml (+1, -1)
ansible/inventory/group_vars/all/overcloud-dib (+2, -1)
ansible/kolla-target-venv.yml (+10, -0)
playbooks/kayobe-overcloud-base/overrides.yml.j2 (+3, -0)
ansible/kayobe-target-venv.yml (+13, -1)
ansible/seed-service-upgrade-prep.yml (+3, -2)
ansible/roles/manage-containers/tasks/destroy-container.yml (+1, -1)
ansible/action_plugins/kayobe_container_image.py (+28, -0)
ansible/roles/opensm/tasks/pull.yml (+2, -2)
playbooks/kayobe-seed-base/overrides.yml.j2 (+3, -0)
ansible/overcloud-etc-hosts-fixup.yml (+8, -4)
ansible/roles/dell-switch-bmp/handlers/main.yml (+6, -3)
ansible/overcloud-deprovision.yml (+10, -5)
zuul.d/project.yaml (+10, -0)
ansible/roles/docker-registry/handlers/main.yml (+2, -1)
ansible/action_plugins/kayobe_container_image_info.py (+17, -0)
ansible/roles/opensm/tasks/destroy.yml (+7, -16)
ansible/roles/manage-containers/tasks/deploy.yml (+5, -5)
ansible/roles/opensm/tasks/deploy.yml (+2, -1)
ansible/seed-ipa-build.yml (+2, -1)
",1.064127,-0.261692,-0.508246,0.39264,-0.673163,0.063283,0.414449,0.564617,-0.135325,0.16186,-0.211644,0.847389,-0.426667,-0.174058,0.226305
openstack/python-octaviaclient,I9977a08131fc5bd1c0478b1e7708bfe39159a649,0,0,0.5044,2.7726,0.0,4,13.67,301,0,Feature,0,0,0,113,0.004204,0.1538,0,0.0776,3,2,0,0.18,1.5329,2.75,50.59,13.27,0,0,0.0,1,18.8125,0,0,0,0,0,"Added the vip_vnic_type load balancer field

This patch adds the vip_vnic_type load balancer field to load balancer
output. If the API version being called does not support this field, it
defaults to 'normal' which was the only option previously.
[SEP]
FILES CHANGED:
releasenotes/notes/Add-vip_vnic_type-load-balancer-field-f1bc1345ee741f88.yaml (+5, -0)
octaviaclient/osc/v2/load_balancer.py (+8, -0)
octaviaclient/osc/v2/constants.py (+1, -0)
octaviaclient/osc/v2/utils.py (+1, -0)
",-0.581968,0.124311,-0.885097,1.826702,0.934904,0.014799,0.520002,0.055052,0.699619,0.005152,0.352046,0.200604,-0.590656,-0.255444,0.065515
openstack/ironic,I2c151afafb86191f047985ac00075a791639646d,1,1,0,2.1972,0.375,1,17.67,411,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,0.9519,0.0,2.0,37.26,15.37,1,0,0.0,0,45.6667,0,6,0,5,0,"Fix multiple assignment of redfish_system_id during node creation

``redfish_system_id`` is being passed multiple times to the node at
creation as ``node_options`` never defaults back to it's initial state
throughout the iteration of the while loop.

Though it is surprisingly functional, it's fragile and this change aims
to fix that.

Closes-Bug: #2054597
[SEP]
FILES CHANGED:
devstack/lib/ironic (+5, -3)
",-0.757289,-1.323291,-0.204494,0.470022,-0.152135,0.631032,-0.267565,-0.432939,0.303111,0.059591,0.193837,-0.391674,-0.271496,0.076654,0.424321
openstack/kolla,I7df7d452c45c57c434d5b4ad15a87963e4d6d0d4,0,0,0.8,6.7662,0.3772,18,6.25,364,0,Doc,0,0,0,75,0.043655,1.0,0,0.8,2,5,0,0.8,2.5513,1.89,39.75,13.7,1,0,0.2353,1,0.4194,0,0,0,0,0,"Add support for rpm to repos.yaml

Add the ability to configure repositories in the same
way as we do Debuntu ones - via repos.yaml.

Removes .repo files from base - since these are not
needed there anymore.

gpgcheck = 1 is default in docker/base/dnf.conf
[SEP]
FILES CHANGED:
kolla/template/methods.py (+97, -37)
docker/base/mariadb.repo (+0, -7)
docker/base/docker-ce.repo (+0, -6)
kolla/template/repos.yaml (+300, -72)
tests/templates/template_overrides.j2 (+1, -12)
docker/base/td.repo (+0, -7)
.ansible-lint (+1, -0)
kolla/tests/test_methods.py (+135, -56)
docker/base/proxysql.repo (+0, -7)
docker/base/kolla_el10.repo (+0, -10)
docker/base/Dockerfile.j2 (+1, -51)
docker/base/grafana.repo (+0, -8)
releasenotes/notes/repos-yaml-rpm-support-01ff7f5fc3b9ecf2.yaml (+5, -0)
docker/base/influxdb.repo (+0, -6)
docker/base/rabbitmq_rabbitmq-server.repo (+0, -9)
docker/base/rabbitmq_rabbitmq-erlang.repo (+0, -9)
docker/base/copr-rabbitmq-erlang.repo (+0, -11)
docker/base/opensearch.repo (+0, -19)
",0.296783,-0.909002,0.047218,0.351857,-0.355279,-0.72989,0.418614,0.100226,-0.681122,-0.014329,-0.236503,-0.704075,-0.220281,0.629709,-0.211363
openstack/kolla-ansible,Ib2936580db5e7ab3479722bc353c39063010b5f2,0,0,0.8462,2.9957,0.0,3,4.25,215,0,Feature,0,0,0,13,0.009594,0.0,0,0.0,4,3,0,0.7822,1.4618,3.33,-36.35,18.17,0,0,0.0,1,10.75,0,0,0,0,0,"Adds feature flag for ironic-inspector in bifrost

This is useful for backwards compatability.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/909865
[SEP]
FILES CHANGED:
ansible/roles/bifrost/templates/bifrost.yml.j2 (+3, -0)
releasenotes/notes/expose-flag-to-enable-ironic-inspector-in-bifrost.yml-12215fb9b1f09528.yaml (+9, -0)
ansible/roles/bifrost/defaults/main.yml (+7, -0)
",0.215384,1.810454,-1.303094,-0.249584,-1.427181,0.060211,0.244555,-0.171793,0.117563,-0.582189,-0.593247,-0.123385,0.067854,-0.5983,0.08479
openstack/kolla-ansible,I154cbb096469c5515c9d8156c2c1c5dd07b95849,0,0,0,5.2311,0.0538,19,7.6,337,0,Feature,0,0,0,0,0.0,1.0,0,0.0,5,5,0,0.78,3.5666,2.95,27.69,12.51,1,0,0.3763,1,1.8021,0,0,0,0,0,"Add backend TLS between MariaDB and ProxySQL

This commit adds TLS connection between ProxySQL and MariaDB.
Frontend TLS ( between services and ProxySQL) will be
added in another commit.

Parialy Implements: mariadb-ssl-support
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/copy-certs.yml (+10, -0)
ansible/roles/certificates/tasks/generate-backend.yml (+14, -0)
tests/run.yml (+10, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.json.j2 (+19, -0)
ansible/roles/mariadb/templates/mariadb.json.j2 (+19, -0)
zuul.d/base.yaml (+2, -0)
ansible/roles/mariadb/tasks/check-containers.yml (+1, -1)
ansible/roles/mariadb/handlers/main.yml (+3, -3)
ansible/roles/mariadb/templates/galera.cnf.j2 (+5, -1)
ansible/roles/loadbalancer/tasks/config.yml (+0, -2)
ansible/roles/mariadb/tasks/copy-certs.yml (+7, -0)
ansible/group_vars/all.yml (+1, -0)
releasenotes/notes/mariadb-proxysql-ssl-support-dd0b264212655424.yaml (+6, -0)
requirements-core.yml (+3, -0)
tests/test-proxysql.sh (+53, -0)
ansible/roles/mariadb/tasks/config.yml (+4, -2)
etc/kolla/globals.yml (+1, -1)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+13, -0)
tests/j2lint.py (+5, -0)
",-0.009127,-0.260846,-0.675386,0.574193,0.128996,-0.010847,-0.40069,0.760341,-0.085337,-0.034986,-0.144301,0.485478,0.116868,-0.098197,-0.563927
openstack/ironic,I33e76929ca9bf7869b3b4ef4d6501e692cf0a922,1,1,0.973,3.6889,0.6154,3,19.17,737,0,Bug Fix,0,0,0,37,0.012693,0.0,0,0.0,6,2,0,0.9524,1.5262,4.0,43.93,13.23,0,0,0.3077,1,18.425,0,6,0,10,0,"neutron: do not error if no cleaning/provisioning on launch

In the early days of the neutron network interface, we had a hard
launch failure added to prevent ironic.conf from having a neutron
network configuration which was not valid when the neutron network
interface was in use.

But as time has moved on, these settings became node-settable,
and ironic configuration largely became mutable as well, so they
can always be added after the process has been launched.

But we kept the error being returned. Which doesn't make sense
now that it can always be back-filled into a working state
or just entirely be ""user supplied"" via the API by an appropriate
user.

Closes-Bug: 2054728
[SEP]
FILES CHANGED:
ironic/drivers/modules/network/neutron.py (+2, -16)
ironic/tests/unit/drivers/modules/network/test_neutron.py (+4, -8)
releasenotes/notes/permit-conductor-to-start-without-neutron-networks-d4aa21654f9c07bf.yaml (+9, -0)
",-1.141596,-2.346201,1.566431,-0.451717,-0.891239,-0.054482,0.338756,-0.288431,-0.173535,0.113583,0.176088,0.210372,-0.160747,0.166674,0.235982
openstack/kolla-ansible,I38446674b014f93acacd675ef9071e020e1dae80,0,0,1.0,4.2905,0.4444,3,9.0,95,0,CI,1,0,0,7,0.021605,0.8,0,0.8,1,3,0,0.7778,0.6839,1.0,9.7,12.49,1,0,1.0,1,1.3014,0,0,0,0,0,"CI: Only migrate RMQ queues during SLURP
[SEP]
FILES CHANGED:
tests/run.yml (+1, -0)
zuul.d/jobs.yaml (+5, -5)
tests/upgrade.sh (+34, -27)
",2.783244,0.977354,1.285013,0.16436,0.858567,0.537759,-0.342697,0.702337,-0.480787,0.05738,0.281425,-0.136553,0.254915,-0.709991,-0.059071
openstack/kolla-ansible,I33a3ec11b0cdef94b08cd7551008284755824cb7,0,0,0.7895,4.2485,0.0,6,9.0,103,0,Doc,0,0,0,76,0.0294,0.8,0,0.6316,4,4,0,0.7756,2.1507,3.33,19.1,16.93,0,0,0.0145,1,1.4714,0,0,0,0,0,"cinder: Add prechecks and docs for HA/clustering
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+6, -0)
releasenotes/notes/cinder-ha-precheck-ca93901f1362ac0d.yaml (+16, -0)
doc/source/reference/storage/cinder-guide.rst (+17, -0)
ansible/roles/cinder/tasks/precheck.yml (+25, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+4, -0)
tests/templates/globals-default.j2 (+1, -0)
",2.352752,0.524654,1.090227,0.088574,0.809644,-0.112058,-0.268471,0.211526,0.006641,-0.080864,-0.741399,-0.291139,0.25995,-0.824143,0.153827
openstack/kolla-ansible,I848bd2838a17756f1c71b07befe1e3d966f5b6c2,1,1,0.7857,2.7081,0.1429,2,17.67,377,0,Bug Fix,0,0,0,14,0.010189,0.0,0,0.0,2,2,0,0.7734,0.9852,2.0,37.26,16.88,0,0,0.0,1,25.1333,0,6,0,12,0,"Support mode in named volumes when using podman

Volumes with a mode specifier were causing the container to fail to
start with the error: ""Wrong format of volume"". ironic-dnsmasq was one
services affected by this issue, but you could also hit this issue when
using the volume customisation variables.

Closes-Bug: #2054834
[SEP]
FILES CHANGED:
releasenotes/notes/fixes-podman-named-volume-issues-when-using-mode-36b9862321eb9e68.yaml (+6, -0)
ansible/module_utils/kolla_podman_worker.py (+6, -2)
",0.513157,-2.384064,-0.032786,0.082103,-0.913207,-0.295141,0.110415,0.13657,0.384855,-0.078679,0.054693,-0.047081,0.338876,0.074532,0.241121
openstack/octavia,I554aac422371abafb4bb04e2d0df3fce3fa169d4,0,0,0.5,7.1172,0.0901,32,10.0,169,0,Feature,0,0,0,114,0.004239,0.6364,0,0.3182,7,2,0,0.6036,4.5803,4.88,31.72,12.0,1,0,0.4984,1,0.1371,1,0,0,0,0,"Enable nftables rules for SR-IOV VIPs

This patch enables setting the nftables rules in Amphora using SR-IOV VIPs.
[SEP]
FILES CHANGED:
octavia/common/utils.py (+6, -0)
octavia/controller/worker/v2/flows/flow_utils.py (+9, -8)
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+100, -0)
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+9, -2)
releasenotes/notes/Add-support-for-SR-IOV-VIPs-862858ec61e9955b.yaml (+9, -0)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+67, -34)
octavia/amphorae/backends/agent/api_server/server.py (+26, -0)
octavia/tests/unit/amphorae/backends/utils/test_interface.py (+57, -1)
octavia/amphorae/backends/agent/api_server/rules_schema.py (+52, -0)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+22, -0)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+37, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+28, -0)
octavia/controller/worker/v2/tasks/shim_tasks.py (+28, -0)
octavia/common/constants.py (+9, -2)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+23, -0)
octavia/controller/worker/v2/controller_worker.py (+45, -11)
octavia/db/repositories.py (+18, -0)
octavia/tests/unit/amphorae/backends/utils/test_nftable_utils.py (+93, -5)
octavia/amphorae/backends/utils/nftable_utils.py (+70, -8)
octavia/controller/worker/v2/flows/amphora_flows.py (+55, -3)
octavia/amphorae/drivers/driver_base.py (+11, -0)
octavia/controller/worker/v2/tasks/database_tasks.py (+46, -0)
octavia/tests/unit/controller/worker/v2/flows/test_listener_flows.py (+54, -11)
octavia/tests/unit/common/test_utils.py (+39, -0)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+34, -10)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver.py (+24, -2)
octavia/tests/functional/db/test_repositories.py (+8, -0)
octavia/tests/unit/controller/worker/v2/tasks/test_shim_tasks.py (+33, -0)
octavia/amphorae/backends/utils/interface.py (+1, -9)
octavia/amphorae/drivers/noop_driver/driver.py (+3, -0)
octavia/controller/worker/v2/flows/listener_flows.py (+95, -5)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver_1_0.py (+10, -0)
",-0.511726,0.606098,-0.633772,1.521336,1.07465,0.085863,-0.476395,0.656659,-0.210997,-0.080504,0.306076,0.568957,0.581787,-0.737778,-0.045306
openstack/kolla,If66f95e52b1897d5b2d319fb1a43bde5ed9db751,0,0,0.7792,2.0794,0.1429,2,3.25,126,0,Feature,0,0,0,77,0.029013,0.6364,0,0.4959,2,2,0,0.7959,0.8631,2.0,34.34,13.61,0,0,0.0,1,15.75,0,0,0,0,0,"toolbox: Bump ansible-core to 2.15

This was forgotten in 2023.2 cycle.
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-core-2-15-toolbox-6317578773bea1c5.yaml (+5, -0)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",1.41315,0.388969,-0.5731,-0.655028,-0.770429,0.597731,-0.100027,0.225548,-0.65328,0.946053,0.246663,0.375303,-0.754253,0.517997,0.393927
openstack/oslo.context,I19f83d7b0a13f14df16ac805998d5b3751801c12,1,0,0.9167,1.9459,0.3333,1,15.4,508,0,CI,0,0,0,12,0.052863,1.0,0,0.9167,1,1,0,1.0,0.0,1.0,46.18,15.51,0,0,0.0,0,72.5714,0,0,0,0,0,"Add is_admin to redacted context

Heat is known to override RequestContext in a strange way and it
attempts to run policy check, which loads full request context, in case
is_admin is not given.

This ensures is_admin is copied during redactation, to avoid failures
in unit tests. is_admin is not a secret field so can appear in
notifications.

This also adds **kwargs interface to redacted_copy, so that we can
inject a few more arguments in subclasses.
[SEP]
FILES CHANGED:
oslo_context/context.py (+4, -2)
",-1.01988,-1.539643,0.596297,0.489116,-0.063945,-0.381553,0.186145,-0.595892,0.184821,0.313849,0.137275,-0.467115,-0.075093,-0.083884,-0.134941
openstack/charm-mysql-innodb-cluster,I221a2c09d1d56809e3ffe75ac42bae9502389a79,1,0,0.0,3.434,0.0333,1,8.5,147,0,Feature,0,0,0,1,0.025641,1.0,1,0.0,1,1,0,1.0,0.0,1.0,24.03,12.81,1,0,0.0,0,4.7419,0,0,0,0,0,"Update readme with Juju 3 compatible commands

Add Juju 3 compatible commands to the README.
[SEP]
FILES CHANGED:
src/README.md (+29, -1)
",1.183356,0.950708,-0.472016,1.356857,0.837287,0.690457,-0.10015,0.52439,-0.582457,-0.043216,0.161625,0.348022,0.128855,0.291858,-0.432121
openstack/ironic,I080ca42c9ba05f2a4e0752312b79a32bef825752,1,1,0,3.5553,0.0294,3,9.0,460,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.9528,1.0863,2.67,44.61,12.49,1,0,0.7059,1,13.1429,0,6,0,3,0,"Fix iscsi url generate method for ipxe

Boot from volume feature has a ipxe template render step, and it need
to generate iscsi urls for booting the volume. However, it not works. In
the function, lun field should be hexadecimal instead of decimal,
according to SAN URIs description at https://ipxe.org/sanuri. So we
need to fix it.

Closes-Bug: #2055355
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2011053-085a8b5a36bb9b59.yaml (+8, -0)
ironic/common/pxe_utils.py (+1, -1)
ironic/tests/unit/common/test_pxe_utils.py (+24, -0)
",-0.546423,-1.211065,0.131901,0.146526,-0.33667,-0.42393,0.033003,0.168421,0.071511,0.257694,-0.07566,-0.474516,0.245767,0.054108,-0.109515
openstack/openstack-ansible-haproxy_server,Ib8b9e4dea0ecd5d35f0e872dfaa0f2ec837a98f8,1,1,0.9504,1.0986,0.5,1,10.0,452,0,Bug Fix,0,0,0,141,0.045824,0.0,0,0.0,1,1,0,0.9091,0.0,1.0,8.87,16.0,0,0,0.0,0,150.6667,0,6,0,8,0,"Use correct permissions for haproxy log mount

With [1] a regression was introduced, where incorrect permissions were
applied to a bind mount corrupting access to /dev/log globally on hosts
where haproxy was running.

Default permissions are 0666 for /dev/log when it's managed by journald.

[1] https://review.opendev.org/c/openstack/openstack-ansible-haproxy_server/+/888143
Closes-Bug: #2055178
[SEP]
FILES CHANGED:
tasks/haproxy_post_install.yml (+1, -1)
",-1.193202,0.454858,-0.087675,0.080018,-0.626827,-0.127501,0.335817,0.199606,0.112559,-0.103837,0.212306,-0.329884,0.222694,-0.191972,-0.053171
openstack/octavia,Iaf08c2bd229165638b4f7f850b26aaf899d540e1,1,0,0.4957,3.1355,0.2727,3,18.25,435,0,Bug Fix,0,0,0,115,0.004089,0.6667,0,0.3304,7,2,0,0.6018,1.582,4.67,70.1,12.23,0,0,0.3636,1,18.913,0,0,0,0,0,"Fix port abandonment on failover flow revert

There was an issue in the failover flow, where if the failover flow reverted
after the VIP base (vrrp) port had been created, the revert would fail to
delete port as part of the revert. It did however log that it was not cleaning
up the port.
This patch corrects the issue such that VIP base ports get cleaned up on a
failover revert.
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+6, -2)
releasenotes/notes/Fix-failover-revert-port-leak-d9879523506c6ff3.yaml (+7, -0)
octavia/controller/worker/v2/tasks/network_tasks.py (+3, -4)
",-0.351229,-1.610968,0.254825,0.61658,-0.142714,0.484306,0.582029,-0.547815,0.199562,-0.091679,0.568278,0.299694,0.051165,0.279491,0.357041
openstack/octavia,I9bb45a1aca6b7b18644752a3dccc3ebfb7c106ef,1,1,0,4.382,0.038,3,10.2,372,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,5,2,0,0.6029,0.5552,3.33,35.58,13.49,0,0,0.8987,1,4.65,0,0,0,0,0,"Fix negative or 0 limit parameter in pagination

Octavia replace ""limit"" with None when it is less 1. (for example 0, -1)
However the further code failed to compare None and int values.
This patch fixes it by validation, that limit is None.

Co-Authored-By: Roman Goncharov <gadzhet007@gmail.com>

Closes-Bug: #2060917
[SEP]
FILES CHANGED:
releasenotes/notes/Fix-limit-pagination-less-or-equal-zero-93a33f1318ea34e5.yaml (+6, -0)
octavia/api/common/pagination.py (+1, -1)
octavia/tests/unit/api/common/test_pagination.py (+69, -2)
",-0.49004,-0.888535,-0.296891,-0.391926,-0.858549,0.257964,-0.152288,-0.007183,0.196357,0.450502,0.450178,-0.128373,0.359799,0.199671,-0.420959
openstack/kolla-ansible,Ib3a1313df680d91c7f008063937ca7d37e82f690,1,1,0.8,2.0794,0.0,2,4.5,753,0,Bug Fix,0,0,0,15,0.010807,0.6,0,0.48,4,2,0,0.774,0.5917,3.0,1.34,10.69,0,0,0.0,1,94.125,0,6,0,11,0,"Add NET_RAW to dnsmasq container

When using dnsmasq as a DHCP server, unless you use the noping option
(and that is not recommended), the NET_RAW capabilty is required so
that dnsmasq can send ICMP packets. These are used to check an address
is not currently in use[1].  Docker enables this capability by
default. Podman runs containers with a minimal set of capabilities[3].

[1] https://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2019q1/012840.html
[2] https://docs.docker.com/engine/containers/run/#runtime-privilege-and-linux-capabilities
[3] https://github.com/rhatdan/common/blob/f39f2a3f8c7680b9e456b9d235570e511807d6c6/docs/containers.conf.5.md?plain=1#L84-L101

Closes-Bug: #2055282
[SEP]
FILES CHANGED:
releasenotes/notes/adds-net-raw-capability-to-ironic-dnsmasq-40f5894c5180b12d.yaml (+6, -0)
ansible/roles/ironic/defaults/main.yml (+1, -0)
",-3.708716,2.162071,1.646341,-0.848027,-0.203295,-0.020804,0.389609,0.087551,0.140662,0.042164,-0.236885,-0.030189,0.062194,-0.183616,-0.26172
openstack/kolla-ansible,Id0bda00b81b5bc6a9a870e231335c33d9828e95f,0,0,0.8851,4.2195,0.0597,5,11.69,1141,0,Doc,0,0,0,87,0.025115,1.0,0,0.8851,3,3,0,0.7746,1.6527,2.0,29.11,12.31,0,0,0.0,1,16.7794,0,0,0,0,0,"Support reducing scope of delegated fact gathering

When Kolla Ansible is executed with a '--limit' argument, the scope of
an operation is limited to the hosts in the limit. For example:

   kolla-ansible deploy --limit control

Due to the nature of configuring clustered software services, there are
cases where we need to know information about other hosts. Most often
this is related to their hostname or network addresses. To make this
work, Kolla Ansible gathers facts for hosts outside of the limit using
delegated fact gathering [1].

By default, Kolla Ansible gathers facts for all hosts. Because delegated
facts are gathered serially in batches by the active hosts, this can
take a long time when there are not many hosts in the limit.

This change makes it possible to reduce the set of hosts eligible for
delegated fact gathering by setting 'kolla_ansible_delegate_facts_hosts'
to a list of hosts.

[1] https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_delegation.html#delegating-facts

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/899615
[SEP]
FILES CHANGED:
releasenotes/notes/delegate-facts-hosts-a3c8bd588c805ffa.yaml (+6, -0)
ansible/group_vars/all.yml (+6, -0)
ansible/gather-facts.yml (+1, -1)
etc/kolla/globals.yml (+9, -3)
doc/source/user/ansible-tuning.rst (+41, -0)
",-3.565545,1.167117,2.99796,-0.227572,-0.205488,0.163931,-0.386799,-0.255976,0.117809,-0.276914,-0.506429,0.324176,-0.089645,-0.3795,-0.250412
openstack/kolla-ansible,I2e0ea49701b5900eae26434bcdb6b1bb44507ee7,0,0,0.875,3.6109,0.6111,5,8.2,787,0,CI,0,1,0,88,0.024922,0.75,0,0.6562,2,3,0,0.7725,2.0782,1.8,-11.96,13.04,1,0,0.1111,1,21.2703,0,0,0,0,0,"Revert ""Allow setting any_errors_fatal true for gather-facts""

This reverts commit 5b431f0f7f932293362a01703673ee05d0a5bd8d.

Reason for revert: the any_errors_fatal play parameter is not templated
by Ansible (tested up to ansible-core 2.15.9). This behaviour is
demonstrated in [1].

This means that ""{{ kolla_ansible_setup_any_errors_fatal }}"" is always
interpreted as 'true', regardless of the value of
kolla_ansible_setup_any_errors_fatal.  This is particularly bad because
the default value of kolla_ansible_setup_any_errors_fatal is false.

We now have gather_facts_max_fail_percentage which can be set to 0 to
provide the same functionality.

[1] https://github.com/markgoddard/ansible-experiments/tree/master/15-fatal-errors
[SEP]
FILES CHANGED:
releasenotes/notes/remove-any-errors-fatal-664fc2207074f0ef.yaml (+14, -0)
ansible/group_vars/all.yml (+0, -8)
tests/templates/globals-default.j2 (+0, -4)
ansible/gather-facts.yml (+0, -2)
etc/kolla/globals.yml (+0, -8)
",-4.015778,1.466144,1.422608,-0.528055,0.628042,0.425859,-0.585561,-0.587186,0.221779,-0.20835,0.362084,0.023668,-0.554954,-0.068763,0.181655
openstack/octavia,Id3dce30639cce6724d41fd2ccd53612384eba87f,0,0,0.5,2.9957,1.0,1,14.33,283,0,Bug Fix,0,0,0,116,0.004121,0.5,0,0.25,5,1,0,0.6041,0.0,5.0,68.34,12.24,1,0,0.0,0,14.15,0,0,0,0,0,"Fix duplicate tasks in SRIOV LB Create flow

There was a mistake in the load balancer create flow where duplicate
tasks were added to the flow when an SRIOV VIP was used. This patch corrects
that by removing the duplicate tasks.
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/flows/load_balancer_flows.py (+0, -19)
",0.539242,-0.337675,-0.102776,1.074977,0.187583,0.803292,0.371189,-0.357807,-0.032265,-0.397131,0.292779,0.717588,0.147717,0.088735,0.325521
openstack/ironic,I3295c92fd7b7871ad351b94f4c6cf0f554279db0,1,0,0.9737,2.0794,0.5714,1,12.0,240,0,CI,0,0,0,38,0.012864,1.0,0,0.9737,2,1,0,0.9533,0.0,2.0,72.46,8.13,0,0,0.0,0,30.0,0,0,0,0,0,"ci: pin CI to dnsmasq 2.85

A temporary path forward to increase CI stability, by pinning
to what appears to be a ""good working version"" of upstream dnsmasq
which does not crash fon us.
[SEP]
FILES CHANGED:
devstack/lib/ironic (+3, -4)
",0.882537,-1.058886,-0.525083,0.470064,0.158947,0.03347,0.470353,-0.42493,-0.394241,0.44627,-0.301888,0.411523,-0.232481,-0.26389,0.464026
openstack/kolla-ansible,I254f71d607353e0cf4d3d5ebafd6813287c4fa9f,0,0,0.7692,0.6931,0.0,1,4.25,253,0,CI,1,0,0,78,0.029312,1.0,0,0.7692,2,1,0,0.7703,0.0,2.0,-46.3,18.17,0,0,1.0,0,126.5,0,0,0,0,0,"CI: Use ControlPersist and ControlMaster

Similar to [1].

[1]: https://review.opendev.org/c/openstack/openstack-ansible/+/851426

(cherry picked from commit 6160c232b1698302a90dae204193ded3858c506f)
[SEP]
FILES CHANGED:
tests/templates/ansible.cfg.j2 (+1, -0)
",-0.254149,1.423509,-1.756674,-1.193379,-0.217439,0.184067,0.526304,0.118662,0.269558,0.214248,-0.388852,-0.198044,0.241781,0.017914,-0.434358
openstack/charm-ceph-mon,I3d274c09522f9d7ef56bc66f68d8488150c125d8,1,1,0.9655,3.2581,0.36,1,16.0,244,0,Bug Fix,0,0,0,29,0.004343,1.0,0,0.9655,1,1,0,0.9355,0.0,1.0,45.19,13.9,1,0,0.0,0,9.3846,0,0,0,0,0,"Fix: defer cos-prometheus for bootstrap

If a COS prometheus changed event is processed but bootstrap hasn't
completed yet, we need to retry the event at a later time.

Closes-bug: #2042891
[SEP]
FILES CHANGED:
src/ceph_metrics.py (+16, -9)
",1.053538,-0.112227,-0.824058,0.350925,-0.382018,0.621656,0.353775,-0.70384,-0.010871,-0.232555,0.682295,0.20594,0.156215,-0.051634,0.560227
openstack/kolla-ansible,I35be54efb5aaa230702d0cebaae04f1e64c3bca3,1,1,1.0,4.5326,0.25,5,7.25,263,0,Bug Fix,0,0,0,1,0.045455,0.8333,0,0.8333,4,3,0,0.7682,0.7421,3.0,9.86,16.69,1,0,0.0,1,2.828,0,10,0,12,0,"Update cell0 database connection

When kolla VIP address is changed the cell0 database connection is
now updated to the new address.

Closes-bug: #1915302
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+1, -0)
kolla_ansible/nova_filters.py (+1, -2)
ansible/roles/nova/tasks/map_cell0.yml (+61, -20)
releasenotes/notes/bug-1915302-a668b00dddaff476.yaml (+5, -0)
ansible/roles/nova-cell/tasks/get_cell_settings.yml (+1, -1)
",0.605852,-1.309471,-0.534186,0.034877,-0.099856,0.679275,-0.438239,0.137814,0.544762,-0.255158,-0.043118,0.251933,-0.205942,0.189296,-0.125356
openstack/kolla-ansible,Iaeaa8c667ce7cd677b2b3dc2096ef4e52c1f651f,1,0,0.3333,2.3979,0.0,1,4.44,386,0,Bug Fix,0,0,0,3,0.034483,0.8,1,0.2667,3,1,0,0.7688,0.0,3.0,22.55,12.78,1,1,0.0,0,35.0909,0,0,0,0,0,"[doc] document --limit limitations

there are currently known bugs in our interaction with the ansible
--limit option. document those and recommend not to use this like it
was agreed in the kolla meeting:
https://meetings.opendev.org/meetings/kolla/2024/kolla.2024-02-21-14.00.log.txt
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+10, -0)
",-1.189924,0.940278,-1.198445,0.441177,-0.9194,-0.496046,0.40715,-0.175842,-0.177266,0.382448,-0.277058,-0.305077,0.096024,0.387277,0.060949
openstack/kolla-ansible,I413537e8989d9d739da8ebb573f62cbb653bdb06,0,0,0.8261,4.6052,1.0,6,9.33,263,0,Feature,0,0,0,23,0.013196,0.5,0,0.413,4,2,0,0.7694,2.2053,4.0,-23.2,22.3,1,0,0.0,0,2.63,0,0,0,0,0,"Remove api-paste config files for masakari, cyborg

- Api-paste files are provided by kolla images
- Nobody maintains in kolla-ansible (masakari outdated)
[SEP]
FILES CHANGED:
ansible/roles/masakari/templates/masakari-api-paste.ini.j2 (+0, -44)
ansible/roles/cyborg/tasks/config.yml (+0, -12)
ansible/roles/cyborg/templates/cyborg-api.json.j2 (+0, -6)
ansible/roles/cyborg/templates/cyborg-api-paste.ini.j2 (+0, -19)
ansible/roles/masakari/tasks/config.yml (+0, -12)
ansible/roles/masakari/templates/masakari-api.json.j2 (+0, -6)
",0.830403,0.068898,-0.622108,0.220964,0.638942,-0.419435,0.070766,0.298186,-1.071311,-0.734192,-0.023208,0.458593,0.521978,0.062147,-0.364525
openstack/kolla,I1fd03a67914386129d7b0bb9be6aca86982f98f3,0,0,0.7595,3.2958,0.2308,5,3.75,266,0,Doc,0,0,0,79,0.029677,0.7778,0,0.5907,2,4,0,0.7919,2.2955,2.0,33.83,9.5,0,0,0.0,1,9.8519,0,0,0,0,0,"Bump rabbitmq to 3.13

Pinning Erlang to 26.2.* (max supported version as per [1]),
so we don't break this in future when Erlang 26.3 becomes
available.

[1]: https://rabbitmq-website.pages.dev/docs/which-erlang
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-3-13-56852b220fd50bc0.yaml (+6, -0)
docker/base/apt_preferences.ubuntu (+5, -1)
docker/base/apt_preferences.debian (+5, -1)
docker/rabbitmq/Dockerfile.j2 (+2, -2)
docker/kolla-toolbox/Dockerfile.j2 (+2, -2)
",0.141479,0.310642,-0.503563,-0.099115,-0.875741,-0.16763,-0.006673,0.426952,-0.399222,0.754676,-0.544296,-0.186488,-0.266293,0.127743,0.189252
openstack/kolla-ansible,Ieaec8f64922e4e5a2199db2d6983518b124cb4aa,0,0,0.0,5.2364,0.262,54,12.29,701,0,CI,0,0,0,1,0.032258,1.0,0,0.0,4,2,0,0.7673,2.4835,3.96,6.47,17.47,0,0,0.0,0,3.7287,0,0,0,0,0,"Refactor of kolla_container_facts

Refactor that prepares kolla_container_facts
module for introducing more actions that will be moved
from kolla_container module and kolla_container_volume_facts.

This change is based on a discussion about adding a new action
to kolla_container module that retrieves all names of the running
containers. It was agreed that kolla-ansible should follow Ansible's
direction of splitting modules between action modules and facts
modules. Because of this, kolla_container_facts needs to be able
to handle different requests for data about containers or volumes.
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/tasks/precheck.yml (+1, -0)
ansible/roles/service-config-validate/tasks/validate.yml (+1, -0)
ansible/roles/hacluster/tasks/precheck.yml (+1, -0)
ansible/roles/skyline/tasks/precheck.yml (+1, -0)
ansible/roles/ironic/tasks/precheck.yml (+1, -0)
ansible/roles/cyborg/tasks/precheck.yml (+1, -0)
ansible/roles/ovn-db/tasks/precheck.yml (+1, -0)
ansible/roles/neutron/handlers/main.yml (+1, -0)
ansible/roles/nova-cell/tasks/precheck.yml (+1, -0)
ansible/roles/gnocchi/tasks/precheck.yml (+1, -0)
ansible/roles/iscsi/tasks/precheck.yml (+1, -0)
ansible/roles/nova/tasks/precheck.yml (+1, -0)
ansible/roles/mariadb/tasks/precheck.yml (+1, -0)
ansible/roles/rabbitmq/tasks/restart_services.yml (+1, -0)
ansible/roles/placement/tasks/precheck.yml (+1, -0)
ansible/roles/watcher/tasks/precheck.yml (+1, -0)
ansible/roles/cloudkitty/tasks/precheck.yml (+1, -0)
ansible/roles/octavia/tasks/precheck.yml (+1, -0)
ansible/roles/opensearch/tasks/precheck.yml (+1, -0)
ansible/roles/venus/tasks/precheck.yml (+1, -0)
ansible/library/kolla_container_facts.py (+85, -49)
ansible/roles/kuryr/tasks/precheck.yml (+1, -0)
ansible/roles/designate/tasks/precheck.yml (+1, -0)
ansible/roles/memcached/tasks/precheck.yml (+1, -0)
ansible/roles/prometheus/tasks/precheck.yml (+1, -0)
ansible/roles/zun/tasks/precheck.yml (+1, -0)
ansible/roles/keystone/tasks/precheck.yml (+1, -0)
ansible/roles/influxdb/tasks/precheck.yml (+1, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+1, -0)
ansible/roles/bifrost/tasks/stop.yml (+1, -0)
ansible/roles/blazar/tasks/precheck.yml (+1, -0)
ansible/roles/barbican/tasks/precheck.yml (+1, -0)
ansible/roles/mistral/tasks/precheck.yml (+1, -0)
ansible/roles/trove/tasks/precheck.yml (+1, -0)
ansible/roles/openvswitch/tasks/precheck.yml (+1, -0)
ansible/roles/manila/tasks/precheck.yml (+1, -0)
ansible/roles/neutron/tasks/precheck.yml (+1, -0)
ansible/roles/nova-cell/tasks/libvirt-cleanup.yml (+1, -0)
ansible/roles/aodh/tasks/precheck.yml (+1, -0)
ansible/roles/cinder/tasks/precheck.yml (+1, -0)
ansible/roles/keystone/tasks/bootstrap_service.yml (+1, -0)
ansible/roles/rabbitmq/tasks/remove-ha-all-policy.yml (+1, -0)
ansible/roles/redis/tasks/precheck.yml (+1, -0)
ansible/roles/horizon/tasks/precheck.yml (+1, -0)
ansible/roles/loadbalancer/tasks/precheck.yml (+1, -0)
ansible/roles/glance/tasks/precheck.yml (+1, -0)
ansible/roles/masakari/tasks/precheck.yml (+1, -0)
ansible/roles/neutron/tasks/neutron_plugin_agent_check.yml (+1, -0)
ansible/roles/etcd/tasks/precheck.yml (+1, -0)
ansible/roles/magnum/tasks/precheck.yml (+1, -0)
ansible/roles/swift/tasks/precheck.yml (+1, -0)
ansible/roles/heat/tasks/precheck.yml (+1, -0)
ansible/roles/grafana/tasks/precheck.yml (+1, -0)
ansible/roles/tacker/tasks/precheck.yml (+1, -0)
",-1.585781,-0.811819,0.367938,0.650035,0.462128,-0.636401,0.204869,0.292087,-0.09312,-0.264357,0.160212,-0.105983,-0.229625,-0.039256,0.128202
openstack/openstack-ansible-os_horizon,I30b9b6a70d2cabfb1f1f434cd883ea2503d867bc,1,1,0.9507,1.9459,0.5,1,18.5,288,0,Bug Fix,0,0,0,142,0.046119,0.0,0,0.0,1,1,0,1.0,0.0,1.0,16.57,20.37,0,0,0.0,0,41.1429,0,6,0,15,0,"Do not change mode of files recursively

Current behavior leads to all files having executable bit which is not
anticipated or required behaviour.

Thus, we should avoid defining mode recursively to the directory

Closes-Bug: #2052011
[SEP]
FILES CHANGED:
tasks/horizon_post_install.yml (+3, -3)
",0.311363,-2.273111,0.015212,0.241391,-0.335396,0.318733,-0.267603,-0.388386,-0.089856,0.052767,-0.491993,-0.162554,0.433278,-0.345511,-0.171876
openstack/kolla-ansible,I1db88e28a828ebf073f018b2bae1d9556ec22807,0,1,0.0,6.6921,0.4199,65,4.89,476,0,Bug Fix,0,0,0,2,0.009174,0.75,0,0.0,4,3,0,0.7652,4.2121,3.72,-40.39,17.41,0,0,0.3988,1,0.5906,0,6,0,3,0,"Move actions to kolla_container_facts

Move actions responsible for info about containers
from kolla_container module to kolla_container_facts.
Also fixes a bug with inconsistencies between docker
and podman in kolla_container_facts.

Closes-bug: #2084878
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/tasks/precheck.yml (+1, -1)
tests/kolla_container_tests/test_docker_worker.py (+0, -56)
ansible/roles/service-config-validate/tasks/validate.yml (+2, -2)
ansible/roles/hacluster/tasks/precheck.yml (+1, -1)
ansible/roles/skyline/tasks/precheck.yml (+2, -2)
ansible/roles/ironic/tasks/precheck.yml (+4, -4)
ansible/roles/cyborg/tasks/precheck.yml (+1, -1)
ansible/roles/ovn-db/tasks/precheck.yml (+2, -2)
ansible/roles/neutron/handlers/main.yml (+1, -1)
ansible/roles/nova-cell/tasks/precheck.yml (+8, -8)
ansible/roles/gnocchi/tasks/precheck.yml (+1, -1)
ansible/roles/iscsi/tasks/precheck.yml (+1, -1)
ansible/roles/nova/tasks/precheck.yml (+2, -2)
ansible/roles/mariadb/tasks/precheck.yml (+4, -4)
ansible/roles/rabbitmq/tasks/restart_services.yml (+1, -1)
ansible/roles/placement/tasks/precheck.yml (+1, -1)
ansible/roles/watcher/tasks/precheck.yml (+1, -1)
ansible/roles/cloudkitty/tasks/precheck.yml (+1, -1)
ansible/roles/octavia/tasks/precheck.yml (+2, -2)
ansible/roles/opensearch/tasks/precheck.yml (+1, -1)
ansible/roles/venus/tasks/precheck.yml (+1, -1)
ansible/library/kolla_container_facts.py (+100, -52)
ansible/roles/kuryr/tasks/precheck.yml (+1, -1)
ansible/roles/designate/tasks/precheck.yml (+4, -4)
ansible/roles/memcached/tasks/precheck.yml (+1, -1)
ansible/roles/prometheus/tasks/precheck.yml (+10, -10)
ansible/roles/zun/tasks/precheck.yml (+3, -3)
ansible/roles/keystone/tasks/precheck.yml (+2, -2)
ansible/roles/influxdb/tasks/precheck.yml (+1, -1)
ansible/roles/rabbitmq/tasks/precheck.yml (+6, -6)
ansible/roles/bifrost/tasks/stop.yml (+1, -1)
ansible/roles/blazar/tasks/precheck.yml (+1, -1)
ansible/roles/barbican/tasks/precheck.yml (+1, -1)
ansible/roles/mistral/tasks/precheck.yml (+1, -1)
ansible/roles/trove/tasks/precheck.yml (+1, -1)
releasenotes/notes/move-container-facts-1507cec39b2bdbe0.yaml (+10, -0)
ansible/roles/openvswitch/tasks/precheck.yml (+1, -1)
tests/kolla_container_tests/test_podman_worker.py (+0, -57)
ansible/roles/service-check/tasks/main.yml (+6, -4)
ansible/roles/swift/tasks/reconfigure.yml (+17, -11)
ansible/roles/manila/tasks/precheck.yml (+1, -1)
ansible/roles/neutron/tasks/precheck.yml (+1, -1)
ansible/roles/nova-cell/tasks/libvirt-cleanup.yml (+1, -1)
ansible/roles/aodh/tasks/precheck.yml (+1, -1)
ansible/roles/cinder/tasks/precheck.yml (+1, -1)
ansible/roles/bifrost/tasks/reconfigure.yml (+17, -11)
ansible/roles/keystone/tasks/bootstrap_service.yml (+4, -4)
ansible/roles/rabbitmq/tasks/remove-ha-all-policy.yml (+1, -1)
ansible/roles/redis/tasks/precheck.yml (+1, -1)
ansible/roles/horizon/tasks/precheck.yml (+1, -1)
tests/test_kolla_container.py (+0, -4)
ansible/roles/mariadb/tasks/backup.yml (+1, -1)
ansible/roles/loadbalancer/tasks/precheck.yml (+9, -9)
ansible/module_utils/kolla_container_worker.py (+0, -24)
ansible/roles/glance/tasks/precheck.yml (+1, -1)
tests/test_kolla_container_facts.py (+204, -0)
ansible/roles/masakari/tasks/precheck.yml (+1, -1)
ansible/roles/neutron/tasks/neutron_plugin_agent_check.yml (+2, -2)
ansible/library/kolla_container.py (+0, -6)
ansible/roles/etcd/tasks/precheck.yml (+2, -2)
ansible/roles/magnum/tasks/precheck.yml (+1, -1)
ansible/roles/swift/tasks/precheck.yml (+8, -8)
ansible/roles/heat/tasks/precheck.yml (+2, -2)
ansible/roles/grafana/tasks/precheck.yml (+1, -1)
ansible/roles/tacker/tasks/precheck.yml (+1, -1)
",-0.387327,-0.504298,-1.052196,0.169896,0.214546,-0.347499,-0.28111,0.184898,-0.226294,-0.692112,0.07763,-0.337273,-0.159123,0.096437,0.2447
openstack/magnum,I8e2a3529ce076465c631244c45e85b0edbc0675b,1,0,1.0,2.3026,0.0,1,8.0,97,0,Doc,0,0,0,1,0.043478,0.5,1,0.5,3,1,0,0.8947,0.0,3.0,-23.36,23.2,0,0,0.0,0,9.7,0,0,0,0,0,"Doc: Update supported versions for Caracal
[SEP]
FILES CHANGED:
doc/source/user/index.rst (+9, -0)
",3.399742,1.930708,1.369011,0.198079,-0.498259,0.959632,0.18554,1.075113,0.46862,0.186944,0.314945,0.5677,0.256694,-0.299887,-0.451383
openstack/openstack-ansible-os_heat,I95faa779bf62524fafd09576aa7ae27de029bb57,1,0,0.951,1.9459,0.5,1,21.0,592,0,Bug Fix,0,0,0,143,0.046353,0.0,0,0.0,1,1,0,1.0,0.0,1.0,27.4,17.45,0,0,0.0,0,84.5714,0,0,0,0,0,"Grant proper privileges to admin user for testing purposes

At the moment we assign `heat_stack_owner` to the `admin` user in a
`service` project, which leads to a completely unwanted behaviour, since
`admin` user does not have any other privileges to the `service` project
rather then `heat_stack_owner`.

Instead we should be granting privileges to the bootstrapped project
for the admin user.

This fixes unclarity and potential issues users might face in horizon
by switching to the `service` project, where they have no permissions.
[SEP]
FILES CHANGED:
tasks/heat_service_setup.yml (+3, -3)
",-1.232768,-1.247855,0.584999,0.669988,0.423439,-0.053427,0.120992,-0.217293,0.04762,-0.129817,9e-05,0.07582,-0.117901,-0.108297,-0.116744
openstack/openstack-ansible,I47b2e9af86b5dceafe68c7e56e149a8b34c30439,1,0,0.9514,0.0,0,1,15.5,527,0,Feature,0,0,0,144,0.046587,0.0,0,0.0,2,1,0,0.9241,0.0,2.0,-5.39,17.81,0,0,0,0,527.0,0,0,0,0,0,"Apply ironic virt_type only for ironic_compute group

With current inventory state, ironic_compute group is not the same as
ironic-compute_hosts, since latter does also include hosts, on which
ironic_compute LXC container resides in LXC scenario.

For example in AIO LXC, 'ironic-compute_hosts' includes aio1, while
ironic_compute - aio1_ironic_compute_container-5fd060b3.

This results in setting `nova_virt_type` for proper nova-compute, that
resides on AIO breaking it.
[SEP]
FILES CHANGED:
inventory/group_vars/ironic_compute.yml (+0, -0)
",-2.388612,-0.546883,0.276146,0.285312,1.219645,-0.541932,-0.452937,0.381292,-0.130853,-0.565382,0.234705,-0.126384,-0.168206,0.07274,-0.093959
openstack/kolla-ansible,I8e321469089f0eb80420b788b51e6d028c7fef4d,1,1,0.8652,2.5649,0.0833,2,17.0,491,0,Bug Fix,0,0,0,89,0.024951,0.6,0,0.5191,2,2,0,0.7631,1.0,1.5,34.07,16.8,0,0,0.0,1,37.7692,0,8,0,11,0,"Avoid unnecessary secondary fact gathering failure

Previously, during fact gathering when using the '--limit' argument if a
host inside the limit fails to gather facts, this would cause another
host to fail during delegated fact gathering. This is because the
ansible_facts variable would not be populated for the host.

This change fixes the issue by avoiding delegated fact gathering for
hosts inside the limit.

Partial-Bug: #2041860
[SEP]
FILES CHANGED:
releasenotes/notes/fact-gathering-double-failure-4662ef2f54d58291.yaml (+6, -0)
ansible/gather-facts.yml (+5, -1)
",-1.083255,-1.382844,-0.040637,0.82545,-0.042502,0.17779,-0.317145,-0.35133,0.543956,0.156076,0.037129,0.038306,0.283322,-0.13374,0.201554
openstack/ironic,I66e8edb847e93f96374072525222f05e7561fb07,1,1,0,6.7007,0.1576,4,13.67,277,0,Bug Fix,0,0,1,0,0.0,1.0,0,0.0,6,3,0,0.9537,1.0277,3.0,54.71,9.37,1,0,0.6256,1,0.3407,1,0,0,0,0,"Allow usage of virtual media via System

DMTF now changes their Virtual Media URI to support Systems. Redfish driver now
support this resource to boot, so it is needed that Ironic have a way to use it.

Closes-Bug: #2039458
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
ironic/tests/unit/drivers/modules/redfish/test_boot.py (+480, -28)
releasenotes/notes/add-vmedia-system-support-5d81316d02b909b9.yaml (+6, -0)
ironic/drivers/modules/redfish/boot.py (+197, -99)
",0.892798,-1.773306,-0.373881,0.07284,-0.764317,0.091449,-0.081035,0.575677,-0.174082,0.040801,-0.298598,0.103698,0.140152,-0.239918,-0.133589
openstack/kolla-ansible,I5568dba15fa98e009ad4a9e41756aba0fa659371,1,1,0.7917,2.0794,0.1429,2,7.64,667,0,Bug Fix,0,0,0,24,0.013029,0.5192,0,0.4111,2,2,0,0.7637,0.8631,2.0,25.86,11.15,1,0,0.0,1,83.375,1,6,0,6,0,"Fix coordination when redis used

Tooz 6.0.1 includes commit [1], which introduced
parsing the username from the Redis connection URL.
As a result, services started authenticating as admin
which, by the way, was incorrect even before, as either
a created user or the default one should have been used.

The reason it worked before is simply because the username
'admin' wasn't parsed anywhere.

This patch fixes the user being used and sets the correct
'default' one.

[1] https://review.opendev.org/c/openstack/tooz/+/907656

Closes-Bug: #2056667
Depends-On: https://review.opendev.org/c/openstack/kolla/+/911703
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2056667-c6d6896855b393f4.yaml (+5, -0)
ansible/group_vars/all.yml (+1, -1)
",-2.301821,0.521034,1.201801,-0.463987,-1.08674,0.395552,0.094627,-0.210946,-0.038302,-0.021814,0.217108,-0.000218,-0.149242,0.032405,-0.04316
openstack/kolla-ansible,Iae2de7782c082eb396f9ff9607ea0ddc5815fc10,0,0,0.75,2.8332,0.5,1,14.0,318,0,Feature,0,0,0,80,0.029762,1.0,0,0.75,4,1,0,0.7644,0.0,4.0,-0.75,22.74,1,0,0.0,0,18.7059,0,0,0,0,0,"magnum: Use valid_interfaces instead of endpoint_type

endpoint_type has been replaced with interface [1], but
interface is deprecated [2] - let's use valid_interfaces.

[1]: If18d8e27e499c294cb4dc94521da843341287362
[2]: I17043cd93072bbfd1389d44935bcf9a653e1d6a0
[SEP]
FILES CHANGED:
ansible/roles/magnum/templates/magnum.conf.j2 (+8, -8)
",-1.235329,-0.089201,-1.552356,-1.107022,1.410115,-0.060289,0.618293,-0.288252,0.296316,0.642294,0.112092,-0.217077,-0.036691,-0.029555,-0.163102
openstack/kolla-ansible,I145f75e13ab40b62b47469c23e34435590d2f767,1,0,0.7407,1.0986,0.5,1,6.0,282,0,Feature,0,0,0,81,0.029956,0.6667,0,0.4938,4,1,0,0.7623,0.0,4.0,-38.95,24.07,1,0,0.0,0,94.0,0,0,0,0,0,"octavia: Use valid_interfaces instead of endpoint_type

Since neutronclient removal in [1] valid_interfaces
is supported and endpoint_type is deprecated for removal.

[1]: https://review.opendev.org/c/openstack/octavia/+/866327
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
",-0.880483,1.655047,-1.061356,0.836273,-0.413547,0.013106,-0.399269,0.011865,0.294046,0.226227,-0.199184,-0.233713,-0.347106,-0.534736,-0.145836
openstack/kolla-ansible,I5df02af004fabb9bb1d6ca7c3fd83954cbf63a51,1,1,1.0,2.6391,0.2308,2,7.25,261,0,Bug Fix,0,0,0,2,0.017544,0.75,0,0.75,4,2,0,0.7629,0.9957,3.0,15.69,15.31,1,0,0.0,1,18.6429,0,10,0,16,0,"Fix trove module imports

Path to the modules needed by trove-api changed in source trove
package so the configuration was updated.

Closes-bug: #1937120
Signed-of-by: Roman Krƒçek <roman.krcek@tietoevry.com>
[SEP]
FILES CHANGED:
ansible/roles/trove/templates/trove.conf.j2 (+3, -3)
releasenotes/notes/bug-1937120-cd1ad24a9a4be739.yaml (+7, -0)
",-0.442537,0.385367,-1.247753,-0.217584,-0.817161,-0.18137,-0.06729,0.149298,-0.084522,-0.4254,0.419466,0.048982,0.10323,0.731333,-0.085581
openstack/kolla-ansible,Id6f51a2bebee3ab63b84ca7032aad17c2933838c,0,0,1.0,5.9322,0.2633,24,8.0,271,0,Feature,0,0,0,2,0.04878,1.0,0,1.0,4,3,0,0.7636,2.7148,3.83,-48.03,19.87,1,0,0.0,1,0.7188,0,0,0,0,0,"Automate prometheus blackbox configuration

This change automates the prometheus blackbox monitoring configuration
for common endpoints. Custom endpoints can be added to
prometheus_blackbox_exporter_endpoints_custom.
[SEP]
FILES CHANGED:
ansible/roles/mistral/defaults/main.yml (+1, -3)
ansible/roles/heat/defaults/main.yml (+3, -5)
ansible/roles/cinder/defaults/main.yml (+0, -3)
ansible/roles/manila/defaults/main.yml (+0, -3)
ansible/roles/cloudkitty/defaults/main.yml (+0, -3)
ansible/roles/blazar/defaults/main.yml (+2, -2)
ansible/roles/placement/defaults/main.yml (+0, -3)
ansible/roles/prometheus/defaults/main.yml (+155, -3)
releasenotes/notes/automated-blackbox-endpoints-b0ffd7bf9e3d16de.yaml (+14, -0)
ansible/roles/swift/defaults/main.yml (+3, -0)
ansible/roles/ceph-rgw/defaults/main.yml (+2, -2)
ansible/roles/tacker/defaults/main.yml (+0, -3)
ansible/roles/trove/defaults/main.yml (+2, -2)
ansible/roles/gnocchi/defaults/main.yml (+0, -3)
ansible/roles/masakari/defaults/main.yml (+0, -3)
ansible/roles/prometheus/templates/prometheus-blackbox-exporter.yml.j2 (+21, -0)
ansible/roles/venus/defaults/main.yml (+0, -3)
ansible/group_vars/all.yml (+70, -42)
ansible/roles/aodh/defaults/main.yml (+0, -3)
ansible/roles/nova/defaults/main.yml (+0, -3)
ansible/roles/ironic/defaults/main.yml (+0, -3)
ansible/roles/magnum/defaults/main.yml (+2, -2)
ansible/roles/zun/defaults/main.yml (+2, -2)
ansible/roles/watcher/defaults/main.yml (+0, -3)
",0.098094,0.744265,-0.669271,1.613822,1.242489,0.024522,-0.228087,0.679591,0.568166,-0.575715,-0.339293,0.075086,-0.687022,-0.404021,-0.140822
openstack/kolla-ansible,I5d321b8326edd7f3b7a11dbdc821e534f457f9d7,0,0,0.0,5.5872,0.4436,5,5.0,329,0,Feature,0,0,0,3,0.002933,0.0,0,0.0,4,2,0,0.7615,1.6972,2.6,-37.94,22.0,0,0,0.4211,0,1.2322,0,0,0,0,0,"Merge of container_facts modules

Merge container_facts and container_volume_facts
into a single module for retrieving all information
about containers and volumes.
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/tasks/lookup_cluster.yml (+4, -3)
ansible/library/kolla_container_volume_facts.py (+0, -108)
ansible/library/kolla_container_facts.py (+30, -2)
tests/test_kolla_container_facts.py (+110, -2)
ansible/roles/neutron/tasks/neutron_plugin_agent_check.yml (+4, -3)
",-0.063354,-0.949738,-0.355388,0.890103,1.354695,-0.236473,-1.049306,0.006586,-0.070201,-0.33006,-0.828409,0.003599,-0.23664,0.314856,-0.20767
openstack/openstack-ansible-os_neutron,If9fc16a7938a49d51dbd1110e908e3bda74e7adb,1,0,1.0,1.0986,0.5,1,3.33,194,0,Feature,0,0,0,2,0.285714,0.9302,0,0.9302,1,1,0,0.9231,0.0,1.0,-168.79,21.33,1,0,0.0,0,64.6667,0,0,0,0,0,"Use ansible_facts['processor_vcpus'] instead of fact variable

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/912768
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",0.002816,4.040587,-1.614583,0.543199,-0.717567,0.270453,0.104079,-0.511363,0.373497,-0.790014,-0.527708,-0.291545,-0.314522,-0.533904,-0.127672
openstack/kolla-ansible,I9b562f6a5722f21b7dbec2a4d53a46a57c829155,1,1,0.8235,3.989,0.0377,4,8.89,651,0,Bug Fix,0,0,0,17,0.004707,1.0,0,0.8235,4,4,0,0.7595,0.9574,3.5,26.5,10.06,1,0,0.0,1,12.0556,0,6,0,13,0,"Support custom Nova Compute Ironic host names

This fixes an issue where it is not possible to customise the `host`
config option in the Nova Compute Ironic config file without breaking
detection of the service.

This is a backwards compatible fix, which allows a user to set the
`host` config option using Ansible host or group vars.

Other reasons for not using the default host setting of
`{{ ansible_hostname }}-ironic` are covered in [1].

[1] https://specs.openstack.org/openstack/nova-specs/specs/2024.1/approved/ironic-shards.html#migrate-from-peer-list-to-shard-key.

Closes-Bug: #2056571
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/templates/nova.conf.j2 (+1, -1)
ansible/roles/nova-cell/tasks/wait_discover_computes.yml (+1, -1)
releasenotes/notes/fix-setting-nova-compute-ironic-host-option-a7a3f6ae095f5201.yaml (+6, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+43, -0)
",-2.492534,1.055172,0.778783,0.197716,-0.152912,-0.257999,-0.074376,0.346822,0.425378,-0.137728,-0.19257,0.262108,-0.059337,-0.261083,-0.28036
openstack/kolla-ansible,I9e0287a4e80b1ebcecf9e3b66c11d4233970a30b,1,1,0.7439,1.0986,0.5,1,11.0,118,0,Bug Fix,0,0,0,82,0.030303,0.0,0,0.0,4,1,0,0.7601,0.0,4.0,3.4,15.31,0,0,0.0,0,39.3333,0,6,0,12,0,"rabbitmq: bump wait timeout to 60 seconds

Closes-Bug: #2057676
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/restart_services.yml (+1, -1)
",2.320885,0.324131,0.099772,-0.95314,-0.510644,0.909534,-0.155011,-0.160788,0.20296,-0.090797,0.642726,-0.282366,-0.035438,0.031542,0.44897
openstack/octavia,Ic5e8140b13164267236f0a5d9a48fbd84bcdd688,0,0,0.4957,4.2627,0.3571,7,8.71,524,0,Feature,0,0,0,117,0.004154,0.5,0,0.2479,7,1,0,0.6023,2.6933,5.86,19.08,11.35,0,0,0.4857,0,7.3803,0,0,0,0,0,"Check Amphora status on SR-IOV failover flows

As noted on an earlier patch[1], the ""SetAmphoraFirewallRules"" task was not
checking the Amphora status nor using an API timeout. This could cause failover
flows to take longer than necessary if one of the Amphora is missing.

This patch corrects that issue by honoring both the Amphora status and timeout.

[1] https://review.opendev.org/c/openstack/octavia/+/910101/13/octavia/controller/worker/v2/flows/amphora_flows.py
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+4, -2)
octavia/controller/worker/v2/tasks/amphora_driver_tasks.py (+11, -4)
octavia/tests/unit/controller/worker/v2/flows/test_listener_flows.py (+10, -5)
octavia/controller/worker/v2/flows/amphora_flows.py (+6, -4)
octavia/amphorae/drivers/haproxy/rest_api_driver.py (+6, -5)
octavia/tests/unit/amphorae/drivers/haproxy/test_rest_api_driver.py (+2, -2)
octavia/tests/unit/controller/worker/v2/tasks/test_amphora_driver_tasks.py (+6, -3)
",-1.473223,1.291691,0.296648,0.354829,-0.577607,0.147341,0.684792,0.325506,0.323523,-0.133081,0.115613,0.107263,-0.071219,-0.346544,-0.054813
openstack/kolla-ansible,I5577ea2c23d6dbd440bd52899a30ea9531996256,1,0,0.747,1.7918,0.2,1,6.5,256,0,Doc,1,0,0,83,0.03065,0.3846,0,0.2873,2,1,0,0.7608,0.0,2.0,-1.5,14.91,0,0,1.0,0,42.6667,0,0,0,0,0,"CI: Increase galera node timeouts

Some multinode jobs have been failing due to galera suspecting inactive nodes
Tweak it as per [1].

[1]: https://galeracluster.com/library/documentation/recovery.html
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+4, -1)
",-0.805684,0.440388,-0.840418,0.452423,-0.490724,0.107625,-0.292549,0.152986,0.162783,0.337914,-0.27362,-0.163871,0.033088,-0.339882,-0.584712
openstack/kolla-ansible,If11710e99cf2e340e558d68e2071c1bb16825e55,0,0,0.75,2.0794,0.0,1,4.14,268,0,CI,1,0,0,84,0.030962,0.4286,0,0.3214,2,1,0,0.7614,0.0,2.0,30.51,12.69,0,0,1.0,0,33.5,0,0,0,0,0,"CI: Use 2023.2 image for rabbitmq on ipv6 scenario

Currently RMQ 3.13 fails on ipv6 multinode scenario, use 3.12 from 2023.1
until [1] gets resolved.

[1]: https://github.com/rabbitmq/rabbitmq-server/issues/10728
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+7, -0)
",-0.891696,1.408178,-0.7396,0.419625,-0.181616,-0.144855,-0.089472,0.287485,-0.355836,0.80187,-0.088266,-0.3806,-0.075711,-0.032349,0.297573
openstack/openstack-ansible-os_neutron,Iedea6f1a67349bafecca5c792072fcd8f95cc546,1,0,0.9517,1.3863,0.0,2,9.4,400,0,Feature,0,0,0,145,0.04691,1.0,0,0.9517,1,1,0,0.9286,0.9183,1.0,11.89,13.12,0,0,0.0,0,100.0,0,0,0,0,0,"Restart OVN on certificate changes

In cases where certificates were regenerated for OVN, a service restart
is required in order to apply and use new certs.

We provide also a unique handler name to distinguish certs between ones
installed for neutron-server and OVN.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/912768
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
handlers/main.yml (+2, -0)
",-0.971455,0.199651,-0.388851,0.548066,-0.609658,-0.383468,0.443238,0.171315,0.03986,0.034671,-0.350162,-0.242674,0.388156,-0.028104,-0.00449
openstack/kolla,I2b1c95395aeefb2ccb1d8edf415eee0f98c52190,0,0,0.0,3.5264,0.0606,3,7.0,152,0,Feature,0,0,0,2,0.012739,0.6667,0,0.0,3,3,0,0.7879,1.4471,2.33,12.4,17.09,1,0,0.0,1,4.4706,0,0,0,0,0,"Change logic for plugins in grafana image build

Co-authored-by:  Will Szumski <will@stackhpc.com>
[SEP]
FILES CHANGED:
docker/grafana/Dockerfile.j2 (+5, -2)
doc/source/admin/image-building.rst (+18, -0)
releasenotes/notes/merge-grafana-plugins-b9a837b9fccff691.yaml (+8, -0)
",1.691433,2.160163,-0.559639,-0.410941,-1.104469,0.479553,0.332446,0.076278,0.096476,-0.86153,0.691718,0.692672,-0.082505,-0.010455,-0.527733
openstack/openstack-ansible-os_nova,I7041a19547af580408ff704578cb8f12d37da1ae,1,1,1.0,2.1972,0.125,1,15.33,344,0,Bug Fix,0,0,0,3,0.333333,1.0,0,1.0,1,1,0,1.0,0.0,1.0,34.95,14.83,1,0,0.0,0,38.2222,0,6,0,10,0,"Ensure nova_device_spec is templated as JSON string

When the nova_device_spec variable is provided as either a string or a
mapping, ensure that it's templated as a JSON string.

Also handle either strings or mappings within nova_device_spec if it's
provided as a list.

Closes-Bug: 2057961
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+7, -1)
",-1.125482,0.134143,-0.751636,1.168086,0.636859,0.291976,-0.178242,-0.58219,0.416686,0.029187,0.397457,-0.156931,-0.129714,0.042681,-0.106634
openstack/kolla-ansible,Id9c7e59e6ae1dd98176c68b14a2aff1985306751,1,1,0.0,2.8904,0.1765,2,13.0,238,0,Bug Fix,0,0,0,3,0.015789,0.3333,0,0.0,4,2,0,0.7594,0.9367,3.0,-4.84,25.2,1,0,0.0,1,13.2222,0,6,0,9,0,"Update Grafana OpenSearch datasource configuration

Updates the Grafana OpenSearch datasource configuration to use values
for OpenSearch that work out of the box.

Closes-Bug: #2039500
[SEP]
FILES CHANGED:
releasenotes/notes/grafana-opensearch-datasource-configuration-04202c059f1abd05.yaml (+11, -0)
ansible/roles/grafana/defaults/main.yml (+3, -3)
",-0.690497,-0.199502,-1.640959,-0.972669,1.047048,0.389731,0.253124,0.263178,0.042498,0.082243,0.066619,-0.073296,0.524066,-0.215205,-0.070221
openstack/kolla-ansible,I9304f3546b20c0406e195163dccb1433fe802204,0,1,0.625,2.0794,0.1429,2,17.0,211,0,Bug Fix,0,0,0,8,0.051948,0.7,0,0.4375,4,2,0,0.76,0.8631,3.0,-14.46,23.27,1,0,0.0,1,26.375,0,6,0,5,0,"octavia: add missing bool to the enable_octavia_jobboard parameter

Closes-Bug: #2058046
(cherry picked from commit 57a11260f0d49e0364f765b074ee5c28862545d8)
[SEP]
FILES CHANGED:
releasenotes/notes/fix_octavia_jobboard_bool-bee05138f8209a8e.yaml (+5, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
",-0.119568,-0.425318,-2.394913,-2.133016,0.900388,0.268742,0.37008,-0.301135,0.420761,-0.099085,-0.066083,-0.007344,0.037924,-0.274925,-0.014541
openstack/openstack-ansible-os_horizon,I25707600c2b05a7f816a7c4ea38c8985717df2d3,1,0,0.9521,2.3979,0.2,2,10.5,210,0,CI,0,0,0,146,0.047188,1.0,0,0.9521,2,2,0,1.0,0.971,1.5,-9.28,19.44,0,0,0.0,1,19.0909,0,0,0,0,0,"Reflect horizon_webroot setting in Apache vhost configuration

Changing only horizon_webroot is not sufficient without adjustments
to horizon Apache vhost.
[SEP]
FILES CHANGED:
releasenotes/notes/horizon_webroot-098629f30f69f192.yaml (+6, -0)
templates/openstack_dashboard.conf.j2 (+2, -2)
",-0.044805,0.219068,-0.556779,1.366455,1.201376,0.317412,-0.292018,-0.346429,-0.239867,-0.25174,-0.004285,0.089782,-0.532473,-0.544426,0.067269
openstack/kolla-ansible,I07b0d4a9da439954f982d19f472f6440b08ae3f8,1,0,0.5556,1.6094,0.5,1,10.0,188,0,Bug Fix,0,0,0,9,0.055901,0.0,0,0.0,4,1,0,0.758,0.0,4.0,19.03,14.0,1,0,0.0,0,37.6,1,0,0,0,0,"ironic: fix tftp server address in the dnsmasq configuration

The tftp server is reachable on the ironic_tftp_listen_address
address.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-dnsmasq.conf.j2 (+2, -2)
",1.487272,-0.956198,-0.273264,0.414598,0.347885,-0.496152,0.537474,0.422757,0.375305,-1.039543,0.054046,-0.288855,-1.363208,0.149033,-0.192707
openstack/kolla,I5349449183dbb7f4ec2042a21526076fb42591b3,0,1,0.7412,3.6109,0.0278,4,17.5,274,0,Bug Fix,0,0,0,85,0.03125,0.625,0,0.4632,3,3,0,0.7839,1.4047,2.25,36.79,17.29,1,0,0.0,1,7.4054,1,36,0,16,0,"neutron: Add docker clients for ML2/OVS improvement

Docker does not support running a container in a given
network namespace (netns) so we need a client installed
in the Neutron container images.

Related-Bug: #1891469
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+2, -0)
docker/base/docker-ce.repo (+6, -0)
docker/neutron/neutron-base/Dockerfile.j2 (+3, -1)
kolla/template/repos.yaml (+24, -0)
",0.81049,-1.133354,-0.471027,-0.061584,-0.579767,-0.136032,-0.060567,0.453768,-0.416445,-0.18914,-0.16233,0.042778,0.313022,-0.229854,-0.05078
openstack/kolla-ansible,I42ba4fb83b5bb31058e888f0d39d47c27b844de5,0,0,0.8,3.6889,0.2564,8,7.0,319,0,Feature,0,0,0,25,0.013521,0.6667,0,0.5333,4,3,0,0.7586,2.5326,2.88,32.95,13.09,1,0,0.2051,1,7.975,0,0,0,0,0,"Switch mariadb's loadbalancer from HAProxy to ProxySQL

It's been some time since ProxySQL has been
with us in Kolla. Let's switch the load balancer
for MariaDB connections from HAProxy to ProxySQL.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/928956
[SEP]
FILES CHANGED:
ansible/roles/mariadb/handlers/main.yml (+1, -0)
ansible/roles/mariadb/tasks/backup.yml (+3, -1)
releasenotes/notes/switch-to-proxysql-907c2bc2f2c04de4.yaml (+15, -0)
ansible/group_vars/all.yml (+2, -1)
tests/setup_gate.sh (+4, -4)
ansible/roles/mariadb/tasks/recover_cluster.yml (+2, -2)
ansible/roles/mariadb/defaults/main.yml (+1, -1)
etc/kolla/globals.yml (+1, -1)
",-0.974609,1.481568,-0.953883,0.617992,-0.617714,0.28379,0.772795,0.311659,-0.329881,-0.035061,0.333523,-0.128342,0.112962,-0.257734,0.140106
openstack/oslo.messaging,I614280c656f7d5fe9043abee93218a9907c395ff,1,1,1.0,2.3979,0.5,1,7.8,350,0,Bug Fix,0,0,0,1,0.028571,0.6667,0,0.6667,2,1,0,0.5926,0.0,2.0,27.55,16.45,1,0,0.0,0,31.8182,0,6,0,7,0,"Fix incorrect desc of rabbit_stream_fanout option

Description of rabbit_stream_fanout option is incorrect. Actually it
reuses the description of quorum queues. So we need to fix it with a
correct stream queue description.

Closes-Bug: #2058616
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/impl_rabbit.py (+5, -5)
",-0.510838,-0.456593,-0.800142,0.479287,0.275098,0.606938,-0.513033,-0.636302,0.121149,-0.454538,0.251876,-0.229608,-0.088627,-0.208701,0.624694
openstack/kolla-ansible,I7995a0540066220feda9ef827a06b17fa960f49c,0,1,0.875,0.6931,1.0,1,9.67,249,0,Bug Fix,1,0,0,8,0.020202,0.6667,0,0.5833,1,1,0,0.7566,0.0,1.0,24.91,16.28,1,0,1.0,0,124.5,0,12,0,17,0,"CI: drop RMQ reconfigure step in queue migrations

When migrating to quorum queues, the RabbitMQ configuration itself
remains unchanged. This step can therefore be dropped.

Closes-Bug: #2058512
[SEP]
FILES CHANGED:
tests/upgrade.sh (+0, -1)
",0.48379,-1.764736,-0.547574,-0.149062,-0.436117,0.456271,-0.816143,0.125303,0.211367,-0.003952,0.147648,0.175195,-0.074409,0.026754,0.035255
openstack/kolla-ansible,I45f3f90ec1973dae92131ea16a7b248ab7a8ae69,1,1,0.8667,3.5264,0.1515,3,15.17,650,0,Bug Fix,0,0,0,90,0.025147,0.5,0,0.4333,4,2,0,0.7546,1.4109,3.33,25.96,14.42,0,0,0.0,1,19.1176,0,4,0,12,0,"Use the running MariaDB server image for backups

If the container image used by Mariabackup is different than the
one used by MariaDB server, it's possible that mariabackup and mariadb
are incompatible. This may cause backup operations to fail.

This change queries the running MariaDB server container's image and
uses it when taking a backup. If MariaDB server isn't running on the
host it falls back to the image defined in configuration.

The separate mariabackup_image, mariabackup_tag and
mariabackup_image_full variables are no longer required and have been
removed.

Closes-Bug: #2058644
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/backup.yml (+13, -1)
ansible/roles/mariadb/defaults/main.yml (+0, -4)
releasenotes/notes/bug-2058644-1db8786303234787.yaml (+15, -0)
",-2.351502,-0.454668,0.450195,0.657681,0.614771,0.028443,-0.247684,0.234756,0.067255,-0.167252,0.550212,0.306428,-0.396454,-0.103434,-0.102187
openstack/kolla-ansible,Ia81a6efc38ec2bdc1355d058c03568cf740fdac5,1,1,1.0,2.4849,0.1818,2,6.0,172,0,Bug Fix,0,0,0,2,0.045455,0.6667,0,0.6667,4,2,0,0.7553,0.994,3.0,8.05,20.18,1,0,0.0,1,14.3333,0,6,0,13,0,"Fix keystone configuration for haproxy.

* Use proper balancing mode when federation is enabled.

Closes-Bug: #2058656
[SEP]
FILES CHANGED:
ansible/roles/keystone/defaults/main.yml (+4, -2)
releasenotes/notes/bug-2058656-ad68bb260327a267.yaml (+5, -0)
",1.527319,-1.407048,-0.242734,-0.82893,-0.805967,0.474765,-0.648778,0.703309,0.139531,-0.232547,0.074928,-0.155162,0.112472,-0.480583,-0.01981
openstack/charm-ceph-mon,I0df8bc0238349b5f03179dfb8f4da95da48140c7,1,1,1.0,1.6094,0.5,1,27.0,1259,0,Bug Fix,0,0,0,11,0.023256,1.0,0,1.0,2,1,0,0.9375,0.0,2.0,36.19,15.88,1,0,0.0,0,251.8,0,18,0,20,0,"Don't expect a static job name

A job name passed via the prometheus_scrape library doesn't end up as a
static job name in the prometheus configuration file in the COS world
even though COS expects a fixed string. Practically we cannot have a
static job name like job=ceph in any of the alert rules in COS since the
charms will convert the string ""ceph"" into:

> juju_MODELNAME_ID_APPNAME_prometheus_scrape_JOBNAME(ceph)-N

Let's give up the possibility of the static job name and use ""up{}"" so
it will be annotated with the model name/ID, etc. without any specific
job related condition. It will break the alert rules when one unit have
more than one scraping endpoint because there will be no way to
distinguish multiple scraping jobs. Ceph MON only has one prometheus
endpoint for the time being so this change shouldn't cause an immediate
issue. Overall, it's not ideal but at least better than the current
status, which is an alert error out of the box.

The following alert rule:
> up{} == 0
will be converted and annotated as:
> up{juju_application=""ceph-mon"",juju_model=""ceph"",juju_model_uuid=""UUID""} == 0

Closes-Bug: #2044062

(cherry picked from commit fb3262183102171da5704868d7522290b3a9ede4)
[SEP]
FILES CHANGED:
files/prometheus_alert_rules/prometheus_alerts.yml.default (+2, -2)
",-3.194114,-0.083095,3.894602,-1.398897,0.061615,0.527771,-0.379299,-0.402871,-0.142923,-0.319396,-0.212121,0.264715,-0.276769,-0.062284,0.082838
openstack/charm-ceph-mon,I12a1bcd32be2ed8a8e5ee0e304f716f5a190bd57,1,1,1.0,3.5835,0.2,2,9.5,470,0,Bug Fix,0,0,0,12,0.025157,1.0,0,1.0,1,1,0,0.9394,0.661,1.0,32.45,12.92,1,0,0.1714,0,13.0556,0,10,0,13,0,"Fix version retrieval

During cluster deployment a situation can arise where there are
already osd relations but osds are not yet fully added to the cluster.
This can make version retrieval fail for osds. Retry version retrieval
to give the cluster a chance to settle.

Conflicts:
	src/utils.py
	tests/bundles/jammy-zed.yaml

Closes-Bug: #2058636

(cherry picked from commit 55beb2504d3ea6d7f522d8d9a46bef7d741f1edc)
[SEP]
FILES CHANGED:
src/utils.py (+25, -4)
unit_tests/test_ceph_utils.py (+3, -3)
",-2.109188,-0.58635,-0.298819,-1.18307,0.469783,-0.099593,0.441023,-0.040007,0.079914,0.143778,0.187312,-0.14219,0.11296,0.173366,-0.034091
openstack/kolla-ansible,Ied2736b891cd8c6dfcc509a8fd6b1fc8bfe21cb4,1,0,0.7326,4.5539,0.7872,10,7.5,146,0,Feature,0,0,0,86,0.031205,1.0,0,0.7326,6,2,0,0.7559,1.8824,5.4,30.02,13.67,1,0,0.0,0,1.5368,0,0,0,0,0,"common: Stop using transitional labels

Also stop using the old config name (td-agent.conf)
[SEP]
FILES CHANGED:
ansible/roles/common/templates/fluentd.conf.j2 (+0, -0)
ansible/roles/common/templates/conf/input/02-mariadb.conf.j2 (+2, -2)
ansible/roles/common/templates/conf/input/04-openstack-wsgi.conf.j2 (+1, -1)
ansible/roles/common/tasks/config.yml (+3, -54)
ansible/roles/common/templates/conf/input/03-rabbitmq.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/10-openvswitch.conf.j2 (+2, -2)
ansible/roles/common/templates/fluentd.json.j2 (+8, -11)
ansible/roles/common/templates/conf/input/05-libvirt.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/11-letsencrypt.conf.j2 (+1, -1)
ansible/roles/common/templates/conf/input/00-global.conf.j2 (+1, -1)
",1.903764,0.028486,-0.406476,0.276352,-0.237531,0.269103,0.202319,-0.481916,-0.344068,-0.380402,-0.030555,-0.034152,-0.320916,0.655021,-0.714493
openstack/charm-openstack-dashboard,Ifedf587356693b58612b1fc4d7404f0f446158ce,1,1,0,3.8918,0.0,4,6.79,876,0,Bug Fix,0,0,0,0,0.0,0.9302,0,0.0,2,2,0,1.0,1.5822,1.0,0.47,11.14,1,0,0.5625,1,17.8776,0,22,0,8,0,"Added OPENSTACK_KEYSTONE_MFA_TOTP_ENABLED to config options

Starting from Openstack Bobcat (2023.2) Multi Factor Authentication
was added for Horizon. This change introduced a new variable called
OPENSTACK_KEYSTONE_MFA_TOTP_ENABLED, which if set to True will display
a new form requesting for the user's TOTP code for MFA enabled users.

This change provides the missing OPENSTACK_KEYSTONE_MFA_TOTP_ENABLED
config option for the charm, allowing the user to enable from the
charm's configuration. If the value is set to True, the new bobcat
template will render the following values:
OPENSTACK_KEYSTONE_MFA_TOTP_ENABLED = True

AUTHENTICATION_PLUGINS = [
    'openstack_auth.plugin.totp.TotpPlugin',
    'openstack_auth.plugin.password.PasswordPlugin',
    'openstack_auth.plugin.token.TokenPlugin'
]

Closes-Bug: #2058689
[SEP]
FILES CHANGED:
hooks/horizon_contexts.py (+2, -0)
templates/bobcat/local_settings.py (+10, -0)
unit_tests/test_horizon_contexts.py (+27, -0)
config.yaml (+9, -0)
",-4.436792,2.762366,1.990194,0.564935,0.693972,0.934848,-0.820673,0.14244,0.09058,-0.286623,0.664848,0.121883,-0.346187,0.24031,0.275678
openstack/kolla-ansible,I280e2660d187d966098ae39df6392503b1aa5bdf,0,0,0.5,2.1972,0.5,1,5.89,594,0,Bug Fix,1,0,0,4,0.041237,0.0,0,0.0,1,1,0,0.7565,0.0,1.0,-14.63,13.68,1,0,1.0,0,66.0,0,0,0,0,0,"CI: fix check-failure.sh sudo missing

this produces errors itself, e.g.:

```
 for container in $failed_containers
+ docker inspect prometheus_openstack_exporter
[]
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get ""http://%2Fvar%2Frun%2Fdocker.sock/v1.45/containers/prometheus_openstack_exporter/json"": dial unix /var/run/docker.sock: connect: permission denied
```

(cherry picked from commit c508479f4421c0af5ca023d9c5787c6eb4ec83cd)
[SEP]
FILES CHANGED:
tests/check-failure.sh (+4, -4)
",-2.643724,0.232025,0.310031,-1.113436,0.740187,-0.403837,0.031058,0.086419,0.178222,-0.307352,0.069185,-0.93306,-0.288333,0.297913,-0.085339
openstack/kolla-ansible,I07058a4b30d0de1aaf8e82656024c5f6a99b290b,1,0,0.7692,1.6094,0.0,2,9.33,196,0,CI,1,0,0,26,0.013771,0.3125,0,0.2404,2,2,0,0.7546,1.0,1.5,61.4,9.45,1,1,1.0,0,39.2,0,0,0,0,0,"[CI] Force config drive for ipv6 jobs

As our CI is ipv6 only and using cirros for tests.
Therefore we need to set force_config_drive = true.
[SEP]
FILES CHANGED:
tests/templates/nova-compute-overrides.j2 (+2, -0)
tests/run.yml (+2, -0)
",-0.061143,0.058026,-0.413466,0.745301,0.485678,0.145417,-0.426122,-0.587075,-0.733862,0.184304,-0.156654,-0.401742,0.106534,-0.457494,-0.392656
openstack/oslo.log,I860abe953ce945bb5152c77a7daeb6aa1003512b,1,1,0,1.6094,0.5,1,11.33,270,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,23.64,17.47,1,0,0.0,0,54.0,0,34,0,22,0,"Fix eventlet detection

Eventlet may be installed, but not used for example projects
like octavia. Improve autodetection mechanism by trying to import
module and check if it is actually patched.

Closes-Bug: #2039346
[SEP]
FILES CHANGED:
oslo_log/log.py (+2, -2)
",0.285807,-1.659736,-0.563478,0.083183,-0.454718,-0.155885,-0.108712,-0.391328,-0.177801,0.114849,0.063449,-0.144886,0.328217,-0.128572,0.185951
openstack/kolla,I802267d848c1dee722015b0d379bd9210f6c103e,0,0,0.7356,2.4849,0.2727,1,7.0,82,0,Feature,0,0,0,87,0.030526,1.0,0,0.7356,2,1,0,0.78,0.0,2.0,54.7,8.51,0,0,0.0,0,6.8333,0,0,0,0,0,"Check if archive is tarfile
[SEP]
FILES CHANGED:
kolla/image/tasks.py (+8, -3)
",2.625384,1.776892,0.698232,1.245742,0.813269,0.805138,1.759382,-0.341687,0.614925,0.226595,0.510828,-0.228958,0.191672,0.769438,0.075987
openstack/kolla-ansible,I23525c35e3f6e4a4a611e97e01cab97750199aef,0,0,0.7273,3.9703,0.5,10,4.0,223,0,Feature,0,0,0,88,0.030758,1.0,0,0.7273,4,2,0,0.7552,2.8575,3.8,-29.87,11.6,0,0,0.0,0,4.2075,0,0,0,0,0,"Use new module names from openstack.cloud

All of them have been renamed 4 years ago [1].

https: //review.opendev.org/c/openstack/ansible-collections-openstack/+/726538
[SEP]
FILES CHANGED:
ansible/roles/magnum/tasks/register.yml (+3, -3)
ansible/library/kolla_toolbox.py (+1, -1)
ansible/roles/ceilometer/tasks/register.yml (+1, -1)
ansible/roles/octavia/tasks/register.yml (+1, -1)
ansible/roles/octavia/tasks/get_resources_info.yml (+4, -4)
ansible/roles/keystone/tasks/register.yml (+1, -1)
ansible/roles/octavia/tasks/prepare.yml (+7, -7)
ansible/roles/service-ks-register/tasks/main.yml (+6, -6)
ansible/roles/octavia/tasks/hm-interface.yml (+1, -1)
ansible/roles/swift/tasks/register.yml (+1, -1)
",-0.037112,2.329939,-1.232342,-0.001347,-1.236876,-0.095346,0.009997,-0.026697,-0.181726,-0.127269,-0.794569,-0.089007,-0.170113,0.052875,-0.069849
openstack/kolla-ansible,Ib9bdae2e25c2b6cce30e4c8024015ab5875bc1ff,1,1,0.7778,3.6636,0.6842,4,9.0,158,0,Bug Fix,0,0,0,9,0.02267,1.0,0,0.7778,4,2,0,0.7532,1.7337,2.75,37.9,12.49,1,0,0.0,1,4.0513,0,12,0,17,0,"RMQ: enable all stable feature flags at once

Also enable these after an upgrade.

Partial-Bug: #2058512
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-enable-all-feature-flags-at-once-28b76958abf54083.yaml (+8, -0)
ansible/roles/rabbitmq/tasks/feature-flags.yml (+3, -8)
ansible/rabbitmq.yml (+1, -1)
ansible/roles/rabbitmq/defaults/main.yml (+0, -17)
",2.106695,-0.879884,0.122963,-0.577778,-0.98219,0.68377,-0.532801,0.193507,0.251425,0.232864,0.175616,-0.027142,0.094171,-0.103382,0.178086
openstack/openstack-ansible-os_neutron,I882364336782078ad934e538bd8dc8d127048292,0,0,0.84,2.7081,0.5,1,12.86,647,0,Bug Fix,0,0,0,25,0.215517,0.9524,0,0.8,1,1,0,0.9333,0.0,1.0,43.39,14.03,0,0,0.0,0,43.1333,0,0,0,0,0,"Fix multiline yaml formatting in neutron systemd services

Yet more fallout from the new linter rules. When n-g-s is enabled
the previous code did not insert a space between the two instances
of --config-file.

With the >- multiline style Newlines result in a space being inserted,
and these can be suppressed with the '-' character in the jinja code.

This patch adjusts the whitespace insertion so there is always a space
between the --config-file instances, but any spaces are suppressed at
the end of the line.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/914859
[SEP]
FILES CHANGED:
vars/main.yml (+7, -7)
",-1.6909,-0.395845,1.040222,-0.087049,-0.571225,-0.245756,0.317497,-0.19954,0.216654,0.083257,0.078155,0.246924,0.018251,0.071921,-0.000477
openstack/kolla-ansible,I23f37897ea08ac708f6df485f699122df647e552,0,0,0.7191,3.6889,0.4615,8,2.8,312,0,Doc,0,0,0,89,0.030553,0.5,0,0.3596,2,1,0,0.7539,2.9648,1.5,19.69,8.26,0,0,0.9231,0,7.8,0,0,0,0,0,"tests: Replace imp with importlib.machinery

It's needed for Python3.12 support, because imp has been dropped [1].

Also shlex dropped s=None support [2].

[1]: https://docs.python.org/3/whatsnew/3.12.html
[2]: https://github.com/python/cpython/issues/94352
[SEP]
FILES CHANGED:
tests/test_fernet_rotate_cron_generator.py (+2, -2)
tests/test_kolla_container.py (+3, -3)
tests/kolla_container_tests/test_docker_worker.py (+3, -3)
tests/test_merge_yaml.py (+2, -2)
tests/kolla_container_tests/test_podman_worker.py (+3, -3)
ansible/module_utils/kolla_podman_worker.py (+2, -1)
tests/kolla_container_tests/test_systemd.py (+3, -2)
tests/test_merge_config.py (+3, -2)
",-0.816228,1.504061,-0.823978,0.238016,-1.116742,0.087289,0.074794,0.083699,-0.476144,0.9658,-0.068329,-0.655815,0.074795,0.359433,0.028197
openstack/openstack-ansible-os_horizon,I767b921dd9114fb6afa6a93d80e3927da481e5ae,1,0,1.0,1.0986,0.5,1,15.5,250,0,Feature,0,0,0,37,0.060556,0.9318,0,0.9318,1,1,0,1.0,0.0,1.0,5.53,20.39,0,0,0.0,0,83.3333,0,0,0,0,0,"Use overridable URL for github rather than hard-coding

For isolated deployments which use mirrors it is necessary
to be able to override the github.com URL currently used
in horizon_pip_packages
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",0.799571,-1.566102,0.129561,0.299099,0.038744,-0.376372,-0.236874,-0.223552,-0.401048,-0.181041,-0.796231,-0.10022,-0.287335,-0.407354,-0.062982
openstack/openstack-ansible-haproxy_server,I8f1c01385d7aca8f17cc3f49aafcf2b7269fa554,1,0,0.8571,0.6931,0.0,1,9.75,285,0,Feature,0,0,0,21,0.068627,0.0,0,0.0,1,1,0,0.9167,0.0,1.0,47.26,9.03,0,0,0.0,0,142.5,0,0,0,0,0,"Do not log content of copied static files

``haproxy_static_files`` can be used to copy static files to target
hosts. These files may contain sensitive content that should not be
logged.

This patch disables logging for this task.
[SEP]
FILES CHANGED:
tasks/haproxy_pre_install.yml (+1, -0)
",-0.108153,-0.782797,-0.524645,1.100944,0.147255,-0.087394,-0.195994,-0.426803,0.247716,-0.119855,-0.139154,-0.455804,-0.130795,-0.053583,-0.526777
openstack/openstack-ansible,Ie43e339df50adbe8240ffe43159c28f132e50000,1,0,0.8077,2.9444,0.4444,2,23.0,336,0,Feature,0,0,0,26,0.2,1.0,0,0.8077,3,1,0,0.925,0.9911,2.0,25.32,17.9,0,0,0.0,0,17.6842,0,0,0,0,0,"Define haproxy fact gathering vars at group rather than task level

Task vars are higher precedence than inventory group vars so
cannot be overidden except in user_variables (ansible extra vars)
which then become a global setting, which is almost certainly
incorrect for this case.
[SEP]
FILES CHANGED:
inventory/group_vars/haproxy/haproxy.yml (+10, -0)
playbooks/haproxy-install.yml (+0, -8)
",0.041333,-1.667427,0.020331,0.621229,0.553277,-0.236199,-0.154266,-0.816061,-0.089867,0.074278,-0.686466,-0.180772,0.100972,-0.300541,-0.245135
openstack/openstack-ansible-os_glance,Ibe3eb5d50f8e0904d73b93713dda2be0a6b38df7,1,0,0.9524,1.7918,0.2,2,6.0,264,0,Feature,0,0,0,147,0.047358,1.0,0,0.9524,1,2,0,0.8,0.971,1.0,-31.9,17.4,0,0,0.0,0,44.0,0,0,0,0,0,"Define lock directory for oslo_concurrency

With [1] it become required to define lock directory for oslo_concurrency
which was missing previously.

[1] https://review.opendev.org/c/openstack/os-brick/+/814139
[SEP]
FILES CHANGED:
tasks/glance_install.yml (+1, -1)
templates/glance-api.conf.j2 (+3, -0)
",-0.450001,2.035167,-0.782841,0.596408,-0.479611,0.168108,0.045314,-0.160344,0.0599,0.152876,-0.235254,-0.339116,-0.136914,-0.249977,-0.043297
openstack/octavia,Ia853d43dc273019c76da09104f31aa7e1b154fec,1,1,1.0,3.2958,0.0385,3,20.0,185,0,Bug Fix,0,0,0,1,0.0125,0.5,0,0.5,5,2,0,0.6006,1.1982,3.67,8.88,20.0,0,0,0.6923,1,6.8519,0,6,0,16,0,"Handle empty delay on update healthmonitor

Check that delay field is not UnsetType before further validation

Closes-Bug: #2059894
[SEP]
FILES CHANGED:
octavia/tests/functional/api/v2/test_health_monitor.py (+18, -0)
releasenotes/notes/Fix-UDP-Health-monitor-update-without-delay-c56240e59e15483f.yaml (+4, -0)
octavia/api/v2/controllers/health_monitor.py (+3, -1)
",1.417465,-1.34997,-0.481391,-0.501596,-0.097759,0.732713,-0.598988,-0.033005,0.645677,-0.465089,0.183748,-0.29722,-0.085957,-0.046117,0.170508
openstack/openstack-ansible-os_designate,I93af581696de0913710592f9033545b87547b78a,1,0,1.0,2.1972,0.125,2,15.6,511,0,Bug Fix,0,0,0,38,0.06199,1.0,0,1.0,1,1,0,1.0,0.8113,1.0,55.42,13.42,0,0,0.0,0,56.7778,0,0,0,0,0,"Fix designate upgrades when internal RPC version changes

When upgrading from 2023.1 to 2023.2 in a HA environment,
the Designate pool update command failed as it ran using
an upgraded client, but made RPC calls against instances
which had not been upgraded yet.

This commit moves the pool update to the last play host
in order to ensure that in an upgrade situation, all
virtualenvs have been upgraded first to ensure no client/
server version conflicts.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
vars/main.yml (+6, -0)
",-1.100547,-2.16,0.21881,0.63828,-0.032404,-0.021412,0.281843,0.202874,0.023164,0.507991,-0.061052,0.180002,0.021902,0.141592,0.171715
openstack/kolla-ansible,Ie5a7b2da9a351e8f47a1ae830bb2fee0a8e35e38,0,0,0.5,4.5539,0.0426,11,4.0,185,0,Feature,0,0,0,4,0.061538,0.5091,0,0.2545,4,4,0,0.7519,3.02,3.45,-107.42,21.6,0,0,0.0,1,1.9474,0,0,0,0,0,"Re-add the neutron-fwaas

neutron-fwaas has become active again

Depends-On: https://review.opendev.org/c/openstack/kolla/+/914855
[SEP]
FILES CHANGED:
ansible/roles/horizon/defaults/main.yml (+1, -0)
ansible/roles/neutron/templates/neutron-l3-agent-wrapper.sh.j2 (+5, -1)
ansible/group_vars/all.yml (+2, -0)
ansible/roles/neutron/defaults/main.yml (+6, -0)
ansible/roles/neutron/templates/neutron-server.json.j2 (+9, -1)
doc/source/reference/networking/neutron-extensions.rst (+20, -1)
ansible/roles/neutron/tasks/config.yml (+22, -0)
ansible/roles/neutron/templates/fwaas_driver.ini.j2 (+11, -0)
releasenotes/notes/re-add-neutron-fwaas-fb2211cf78ba2eb7.yaml (+5, -0)
etc/kolla/globals.yml (+2, -0)
ansible/roles/neutron/templates/neutron-l3-agent.json.j2 (+7, -1)
",0.012024,2.869993,-1.608899,0.316245,-0.921837,0.200879,0.277723,-0.424768,-0.050174,-0.920018,-0.214215,0.170599,-0.015598,-0.008298,0.097926
openstack/kolla,Id64c04ef38bd3084dec05bf58ec10b93344f68ec,0,0,0.4,2.8904,0.0,2,6.0,88,0,Feature,0,0,0,5,0.031447,0.6,0,0.24,2,2,0,0.7761,0.9975,2.0,-38.95,22.4,0,0,0.0,0,4.8889,0,0,0,0,0,"horizon/neutron: Add FWaaS plugin
[SEP]
FILES CHANGED:
kolla/common/sources.py (+8, -0)
docker/horizon/extend_start.sh (+9, -0)
",1.70359,2.102125,0.352366,0.137609,0.33533,-0.151112,0.319569,0.679835,-0.083706,-0.397686,0.147079,0.389178,-0.403286,-0.366967,0.375154
openstack/openstack-ansible-os_neutron,Ia1507f03febd5bdba18610909f5c3856976566b4,1,0,0.9527,1.0986,0.5,1,27.0,227,0,Bug Fix,0,0,0,148,0.047604,0.913,0,0.8699,1,1,0,0.875,0.0,1.0,16.5,25.61,0,0,0.0,0,75.6667,0,0,0,0,0,"Fix multiline yaml formatting in neutron systemd services

This patch adjusts the whitespace insertion so a space between the
--config-file instances is not trimmed anymore
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",1.657568,-2.088463,0.63313,-0.023905,-0.05421,-0.448984,0.366997,-0.161544,0.15546,-0.215195,-0.209372,-0.00302,-0.005733,0.070818,-0.07777
openstack/kolla-ansible,Ibdf107d27f1523d57787726685f68ff27e9db7bc,1,1,0.4,1.0986,0.5,1,4.25,232,0,Bug Fix,0,0,0,5,0.047619,1.0,0,0.4,4,1,0,0.75,0.0,4.0,-26.4,15.82,1,0,0.0,0,77.3333,0,10,0,17,0,"fix swift keystone auth url

Closes-Bug: #2060121

Bug introduced in https://review.opendev.org/c/openstack/kolla-ansible/+/843748
[SEP]
FILES CHANGED:
ansible/roles/swift/templates/proxy-server.conf.j2 (+1, -1)
",0.300845,2.501795,-1.48297,-0.882096,-1.361582,0.319926,-0.077455,0.02692,0.254421,-0.715755,-0.282753,-0.133075,-0.05573,-0.43146,0.388833
openstack/kolla-ansible,Ib0f00aadb6c7022de6e8b455ac4b9b8cd6be5b1b,0,0,1.0,7.5919,0.7314,126,11.56,1314,0,Doc,0,0,0,3,0.023622,1.0,0,1.0,4,2,0,0.7506,6.3124,3.98,57.22,11.55,1,0,0.0,1,0.663,0,0,0,0,0,"Performance: use filters for service dicts

Most roles are not leveraging the jinja filters available.
According to [1] filtering the list of services makes the execution
faster than skipping the tasks.

This patchset also includes some cosmetic changes to genconfig.
Individual services are now also using a jinja filter. This has
no impact on performance, just makes the tasks look cleaner.

Naming of some vars in genconfig was changed to ""service"" to make
the tasks more uniform as some were previously using
the service name and some were using ""service"".

Three metrics from the deployment were taken and those were
- overall deployment time [s]
- time spent on the specific role [s]
- CPU usage (measured with perf) [-]
Overall genconfig time went down on avg. from 209s to 195s
Time spent on the loadbalancer role went down on avg. from 27s to 23s
Time spent on the neutron role went down on avg from 102s to 95s
Time spent on the nova-cell role went down on avg. from 54s to 52s
Also the average CPUs utilized reported by perf went down
from 3.31 to 3.15.
For details of how this was measured see the comments in gerrit.

[1] - https://github.com/stackhpc/ansible-scaling/blob/master/doc/skip.md
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/check-containers.yml (+1, -4)
ansible/roles/letsencrypt/tasks/precheck.yml (+1, -2)
ansible/roles/opensearch/tasks/check-containers.yml (+1, -4)
ansible/roles/kuryr/tasks/check-containers.yml (+1, -4)
ansible/roles/venus/tasks/check-containers.yml (+1, -4)
ansible/roles/ovs-dpdk/tasks/check-containers.yml (+1, -4)
ansible/roles/cloudkitty/tasks/config.yml (+6, -21)
ansible/roles/openvswitch/tasks/check-containers.yml (+1, -4)
ansible/roles/barbican/tasks/config.yml (+8, -26)
ansible/roles/neutron/tasks/check-containers.yml (+1, -4)
ansible/roles/magnum/tasks/check-containers.yml (+1, -4)
ansible/roles/octavia/tasks/check-containers.yml (+1, -4)
ansible/roles/ovn-controller/tasks/check-containers.yml (+1, -4)
ansible/roles/skyline/tasks/config.yml (+9, -23)
ansible/roles/horizon/tasks/config.yml (+13, -27)
ansible/roles/letsencrypt/tasks/config.yml (+4, -14)
ansible/roles/magnum/tasks/config.yml (+5, -18)
ansible/roles/keystone/tasks/config.yml (+20, -42)
ansible/roles/blazar/tasks/check-containers.yml (+1, -4)
ansible/roles/ironic/tasks/check-containers.yml (+1, -4)
ansible/roles/ironic/tasks/config.yml (+16, -40)
ansible/roles/opensearch/tasks/config.yml (+7, -15)
ansible/roles/ceilometer/tasks/check-containers.yml (+1, -4)
ansible/roles/etcd/tasks/config.yml (+2, -8)
ansible/roles/placement/tasks/precheck.yml (+2, -3)
ansible/roles/nova/tasks/upgrade.yml (+1, -3)
ansible/roles/watcher/tasks/config.yml (+4, -15)
ansible/roles/tacker/tasks/config.yml (+4, -15)
ansible/roles/ironic/tasks/bootstrap_service.yml (+4, -6)
ansible/roles/grafana/tasks/check-containers.yml (+1, -4)
ansible/roles/multipathd/tasks/check-containers.yml (+1, -4)
ansible/roles/gnocchi/tasks/config.yml (+5, -18)
ansible/roles/telegraf/tasks/config.yml (+4, -14)
ansible/roles/neutron/tasks/config-host.yml (+2, -2)
ansible/roles/etcd/tasks/check-containers.yml (+1, -4)
ansible/roles/openvswitch/tasks/config.yml (+3, -10)
ansible/roles/designate/tasks/check-containers.yml (+1, -4)
ansible/roles/ovn-db/tasks/check-containers.yml (+1, -4)
ansible/roles/trove/tasks/config.yml (+6, -20)
ansible/roles/ovs-dpdk/tasks/config.yml (+2, -8)
ansible/roles/prometheus/tasks/config.yml (+14, -39)
ansible/roles/cyborg/tasks/config.yml (+5, -18)
ansible/roles/barbican/tasks/check-containers.yml (+1, -4)
ansible/roles/glance/tasks/external_ceph.yml (+1, -3)
ansible/roles/grafana/tasks/config.yml (+7, -22)
ansible/roles/heat/tasks/config.yml (+6, -21)
ansible/roles/gnocchi/tasks/check-containers.yml (+1, -4)
ansible/roles/iscsi/tasks/config.yml (+2, -8)
ansible/roles/iscsi/tasks/check-containers.yml (+1, -4)
ansible/roles/neutron/tasks/config.yml (+44, -97)
ansible/roles/cinder/tasks/config.yml (+9, -22)
ansible/roles/influxdb/tasks/check-containers.yml (+1, -4)
ansible/roles/glance/tasks/config.yml (+18, -35)
ansible/roles/manila/tasks/external_ceph.yml (+1, -3)
ansible/roles/placement/tasks/check-containers.yml (+1, -4)
ansible/roles/cyborg/tasks/check-containers.yml (+1, -4)
ansible/roles/masakari/tasks/config.yml (+8, -25)
ansible/roles/blazar/tasks/config.yml (+4, -15)
ansible/roles/zun/tasks/config.yml (+5, -17)
ansible/roles/loadbalancer/tasks/check-containers.yml (+1, -4)
ansible/roles/ceilometer/tasks/config.yml (+14, -42)
ansible/roles/ovn-controller/tasks/config.yml (+2, -8)
ansible/roles/redis/tasks/check-containers.yml (+1, -4)
ansible/roles/common/tasks/check-containers.yml (+1, -3)
ansible/roles/masakari/tasks/check-containers.yml (+1, -4)
ansible/roles/cinder/tasks/check-containers.yml (+1, -4)
ansible/roles/trove/tasks/check-containers.yml (+1, -4)
ansible/roles/mistral/tasks/check-containers.yml (+1, -4)
ansible/roles/nova-cell/tasks/external_ceph.yml (+4, -8)
ansible/roles/cloudkitty/tasks/check-containers.yml (+1, -4)
ansible/roles/multipathd/tasks/config.yml (+3, -11)
ansible/roles/nova/tasks/check-containers.yml (+1, -4)
releasenotes/notes/performance-improvements-42c34ebf4243312a.yaml (+13, -0)
ansible/roles/aodh/tasks/check-containers.yml (+1, -4)
ansible/roles/heat/tasks/check-containers.yml (+1, -4)
ansible/roles/nova-cell/tasks/precheck.yml (+14, -21)
ansible/roles/nova-cell/tasks/upgrade.yml (+1, -3)
ansible/roles/nova/tasks/precheck.yml (+4, -6)
ansible/roles/rabbitmq/tasks/config.yml (+8, -26)
ansible/roles/octavia/tasks/config.yml (+8, -27)
ansible/roles/common/tasks/config.yml (+2, -4)
ansible/roles/hacluster/tasks/bootstrap_service.yml (+2, -4)
ansible/roles/manila/tasks/check-containers.yml (+1, -4)
ansible/roles/watcher/tasks/check-containers.yml (+1, -4)
ansible/roles/placement/tasks/config.yml (+6, -21)
ansible/roles/designate/tasks/config.yml (+8, -26)
ansible/roles/loadbalancer/tasks/config.yml (+19, -51)
ansible/roles/venus/tasks/config.yml (+4, -14)
ansible/roles/skyline/tasks/check-containers.yml (+1, -4)
ansible/roles/influxdb/tasks/config.yml (+3, -11)
ansible/roles/mariadb/tasks/config.yml (+3, -11)
ansible/roles/nova/tasks/reload_super_conductor.yml (+1, -2)
ansible/roles/telegraf/tasks/check-containers.yml (+1, -4)
ansible/roles/mistral/tasks/config.yml (+5, -18)
ansible/roles/gnocchi/tasks/external_ceph.yml (+4, -16)
ansible/roles/letsencrypt/tasks/check-containers.yml (+1, -4)
ansible/roles/cinder/tasks/external_ceph.yml (+7, -9)
ansible/roles/kuryr/tasks/config.yml (+5, -18)
ansible/roles/mariadb/tasks/check-containers.yml (+1, -4)
ansible/roles/nova-cell/tasks/reload.yml (+1, -2)
ansible/roles/openvswitch/tasks/precheck.yml (+2, -3)
ansible/roles/memcached/tasks/check-containers.yml (+1, -3)
ansible/roles/rabbitmq/tasks/check-containers.yml (+1, -4)
ansible/roles/redis/tasks/config.yml (+3, -12)
ansible/roles/prometheus/tasks/check-containers.yml (+1, -4)
ansible/roles/neutron/tasks/rolling_upgrade.yml (+4, -4)
ansible/roles/nova-cell/tasks/config-libvirt-tls.yml (+20, -37)
ansible/roles/hacluster/tasks/config.yml (+6, -20)
ansible/roles/zun/tasks/check-containers.yml (+1, -4)
ansible/roles/collectd/tasks/check-containers.yml (+1, -4)
ansible/roles/redis/tasks/precheck.yml (+2, -3)
ansible/roles/glance/tasks/stop_service.yml (+3, -5)
ansible/roles/tacker/tasks/check-containers.yml (+1, -4)
ansible/roles/collectd/tasks/config.yml (+4, -15)
ansible/roles/glance/tasks/check-containers.yml (+1, -4)
ansible/roles/manila/tasks/config.yml (+5, -17)
ansible/roles/nova/tasks/reload_api.yml (+1, -2)
ansible/roles/aodh/tasks/config.yml (+5, -18)
ansible/roles/glance/tasks/precheck.yml (+3, -2)
ansible/roles/horizon/tasks/check-containers.yml (+7, -12)
ansible/roles/nova/tasks/config.yml (+8, -20)
ansible/roles/nova-cell/tasks/config.yml (+12, -34)
ansible/roles/keystone/tasks/check-containers.yml (+1, -4)
ansible/roles/memcached/tasks/config.yml (+1, -3)
ansible/roles/designate/tasks/backend_external.yml (+2, -6)
ansible/roles/ovn-db/tasks/config.yml (+2, -8)
",-3.234872,0.429992,3.685511,-0.60848,-0.301735,0.443031,-0.208886,-0.14039,-0.443504,0.040718,-0.472896,0.164598,0.067898,0.112785,-0.116037
openstack/kayobe,I80a7ea06620c69ff2ba2ab8fe78b990ef3c151ec,1,0,0.9216,2.5649,0.6667,1,6.5,262,0,Bug Fix,0,0,0,51,0.059719,1.0,1,0.9216,3,1,0,0.9495,0.0,3.0,-14.52,16.45,1,0,0.0,0,20.1538,0,0,0,0,0,"Fix Bifrost database backup instructions

Bifrost uses a combined Ironic service instead of API and conductor
services since the Yoga release [1].

[1] https://review.opendev.org/c/openstack/bifrost/+/820390
[SEP]
FILES CHANGED:
doc/source/administration/seed.rst (+4, -8)
",-0.580416,1.271587,-0.994636,0.42099,-0.793394,0.033572,-0.178862,0.618201,0.032883,0.038956,-0.455442,0.05145,-0.159915,-0.305808,-0.426442
openstack/ansible-role-uwsgi,Iaf295e61ad80a919fcb979ed753a0194816700f4,1,0,0.953,0.6931,0.0,1,8.0,90,0,Feature,0,0,0,149,0.047895,1.0,0,0.953,1,1,0,0,0.0,1.0,-2.21,13.2,0,0,0.0,0,45.0,0,0,0,0,0,"Add Debian 12 distro setup variable
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",2.959128,0.908821,1.75178,0.531454,1.153324,0.180668,0.816963,1.250964,0.239049,-0.004946,-0.280094,-0.390221,-0.04234,0.017597,0.077248
openstack/openstack-ansible-os_keystone,I1ebee33e3cf52cc0a9c474423a4fd5fa7f1cbe81,1,0,0.9533,2.4849,0.0,1,19.0,432,0,Bug Fix,0,0,0,150,0.048201,0.0,0,0.0,1,1,0,1.0,0.0,1.0,19.83,18.13,1,0,0.0,0,36.0,0,0,0,0,0,"Fix permissions for SSH private key for Ubuntu distro installations

Due to weird postinst logic of keystone-common package permissions
for SSH private key that is used for fernet rotation are reset to 0640 which
prevents SSH from further functioning.

We add post-package installation task that will ensure private key permissions
for Ubuntu distro installations specifically.
[SEP]
FILES CHANGED:
tasks/keystone_install.yml (+11, -0)
",-0.148046,-1.828262,0.244523,0.684796,0.247469,-0.295911,0.079184,0.207504,-0.161902,-0.046042,-0.630524,-0.024044,0.54158,-0.306209,0.078604
openstack/openstack-ansible-os_nova,I96fa921cfdb849f59b5abd8452061d4c5bd04a76,1,0,0.9536,4.1431,0.2419,2,11.25,381,0,Feature,0,0,0,151,0.048351,1.0,0,0.9536,2,2,0,1.0,0.5086,1.5,18.7,15.17,0,0,0.0,1,6.0476,0,0,0,0,0,"Ensure TLS is enabled properly for cell0 mapping DB connection

Once we've enabled TLS requirement in [1] jobs started failing on cell0
mapping as it was actually different and not connecting to MariaDB through
TLS when it was assumed it is.

[1] https://review.opendev.org/c/openstack/openstack-ansible-galera_server/+/911009
[SEP]
FILES CHANGED:
tasks/nova_db_setup.yml (+40, -15)
releasenotes/notes/update_cell0_db_tls-1d14996f697b5c68.yaml (+7, -0)
",-0.707958,0.188019,-0.126698,0.320678,-0.89007,-0.219221,0.464383,0.370274,-0.03974,0.354963,-0.184536,-0.348705,0.091617,-0.237675,0.185923
openstack/ironic,I92fd7a0009a816e93e316e4674c7509b61a474d4,1,0,0.9706,3.6636,0.3684,6,12.33,531,0,Bug Fix,0,0,0,34,0.013163,1.0,0,0.9706,5,1,0,0.9541,2.3589,3.0,33.12,12.5,1,0,0.3158,0,13.6154,0,0,0,0,0,"Fix servicing clean-up

Serious issues:
- Nothing powers on nodes after servicing, so they end up active and
  powered off in the end.
- Restoring power state was done three times.

Minor issues:
- Function _tear_down_node_servicing is called twice causing a traceback.
- Furthermore, process_event('done') is also called in another place
  in deploy utils.
- Make sure nodes are never considered for fast-track when servicing, it
  prevents clean-up of virtual media devices.
[SEP]
FILES CHANGED:
ironic/conductor/servicing.py (+0, -2)
ironic/drivers/modules/deploy_utils.py (+4, -10)
ironic/tests/unit/conductor/test_utils.py (+7, -0)
ironic/conductor/utils.py (+4, -1)
ironic/common/states.py (+5, -0)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+4, -1)
",-1.138911,-1.254808,0.605434,0.252703,-0.286462,-0.064169,-0.186645,-0.441425,-0.161036,0.142368,0.090385,-0.463325,0.606534,0.219599,0.230811
openstack/kolla,I3df4823d78474d94e138ff73f0f577bd247bdad0,0,1,0.5,3.2581,0.0,4,5.5,247,0,Bug Fix,0,0,0,6,0.056075,0.7,0,0.35,3,3,0,0.7723,1.987,2.5,5.13,20.38,1,0,0.0,0,9.5,0,12,0,6,0,"CI/Master only: pin opensearch{-dashboards}

pin opensearch and opensearch-dashboards to 2.12. for now
Closes-Bug: #2060668
Related-Bug: #2060306
[SEP]
FILES CHANGED:
docker/opensearch/opensearch-dashboards/Dockerfile.j2 (+6, -0)
docker/opensearch/opensearch/Dockerfile.j2 (+5, -0)
docker/base/apt_preferences.ubuntu (+7, -0)
docker/base/apt_preferences.debian (+7, -0)
",-0.115506,0.397645,-1.064152,-0.133579,0.4462,0.065705,-1.167323,0.374163,-0.397301,0.220438,-0.17766,0.129416,0.213926,0.316173,0.429411
openstack/kayobe,I49522dab189a9b1fb91daed34a85f4cccf654348,0,0,0.8919,0.6931,0.0,1,5.0,213,0,CI,0,0,0,37,0.034228,1.0,0,0.8919,3,1,0,0.95,0.0,3.0,-23.84,20.67,0,0,0.0,0,106.5,0,0,0,0,0,"CI: fetch Bifrost's disk-image-create log file

Followup on Iab88b3a28378cc22f767204bef84128bc9627210
[SEP]
FILES CHANGED:
roles/kayobe-diagnostics/files/get_logs.sh (+1, -0)
",0.90246,-0.582063,-1.829416,-2.066236,0.949847,0.261803,0.099299,-0.083645,0.230798,-0.506865,-0.545185,0.59741,-0.151504,0.15138,-0.114315
openstack/openstack-ansible-plugins,Ia2862e9883f1c972efdb40576e55dfe828c3a424,1,0,0.9539,0.6931,0.0,1,7.0,381,0,Feature,0,0,0,152,0.047724,0.0,0,0.0,1,1,0,1.0,0.0,1.0,-32.32,16.51,0,0,0.0,0,190.5,0,0,0,0,0,"Apply haproxy_service_configs to hosts idempotently

add_host module always returns changed state which looks like
non-idempotent behaviour, while it's expected to be changed at all times.
changed_when: false added for idempotent behaviour.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-os_nova/+/915320
[SEP]
FILES CHANGED:
playbooks/haproxy_service_config.yml (+1, -0)
",-0.98015,0.351478,-0.419651,0.112276,-0.566107,-0.414341,0.242034,-0.229121,0.06659,-0.18171,0.126611,-0.565491,0.086888,-0.285808,0.145372
openstack/kolla-ansible,I311c374b34f22c78cc5bcf91e5ce3924c62568b6,0,1,0.4286,4.5747,0.0625,7,7.75,787,1,Bug Fix,0,0,0,7,0.05303,1.0,0,0.4286,5,4,0,0.7487,2.3942,3.43,13.39,14.28,1,0,0.0,1,8.1134,0,6,0,4,0,"harden haproxy TLS configuration

harden the TLS default config according to the mozilla
""modern"" recommendation:

https://ssl-config.mozilla.org/#server=haproxy&version=2.1&config=modern&openssl=1.1.1k&guideline=5.7

if you want to revert to the old settings, set:

kolla_haproxy_ssl_settings: ""legacy"" in globals.yaml
alternatively you can also set it to ""intermediate""
for a middle ground between security and accessibility.

this also adjusts the glance and neutron tls proxy ssl settings
in their dedicated haproxy config templates to use the same mechanism.

also add some haproxy related docs to the TLS guide and cross reference
it from the haproxy-guide.

Closes-Bug: #2060787
[SEP]
FILES CHANGED:
doc/source/reference/high-availability/haproxy-guide.rst (+5, -0)
doc/source/admin/tls.rst (+26, -0)
releasenotes/notes/harden_haproxy_tls_config-6a70503d8a124b2a.yaml (+28, -0)
ansible/roles/loadbalancer/templates/haproxy/haproxy_main.cfg.j2 (+1, -2)
ansible/group_vars/all.yml (+22, -0)
ansible/roles/glance/templates/glance-tls-proxy.cfg.j2 (+4, -2)
ansible/roles/neutron/templates/neutron-tls-proxy.cfg.j2 (+4, -2)
",-2.343334,-0.286844,1.264181,-0.399212,-0.09985,-0.359218,-0.137548,0.173626,0.031052,-0.167422,-0.128246,-0.110755,-0.329026,0.1054,0.001194
openstack/charm-manila-ganesha,Id745140a316120e56948f3770f2b2473d1134255,1,1,1.0,1.0986,0.5,1,16.0,245,0,Bug Fix,0,0,0,1,0.038462,0.0,0,0.0,4,1,0,1.0,0.0,4.0,42.55,15.15,1,0,0.0,0,81.6667,0,6,0,20,0,"Fix application version on manila-ganesha charm

The charm is not using `version_package` in the class and it's
using the default to the first in packages which is Ceph.

Closes-bug: #2060751
[SEP]
FILES CHANGED:
src/lib/charm/openstack/manila_ganesha.py (+1, -1)
",1.261574,-1.850098,-0.075878,-0.486207,-0.5571,-0.0115,-0.090859,0.169949,0.104317,-0.309673,-0.125322,-0.072228,-0.414348,0.128117,0.133095
openstack/kolla,Ief7b8f2d427b2557c84fda9b3774ed85ceb105f4,0,0,0.7111,3.6889,0.4615,16,12.0,120,0,Bug Fix,0,0,0,90,0.030488,1.0,0,0.7111,5,6,0,0.7685,3.8621,1.69,32.5,18.13,1,0,0.0,1,3.0,0,0,0,0,0,"CI: Add codespell for spell checking

Fix existing spell checking
[SEP]
FILES CHANGED:
specs/template.rst (+1, -1)
docker/glance/glance-base/etc/glance/rootwrap.conf (+1, -1)
releasenotes/notes/reenable-ironic-inspector-in-bifrost.yml-5e01af1e96528c62.yaml (+1, -1)
releasenotes/notes/tacker-conductor-246d23f8c4a97de0.yaml (+1, -1)
releasenotes/notes/kolla-host-584270e3aee6dfd6.yaml (+2, -2)
.codespell-ignore (+1, -0)
releasenotes/notes/bug-1934753-98ec4951a0f7373b.yaml (+1, -1)
releasenotes/notes/fix-lock-swift-path-9b743367e4014f92.yaml (+1, -1)
docker/proxysql/kolla_extend_start (+1, -1)
specs/kolla-ceph-bluestore.rst (+1, -1)
releasenotes/notes/bug-1874298-35b7ccffe327f7e4.yaml (+1, -1)
specs/kubernetes-deployment.rst (+2, -2)
tox.ini (+2, -0)
docker/kolla-toolbox/find_disks.py (+3, -3)
releasenotes/notes/add-use-dumb-init-config-option-26b47f6d97d7585c.yaml (+1, -1)
specs/logging-with-heka.rst (+1, -1)
",1.988966,-0.588529,0.610476,-0.043018,0.364311,0.229843,-0.864019,-0.233916,0.116292,0.222846,0.088175,-0.188157,0.447861,0.199254,-0.345059
openstack/kolla,If91e0330dc149143c82d2183b8ddf6fa9f68d80e,1,1,0.7778,6.4265,0.0,3,9.33,261,0,Bug Fix,0,0,0,27,0.014271,1.0,0,0.7778,2,2,0,0.7647,0.8778,1.67,10.03,16.59,1,0,0.7455,1,0.4223,0,6,0,16,0,"Fix handling configs in base image

This commit restructures the handling of configuration
files in set_configs.py, introducing functions for managing
default configuration files first.

Closes-Bug: #2060855
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+151, -0)
tests/test_set_config.py (+460, -0)
releasenotes/notes/bug-2060855-77516da722d04761.yaml (+6, -0)
",0.576863,-1.2551,-0.113155,-0.073131,-0.163089,0.187868,-0.697617,0.188107,0.155985,-0.244036,-0.247632,-0.39846,-0.114012,0.065812,0.237382
openstack/kolla-ansible,I4c0c514bb8c05ccc5179300cd8310018e1e3ffa3,1,0,0.7033,2.1972,0.5,1,9.0,109,0,CI,1,0,0,91,0.030425,0.3529,0,0.2482,1,1,0,0.7468,0.0,1.0,9.7,25.82,0,0,1.0,0,12.1111,0,0,0,0,0,"CI: Add post-upgrade description to post-upgrade tasks
[SEP]
FILES CHANGED:
tests/run.yml (+4, -4)
",1.946905,1.184726,0.482413,1.39764,1.809841,0.114084,0.027285,-0.194028,-0.014438,0.044275,-0.094432,0.420905,0.541253,0.208971,0.009295
openstack/ironic,I502be5613ffef7c2f51eafd0a10d5e9c5d5ec2a4,1,0,0.9714,2.9957,0.2105,1,8.0,111,0,Bug Fix,0,0,0,35,0.013354,1.0,0,0.9714,3,1,0,0.9545,0.0,3.0,-76.23,23.2,1,0,0.0,0,5.55,0,0,0,0,0,"Fix get_async_step_return_state to account for servicing
[SEP]
FILES CHANGED:
ironic/drivers/modules/deploy_utils.py (+15, -4)
",1.51966,1.095875,0.882729,0.370516,0.720411,0.174594,-0.811266,-0.560199,0.500098,-0.301354,0.242938,-1.144209,-1.285051,-0.415924,0.738699
openstack/ironic,I32b5f860b5d10864ce68f8d5f1dac3f76cd158d6,1,0,0.9722,6.18,0.4813,14,16.8,587,0,Bug Fix,0,0,0,36,0.013636,1.0,0,0.9722,6,2,0,0.955,3.0246,3.36,35.69,14.34,1,0,0.251,1,1.2153,0,0,0,0,0,"Fix the confusion around service_reboot/servicing_reboot

We ended up using two names for the same flag (and forgot it in one
place completely). To not just fix the issue but also prevent it in the
future, refactor asynchronous steps handling into a new helper module
with constants and helper functions.

I've settled on servicing_reboot as opposed to service_reboot because
that's the value we currently set (but not read), so it provides
better compatibility when backporting.

Remove excessive mocking in the Redfish unit tests.
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent.py (+5, -3)
ironic/common/async_steps.py (+168, -0)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+4, -18)
ironic/conductor/cleaning.py (+7, -4)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+6, -52)
ironic/conductor/servicing.py (+6, -4)
ironic/tests/unit/drivers/modules/drac/test_management.py (+2, -7)
ironic/drivers/modules/agent_base.py (+11, -20)
ironic/drivers/modules/deploy_utils.py (+5, -80)
ironic/tests/unit/conductor/test_utils.py (+8, -8)
ironic/conductor/utils.py (+8, -23)
ironic/conductor/deployments.py (+7, -5)
releasenotes/notes/servicing-reboot-502f474a01f937a8.yaml (+5, -0)
ironic/tests/unit/conductor/test_servicing.py (+8, -8)
",-0.721715,-1.837752,0.811392,0.130848,-0.330244,-0.01574,0.415596,-0.496737,-0.420301,0.195125,0.166599,-0.389755,-0.101065,-0.317813,0.346936
openstack/kolla-ansible,I1fdcaacd4f3bee2c5a4d4e6f3b643e46793a1313,1,1,0,2.0794,0.1429,2,5.5,128,0,Bug Fix,0,0,0,0,0.0,0.25,0,0.0,4,2,0,0.7474,0.8631,3.0,-37.17,27.65,1,0,0.0,1,16.0,1,10,0,4,0,"Masakari: Fix incorrect reference to dictionary key.

Closes-Bug: #2054867
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2054867-33bf1caa05cd004d.yaml (+5, -0)
ansible/roles/masakari/tasks/config.yml (+1, -1)
",1.872578,-0.300349,-0.673243,-1.171146,-0.848959,0.939903,-0.975411,0.10336,0.463972,0.007494,0.779824,-0.100331,0.085536,-0.157105,-0.250941
openstack/kolla,Ib973325bb3ad04e1646b71595fa43903604d9b20,0,0,0.7065,1.0986,0.5,1,8.0,95,0,Feature,0,0,0,92,0.030677,0.4667,0,0.3297,2,1,0,0.7659,0.0,2.0,-2.21,23.2,0,1,0.0,0,31.6667,0,0,0,0,0,"[release] Use Caracal sources by default
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",2.030891,2.800056,1.007576,1.008663,0.545205,0.979878,0.06515,-0.017464,-0.615093,0.266179,0.788354,0.234773,0.269265,-0.585197,-1.687479
openstack/kolla-ansible,I8864e05212e0ed76ea3a0108b00ed9dd04b1a697,1,0,0.0,2.8332,0.625,2,19.67,439,0,Feature,0,0,0,1,0.005348,0.0,0,0.0,4,2,0,0.7481,0.9544,3.0,16.24,20.75,1,0,0.0,1,25.8235,0,0,0,0,0,"Patch service-cert-copy role to be used w/o HAProxy

Currently, service-cert-copy role used to copy certs and CA
into containers has 'when' statements  that check if HAProxy is
defined and enabled for the service. However, some services like
RabbitMQ, ProxySQL or Redis don't use HAProxy

This patch removes the when condition, as it is not necessary.

PartiallyImplements: mariadb-ssl
[SEP]
FILES CHANGED:
releasenotes/notes/service-cert-copy-without-haproxy-85d45834469aa9e8.yaml (+6, -0)
ansible/roles/service-cert-copy/tasks/main.yml (+0, -10)
",-0.963828,-0.818028,0.188125,0.720811,-0.15169,-0.508263,0.024494,0.309495,-0.156477,0.121066,0.28961,-0.208098,0.467296,0.087073,-0.162245
openstack/charm-neutron-api,I245cfe2f8fdb4d8ca325ade0c22771efa31b4bf2,1,1,0,1.7918,0.2,1,15.43,880,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.0,1.0,14.14,16.54,1,0,0.0,0,146.6667,0,12,0,16,0,"Enable more recent DNS extensions (dns-integration-domain-keywords)

Since yoga, there have been two ""additions"" to the DNS extensions, which
simply build on top of the older ones. By changing the DNS extension to
be the latest (dns-integration-domain-keywords), all 4 extensions will
be activated:

- dns-integration (already included)
- dns-domain-ports (the previous default extension)
- subnet-dns-publish-fixed-ip
- dns-integration-domain-keywords

These extensions are required to enable replacement of keywords in DNS
entries and allow publishing fixed IPs without restrictions [1].

I have tested this on a local cluster and confirmed that the extensions
are enabled, and allow me to make use of the two new features.

[1] https://docs.openstack.org/designate/latest/user/neutron-integration.html

Closes-Bug: #2028163
[SEP]
FILES CHANGED:
hooks/neutron_api_context.py (+4, -1)
",-2.301787,0.652895,2.085816,-0.201087,-0.113163,-0.354843,0.390842,0.154253,-0.009678,-0.446554,-0.029618,0.349071,0.221274,0.103002,0.025336
openstack/kolla-ansible,I55b612d2f5f5a3fc8d21c6d2f71d6c58d89d4e31,0,0,0.8125,3.8286,0.0,4,10.5,170,0,Feature,0,0,0,16,0.01147,0.7273,0,0.5909,4,4,0,0.7487,1.6447,3.5,47.12,15.63,1,0,0.0,1,3.6957,0,0,0,0,0,"Adds option to add extra scrape targets for node exporter

This enables you to scrape external targets more easily.
[SEP]
FILES CHANGED:
doc/source/reference/logging-and-monitoring/prometheus-guide.rst (+26, -0)
releasenotes/notes/adds-node-exporter-targets-extra-c037d4755d1002e8.yaml (+7, -0)
ansible/roles/prometheus/defaults/main.yml (+5, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+7, -0)
",1.683522,-1.185733,-0.007035,1.097052,0.282279,-0.049547,0.454482,-0.251197,-0.043896,0.260596,-0.669347,0.017096,0.180987,-0.525461,-0.569661
openstack/openstack-ansible-repo_server,I7fdb62f79590deb118ecac2aac71984bd32685f1,1,0,1.0,1.0986,0.5,1,15.83,700,0,CI,0,0,0,39,0.062802,0.0,0,0.0,1,1,0,1.0,0.0,1.0,34.03,15.6,0,0,0.0,0,233.3333,0,0,0,0,0,"Set 'Cache-Control: no-cache' in repo server response headers

Currently, when the repo server stores files like OpenStack's
upper-constraints.txt, the cache settings cause pip to cache this
file. When updating this file or experimenting with different
constraints, this cache can cause unexpected results as pip may
deploy different versions to those currently specified in the file.

This change instructs pip or other clients not to cache responses,
and matches the OpenDev origin's response headers for requirements
files.

Similar issues could apply for wheels and similar if experimental
changes are made without adjusting version numbers.
[SEP]
FILES CHANGED:
templates/openstack-slushee.vhost.j2 (+1, -1)
",-1.249512,-1.780374,0.798399,0.661702,-0.108597,-0.63267,0.140908,0.303582,0.099102,0.288238,-0.225918,-0.116855,0.266246,-0.21027,-0.312951
openstack/openstack-ansible-rabbitmq_server,Ia0a26fdfdfa09088c921f1530d4ac020b2bec290,1,0,1.0,1.0986,0.5,1,12.18,882,0,Bug Fix,0,0,0,40,0.064205,0.9333,0,0.9333,1,1,0,0.8,0.0,1.0,51.16,11.74,1,0,0.0,0,294.0,0,0,0,0,0,"Adjust legacy OpenStack HA policy to make reply queues HA

Changes in oslo.messaging for 2023.1 exposed a known race
condition in RabbitMQ when dealing with non-HA classic queues.
When a RMQ cluster member is taken down, clients failing over
to other members may erroneously be told a queue exists when it
is in the process of being deleted. This can cause them to
permanently sit waiting for messages from a queue that no longer
exists until their services are restarted.

Making the reply queues HA resolves this issue, at the expense
of a x3 increase in reply queues across the cluster. My
assumption is that reply queues were previously excluded from HA
policy as a performance gain given their link to the number of
compute nodes in an OpenStack deployment.

Context: https://bugs.launchpad.net/oslo.messaging/+bug/2031512
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",-1.942453,-0.898347,1.795585,-0.003841,-0.528567,-0.001494,0.385322,0.193376,0.31182,0.001951,-0.086524,0.323427,0.056773,-0.442599,0.223336
openstack/openstack-ansible-rabbitmq_server,I956abe68d4d7921a4e87ae5a7694d49546bdde94,1,0,1.0,2.3026,1.0,1,21.0,668,0,CI,0,0,0,41,0.0656,1.0,0,1.0,1,1,0,0.8182,0.0,1.0,37.27,15.26,1,0,0.0,0,66.8,0,0,0,0,0,"Remove RabbitMQ restart when changing policy

My assumption is that this restart only exists for historical
reasons or in order to force client re-connection and
re-definition of queues to match this policy.

Unfortunately the current task only executes on a single RabbitMQ
node when part of a cluster, so it is ineffective in forcing
reconnection. From a brief review at least when shifting from
non-HA to HA this also isn't required as queues are immediately
updated to reflect the new policy.

Given no clear reason for the task to be present, I'm removing
it ahead of making changes to the default HA policy.
[SEP]
FILES CHANGED:
tasks/rabbitmq_post_install.yml (+0, -9)
",-1.025546,-1.936374,1.015768,0.57443,-0.5733,0.191401,0.576621,-0.338017,0.139185,0.218712,0.168736,0.320849,-0.046212,-0.133484,0.119664
openstack/openstack-ansible,Iee6b5f8cc1ad04988c8634f8b6e026e2f8c75b52,1,0,1.0,2.3026,0.1111,2,10.38,968,0,Bug Fix,0,0,0,42,0.066246,1.0,0,1.0,3,2,0,0.9259,0.7642,2.5,43.39,10.97,1,0,0.0,1,96.8,0,0,0,0,0,"Adjust RabbitMQ HA policy to make reply queues HA

Changes in oslo.messaging for 2023.1 exposed a known race
condition in RabbitMQ when dealing with non-HA classic queues.
When a RMQ cluster member is taken down, clients failing over
to other members may erroneously be told a queue exists when it
is in the process of being deleted. This can cause them to
permanently sit waiting for messages from a queue that no longer
exists until their services are restarted.

Making the reply queues HA resolves this issue, at the expense
of a x3 increase in reply queues across the cluster. My
assumption is that reply queues were previously excluded from HA
policy as a performance gain given their link to the number of
compute nodes in an OpenStack deployment.

Context: https://bugs.launchpad.net/oslo.messaging/+bug/2031512

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/916042
[SEP]
FILES CHANGED:
inventory/group_vars/all/infra.yml (+1, -1)
releasenotes/notes/rmq-ha-reply-queue-policy-95a8fd54561fc9cd.yaml (+7, -0)
",-2.527999,0.118189,2.332015,-0.391973,-0.727518,0.004237,0.333231,0.160295,0.280992,-0.16802,-0.13637,0.303011,0.045878,-0.40651,0.237447
openstack/charm-ceph-mon,Ib735bd4876b6909762288b97857bccaa597c2b80,1,1,0,3.8067,0.0,3,6.17,298,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,2,0,0.9412,0.8315,1.0,63.39,8.95,1,0,0.8182,1,6.6222,0,6,0,7,0,"Add ipv6 bind flags

Following https://tracker.ceph.com/issues/52867 we need to tell ceph
which address family to use via the ms_bind_ipv4/6 config flags.
I added them to the ceph.conf template and updated the config hook.
Closes-Bug: #2056337
[SEP]
FILES CHANGED:
src/ceph_hooks.py (+2, -0)
unit_tests/test_ceph_hooks.py (+36, -0)
templates/ceph.conf (+6, -0)
",-0.172766,0.085511,-0.94374,0.039585,-0.578829,-0.064262,-0.151851,0.001358,0.081541,-0.220183,-0.066288,-0.552954,-0.104148,0.030894,0.16184
openstack/kolla,I2caf2c972cd0283889fadde01bdd6a53e5f66ed9,0,0,0.6989,3.3322,0.5556,3,7.2,274,0,Feature,0,0,0,93,0.03099,0.5385,0,0.3763,2,2,0,0.7621,1.0811,1.67,39.73,11.77,0,0,0.0,1,9.7857,0,0,0,0,0,"kolla-toolbox: Use py311 on rpm distros

ansible-core 2.16 requires py3.10+ on the host running
ansible-playbook - let's use Python 3.11 on RPM distros
to have the same version of ansible-core used on all
distributions.
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-core-2_16-toolbox-8cec8f56e022731b.yaml (+1, -2)
docker/macros.j2 (+2, -2)
docker/kolla-toolbox/Dockerfile.j2 (+9, -11)
",0.099291,-0.13347,-0.622351,0.413879,0.176911,-0.917491,0.078717,0.330148,-0.757501,0.032703,-0.305021,0.146203,-0.066047,0.157701,0.315471
openstack/kayobe,I4901294c8f5912cb35df3866ed13012461b4f644,1,0,0.8684,2.0794,0.1429,2,3.23,614,0,Bug Fix,0,0,0,38,0.03512,1.0,0,0.8684,4,2,0,0.9406,0.8631,3.0,-92.54,13.67,1,0,0.0,1,76.75,0,0,0,0,0,"Fix default place for Ubuntu Apt keyrings

The Ansible openstack.kolla collection already uses [1,2]
the recommended location [3] for the Ubuntu Apt keyrings,
so lets fix this in Kayobe too.

[1] https://opendev.org/openstack/ansible-collection-kolla/src/branch/master/roles/docker/tasks/repo-Debian.yml#L21
[2] https://opendev.org/openstack/ansible-collection-kolla/src/branch/master/roles/podman_sdk/tasks/main.yml#L13
[3] https://manpages.ubuntu.com/manpages/jammy/en/man8/apt-key.8.html#deprecation
[SEP]
FILES CHANGED:
ansible/roles/apt/defaults/main.yml (+1, -1)
releasenotes/notes/fix-apt-keyrings-location-28ea144738de54a7.yaml (+5, -0)
",-3.200826,3.708304,0.363458,0.135929,-0.310451,-0.578208,0.674053,0.481097,-0.062942,-0.320087,-0.050744,-0.157941,-0.315545,-0.072872,-0.170286
openstack/ansible-collection-kolla,Ic3dd0ce30a8436406a451276bbd94cb5f6f33f9d,0,0,0.8718,4.8828,0.2519,7,4.14,608,0,Feature,0,0,0,39,0.035813,1.0,0,0.8718,3,2,0,1.0,1.8571,2.86,-10.33,11.31,1,0,0.0,1,4.6061,0,0,0,0,0,"Use deb822 format for Apt repositories on Ubuntu and drop apt-key

Use the modern deb822 format [1] for Apt repositories on Ubuntu the
same way as in OpenStack Kolla projects, for example in Kayobe [2].
Also this change refactor usage of the deprecated [3] apt-key tool.

[1] https://manpages.ubuntu.com/manpages/jammy/en/man5/sources.list.5.html#deb822-style%20format
[2] I3f821937b0930a0ac9341178de7ae5123d82b957
[3] https://manpages.ubuntu.com/manpages/jammy/en/man8/apt-key.8.html#deprecation
[SEP]
FILES CHANGED:
releasenotes/notes/fix-apt-repositories-and-drop-apt-key-ff4c062f5689c91e.yaml (+5, -0)
roles/baremetal/defaults/main.yml (+0, -1)
roles/podman_sdk/tasks/main.yml (+23, -7)
roles/docker/defaults/main.yml (+0, -1)
roles/baremetal/tasks/configure-ceph-for-zun.yml (+42, -16)
roles/podman_sdk/defaults/main.yml (+0, -1)
roles/docker/tasks/repo-Debian.yml (+28, -7)
",-3.489216,2.196463,0.890911,-1.118584,0.45789,0.012329,0.748219,0.241252,-0.072344,0.253766,-0.025752,-0.016477,0.052779,-0.128549,-0.318485
openstack/ansible-collection-kolla,If1ebf6a1dded1f884af2e94a714854a0523eeb67,1,0,0.0,4.1744,0.0,3,5.0,375,0,Doc,0,0,0,4,0.003103,0.0,0,0.0,3,2,0,0.75,1.2244,3.0,-16.08,11.0,0,0,0.0,0,5.7692,0,0,0,0,0,"Adding osbpo repository to docker

To install docker version of 6.0.0 on Debian we need to
add osbpo repository and store docker package there. This
is needed for the patchset refactoring docker worker:
 https://review.opendev.org/c/openstack/kolla-ansible/+/908295
[SEP]
FILES CHANGED:
roles/docker_sdk/tasks/main.yml (+32, -0)
roles/docker_sdk/defaults/main.yml (+3, -0)
roles/docker_sdk/templates/osbpo_pubkey.gpg.j2 (+29, -0)
",-0.55191,0.55896,-0.953622,0.260271,-0.664442,-0.631237,0.479973,0.398935,-0.295912,0.221979,-0.480412,-0.274676,0.082199,0.000544,0.093928
openstack/charm-ceph-radosgw,I63c21a0b545bb456df9b09d8c16cc43cd7eec2f3,1,1,0,2.3979,0.4,1,11.8,1073,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,0.9286,0.0,1.0,2.72,17.6,1,0,0.0,0,97.5455,0,30,0,5,0,"Fix scale-out in the multi-site replication scenario

If the multi-site relation is established, the `ceph-radosgw` application
cannot be scaled out.

This is happening because the multi-site functions are part of
`check_optional_config_and_relations`, which is called by `assess_status`
after every successful hook in the main hook entrypoint:
```
if __name__ == '__main__':
    try:
        hooks.execute(sys.argv)
    except UnregisteredHookError as e:
        log('Unknown hook {} - skipping.'.format(e))
    except ValueError as e:
        # Handle any invalid configuration values
        status_set(WORKLOAD_STATES.BLOCKED, str(e))
    else:
        assess_status(CONFIGS)
```

The multi-site functions (for example: `is_multisite_configured` or
`check_cluster_has_buckets`) will fail since the unit is not be ready
for service.

This change ensures that the unit is ready for service before calling
any multi-site functions.

Closes-Bug: #2062405
[SEP]
FILES CHANGED:
hooks/utils.py (+6, -4)
",-3.737548,0.926866,3.317154,-1.025838,-0.11918,0.65467,-1.314876,-0.627,0.043128,-0.397712,-0.076753,-0.325404,-0.118314,0.338487,-0.141181
openstack/kolla-ansible,Ifb44a437b96c0c029210b1491ee6c6403ee9e6fb,0,0,0.8681,2.6391,0.4615,3,8.0,188,0,CI,0,1,0,91,0.025194,0.4286,0,0.3721,4,2,0,0.7468,1.4605,2.0,-18.07,18.2,1,0,0.0,1,13.4286,0,0,0,0,0,"Revert ""Deprecate Masakari""

This reverts commit 9675347fecd2907e7f60e84e405abcedf426b229.

Reason for revert: Masakari CI is working
[SEP]
FILES CHANGED:
doc/source/reference/compute/masakari-guide.rst (+0, -5)
releasenotes/notes/dedeprecate-masakari-52e3979f563db779.yaml (+6, -0)
README.rst (+1, -1)
",0.532871,0.162007,-2.07143,-1.688225,0.848288,1.033891,0.425545,-0.359597,0.070775,-0.211329,0.20415,0.639327,-0.548561,-0.131763,-0.208457
openstack/kolla-ansible,I47157973a8152154a264cc1914b6d2b55bc08cd1,1,0,0.375,1.0986,0.5,1,5.6,361,0,CI,1,0,0,8,0.035088,0.0,0,0.0,1,1,0,0.7449,0.0,1.0,-34.52,10.81,1,0,1.0,0,120.3333,0,0,0,0,0,"CI: increase timeout for server resize confirmation

double the timeout from 5 to 10 seconds.
this should prevent errors like these:

https://zuul.opendev.org/t/openstack/build/547464fe844e4e8ba34faac33f615c92/log/primary/logs/ansible/test-core-openstack#1210
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+1, -1)
",-1.534081,2.27239,-1.681334,-0.232924,-0.029197,-0.291869,0.859756,-0.309824,0.449169,0.107313,-0.698376,-0.459478,0.477065,0.067894,0.064548
openstack/kolla,I0b20d82a0061062f8aa9dfe179b1d02708ad610e,0,0,0.9286,3.6109,0.0833,2,3.0,158,0,Feature,0,0,0,14,0.091503,1.0,0,0.9286,3,2,0,0.7585,0.5033,2.5,-97.01,18.98,1,0,0.0,1,4.2703,0,0,0,0,0,"Add Let's Encrypt EAB support

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/935656
[SEP]
FILES CHANGED:
docker/letsencrypt/letsencrypt-lego/letsencrypt-certificates.sh (+29, -3)
releasenotes/notes/add-letsencrypt-eab-support-0ec1a60f1602662e.yaml (+4, -0)
",0.45057,4.188944,-1.654884,-0.113084,-1.355418,0.479239,0.32824,-0.403935,0.066476,-0.800671,-0.364066,0.224695,0.101023,-0.496588,-0.043605
openstack/ironic,I88b56ae26d9f1d8642ed6ffc5c055f8d56f6939a,1,0,1.0,3.6889,0.0513,3,10.0,172,0,Bug Fix,0,0,0,5,0.04717,1.0,0,1.0,6,2,0,0.9554,1.4196,4.0,23.26,16.0,1,0,0.5385,1,4.3,0,0,0,0,0,"Fix attach/detach vmedia redfish implementation

We need to map with virtual media devices and not boot
devices only.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/management.py (+10, -2)
releasenotes/notes/fix-redfish-advmedia-part02-67ac1b22153ff1cf.yaml (+6, -0)
ironic/tests/unit/drivers/modules/redfish/test_management.py (+21, -0)
",1.858117,-1.282669,0.321404,0.196354,0.277408,-0.397065,0.334373,0.106854,-0.61492,-0.467047,-0.539629,-0.242,0.227314,-0.103809,-0.351622
openstack/openstack-ansible,I0acd3a14faf57d6c1bd64af9f36105df8b27b714,1,0,0.9542,2.3979,0.1,2,32.5,446,0,CI,0,0,0,153,0.048023,1.0,0,0.9542,2,2,0,0.9268,0.7219,1.5,33.28,20.38,0,0,0.0,1,40.5455,0,0,0,0,0,"Better check if we're in CI during collection bootstrap

Current behaviour may treat git+file combination as one being Zuul-treated
as when zuul_src_path is an empty string, path is still be located
and added as `zuul_item` while deployer might want it to be as local git
repo.

This patch adds another verification to ensure zuul_src_path
is defined and we're in CI before doing adjustments
[SEP]
FILES CHANGED:
scripts/get-ansible-collection-requirements.yml (+1, -1)
releasenotes/notes/bootstrap_collections_file_git-3e61f6c33cfc96f6.yaml (+8, -0)
",-0.081082,-1.704337,0.394022,0.237895,0.03076,-0.553446,0.383344,-0.226564,-0.245315,-0.155525,-0.133263,-0.430643,-0.066267,0.316879,-0.129836
openstack/kolla,I799d6bf7a381c377dee565c13b1732f7313520f4,0,0,0.6915,4.8598,0.4453,28,6.0,75,0,CI,0,0,0,94,0.031044,1.0,0,0.6915,2,2,0,0.7548,4.6796,1.93,31.55,15.73,0,0,0.0,1,0.5814,0,0,0,0,0,"CI: Add reno linting
[SEP]
FILES CHANGED:
releasenotes/notes/add-monasca-grafana-app-ea24f8ca43fa9c7d.yaml (+2, -1)
releasenotes/notes/ironic_syslinux-70eac225d227dc2e.yaml (+2, -1)
releasenotes/notes/remove-glance-registry-4a5c3d54440f7c28.yaml (+2, -1)
releasenotes/notes/bug-1814552-a037354969dcf7e5.yaml (+2, -2)
releasenotes/notes/fix-grafana-opensearch-datasource-96dc8061d9721af3.yaml (+2, -2)
releasenotes/notes/octavia-driver-agent-83ee17b82c577e95.yaml (+2, -2)
releasenotes/notes/add-ironic-prometheus-exporter-c793478ee5938bee.yaml (+2, -2)
releasenotes/notes/deprecate-kubernetes-dbabf9f86c15a0ee.yaml (+2, -2)
releasenotes/notes/upgrade-pip-44352805d60bbf7f.yaml (+2, -2)
releasenotes/notes/add-networking-ansible-b27128f544f300e6.yaml (+4, -3)
releasenotes/notes/support-image-cross-compile-3b1dc348d742e96d.yaml (+2, -2)
releasenotes/notes/deprecate-opendaylight-58b3e9dbdc359688.yaml (+2, -2)
releasenotes/notes/generic-customisation-b2d431caa2fc5c10.yaml (+2, -2)
releasenotes/notes/bug-1859047-d41762357da8ae0b.yaml (+2, -2)
releasenotes/notes/remove-zaqar-image-de36960a88f132c8.yaml (+2, -1)
releasenotes/notes/prometheus-containers-1599a6417cc6a264.yaml (+3, -3)
releasenotes/notes/remove-fwaas-deployment-8381b454528bdae9.yaml (+2, -2)
releasenotes/notes/remove-neutron-vpnaas-agent-216810affb495ad0.yaml (+7, -6)
releasenotes/notes/bug-2062572-c55c71e1045a863f.yaml (+4, -1)
releasenotes/notes/vitrage-containers-3bfb360357aa628b.yaml (+4, -4)
releasenotes/notes/drop-pyhton-3-6-and-3-7-6cc88979aad423e8.yaml (+2, -2)
releasenotes/notes/fix_rsync_rpm_swift_base_missing-9d106d94b52d0bad.yaml (+2, -1)
releasenotes/notes/add-designate-c789e47f8ced394d.yaml (+2, -1)
releasenotes/notes/summary-json-file-96441e67076fc480.yaml (+2, -2)
releasenotes/notes/remove-prometheus-haproxy-exporter-22d5af88af7e4a9d.yaml (+4, -4)
tox.ini (+2, -0)
releasenotes/notes/add-use-dumb-init-config-option-26b47f6d97d7585c.yaml (+3, -2)
releasenotes/notes/bug-1946801-5f3af3c44e567fcf.yaml (+2, -2)
",3.138766,1.413996,1.370769,0.186453,0.384177,0.588958,-0.375936,-0.429588,-0.082165,0.378193,0.151382,-0.432577,0.457208,-0.558662,0.061517
openstack/kolla,I472845503634900114d0f7aa96229e699f74d97e,1,0,0.9231,1.7918,0.4,1,11.0,104,0,Feature,0,0,0,52,0.060046,0.0,1,0.0,3,1,0,0.7512,0.0,3.0,57.23,11.67,1,0,0.0,0,17.3333,0,0,0,0,0,"Replace meeting time by link to the meetings page
[SEP]
FILES CHANGED:
doc/source/contributor/meeting.rst (+3, -2)
",2.212645,1.266464,1.578732,1.177629,0.259544,0.980781,1.055808,-0.317486,0.740028,-0.068422,0.037384,0.108973,-0.246655,0.281255,-0.201386
openstack/kolla-ansible,I3bc15b78549f033623d6ffba42ab833881171424,1,0,0.9245,1.6094,0.5,1,12.0,194,0,Feature,0,0,0,53,0.06085,0.0,1,0.0,3,1,0,0.7456,0.0,3.0,50.13,13.13,1,0,0.0,0,38.8,0,0,0,0,0,"Replace meeting time by link to the meetings page

This avoids presenting outdated information since the meeting time
changes twice a year.
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+2, -2)
",1.555874,-1.137278,0.604003,0.631997,-0.566914,0.907691,1.022931,-0.573399,0.131139,-0.128767,0.178422,0.211558,-0.21901,0.272798,-0.061093
openstack/charm-gnocchi,I048921beb6aaa66563d83253efb6152caa315ba9,1,1,0,1.9459,0.0,1,18.67,384,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,1.0,0.0,4.0,41.35,14.61,1,0,0.0,0,54.8571,0,16,0,46,0,"Update package version codenames

Codenames stopped at Train so this fills gap
all the way to Caracal as well as accounting
for releases that share the version. Where more
than one release shares the same version we set
the highest release as the named release for that
version to avoid unnecessary upgrades.

Closes-Bug: #1973303
[SEP]
FILES CHANGED:
src/lib/charm/openstack/gnocchi.py (+6, -0)
",0.012738,-1.699914,-0.109905,0.248221,-0.152047,0.312127,0.161827,-0.282356,-0.005463,-0.003329,-0.061145,0.090144,0.10648,0.24654,0.147848
openstack/charm-ceph-osd,I4b5346e86e96af493b9652fe81481c9cfabb9e49,1,0,0.9667,6.2615,0.979,7,5.0,78,0,Feature,0,0,0,30,0.004476,1.0,0,0.9667,2,2,0,0.8667,1.3422,1.0,-85.88,34.0,0,0,0.9809,1,0.1489,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -1)
tests/bundles/lunar-antelope.yaml (+0, -247)
.gitreview (+2, -0)
charmcraft.yaml (+0, -6)
tests/bundles/mantic-bobcat.yaml (+0, -247)
metadata.yaml (+0, -2)
tests/bundles/jammy-bobcat.yaml (+9, -9)
",3.63826,2.404005,1.787508,0.260121,0.681316,0.639053,0.619966,-0.356826,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/openstack-ansible-os_neutron,Id459831d936a60843a2c07d79c97a1b6aeaa6126,1,0,0,0.6931,0.0,1,12.67,374,0,CI,0,0,0,0,0.0,1.0,0,0.0,1,1,0,0.8824,0.0,1.0,6.97,14.54,0,0,0.0,0,187.0,0,0,0,0,0,"Add debian package libstrongswan-standard-plugins

The package provides the following plugins for strongSwan.

 - agent (RSA/ECDSA private key backend connecting to SSH-Agent)
 - gcm (GCM cipher mode wrapper)
 - openssl (Crypto backend based on OpenSSL, provides
   RSA/ECDSA/DH/ECDH/ciphers/hashers/HMAC/X.509/CRL/RNG)
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",-0.973829,0.535895,-0.395867,0.422309,0.301474,-0.715794,0.273226,1.584147,-0.203023,-0.172863,-0.283486,-0.296292,0.745772,0.100281,-0.330655
openstack/charm-ceph-radosgw,Iea235f5b792202f2674b0d856481887a78375fe5,1,0,0.9677,5.6058,0.797,16,5.0,78,0,Feature,0,0,0,31,0.004291,1.0,0,0.9677,2,2,0,0.9333,2.9896,1.44,-18.2,34.0,0,0,0.8635,1,0.2868,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/bundles/focal-yoga-multisite.yaml (+4, -4)
tests/bundles/jammy-bobcat-namespaced.yaml (+6, -6)
osci.yaml (+0, -27)
tests/bundles/jammy-bobcat-multisite.yaml (+4, -4)
.gitreview (+2, -0)
tests/bundles/focal-yoga.yaml (+7, -7)
tests/bundles/jammy-bobcat.yaml (+6, -6)
tests/tests.yaml (+0, -6)
tests/bundles/jammy-antelope-multisite.yaml (+4, -4)
tests/bundles/focal-yoga-namespaced.yaml (+7, -7)
tests/bundles/jammy-antelope.yaml (+4, -4)
charmcraft.yaml (+0, -6)
tests/bundles/jammy-antelope-namespaced.yaml (+8, -7)
tests/bundles/local-jammy-antelope.yaml (+3, -3)
tests/bundles/mantic-bobcat.yaml (+0, -123)
metadata.yaml (+0, -2)
",3.638262,2.404005,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/charm-ceph-mon,I9da89928e100e5002d36541d8283462651c3e792,1,0,0.9688,3.5553,0.6176,5,5.0,78,0,Feature,0,0,0,32,0.004269,1.0,0,0.9688,2,2,0,0.9429,1.7138,0.6,-52.04,34.0,0,0,0.6176,1,2.2286,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -1)
.gitreview (+2, -1)
charmcraft.yaml (+0, -6)
metadata.yaml (+1, -3)
tests/bundles/jammy-bobcat.yaml (+10, -10)
",3.638262,2.404005,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/charm-ceph-dashboard,I692270b2427a7f892d2893b4ecd268231c71f5cb,1,0,0.9697,5.9162,0.9703,9,5.0,78,0,Feature,0,0,0,33,0.004382,1.0,0,0.9697,2,2,0,0.8571,2.0364,1.22,-18.2,34.0,0,0,0.973,1,0.2102,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -2)
tests/bundles/lunar-antelope.yaml (+0, -114)
.gitreview (+2, -0)
tests/bundles/focal.yaml (+0, -114)
tests/bundles/jammy-antelope.yaml (+2, -2)
charmcraft.yaml (+0, -6)
tests/bundles/mantic-bobcat.yaml (+0, -112)
metadata.yaml (+0, -2)
tests/bundles/jammy-bobcat.yaml (+7, -7)
",3.638262,2.404005,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/charm-ceph-rbd-mirror,I2d2d647185ffb496cdcac79ad0f292926433bdba,1,0,0.9706,6.5848,0.9723,10,5.0,78,0,Feature,0,0,0,34,0.004304,1.0,0,0.9706,3,2,0,1.0,1.9869,2.1,-35.12,34.0,0,0,0.9848,1,0.1077,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
src/tests/bundles/focal-yoga.yaml (+5, -5)
src/tests/bundles/lunar-antelope.yaml (+0, -246)
src/tests/bundles/jammy-bobcat.yaml (+9, -9)
src/tests/bundles/jammy-yoga.yaml (+0, -186)
.gitreview (+2, -0)
charmcraft.yaml (+0, -7)
src/tests/bundles/mantic-bobcat.yaml (+0, -242)
src/metadata.yaml (+0, -2)
src/tests/tests.yaml (+0, -2)
src/tests/bundles/jammy-antelope.yaml (+4, -4)
",3.638262,2.404005,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/kolla,Id6e4bbe0aab2360c4e7e5f74fff6170bcc71080b,1,1,0.85,1.9459,0.0,2,10.0,238,0,Bug Fix,0,0,0,40,0.032787,0.5,0,0.425,3,2,0,0.7524,0.65,2.5,10.56,16.0,1,0,0.0,1,34.0,0,6,0,18,0,"swift-base: fix rsync missing for rpm installs

Closes-Bug: 2062072

(cherry picked from commit 7766abb4398d13355a3f76bc1b91f6c92d36111b)
[SEP]
FILES CHANGED:
releasenotes/notes/fix_rsync_rpm_swift_base_missing-9d106d94b52d0bad.yaml (+5, -0)
docker/swift/swift-base/Dockerfile.j2 (+1, -0)
",0.203039,0.022946,-2.122298,-2.217682,0.927015,0.209023,0.250637,-0.372981,0.071825,-0.006766,-0.352766,0.026086,0.259459,0.041199,0.009769
openstack/kolla,Id6e4bbe0aab2360c4e7e5f74fff6170bcc71080b,1,1,0.8537,1.9459,0.0,2,10.0,238,0,Bug Fix,0,0,0,41,0.033442,0.6667,0,0.5691,3,2,0,0.7536,0.65,2.5,10.56,16.0,1,0,0.0,1,34.0,0,6,0,18,0,"swift-base: fix rsync missing for rpm installs

Closes-Bug: 2062072

(cherry picked from commit 7766abb4398d13355a3f76bc1b91f6c92d36111b)
[SEP]
FILES CHANGED:
releasenotes/notes/fix_rsync_rpm_swift_base_missing-9d106d94b52d0bad.yaml (+5, -0)
docker/swift/swift-base/Dockerfile.j2 (+1, -0)
",0.203039,0.022946,-2.122298,-2.217682,0.927015,0.209023,0.250637,-0.372981,0.071825,-0.006766,-0.352766,0.026086,0.259459,0.041199,0.009769
openstack/charm-ceph-fs,I42c2d5ee5c2795bb7025be25b3301668a8425f7a,1,0,0.9714,5.3132,0.9604,12,5.0,78,0,Feature,0,0,0,35,0.004059,1.0,0,0.9714,3,2,0,1.0,2.6419,2.0,-52.04,34.0,0,0,0.9406,1,0.3842,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
src/tests/bundles/lunar-antelope.yaml (+0, -44)
osci.yaml (+0, -2)
.gitreview (+2, -0)
src/tests/bundles/focal-xena.yaml (+0, -45)
src/metadata.yaml (+0, -2)
src/tests/tests.yaml (+0, -1)
src/tests/bundles/focal-yoga.yaml (+2, -2)
src/tests/bundles/jammy-bobcat.yaml (+2, -2)
src/tests/bundles/jammy-yoga.yaml (+0, -44)
charmcraft.yaml (+0, -6)
src/tests/bundles/mantic-bobcat.yaml (+0, -44)
src/tests/bundles/jammy-antelope.yaml (+2, -2)
",3.63826,2.404005,1.787508,0.260121,0.681316,0.639053,0.619966,-0.356826,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/kolla-ansible,I541f704bfa2e98068096331afbdb591659cbc40b,0,0,0.6842,5.0239,0.0132,30,16.22,2003,0,CI,0,0,0,95,0.030101,1.0,0,0.6842,4,3,0,0.7462,4.7311,3.87,31.31,15.67,1,0,0.0,1,13.1776,0,0,0,0,0,"rabbitmq: Add support for using stream queues for fanout

The global configuration of rabbit_qos_prefetch_count = 1
in oslo.messaging is a deliberate choice that balances
compatibility, fairness, and reliability across all
OpenStack services.

While some services (particularly those using quorum queues)
could theoretically benefit from a higher or even unlimited
prefetch count for performance reasons, this is not universally
safe. Specifically, RabbitMQ stream queues - which are used in
certain OpenStack components do not support a prefetch_count of
0. Setting this value to 0 would result in runtime errors
or stalls, as the stream protocol requires a positive credit
window to function properly. Oslo.messaging enforces this by
raising an error if prefetch_count = 0 is set while using stream
queues.

A value of 1 is the lowest legal and universally compatible
setting. It works safely with both stream and quorum queues.
It also improves fairness in message distribution across worker
processes. In distributed services like Nova, Neutron, or
Cinder, this helps avoid uneven load where one worker might
prefetch many messages while others remain idle.
A low prefetch count ensures that messages are pulled only
when the worker is ready, promoting better load balancing and
more predictable performance.

Although a higher prefetch value could increase throughput in
certain scenarios, it comes at the cost of memory usage, risk
of overloading specific nodes, and potential starvation of
others. Until oslo.messaging supports queue-type-specific or
per-service tuning, the value of 1 remains the safest and
most predictable option that works well in mixed OpenStack
environments.

In summary, rabbit_qos_prefetch_count = 1 is not about
optimizing raw throughput for any one service, but about
ensuring stable, fair, and reliable behavior across all
services that rely on oslo.messaging, regardless of the queue
type or broker backend used.
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+4, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+4, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+4, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+4, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+4, -0)
ansible/roles/heat/templates/heat.conf.j2 (+4, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+4, -0)
ansible/roles/designate/templates/designate.conf.j2 (+4, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+4, -0)
ansible/roles/nova/templates/nova.conf.j2 (+4, -0)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+4, -0)
releasenotes/notes/rabbitmq-fanout-stream-queue-type-5b73723aa5e9b231.yaml (+12, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+4, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+4, -0)
ansible/roles/zun/templates/zun.conf.j2 (+4, -0)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+4, -0)
ansible/roles/watcher/templates/watcher.conf.j2 (+4, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+4, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+4, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+4, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+4, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+4, -0)
ansible/roles/trove/templates/trove.conf.j2 (+4, -0)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+4, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+4, -0)
ansible/group_vars/all.yml (+7, -1)
ansible/roles/manila/templates/manila.conf.j2 (+4, -0)
ansible/roles/prechecks/tasks/service_checks.yml (+9, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+4, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+17, -1)
",-2.939312,-0.48002,3.911605,-0.366184,0.078056,0.443019,-0.955806,-0.502714,-0.145595,-0.018995,-0.976727,0.600644,-0.017485,-0.757192,0.18613
openstack/charm-ceph-iscsi,I32d5e249dffa8d1a5ad407e134b687dc6d4ea4ad,1,0,0.9722,6.1399,0.9719,12,5.0,78,0,Feature,0,0,0,36,0.004079,1.0,0,0.9722,2,2,0,0.9167,2.6074,1.33,-102.8,34.0,0,0,0.8942,1,0.1681,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
osci.yaml (+0, -37)
.gitreview (+2, -0)
tests/bundles/lunar-ec.yaml (+0, -100)
tests/bundles/focal-ec.yaml (+0, -100)
tests/bundles/focal.yaml (+0, -97)
tests/bundles/jammy-reef.yaml (+2, -2)
tests/bundles/jammy-reef-ec.yaml (+2, -2)
tests/bundles/jammy-ec.yaml (+2, -2)
tests/bundles/jammy.yaml (+2, -2)
charmcraft.yaml (+0, -3)
tests/bundles/lunar.yaml (+0, -101)
metadata.yaml (+3, -4)
",3.63826,2.404005,1.787508,0.260121,0.681316,0.639053,0.619966,-0.356826,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/kolla-ansible,Ie42012af9e5c64bca23a6e6826bfc4651fd194bd,0,0,0.6771,6.5862,0.9945,41,4.0,321,0,Feature,0,0,0,96,0.029029,0.8,0,0.5417,6,5,0,0.7444,4.2895,3.54,-32.9,8.74,1,0,0.0138,1,0.4428,0,0,0,0,0,"Drop Freezer

It's inactive and hasn't produced a 2024.1 release [1].
There are some efforts to restore Freezer, but let's remove it for now.

[1]: https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -10)
ansible/roles/freezer/tasks/register.yml (+0, -7)
ansible/roles/freezer/defaults/main.yml (+0, -138)
ansible/roles/horizon/defaults/main.yml (+0, -1)
ansible/roles/freezer/templates/freezer.conf.j2 (+0, -75)
README.rst (+0, -1)
releasenotes/notes/drop-freezer-f41acd5519d643bf.yaml (+4, -0)
ansible/site.yml (+0, -21)
ansible/roles/common/templates/cron-logrotate-freezer.conf.j2 (+0, -3)
ansible/roles/freezer/tasks/precheck.yml (+0, -26)
ansible/roles/freezer/tasks/bootstrap_service.yml (+0, -20)
ansible/inventory/all-in-one (+0, -10)
ansible/roles/freezer/tasks/pull.yml (+0, -3)
ansible/roles/freezer/vars/main.yml (+0, -2)
ansible/roles/freezer/handlers/main.yml (+0, -30)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/freezer/tasks/check.yml (+0, -1)
ansible/roles/freezer/tasks/deploy.yml (+0, -14)
etc/kolla/globals.yml (+0, -11)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -13)
ansible/roles/freezer/templates/freezer-scheduler.json.j2 (+0, -24)
ansible/roles/freezer/templates/wsgi-freezer-api.conf.j2 (+0, -38)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/freezer/tasks/config_validate.yml (+0, -7)
ansible/roles/freezer/tasks/upgrade.yml (+0, -9)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/freezer/tasks/clone.yml (+0, -16)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
ansible/roles/freezer/tasks/reconfigure.yml (+0, -2)
ansible/roles/freezer/templates/freezer-api.json.j2 (+0, -32)
ansible/roles/freezer/tasks/bootstrap.yml (+0, -40)
ansible/roles/freezer/tasks/check-containers.yml (+0, -16)
ansible/group_vars/all.yml (+0, -8)
ansible/roles/freezer/tasks/copy-certs.yml (+0, -6)
ansible/roles/freezer/tasks/stop.yml (+0, -6)
ansible/roles/freezer/tasks/main.yml (+0, -2)
ansible/roles/freezer/tasks/loadbalancer.yml (+0, -7)
tests/templates/inventory.j2 (+0, -10)
ansible/roles/freezer/tasks/deploy-containers.yml (+0, -2)
ansible/roles/freezer/tasks/config.yml (+0, -97)
",-1.292473,2.252288,-1.376304,0.978755,-0.925777,0.105048,0.391233,-0.474855,-0.201991,0.384152,-0.150094,0.266308,0.332452,-0.013644,0.00154
openstack/kolla-ansible,Ic988295bc5b8acb19df008fe0d52a3bcc6de2135,0,0,0.6701,6.7499,0.9953,41,2.5,247,0,Feature,0,0,0,97,0.024064,1.0,0,0.6701,4,5,0,0.7425,4.0737,3.49,-134.1,14.33,1,0,0.0258,1,0.2892,0,0,0,0,0,"Drop Solum

It's inactive and hasn't produced a 2024.1 release [1].

[1]: https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -22)
ansible/roles/common/templates/cron-logrotate-solum.conf.j2 (+0, -3)
ansible/roles/solum/tasks/clone.yml (+0, -8)
ansible/roles/horizon/defaults/main.yml (+0, -1)
ansible/roles/solum/tasks/config.yml (+0, -50)
README.rst (+0, -1)
ansible/roles/solum/handlers/main.yml (+0, -64)
ansible/site.yml (+0, -25)
ansible/roles/solum/tasks/bootstrap.yml (+0, -38)
ansible/roles/solum/vars/main.yml (+0, -2)
ansible/inventory/all-in-one (+0, -22)
ansible/roles/solum/tasks/check-containers.yml (+0, -17)
ansible/roles/solum/templates/solum.conf.j2 (+0, -81)
ansible/roles/solum/tasks/loadbalancer.yml (+0, -7)
ansible/roles/solum/tasks/precheck.yml (+0, -37)
ansible/roles/solum/tasks/pull.yml (+0, -3)
ansible/roles/solum/tasks/bootstrap_service.yml (+0, -20)
ansible/roles/solum/tasks/deploy.yml (+0, -14)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/solum/defaults/main.yml (+0, -250)
releasenotes/notes/drop-solum-5bbdd7f4fc937017.yaml (+4, -0)
ansible/roles/solum/tasks/main.yml (+0, -2)
ansible/roles/solum/tasks/stop.yml (+0, -6)
etc/kolla/globals.yml (+0, -2)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -26)
ansible/roles/solum/tasks/check.yml (+0, -1)
ansible/roles/solum/templates/solum-api.json.j2 (+0, -18)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/solum/tasks/register.yml (+0, -7)
ansible/roles/solum/tasks/copy-certs.yml (+0, -6)
ansible/roles/solum/tasks/upgrade.yml (+0, -9)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/solum/templates/solum-conductor.json.j2 (+0, -18)
ansible/roles/solum/tasks/reconfigure.yml (+0, -2)
ansible/roles/solum/templates/solum-worker.json.j2 (+0, -18)
ansible/group_vars/all.yml (+0, -13)
ansible/roles/solum/tasks/deploy-containers.yml (+0, -2)
ansible/roles/solum/tasks/config_validate.yml (+0, -7)
tests/templates/inventory.j2 (+0, -22)
ansible/roles/solum/templates/solum-deployer.json.j2 (+0, -18)
",-1.075035,3.392288,-1.495006,0.935052,-0.732289,0.103413,0.107183,-0.292395,0.100482,0.051147,-0.633618,0.610545,0.245153,0.233942,-0.155592
openstack/kolla-ansible,I888963751b6e1ed080588297c2889e700431516c,0,0,0.6633,6.5737,0.9944,41,2.5,248,0,Feature,0,0,0,98,0.020066,1.0,0,0.6633,6,5,0,0.7406,4.1742,3.54,-134.1,17.0,1,0,0.014,1,0.3464,0,0,0,0,0,"Drop Sahara

It's inactive and hasn't produced a 2024.1 release [1].

[1]: https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -10)
ansible/roles/sahara/tasks/clone.yml (+0, -8)
ansible/roles/sahara/templates/sahara-api.json.j2 (+0, -29)
ansible/roles/horizon/defaults/main.yml (+0, -1)
README.rst (+0, -1)
ansible/roles/sahara/templates/sahara.conf.j2 (+0, -72)
ansible/site.yml (+0, -21)
ansible/inventory/all-in-one (+0, -10)
ansible/roles/sahara/templates/sahara-engine.json.j2 (+0, -29)
ansible/roles/ceilometer/templates/event_definitions.yaml.j2 (+0, -25)
releasenotes/notes/drop-sahara-9242926ee36e5316.yaml (+4, -0)
ansible/roles/sahara/tasks/copy-certs.yml (+0, -6)
ansible/roles/sahara/tasks/register.yml (+0, -7)
ansible/roles/sahara/handlers/main.yml (+0, -33)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/sahara/tasks/bootstrap.yml (+0, -38)
ansible/roles/common/templates/cron-logrotate-sahara.conf.j2 (+0, -3)
ansible/roles/sahara/tasks/precheck.yml (+0, -26)
etc/kolla/globals.yml (+0, -2)
ansible/roles/sahara/tasks/deploy-containers.yml (+0, -2)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -13)
ansible/roles/sahara/tasks/check.yml (+0, -1)
ansible/roles/common/defaults/main.yml (+0, -2)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/sahara/tasks/config_validate.yml (+0, -7)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/sahara/defaults/main.yml (+0, -171)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
ansible/roles/sahara/tasks/reconfigure.yml (+0, -2)
ansible/roles/sahara/tasks/bootstrap_service.yml (+0, -20)
ansible/roles/sahara/tasks/deploy.yml (+0, -14)
ansible/roles/sahara/tasks/stop.yml (+0, -6)
ansible/roles/sahara/tasks/check-containers.yml (+0, -18)
ansible/roles/sahara/tasks/main.yml (+0, -2)
ansible/roles/sahara/tasks/loadbalancer.yml (+0, -7)
ansible/roles/sahara/tasks/config.yml (+0, -83)
ansible/roles/sahara/tasks/upgrade.yml (+0, -9)
ansible/group_vars/all.yml (+0, -8)
ansible/roles/sahara/vars/main.yml (+0, -2)
tests/templates/inventory.j2 (+0, -10)
ansible/roles/sahara/tasks/pull.yml (+0, -3)
",-1.124387,3.493077,-1.504022,1.023768,-0.728041,0.147813,0.093274,-0.328219,0.106407,0.014086,-0.675544,0.681313,0.213893,0.241202,-0.144611
openstack/kolla-ansible,I217b3633f07e5b2c657e20b19aaa4fbb46535a97,0,0,0.6566,6.7673,0.9954,42,2.5,248,0,Feature,0,0,0,99,0.017682,1.0,0,0.6566,6,5,0,0.7388,4.0675,3.55,-134.1,14.33,1,0,0.0184,1,0.2854,0,0,0,0,0,"Drop Senlin

It's inactive and hasn't produced a 2024.1 release [1].

[1]: https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -16)
ansible/roles/senlin/tasks/main.yml (+0, -2)
ansible/roles/senlin/tasks/upgrade.yml (+0, -9)
ansible/roles/senlin/tasks/clone.yml (+0, -8)
ansible/roles/senlin/tasks/config.yml (+0, -83)
ansible/roles/horizon/defaults/main.yml (+0, -1)
ansible/roles/senlin/tasks/precheck.yml (+0, -26)
ansible/roles/senlin/tasks/reconfigure.yml (+0, -2)
README.rst (+0, -1)
ansible/roles/senlin/templates/senlin-health-manager.json.j2 (+0, -24)
ansible/site.yml (+0, -23)
ansible/roles/senlin/tasks/config_validate.yml (+0, -7)
ansible/roles/senlin/templates/senlin-engine.json.j2 (+0, -24)
ansible/inventory/all-in-one (+0, -16)
releasenotes/notes/drop-senlin-be5be514825a5d92.yaml (+4, -0)
ansible/roles/senlin/vars/main.yml (+0, -2)
ansible/roles/senlin/templates/senlin.conf.j2 (+0, -96)
ansible/roles/senlin/tasks/stop.yml (+0, -6)
ansible/roles/senlin/tasks/pull.yml (+0, -3)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/senlin/tasks/bootstrap.yml (+0, -38)
ansible/roles/senlin/tasks/deploy.yml (+0, -14)
ansible/roles/senlin/tasks/copy-certs.yml (+0, -6)
ansible/roles/senlin/tasks/deploy-containers.yml (+0, -2)
etc/kolla/globals.yml (+0, -2)
ansible/roles/senlin/tasks/check-containers.yml (+0, -17)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -13)
ansible/roles/senlin/tasks/check.yml (+0, -1)
ansible/roles/senlin/templates/senlin-conductor.json.j2 (+0, -24)
ansible/roles/senlin/defaults/main.yml (+0, -237)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/senlin/handlers/main.yml (+0, -64)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
ansible/roles/common/templates/cron-logrotate-senlin.conf.j2 (+0, -3)
ansible/roles/senlin/tasks/loadbalancer.yml (+0, -7)
ansible/roles/senlin/tasks/register.yml (+0, -7)
ansible/roles/senlin/templates/senlin-api.json.j2 (+0, -24)
ansible/roles/senlin/tasks/bootstrap_service.yml (+0, -20)
ansible/group_vars/all.yml (+0, -8)
tests/templates/inventory.j2 (+0, -16)
",-1.065418,3.42618,-1.5418,0.890589,-0.781972,0.140335,0.104708,-0.332515,0.063933,0.023853,-0.609705,0.602648,0.241908,0.210761,-0.157674
openstack/kolla-ansible,I691205730b0e10a42ce61f3340cc39ee51bd1010,0,0,0.65,6.9556,0.9876,50,3.25,507,0,Feature,0,0,0,100,0.015463,1.0,0,0.65,6,5,0,0.737,4.6238,3.56,-63.28,11.56,1,0,0.0124,1,0.4833,0,0,0,0,0,"Drop Murano

It's inactive and hasn't produced a 2024.1 release [1].
In addition to that, there's a CVE that hasn't really been patched [2].

Also drop outward_rabbitmq that was used only with Murano.

[1]: https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[2]: https://lists.openstack.org/archives/list/openstack-announce@lists.openstack.org/thread/4FYM6GSIM5WZSJQIG4TT5Q3UBKQIHLWX/
[SEP]
FILES CHANGED:
ansible/roles/horizon/defaults/main.yml (+0, -5)
README.rst (+0, -1)
ansible/site.yml (+1, -23)
ansible/roles/murano/tasks/bootstrap.yml (+0, -38)
ansible/roles/murano/tasks/upgrade.yml (+0, -11)
ansible/roles/murano/tasks/check-containers.yml (+0, -16)
ansible/roles/murano/tasks/import_library_packages.yml (+0, -61)
ansible/roles/rabbitmq/templates/definitions.json.j2 (+4, -12)
ansible/roles/murano/tasks/register.yml (+0, -7)
ansible/roles/horizon/tasks/config.yml (+0, -1)
ansible/roles/murano/tasks/pull.yml (+0, -3)
ansible/roles/murano/handlers/main.yml (+0, -31)
etc/kolla/globals.yml (+1, -4)
ansible/roles/murano/tasks/precheck.yml (+0, -26)
ansible/roles/murano/defaults/main.yml (+0, -140)
ansible/roles/common/templates/cron-logrotate-murano.conf.j2 (+0, -3)
ansible/roles/horizon/tasks/clone.yml (+0, -10)
ansible/roles/murano/vars/main.yml (+0, -2)
ansible/roles/common/tasks/config.yml (+0, -2)
ansible/roles/murano/tasks/reconfigure.yml (+0, -2)
ansible/roles/murano/tasks/check.yml (+0, -1)
ansible/roles/rabbitmq/defaults/main.yml (+0, -23)
ansible/roles/murano/templates/murano-engine.json.j2 (+0, -24)
ansible/roles/murano/tasks/copy-certs.yml (+0, -6)
ansible/roles/murano/tasks/main.yml (+0, -2)
ansible/roles/murano/tasks/config.yml (+0, -82)
tests/templates/inventory.j2 (+0, -13)
ansible/roles/rabbitmq/tasks/precheck.yml (+0, -96)
ansible/inventory/multinode (+0, -13)
ansible/roles/murano/tasks/stop.yml (+0, -6)
ansible/roles/murano/tasks/clone.yml (+0, -8)
ansible/roles/murano/tasks/deploy-containers.yml (+0, -2)
ansible/inventory/all-in-one (+0, -13)
releasenotes/notes/drop-murano-51796e817e8331b4.yaml (+6, -0)
ansible/roles/common/templates/cron-logrotate-outward-rabbitmq.conf.j2 (+0, -3)
ansible/rabbitmq.yml (+0, -69)
ansible/roles/murano/tasks/deploy.yml (+0, -17)
ansible/roles/murano/templates/murano.conf.j2 (+0, -119)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -25)
ansible/roles/murano/tasks/bootstrap_service.yml (+0, -21)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/murano/templates/murano-api.json.j2 (+0, -24)
ansible/roles/telegraf/templates/telegraf.conf.j2 (+0, -6)
etc/kolla/passwords.yml (+0, -6)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
ansible/roles/murano/tasks/loadbalancer.yml (+0, -7)
ansible/roles/murano/tasks/config_validate.yml (+0, -7)
ansible/roles/telegraf/defaults/main.yml (+0, -1)
ansible/group_vars/all.yml (+1, -26)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+0, -10)
",-2.871601,2.268056,-0.245264,-0.293915,-0.276143,-0.044716,0.433059,-0.023874,-0.303071,0.108111,0.273155,0.009667,0.116286,-0.051396,-0.097808
openstack/kolla-ansible,I499e69ec6db63e4067e49376e2a1f3e01e48fe62,0,0,0.6436,7.0255,0.9956,48,5.0,105,0,Feature,0,0,0,101,0.01344,1.0,0,0.6436,6,5,0,0.7351,4.2035,3.6,-35.12,18.0,1,0,0.0142,1,0.0933,0,0,0,0,0,"Drop Vitrage

It was deprecated in Antelope cycle.
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+0, -2)
ansible/roles/horizon/defaults/main.yml (+0, -1)
README.rst (+0, -1)
ansible/site.yml (+0, -24)
ansible/roles/prometheus/templates/prometheus-alertmanager.yml.j2 (+0, -9)
ansible/roles/vitrage/templates/vitrage-ml.json.j2 (+0, -24)
ansible/roles/vitrage/templates/vitrage-notifier.json.j2 (+0, -24)
ansible/roles/vitrage/tasks/register.yml (+0, -22)
ansible/roles/vitrage/handlers/main.yml (+0, -80)
ansible/roles/cinder/defaults/main.yml (+0, -2)
ansible/roles/vitrage/tasks/precheck.yml (+0, -35)
ansible/roles/vitrage/tasks/pull.yml (+0, -3)
ansible/roles/vitrage/tasks/loadbalancer.yml (+0, -7)
ansible/roles/vitrage/tasks/deploy.yml (+0, -14)
releasenotes/notes/drop-vitrage-b7d94fd6038e0d60.yaml (+4, -0)
etc/kolla/globals.yml (+0, -2)
ansible/roles/vitrage/templates/wsgi-vitrage.conf.j2 (+0, -43)
ansible/roles/vitrage/templates/vitrage.conf.j2 (+0, -107)
ansible/roles/vitrage/templates/vitrage-graph.json.j2 (+0, -30)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/vitrage/tasks/clone.yml (+0, -8)
ansible/roles/vitrage/templates/vitrage-api.json.j2 (+0, -33)
ansible/roles/vitrage/tasks/bootstrap_service.yml (+0, -20)
ansible/roles/vitrage/templates/vitrage-persistor.json.j2 (+0, -24)
ansible/roles/vitrage/tasks/config_validate.yml (+0, -7)
ansible/roles/aodh/defaults/main.yml (+0, -2)
ansible/roles/nova/defaults/main.yml (+0, -2)
ansible/roles/vitrage/tasks/deploy-containers.yml (+0, -2)
tests/templates/inventory.j2 (+0, -16)
ansible/roles/vitrage/tasks/bootstrap.yml (+0, -38)
ansible/roles/vitrage/tasks/config.yml (+0, -110)
ansible/inventory/multinode (+0, -19)
ansible/roles/vitrage/tasks/check.yml (+0, -1)
ansible/roles/neutron/defaults/main.yml (+0, -2)
ansible/roles/vitrage/tasks/stop.yml (+0, -6)
ansible/roles/vitrage/tasks/copy-certs.yml (+0, -6)
ansible/inventory/all-in-one (+0, -19)
ansible/roles/vitrage/tasks/check-containers.yml (+0, -17)
ansible/roles/common/templates/cron-logrotate-vitrage.conf.j2 (+0, -3)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -12)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/vitrage/defaults/main.yml (+0, -300)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+1, -6)
ansible/roles/vitrage/tasks/main.yml (+0, -2)
ansible/roles/vitrage/tasks/reconfigure.yml (+0, -2)
ansible/roles/vitrage/vars/main.yml (+0, -2)
ansible/group_vars/all.yml (+0, -17)
ansible/roles/vitrage/tasks/upgrade.yml (+0, -9)
",3.213939,-0.669549,0.82253,-0.884315,-1.312672,1.005624,-0.139657,0.603012,-0.530867,0.02483,0.404517,0.504565,-0.795217,0.66833,-0.252508
openstack/kolla,Ie9cc529d186b74ea3d07b0082f9c965d4aa054e9,0,0,0.6373,5.0752,0.9686,18,5.5,110,0,Feature,0,0,0,102,0.011807,1.0,0,0.6373,3,7,0,0.7547,3.4939,2.39,24.36,16.75,1,0,0.0,1,0.6875,0,0,0,0,0,"Drop Vitrage

It has been deprecated in Antelope cycle.
[SEP]
FILES CHANGED:
docker/vitrage/vitrage-ml/Dockerfile.j2 (+0, -13)
docker/vitrage/vitrage-notifier/Dockerfile.j2 (+0, -13)
docker/vitrage/vitrage-persistor/Dockerfile.j2 (+0, -13)
kolla/common/sources.py (+0, -8)
README.rst (+0, -1)
docker/horizon/extend_start.sh (+0, -9)
docker/vitrage/vitrage-api/extend_start.sh (+0, -8)
kolla/common/config.py (+0, -1)
docker/vitrage/vitrage-base/Dockerfile.j2 (+0, -41)
releasenotes/notes/drop-vitrage-d871449de1e06458.yaml (+4, -0)
kolla/common/users.py (+1, -1)
doc/source/matrix_x86.csv (+0, -1)
docker/openstack-base/Dockerfile.j2 (+0, -1)
docker/vitrage/vitrage-api/Dockerfile.j2 (+0, -14)
doc/source/matrix_aarch64.csv (+0, -1)
docker/vitrage/vitrage-base/extend_start.sh (+0, -14)
roles/kolla-build-config/defaults/main.yml (+0, -2)
docker/vitrage/vitrage-graph/Dockerfile.j2 (+0, -13)
",3.003764,-0.666297,0.613714,-0.757752,-1.222216,0.997156,-0.06917,0.384679,-0.468017,0.097666,0.462846,0.552207,-0.903246,0.500468,-0.276608
openstack/charm-ceph-nfs,I4cbf908abb3291e58248b907e058012cfffdafb3,1,0,0.973,5.5645,0.95,10,5.0,78,0,Feature,0,0,0,37,0.003984,1.0,0,0.973,2,2,0,1.0,2.747,1.1,-52.04,34.0,0,0,0.7538,1,0.2989,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -1)
osci.yaml (+4, -42)
tests/bundles/mantic-quincy.yaml (+0, -48)
.gitreview (+2, -0)
tests/bundles/focal-quincy.yaml (+0, -47)
charmcraft.yaml (+0, -6)
tests/bundles/focal-pacific.yaml (+0, -47)
metadata.yaml (+4, -6)
tests/bundles/jammy-reef.yaml (+3, -3)
tests/bundles/lunar-quincy.yaml (+0, -47)
",3.638262,2.404005,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/charm-ceph-proxy,I5d353c2b68944edfb1f8327d6819fbe08544f281,1,0,0.9737,6.9276,0.9441,13,5.0,78,0,Feature,0,0,0,38,0.00398,1.0,0,0.9737,2,2,0,1.0,2.6865,1.31,-18.2,34.0,0,0,0.9715,1,0.0765,0,0,0,0,0,"Updates for stable/reef
[SEP]
FILES CHANGED:
tests/bundles/mantic-bobcat-ec.yaml (+0, -224)
osci.yaml (+0, -19)
tests/bundles/lunar-antelope.yaml (+0, -214)
.gitreview (+2, -0)
tests/bundles/jammy-bobcat.yaml (+14, -14)
tests/tests.yaml (+0, -4)
tests/bundles/lunar-antelope-ec.yaml (+0, -224)
tests/bundles/jammy-antelope.yaml (+14, -14)
charmcraft.yaml (+0, -6)
tests/bundles/mantic-bobcat.yaml (+0, -214)
metadata.yaml (+0, -2)
tests/bundles/jammy-yoga.yaml (+14, -14)
tests/bundles/jammy-yoga-ec.yaml (+13, -13)
",3.638262,2.404006,1.787509,0.26012,0.681315,0.639053,0.619967,-0.356825,0.399604,-0.192645,-0.850145,-0.420626,0.144071,0.072772,0.683913
openstack/kolla-ansible,I0247877c245f12994ffab983a624844e1238de9b,0,0,0.5,3.7612,0.0238,5,12.0,117,0,Feature,0,0,0,2,0.042553,0.0,0,0.0,4,4,0,0.7333,2.1099,3.6,25.46,18.13,1,0,0.0,1,2.7209,0,0,0,0,0,"Skyline: use an external object store (Swift) in the dashboard
[SEP]
FILES CHANGED:
doc/source/reference/shared-services/skyline-guide.rst (+15, -0)
ansible/roles/skyline/defaults/main.yml (+6, -0)
ansible/roles/skyline/templates/nginx.conf.j2 (+10, -0)
releasenotes/notes/skyline-external-swift-d9e38f696a22c117.yaml (+9, -0)
ansible/roles/skyline/templates/skyline.yaml.j2 (+1, -1)
",2.241144,0.560976,0.969597,0.664445,0.17309,0.092841,0.306035,0.345407,-0.018592,-0.308648,-0.199645,0.606822,0.035376,-0.001442,-0.602024
openstack/kolla-ansible,I76cce7f491c77b6b788d29c8644e87055f5cfff0,1,1,0.6311,1.0986,0.0,2,12.5,209,0,Bug Fix,0,0,0,103,0.011707,0.5,0,0.3155,1,2,0,0.7315,1.0,1.0,58.79,14.6,0,0,0.5,1,69.6667,0,6,0,9,0,"kolla_url: port is a string

Ansible passes port as a string - therefore matching does not work
and we get https://nova_url:443/v2.1

Closes-Bug: #2063434
[SEP]
FILES CHANGED:
kolla_ansible/kolla_url.py (+1, -0)
zuul.d/base.yaml (+1, -0)
",-0.698111,-0.745878,-1.266203,-1.62002,0.379707,-0.084222,0.158494,-0.23361,0.09724,0.42021,0.020172,-0.530903,0.31945,0.377763,-0.036438
openstack/openstack-ansible-os_trove,Id8a428686287ec4067c5eeec12d65329d0248669,1,1,0.9545,2.0794,0.2857,1,30.0,255,0,Bug Fix,0,0,0,154,0.048185,0.0,0,0.0,1,1,0,0,0.0,1.0,12.83,22.67,0,0,0.0,0,31.875,0,0,0,0,0,"Fix RabbitMQ vhost defenition for guestagent

While adding support for quorum queues it was missed to reflect changes
for guestagent settings, which leads to invalid configuration

Closes-Bug: #2056663
[SEP]
FILES CHANGED:
templates/trove-guestagent.conf.j2 (+5, -2)
",0.274858,-2.34798,-0.372922,-0.238689,-0.317718,-0.097063,-0.821922,0.298657,0.056851,0.015068,-0.287571,-0.154323,0.166937,-0.5058,0.468773
openstack/openstack-ansible-os_trove,Iad29d9f4f344861e3fa9a959c2c03d5a3f87c430,1,1,0.9548,1.0986,0.5,1,12.5,229,0,Bug Fix,0,0,0,155,0.048392,1.0,0,0.9548,1,1,0,1.0,0.0,1.0,4.64,19.4,0,0,0.0,0,76.3333,0,6,0,15,0,"Add TLS configuration for guestagent notifications

While adding TLS support for RabbitMQ it was missed to configure
notifications for Trove guestagent.

Related-Bug: #2056663
[SEP]
FILES CHANGED:
templates/trove-guestagent.conf.j2 (+1, -1)
",0.674507,-1.715236,-0.515171,0.045432,-0.450124,0.159622,-1.054016,0.765319,0.109983,0.127443,-0.264404,0.092668,0.07879,-0.277153,0.430744
openstack/openstack-ansible-galera_server,Ia10a9ab589275f18ff2c92a21cd2ff9aeac07567,1,0,0.9551,1.0986,0.0,2,15.6,520,0,Feature,0,0,0,156,0.048674,1.0,0,0.9551,1,1,0,0.9,1.0,1.0,53.25,11.88,1,0,0.0,0,173.3333,0,0,0,0,0,"Ensure find is installed on MariaDB containers

wsrep_sst_mariabackup script that syncs data for members joining cluster
leverages `find` util heavily. While Ubuntu LXC image seems to contain
it out of the box, EL does miss it. While we do not see any issues due
to missing `find` on modern MariaDB, script still apparently relies on
it's existance, though can handle cases when it's not present.
Still let's ensure it's present, as it feels playing important role.
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
vars/debian.yml (+1, -0)
",-0.326569,-1.801883,0.234,0.011999,-0.577838,-0.259892,0.890453,-0.181099,-0.531609,0.007143,0.400267,-0.330316,0.149125,-0.332513,0.088048
openstack/openstack-ansible-openstack_hosts,I28311bb6f5fb43a007f58bb97683c1ab04cc786e,1,0,0.9554,1.0986,0.5,1,10.25,376,0,Feature,0,0,0,157,0.048955,0.0,0,0.0,1,1,0,0.8571,0.0,1.0,14.85,11.9,0,0,0.0,0,125.3333,0,0,0,0,0,"Ensure codename is lowercased for cloudsig install

With [1] option to install cloudsig repo from package was added, though
release codename was not lowered, which results in a failure when
attempting to use cloudsig instead of trunk.

[1] https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/880473
[SEP]
FILES CHANGED:
tasks/openstack_hosts_configure_dnf.yml (+1, -1)
",-1.063142,0.959993,-0.490235,0.552266,-0.469571,-0.342334,0.464269,0.040292,0.088509,0.107366,-0.057554,-0.257973,0.170337,-0.258456,-0.05257
openstack/openstack-ansible,Ief85eb374ad1cc5b99a54fb5f225157b7b85542b,1,0,0.9557,2.3979,0.3,6,7.0,82,0,Bug Fix,0,0,0,158,0.049237,1.0,0,0.9557,4,3,0,0.9277,2.4464,2.5,30.53,19.94,0,1,0.0,0,7.4545,0,0,0,0,0,"[doc] Fix supported OS list
[SEP]
FILES CHANGED:
deploy-guide/source/deploymenthost.rst (+1, -0)
doc/source/user/aio/quickstart.rst (+2, -1)
deploy-guide/source/overview-requirements.rst (+1, -0)
doc/source/admin/upgrades/os-compatibility-matrix.html (+1, -1)
deploy-guide/source/targethosts-prepare.rst (+1, -0)
playbooks/openstack-hosts-setup.yml (+1, -1)
",3.127933,2.154645,1.373444,0.703523,-0.419332,0.916361,0.551559,-0.031786,0.219108,0.821135,0.270736,-0.290603,0.638573,-0.285152,-1.600615
openstack/ironic,I9610add40afbb7beb30d375a3a455434f5446cc7,1,0,0.973,2.1972,0.5,1,8.0,147,0,Bug Fix,0,0,0,37,0.011851,1.0,0,0.973,4,1,0,0.9558,0.0,4.0,13.65,13.2,1,0,0.0,0,16.3333,0,0,0,0,0,"Redfish: fix error formatting when mounting vmedia

Also add missing error into the message.
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/boot.py (+4, -4)
",3.514291,-0.682025,0.98745,0.000995,-0.577521,0.588614,0.827189,-0.217215,0.582606,-0.204539,0.138144,-0.194914,0.013294,0.164312,-0.502735
openstack/kolla-ansible,Id9c7e59e6ae1dd98176c68b14a2aff1985306751,0,1,0.8587,2.8904,0.1765,2,15.5,307,0,Bug Fix,0,0,0,92,0.025379,1.0,0,0.8587,4,2,0,0.7322,0.9367,3.0,-2.66,24.26,1,0,0.0,1,17.0556,0,6,0,9,0,"Update Grafana OpenSearch datasource configuration

Updates the Grafana OpenSearch datasource configuration to use values
for OpenSearch that work out of the box.

Closes-Bug: #2039500
(cherry picked from commit 9afc9da22621cc808287874915ab3c1305592d15)
[SEP]
FILES CHANGED:
releasenotes/notes/grafana-opensearch-datasource-configuration-04202c059f1abd05.yaml (+11, -0)
ansible/roles/grafana/defaults/main.yml (+3, -3)
",-0.690497,-0.199502,-1.640959,-0.972669,1.047048,0.389731,0.253124,0.263178,0.042498,0.082243,0.066619,-0.073296,0.524066,-0.215205,-0.070221
openstack/kolla-ansible,I310fc1b8e002ce9f0ba60f8bb67b7f372a589314,1,1,0.8333,3.4657,0.0645,4,10.09,893,0,Bug Fix,0,0,0,18,0.004911,1.0,0,0.8333,6,2,0,0.7304,1.8007,5.0,19.01,14.13,0,0,0.0,1,27.9062,0,6,0,4,0,"Define retry_tag for unprocessed Fluentd logs

The Kolla Ansible Fluentd config is not idempotent. In practise this
can be an issue if some logs are rejected by OpenSearch /
ElasticSearch bulk API. In this case, by default, the unprocessed
logs will be reprocessed from the start of the Fluentd pipeline,
leading to error messages.

The solution proposed here is to explicitly set the retry_tag as
documented in [1,2], and add a dedicated output for retried logs.

An alternative fix could be to make the pipeline idempotent. This
would require a compromise of either duplicating content, or having
non-standard fields for the log payload/message.

[1] https://github.com/fluent/fluent-plugin-opensearch?tab=readme-ov-file#retry_tag
[2] https://github.com/uken/fluent-plugin-elasticsearch?tab=readme-ov-file#retry_tag

Closes-Bug: #2064104
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/03-opensearch.conf.j2 (+10, -1)
ansible/roles/common/templates/conf/output/01-es.conf.j2 (+10, -1)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+2, -0)
releasenotes/notes/bugfix-fluentd-retry-tag-383dd788a42fddd6.yaml (+7, -0)
",-3.473438,0.967962,2.218761,-0.073513,-0.11536,-0.015085,-0.0812,0.032782,0.176827,-0.149153,-0.017539,0.374344,-0.044,-0.343365,0.020733
openstack/charm-neutron-api-plugin-ovn,I57417c31d142b73f68923c82e95b4be9255e16b4,1,0,0.5,2.5649,0.0,1,9.67,252,0,Feature,0,0,0,2,0.028986,1.0,0,0.5,4,1,0,1.0,0.0,4.0,7.4,21.8,1,0,0.0,0,19.3846,0,0,0,0,0,"Enable ironic compatible services

Enable ironic compatible services starting at Bobcat release.
This enables the ovn-router and trunk service plugins and allows
for the baremetal mechanism driver.
[SEP]
FILES CHANGED:
src/lib/charm/openstack/neutron_api_plugin_ovn.py (+12, -0)
",1.03719,-1.546827,-0.206084,0.15799,-0.045352,-0.47105,-0.184898,1.099462,-0.294846,-0.320837,-0.476054,0.782279,0.041685,-0.340723,-0.371429
openstack/charm-neutron-api,I36b4a59dd6edf4dd3790dcab5279237af73bf712,1,0,0.6667,5.0106,0.0604,2,15.4,564,0,Feature,0,0,0,3,0.037037,1.0,0,0.6667,1,1,0,1.0,0.8192,1.0,23.1,16.55,1,0,0.745,0,3.76,0,0,0,0,0,"Support multiple subordinate api plugins

Support multiple subordinate api plugins providing services, mechanism
drivers, etc. This works by merging the dictionaries that are returned
from the different subordinates.

This is to support the case where a neutron-api-plugin-ovn and
neutron-api-plugin-ironic are both related in order to support an OVN +
Ironic based deployment.

Note: there is an additional check to ensure that the ovn and
openvswitch mechanism drivers are not both enabled at the same time.
[SEP]
FILES CHANGED:
hooks/neutron_api_context.py (+30, -8)
unit_tests/test_neutron_api_context.py (+110, -1)
",-1.587417,-0.695088,0.193369,0.933761,0.346379,-0.398827,-0.0059,0.305779,0.090882,0.073436,-0.071641,0.413157,0.330698,0.062318,-0.044173
openstack/openstack-ansible-openstack_hosts,I89081646bccf4886669dee1261b2814fa9a0de07,0,0,0.956,1.7918,0.0,2,13.0,238,0,Feature,0,0,0,159,0.049394,1.0,0,0.956,1,1,0,0.875,0.971,1.0,-11.35,23.66,0,0,0.0,0,39.6667,0,0,0,0,0,"Re-initiate connection after environment is changed

When we change /etc/environment it might be necessary to re-initiate
connection in order to consume updated environment variables.
[SEP]
FILES CHANGED:
tasks/main.yml (+2, -0)
handlers/main.yml (+3, -0)
",0.943861,0.215518,0.04398,1.446828,0.584632,0.169618,0.705085,-1.114589,-0.381675,-0.158942,-0.276678,0.157095,-0.097926,-0.002512,0.174989
openstack/charm-vault,I1d6b9d05b960e7723fab30594dcb73769066112c,1,1,1.0,4.1109,0.3333,1,23.0,588,0,Bug Fix,0,0,0,8,0.888889,0.0,0,0.0,3,1,0,0.4286,0.0,3.0,49.23,15.29,1,0,0.0,0,9.6393,0,28,0,6,0,"Fix NRPE check return error after snap upgrade

A recent update to snapd changed the response snapd returns when
requesting the version of the Vault snap. This is due to the snapd
API talking http over a socket interface and the code in question
not actually understanding http protocol. Rather than add additional
dependencies on the machine for this check to run when invoked by
nagios invocations, the code is rewritten to parse the version of
the installed vault snap from the output of the snap info command.

Closes-Bug: 2060173
[SEP]
FILES CHANGED:
src/files/nagios/check_vault_health.py (+40, -20)
",-0.757284,-1.945467,0.448904,0.474095,-0.449113,-0.084482,0.803615,0.341831,0.285113,-0.025613,0.375275,0.026951,-0.011114,0.073694,0.348473
openstack/openstack-ansible-os_glance,Ica91974c587331ad85bdf51200403831a919ed38,1,0,0.95,2.4849,0.7273,3,6.2,313,0,Bug Fix,0,0,0,160,0.049628,1.0,0,0.95,1,1,0,0.8333,1.3093,1.0,9.51,16.67,0,0,0.0,0,26.0833,0,0,0,0,0,"Fix rootwrap.conf distribution for EL

Due to overriding glance_core_files value for specific distros, rootwrap
config was not actualy provisioned for EL.

This is a follow-up to [1]

[1] https://review.opendev.org/q/I4ee3fc33fdbeb50fc7b102bf62d6134f83c5925f
[SEP]
FILES CHANGED:
vars/redhat.yml (+0, -7)
vars/debian.yml (+2, -0)
vars/main.yml (+1, -1)
",-1.22903,0.182359,-0.915522,-0.744376,0.04186,-0.136468,0.792063,0.254648,0.392892,0.569143,-0.29661,-0.605963,0.029774,-0.091838,-0.116807
openstack/kolla,Ie91b533047d59e19bdd56f3a999e377d49a745a8,0,0,0,0.6931,1.0,1,4.83,290,0,Feature,0,0,0,0,0.0,0.5,0,0.0,2,1,0,0.7512,0.0,2.0,-5.19,15.73,1,0,0.0,0,145.0,0,0,0,0,0,"pyinotify is no longer needed

This library was used by oslo.log but isn't now.  It's being removed
from global-requirements so let's drop it from openstack-base.

Depends-On: https://review.opendev.org/c/openstack/requirements/+/917831
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+0, -1)
",-0.347692,0.941522,-0.960093,0.15346,-1.383119,-0.18812,0.589358,-0.465406,-0.608323,-0.08949,-0.063762,-0.427022,0.002354,0.045583,0.224278
openstack/charm-ceph-dashboard,Iae146f2772ce80e541966791f05e979578f62e86,0,0,0.5455,5.0752,0.8805,6,6.0,98,0,Feature,0,0,0,11,0.007687,1.0,0,0.5455,2,1,0,0.8667,1.4047,1.17,-81.25,35.73,1,0,0.9497,1,0.6125,0,0,0,0,0,"Caracal-Squid enablement for ceph-dashboard
[SEP]
FILES CHANGED:
tests/tests.yaml (+1, -4)
tests/bundles/lunar-antelope.yaml (+0, -114)
charmcraft.yaml (+0, -6)
tests/bundles/jammy-caracal.yaml (+13, -9)
metadata.yaml (+0, -2)
tests/bundles/jammy-bobcat.yaml (+5, -5)
",1.866663,1.275325,0.410988,-0.429977,0.63038,-0.448487,0.391516,0.872874,-0.285729,-0.72537,0.635572,1.28898,0.161203,-0.139965,0.223868
openstack/charm-ceph-proxy,I1eecf717ed945faaa5b3bf6a9db2bd9f80e9fa73,0,0,0.5,7.0003,0.7765,16,6.0,94,0,Feature,0,0,0,12,0.007547,1.0,0,0.5,4,2,0,1.0,3.1166,1.94,-109.45,35.73,1,0,0.6679,1,0.0857,0,0,0,0,0,"Caracal-Squid enablement for ceph-proxy
[SEP]
FILES CHANGED:
tests/bundles/mantic-bobcat-ec.yaml (+0, -224)
charmhelpers/contrib/openstack/utils.py (+22, -27)
lib/charms_ceph/utils.py (+41, -98)
tests/bundles/lunar-antelope.yaml (+0, -214)
charmhelpers/contrib/storage/linux/lvm.py (+1, -5)
charmhelpers/osplatform.py (+20, -8)
charmhelpers/fetch/ubuntu.py (+10, -0)
tests/bundles/jammy-bobcat.yaml (+14, -14)
charmhelpers/core/host.py (+5, -2)
tests/bundles/lunar-antelope-ec.yaml (+0, -224)
lib/charms_ceph/broker.py (+68, -1)
tests/bundles/jammy-antelope.yaml (+14, -14)
charmcraft.yaml (+0, -6)
tests/bundles/jammy-caracal.yaml (+7, -7)
charmhelpers/contrib/network/ip.py (+43, -5)
metadata.yaml (+0, -2)
",1.690661,1.583466,0.429113,-0.061198,0.638894,-0.366222,0.338206,0.768522,-0.133322,-0.399597,0.776576,1.163226,0.218215,-0.335857,0.29376
openstack/kolla-ansible,I31969eaac40c4de985be8d9d05befa930b788800,1,0,0.6346,1.0986,0.5,1,7.0,80,0,Bug Fix,1,0,0,104,0.011818,0.75,0,0.476,1,1,0,0.7311,0.0,1.0,30.53,14.23,0,0,1.0,0,26.6667,0,0,0,0,0,"CI: Fix fluentd log check
[SEP]
FILES CHANGED:
tests/check-logs.sh (+1, -1)
",3.833491,1.049256,1.471668,-0.537022,0.171617,0.133126,0.191069,0.247329,0.090144,0.030249,0.403186,-0.565582,0.720844,-0.221746,0.142077
openstack/kolla,Id1c028e0650c1fd3aa4c0a7b311a61b26057179c,0,0,0.8462,1.0986,0.5,1,6.0,80,0,Feature,0,0,0,13,0.059091,0.5667,0,0.4795,2,1,0,0.7477,0.0,2.0,-24.85,22.4,0,0,0.0,0,26.6667,0,0,0,0,0,"Debian: use caracal repos
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
",3.13775,1.971524,0.843294,0.419203,0.499667,0.119693,0.996483,0.125338,-1.024848,-0.524662,0.532336,0.181071,0.167839,-0.096855,-0.413916
openstack/kolla-ansible,I839f7f1051182fe797394e5436571d64d5c5b5a4,0,0,0,4.9836,0.0,29,116.67,1898,0,Doc,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.7317,4.7382,3.93,-35.58,50.1,0,0,0.0,1,13.0,0,0,0,0,0,"HAProxy: Switch to L7 Healthchecks

Address occasional issues where TCP connections appear healthy,
yet the web servers within containers fail to respond,
resulting in requests being sent to unhealthy servers.

Implemented for services I currently use.
- Aodh (OPTIONS to /, expects 2XX or 3XX)
- Barbican (OPTIONS to /, expects 2XX or 3XX)
- Blazar (OPTIONS to /, expects 401)
- Cinder API (OPTIONS to /, expects 2XX or 3XX)
- CloudKitty (OPTIONS to /, expects 2XX or 3XX)
- Designate (OPTIONS to /, expects 2XX or 3XX)
- Glance (OPTIONS to /, expects 2XX or 3XX)
- Gnocchi (OPTIONS to /, expects 2XX or 3XX)
- Grafana (OPTIONS to /, expects 2XX or 3XX)
- Heat (OPTIONS to /, expects 2XX or 3XX)
- Horizon (OPTIONS to /, expects 2XX or 3XX)
- Ironic (OPTIONS to /, expects 2XX or 3XX)
- Keystone (OPTIONS to /, expects 2XX or 3XX)
- Magnum (OPTIONS to /, expects 2XX or 3XX)
- Manila (OPTIONS to /, expects 2XX or 3XX)
- Masakari (OPTIONS to /, expects 2XX or 3XX)
- Mistral (OPTIONS to /, expects 2XX or 3XX)
- Nova API (OPTIONS to /, expects 2XX or 3XX)
- Nova Metadata (OPTIONS to /, expects 2XX or 3XX)
- Neutron (OPTIONS to /, expects 2XX or 3XX)
- Opensearch (OPTIONS to /, expects 2XX or 3XX)
- Opensearch Dashboards (OPTIONS to /, expects 401)
- Placement (GET to /, expects 2XX or 3XX)
- Prometheus (OPTIONS to /, expects 2XX or 3XX)
- Prometheus AlertManager (OPTIONS to /, expects 2XX or 3XX)
- Prometheus Openstack Exporter (OPTIONS to /, expects 2XX or 3XX)
- Prometheus Server (OPTIONS to /, expects 2XX or 3XX)
- Skyline API (OPTIONS to /docs, expects 2XX or 3XX)
- Skyline Console (GET to /, expects 2XX or 3XX)
- Swift (OPTIONS to /info, expects 2XX or 3XX)
- Trove (OPTIONS to /, expects 2XX or 3XX)
- Venus (OPTIONS to /, expects 2XX or 3XX)
- Watcher (GET to /, expects 2XX or 3XX)
- Zun (OPTIONS to /, expects 2XX or 3XX)
[SEP]
FILES CHANGED:
ansible/roles/mistral/defaults/main.yml (+4, -0)
ansible/roles/horizon/defaults/main.yml (+2, -0)
ansible/roles/skyline/defaults/main.yml (+8, -0)
ansible/roles/neutron/defaults/main.yml (+4, -0)
ansible/roles/heat/defaults/main.yml (+8, -0)
ansible/roles/cinder/defaults/main.yml (+4, -0)
ansible/roles/manila/defaults/main.yml (+4, -0)
ansible/roles/cloudkitty/defaults/main.yml (+4, -0)
ansible/roles/blazar/defaults/main.yml (+10, -0)
ansible/roles/placement/defaults/main.yml (+4, -0)
ansible/roles/keystone/defaults/main.yml (+2, -0)
ansible/roles/prometheus/defaults/main.yml (+10, -0)
ansible/roles/glance/defaults/main.yml (+4, -0)
releasenotes/notes/haproxy_healthchecks_to_l7-b05e8c7b177d1544.yaml (+5, -0)
ansible/roles/swift/defaults/main.yml (+4, -0)
ansible/roles/designate/defaults/main.yml (+4, -0)
ansible/roles/grafana/defaults/main.yml (+4, -0)
ansible/roles/barbican/defaults/main.yml (+4, -0)
ansible/roles/trove/defaults/main.yml (+4, -0)
ansible/roles/gnocchi/defaults/main.yml (+4, -0)
ansible/roles/masakari/defaults/main.yml (+4, -0)
ansible/roles/venus/defaults/main.yml (+4, -0)
ansible/roles/aodh/defaults/main.yml (+4, -0)
ansible/roles/nova/defaults/main.yml (+8, -0)
ansible/roles/ironic/defaults/main.yml (+8, -0)
ansible/roles/opensearch/defaults/main.yml (+8, -0)
ansible/roles/magnum/defaults/main.yml (+4, -0)
ansible/roles/zun/defaults/main.yml (+4, -0)
ansible/roles/watcher/defaults/main.yml (+4, -0)
",-4.54286,3.476246,2.753414,0.055215,1.28575,1.64033,-2.441773,-0.624499,-1.518623,0.480011,-0.537559,0.152158,1.119889,0.626612,-0.61399
openstack/kolla-ansible,I96151bb6809a4bf0f17dd3e0e97a654730881869,0,0,0.9259,2.1972,0.0,2,8.0,103,0,CI,0,0,0,54,0.061714,0.6,0,0.5556,4,2,0,0.7299,0.9544,3.0,-33.93,23.2,1,0,0.0,1,11.4444,0,0,0,0,0,"heat: set backups_enabled based on cinder-backup
[SEP]
FILES CHANGED:
releasenotes/notes/heat-volumes-backup-enabled-4e9799558677e6cd.yaml (+5, -0)
ansible/roles/heat/templates/heat.conf.j2 (+3, -0)
",1.816248,1.652685,0.148325,0.553803,1.408445,-0.312023,-0.370097,-0.87066,-0.108981,-0.627234,0.044337,-0.318405,-0.03074,-0.325195,0.18068
openstack/ironic,I7687ff1eddb14d22b981860d4c4c9b172bae45b7,1,0,0.9744,2.0794,0.2857,1,32.83,1185,0,Bug Fix,0,0,0,39,0.013171,1.0,0,0.9744,2,1,0,0.9561,0.0,2.0,40.81,19.02,0,0,0.0,0,148.125,0,0,0,0,0,"Fix spurious CI job failures around partition images

Cirros partition images have some underlying limitations,
meaning it is not ideal for any step which requires the image
to hae commands executed in it to perform operations, such as
mounting additional filesystems in UEFI mode, or installing
grub in BIOS mode.

This is because cirros images are an unpacked ramdisk, in other
words, the posted disk image *has no* contents on the root
filesystem of the image. While we attempt to unpack[0] this as well,
this can also fail creating false failures resulting in check
jobs failing and then working on recheck.

As the constraint is the same as the BIOS mode check, and there
is no realistic fix, this change removes the boot mode check and
thus always disables partition image testing with tempest *when*
cirros is in use.

note 0: We presently unpack using a virtual machine launch so it
takes place with the same process as when cirros starts, however
linux doesn't always boot, and the tools don't really determine
if that is the case or not, and if we retool it, we should just
move to a direct extraction and image re-pack.
[SEP]
FILES CHANGED:
devstack/lib/ironic (+5, -2)
",-2.575578,-1.666907,3.514166,-0.672107,-0.402435,-0.188473,-0.007535,-0.368747,-0.473772,0.008822,-0.149144,0.213167,0.021026,-0.22852,-0.096372
openstack/kolla,Ibf4d24657f246a191a4b4c1ab95b47d6873e468a,0,0,0.6381,3.8067,0.5682,5,6.0,114,0,Feature,0,0,0,105,0.011929,0.7,0,0.4467,2,3,0,0.7442,2.2743,2.0,31.55,12.4,0,1,0.2045,0,2.5333,0,0,0,0,0,"[2024.1 only] switch rpm distros to Cloud SIG Caracal repos
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -12)
docker/base/ci-centos.repo (+8, -0)
tests/templates/template_overrides.j2 (+1, -8)
docker/base/ci-rocky.repo (+8, -0)
kolla/common/config.py (+1, -5)
",1.387164,0.592822,0.228012,-0.519669,0.166789,-0.18553,0.103922,1.124613,-1.33103,0.578495,0.423907,0.026444,-0.072406,-0.487722,-0.949662
openstack/kolla-ansible,I70dd1751dea6bfc9bb265aeda04b3392e135324c,1,1,0,2.1972,0.125,2,11.5,217,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.7282,0.5436,2.0,7.57,16.77,1,0,0.0,1,24.1111,0,22,0,46,0,"Fix kolla-ansible systemd restart behaviour

Fix kolla systemd unit template to prevent restart
all kolla services with docker.service restart

Closes-Bug: 2065168
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_systemd_worker.py (+0, -1)
releasenotes/notes/fix-systemd-restart-5fc282419cf13589.yaml (+7, -0)
",1.393461,-1.034716,-0.335918,-0.608638,-0.177233,-0.344012,-0.592049,0.430989,-0.127999,-0.767379,0.015401,0.115916,0.424319,0.061899,0.121354
openstack/charm-ceph-mon,If64d82dd49137784ba2f5f9e748febf189ddecfb,0,0,0.4615,4.9488,0.0071,1,9.67,292,0,CI,0,0,0,13,0.00484,0.0,0,0.0,2,1,0,0.9444,0.0,2.0,7.4,17.66,1,0,0.0,0,2.0709,0,0,0,0,0,"Implement remaining bits of key rotation on Reef

This patchset implements the remaining bits on key rotation for
Reef, importing it from the main branch.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1205
[SEP]
FILES CHANGED:
src/ops_actions/rotate_key.py (+139, -1)
",-0.374495,1.141904,-1.210139,0.424453,-0.614032,-0.288559,0.017343,0.155673,0.057822,-0.334491,-0.356888,0.096991,0.113337,-0.171367,0.336532
openstack/kolla-ansible,I616bf3a3dbb4d963665b1621a9e5e9d417b13942,1,1,0.6321,2.6391,0.0,3,15.0,231,0,Bug Fix,0,0,0,106,0.011983,0.1111,0,0.0702,4,1,0,0.7288,1.2957,4.0,33.69,14.0,0,0,0.0,0,16.5,0,6,0,6,0,"neutron: add service role

After Neutron policy changes - Octavia jobs started
to fail on cascade LB deletion due to Neutron user
not having service role.

Closes-Bug: #2065337
[SEP]
FILES CHANGED:
ansible/roles/neutron/tasks/upgrade.yml (+7, -0)
ansible/roles/neutron/defaults/main.yml (+5, -0)
ansible/roles/neutron/tasks/register.yml (+1, -0)
",0.685732,-1.367449,-0.459516,-0.34546,-0.37468,0.006752,-0.497606,0.219378,-0.258591,-0.463786,0.134122,0.007507,0.251873,-0.006142,-0.047079
openstack/kolla,Idadfad79eb566f2c45c5e36d4c25f4d23f2bbbd9,1,0,0.8,4.6913,0.1481,25,4.3,288,0,CI,0,0,0,10,0.022989,0.6,0,0.48,3,8,0,0.7407,3.9103,2.84,66.72,7.3,0,0,0.0,1,2.6422,0,0,0,0,0,"Build RabbitMQ 3.11, 3.12 and 3.13 in 2023.1

An operator will need to upgrade to 3.12 before a SLURP upgrade to
Caracal, which has 3.13.

Also provide 3.13 if an operator wishes to use the latest supoorted
RabbitMQ release in 2023.1
[SEP]
FILES CHANGED:
docker/rabbitmq/rabbitmq-3-13/apt_preferences_rabbitmq.debian (+7, -0)
docker/rabbitmq/rabbitmq/apt_preferences_rabbitmq.ubuntu (+2, -2)
docker/rabbitmq/rabbitmq-3-13/Dockerfile.j2 (+1, -0)
kolla/template/repos.yaml (+24, -4)
docker/rabbitmq/rabbitmq-3-13/extend_start.sh (+1, -0)
docker/rabbitmq/rabbitmq-3-12/Dockerfile.j2 (+1, -0)
docker/rabbitmq/rabbitmq-3-12/healthcheck_rabbitmq (+1, -0)
docker/rabbitmq/rabbitmq-3-13/rabbitmq_packages_rpm.rocky (+4, -0)
docker/rabbitmq/rabbitmq-3-12/apt_preferences_rabbitmq.debian (+7, -0)
docker/rabbitmq/rabbitmq-3-12/extend_start.sh (+1, -0)
docker/rabbitmq/rabbitmq/rabbitmq_packages_rpm.centos (+4, -0)
docker/rabbitmq/rabbitmq-3-12/rabbitmq_packages_rpm.centos (+4, -0)
docker/rabbitmq/rabbitmq-3-12/rabbitmq_packages_rpm.rocky (+4, -0)
docker/rabbitmq/rabbitmq/rabbitmq_packages_rpm.rocky (+4, -0)
docker/rabbitmq/rabbitmq/healthcheck_rabbitmq (+0, -0)
docker/kolla-toolbox/apt_preferences_rabbitmq.ubuntu (+1, -1)
docker/rabbitmq/rabbitmq-3-12/apt_preferences_rabbitmq.ubuntu (+7, -0)
docker/rabbitmq/rabbitmq/Dockerfile.j2 (+3, -5)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
docker/rabbitmq/rabbitmq-3-13/apt_preferences_rabbitmq.ubuntu (+7, -0)
docker/rabbitmq/rabbitmq-3-13/rabbitmq_packages_rpm.centos (+4, -0)
docker/rabbitmq/rabbitmq/extend_start.sh (+0, -0)
docker/rabbitmq/rabbitmq/apt_preferences_rabbitmq.debian (+2, -2)
docker/kolla-toolbox/apt_preferences_rabbitmq.debian (+1, -1)
docker/rabbitmq/rabbitmq-3-13/healthcheck_rabbitmq (+1, -0)
",-0.20872,-0.22848,-0.487894,0.569816,0.089619,0.349617,0.151713,0.741242,-0.498453,1.185538,-0.171643,0.412845,-0.360415,0.172951,0.442536
openstack/charm-ceph-osd,I1328d2c6221c77bfe0f2420af770cc5064394c57,1,0,0.9744,3.5835,0.4857,6,5.6,289,0,Bug Fix,0,0,0,39,0.003691,1.0,0,0.9744,2,3,0,0.875,2.1287,0.67,10.8,12.24,1,0,0.5714,1,8.0278,0,0,0,0,0,"Fixes for ceph squid

Make caracal the default source. Add python3-packaging package as a
tactical fix for bug #2064717. Add a local caracal functest.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1209
[SEP]
FILES CHANGED:
hooks/ceph_hooks.py (+5, -1)
tests/tests.yaml (+1, -3)
osci.yaml (+3, -3)
.zuul.yaml (+0, -1)
config.yaml (+1, -1)
tests/bundles/local-jammy-caracal.yaml (+8, -8)
",-0.655853,0.839334,-1.084006,-0.059584,-0.586218,-0.780058,0.191741,0.443608,-0.042638,-0.026169,0.109072,-0.015643,0.220026,-0.218327,0.470909
openstack/kolla-ansible,I3c92a80b1db9422e72d769b4747fb282ac4ff52a,1,1,0.8182,2.8332,0.0,7,8.6,357,0,Bug Fix,0,0,0,11,0.020258,0.1429,0,0.1169,4,2,0,0.7295,2.4363,3.71,32.84,10.88,1,0,0.0,1,21.0,0,6,0,4,0,"Cinder and Nova: add service role

This role is registered in Keystone [1], but Nova and Cinder deployment
will break if Keystone is skipped. Register this role in Nova and Cinder
tasks too to prevent this failure.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/909002

Closes-Bug: #2065578
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+3, -0)
ansible/roles/cinder/tasks/upgrade.yml (+1, -0)
releasenotes/notes/cinder-nova-register-service-role-46a5a745ca697654.yaml (+6, -0)
ansible/roles/nova/defaults/main.yml (+3, -0)
ansible/roles/nova/tasks/register.yml (+1, -0)
ansible/roles/nova/tasks/upgrade.yml (+1, -0)
ansible/roles/cinder/tasks/register.yml (+1, -0)
",-0.370532,0.623087,-0.776529,-0.028298,-1.048503,-0.16756,0.162211,0.38434,-0.007282,0.044129,0.197574,-0.247182,0.342554,-0.034131,-0.329159
openstack/octavia,I325de85b03080db646da847b58c15c3fbbdc6be2,1,0,0.4915,3.9512,0.3922,3,10.0,417,0,Bug Fix,0,0,0,118,0.004179,0.5,0,0.2458,7,2,0,0.6017,1.3155,4.67,17.33,13.6,0,0,0.4902,1,8.0192,0,0,0,0,0,"Fix listener update when using SRIOV VIP

The previous patch[1] that added a check for Amphora status missed
adding a task that generates the Amphora status information when a
listener is updated.
This patch corrects that by adding the AmphoraeGetConnectivityStatus
task to the firewall rules subflow.

[1] https://review.opendev.org/c/openstack/octavia/+/912599
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/flows/test_listener_flows.py (+10, -15)
releasenotes/notes/Fix-Listener-Update-for-SRIOV-VIPs-8348b7fe0c02b9c4.yaml (+4, -0)
octavia/controller/worker/v2/flows/listener_flows.py (+17, -5)
",-0.38098,0.146335,-0.09208,0.186708,-0.8044,0.04613,0.698554,0.395377,0.563275,-0.136171,0.2334,-0.160785,-0.014541,-0.022587,-0.02721
openstack/openstack-ansible-os_keystone,I5d9505ed4b385673cc719e9821ee2e1c2ba5c754,1,1,0.9503,3.091,0.1905,2,3.8,339,0,Bug Fix,0,0,0,161,0.049768,0.9348,0,0.8883,2,2,0,1.0,0.9587,1.5,-130.97,18.36,0,0,0.0,1,15.4091,0,6,0,2,0,"Change example to contain domain name instead of UUID

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/930272
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/930446
Related-Bug: #2065680
Closes-Bug: #2064718
[SEP]
FILES CHANGED:
defaults/main.yml (+4, -4)
releasenotes/notes/federated_domain_names-4e169b8b9a947940.yaml (+13, -0)
",-2.178852,4.504259,-1.622954,0.883374,-0.284537,0.193331,-0.117635,-0.197281,0.083046,-0.37717,-0.170392,-0.079651,0.686217,-0.080735,0.503094
openstack/kolla-ansible,Iad34c3340325d2aad0f468d88e94007823871a41,1,0,0,2.1972,1.0,1,6.0,79,0,Feature,0,0,0,0,0.0,0.0,1,0.0,4,1,0,0.7301,0.0,4.0,3.34,15.73,0,0,0.0,0,8.7778,0,0,0,0,0,"Remove mistral and redis
[SEP]
FILES CHANGED:
doc/source/reference/orchestration-and-nfv/tacker-guide.rst (+0, -8)
",2.845138,1.859319,1.147984,0.677618,1.627945,0.3312,0.569886,0.016904,-0.482624,-0.715719,-0.28094,0.112246,0.228214,0.01036,0.085762
openstack/kolla-ansible,I7b11359cee931273a058364160b64fe1fb606b5e,0,0,0.75,2.9957,0.4737,2,7.75,256,0,Bug Fix,0,0,0,4,0.001898,0.0,0,0.0,4,2,0,0.7308,0.8997,3.0,35.23,12.13,1,0,0.0,1,12.8,0,0,0,0,0,"Fix: Update Skyline stop task

Update Sykline stop task to use the
service-stop role to symplify the task
and make sure it is using kolla_container.

Authored-By: Roman Krƒçek <roman.krcek@tietoevry.com>
[SEP]
FILES CHANGED:
releasenotes/notes/skyline-stop-7eb0d8770335a9ca.yaml (+6, -0)
ansible/roles/skyline/tasks/stop.yml (+4, -9)
",-0.333242,0.361361,-1.335612,0.251653,-0.632011,-0.260073,0.207967,0.187062,-0.061447,-0.624776,0.788974,0.297664,0.040707,0.643192,-0.618494
openstack/openstack-ansible-rabbitmq_server,I5211a30899f544a9f7e609e85551a92b245d25bf,1,1,1.0,4.3175,0.0,4,12.75,376,0,Bug Fix,0,0,0,43,0.066874,0.9583,0,0.9583,2,2,0,0.8333,1.4614,1.25,42.94,13.73,0,0,0.0,1,5.0133,0,16,0,11,0,"Enable feature flags post-upgrade

Stable feature flags must be enabled before upgrades to ensure
the service can still start. These additional tasks check for
any disabled feature flags and enable them. This is done
immediately after upgrades so that systems can run with them
enabled striaght away.

Closes-Bug: #2038818
[SEP]
FILES CHANGED:
tasks/main.yml (+4, -0)
releasenotes/notes/feature-flags-9faf32a3d49af4fc.yaml (+6, -0)
tasks/rabbitmq_feature_flags.yml (+45, -0)
vars/main.yml (+19, -0)
",-0.189817,-1.838714,-0.217426,0.475447,-0.192296,0.038033,-0.199679,-0.26073,0.201481,0.065816,-0.197815,0.028796,0.498553,0.008748,0.204508
openstack/charm-rabbitmq-server,Ifc8634bbf2eb3f66a3a922d0f2aeb4b668b06a54,1,0,0.963,5.6021,0.2593,15,5.33,156,0,Feature,0,0,0,27,0.010753,1.0,0,0.963,4,3,0,1.0,3.2824,3.0,-10.08,22.13,1,0,0.0,1,0.5756,0,0,0,0,0,"Sync charmhelpers to pull in jammy-caracal codename.

This is required for the jammy-caracal release.
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/section-audit-middleware-notifications (+4, -0)
charmhelpers/contrib/openstack/utils.py (+22, -27)
charmhelpers/contrib/storage/linux/lvm.py (+1, -5)
charmhelpers/fetch/snap.py (+1, -1)
charmhelpers/osplatform.py (+20, -8)
charmhelpers/contrib/storage/linux/ceph.py (+6, -2)
charmhelpers/fetch/ubuntu.py (+10, -0)
charmhelpers/contrib/openstack/cert_utils.py (+21, -12)
charmhelpers/contrib/openstack/templates/wsgi-openstack-api.conf (+1, -1)
charmhelpers/core/host.py (+5, -2)
charmhelpers/contrib/openstack/templates/wsgi-openstack-metadata.conf (+1, -1)
charmhelpers/core/unitdata.py (+38, -1)
charmhelpers/contrib/openstack/context.py (+21, -5)
charmhelpers/contrib/network/ip.py (+43, -5)
charmhelpers/contrib/openstack/templates/section-filter-audit (+6, -0)
",0.736525,1.365978,-1.289368,0.951596,0.471878,-0.034103,0.855378,-0.109578,-0.63431,-0.3497,1.069494,0.720178,-0.545674,0.044474,0.148955
openstack/openstack-ansible,I588e0d3b15e7683ff79b64ecc61a06af94b5d7df,1,0,0.8148,2.6391,1.0,1,16.0,144,0,Feature,1,0,0,27,0.182432,0.4074,0,0.332,1,1,0,0.9286,0.0,1.0,5.53,21.4,0,0,1.0,1,10.2857,0,0,0,0,0,"Remove murano, senlin and sahara from zuul required projects

These repos are now retired
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+0, -13)
",0.774589,0.252145,-1.146645,0.228533,0.649621,0.434203,0.001374,-0.588008,-0.887362,-0.494321,0.454164,0.655513,-0.137591,0.343335,-0.888237
openstack/kolla,Iceb16a5cf2ebc64effe30bbc9144144cdffebab0,0,0,0.6355,1.6094,0.25,1,4.0,113,1,Feature,0,0,0,107,0.012078,0.0,0,0.0,3,1,0,0.7419,0.0,3.0,-82.75,21.6,0,0,0.0,0,22.6,0,0,0,0,0,"opensearch: remove example certs and securityadmin_demo.sh
[SEP]
FILES CHANGED:
docker/opensearch/opensearch/Dockerfile.j2 (+3, -1)
",1.765164,0.062622,0.501615,-0.723416,0.574127,-0.862436,-0.265137,0.207585,-0.644282,-0.63601,-0.22475,-0.582612,-1.089967,0.370579,0.165507
openstack/kolla-ansible,I85479a64821686f81a3592aa5620e1628dcb5c73,0,0,0.7857,1.0986,0.5,1,3.5,89,0,CI,1,0,0,28,0.01116,0.5263,0,0.4135,1,1,0,0.729,0.0,1.0,9.91,18.54,0,0,1.0,1,29.6667,0,0,0,0,0,"CI: Use 2024.1 as previous_release
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",2.522447,1.501517,0.818157,0.03419,0.521825,0.923655,-0.462207,0.185481,0.313504,0.78127,0.267985,-0.226338,-0.287527,0.581908,0.052293
openstack/ansible-collection-kolla,Ic3dd0ce30a8436406a451276bbd94cb5f6f33f9d,0,0,0.4444,1.7918,0.0,1,4.5,677,0,Feature,0,0,0,9,0.03913,0.0,0,0.0,2,1,0,0.8,0.0,2.0,-11.25,11.32,1,0,0.0,1,112.8333,0,0,0,0,0,"Use deb822 format for Apt repositories on Ubuntu and drop apt-key

Use the modern deb822 format [1] for Apt repositories on Ubuntu the
same way as in OpenStack Kolla projects, for example in Kayobe [2].
Also this change refactor usage of the deprecated [3] apt-key tool.

[1] https://manpages.ubuntu.com/manpages/jammy/en/man5/sources.list.5.html#deb822-style%20format
[2] I3f821937b0930a0ac9341178de7ae5123d82b957
[3] https://manpages.ubuntu.com/manpages/jammy/en/man8/apt-key.8.html#deprecation

(cherry picked from commit 2ab88e699019ae33b48c28ad4c9f87d0877e46e9)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-apt-repositories-and-drop-apt-key-ff4c062f5689c91e.yaml (+5, -0)
",-3.489216,2.196463,0.890911,-1.118584,0.45789,0.012329,0.748219,0.241252,-0.072344,0.253766,-0.025752,-0.016477,0.052779,-0.128549,-0.318485
openstack/kayobe,I2a996fa22fedece2c894b378fadbfc5dd0c045b6,0,1,0,1.0986,0.5,1,12.0,393,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.9412,0.0,4.0,59.3,10.13,0,0,0.0,0,131.0,0,6,0,4,0,"Add type for mtu field in docker role

Closes-Bug: #2066032

This patch adds an integer type to the task in the docker role that
generates the docker daemon config. This was previously uncast and
defaulting to a string type, which causes an error with certain docker
versions (via the Rocky 9.3 distro). See bug description for more info.
[SEP]
FILES CHANGED:
ansible/roles/docker/tasks/main.yml (+1, -1)
",0.04256,-1.851405,0.021851,0.114875,-0.492255,0.152593,0.353765,0.431904,0.498023,0.273532,-0.107955,0.052526,0.068913,0.00066,0.120028
openstack/octavia,I9150da04214f470060020123813bb71235acbc20,1,0,0.4958,3.4657,0.2903,3,10.4,425,0,Bug Fix,0,0,0,119,0.004207,0.4444,0,0.2204,7,2,0,0.6029,1.383,4.67,23.83,13.39,0,0,0.3226,1,13.2812,0,0,0,0,0,"Fix failover when using SRIOV VIP

The previous patch[1] that added a check for Amphora status missed
adding a task that generates the Amphora status information when a
failvoer is triggered.
This patch corrects that by adding the AmphoraeGetConnectivityStatus
task to the get amphora for lb failover subflow.

[1] https://review.opendev.org/c/openstack/octavia/+/912599
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/flows/test_load_balancer_flows.py (+4, -6)
octavia/controller/worker/v2/flows/amphora_flows.py (+14, -3)
releasenotes/notes/Fix-failover-for-SRIOV-VIPs-e2ab193c0de5eb1d.yaml (+4, -0)
",-0.557947,0.191173,-0.063542,0.115548,-0.625484,0.007009,0.692636,0.386802,0.509786,-0.192217,0.307943,-0.116529,-0.014151,-0.073782,0.093828
openstack/kolla-ansible,I3c0ad7652a03388ab2eafa173c644a55b0405cc6,0,0,0.0,3.6376,0.0,8,8.5,262,0,CI,0,0,0,2,0.005682,0.6667,0,0.0,4,4,0,0.7273,2.427,3.25,48.91,9.28,1,0,0.0,1,6.8947,0,0,0,0,0,"Add NVMe-TCP Cinder driver support for Pure Storage

From OpenStack 2023.2 (Bobcat) the Pure Storage Cinder driver
supports NVMe-TCP as a dataplane protocol. This patch adds support
for this new driver type.
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+3, -0)
doc/source/reference/storage/cinder-guide.rst (+3, -0)
releasenotes/notes/pure-nvme-tcp-driver-added.yaml-db8e3496376e843c.yaml (+5, -0)
ansible/roles/cinder/tasks/precheck.yml (+1, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+9, -0)
doc/source/reference/storage/cinder-guide-pure.rst (+14, -0)
etc/kolla/globals.yml (+1, -0)
",-0.00992,0.09735,-0.72926,1.015106,0.119551,0.333029,-0.042705,1.326413,-0.085199,0.423948,-0.034445,0.956553,0.240497,-0.630809,-0.188569
openstack/openstack-ansible-os_cinder,Ic1e190fc86bd3b6fd2cc771273e28b5bb095a322,1,0,0.9506,2.7081,0.0714,3,13.83,573,0,Feature,0,0,0,162,0.049754,0.96,0,0.9126,2,2,0,1.0,1.4316,1.33,45.0,11.32,0,0,0.0,1,38.2,0,0,0,0,0,"Allow to skip volume type management by role

Right now it is not possible to avoid creation of a default volume type
which will have the same name as a backend. In case operator want to
rename volume type or have a different name - it will not be possible
as of today.

While we should migrate to using openstack_resources role for managing
of QoS and volume_types [1], the patch/modules are not ready and will
not be backportable anyway.

[1] https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/906372
[SEP]
FILES CHANGED:
tasks/main.yml (+6, -1)
releasenotes/notes/allow_to_skip_volume_types-8698ec60660a0510.yaml (+5, -0)
defaults/main.yml (+2, -0)
",-1.15925,-0.785216,0.689915,0.049938,-0.553676,-0.527702,0.403881,-0.046142,0.131998,0.174471,-0.167252,0.096315,-0.211614,-0.202647,-0.362812
openstack/kolla,I64e9442545d98364585e3c632ae9142cd6b4f9bf,1,1,0.8333,2.7081,0.0,4,11.5,225,0,Bug Fix,0,0,0,12,0.021467,1.0,0,0.8333,2,4,0,0.7385,1.5917,2.0,7.57,20.25,1,0,0.0,1,15.0,0,6,0,14,0,"Pass rabbitmq apt preferences into kolla-toolbox

If the latest and targeted rabbitmq-server dependencies mismatch,
kolla-toolbox will fail to build.

Closes-Bug: #2066171
[SEP]
FILES CHANGED:
docker/kolla-toolbox/apt_preferences_rabbitmq.debian (+1, -0)
releasenotes/notes/pass-rmq-preferences-into-kolla-toolbox-32d7209c4cf1f3c9.yaml (+6, -0)
docker/kolla-toolbox/apt_preferences_rabbitmq.ubuntu (+1, -0)
docker/kolla-toolbox/Dockerfile.j2 (+6, -0)
",0.384104,0.162739,-0.954738,0.226121,0.05273,-0.310726,-0.399429,0.072419,-0.296876,-0.487519,0.14319,0.110452,-0.034279,-0.11334,0.291278
openstack/openstack-ansible,Idf33b6810e1afb3a89dad5e65a48e86ac0a58a67,1,0,1.0,2.9444,0.0,2,12.0,499,0,Feature,0,0,0,44,0.061367,0.0,0,0.0,2,2,0,0.9294,0.8524,1.5,15.59,13.47,0,0,0.0,1,26.2632,0,0,0,0,0,"Enable RabbitMQ feature flags pre-upgrade

This task must be carried out before any RabbitMQ instances are
stopped, so must live in the playbook as opposed to the role.

This complements the post-upgrade enablement which happens within
the role itself, and covers the case where older versions of the
role have not already enabled the relevant flags.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/919701
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-feature-flags-d1a0f3fd4e17cbf4.yaml (+5, -0)
playbooks/rabbitmq-install.yml (+13, -0)
",-1.410282,0.454871,0.009318,0.535507,-0.516744,0.000869,0.606486,0.130011,0.252245,-0.147946,0.331742,0.353071,0.08024,-0.048755,0.223548
openstack/charm-designate-bind,I87263ac24e5e4061757e5fb8bb167a43b2e85f93,1,1,1.0,1.9459,0.0,1,8.33,399,0,Bug Fix,1,0,0,9,0.130435,0.0,0,0.0,1,1,0,0,0.0,1.0,35.94,12.13,0,0,1.0,0,57.0,0,6,0,5,0,"Fix mocking for wrapped OpenStack releases

A recent change in charms.openstack to support wrapped
OpenStack releases caused unit tests to fail.
The unit tests failed because mocking was incompatible
with the change. This commit mocks the default_get_charm
instance where the charms.openstack change was breaking
unit tests.

Closes-Bug: 2066281
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_designate_bind.py (+6, -0)
",-0.749654,-1.525768,-0.457334,0.229669,-0.35502,0.065698,-0.47057,0.258361,0.046529,0.06518,0.176581,-0.11322,-0.025315,0.012561,0.568374
openstack/ironic-python-agent,Iebc5b6d2440bfc9f23daa322493379bbe69e84d0,1,1,1.0,5.3753,0.2884,10,14.8,520,0,Bug Fix,0,0,0,3,0.01087,1.0,0,1.0,4,3,0,0.931,2.4129,2.4,39.76,12.41,0,0,0.614,1,2.4074,0,6,0,9,0,"Call evaluate_hardware_support exactly once per hwm

Fixes an issue where we could call evaluate_hardware_support multiple
times each run. Now, instead, we cache the values and use the cache
where needed.

Adds unit test coverage for get_managers and the new method.
Fixes issue where we were caching hardware managers between unit tests.

Also includes fixes for codespell CI:
- skip build files in repo
- fix spelling issues introduced to repo

Closes-bug: 2066308
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+41, -28)
ironic_python_agent/tests/unit/extensions/test_service.py (+13, -7)
ironic_python_agent/tests/unit/extensions/test_clean.py (+13, -7)
ironic_python_agent/tests/unit/base.py (+1, -0)
releasenotes/notes/mix-and-match-disk-detection-58db04403ce220a0.yaml (+1, -1)
ironic_python_agent/tests/unit/test_hardware.py (+61, -10)
ironic_python_agent/utils.py (+2, -2)
setup.cfg (+1, -0)
ironic_python_agent/tests/unit/extensions/test_deploy.py (+13, -7)
releasenotes/notes/only-run-evaluate-hardware-support-once-9ec1ae327b4e03f2.yaml (+7, -0)
",-0.946794,-1.325976,0.448502,0.108852,-0.022273,-0.18717,-0.367205,-0.146249,-0.106401,0.058311,0.106915,-0.500834,0.465441,0.045041,0.252767
openstack/kolla-ansible,Ieba0baf154ead063a1bc244aaadd4ca53c814ad3,1,0,0.6296,1.0986,0.5,1,3.0,181,0,Doc,1,0,0,108,0.012185,0.1429,0,0.0899,1,1,0,0.7255,0.0,1.0,-85.26,14.53,0,0,1.0,0,60.3333,0,0,0,0,0,"CI: Pin requests to <2.32 for docker sdk

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/920172
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",-1.756972,1.151478,-1.706014,-1.779137,0.666049,-0.128015,1.023971,-0.057555,0.0788,0.261431,-0.203703,0.000209,0.511745,0.0163,-0.116484
openstack/ansible-collection-kolla,I274d698956303af832972c2c5e16509f2053bd5b,1,1,0.633,0.6931,0.0,1,6.5,142,0,Bug Fix,0,0,0,109,0.012296,1.0,0,0.633,3,1,0,0.6667,0.0,3.0,11.51,17.98,0,0,0.0,0,71.0,0,8,0,5,0,"docker_sdk: Pin requests to <2.32 due to docker-py incompatibility

Closes-Bug: #2066364
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+1, -0)
",-0.337232,-0.566096,-2.164028,-2.012041,0.786393,0.059696,-0.067385,-0.019817,-0.006369,0.255564,-0.384744,-0.004674,0.021621,-0.305956,0.144463
openstack/ansible-collection-kolla,I274d698956303af832972c2c5e16509f2053bd5b,1,1,0.6364,0.6931,0.0,1,6.5,142,0,Bug Fix,0,0,0,110,0.012407,1.0,0,0.6364,3,1,0,0.7143,0.0,3.0,11.51,17.98,0,0,0.0,0,71.0,0,8,0,5,0,"docker_sdk: Pin requests to <2.32 due to docker-py incompatibility

Closes-Bug: #2066364
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+1, -0)
",-0.337232,-0.566096,-2.164028,-2.012041,0.786393,0.059696,-0.067385,-0.019817,-0.006369,0.255564,-0.384744,-0.004674,0.021621,-0.305956,0.144463
openstack/ansible-collection-kolla,I274d698956303af832972c2c5e16509f2053bd5b,1,1,0.6396,0.6931,0.0,1,6.5,142,0,Bug Fix,0,0,0,111,0.012518,1.0,0,0.6396,3,1,0,0.75,0.0,3.0,11.51,17.98,0,0,0.0,0,71.0,0,8,0,5,0,"docker_sdk: Pin requests to <2.32 due to docker-py incompatibility

Closes-Bug: #2066364
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+1, -0)
",-0.337232,-0.566096,-2.164028,-2.012041,0.786393,0.059696,-0.067385,-0.019817,-0.006369,0.255564,-0.384744,-0.004674,0.021621,-0.305956,0.144463
openstack/kolla-ansible,Ieba0baf154ead063a1bc244aaadd4ca53c814ad3,1,0,0.6429,1.0986,0.5,1,3.0,181,0,Doc,1,0,0,112,0.01263,0.25,0,0.1607,1,1,0,0.7262,0.0,1.0,-85.26,14.53,0,0,1.0,0,60.3333,0,0,0,0,0,"CI: Pin requests to <2.32 for docker sdk

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/920172
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",-1.756972,1.151478,-1.706014,-1.779137,0.666049,-0.128015,1.023971,-0.057555,0.0788,0.261431,-0.203703,0.000209,0.511745,0.0163,-0.116484
openstack/ansible-collection-kolla,I274d698956303af832972c2c5e16509f2053bd5b,1,1,0.646,0.6931,0.0,1,9.0,211,0,Bug Fix,0,0,0,113,0.01274,1.0,0,0.646,3,1,0,0.7778,0.0,3.0,14.4,16.93,0,0,0.0,0,105.5,0,8,0,5,0,"docker_sdk: Pin requests to <2.32 due to docker-py incompatibility

Closes-Bug: #2066364
(cherry picked from commit cf7b405c4aa788bb307020b739c93094ae0050a9)
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+1, -0)
",-0.337232,-0.566096,-2.164028,-2.012041,0.786393,0.059696,-0.067385,-0.019817,-0.006369,0.255564,-0.384744,-0.004674,0.021621,-0.305956,0.144463
openstack/kolla-ansible,Ieba0baf154ead063a1bc244aaadd4ca53c814ad3,1,0,0.6491,1.0986,0.5,1,4.25,250,0,Doc,1,0,0,114,0.012851,0.3333,0,0.2164,1,1,0,0.7268,0.0,1.0,-51.28,13.46,0,0,1.0,0,83.3333,0,0,0,0,0,"CI: Pin requests to <2.32 for docker sdk

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/920172

(cherry picked from commit 160a81b8bdf9185ab175d15446631c5877556aa3)
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",-1.756972,1.151478,-1.706014,-1.779137,0.666049,-0.128015,1.023971,-0.057555,0.0788,0.261431,-0.203703,0.000209,0.511745,0.0163,-0.116484
openstack/kolla-ansible,Ieba0baf154ead063a1bc244aaadd4ca53c814ad3,1,0,0.6522,1.0986,0.5,1,5.5,319,0,Doc,1,0,0,115,0.012961,0.4,0,0.2609,1,1,0,0.7275,0.0,1.0,-48.7,13.11,0,0,1.0,0,106.3333,0,0,0,0,0,"CI: Pin requests to <2.32 for docker sdk

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/920172

(cherry picked from commit 160a81b8bdf9185ab175d15446631c5877556aa3)
(cherry picked from commit 8e68bef04a37a9434d3ce77bb991cef41fea830b)
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",-1.756972,1.151478,-1.706014,-1.779137,0.666049,-0.128015,1.023971,-0.057555,0.0788,0.261431,-0.203703,0.000209,0.511745,0.0163,-0.116484
openstack/kolla,I11d306be5e5bb3d5b05b50dd8ee64ac9424854a1,1,0,0.6552,3.1355,0.5455,2,8.0,101,0,Doc,0,0,0,116,0.01307,1.0,0,0.6552,2,2,0,0.7397,0.4395,2.0,-44.51,28.2,0,0,0.0909,0,4.3913,0,0,0,0,0,"Drop packaging requirement and unpin docker-py
[SEP]
FILES CHANGED:
kolla/image/build.py (+9, -11)
tests/playbooks/pre.yml (+1, -1)
",0.756716,0.123132,-2.301506,-2.662247,1.691887,0.864942,0.530298,-0.62359,0.011704,-0.15734,-0.31453,0.658526,-0.240257,-0.303993,-0.597337
openstack/kolla-ansible,Ied5ef4e1e3c9346342962d44de26702522b06b86,1,1,0,3.7377,0.3415,4,20.75,671,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.7281,1.028,2.75,8.42,21.79,1,0,0.0,1,15.9762,0,6,0,10,0,"Allow to run post-deploy without privilege escalation

In deployments where `kolla-ansible` is run by a regular user,
`post-deploy` could fail when attempting to create the
`/etc/openstack` directory if privilege escalation is not
enabled/possible non-interactively.

With this change, we can run `post-deploy` with `become: false` if
root is not the owner of the `node_config` directory.

This change also removes the task creating `/etc/openstack` as this
directory is unused since the change moving the cloud config file
to `node_config`.

Related-Id: Idd458ad6ef29e4eee2f9e537b4eae39d26eb9f64
Closes-Bug: #2098887
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+1, -0)
releasenotes/notes/post-deploy-without-privilege-escalation-9427cb91d32fbd8d.yaml (+6, -0)
ansible/post-deploy.yml (+19, -13)
ansible/roles/octavia/tasks/openrc.yml (+1, -1)
",-2.416718,0.332744,1.01037,-0.65751,0.550263,0.038066,0.151207,-0.180951,0.282632,-0.543454,0.037549,0.047383,-0.165443,-0.001675,-0.188899
openstack/kolla-ansible,I0d2eb3ea6c50801a94139312399c8f8df092b4d3,1,1,0.7586,2.8904,0.1176,2,24.0,183,0,Bug Fix,0,0,0,29,0.011549,1.0,0,0.7586,4,1,0,0.7288,0.7871,4.0,41.48,14.6,1,0,0.0,0,10.1667,0,6,0,4,0,"Fix venus when proxysql used

This patch fixes defaults for venus
so it can be used with proxysql turned on

Closes-Bug: #2066937
[SEP]
FILES CHANGED:
ansible/roles/venus/defaults/main.yml (+13, -0)
ansible/roles/venus/tasks/bootstrap.yml (+2, -2)
",0.323963,-1.190462,-0.469705,-0.432893,-0.019629,0.249087,-1.140766,-0.267171,-0.688977,-0.057353,0.177059,-0.32712,0.080115,-0.579494,0.383877
openstack/kolla-ansible,I9547d5da78da30bfeea8e97056cfa9308c977098,1,1,0.7667,2.1972,0.0,2,20.0,528,0,Bug Fix,0,0,0,30,0.011867,0.0,0,0.0,4,2,0,0.7294,0.9544,3.0,40.6,16.5,1,0,0.0,1,58.6667,0,6,0,11,0,"Fix mariadb recovery

This patch modifies tasks that are delegated to
localhost to use local connection.
Firstly, this is correct since SSH connection is not used,
and secondly, it fixes the issue when kolla-ansible is
packaged in a docker container. If the local connection
is not used, the tasks will fail because temporary data are
stored outside the container, whereas we need it to be
stored inside the container so we can read them and set_facts.

Closes-Bug: #2073370
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2073370-268e9a76be9f2ae9.yaml (+5, -0)
ansible/roles/mariadb/tasks/recover_cluster.yml (+3, -0)
",-0.82434,-2.121741,0.255253,0.269955,-0.470748,-0.208508,0.564778,-0.202911,-0.043777,0.071264,0.453312,0.072845,0.120739,0.204255,-0.087788
openstack/kolla-ansible,Ief1598a017b7ff491c9fcb775fdb155628bc55d2,1,0,0.6581,1.0986,0.5,2,2.33,82,0,CI,0,0,1,117,0.013151,0.561,0,0.3692,0,2,0,0.73,1.0,0.0,59.44,12.36,0,0,0.0,1,27.3333,0,0,0,0,0,"CI: Pin codespell to <2.3.0
[SEP]
FILES CHANGED:
lint-requirements.txt (+1, -0)
tox.ini (+0, -1)
",0.310175,0.082298,-1.964945,-2.367318,1.210595,0.516983,0.039391,-0.413108,-0.126229,0.541808,-0.457362,0.346601,-0.122466,-0.094705,-0.217967
openstack/kolla-ansible,I9de6c27131ce78e85aac56ea5d91d9740fd58354,1,1,1.0,3.4965,0.0,3,24.0,278,0,Bug Fix,0,0,0,1,0.111111,0.0,0,0.0,4,3,0,0.7307,1.3663,3.33,-81.9,26.27,1,0,0.0,1,8.4242,0,12,0,13,0,"Fix octavia-interface timeout

Added Restart=on-failure policy to octavia-interface systemd unit
Added octavia_interface_wait_timeout variable to control
TimeoutStartSec in octavia-interface systemd unit

Closes-Bug: 2067036
[SEP]
FILES CHANGED:
releasenotes/notes/fix-octavia-interface-timeout-5e87ea2501d5ab3c.yaml (+10, -0)
ansible/roles/octavia/templates/octavia-interface.service.j2 (+4, -0)
doc/source/reference/networking/octavia.rst (+18, -0)
",-1.017991,0.043647,-1.233636,0.327394,0.594849,-0.353971,-1.069094,0.309846,0.219669,-0.749687,0.414938,0.364712,0.566883,0.219564,0.245024
openstack/kolla-ansible,I0ab56c49ca6393282ff2a270cf374cc1fd57c6c7,0,0,0.661,3.4965,0.125,1,6.0,86,0,Feature,0,0,0,118,0.01326,0.6667,0,0.4407,1,1,0,0.7313,0.0,1.0,-38.95,22.4,0,0,0.0,0,2.6061,0,0,0,0,0,"cli: add ansible-galaxy retries
[SEP]
FILES CHANGED:
tools/kolla-ansible (+28, -4)
",2.351647,1.901678,-0.15881,0.315593,1.385214,-0.572506,-0.153797,-0.446869,-0.248208,-0.262305,0.234571,-0.110697,0.162692,-0.373798,0.291576
openstack/kolla-ansible,Ief1598a017b7ff491c9fcb775fdb155628bc55d2,1,0,0.6555,1.0986,0.5,2,4.0,151,0,CI,0,0,1,119,0.013324,0.5663,0,0.3712,0,2,0,0.7296,1.0,0.0,40.62,11.6,0,0,0.0,1,50.3333,0,0,0,0,0,"CI: Pin codespell to <2.3.0

(cherry picked from commit 84f2cb34a081fb455552ee986ac16539dd729ba1)
[SEP]
FILES CHANGED:
lint-requirements.txt (+1, -0)
tox.ini (+0, -1)
",0.310175,0.082298,-1.964945,-2.367318,1.210595,0.516983,0.039391,-0.413108,-0.126229,0.541808,-0.457362,0.346601,-0.122466,-0.094705,-0.217967
openstack/kolla-ansible,Ief1598a017b7ff491c9fcb775fdb155628bc55d2,1,0,0.6583,0.6931,0.0,1,4.0,151,0,CI,0,0,1,120,0.013433,0.6,1,0.395,0,1,0,0.7302,0.0,0.0,40.62,11.6,0,0,0.0,0,75.5,0,0,0,0,0,"CI: Pin codespell to <2.3.0

(cherry picked from commit 84f2cb34a081fb455552ee986ac16539dd729ba1)
[SEP]
FILES CHANGED:
lint-requirements.txt (+1, -0)
",0.310175,0.082298,-1.964945,-2.367318,1.210595,0.516983,0.039391,-0.413108,-0.126229,0.541808,-0.457362,0.346601,-0.122466,-0.094705,-0.217967
openstack/kolla-ansible,Ief1598a017b7ff491c9fcb775fdb155628bc55d2,1,0,0.6612,0.6931,0.0,1,4.0,151,0,CI,0,0,1,121,0.013544,0.6667,1,0.4408,0,1,0,0.7309,0.0,0.0,40.62,11.6,0,0,0.0,0,75.5,0,0,0,0,0,"CI: Pin codespell to <2.3.0

(cherry picked from commit 84f2cb34a081fb455552ee986ac16539dd729ba1)
[SEP]
FILES CHANGED:
lint-requirements.txt (+1, -0)
",0.310175,0.082298,-1.964945,-2.367318,1.210595,0.516983,0.039391,-0.413108,-0.126229,0.541808,-0.457362,0.346601,-0.122466,-0.094705,-0.217967
openstack/openstack-ansible-os_cloudkitty,If3a37b6190449e18446e65ce3b8cb70cd9038c37,1,1,0.9509,2.1972,0.0,1,14.33,343,0,Bug Fix,0,0,0,163,0.049847,0.0,0,0.0,1,1,0,0,0.0,1.0,32.92,17.83,0,0,0.0,0,38.1111,1,6,0,15,0,"Define region and interface for collector/fetcher

It appears, that produced gnocchiclient does not respect region_name
from the auth_section, thus it needs to be defined directly for the
fetcher.

We align collector for now with fetcher, to make change backportable.

Closes-Bug: #2067084
[SEP]
FILES CHANGED:
templates/cloudkitty.conf.j2 (+8, -0)
",0.730998,-1.287589,-0.156042,0.19417,-0.433305,-0.123071,0.215778,-0.044225,0.079225,-0.305883,0.010664,-0.415368,-0.254948,0.015597,0.109992
openstack/kolla,I309e558a445c0a96f16fd002b8ca232d94620b5a,0,0,0,1.6094,0.5,2,7.25,209,0,Bug Fix,0,0,0,0,0.0,0.5714,0,0.0,3,2,0,0.7409,1.0,1.5,44.86,12.56,1,0,0.0,1,41.8,1,0,0,0,0,"Fix codespell on master

codespell, now part of pep8, was failing on master. Also remove
the codespell version pin in tox.ini as it is no longer required.
[SEP]
FILES CHANGED:
doc/source/contributor/ptl-guide.rst (+1, -1)
tox.ini (+1, -1)
",0.342268,-0.381689,-0.044039,0.500669,0.079025,0.135852,-0.258256,-0.775856,-0.664781,0.122769,0.173203,0.178564,-0.381913,0.154908,0.351984
openstack/kolla-ansible,I9a71da5a00a4580b491a9c10ca34094b6654b438,0,0,0.6639,1.0986,0.5,1,6.0,74,0,Doc,1,0,0,122,0.013654,0.4545,0,0.3018,1,1,0,0.7315,0.0,1.0,-10.75,15.73,0,0,1.0,0,24.6667,1,0,0,0,0,"CI: drop docker pin
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",4.084138,1.642445,2.0718,0.150642,0.1245,0.473511,0.275559,0.183606,0.110693,-0.001847,0.303342,-0.533152,0.98762,0.726288,-0.221956
openstack/kolla,I403d933b029e846e682fd41a62ada4fc73cdfd12,1,0,0.6585,1.0986,0.5,1,2.33,82,0,CI,0,0,0,123,0.013763,0.5647,0,0.3719,0,1,0,0.7376,0.0,0.0,11.1,18.08,0,0,0.0,1,27.3333,1,0,0,0,0,"CI: pin codespell to <2.3.0
[SEP]
FILES CHANGED:
tox.ini (+1, -1)
",0.062629,-0.372358,-2.230059,-2.472168,1.228374,0.630884,0.149906,-0.487854,0.055705,0.548335,-0.72363,0.512757,-0.165839,0.141568,-0.063554
openstack/kolla-ansible,I33d62e910ff6151eb03c814ee7b8984c6f4e5308,1,0,0.6613,2.0794,1.0,1,7.0,207,0,Bug Fix,1,1,0,124,0.013872,0.4,0,0.2645,2,1,0,0.7298,0.0,2.0,46.64,8.51,0,0,1.0,0,25.875,0,0,0,0,0,"Revert ""CI: Use 2023.2 image for rabbitmq on ipv6 scenario""

This reverts commit 0ec71d87cd67c25790f56143a73bd65d3cbd6d36.

Reason for revert: fixed now
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+0, -7)
",-1.277027,-0.811864,-2.029389,-2.3803,1.198239,0.194962,0.742489,-0.108679,-0.004316,0.465836,0.101231,-0.259396,0.241439,0.098194,-0.290515
openstack/charms.openstack,I05e63550b8b7e18dba664d452ad8895f1c4bada8,1,0,0,1.0986,0.0,1,8.0,262,0,Feature,0,0,0,0,0.0,0.0,0,0.0,2,1,0,1.0,0.0,2.0,13.65,16.95,1,0,0.0,0,87.3333,0,0,0,0,0,"Add apache2 to the list of services

Add apache2 to the list of services so that it is stopped when the unit
is stopped/paused.

Resolves: #2067285
[SEP]
FILES CHANGED:
charms_openstack/charm/classes.py (+2, -0)
",0.1339,-0.529421,-1.03452,0.636655,-0.101914,0.473999,-0.401635,-0.615859,0.025371,-0.009583,-0.013931,0.230851,-0.135,0.438249,-0.260604
openstack/kolla-ansible,Iec9a8de184481dae058377fa8d7bbd8da729d62c,1,1,0,2.6391,0.2308,2,8.5,317,0,Bug Fix,0,0,0,0,0.0,0.3333,0,0.0,2,2,0,0.7304,0.9957,2.0,-5.83,16.34,1,0,0.0,1,22.6429,0,6,0,10,0,"Fix missing commas in kolla_podman_worker

List of strings CONTAINER_PARAMS is missing comma separators,
which makes it an implicit concatenation of list items
that should be separate.

Closes-Bug: #2067278
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2067278-82287115c972a04e.yaml (+7, -0)
ansible/module_utils/kolla_podman_worker.py (+3, -3)
",-0.725809,-1.073015,-0.957577,-1.455102,0.642715,-0.319055,0.810654,-0.017475,0.369805,0.309808,0.142613,-0.640808,0.297682,0.019153,-0.074343
openstack/kolla-ansible,I33d62e910ff6151eb03c814ee7b8984c6f4e5308,0,0,0.664,2.0794,1.0,1,8.67,276,0,Bug Fix,1,1,0,125,0.013973,0.4375,0,0.2905,2,1,0,0.731,0.0,2.0,41.85,9.62,0,0,1.0,0,34.5,0,0,0,0,0,"Revert ""CI: Use 2023.2 image for rabbitmq on ipv6 scenario""

This reverts commit 0ec71d87cd67c25790f56143a73bd65d3cbd6d36.

Reason for revert: fixed now

(cherry picked from commit cbf514869aa641091a0577c43d76ba851c9bc264)
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+0, -7)
",-1.277027,-0.811864,-2.029389,-2.3803,1.198239,0.194962,0.742489,-0.108679,-0.004316,0.465836,0.101231,-0.259396,0.241439,0.098194,-0.290515
openstack/kolla,If5aa7371d14041d6e0efca866341be2894fd6f87,0,0,0.6587,5.6095,0.7169,3,8.0,84,0,CI,0,0,0,126,0.014073,1.0,0,0.6587,3,2,0,0.7387,0.9037,2.0,18.94,13.2,0,0,0.7279,0,0.3077,0,0,0,0,0,"CI: Move pre tasks into roles
[SEP]
FILES CHANGED:
tests/playbooks/pre.yml (+1, -195)
.zuul.d/base.yaml (+2, -0)
roles/kolla-build-deps/tasks/main.yml (+74, -0)
",3.043888,1.143988,1.88621,0.57864,0.834403,0.942021,-0.079668,0.061329,-0.093137,0.217294,-0.028827,-0.4339,0.654082,0.321846,-0.18981
openstack/charms.ceph,I78a9906845bca398b9d81fa5cf8908cd59e67974,1,0,0,4.1744,0.2812,4,13.67,296,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,1,1,0,0.0,1.6638,1.0,50.59,13.27,1,0,0.5938,0,4.5538,0,0,0,0,0,"fix: patch bugs on cephfs operations

This puts the implementation a bit more in line with microceph's,
which delegates some checks to the ceph command.

Fixes a bug for `get_cephfs`, returning the true list of filesystems
instead of `None`.
[SEP]
FILES CHANGED:
charms_ceph/broker.py (+11, -14)
charms_ceph/utils.py (+1, -0)
unit_tests/test_utils.py (+19, -0)
unit_tests/test_broker.py (+15, -4)
",-0.405784,-0.82075,-0.27103,0.482409,0.03738,0.288474,-0.276609,-0.538046,-0.118021,-0.011363,-0.245878,-0.184237,-0.170333,-0.279057,0.159632
openstack/octavia,Id8e8232c7170cd5328683222b05c8b644cbaf494,1,0,0.9231,2.3979,0.5,1,2.29,264,0,Doc,0,0,0,13,0.055794,0.0,0,0.0,3,1,0,0.604,0.0,3.0,-96.87,15.91,1,0,0.0,0,24.0,0,0,0,0,0,"Drop usage of subtransactions=True

... because it was removed in SQLAlchemy 2.0[1].

[1] https://docs.sqlalchemy.org/en/20/changelog/migration_20.html#migration-to-2-0-step-five-use-the-future-flag-on-session
[SEP]
FILES CHANGED:
octavia/controller/worker/amphora_rate_limit.py (+5, -5)
",-0.961106,3.591773,-1.160302,0.766141,-0.694681,0.121485,0.186823,-0.463529,0.259512,0.386513,-0.44513,0.213811,-0.050755,0.575388,0.456108
openstack/kolla,I11d306be5e5bb3d5b05b50dd8ee64ac9424854a1,1,0,0.6535,3.1355,0.5455,2,13.0,170,0,Doc,0,0,0,127,0.013767,0.8,0,0.5228,2,2,0,0.7354,0.4395,2.0,-21.11,23.66,0,0,0.0909,0,7.3913,0,0,0,0,0,"Drop packaging requirement and unpin docker-py

(cherry picked from commit 968711579fbe73316227bd2b1993c5656adad9f4)
[SEP]
FILES CHANGED:
kolla/image/build.py (+9, -11)
tests/playbooks/pre.yml (+1, -1)
",0.756716,0.123132,-2.301506,-2.662247,1.691887,0.864942,0.530298,-0.62359,0.011704,-0.15734,-0.31453,0.658526,-0.240257,-0.303993,-0.597337
openstack/kolla,I403d933b029e846e682fd41a62ada4fc73cdfd12,1,0,0.6562,1.0986,0.5,1,4.0,151,0,CI,0,0,0,128,0.013842,0.5698,0,0.3739,0,1,0,0.7366,0.0,0.0,26.53,11.6,0,0,0.0,1,50.3333,0,0,0,0,0,"CI: pin codespell to <2.3.0

(cherry picked from commit 91f91e1cc28942870e0fd01f039872c24d62c99b)
[SEP]
FILES CHANGED:
tox.ini (+1, -1)
",0.062629,-0.372358,-2.230059,-2.472168,1.228374,0.630884,0.149906,-0.487854,0.055705,0.548335,-0.72363,0.512757,-0.165839,0.141568,-0.063554
openstack/kolla,I70981e9f7dcbd755b5df43d860b44c3feb8f90b1,0,0,0.6589,1.3863,0.0,1,5.6,868,0,Feature,0,0,0,129,0.013947,0.0,0,0.0,0,1,0,0.7378,0.0,0.0,43.28,11.53,0,0,0.0,0,217.0,0,0,0,0,0,"Add pyproject.toml to support pip 23.1

pip 23.1 removed the ""setup.py install"" fallback for projects
that do not have pyproject.toml and now uses a pyproject.toml
which is vendored in pip.
To address that, this change adds the minimal pyproject.toml
to enable pbr to be properly used to build editable wheels.

This is required to support installing devstack on
centos stream 9 and related distros with GLOBAL_VENV=True
Without this change the wsgi scripts are not generated in
editable mode. i.e. pip install -e /opt/stack/keystone

See https://pip.pypa.io/en/stable/news/#v23-1
and https://github.com/pypa/pip/issues/8368 for more
details on the removal of the fallback support.

setuptools v64.0.0 is used to support editable installs
via its PEP-660 implmentation
https://github.com/pypa/setuptools/pull/3488
[SEP]
FILES CHANGED:
pyproject.toml (+3, -0)
",-2.836733,1.213884,2.533086,-0.556226,-0.429821,-0.153468,0.184983,0.164128,-0.388793,0.024954,-0.129728,0.024991,-0.374261,-0.09713,0.190679
openstack/kayobe,I65eccf6bbe13534418c2f5b0aa5397ba170bd17a,0,0,0.9091,2.9444,0.7778,4,4.0,320,0,Feature,0,0,0,55,0.062288,1.0,0,0.9091,5,3,0,0.932,1.7652,3.75,-32.9,8.74,0,0,0.1111,1,16.8421,0,0,0,0,0,"Drop Freezer

It's inactive and hasn't produced a 2024.1 release [1]. There are some
efforts to restore Freezer, but let's remove it for now.

[1] https://governance.openstack.org/tc/reference/emerging-technology-and-inactive-projects.html#current-inactive-projects
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+0, -9)
ansible/inventory/group_vars/all/kolla (+0, -3)
releasenotes/notes/remove-freezer-support-caracal-70464d77734a3e3c.yaml (+4, -0)
ansible/roles/kolla-ansible/tests/test-extras.yml (+0, -2)
",-1.129413,2.45866,-1.248598,1.011087,-0.905892,0.131255,0.629382,-0.511946,-0.254878,0.371395,-0.039397,0.182951,0.371637,-0.179736,-0.084855
openstack/kayobe,I704b4e79ce5519a57830fbcaa51b8cf19f3f249a,0,0,0.8929,4.7536,0.8261,19,9.0,101,0,Feature,0,0,0,56,0.062153,1.0,0,0.8929,6,6,0,0.9231,3.7709,3.68,-18.5,21.38,0,0,0.1217,1,0.8707,0,0,0,0,0,"Drop Murano, Sahara, Senlin, Solum and Vitrage
[SEP]
FILES CHANGED:
releasenotes/notes/drop-senlin-6728bde642846310.yaml (+4, -0)
ansible/roles/kolla-openstack/molecule/enable-everything/prepare.yml (+0, -2)
README.rst (+0, -2)
releasenotes/notes/drop-vitrage-e94057f4953c191a.yaml (+4, -0)
doc/source/configuration/reference/kolla-ansible.rst (+0, -4)
ansible/roles/kolla-openstack/molecule/enable-everything/tests/test_default.py (+0, -4)
ansible/roles/kolla-openstack/molecule/default/tests/test_default.py (+0, -2)
ansible/roles/kolla-openstack/templates/kolla/config/murano.conf (+0, -7)
ansible/roles/kolla-openstack/molecule/enable-everything/molecule.yml (+0, -8)
ansible/overcloud-etc-hosts-fixup.yml (+0, -1)
ansible/roles/kolla-ansible/defaults/main.yml (+0, -3)
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+0, -5)
releasenotes/notes/drop-murano-040dbcf2e81da7b5.yaml (+4, -0)
ansible/inventory/group_vars/all/kolla (+0, -14)
releasenotes/notes/drop-solum-8815cdc955705123.yaml (+4, -0)
releasenotes/notes/drop-sahara-b818f90bad92a8dc.yaml (+4, -0)
ansible/roles/kolla-ansible/tests/test-extras.yml (+0, -8)
ansible/roles/kolla-openstack/defaults/main.yml (+0, -28)
ansible/roles/kolla-openstack/templates/kolla/config/sahara.conf (+0, -7)
",-0.654113,2.098634,-1.355512,0.525871,1.0991,0.648946,-1.733132,0.616593,-1.00277,0.1762,0.596293,1.341448,0.605996,-0.074373,-1.252508
openstack/charm-designate,I1f3f15dff365df467379957fd5b96d6623496c86,1,1,0.9643,5.8833,0.0,2,5.22,493,0,Bug Fix,0,0,0,28,0.010068,0.0,0,0.0,4,2,0,1.0,0.2756,3.5,-7.27,13.15,1,0,0.0,1,1.3733,0,8,0,11,0,"Remove the designate-agent service/package install

As of caracal [1] the designate-agent service has been removed. The
designate-mdns service is used instead, which was enabled in a previous
release. The default settings for the designate-mdns have been left as
is.

[1] https://docs.openstack.org/releasenotes/designate/2024.1.html

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1213

Closes-Bug: #2065596
[SEP]
FILES CHANGED:
src/lib/charm/openstack/designate.py (+17, -0)
src/templates/caracal/designate.conf (+341, -0)
",-1.815461,1.385491,-0.148441,0.027257,-0.869105,-0.2821,0.325953,0.431384,0.118615,0.077444,0.452977,0.116137,-0.209658,0.001468,-0.086169
openstack/openstack-ansible-openstack_hosts,I1c1dc35d8d59db4ae2b6770a620d91548a8a3734,1,0,0.8214,3.091,0.0476,4,10.33,257,0,CI,0,0,0,28,0.173913,0.9615,0,0.7898,1,2,0,0.7778,1.6482,1.0,5.31,19.62,0,0,0.0,0,11.6818,0,0,0,0,0,"Allow openstack_hosts role to configure git safe.directory entries

This is defaulted to '*"" and will be undefined when a CI specific
override is subsequently merged to the openstack-ansible repository.
[SEP]
FILES CHANGED:
tasks/main.yml (+0, -1)
tasks/openstack_gitconfig.yml (+10, -0)
templates/gitconfig.j2 (+7, -0)
defaults/main.yml (+3, -0)
",1.174971,-1.363089,-0.383154,0.405228,-0.207875,-0.150505,0.525928,0.295065,0.20659,-0.366153,-0.304148,0.249424,-0.63822,-0.403512,-0.216613
openstack/openstack-ansible,I20efb9be544db6d4d66c9b8d968aaf44d96d899f,1,0,0.8276,1.7918,0.0,1,7.8,407,0,CI,1,0,0,29,0.159341,1.0,0,0.8276,4,1,0,0.9302,0.0,4.0,5.86,12.35,0,0,1.0,0,67.8333,0,0,0,0,0,"Configure all directories to be safe for git clone in CI

CI jobs use the file:// mechanism to clone their repos and this is
now subject to 'safe' directory rules in lastest git.

See https://github.com/git/git/commit/f4aa8c8bb11dae6e769cd930565173808cbb69c8

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/920757
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/templates/user_variables.aio.yml.j2 (+5, -0)
",-1.890078,1.327961,-1.202839,-0.559843,-0.032823,-0.472063,0.916957,0.127086,0.102802,0.211039,-0.27996,-0.526292,0.494423,-0.218901,-0.004444
openstack/charm-rabbitmq-server,I552c04c964c98b2a700cd47e98a2ae491f5fd47b,1,1,0,2.9957,0.0,4,13.4,485,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,3,0,1.0,1.723,0.75,39.19,13.12,1,0,0.1053,1,24.25,0,60,0,19,0,"Add consumer-timeout config option

Exposes the consumer timeout configuration value that was changed in the jammy
version of rabbitmq. The value used to default to unlimited, but was changed to
30 minutes. This causes clients to timeout for longer-running jobs.

This change doesn't alter the payload's default value, it override it only when
the user provides a value via juju config.

Closes-Bug: #2020909
Related-Bug: #2067424
[SEP]
FILES CHANGED:
templates/rabbitmq.conf (+4, -0)
unit_tests/test_rabbitmq_context.py (+2, -0)
config.yaml (+10, -0)
hooks/rabbitmq_context.py (+3, -0)
",-0.659075,-1.30121,-0.004201,0.392905,-0.481471,0.113485,0.266587,0.127353,0.314944,0.312866,0.375675,0.066939,0.225354,0.039615,0.350165
openstack/kayobe,I234b7a0434ba3d533a66b766331fd489078fbcf8,1,0,0.8772,2.4849,0.1818,2,18.33,441,0,Bug Fix,0,0,0,57,0.056102,0.7143,0,0.6266,4,2,0,0.9143,0.994,3.0,15.95,17.52,1,0,0.0,1,36.75,0,0,0,0,0,"Fix container image build issues with letsencrypt

The kolla_enable_letsencrypt variable was undefined, which was causing
overcloud container image build to fail when the variable was not
defined in Kayobe configuration.

The bool filter was missing for kolla_enable_letsencrypt, which was
causing letsencrypt images to be built when kolla_enable_letsencrypt was
set to ""false"" or ""no"".
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/kolla (+3, -2)
releasenotes/notes/fix-kolla-enable-letsencrypt-8e8746560be575ac.yaml (+6, -0)
",-1.995557,-0.004847,-0.561424,1.211951,0.928995,0.175734,-0.417668,-0.472455,0.167401,0.105494,0.487882,-0.367295,-0.010593,-0.148933,0.485067
openstack/kolla,I1dda73b0bc9a9f57ec8fda3f2234449b04906410,1,1,0.7857,2.3026,0.0,1,5.44,443,0,Bug Fix,1,0,0,14,0.063063,1.0,0,0.7857,2,1,0,0.7345,0.0,2.0,16.57,10.34,0,0,1.0,0,44.3,0,8,0,5,0,"CI: Pin requests to <2.32 for publish jobs

Periodic jobs are failing because Zuul Ansible executor runs with
Ansible 8 which uses community.docker collection that needs requests<2.32.
Revert this patch when Zuul supports Ansible 10, and/or Ansible 9 gets
fixed community.docker collection. [1]

[1] https://github.com/ansible-collections/community.docker/issues/868

Related-Bug: #2066364
[SEP]
FILES CHANGED:
tests/playbooks/publish.yml (+9, -0)
",-2.073821,0.464155,-0.0871,-0.915829,0.225862,-0.159951,-0.031348,0.438534,-0.339245,0.251519,0.314129,0.011962,0.030294,-0.253256,-0.088457
openstack/kolla-ansible,I82b2003e90993df5227c58b5511adcc391742bda,1,0,0.6,1.0986,0.0,1,26.0,398,0,Feature,0,0,0,10,0.060606,0.0,0,0.0,4,1,0,0.7294,0.0,4.0,12.87,21.17,1,0,0.0,0,132.6667,0,0,0,0,0,"loadbalancer: fail on failed ""Wait for backup * to start"" handlers

If a faulty HAProxy/ProxySQL configuration is applied and the backup
HAProxy/ProxySQL containers have not been successfully restarted, a
hard stop must be performed so that the master HAProxy/ProxySQL
container with the faulty configuration is not also stopped and restarted.
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/handlers/main.yml (+2, -0)
",-0.861183,-1.490623,-0.17731,0.854093,0.285285,-0.074861,-0.220368,0.203999,0.342989,0.107661,-0.146526,0.367962,0.183726,0.103928,0.091414
openstack/kolla-ansible,I7bce1fe3d0a96816f1782107b202d6dac7d1291d,0,1,0,3.9318,0.58,4,10.57,596,0,Bug Fix,0,0,0,0,0.0,0.3333,0,0.0,4,3,0,0.73,1.5621,3.5,23.48,14.5,1,0,0.0,1,11.6863,0,6,0,4,0,"Fix redundant extra config files in grafana role

Task `Check if extra configuration file exists` picks up all files in
`{{ node_custom_config }}/grafana` including those that get handled
specially later on.
While `prometheus.yml` and `provisioning.yml` are best excluded from
extra config , because their treatment requires more than just copying,
`grafana_home_dashboard.json` may simply be treated as extra config,
which saves the execution of two additional tasks.

Closes-Bug: 2067999
[SEP]
FILES CHANGED:
ansible/roles/grafana/templates/grafana.json.j2 (+12, -11)
releasenotes/notes/bug-2067999-5d009f15e1cc3185.yaml (+5, -0)
ansible/roles/grafana/tasks/post_config.yml (+1, -1)
ansible/roles/grafana/tasks/config.yml (+3, -17)
",-1.269051,-0.748689,0.148799,0.14137,0.326149,-0.237516,-0.100999,-0.051402,0.056368,-0.302663,-0.11869,-0.736585,-0.244979,0.090559,-0.262916
openstack/kolla,I11d306be5e5bb3d5b05b50dd8ee64ac9424854a1,0,0,0.8,3.0445,0.55,1,10.0,150,0,Feature,0,0,0,15,0.064935,0.76,0,0.608,2,1,0,0.7357,0.0,2.0,-31.73,24.0,0,0,0.0,0,7.1429,0,0,0,0,0,"Drop packaging requirement

(cherry picked from commit 968711579fbe73316227bd2b1993c5656adad9f4)
[SEP]
FILES CHANGED:
kolla/image/build.py (+9, -11)
",0.756716,0.123132,-2.301506,-2.662247,1.691887,0.864942,0.530298,-0.62359,0.011704,-0.15734,-0.31453,0.658526,-0.240257,-0.303993,-0.597337
openstack/kolla,Ic298d9eb9d73ee4378921e15865ec11a488f7bd0,1,1,0.75,0.6931,0.0,1,3.4,295,0,Bug Fix,0,0,1,16,0.063745,0.386,1,0.2895,0,1,0,0.7325,0.0,0.0,46.63,8.42,0,0,0.0,0,147.5,0,8,0,5,0,"Pin requests to <2.32 for docker sdk (2023.1 and older releases)

As 2023.1 and older releases have docker>=3.0.0,<7.0.0 we need
to pin requests to <2.32 due too [1]

[1] https://github.com/docker/docker-py/issues/3256
Related-Bug: #2066364
[SEP]
FILES CHANGED:
requirements.txt (+1, -0)
",-2.569351,1.117401,1.175939,-1.456009,-0.335277,0.1482,0.527532,0.307993,-0.187258,0.434868,-0.073422,-0.180348,0.020583,-0.055398,-0.00667
openstack/openstack-ansible-os_horizon,I4c06b4b5a206b087a9fce856f5fec936e058e3f8,1,0,0.9512,2.0794,0.1429,3,37.0,299,0,Bug Fix,0,0,0,164,0.050031,1.0,0,0.9512,1,2,0,1.0,1.5567,1.0,-13.64,26.69,0,0,0.0,0,37.375,0,0,0,0,0,"Fix horizon distro installation for EL

RDO is installing Horizon not under site-packages, but under /usr/share
which makes it completely different logic, with default horizon-manage
not working, as it can not import openstack_dashboard now, as
[SEP]
FILES CHANGED:
vars/distro_install.yml (+2, -0)
templates/horizon-manage.py.j2 (+3, -0)
tasks/horizon_post_install.yml (+1, -1)
",0.382262,-1.841796,-0.13641,0.190248,-0.161676,-0.749671,0.145426,0.040563,-0.859878,-0.236236,-0.347433,-0.283871,-0.046919,-0.23381,-0.033097
openstack/charm-nova-cloud-controller,I4602a9cf38126b50bfe188b68a75cff1d2597342,1,1,1.0,4.8203,0.0081,5,11.5,196,0,Bug Fix,0,0,0,2,0.064516,1.0,0,1.0,1,3,0,1.0,1.5711,0.8,37.0,13.3,1,0,0.6016,1,1.5806,0,8,0,19,0,"Add new action purge-data

The action will run
`nova-manage db purge --verbose --all`
to delete rows from shadow tables.

Related-Bug: 2066940
[SEP]
FILES CHANGED:
actions/actions.py (+11, -0)
unit_tests/test_nova_cc_utils.py (+74, -0)
hooks/nova_cc_utils.py (+28, -0)
actions/purge-data (+1, -0)
actions.yaml (+8, -1)
",0.739584,-1.566989,-0.64388,-0.581248,-0.295582,-0.431474,-1.029526,0.078063,0.038421,-0.431689,-0.49396,0.074858,0.149519,0.889407,-0.200046
openstack/kolla-ansible,I7ae1db8d42c83b773047bb01e846d4abee02710a,1,1,0.4,2.0794,0.1429,2,11.11,680,1,Bug Fix,0,0,0,10,0.042553,0.0,0,0.0,4,2,0,0.7283,0.5917,3.0,44.12,14.44,1,0,0.0,1,85.0,0,256,0,19,0,"hardening horizon: don't mount hosts /tmp

consider this a security hardening
as it would be possible to write to host
owned private tmp files e.g. of systemd-logind
when you are able to highjack the apache2 process
inside the horizon container, which runs as root.

see the bug report for a demonstration of this.

I checked the horizon code, it only facilitates
python tempfiles module for temp file usage.

I also checked the horizon container we build
via `kolla-build -b ubuntu horizon`, which has
a /tmp/ directory.
So no mountpoint should be needed.

Closes-Bug: #2068126
[SEP]
FILES CHANGED:
releasenotes/notes/harden_horizon_tmp_usage-0d690e49645b99a8.yaml (+6, -0)
ansible/roles/horizon/defaults/main.yml (+0, -1)
",-0.77992,-2.17303,1.23861,-0.745136,-0.570955,-0.638847,0.143467,0.024428,-0.357211,-0.293381,-0.021939,-0.250496,-0.067746,0.373196,-0.053955
openstack/kolla,Ic298d9eb9d73ee4378921e15865ec11a488f7bd0,1,1,0.7647,1.0986,0.0,2,4.33,501,0,Bug Fix,0,0,1,17,0.06746,0.75,0,0.5735,2,2,0,0.7336,1.0,1.0,29.98,9.43,0,0,0.0,0,167.0,0,8,0,5,0,"Pin requests to <2.32 for docker sdk (2023.1 and older releases)

As 2023.1 and older releases have docker>=3.0.0,<7.0.0 we need
to pin requests to <2.32 due too [1]

Also marking collectd as unbuildable to unblock CI [2]

[1] https://github.com/docker/docker-py/issues/3256
[2] https://review.opendev.org/c/openstack/kolla/+/918962

Related-Bug: #2066364
Related-Bug: #2065362

(cherry picked from commit b5c936a3a564e10b35b0e378bd6d5034f0db93b4)
[SEP]
FILES CHANGED:
requirements.txt (+1, -0)
kolla/image/unbuildable.py (+1, -0)
",-2.569351,1.117401,1.175939,-1.456009,-0.335277,0.1482,0.527532,0.307993,-0.187258,0.434868,-0.073422,-0.180348,0.020583,-0.055398,-0.00667
openstack/kolla,Ic298d9eb9d73ee4378921e15865ec11a488f7bd0,0,1,0.7778,3.6376,0.9459,3,4.69,556,0,Bug Fix,0,0,1,18,0.070866,0.7308,0,0.5684,2,3,0,0.7348,0.3574,1.0,37.03,9.09,0,0,0.9459,0,14.6316,0,8,0,5,0,"Pin requests to <2.32 for docker sdk (2023.1 and older releases)

As 2023.1 and older releases have docker>=3.0.0,<7.0.0 we need
to pin requests to <2.32 due too [1]

Also marking collectd as unbuildable to unblock CI [2],
furthermore dropping centos8 CI jobs, as it went EOL.

[1] https://github.com/docker/docker-py/issues/3256
[2] https://review.opendev.org/c/openstack/kolla/+/918962

Related-Bug: #2066364
Related-Bug: #2065362

(cherry picked from commit b5c936a3a564e10b35b0e378bd6d5034f0db93b4)
[SEP]
FILES CHANGED:
kolla/image/build.py (+1, -0)
requirements.txt (+1, -0)
.zuul.d/centos.yaml (+0, -35)
",-2.569351,1.117401,1.175939,-1.456009,-0.335277,0.1482,0.527532,0.307993,-0.187258,0.434868,-0.073422,-0.180348,0.020583,-0.055398,-0.00667
openstack/openstack-ansible-os_skyline,Ib5a4af5ea79868b7dd7ee7f4329317815f3b466a,1,0,0.9515,1.0986,0.5,1,10.5,367,0,Bug Fix,0,0,0,165,0.050228,0.963,0,0.9163,1,1,0,0,0.0,1.0,26.98,9.91,0,0,0.0,0,122.3333,0,0,0,0,0,"Fix skyline user creation

With previous change [1] when type of role name was changed from string
to a list, variable name change was not reflected in _service_users,
which leads to skipping creation and role assignment to users.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_skyline/+/918160
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
",-0.892793,0.62268,-0.513368,0.432103,-0.72666,-0.228214,0.334265,0.002366,0.410308,0.227535,-0.326825,-0.393499,0.074834,0.010102,-0.270861
openstack/openstack-ansible-plugins,I2ebf91cd48f97ad063fa0a4552e948db6728481c,1,0,0.9518,2.9444,0.1667,2,16.33,319,0,Feature,0,0,0,166,0.050502,0.0,0,0.0,3,2,0,1.0,0.9183,2.5,55.59,10.61,0,0,0.0,1,16.7895,0,0,0,0,0,"Allow to remove role assignment from users

This change adds option to suply roles not only as a string or simple
list, but also as a list of mappings, with valid keys of `name` and
`state`.

Providing state as `absent` will trigger role revokaction from the user.
[SEP]
FILES CHANGED:
releasenotes/notes/service_setup_role_assignment_removal-03d94ef7b947085f.yaml (+6, -0)
roles/service_setup/tasks/setup_roles.yml (+9, -3)
",0.009374,-1.096261,-0.070798,1.100002,0.33544,0.092997,0.231729,-0.408121,0.728447,0.002881,-0.627556,-0.26794,-0.165718,-0.016865,-0.588855
openstack/openstack-ansible-plugins,Ib23bc98de8fb8e9dde1a7cb4512913b2545c276b,1,0,0.9521,1.9459,0.3333,1,20.0,382,0,Feature,0,0,0,167,0.05053,0.0,0,0.0,3,1,0,1.0,0.0,3.0,38.49,17.33,0,0,0.0,0,54.5714,0,0,0,0,0,"Run Notify part when RPC is disabled

Previously a logic to skip RPC configuration was added, however, our
Notify logic depends solely on being different from RPC while not
taking into account that RPC might be skipped as a whole.

We extend Notify logic with rules to run Notify part when RPC is not
intended to be configured.
[SEP]
FILES CHANGED:
roles/mq_setup/tasks/main.yml (+4, -2)
",-0.755338,-1.914361,-0.086301,1.148695,-0.104916,0.316618,-0.138615,-0.468877,-0.158947,0.413157,-0.036163,0.097953,0.122116,0.100765,0.091469
openstack/oslo.messaging,I637d931242c64465701266149d5e301f9b5ec4de,1,1,0,3.4012,0.0,2,15.67,344,0,Bug Fix,0,0,0,0,0.0,0.6875,0,0.0,2,2,0,0.6071,0.7355,2.0,48.73,16.48,1,0,0.0,1,11.4667,0,10,0,14,0,"Handle NotFound exception when declaring a queue

Catch and handle the NotFound exception when declaring a queue.
This exception occurs when attempting to declare a queue that already
exists and is non-durable, non-HA, and hosted on a node that has
recently gone down.

Closes-Bug: #2068630
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2068630-6ff92f213bc4eca0.yaml (+6, -0)
oslo_messaging/_drivers/impl_rabbit.py (+23, -0)
",-0.742563,-1.115479,-0.936387,0.46777,-0.158704,0.555403,-0.30912,-0.607609,0.337449,0.151924,0.368151,0.476761,0.589816,0.209902,-0.027959
openstack/openstack-ansible-os_skyline,I64e0cabeb75bf236b14c01e0eb91c77e2d369d7b,1,0,0,2.3026,0.1111,1,8.5,283,0,Feature,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.0,1.0,14.08,12.81,0,0,0.0,0,28.3,0,0,0,0,0,"Update the skyline proxy config

This change updates the skyline proxy configuration so that it is more
similar to the nginx base config that skyline generates for itself.
[SEP]
FILES CHANGED:
templates/skyline.vhost.j2 (+8, -1)
",0.867393,-1.085401,-0.017278,1.206513,0.361803,0.451349,0.460603,-0.101439,0.267719,-0.305905,-0.404107,0.621769,-0.527106,-0.038056,0.086325
openstack/openstack-ansible,I693bcaf67441a8920d955e495cdb35fb58ee849d,1,0,0.9524,0.6931,0.0,1,9.0,422,0,Doc,0,0,0,168,0.05074,1.0,0,0.9524,2,1,0,0.931,0.0,2.0,15.34,9.82,0,0,0.0,0,211.0,1,0,0,0,0,"Ensure link to PDF appears for deploy guide

Now, when build and promote of deploy gide includes PDF, the last thing
to do apparently was to enable the PDF link in openstackdocstheme
which was missed in previous patches [1][2]

[1] https://review.opendev.org/c/openstack/openstack-ansible/+/920043
[2] https://review.opendev.org/c/openstack/openstack-ansible/+/921237
[SEP]
FILES CHANGED:
deploy-guide/source/conf.py (+1, -0)
",-2.131494,2.787543,-0.618142,0.670197,-0.429565,-0.074606,0.729279,-0.195579,-0.240016,0.259459,0.197402,-0.102047,0.157658,-0.123706,-0.13872
openstack/kayobe,I88f20112ab4740fe114a6484f88f4fbfb66863e5,1,0,0.6538,4.5218,0.0879,13,2.6,139,0,Feature,0,0,0,130,0.014051,1.0,0,0.6538,4,4,0,0.9151,3.2425,2.15,41.5,13.35,0,0,0.2967,1,1.5109,0,0,0,0,0,"seed-vm/infra-vms: Add support for EFI and q35

Bump stackhpc.libvirt-vm to v1.16.1.
[SEP]
FILES CHANGED:
etc/kayobe/infra-vms.yml (+6, -0)
playbooks/kayobe-seed-vm-base/overrides.yml.j2 (+7, -0)
releasenotes/notes/seed-infra-vm-boot-fw-machine-096251c45653f98c.yaml (+8, -0)
ansible/roles/infra-vms/tasks/deploy.yml (+2, -0)
ansible/seed-vm-provision.yml (+2, -1)
ansible/roles/infra-vms/tasks/destroy.yml (+1, -0)
ansible/inventory/group_vars/all/infra-vms (+6, -0)
requirements.yml (+2, -2)
zuul.d/project.yaml (+2, -0)
ansible/inventory/group_vars/all/seed-vm (+6, -0)
ansible/seed-vm-deprovision.yml (+10, -5)
zuul.d/jobs.yaml (+25, -0)
etc/kayobe/seed-vm.yml (+6, -0)
",0.917725,1.191706,-1.035922,-0.226337,-0.487786,-0.760561,0.204297,0.751646,-0.276858,-0.038502,-0.373794,0.43685,-0.259951,0.559691,0.274808
openstack/kolla-ansible,Iec9a8de184481dae058377fa8d7bbd8da729d62c,0,1,0.4545,2.6391,0.2308,2,9.75,386,0,Bug Fix,0,0,0,11,0.045455,1.0,0,0.4545,2,2,0,0.7289,0.9957,2.0,-6.97,16.21,1,0,0.0,1,27.5714,0,6,0,10,0,"Fix missing commas in kolla_podman_worker

List of strings CONTAINER_PARAMS is missing comma separators,
which makes it an implicit concatenation of list items
that should be separate.

Closes-Bug: #2067278
(cherry picked from commit 69cdc6dbc8b7bcc5ebffbe9ec7c84e5d4ad5c839)
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2067278-82287115c972a04e.yaml (+7, -0)
ansible/module_utils/kolla_podman_worker.py (+3, -3)
",-0.725809,-1.073015,-0.957577,-1.455102,0.642715,-0.319055,0.810654,-0.017475,0.369805,0.309808,0.142613,-0.640808,0.297682,0.019153,-0.074343
openstack/kolla-ansible,Iec9a8de184481dae058377fa8d7bbd8da729d62c,0,1,0.4167,2.6391,0.2308,2,9.75,386,0,Bug Fix,0,0,0,12,0.047059,0.5,0,0.2083,2,2,0,0.7273,0.9957,2.0,-6.97,16.21,1,0,0.0,1,27.5714,0,6,0,10,0,"Fix missing commas in kolla_podman_worker

List of strings CONTAINER_PARAMS is missing comma separators,
which makes it an implicit concatenation of list items
that should be separate.

Closes-Bug: #2067278
(cherry picked from commit 69cdc6dbc8b7bcc5ebffbe9ec7c84e5d4ad5c839)
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2067278-82287115c972a04e.yaml (+7, -0)
ansible/module_utils/kolla_podman_worker.py (+3, -3)
",-0.725809,-1.073015,-0.957577,-1.455102,0.642715,-0.319055,0.810654,-0.017475,0.369805,0.309808,0.142613,-0.640808,0.297682,0.019153,-0.074343
openstack/charm-ceph-osd,I32398a0525b7098503de36d72e593c14207102a1,1,1,1.0,5.6312,0.2554,5,16.0,341,0,Bug Fix,0,0,0,3,0.002059,1.0,0,1.0,1,3,0,0.8824,1.1066,0.8,37.26,14.73,0,0,0.6871,1,1.2222,0,36,0,12,0,"Defer restart of services on AppArmor change

AppArmor changes cause restarts of all OSD
services in all units at the same time, which
can cause ceph-cluster outage.

Defer actual update and set a status message prompting
to run an action for each unit separately.

Related-bug: #2068020
[SEP]
FILES CHANGED:
hooks/ceph_hooks.py (+67, -10)
unit_tests/test_ceph_hooks.py (+131, -60)
actions/update-apparmor-and-restart-osds (+1, -0)
actions/service.py (+3, -1)
actions.yaml (+5, -0)
",-3.082221,-0.522842,0.333187,-2.114872,1.417919,0.156887,0.989922,-0.153185,0.167045,0.092528,0.126377,0.273914,0.270563,-0.017947,-0.191254
openstack/kolla-ansible,I1b58f4aeda8c9fe8db1770c63c17bf1c465f3d2a,1,1,0,1.0986,0.5,1,15.0,294,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.7256,0.0,4.0,65.65,11.33,1,0,0.0,0,98.0,0,26,0,13,0,"Set node to a valid rabbitmq host

If rabbitmq is not on the same host as the nova-controller,
then this task will fail. This change ensures that the
task references an actual rabbitmq host vs the host the
task runs on.

Closes-Bug: 2020805
[SEP]
FILES CHANGED:
ansible/roles/service-rabbitmq/tasks/main.yml (+1, -1)
",-0.19395,-1.302016,-0.705968,0.74145,-0.204641,0.101527,0.029724,-0.167185,0.088635,-0.171299,0.35441,0.409198,-0.062685,0.189981,-0.145835
openstack/kolla-ansible,Ic87fb3e4c014d3090869d5631e02982829df6312,0,0,0.6565,4.4067,0.3457,7,3.0,93,0,Feature,0,0,0,131,0.014021,0.6667,0,0.4377,4,5,0,0.7262,2.1333,1.57,62.79,10.09,1,0,0.8025,1,1.1341,0,0,0,0,0,"Bump Ansible versions to 2.16 and 2.17
[SEP]
FILES CHANGED:
tests/test-hashicorp-vault-passwords.sh (+1, -0)
tests/run-hashi-vault.yml (+28, -13)
tests/run.yml (+10, -1)
doc/source/conf.py (+4, -4)
zuul.d/base.yaml (+6, -6)
tools/kolla-ansible (+2, -2)
ansible/roles/prechecks/vars/main.yml (+2, -2)
",0.700415,2.503023,0.058282,0.941942,1.42573,0.928276,-0.235316,0.587529,-0.625867,1.903868,-0.12048,0.399746,-0.38046,0.711281,0.616393
openstack/openstack-ansible-plugins,I19d6b2b1734c56ea9cff95614c0ce0ea83d7b5e9,1,0,0.9527,2.7081,0.0,1,12.75,358,0,Doc,0,0,0,169,0.051027,0.0,0,0.0,2,1,0,1.0,0.0,2.0,52.89,11.37,0,0,0.0,0,23.8667,0,0,0,0,0,"Add sshpass_prompt to ssh connection options

At the moment our connection plugin will fail on attempt to auth by
password.
In order to allow SSH prompt it's enough to add `sshpass_prompt` as
documented option.
All logic needed to implement it goes from Ansible SSH connection module
and works properly.
[SEP]
FILES CHANGED:
plugins/connection/ssh.py (+14, -0)
",-0.231752,-1.17918,-0.450218,0.835016,-0.031889,0.215828,-0.062033,-0.646617,0.080709,0.156805,-0.040738,-0.421688,-0.045859,-0.088712,0.083012
openstack/openstack-ansible-os_keystone,I2e801fade862608382aa0adb868eff3f44ed938b,1,0,0.9529,1.0986,0.0,1,14.33,353,0,Feature,0,0,0,170,0.051112,0.0,0,0.0,1,1,0,1.0,0.0,1.0,5.38,15.04,0,0,0.0,0,117.6667,0,0,0,0,0,"Define oslo_messaging_rabbit section if either RPC or Notifications are enabled

At the moment Keystone config would not contain rabbitmq tunning for
notifications, while this still might be preffered.

We adjust template to contain oslo_messaging_rabbit if either RPC or
Notifications are enabled.
[SEP]
FILES CHANGED:
templates/keystone.conf.j2 (+2, -0)
",-1.382798,-0.404721,-0.56278,1.167382,0.828168,-0.087297,-0.666642,-0.028217,-0.212076,0.0555,-0.024036,-0.125063,-0.130283,-0.544108,0.178115
openstack/charm-ceph-osd,I744316656a2570950c42b1c3898a41a4185ffbd7,1,0,0.4286,4.2627,0.3429,5,16.33,347,0,CI,0,0,0,14,0.004954,0.8571,0,0.3673,2,2,0,0.8889,1.966,1.2,40.05,14.7,1,0,0.0286,1,4.8873,0,0,0,0,0,"Allow the user to skip Bluestore features

This patchset allows users to skip either the WAL, DB or both
bluestore devices when adding an OSD. It does so by modifying
the 'add-disk' action to take an additional parameter, called
'bluestore-skip' which specifies which features to avoid using.
[SEP]
FILES CHANGED:
lib/charms_ceph/utils.py (+15, -6)
lib/charms_ceph/broker.py (+11, -14)
unit_tests/test_actions_add_disk.py (+1, -1)
actions/add_disk.py (+14, -3)
actions.yaml (+5, -0)
",-1.659341,-0.959769,-0.509538,-0.242803,0.533559,-0.379299,0.433305,0.006074,0.275301,0.321428,0.177329,0.03485,0.303906,0.236391,-0.105494
openstack/kolla,I1dda73b0bc9a9f57ec8fda3f2234449b04906410,0,1,0.7368,2.3026,0.0,1,6.0,512,0,Bug Fix,1,0,0,19,0.065292,1.0,0,0.7368,2,1,0,0.7316,0.0,2.0,20.58,9.81,0,0,1.0,0,51.2,0,8,0,5,0,"CI: Pin requests to <2.32 for publish jobs

Periodic jobs are failing because Zuul Ansible executor runs with
Ansible 8 which uses community.docker collection that needs requests<2.32.
Revert this patch when Zuul supports Ansible 10, and/or Ansible 9 gets
fixed community.docker collection. [1]

[1] https://github.com/ansible-collections/community.docker/issues/868

Related-Bug: #2066364
(cherry picked from commit 428f37124986019bedc897469f9b1f3470b62082)
[SEP]
FILES CHANGED:
tests/playbooks/publish.yml (+9, -0)
",-2.073821,0.464155,-0.0871,-0.915829,0.225862,-0.159951,-0.031348,0.438534,-0.339245,0.251519,0.314129,0.011962,0.030294,-0.253256,-0.088457
openstack/kolla,I1dda73b0bc9a9f57ec8fda3f2234449b04906410,0,1,0.7,2.3026,0.0,1,6.0,512,0,Bug Fix,1,0,0,20,0.066667,0.6667,0,0.4667,2,1,0,0.7284,0.0,2.0,20.58,9.81,0,0,1.0,0,51.2,0,8,0,5,0,"CI: Pin requests to <2.32 for publish jobs

Periodic jobs are failing because Zuul Ansible executor runs with
Ansible 8 which uses community.docker collection that needs requests<2.32.
Revert this patch when Zuul supports Ansible 10, and/or Ansible 9 gets
fixed community.docker collection. [1]

[1] https://github.com/ansible-collections/community.docker/issues/868

Related-Bug: #2066364
(cherry picked from commit 428f37124986019bedc897469f9b1f3470b62082)
[SEP]
FILES CHANGED:
tests/playbooks/publish.yml (+9, -0)
",-2.073821,0.464155,-0.0871,-0.915829,0.225862,-0.159951,-0.031348,0.438534,-0.339245,0.251519,0.314129,0.011962,0.030294,-0.253256,-0.088457
openstack/charm-ceph-osd,I744316656a2570950c42b1c3898a41a4185ffbd7,1,0,0.975,4.7622,0.0948,5,13.75,431,0,CI,0,0,0,40,0.003773,0.875,0,0.8531,2,2,0,0.8947,1.6112,1.2,37.52,14.23,0,0,0.0172,1,3.6838,0,0,0,0,0,"Allow the user to skip Bluestore features

This patchset allows users to skip either the WAL, DB or both
bluestore devices when adding an OSD. It does so by modifying
the 'add-disk' action to take an additional parameter, called
'bluestore-skip' which specifies which features to avoid using.

Also sync charms.ceph

Cherry-picked from 503ca402f94a412ccf65a0a0f98f4d325c49b6c5
[SEP]
FILES CHANGED:
lib/charms_ceph/utils.py (+17, -6)
lib/charms_ceph/broker.py (+68, -1)
unit_tests/test_actions_add_disk.py (+1, -1)
actions/add_disk.py (+14, -3)
actions.yaml (+5, -0)
",-1.659341,-0.959769,-0.509538,-0.242803,0.533559,-0.379299,0.433305,0.006074,0.275301,0.321428,0.177329,0.03485,0.303906,0.236391,-0.105494
openstack/kolla-ansible,I8ad0dcdfaf419dfbc04d19203424adecd400db05,0,0,1.0,2.1972,0.5,1,8.4,331,0,Feature,0,0,0,1,0.071429,0.2857,0,0.2857,1,1,0,0.7246,0.0,1.0,17.02,12.88,0,0,0.0,0,36.7778,0,0,0,0,0,"Move Nova roles after OVS

Moves the execution of Nova roles after Open vSwitch roles.
Current order of execution causes VMs to not be able to start after the redeployment of Openstack during container engine migration.
[SEP]
FILES CHANGED:
ansible/site.yml (+4, -4)
",-0.037696,-0.917671,-0.333752,1.307794,0.344058,0.433885,0.397328,0.690786,0.005807,-0.440815,-0.025205,0.328639,-0.005082,-0.187127,-0.320819
openstack/ansible-role-python_venv_build,I271e6464133939be4e21110042cd489dc66c8d5d,1,0,0.9532,2.9444,0.2222,3,24.25,683,0,Feature,0,0,0,171,0.051382,0.9643,0,0.9192,2,2,0,1.0,1.5305,1.33,27.85,20.01,0,0,0.0,1,35.9474,0,0,0,0,0,"Ignore repo container facts gathering errors

In case of any repo container going down any attempt to build venv will
fail due to failure to gather facts for them.

In order to overcome the issue defaults for venv_build_targets elements
are defined along with ignoring any failures for fact gathering.

However failed_when is used instead of ignore_errors as ignore_errors
will invalidate facts for successfull hosts as well, while failed_when
preserves result for successfull hosts.

As a result venv_build_targets will be populated with `none-none-none`
key which will inlcude all hosts that don't have required facts in place
[SEP]
FILES CHANGED:
tasks/main.yml (+4, -0)
releasenotes/notes/venv_build_facts_gathering-9a85f72324d6e7e0.yaml (+6, -0)
vars/main.yml (+4, -4)
",-1.923673,-1.320291,1.037009,0.35066,0.626472,-0.220609,-0.483213,-0.677306,0.096505,-0.22721,0.038831,-0.160872,-0.143564,-0.24111,-0.068413
openstack/openstack-ansible-os_cinder,I7a1931c51595e2f6ee1c5794230737d68740c049,1,0,0.8333,2.4849,0.0,1,13.0,194,0,CI,0,0,0,30,0.160428,1.0,0,0.8333,1,1,0,1.0,0.0,1.0,50.47,11.35,0,0,0.0,0,16.1667,0,0,0,0,0,"Start iscsid on cinder-volume hosts using LVM backend

This is needed to create the iscsi initiator ID which may
not be present by default.
[SEP]
FILES CHANGED:
tasks/cinder_post_install.yml (+11, -0)
",1.379489,-1.426608,0.131927,0.579266,0.038954,-0.155612,0.38687,0.328846,0.320212,-0.426343,-0.09333,0.504731,-0.290229,-0.135108,-0.394761
openstack/kolla-ansible,I4b09b066d2a65f7f83dde75fec363874c13225c6,0,0,0.6515,1.7918,1.0,1,9.0,89,0,CI,1,0,0,132,0.014007,0.8182,0,0.5331,1,1,0,0.723,0.0,1.0,56.7,12.49,0,0,1.0,1,14.8333,0,0,0,0,0,"CI: Disable SLURP jobs for D cycle
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -5)
",2.838327,0.757662,1.596212,0.101293,0.583085,0.48408,-0.230524,0.877164,-0.253055,0.254105,0.225416,-0.320979,0.6627,-0.354314,-0.214771
openstack/kolla-ansible,I517d9f078a4dbb34178c851c1bc8b51b738882da,0,0,0.6667,2.1972,1.0,1,8.0,101,0,CI,1,0,0,21,0.067961,0.3684,0,0.2456,1,1,0,0.7213,0.0,1.0,-2.21,23.2,0,1,1.0,0,11.2222,0,0,0,0,0,"[CI] Remove SLURP related ansible installation
[SEP]
FILES CHANGED:
tests/run.yml (+0, -8)
",1.973533,1.670292,0.308593,0.30644,0.593687,0.316603,-0.204627,0.988116,-0.575702,0.277953,0.686086,-0.037121,0.302551,-0.577955,-1.10495
openstack/kolla-ansible,I7edc1216d3e74e995ed2051e9fd3d93196014836,0,0,0.6364,1.9459,1.0,1,9.0,161,0,CI,1,0,0,22,0.069401,0.5,0,0.3182,1,1,0,0.7197,0.0,1.0,14.4,14.71,0,0,1.0,0,23.0,0,0,0,0,0,"CI: remove m2.tiny creation outside of init-runonce

it is already in init-runonce in the previous release
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+0, -6)
",2.185442,-0.751076,0.779963,-0.43982,-0.230958,0.077502,-0.031527,-0.711082,-0.808381,0.109565,-0.23071,0.216833,-0.175319,0.723491,0.42581
openstack/ironic,Ib00504563f9fa7bed99a0fa1949ac99ea6870875,1,1,0,3.4657,0.0323,3,9.8,420,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.9565,1.1915,2.67,13.88,16.16,1,0,0.6774,1,13.125,0,10,0,5,0,"Build PXE config for node in SERVICING state

When [pxe]enable_netboot_fallback option is enabled, it's necessary to
build PXE config for nodes in SERVICING provisioning state. Otherwise
node servicing tear down will fail and node will be placed into
servicing failed state.

Closes-Bug: #2069413
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2069413-fc9262c573f2fe10.yaml (+7, -0)
ironic/common/pxe_utils.py (+2, -1)
ironic/tests/unit/common/test_pxe_utils.py (+21, -0)
",-0.889137,-0.658183,-0.548125,0.644845,0.411231,0.130136,-0.621185,0.041034,0.21497,-0.079227,0.368642,-0.04747,0.273612,-0.239449,-0.174851
openstack/ironic,Idb1d5b50656c3765ea5c9e21b7844946ae4cfc67,1,1,1.0,4.3694,0.1154,4,13.0,598,0,Bug Fix,0,0,0,1,0.03125,1.0,0,1.0,5,2,0,0.9569,1.3406,3.0,-10.7,23.05,1,0,0.1923,1,7.5696,0,6,0,4,0,"Fix execution of node servicing steps exposed by IPA's HardwareManager

Implement execute_service_step() in AgentBaseMixin that will
asynchronously execute service step on the agent. Without it, Ironic
will try to find <step_name> attribute on the object that implements
interface specified by the servicing step.

Example:

Step: [{""interface"": ""deploy"", ""step"": ""burnin_cpu""}]
Error: AttributeError: 'AgentDeploy' object has no attribute 'burnin_cpu'

Closes-Bug: #2069430
[SEP]
FILES CHANGED:
ironic/common/exception.py (+4, -0)
ironic/drivers/modules/agent_base.py (+44, -9)
ironic/tests/unit/drivers/modules/test_agent_base.py (+15, -0)
releasenotes/notes/bug-2069430-cb58c9beaa7a35de.yaml (+6, -0)
",-1.495959,-0.756865,0.105691,0.172311,0.038061,-0.034513,-0.495926,0.304609,0.579698,-0.198668,0.446754,-0.267495,-0.14483,0.15829,-0.273715
openstack/charm-keystone-openidc,Ie7da5f9a85027a287aad9958c54848a948f8495c,1,1,1.0,4.2905,0.25,5,12.5,600,0,Bug Fix,0,0,0,10,0.133333,1.0,0,1.0,1,3,0,0,1.9653,0.8,19.31,14.6,1,0,0.1806,1,8.2192,0,24,0,26,0,"Fix reversed values, add config options

The values of the protocol ID and identity provider ID are
reversed in the charm's code. This causes the mod_auth_openidc
config to render incorrectly in the Apache template. This change
fixes the reversed values and adds a config option for
defining the identity provider ID. This change also adds new
config options for enabling using mod_auth_openidc with
multiple Keystone units and with proxies.

Closes-Bug: #2065590
Func-Test-Pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1235
[SEP]
FILES CHANGED:
templates/apache-openidc-location.conf (+9, -4)
tests/tests.yaml (+1, -1)
config.yaml (+33, -0)
src/charm.py (+4, -9)
unit_tests/test_charm.py (+7, -4)
",-1.723466,0.215094,0.263064,0.132774,0.014267,-0.135585,-0.153572,0.142544,0.29582,-0.182115,0.070072,0.062423,-0.117465,-0.299578,0.103506
openstack/kolla,I9fdccbe3bde07a7f9a1e6ac82b1096a024e1b0ee,1,1,0,2.3026,0.4444,1,9.0,118,0,Bug Fix,0,0,0,0,0.0,0.3889,0,0.0,2,1,0,0.7253,0.0,2.0,-65.5,30.27,1,0,0.0,0,11.8,1,6,0,7,0,"fix: apple silicon architecture selection

Closes-Bug: #2073256
[SEP]
FILES CHANGED:
kolla/common/config.py (+5, -4)
",2.218371,-0.474761,-0.157552,-1.627047,-0.808098,0.889052,-1.193681,0.410667,0.207944,-0.266601,0.598613,-0.066756,0.381466,-0.159712,0.440125
openstack/kolla,I00403f967c06af6d8c718ed1245aaa01f1218add,1,0,0.3846,3.0445,0.7,1,12.33,285,0,Doc,0,0,0,13,0.048507,0.0,1,0.0,3,1,0,0.7265,0.0,3.0,36.55,13.58,1,1,0.0,0,13.5714,0,0,0,0,0,"[docs] remove not working dev setup

also add the command to clone the repository
and use the pip-install `--editable` option in
it's long form so it's immediately clear what it does.
[SEP]
FILES CHANGED:
doc/source/contributor/running-in-development.rst (+6, -14)
",2.017596,-1.709289,0.528891,-0.1434,-0.854042,-0.45138,0.640822,-0.58363,-0.507909,-0.179087,-0.317457,-0.179363,-0.387728,0.434822,-0.147332
openstack/kolla,Ibf04bd90a15e7d3949214d15a8b8e25f2050bb65,0,0,0.6466,3.5264,0.303,4,10.0,158,0,CI,0,0,0,133,0.014105,1.0,0,0.6466,3,2,0,0.7277,1.559,2.25,44.41,12.0,0,0,0.3939,0,4.6471,0,0,0,0,0,"CI: Move image building to a role

This role can be then used in kolla-ansible instead of setup_gate.sh
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+2, -10)
roles/kolla-build/defaults/main.yml (+4, -0)
roles/kolla-build/tasks/main.yml (+16, -0)
.zuul.d/base.yaml (+1, -0)
",1.509152,-0.111781,-0.443402,-0.075472,-0.360006,0.0947,-0.114028,-0.376676,-0.372692,-0.483407,0.006073,0.2511,-0.720248,0.20947,-0.54899
openstack/kayobe,Ie3c9248f0b3e47e3645e1886c0492265d52969c9,1,0,0.6418,4.6913,0.0185,7,14.67,351,0,Feature,0,0,0,134,0.014162,1.0,0,0.6418,5,5,0,0.9159,2.5177,3.0,15.06,17.68,0,0,0.1759,1,3.2202,0,0,0,0,0,"Allow using Bifrost/Ironic introspection data MAC address

Currently Kayobe sets ipv4_interface_mac to pxe interface
MAC address.

In cases where provisioning network interface and admin
network interface are different - this feature can be used
to get MAC address from Ironic introspection data.
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/bifrost (+4, -0)
etc/kayobe/bifrost.yml (+6, -0)
kayobe/tests/unit/plugins/filter/test_networks.py (+18, -1)
releasenotes/notes/kolla-bifrost-use-introspection-mac-5765956eabc8366c.yaml (+8, -0)
kayobe/plugins/filter/networks.py (+14, -0)
doc/source/configuration/reference/bifrost.rst (+25, -0)
ansible/kolla-bifrost-hostvars.yml (+31, -1)
",-0.0091,-1.548415,-0.046448,0.758251,0.223324,-0.376408,-0.10471,0.898922,0.312668,-0.317905,-0.311362,0.116879,-0.010096,-0.219327,-0.565563
openstack/kolla-ansible,I5f57467a18d3e42e0c71826cc3a7740110162af7,1,0,0,1.9459,0.5,1,9.67,213,0,Bug Fix,0,0,0,0,0.0,0.0,1,0.0,3,1,0,0.7181,0.0,3.0,36.58,17.66,1,0,0.0,0,30.4286,0,0,0,0,0,"Updates docs to fix incorrect container example

Existing container was out of date and did not work
for the db restore example. Updates to a rocky-9
example.
[SEP]
FILES CHANGED:
doc/source/admin/mariadb-backup-and-restore.rst (+3, -3)
",1.600712,-1.794293,0.074603,-0.333868,-0.526329,0.174251,-0.085559,-0.033518,-0.2907,0.093837,-0.299259,0.250648,-0.144303,0.44184,-0.049185
openstack/kolla-ansible,I76cce7f491c77b6b788d29c8644e87055f5cfff0,1,1,0.6444,1.0986,0.0,2,15.0,278,0,Bug Fix,0,0,0,135,0.014107,1.0,0,0.6444,1,2,0,0.7188,1.0,1.0,44.97,15.33,0,0,0.5,1,92.6667,0,6,0,9,0,"kolla_url: port is a string

Ansible passes port as a string - therefore matching does not work
and we get https://nova_url:443/v2.1

Closes-Bug: #2063434

(cherry picked from commit 2c0f94a868ce712a7b13ac1755f20a5cdc950535)
[SEP]
FILES CHANGED:
kolla_ansible/kolla_url.py (+1, -0)
zuul.d/base.yaml (+1, -0)
",-0.698111,-0.745878,-1.266203,-1.62002,0.379707,-0.084222,0.158494,-0.23361,0.09724,0.42021,0.020172,-0.530903,0.31945,0.377763,-0.036438
openstack/kolla-ansible,Id25b4407a8170f69e4cd7278e0aff64c609ace7d,1,0,0.6471,4.0431,0.0,6,12.0,161,0,CI,1,0,0,136,0.014208,0.7826,0,0.5064,2,4,0,0.7194,2.2333,1.17,-37.99,21.47,1,0,1.0,1,2.8246,0,0,0,0,0,"Test haproxy single external frontend

(cherry picked from commit 71d1a643bbe419c9e413ee799d30720a0985ebd7)
[SEP]
FILES CHANGED:
tests/pre.yml (+12, -0)
tests/templates/globals-default.j2 (+12, -0)
zuul.d/base.yaml (+13, -0)
zuul.d/project.yaml (+2, -0)
tests/test-core-openstack.sh (+1, -0)
zuul.d/jobs.yaml (+16, -0)
",0.561355,-0.288464,-2.341669,-2.522576,1.628368,0.595146,0.475476,-0.743167,-0.052806,0.068567,-0.57896,0.638715,-0.05328,-0.330944,-0.25018
openstack/kolla-ansible,Ia29d89b2594a604c687469850a67f7fe29d0eb5d,1,1,0,2.3026,0.2222,2,10.0,176,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.72,0.9911,3.0,40.18,16.0,1,0,0.0,1,17.6,0,10,0,11,0,"Skyline: Fix incorrect keystone port

Change the skyline nginx config to point to the internal port.

Closes-Bug: #2069855
[SEP]
FILES CHANGED:
releasenotes/notes/fix-skyline-keystone-port-0a25395608f572d9.yaml (+5, -0)
ansible/roles/skyline/templates/nginx.conf.j2 (+2, -2)
",1.413018,-1.250528,-0.444792,-0.666675,-0.666606,0.429554,-0.671545,0.492979,0.292928,-0.429421,0.344867,-0.045816,0.044361,-0.034974,-0.133692
openstack/kolla,I568dc94bea394feb5fed157b8209429813ed06fd,0,0,0.8571,1.0986,0.5,1,4.25,224,0,Feature,0,1,0,42,0.034091,0.4211,0,0.3609,2,1,0,0.7246,0.0,2.0,-31.37,18.17,0,0,0.0,0,74.6667,0,0,0,0,0,"Revert ""[release] Use Caracal sources by default""

This reverts commit 0fb24ceefce742a374d725ffa5cc3221ca18dfda.
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",0.848111,0.671996,-2.014916,-1.944746,1.31016,1.119891,0.685681,-0.476624,0.078642,-0.131235,0.013246,0.534968,-0.520141,-0.407451,-0.406527
openstack/kolla-ansible,Ib5b8ea727014964919c6b3bd2352bac4a4ac1787,0,0,0.8495,4.2627,0.1857,8,18.0,898,0,Feature,0,0,0,93,0.025535,1.0,0,0.8495,4,4,0,0.7206,2.0764,3.5,26.75,16.41,0,0,0.0,1,12.6479,0,0,0,0,0,"Add support for customising Neutron physical network names

Previously Kolla Ansible hard-coded Neutron physical networks starting
at physnet1 up to physnetN, matching the number of interfaces in
neutron_external_interface and bridges in neutron_bridge_name.

Sometimes we may want to customise the physical network names used. This
may be to allow for not all hosts having access to all physical
networks, or to use more descriptive names.

For example, in an environment with a separate physical network for
Ironic provisioning, controllers might have access to two physical
networks, while compute nodes have access to one.

This change adds a neutron_physical_networks variable, making it
possible to customise the Neutron physical network names used for the
OVS, OVN, Linux bridge and OVS DPDK plugins. The default behaviour is
unchanged.
[SEP]
FILES CHANGED:
ansible/roles/ovn-controller/tasks/setup-ovs.yml (+4, -2)
ansible/roles/neutron/templates/ml2_conf.ini.j2 (+2, -2)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/neutron/templates/linuxbridge_agent.ini.j2 (+2, -1)
ansible/roles/neutron/templates/openvswitch_agent.ini.j2 (+2, -1)
releasenotes/notes/neutron-physical-networks-5b908bed9809c3b4.yaml (+6, -0)
ansible/roles/ovs-dpdk/defaults/main.yml (+4, -2)
doc/source/reference/networking/neutron.rst (+36, -5)
",-2.58329,-0.459964,1.93884,0.645485,0.545777,0.058213,-0.060797,0.37588,0.11696,-0.245867,-0.050594,0.271965,-0.109437,-0.406814,-0.225356
openstack/kayobe,I214444c60653f484fcda6275cc725879d14f9e7a,0,0,0.8404,5.4205,0.04,7,14.44,979,0,Feature,0,0,0,94,0.025323,1.0,0,0.8404,5,5,0,0.9167,1.8455,3.71,24.28,15.32,0,0,0.5511,1,4.3319,0,0,0,0,0,"Add support for customising Neutron physical network names

Previously Kolla Ansible hard-coded Neutron physical networks starting
at physnet1 up to physnetN, matching the number of interfaces in
neutron_external_interface and bridges in neutron_bridge_name.

Sometimes we may want to customise the physical network names used.
This may be to allow for not all hosts having access to all physical
networks, or to use more descriptive names.

For example, in an environment with a separate physical network for
Ironic provisioning, controllers might have access to two physical
networks, while compute nodes have access to one.

This change extends the 'physical_network' network attribute to make it
possible to customise the Neutron physical network names used for the
OVS, OVN, Linux bridge and OVS DPDK plugins. The default behaviour is
unchanged.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/922320
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible-host-vars/tests/test.yml (+6, -0)
ansible/inventory/group_vars/all/kolla (+2, -0)
releasenotes/notes/neutron-physical-networks-861c2eca701360e8.yaml (+10, -0)
doc/source/configuration/reference/kolla-ansible.rst (+2, -0)
kayobe/tests/unit/plugins/action/test_kolla_ansible_host_vars.py (+118, -0)
kayobe/plugins/action/kolla_ansible_host_vars.py (+47, -8)
doc/source/configuration/reference/network.rst (+31, -1)
",-2.8914,0.462606,2.359568,0.247472,0.040074,0.094477,0.102615,0.315914,0.111777,-0.385176,-0.114549,0.267915,-0.046752,-0.395648,-0.209192
openstack/kolla-ansible,I4d01b7eb944c4edf6a440f2b775221986509f7eb,0,0,0.7742,1.6094,0.5,2,11.25,329,0,CI,0,0,1,31,0.012224,0.6429,1,0.4977,0,1,0,0.719,0.8113,0.0,35.62,14.28,1,0,0.25,0,65.8,0,0,0,0,0,"Add ansible-core as a dependency

This patch adds ansible-core as a dependency to
requirements.txt since there is really no reason
not to have it in the requirements.txt, given that
kolla-ansible project even has ansible in its name
and ansible-core is a crucial dependency.
[SEP]
FILES CHANGED:
requirements.txt (+2, -1)
test-requirements.txt (+0, -1)
",-0.669075,-0.182956,-0.571107,0.953109,0.268936,-0.316892,0.065739,-0.929505,-0.728204,0.088231,0.094173,-0.130778,-0.090136,0.187254,0.228801
openstack/openstack-ansible-galera_server,Ib2cd632f437c4771452c22f77bedd3012f37b86b,1,0,1.0,2.6391,0.4615,1,9.6,335,0,Bug Fix,0,0,0,2,0.008333,0.0,0,0.0,1,1,0,0.9091,0.0,1.0,61.38,10.51,1,0,0.0,0,23.9286,0,0,0,0,0,"Fix condition in cluster state checks

Conditions in Ansible ""when"" clauses are combined with ""and"". But the
cluster check should fail if only one of these conditions is true.

Additionally the second condition on the node status check was inversed.
It checked for a healthy node.
[SEP]
FILES CHANGED:
tasks/galera_server_cluster_state.yml (+7, -6)
",-0.100623,-1.807455,-0.143477,0.503311,-0.065998,0.176328,-0.019188,-0.573029,0.366845,0.123885,-0.222017,0.096277,-0.062667,0.075903,0.042821
openstack/kolla-ansible,I30915409510a4eb3e501e624b864b5ef48f85c75,1,0,0.6496,2.5649,0.0,3,5.0,155,0,Feature,0,0,0,137,0.014229,1.0,0,0.6496,4,3,0,0.7174,1.325,3.33,4.36,18.0,0,0,0.0,0,11.9231,0,0,0,0,0,"systemd: Add kolla.target

This should ease the operation of stopping/starting all Kolla
containers.
[SEP]
FILES CHANGED:
ansible/roles/common/tasks/config.yml (+6, -0)
ansible/module_utils/kolla_systemd_worker.py (+1, -0)
ansible/roles/common/templates/kolla.target.j2 (+5, -0)
",1.453986,-0.627964,-0.230788,0.12631,-0.059024,0.148007,-0.493392,-0.102344,-0.348337,-0.259442,-0.389065,0.299613,-0.024551,0.05778,-0.424353
openstack/kolla-ansible,I221eb136e77c61aef39e8646b48b927352d1419d,1,1,0.6522,2.9444,0.6667,6,4.0,203,0,Bug Fix,0,0,0,138,0.014315,1.0,0,0.6522,4,2,0,0.7181,2.4194,3.17,-100.37,21.6,1,0,0.1111,0,10.6842,0,6,0,26,0,"Fix prechecks for interfaces with dashes

Closes-Bug: #2070051

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/923544
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/precheck.yml (+1, -1)
roles/cephadm/tasks/main.yml (+2, -2)
doc/source/reference/logging-and-monitoring/prometheus-guide.rst (+1, -1)
tests/run.yml (+1, -1)
doc/source/admin/production-architecture-guide.rst (+0, -6)
ansible/roles/prechecks/tasks/port_checks.yml (+1, -1)
",-0.133186,2.325908,-1.360522,-0.731034,-1.182184,-0.019429,-0.462437,-0.103553,0.244931,-0.487206,-0.775459,-0.160562,0.434274,-0.300183,0.330729
openstack/charm-ceph-fs,I225fecdf2d9882d23101f7314e3c9fb1fe1a79f5,1,0,0.9756,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,41,0.003825,0.8235,0,0.8034,0,1,0,1.0,0.0,0.0,-18.2,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.68347,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-dashboard,Icf7ae0937fe05966abc3a7234595e25769a58d65,1,0,0.9762,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,42,0.003918,0.8333,0,0.8135,0,1,0,0.8125,0.0,0.0,-52.04,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.68347,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-iscsi,Ifb0ce27b7229c1a1e469c6c92cdeb75246cf1843,0,0,0.9767,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,43,0.00401,0.8421,0,0.8225,0,1,0,0.9231,0.0,0.0,-18.2,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.683471,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-mon,I5dda7a459c946eae1cdac0c8ae76b6083383b741,1,0,0.9545,5.5835,0.9925,3,5.0,80,0,Feature,0,0,0,44,0.004103,0.9706,0,0.9265,2,2,0,0.9189,0.1252,1.0,-35.12,26.0,1,0,0.9887,1,0.3008,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
tests/tests.yaml (+0, -1)
tests/bundles/noble-caracal.yaml (+0, -261)
.gitreview (+2, -1)
",3.683471,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-nfs,If300d270c26c02bbc9d3ca616f6e483fd3c03fb6,0,0,0.9556,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,45,0.004095,0.8095,0,0.7735,0,1,0,1.0,0.0,0.0,15.64,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.683471,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-proxy,I324dde12f5107d902774c871ebc3e61259128aa7,1,0,0.9348,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,46,0.004185,0.7727,0,0.7223,0,1,0,0.6667,0.0,0.0,-18.2,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.683471,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/charm-ceph-rbd-mirror,Id677722b3a99652747c187194d2eabc306edb0ad,1,0,0.9362,1.0986,0.0,1,5.0,80,0,Feature,0,0,0,47,0.004275,0.7826,0,0.7327,0,1,0,1.0,0.0,0.0,-18.2,26.0,1,0,0.0,0,26.6667,0,0,0,0,0,"Create squid-jammy branch
[SEP]
FILES CHANGED:
.gitreview (+2, -0)
",3.683471,1.216498,1.766247,-0.749051,0.093518,-0.433412,0.920066,0.620811,-0.129173,-0.869588,0.273442,0.146412,0.460485,0.793159,0.356889
openstack/openstack-ansible-os_nova,I6e8e0ee1ffc2c154bac0f64f2e797281d7ba966f,1,0,0.9535,2.6391,0.5385,1,34.0,271,0,Feature,0,0,0,172,0.051405,0.0,0,0.0,3,1,0,1.0,0.0,3.0,-14.29,26.54,0,0,0.0,0,19.3571,1,0,0,0,0,"Update conditions for kernel statoverride

With update of ansible version having variables in conditions is not
allowed anymore, which results in error like:
`Conditional is marked as unsafe, and cannot be evaluated`
[SEP]
FILES CHANGED:
tasks/drivers/kvm/nova_kernel_permissions.yml (+6, -7)
",0.075438,-1.68935,-0.038313,0.500979,0.009388,0.101513,-0.620223,-0.540689,0.288709,0.131748,-0.519017,-0.043408,0.024661,-0.302055,-0.465317
openstack/kolla,I9e57150645aebf4b684c609b9b356b8921aa7333,1,0,0.6087,1.6094,0.5,1,19.0,166,0,Doc,0,0,0,23,0.071207,0.0,1,0.0,3,1,0,0.7215,0.0,3.0,27.26,16.02,0,0,0.0,0,33.2,0,0,0,0,0,"add kayobe to release management doc's Launchpad admin section

Kayobe moved away from Storyboard some time ago
[SEP]
FILES CHANGED:
doc/source/contributor/release-management.rst (+2, -2)
",0.994145,-0.69067,-0.495746,-0.155838,-0.020475,0.654696,0.204688,0.282454,-1.044427,-0.668168,0.678304,0.184422,-0.39608,0.097999,-0.308724
openstack/ansible-collection-kolla,Idfd4ffd0f80a2f22098639f81be69c664198b6c8,1,1,0.75,1.7918,0.0,3,15.67,325,0,Bug Fix,0,0,0,32,0.012598,1.0,0,0.75,3,1,0,0.8,1.5219,3.0,50.53,13.93,1,0,0.0,0,54.1667,0,6,0,10,0,"Add installation of dbus package

In kolla-ansible, we perform a precheck to see if the python library for
dbus exists, but we do not install it in the bootstrap. This patch
addresses this issue by adding the installation of the dbus python
library.

Closes-Bug: #2021585
[SEP]
FILES CHANGED:
roles/packages/defaults/main.yml (+1, -0)
roles/docker_sdk/defaults/main.yml (+2, -0)
roles/podman_sdk/defaults/main.yml (+2, -0)
",0.101864,-1.240619,-0.542761,0.197532,-0.506942,-0.252777,0.162912,-0.021853,-0.063048,0.059965,0.069502,0.207045,0.06169,0.006493,0.337208
openstack/kolla-ansible,I66e471d3f199a9044a4b8aa8c51c2ad687926af3,0,0,0.4286,3.2958,0.4231,1,3.0,141,0,Feature,0,0,1,14,0.048611,0.3934,1,0.1686,0,1,0,0.7187,0.0,0.0,-106.41,27.87,1,0,0.0,0,5.2222,0,0,0,0,0,"reorder requirements.txt alphabetically
[SEP]
FILES CHANGED:
requirements.txt (+15, -11)
",2.753011,1.518714,1.644615,0.54682,0.379298,0.314211,0.277398,-0.1673,0.349613,0.149297,-0.281845,-1.054503,-0.959208,0.728318,-0.227407
openstack/kolla-ansible,I1e619cbf17d49a5ff1496637f8084a03ace9b599,0,0,0.4,1.0986,0.5,1,4.0,209,0,Feature,0,0,1,15,0.047771,0.3871,1,0.1548,0,1,0,0.7171,0.0,0.0,-35.16,16.6,1,0,0.0,0,69.6667,0,0,0,0,0,"add missing license for hvac library

license taken from https://github.com/hvac/hvac/blob/main/LICENSE.txt
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
",-0.322356,4.90238,-1.748974,1.410201,-0.299264,0.530561,0.496089,-0.616473,-0.284125,-0.455958,-0.3107,-0.139378,-0.373487,0.14116,-0.15356
openstack/kolla-ansible,Ib1ca92691c6534acca0970e0d3bb784d1748d60f,0,0,0.7576,2.7081,0.5,2,6.5,234,0,CI,0,0,0,33,0.012967,0.3333,0,0.2525,2,1,0,0.7155,0.9852,2.0,18.02,21.06,1,0,0.0,0,15.6,0,0,0,0,0,"Remove usage of distutils

This patch is replacing distutils library
by packaging library as per ""PEP 632 ‚Äì Deprecate distutils module"" [1].

[1] https://peps.python.org/pep-0632/
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+3, -3)
ansible/library/kolla_toolbox.py (+4, -4)
",-0.323718,1.351083,-0.986954,0.571761,-0.62055,0.5281,-0.378068,0.217075,-0.018193,0.426432,-0.179886,-0.031497,-0.196896,-0.00133,-0.390971
openstack/charm-cinder,I2b264072435be604bf1628e1178b0ea9f41c12ce,1,0,0,4.8752,0.2692,6,3.0,84,0,Feature,0,0,0,0,0.0,1.0,0,0.0,4,2,0,1.0,2.0426,3.17,6.39,21.2,1,0,0.0,0,0.6412,0,0,0,0,0,"Update charmhelpers in 2023.2
[SEP]
FILES CHANGED:
charmhelpers/contrib/openstack/templates/section-audit-middleware-notifications (+4, -0)
charmhelpers/contrib/openstack/utils.py (+21, -26)
charmhelpers/core/host.py (+5, -2)
charmhelpers/contrib/openstack/context.py (+16, -2)
charmhelpers/contrib/network/ip.py (+43, -5)
charmhelpers/contrib/openstack/templates/section-filter-audit (+6, -0)
",3.250023,0.573727,1.228688,-0.500769,-0.121882,0.362056,0.57891,0.940791,0.125931,1.049898,-0.714095,-0.103528,-0.974836,0.507718,0.615926
openstack/octavia,Ice6e4ee98edb446a8b0547ced477598dcf22f791,1,1,0.5,5.8201,0.5506,14,19.5,280,0,Bug Fix,0,0,0,120,0.004238,0.6667,0,0.3333,7,3,0,0.6052,3.1259,5.0,43.87,16.01,0,0,0.378,1,0.8309,0,6,0,7,0,"Fix SR-IOV when VIP interface is used for members

This patch fixes a bug in the VIP SR-IOV implementation that would cause
load balancer memebers that use the SR-IOV VIP interface to not receive
traffic.

Closes-Bug: #2070312
[SEP]
FILES CHANGED:
releasenotes/notes/Fix-SR-IOV-when-VIP-interface-is-used-for-members-adb150ece454ecff.yaml (+5, -0)
octavia/amphorae/backends/agent/api_server/plug.py (+5, -4)
octavia/amphorae/backends/agent/api_server/server.py (+3, -2)
elements/amphora-agent/static/usr/local/bin/lvs-masquerade.sh (+37, -25)
octavia/tests/unit/amphorae/backends/utils/test_interface.py (+2, -64)
octavia/tests/unit/amphorae/backends/agent/api_server/test_osutils.py (+1, -1)
octavia/amphorae/backends/utils/interface_file.py (+23, -10)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+1, -1)
octavia/common/constants.py (+3, -3)
octavia/amphorae/backends/utils/interface.py (+2, -37)
octavia/tests/unit/amphorae/backends/agent/api_server/test_plug.py (+4, -3)
octavia/tests/unit/amphorae/backends/utils/test_nftable_utils.py (+28, -22)
octavia/amphorae/backends/utils/nftable_utils.py (+33, -11)
octavia/amphorae/backends/agent/api_server/osutils.py (+4, -2)
",-0.389542,-0.727616,-0.632437,0.665665,0.252187,0.369612,-0.517959,0.277266,0.176544,-0.213856,0.2068,0.412729,0.601092,-0.458205,0.256418
openstack/kolla-ansible,Id7c90a6ec04f4a21a75f2edb39f80a64199b5f86,1,0,0.2,2.9957,0.3158,1,9.0,323,0,Doc,0,0,0,5,0.003695,0.3333,0,0.0667,2,1,0,0.714,0.0,2.0,-16.15,18.04,0,0,0.0,0,16.15,0,0,0,0,0,"Enhanced explanation of volume handling with podman

Add more explanatory documentation why is parsing of
volumes needed during creation of container to stay
consistent with the documentation inside docker worker.
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_podman_worker.py (+13, -6)
",1.52198,-2.1021,0.459537,0.074018,-0.378826,-0.085342,0.274603,-0.084313,0.059974,-0.478102,-0.852364,0.06351,-0.135263,-0.273129,-0.094507
openstack/kolla-ansible,If146d8f896c70374884807d42ca0e12df3276d48,1,1,1.0,2.8904,0.9412,2,7.36,585,0,Bug Fix,0,0,0,1,0.333333,0.6,0,0.6,4,1,0,0.7146,0.5226,4.0,50.01,8.87,1,0,0.0,0,32.5,0,18,0,20,0,"Change from PERCONA_SCHEMA to mysql for mariabackup

In 2023.1, mariadb was at version 10.6, which meant that
the PERCONA_SCHEMA.xtrabackup_history table was used to
log historicals for backups.

Starting in 2023.2 onwards, mariadb is at version 10.11, and the
default table used is now mysql.mariadb_backup_history.

Because the mysql database already exists, there is no reason
to try and create it. Instead, we just need to update the defaults
and ensure the permissions get added to the correct database.

Related-Bug: #2061889
[SEP]
FILES CHANGED:
ansible/roles/mariadb/defaults/main.yml (+1, -1)
ansible/roles/mariadb/tasks/register.yml (+0, -15)
",-2.163593,-0.016667,0.524137,0.367235,0.072864,0.242648,0.086753,0.23336,-0.284092,0.234815,0.549892,0.200347,-0.574411,0.145812,0.295857
openstack/kayobe,I7a9aa9abf611cdaa47cc91f40a6753f23a7f187e,1,1,0.6547,3.1781,0.087,3,10.0,112,0,Bug Fix,0,0,0,139,0.014392,1.0,0,0.6547,4,3,0,0.9083,0.9976,2.67,-14.81,24.0,0,0,0.0,1,4.6667,0,6,0,12,0,"Add internal VIP address to no_proxy

Closes-Bug: #2087556
[SEP]
FILES CHANGED:
releasenotes/notes/adds-internal-vip-to-no-proxy-cbb4db4ea3909185.yaml (+17, -0)
ansible/inventory/group_vars/all/proxy (+1, -0)
etc/kayobe/proxy.yml (+3, -2)
",1.6637,-0.408743,-0.766157,-1.031824,-0.521929,0.828461,-1.353846,0.249887,0.466911,-0.291172,0.396621,-0.265763,-0.002194,0.044414,-0.114435
openstack/openstack-ansible-os_octavia,I73a7c4c5d53ce4398f26a5671dc24728c8739812,0,0,0.9538,3.434,0.2667,2,14.17,680,0,CI,0,0,0,173,0.051503,0.9388,0,0.8954,1,1,0,1.0,0.7219,1.0,16.29,14.14,0,0,0.0,0,21.9355,0,0,0,0,0,"Return usage of custom keypair setup host

Before implementation of openstack_resources, there was ability to
define a custom location/host for ssh keypairs, which could be different
from service_setup host.

While this was removed with implementation of openstack_resources [1],
this behaviour might break deployments during upgrade in case path was
overriden, as no release note or upgrade script was issued instead.

Alternatively, we can cover this by a reno and upgrade script which will
move SSH keypairs to the new anticipated location.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_octavia/+/889879
[SEP]
FILES CHANGED:
tasks/octavia_resources.yml (+16, -8)
defaults/main.yml (+6, -0)
",-1.705244,-0.440355,0.97916,0.039642,-0.373931,-0.221055,0.208961,0.183228,0.123863,-0.237313,-0.154954,0.045358,-0.336131,-0.303184,0.000436
openstack/kolla-ansible,Iffcce707e0248f166cd71a0b0c1c4a032c8435c6,0,0,0.375,3.2958,0.0,1,6.5,146,0,Feature,0,0,0,16,0.050633,0.0,0,0.0,4,1,0,0.7152,0.0,4.0,-14.52,21.06,1,0,0.0,0,5.4074,0,0,0,0,0,"add a config validation precheck for haproxy
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/config_validate.yml (+26, -0)
",3.558678,0.128346,1.935274,0.394193,0.789617,-0.065937,1.211158,0.016099,0.572788,-0.029298,-0.4959,-0.391392,-0.038143,-0.35415,0.578061
openstack/openstack-ansible-plugins,I73fef0f69ddffb779eb0d70f22568558aa473a68,1,0,1.0,2.7081,0.1429,4,13.4,461,0,Feature,0,0,0,45,0.061224,0.0,0,0.0,3,1,0,1.0,1.9242,3.0,34.14,14.32,0,0,0.0,0,30.7333,0,0,0,0,0,"Enable use of alternative host for keypair generation and storage

Keypair generation is moved to the host running Ansible
(ie. the deploy host) by default in order to match previous
behaviour. This ensures that a copy of any keypairs remains
on the deploy host as opposed to a potentially ephemeral
container.

This behaviour can be overridden using the added deploy host
and python interpreter variables.
[SEP]
FILES CHANGED:
roles/openstack_resources/tasks/main.yml (+0, -2)
roles/openstack_resources/tasks/keypairs.yml (+5, -0)
roles/openstack_resources/defaults/main.yml (+3, -0)
roles/openstack_resources/tasks/compute.yml (+4, -0)
",-0.667336,-1.279395,0.180991,1.472599,0.273029,0.055328,0.684282,0.329699,0.276235,0.188133,-0.251743,0.279112,0.219118,-0.213531,-0.20204
openstack/kolla,Ia21f81d9cb0850e37882dd6155b4d2d6ba774a05,1,0,0.7353,1.0986,1.0,1,7.5,152,0,Bug Fix,0,0,0,34,0.013286,0.0,0,0.0,3,1,0,0.7227,0.0,3.0,7.46,19.0,1,0,0.0,0,50.6667,0,0,0,0,0,"Trivial fix letsencrypt base image

Replace cinder -> letsencrypt typo in
letsencrypt-base image.
[SEP]
FILES CHANGED:
docker/letsencrypt/letsencrypt-base/Dockerfile.j2 (+0, -2)
",1.517369,-1.267419,0.223006,-0.54019,0.697073,-0.457099,-0.275252,0.164886,-0.384076,-0.55011,0.098673,-0.07206,0.080836,0.22965,0.188228
openstack/kolla-ansible,I901c2bc8ac477f15d2833e68566b19e437f4b6d1,1,1,0.7429,2.1972,0.0,2,8.6,421,0,Bug Fix,0,0,0,35,0.013667,0.3846,0,0.2857,4,2,0,0.7137,0.5436,3.0,1.36,14.6,1,0,0.0,1,46.7778,1,10,0,19,0,"Add REQUESTS_CA_BUNDLE to kolla-toolbox container

This patch adds REQUESTS_CA_BUNDLE as it's described
in requests documentation [1].

This is needed because some ansible modules inside uses
python request library and some users of course using
their own CAs.

[1] https://requests.readthedocs.io/en/latest/user/advanced/#ssl-cert-verification

Closes-Bug: #1967132
[SEP]
FILES CHANGED:
ansible/roles/common/defaults/main.yml (+1, -0)
releasenotes/notes/bug-923105-d451a78930973a82.yaml (+7, -0)
",-1.993631,0.630429,-0.374062,0.365001,-0.199487,-0.107451,-0.432441,0.216679,-0.11876,0.20489,0.191037,-0.671619,0.017269,0.019205,0.024979
openstack/kolla-ansible,I9749b320d4f5eeec601a055b597dfa7d8fb97ce2,0,1,0.6,7.4541,0.3708,18,10.0,498,0,Bug Fix,0,0,1,5,0.002351,0.5714,0,0.3429,4,7,0,0.7143,2.4108,1.28,16.21,15.33,1,0,0.0255,1,0.2884,1,14,0,6,0,"Rewrite kolla-ansible CLI to python

Moving the CLI to python allows for easier
maintenance and larger feature-set.

This patch introduces a few breaking changes!
The changes stem the nature of the cliff package.
- the order of parameters must be
  kolla-ansible <action> <arguments>
- mariadb_backup and mariadb_recovery now are
  mariadb-backup and mariadb-recovery

Closes-bug: #1589020
[SEP]
FILES CHANGED:
tests/reconfigure.sh (+2, -2)
tests/deploy.sh (+6, -6)
kolla_ansible/ansible.py (+318, -0)
tests/test-mariadb.sh (+4, -4)
tests/setup_gate.sh (+1, -1)
doc/source/reference/deployment-and-bootstrapping/bifrost.rst (+7, -3)
kolla_ansible/cli/commands.py (+470, -0)
kolla_ansible/cmd/kolla_ansible.py (+50, -0)
kolla_ansible/cli/__init__.py (+0, -0)
tests/upgrade-bifrost.sh (+1, -1)
kolla_ansible/utils.py (+173, -0)
requirements.txt (+2, -4)
tests/deploy-bifrost.sh (+1, -1)
tests/test-magnum.sh (+1, -1)
releasenotes/notes/python-cli-3e568065b8706e73.yaml (+16, -0)
setup.cfg (+28, -3)
tools/kolla-ansible (+0, -608)
tests/upgrade.sh (+6, -6)
",-1.860418,-0.051266,-0.261954,0.327561,0.742227,-0.291429,-0.027995,0.019705,-0.260839,-0.104543,0.493289,0.08503,0.203141,0.161711,0.147129
openstack/openstack-ansible-lxc_hosts,Ic9804f0ab901c6ca145d6515c6a1e64c7a9a9be4,1,0,0.8387,0.6931,0.0,1,10.0,169,0,Feature,0,0,0,31,0.156566,0.0,0,0.0,1,1,0,1.0,0.0,1.0,19.03,16.0,0,0,0.0,0,84.5,0,0,0,0,0,"Ensure udev is installed in container image

This is not present in the minimal rootfs from
debian-12 debootstrap.
[SEP]
FILES CHANGED:
vars/debian-12.yml (+1, -0)
",2.49467,-1.672864,0.319161,-0.467783,-0.361592,-0.191959,0.319978,0.378691,-0.628858,-0.519337,-0.358417,0.106395,-0.464842,0.635967,0.033408
openstack/openstack-ansible-os_ironic,I2cb53414cce3a899a0db5f74e56798de95c6c4b1,1,0,1.0,2.3026,0.0,2,8.38,540,0,Feature,0,0,0,46,0.061415,0.92,0,0.92,1,2,0,1.0,0.9911,1.0,20.3,14.69,0,0,0.0,0,54.0,0,0,0,0,0,"Add new RBAC parameters which are necessary from 2024.1

See https://review.opendev.org/c/openstack/ironic/+/907148

Ironic enables oslo policy RBAC changes from 2024.1 by default.
Once enabled, in theory system scoped tokens are required for
various actions, but in practice this doesn't necessarily work
when interacting with other services.

New Ironic variables provide the means to continue with a
relatively standard deployment without having to make
far-reaching policy changes.
[SEP]
FILES CHANGED:
templates/ironic.conf.j2 (+4, -0)
defaults/main.yml (+5, -0)
",-0.82604,-0.45724,0.158131,0.486357,-0.731431,0.001655,0.388818,0.272953,0.083514,0.297726,-0.16487,0.020883,0.150609,-0.498123,0.03354
openstack/kolla-ansible,If29ab064af9968784995115da6dd2cdf6e723c0b,0,0,0.6571,3.2581,0.88,3,16.0,144,0,Doc,0,0,0,140,0.014461,0.6667,0,0.4381,3,2,0,0.7127,1.5166,1.67,37.26,11.4,0,0,0.72,1,5.5385,0,0,0,0,0,"Use Bookworm for Debian upgrade jobs and update docs

Remove Bullseye from support matrix
[SEP]
FILES CHANGED:
doc/source/user/support-matrix.rst (+0, -7)
zuul.d/nodesets.yaml (+0, -12)
zuul.d/jobs.yaml (+3, -3)
",1.73398,-0.546558,-0.513809,0.327125,0.333776,0.338256,-0.020391,0.773278,-0.349948,-0.637111,0.079261,0.09345,-0.256325,-0.13729,-0.887455
openstack/kolla-ansible,I3140bb79eace58b23f579be3da569c502c52c38c,1,1,0.3333,3.6109,0.0278,4,10.4,384,0,Bug Fix,0,0,0,6,0.004373,0.4286,0,0.1429,2,2,0,0.7112,1.7842,2.0,41.72,12.62,0,0,0.75,1,10.3784,0,6,0,3,0,"Fix podman healtcheck when not enabled

There was a bug where setting the test command
for the health check to 'NONE' would throw an error
in podman_worker. This was problematic since K-A
uses 'NONE' as an indicator that the health check is not enabled.

Closes-Bug: #2071912
[SEP]
FILES CHANGED:
tests/kolla_container_tests/test_docker_worker.py (+15, -0)
releasenotes/notes/bug-2071912-89d2fba8865ddf40.yaml (+6, -0)
tests/kolla_container_tests/test_podman_worker.py (+12, -0)
ansible/module_utils/kolla_podman_worker.py (+2, -1)
",-0.096753,-1.171743,-0.371116,0.246884,-0.326018,0.246176,-0.166674,-0.299089,0.04923,0.126268,0.33192,-0.130064,0.156847,-0.081316,0.329959
openstack/openstack-ansible-os_ironic,I74863815e83df675f5a763ac182c1ad5b26d4d91,1,0,1.0,1.0986,0.5,1,4.0,88,0,Bug Fix,0,0,0,47,0.062005,0.9216,0,0.9216,1,1,0,1.0,0.0,1.0,12.43,16.6,1,0,0.0,0,29.3333,0,0,0,0,0,"Fix Ironic IPA version for 2024.1
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",2.999,0.768429,1.483549,-0.069046,0.094109,0.764247,0.147114,1.53392,0.296618,0.979012,-0.24513,0.080746,-0.23662,0.081499,0.290077
openstack/kolla-ansible,Id5e10872de413e7b476c5343360d73c109b9667a,0,0,0.6525,4.2485,0.8261,10,3.14,294,0,Doc,0,0,0,141,0.014527,0.8,0,0.522,4,4,0,0.7118,2.686,2.1,-80.92,12.17,0,0,0.7536,1,4.2,0,0,0,0,0,"Drop OpenEuler host OS support (due to no python3.10+)

ansible-core 2.16 and later requires python 3.10+ (see [1])

[1]: https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-support-matrix
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+2, -2)
doc/source/user/quickstart.rst (+2, -2)
doc/source/user/support-matrix.rst (+0, -1)
tests/pre.yml (+0, -28)
tests/templates/globals-default.j2 (+2, -6)
zuul.d/project.yaml (+0, -1)
zuul.d/nodesets.yaml (+0, -6)
releasenotes/notes/drop-openeuler-support-ab48de4656af2485.yaml (+6, -0)
zuul.d/jobs.yaml (+0, -9)
ansible/roles/prechecks/vars/main.yml (+0, -2)
",-0.910677,2.271681,-0.867259,0.428226,-0.526919,-0.095526,-0.132036,0.482722,-0.019885,0.603648,-0.735245,0.07607,0.028729,-0.25881,-0.127094
openstack/kolla-ansible,I3023f88f710ff6b41c95d570c571af8ef009efe8,0,0,0.6479,0.6931,1.0,1,9.0,104,0,Feature,0,0,0,142,0.014527,0.3333,0,0.216,4,1,0,0.7103,0.0,4.0,0.3,21.38,0,0,0.0,0,52.0,0,0,0,0,0,"Bullseye removal followup - remove from prechecks
[SEP]
FILES CHANGED:
ansible/roles/prechecks/vars/main.yml (+0, -1)
",1.995686,-0.367705,0.802913,-0.099941,0.839997,0.540167,-0.073494,-0.576209,-0.434765,-0.318775,0.351002,-0.148263,0.061403,-0.111703,0.03373
openstack/charm-manila-ganesha,I55e9aa09b88684517d4052dc56eed0cab05a0262,1,1,0.9655,6.7044,0.0037,8,10.6,471,0,Bug Fix,0,0,0,29,0.009239,1.0,0,0.9655,4,3,0,1.0,2.0513,2.0,4.53,16.32,1,0,0.7423,1,0.5772,0,16,0,17,0,"Use client cert for keystone-identity

When manila-ganesha is related to vault it needs a client cert to
configure the keystone-auth section of manila.conf to communicate with
keystone. This patch sets that up and removes the broken server cert
auto configuration which ended up masking the manila-share service.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1244
Closes-Bug: #2064487
[SEP]
FILES CHANGED:
unit_tests/test_lib_charm_openstack_manila_ganesha.py (+218, -0)
osci.yaml (+9, -0)
src/tests/bundles/jammy-caracal-vault.yaml (+368, -0)
src/reactive/manila_ganesha.py (+74, -2)
unit_tests/test_manila_ganesha_handlers.py (+3, -0)
src/templates/rocky/manila.conf (+14, -0)
src/lib/charm/openstack/manila_ganesha.py (+111, -0)
src/tests/tests.yaml (+15, -1)
",-0.928711,0.526209,-0.298342,0.149751,-0.241214,-0.730528,0.632915,0.297424,0.083571,-0.520614,0.472546,-0.149552,0.146726,0.012798,0.426574
openstack/sushy,I15d035357c775d422b9b1165b32a51453b4b907f,1,1,1.0,4.8122,0.1557,4,13.5,226,0,Bug Fix,0,0,0,1,0.017857,0.0,0,0.0,5,3,0,0,1.6628,3.5,30.2,17.25,0,0,0.5,1,1.8374,0,6,0,4,0,"Provide vmedia username and password if required

virtualmedia mount on nvidia fails if a username and password
is not provided(even if not required).

Closes-Bug: #2071945
[SEP]
FILES CHANGED:
sushy/tests/unit/json_samples/credentials_required_error.json (+36, -0)
sushy/resources/manager/virtual_media.py (+38, -19)
releasenotes/notes/vmedia-blank-auth-c01916469219a39e.yaml (+4, -0)
sushy/tests/unit/resources/manager/test_virtual_media.py (+25, -0)
",0.996752,-1.129999,-0.165924,0.199761,0.017171,0.415019,-0.479105,-0.142169,0.250892,-0.066792,-0.232038,0.102345,0.248289,0.05851,-0.055053
openstack/ansible-collection-kolla,I03cdea3edf9b53cdce254c209997ed984e084b18,1,1,0.6434,1.0986,0.5,1,12.0,128,0,Bug Fix,0,0,0,143,0.014628,0.0,0,0.0,3,1,0,0.8182,0.0,3.0,-2.75,21.47,0,0,0.0,0,42.6667,0,6,0,26,0,"Fix etc hosts generation for interfaces with dashes

Partial-Bug: #2070051
[SEP]
FILES CHANGED:
roles/etc_hosts/tasks/etc-hosts.yml (+1, -1)
",1.511562,-0.221092,-0.399583,-0.92492,-0.340232,0.621418,-0.71515,0.089284,0.010564,-0.147005,0.423278,-0.121625,0.539675,-0.015452,0.253981
openstack/kolla-ansible,I46d18c246703373abdb27aec0061aff161d842a7,1,0,0.8316,3.1355,0.0,1,10.67,267,0,Feature,0,0,0,95,0.02413,0.0,0,0.0,4,1,0,0.7088,0.0,4.0,21.52,16.77,0,0,0.0,0,11.6087,0,0,0,0,0,"Add precheck for Horizon config file renames in Caracal

This is a common custom configuration and is likely to catch people out
on upgrade.

See I17a16ce746faa8898a457cadbb6f996f964a5b6f for the original change.
[SEP]
FILES CHANGED:
ansible/roles/horizon/tasks/precheck.yml (+22, -0)
",0.330481,-1.15289,-1.578439,-1.284676,0.570826,0.199753,1.11084,-0.370014,0.258686,0.233039,-0.454164,0.196592,-0.040514,-0.131283,0.040388
openstack/openstack-ansible-lxc_container_create,I75ad2fc575cce7892825fcbacc6c3fb6d2579211,1,0,0.9483,1.0986,0.5,1,10.25,351,0,Feature,0,0,0,174,0.051343,0.9259,0,0.878,1,1,0,1.0,0.0,1.0,21.04,14.83,0,0,0.0,0,117.0,1,0,0,0,0,"Respect dhcp_use_routes in lxc_container_networks

Due to the typo during coversion to systemd_networkd format,
dhcp_use_routes are assumed to be added through config_overrides.
Intention was to add `UseRoutes` value into [DHCP] section. But instead
it adds `DHCP` option under {DEFAULT] section.
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",-1.066434,0.019876,-0.250149,0.990592,0.8482,0.023229,-0.424612,0.080902,0.276576,-0.31969,0.023154,-0.715108,-0.4534,-0.324212,-0.290347
openstack/charm-ceph-osd,Ia756c1df0f9d4b98bbb89586eda0534bcc28b041,0,1,1.0,7.8544,0.9437,31,8.17,468,0,Bug Fix,0,0,1,11,0.020333,1.0,0,1.0,2,6,0,0.9,4.2277,1.19,-5.18,18.78,1,0,0.9519,1,0.1816,0,10,0,17,0,"Add victoria to the UCA codename map

According to https://docs.openstack.org/charm-guide/latest/project/charm-delivery.html#tracks-for-the-openstack-charms-project
octopus is the supported release for OpenStack victoria,
so victoria must be included in the UCA codename map.

Otherwise the charm cannot determine correctly what action
should be taken after upgrading the `source` to victoria.

Closes-Bug: 2071875
[SEP]
FILES CHANGED:
lib/charms_ceph/utils.py (+1, -0)
osci.yaml (+6, -8)
.gitignore (+1, -0)
.gitreview (+1, -1)
test-requirements.txt (+5, -2)
Makefile (+1, -1)
tests/bundles/xenial-queens.yaml (+0, -106)
charm-helpers-hooks.yaml (+1, -1)
tests/bundles/xenial-pike.yaml (+0, -106)
tests/bundles/bionic-rocky.yaml (+0, -106)
bindep.txt (+6, -0)
tests/bundles/bionic-queens.yaml (+0, -92)
tests/bundles/focal-victoria.yaml (+0, -222)
tests/bundles/hirsute-wallaby.yaml (+0, -222)
tests/bundles/focal-wallaby.yaml (+0, -222)
tests/bundles/focal-ussuri.yaml (+31, -16)
tests/bundles/xenial-ocata.yaml (+0, -106)
build-requirements.txt (+7, -0)
tests/bundles/bionic-ussuri.yaml (+14, -53)
tests/bundles/xenial-mitaka.yaml (+0, -92)
tests/bundles/bionic-stein.yaml (+0, -106)
tests/bundles/groovy-victoria.yaml (+0, -222)
tests/bundles/bionic-train.yaml (+0, -116)
tests/bundles/trusty-mitaka.yaml (+0, -142)
tests/tests.yaml (+0, -27)
tests/bundles/focal-xena.yaml (+0, -222)
rename.sh (+13, -0)
charmcraft.yaml (+33, -0)
metadata.yaml (+0, -4)
tox.ini (+25, -14)
tests/bundles/impish-xena.yaml (+0, -222)
",-1.570186,1.529948,-0.882636,0.776196,-0.084512,-0.113516,0.151806,-0.099204,0.325975,-0.34332,-0.002383,0.410794,0.009307,0.05452,-0.031054
openstack/openstack-ansible-openstack_hosts,I602cb8b603306241e601cffc2324cb618a1dc792,1,0,0.9486,1.0986,0.5,1,12.33,270,0,Feature,0,0,0,175,0.051607,1.0,0,0.9486,1,1,0,0.8,0.0,1.0,45.7,14.66,0,0,0.0,0,90.0,0,0,0,0,0,"Ensure git safe directory is templated properly

We're missing `=` in gitconfig template. That template is being used
only when `git` is missing from the image template, which is the reason
why it slipped attention.
[SEP]
FILES CHANGED:
templates/gitconfig.j2 (+1, -1)
",1.384954,-1.257946,0.120648,0.462307,-0.45567,0.398507,0.54935,-0.940796,-0.159168,-0.335733,-0.123477,-0.3245,-0.133185,0.410503,-0.092817
openstack/kolla-ansible,Idc7bcd1aa2cbb9a08facb3140eed0f22d5d7e99f,1,1,0.75,2.5649,0.0833,2,4.8,263,0,Bug Fix,0,0,0,36,0.014013,0.6,0,0.45,4,2,0,0.7094,0.9799,3.0,-13.06,16.92,0,0,0.0,1,20.2308,0,6,0,6,0,"Fix barbican's configuration

Barbican switched to oslo.db as per [1]
This patch is fixing kolla-ansible config
for barbican.

[1] https://review.opendev.org/c/openstack/barbican/+/848011

Closes-Bug: #2072554
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2072554-d113b89975985520.yaml (+5, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+6, -1)
",-0.428058,1.003365,-1.171434,-0.453293,-1.305574,-0.049543,0.218159,0.500997,0.000559,-0.051812,0.320821,-0.424347,-0.038237,-0.246976,-0.18022
openstack/openstack-ansible,If7b77b76b192b2dec516375f834a19b0e09afbfe,1,0,0.8438,1.9459,0.3333,1,7.0,314,0,CI,1,0,0,32,0.160804,0.0,0,0.0,4,1,0,0.9318,0.0,4.0,-35.94,11.37,0,0,1.0,0,44.8571,0,0,0,0,0,"Use UCA mirror in CI for ubuntu

The previously used variable was removed [1] so the local mirror
in CI has not been used.

[1] https://opendev.org/openstack/openstack-ansible-openstack_hosts/src/branch/master/releasenotes/notes/apt_repo-097cb34c12e60207.yaml
[SEP]
FILES CHANGED:
tests/roles/bootstrap-host/tasks/prepare_aio_config.yml (+4, -2)
",-0.51972,1.751398,-1.106834,-0.031703,-0.689004,-0.616033,1.19047,0.684316,0.315767,0.040571,-0.232192,-0.400958,-0.234868,-0.090543,-0.149385
openstack/charm-ceph-osd,I32398a0525b7098503de36d72e593c14207102a1,0,1,1.0,5.6312,0.2554,5,21.0,548,0,Bug Fix,0,0,0,4,0.002305,1.0,0,1.0,1,3,0,0.8571,1.1066,0.8,19.01,16.65,0,0,0.6871,1,1.9642,0,36,0,12,0,"Defer restart of services on AppArmor change

AppArmor changes cause restarts of all OSD
services in all units at the same time, which
can cause ceph-cluster outage.

Defer actual update and set a status message prompting
to run an action for each unit separately.

Related-bug: #2068020
(cherry picked from commit b4a870af2c74638f139d73a09dc61cd43865c4f5)
(cherry picked from commit e2a6a33f9ae56d0e3fa5cc510683ea3c84da6986)
(cherry picked from commit a5f13cac333e714fd03e0b44f7b33d0be3f88371)
[SEP]
FILES CHANGED:
hooks/ceph_hooks.py (+67, -10)
unit_tests/test_ceph_hooks.py (+131, -60)
actions/update-apparmor-and-restart-osds (+1, -0)
actions/service.py (+3, -1)
actions.yaml (+5, -0)
",-3.082221,-0.522842,0.333187,-2.114872,1.417919,0.156887,0.989922,-0.153185,0.167045,0.092528,0.126377,0.273914,0.270563,-0.017947,-0.191254
openstack/octavia,I76645da7504d8e6e8120c305c73ae16adabc17c4,0,1,0.5041,2.6391,1.0,1,11.4,423,0,Bug Fix,0,0,0,121,0.004223,0.5556,0,0.2801,1,1,0,0.6063,0.0,1.0,33.49,15.09,0,0,0.0,0,30.2143,0,6,0,4,0,"Do not install qemu in the Octavia devstack plugin

This patch removes the installation of qemu from the Octavia devstack
plugin. It was installed to make sure the required tools were available
for diskimage-builder. However, these tools should be installed via the
diskimage-builder bindep.txt, which is also run from the Octavia
devstack plugin.

Closes-Bug: #2072590
[SEP]
FILES CHANGED:
devstack/plugin.sh (+0, -13)
",-0.599181,-0.707643,-0.35776,0.623989,-0.242875,-0.37977,0.325103,0.534772,-0.087624,-0.246914,0.523784,0.461253,0.133439,0.264191,0.373802
openstack/ansible-collection-kolla,I4aad4f5ea0337be32d3d6c06276d94c149eedda6,0,0,0.6458,1.6094,0.5,1,9.0,155,0,Doc,1,0,0,144,0.014727,0.76,0,0.4908,1,1,0,0.8333,0.0,1.0,33.2,12.49,0,0,1.0,1,31.0,0,0,0,0,0,"CI: Mark kayobe rocky9 job as non voting

It has been failing with docker-py/requests related error.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+2, -2)
",2.77241,-1.178059,0.527359,-0.94042,-0.891268,-0.099,0.221616,0.203892,-0.426844,-0.275216,0.068999,0.105155,-0.105842,-0.030073,-0.051476
openstack/kolla-ansible,I3dbe017d29f0209e963fd250d4e5a753f62695d5,0,0,0.8667,1.9459,0.5,1,7.0,79,0,CI,0,0,0,15,0.079365,0.0,0,0.0,3,1,0,0.71,0.0,3.0,30.53,14.23,0,0,0.0,0,11.2857,0,0,0,0,0,"ci: bump up ceph release
[SEP]
FILES CHANGED:
roles/cephadm/defaults/main.yml (+3, -3)
",2.93113,1.905443,1.207708,0.587682,1.556022,0.645565,0.582522,-0.33919,-0.066847,0.015022,0.14332,0.154413,0.216216,-0.085432,0.66815
openstack/openstack-ansible-os_magnum,I25aca00229bad13f6618209350e32668b09a3122,1,0,1.0,2.0794,0.1429,2,18.2,558,0,Feature,0,0,0,48,0.063158,0.9655,0,0.9655,1,1,0,1.0,0.8631,1.0,59.14,13.43,0,0,0.0,0,69.75,0,0,0,0,0,"Manage Magnum resources with the last play host

When deploying Magnum for the first time in an HA setup,
the first backend is set into HAProxy maintenance during
its initial build. Once the build completes, if an attempt
is made to add resources this will fail with a 503.

By moving the resources setup to the last play host, the
first backend will be up and out of maintenance when this
task runs.

This only impacts HA setups a single-backend deployments
do not make use of HAProxy maintenance mode.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
vars/main.yml (+5, -0)
",-0.679423,-1.937627,0.766653,0.650888,-0.371918,0.25526,0.281293,0.048547,0.352205,0.129174,0.046469,0.505119,0.024343,0.202541,-0.036089
openstack/kolla-ansible,I8866cdab396b805ec75bc4ccccdc5c1909e63bcf,1,0,0.6414,3.6376,0.0,3,3.0,219,0,Feature,0,0,0,145,0.014823,0.8333,0,0.5345,4,2,0,0.7085,1.1735,4.0,-92.31,17.87,0,0,0.0,0,5.7632,0,0,0,0,0,"inspector: Add support for copying known_devices.yaml

See [1].

[1]: https://opendev.org/openstack/ironic-inspector/commit/0b9b1756660b4ea63b44c0f01bbf3c1aa71c1f1a
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+5, -0)
ansible/roles/ironic/tasks/config.yml (+26, -0)
ansible/roles/ironic/templates/ironic-inspector.json.j2 (+6, -0)
",-0.470872,1.655613,-1.955906,-1.010977,0.02326,-0.283007,1.271481,0.146979,0.782151,0.374727,-0.548103,-0.324837,-0.088018,-0.106963,-0.204903
openstack/kolla-ansible,I8b8dbb84d25078c533d9eaf80103609bc6fd5d48,0,0,0.6438,2.9957,0.2105,5,3.6,215,0,Feature,0,0,0,146,0.014869,0.5,0,0.3219,4,3,0,0.7091,1.868,2.6,-17.72,14.77,0,0,0.1053,1,10.75,0,0,0,0,0,"ironic: Make ironic-inspector optional

It has been deprecated in 2024.2 cycle - see [1].

[1]: https://review.opendev.org/c/openstack/ironic-inspector/+/923170
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/bootstrap_service.yml (+3, -1)
releasenotes/notes/deprecate-inspector-86fb3aa691099267.yaml (+10, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/ironic/defaults/main.yml (+1, -1)
tests/test-ironic.sh (+0, -2)
",0.18618,2.908232,-1.274431,0.388786,-1.150678,0.132862,0.300609,0.063516,0.16709,0.205592,-0.150773,-0.049848,-0.222771,-0.165451,0.035317
openstack/kolla-ansible,I699f9e7497bc1b384f383182d67233f3e0e165d1,0,1,0.5,3.091,0.1429,2,9.17,466,0,Bug Fix,0,0,0,6,0.001557,0.0,0,0.0,4,2,0,0.7076,0.9587,3.0,20.64,14.58,1,0,0.0,1,21.1818,0,38,0,24,0,"Fix unintentional trigger of ansible handlers

Due to an Ansible quirk, when one container of a group
changes, all containers in that group are restarted.
This can cause problems with some services.
The lower amount of containers restarted also speeds
up deploy and reconfigure.

Closes-bug: #1863510
Partially-implements: blueprint performance-improvements
[SEP]
FILES CHANGED:
releasenotes/notes/bug-1863510-e39da141cdd07c41.yaml (+8, -0)
ansible/roles/service-check-containers/tasks/main.yml (+10, -3)
",-0.676577,-1.91884,-0.104776,0.01745,-0.456819,-0.124667,-0.27236,-0.124943,0.204062,0.226177,-0.358414,0.157813,0.627641,-0.098171,0.127864
openstack/kolla-ansible,I50ce48c4e3c645e2f3aeee4913a9bc9ee506040a,1,1,0,2.3979,0.0,3,23.0,186,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,4,2,0,0.7061,1.5219,3.33,14.29,19.63,1,0,0.0,1,16.9091,0,6,0,12,0,"Add ca_path for module uri in opensearch role

Fixes an deploy opensearch whith enable TLS on the internal VIP

Closes-Bug: #2073224
[SEP]
FILES CHANGED:
releasenotes/notes/add-opensearch-uri-68a657c55ce9c9f1.yaml (+4, -0)
ansible/roles/opensearch/tasks/post-config.yml (+4, -0)
ansible/roles/opensearch/handlers/main.yml (+2, -0)
",1.505762,-1.22412,-0.406078,-0.698286,-0.176214,-0.095913,-0.464469,0.475583,0.05973,-0.585539,-0.091888,-0.323303,-0.140777,-0.348895,-0.000221
openstack/openstack-ansible-os_nova,I5601726095ff19620de2d87220efad191cf7cb6d,1,0,0.9489,2.5649,0.25,3,6.5,449,0,Feature,0,0,0,176,0.051872,0.931,0,0.8834,2,2,0,1.0,1.2516,1.33,26.16,11.83,1,0,0.0,1,34.5385,0,0,0,0,0,"Disable heartbeat_in_pthread by default

The default value for heartbeat_in_pthread has been reverted in
oslo.messaging to False [1] and backported back to Yoga.

At the moment this setting brings intermittent issues during live
migrations of instances and some other operations. So makes sense
to align it with default value.

[1] https://review.opendev.org/c/openstack/oslo.messaging/+/852251
[SEP]
FILES CHANGED:
releasenotes/notes/heartbeat_in_pthread_to_false-4bde8fca9a332805.yaml (+8, -0)
defaults/main.yml (+1, -1)
vars/main.yml (+0, -2)
",-0.878879,0.990227,0.082704,0.556516,-0.745778,0.135547,0.600254,0.010183,0.215182,0.309933,0.284174,-0.331006,-0.250478,-0.30375,0.019182
openstack/openstack-ansible-os_cinder,I06dae436639562c88ef917fd06f1f73e2ce74720,1,0,0.9492,1.6094,0.75,2,6.5,449,0,Feature,0,0,0,177,0.051982,0.9333,0,0.8859,1,1,0,1.0,1.0,1.0,24.53,11.83,1,0,0.0,0,89.8,0,0,0,0,0,"Disable heartbeat_in_pthread by default

The default value for heartbeat_in_pthread has been reverted in
oslo.messaging to False [1] and backported back to Yoga.

At the moment this setting brings intermittent issues during live
migrations of instances and some other operations. So makes sense
to align it with default value.

[1] https://review.opendev.org/c/openstack/oslo.messaging/+/852251
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
vars/main.yml (+0, -2)
",-0.878879,0.990227,0.082704,0.556516,-0.745778,0.135547,0.600254,0.010183,0.215182,0.309933,0.284174,-0.331007,-0.250478,-0.30375,0.019182
openstack/kolla,I000e2f2aacb011618a0b3c7b41fe286b3680614f,0,0,0.6395,2.1972,0.5,1,4.0,143,0,Feature,0,0,0,147,0.014942,0.5625,0,0.3597,2,1,0,0.7238,0.0,2.0,44.15,9.1,1,0,0.0,0,15.8889,0,0,0,0,0,"toolbox: Bump ansible-core to 2.17

And also python3.11 to python3.12 on rpm distro side
[SEP]
FILES CHANGED:
docker/kolla-toolbox/Dockerfile.j2 (+4, -4)
",0.937572,0.809127,-0.782336,0.001427,0.425446,0.043983,-0.115609,0.260748,-1.281736,0.608909,-0.055512,0.307924,-0.56206,0.198003,0.379397
openstack/kolla,Ia2721dd7459a11324726910c99ea4c357047631e,0,0,0.6351,2.4849,0.2727,2,5.75,273,0,Feature,0,0,0,148,0.015031,0.6,0,0.3811,3,2,0,0.7208,0.994,2.5,24.44,7.52,1,0,0.0,1,22.75,0,0,0,0,0,"bifrost: bump Ansible version to 8 (rpm) and 9 (deb)

This is used by bifrost in setup script [1].

[1]: https://opendev.org/openstack/bifrost/src/commit/1c95336154c9ed3995bb63c4b4d16f344290b796/scripts/env-setup.sh#L9
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+3, -3)
releasenotes/notes/bifrost-ansible-9-10-3a33e95f42713209.yaml (+5, -0)
",-1.46851,2.149472,-2.04633,-0.531081,0.26589,-0.081808,0.804574,-0.007923,0.200368,0.401735,-0.301425,-0.395407,0.398904,0.032696,-0.304117
openstack/openstack-ansible-lxc_hosts,I2eaf37b3c512bd41d18a4704fa3c52a0de58f5b3,1,0,0.8485,1.0986,0.5,1,5.5,319,0,Bug Fix,0,0,0,33,0.160976,1.0,0,0.8485,1,1,0,1.0,0.0,1.0,-1.27,13.11,1,0,0.0,0,106.3333,0,0,0,0,0,"Fix incorrect copying of sources.list.d to container image

This was missing a trailing / on the source path so created an
extra incorrect level of directories on the target.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-os_keystone/+/924474
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -1)
",-0.314883,0.693494,-0.77982,-0.102479,-1.022619,-0.414083,0.526638,-0.018151,0.107669,-0.265098,-0.587248,-0.45796,0.288338,0.108119,0.223656
openstack/openstack-ansible-haproxy_server,Ie5e6671d7ab929d17766a53320f262dafface99a,1,0,0.9494,1.9459,0.1667,1,19.0,393,0,Feature,0,0,0,178,0.052215,1.0,0,0.9494,1,1,0,0.9231,0.0,1.0,31.71,18.83,0,0,0.0,0,56.1429,0,0,0,0,0,"Respect defined interface for external VIP with LE

In case an interface is defined for haproxy to listen on, this affects
path for certificate to be installed to.
Seems that Let's Encrypt path was not respecting interfaces, thus once
it's defined, task was assembling certificates under wrong path, so
self-signed was used instead of LE.
[SEP]
FILES CHANGED:
tasks/haproxy_ssl_letsencrypt.yml (+5, -1)
",-0.347618,-2.355198,0.007793,0.618112,-0.316985,-0.226062,-0.066463,-0.237247,-0.32147,-0.051466,-0.322894,-0.27357,0.150532,-0.029589,-0.157083
openstack/kolla-ansible,I06e34ceb26bf792f24ee4030a267c94f9ee22e3b,1,1,0.25,3.4012,0.0,5,14.67,323,0,Bug Fix,0,0,0,4,0.019324,1.0,0,0.25,6,3,0,0.7068,1.977,4.8,49.67,13.14,1,0,0.0,1,10.7667,0,8,0,10,0,"Add size limits to Fluentd buffers

This change adds size limits to the Fluentd buffers to prevent them from
becoming too large for OpenSearch and Elasticsearch. These values have
been tested and prevent the buffer becoming too big for OpenSearch.

Closes-Bug: #2079988
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/output/03-opensearch.conf.j2 (+2, -0)
ansible/roles/common/templates/conf/output/01-es.conf.j2 (+2, -0)
ansible/roles/common/defaults/main.yml (+12, -0)
releasenotes/notes/fluentd-buffers-86acb335b1cf3126.yaml (+9, -0)
ansible/roles/common/templates/conf/output/00-local.conf.j2 (+4, -0)
",-0.694218,-0.542431,-0.738269,0.730585,0.214085,0.685934,-0.47409,-0.259119,-0.09034,0.365693,-0.137577,0.227096,0.402185,-0.575355,-0.094477
openstack/kolla,I690d9f3829083f2493bf286a1c45764b9699219b,0,0,1.0,5.1761,0.0057,8,10.43,591,0,Doc,0,0,0,2,0.043478,0.8,0,0.8,4,6,0,0.7178,2.2282,2.5,23.57,14.03,1,0,0.3011,1,3.339,0,0,0,0,0,"Allow to use configure_user macro for external templates

Commit 79a234239516b94b1b79c7ddafcc4fbe4e3ba155 introduced an ability to
build 'in-house'/'not-built-in' projects with Kolla.

This commits extends this feature with an ability to use configure_user
macro for 'not-built-in' users.
The implementation is done the same way as for 'sources', i.e. engine
after registers new section structure as soon as it finds unknown
'<project>-user' section.

In addition, the documentation and CI are extended to cover
``--docker-dir`` option.
[SEP]
FILES CHANGED:
kolla/template/methods.py (+6, -0)
tests/playbooks/run.yml (+17, -0)
tests/templates/docker/releaser/extend_start.sh (+11, -0)
releasenotes/notes/bring-configure_user-macro-to-custom-templates-61c143326a35c7ed.yaml (+9, -0)
kolla/image/kolla_worker.py (+12, -1)
doc/source/admin/image-building.rst (+92, -0)
docker/macros.j2 (+3, -0)
tests/templates/docker/releaser/Dockerfile.j2 (+25, -0)
",-1.473545,-0.540342,0.170078,-0.429613,0.404899,-0.286196,0.33197,-0.103468,0.050533,-0.125982,-0.053172,0.260903,-0.097981,-0.096372,-0.102012
openstack/kolla-ansible,I9c04d6fe77f20e5aa832684bd65de95d161cd8ea,0,0,0.4286,3.6636,0.0263,2,9.8,363,0,Doc,0,0,0,7,0.004972,0.0,0,0.0,2,1,0,0.7074,0.9495,1.5,27.69,13.72,0,0,0.6316,0,9.3077,0,0,0,0,0,"Add action for getting container names list

This patch adds a new action to kolla_container_facts
module, which retrieves list of names of all containers.
It is intended to be an alternative to using
""docker ps -a"" type of commands in the Ansible code.
[SEP]
FILES CHANGED:
ansible/library/kolla_container_facts.py (+13, -1)
tests/test_kolla_container_facts.py (+24, -0)
",-0.04263,-1.575182,-0.545678,0.820969,-0.129412,-0.322927,0.016234,0.114583,0.427116,0.04468,-0.507868,0.089067,-0.087919,0.2291,-0.416446
openstack/kolla-ansible,I20f08c986fa6b4b3ec668dad649e69f23119796b,1,1,0.8333,2.9444,0.0,3,16.5,423,0,Bug Fix,0,0,0,96,0.024249,0.0,0,0.0,4,2,0,0.7059,1.3516,3.33,49.09,13.87,0,0,0.0,1,22.2632,0,4,0,14,0,"Work around OVN DB leader election race condition

After OVN DB leader restarts there is a period before a new leader has
been elected where the old leader is returned in the cluster status.
This can result in a failure to apply the connection settings if a
different leader is elected.

Wait for a few seconds for the leader election to complete.

Closes-Bug: #2059124
[SEP]
FILES CHANGED:
releasenotes/notes/workaround-ovn-leader-election-f7f75e93e9300d96.yaml (+6, -0)
ansible/roles/ovn-db/defaults/main.yml (+2, -0)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+10, -0)
",-0.179725,-1.348635,0.240692,0.572287,-0.373984,0.655045,0.519143,-0.084457,0.456384,0.088208,0.416815,0.373145,0.226793,0.094863,0.287003
openstack/kolla-ansible,Ia8140b289aa76fcd584e0e72686e3786215c5a99,1,1,0.7568,5.826,0.4852,55,8.0,289,0,Bug Fix,0,0,0,37,0.014336,1.0,0,0.7568,4,2,0,0.7065,5.397,3.93,0.43,16.95,0,0,0.0,1,0.8525,0,6,0,4,0,"Add support for docker_image_name_prefix

The Kolla project supports building images with
user-defined prefixes. However, Kolla-ansible is unable
to use those images for installation.

This patch fixes that issue.

Closes-Bug: #2073541
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+8, -8)
ansible/roles/horizon/defaults/main.yml (+1, -1)
ansible/roles/heat/defaults/main.yml (+3, -3)
ansible/roles/cinder/defaults/main.yml (+4, -4)
ansible/roles/cloudkitty/defaults/main.yml (+2, -2)
ansible/roles/blazar/defaults/main.yml (+2, -2)
ansible/roles/ovn-db/defaults/main.yml (+3, -3)
ansible/roles/kuryr/defaults/main.yml (+1, -1)
ansible/roles/hacluster/defaults/main.yml (+3, -3)
ansible/roles/redis/defaults/main.yml (+2, -2)
ansible/roles/mariadb/defaults/main.yml (+2, -2)
ansible/roles/loadbalancer/defaults/main.yml (+4, -4)
ansible/roles/multipathd/defaults/main.yml (+1, -1)
ansible/roles/etcd/defaults/main.yml (+1, -1)
ansible/roles/grafana/defaults/main.yml (+1, -1)
ansible/roles/barbican/defaults/main.yml (+3, -3)
ansible/roles/bifrost/defaults/main.yml (+1, -1)
ansible/roles/rabbitmq/defaults/main.yml (+1, -1)
ansible/roles/trove/defaults/main.yml (+3, -3)
ansible/roles/memcached/defaults/main.yml (+1, -1)
ansible/roles/aodh/defaults/main.yml (+4, -4)
ansible/roles/letsencrypt/defaults/main.yml (+2, -2)
ansible/roles/nova/defaults/main.yml (+3, -3)
ansible/roles/ironic/defaults/main.yml (+6, -6)
ansible/roles/magnum/defaults/main.yml (+2, -2)
ansible/roles/zun/defaults/main.yml (+4, -4)
ansible/roles/watcher/defaults/main.yml (+3, -3)
ansible/roles/mistral/defaults/main.yml (+4, -4)
ansible/roles/skyline/defaults/main.yml (+2, -2)
ansible/roles/neutron/defaults/main.yml (+16, -16)
ansible/roles/influxdb/defaults/main.yml (+1, -1)
ansible/roles/manila/defaults/main.yml (+4, -4)
ansible/roles/cyborg/defaults/main.yml (+3, -3)
ansible/roles/iscsi/defaults/main.yml (+2, -2)
releasenotes/notes/add-docker-image-name-prefix-1503a64978740808.yaml (+9, -0)
ansible/roles/placement/defaults/main.yml (+1, -1)
ansible/roles/openvswitch/defaults/main.yml (+2, -2)
ansible/roles/keystone/defaults/main.yml (+3, -3)
ansible/roles/prometheus/defaults/main.yml (+11, -11)
ansible/roles/glance/defaults/main.yml (+2, -2)
ansible/roles/swift/defaults/main.yml (+6, -6)
ansible/roles/common/defaults/main.yml (+3, -3)
ansible/roles/designate/defaults/main.yml (+7, -7)
ansible/roles/ovs-dpdk/defaults/main.yml (+2, -2)
ansible/roles/tacker/defaults/main.yml (+2, -2)
ansible/roles/gnocchi/defaults/main.yml (+3, -3)
ansible/roles/masakari/defaults/main.yml (+3, -3)
ansible/roles/octavia/defaults/main.yml (+5, -5)
ansible/roles/venus/defaults/main.yml (+2, -2)
ansible/roles/telegraf/defaults/main.yml (+1, -1)
ansible/roles/ceilometer/defaults/main.yml (+4, -4)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/collectd/defaults/main.yml (+1, -1)
ansible/roles/opensearch/defaults/main.yml (+2, -2)
ansible/roles/ovn-controller/defaults/main.yml (+1, -1)
",0.151599,-0.693737,-0.685292,0.30142,-0.565723,0.195606,-0.752706,0.091077,0.239274,0.018247,0.10127,-0.037142,0.101339,-0.105772,0.124206
openstack/charm-vault,I34874cc19d65c4d6f37f58b9108883463df6d5f6,1,1,0,4.4308,0.0241,3,14.0,143,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,2,1,0,0.5,1.5665,1.33,59.68,11.31,1,0,0.6988,0,1.7024,0,6,0,1,0,"fix: remove windows line endings from config ssl-cert and ssl-chain

Closes-Bug: #2064542
[SEP]
FILES CHANGED:
unit_tests/test_reactive_vault_handlers.py (+34, -0)
unit_tests/test_utils.py (+24, -0)
src/reactive/vault_handlers.py (+23, -2)
",1.140736,0.709535,-0.982242,-0.231639,0.524233,0.084931,-0.621006,-0.358707,-0.153378,-0.380929,0.511598,-0.320591,0.326814,0.053026,0.288194
openstack/kayobe,Ied06ee3380a149c4c8d082562c93f9b771457cb4,1,1,0.8462,2.1972,0.125,2,2.25,116,0,Bug Fix,0,0,0,13,0.022688,0.8889,0,0.7521,2,2,0,0.9091,0.8113,1.0,25.95,23.12,0,0,0.0,1,12.8889,0,6,0,13,0,"Bump stackhpc.linux collection to v1.2.3

Closes-Bug: #2073100
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
releasenotes/notes/fix-systemd-networkd-enabling-10bf4e5f0903c311.yaml (+6, -0)
",1.318685,0.096153,-0.980521,-0.784367,-0.203187,0.263235,-0.44346,0.886799,0.2178,-0.005755,0.273152,-0.132375,-0.883598,0.136939,0.422507
openstack/kolla-ansible,I6ff46b47e9109d0757f2e5ce8019ba591b9892e1,1,1,0,2.3026,0.1111,2,13.33,370,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.7071,0.9183,3.0,17.76,16.33,1,0,0.0,1,37.0,0,14,0,18,0,"Add /v3 suffix to OPENSTACK_KEYSTONE_URL

Change I60162b54bc06e158534d29311d4474b34750c64d
removed the '/v3' suffix from horizon_keystone_url variable,
but the version is needed for some operations.
This patch fixes the ""Change password"" Horizon function
until Horizon bug #2073639 is resolved.

Closes-Bug: #2073159
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+2, -1)
releasenotes/notes/bug-2073159-c54c773c72c8fb11.yaml (+6, -0)
",-1.394089,-0.811898,-1.15152,-1.138301,0.521812,0.176483,-0.228922,0.271665,0.174053,0.101824,0.197033,-0.261297,-0.012208,0.085522,0.228122
openstack/kolla-ansible,I6ed82ecc7ca82c09aacb2a65254f794c72365188,1,1,0.6309,4.0254,0.0,4,13.0,122,0,Bug Fix,1,0,0,149,0.015116,0.5,0,0.3154,1,1,0,0.7077,1.9219,1.0,30.95,17.51,0,0,1.0,0,2.1786,0,6,0,10,0,"CI: Fix cases where port is not available yet

Closes-Bug: #2075966
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+22, -0)
tests/test-magnum.sh (+11, -0)
tests/test-ovn.sh (+11, -0)
tests/test-core-openstack.sh (+11, -0)
",2.195826,-0.23082,0.126083,-0.921765,-0.763677,1.161666,-0.73741,-0.116117,0.002338,0.37929,0.512327,-0.382039,0.37407,-0.335104,0.276787
openstack/kolla-ansible,I715a6a95f9d32d62a8199727ddbaddd0dd7baa2d,0,1,0.7632,2.9444,0.0556,5,19.75,593,0,Bug Fix,0,0,0,38,0.013018,0.7778,0,0.5936,4,2,0,0.7083,1.9694,3.6,15.45,16.51,1,0,0.0,1,31.2105,1,24,0,16,0,"Fix nova-libvirt's secrets - device or resource is busy

This patch removes the nova_libvirt_secret container volume because
it is a complete antipattern, and during testing, I found that
it causes problems. When it was necessary to copy libvirt secrets
from /etc/kolla/nova-libvirt/secrets, the container logs reported that
the resource is busy - precisely because it was a mounted container
volume. This, of course, is unnecessary because the secrets are copied
to the kolla host in /etc/kolla/nova-libvirt/secrets.

Closes-Bug: #2073678
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+0, -1)
ansible/roles/nova-cell/tasks/post-config.yml (+8, -0)
releasenotes/notes/bug-2073678-45f31547395ef3c7.yaml (+5, -0)
ansible/roles/nova-cell/tasks/deploy.yml (+2, -0)
ansible/roles/nova-cell/tasks/rolling_upgrade.yml (+2, -0)
",-1.978027,-0.917549,0.173301,0.150629,-0.293027,-0.487777,0.239953,0.014346,-0.297546,-0.270169,0.475022,-0.008633,0.008277,0.334946,0.290991
openstack/kolla-ansible,I2145160a1e359988e519113400e8cd2c2a0b057e,0,0,0.6333,1.6094,0.0,1,8.0,95,0,CI,0,0,0,150,0.015133,0.0,0,0.0,3,1,0,0.7069,0.0,3.0,-12.78,23.2,0,0,0.0,0,19.0,0,0,0,0,0,"CI: Install simplejson in swift scenario
[SEP]
FILES CHANGED:
roles/openstack-clients/defaults/main.yml (+4, -0)
",2.811149,0.373947,1.68806,-0.214372,0.433338,0.21604,-0.361612,0.388263,-0.150818,0.114877,-0.040717,-0.155999,0.32,0.054645,0.148293
openstack/kolla-ansible,Iae5f268e778fbbd2b744dc71a84253ec9e758a99,0,0,0.7436,4.8442,0.0238,30,14.35,1685,0,Bug Fix,0,0,0,39,0.013279,1.0,0,0.7436,4,3,0,0.7054,4.7672,3.87,36.94,14.43,1,0,0.0,1,13.2677,0,0,0,0,0,"Add oslo.messaging Queue Manager

Adds the variable ``om_enable_queue_manager`` to configure enabling
oslo.messaging Queue Manager for all services which use RabbitMQ. This
is enabled by default.

This is required before we can move away from transient queues
(``rabbit_transient_quorum_queue``) as Queue Manager is needed to avoid
consuming all erlang atoms after some time. It is also a useful feature
for debugging, as queues are now named with hostnames and services
included.

Also setting ``lock_path`` and mounting ``dev/shm`` is dependent on
``om_enable_queue_manager``, these are now enabled too. This will allow
us to backport these features to Caracal and Dalamation without
enforcing the changes right away.

Why is -t added for exec commands?
When using Podman, behavior differs from Docker regarding exec
commands. If -t (which allocates a pseudo-terminal) is not used, the
process runs as a child of podman exec without a PTY. This causes
Python inside the container to assign PGID=0 because the pseudo-terminal
is missing, leading to issues with non-existent paths like /proc/0/....
Adding -t ensures proper PGID assignment, preventing these issues and
ensuring consistent behavior across Docker and Podman.

Side-notes:
The quorum queue precheck needed to be updated as queue manager puts
""_fanout"" on the end of the name instead.
We need to override the ``[oslo_messaging_rabbit] processname`` for
services running udner wsgi, as they will otherwise all use the same
processname ``mod_wsgi``. This will cause Permission Errors trying to
access the same file in shared memory as services run with different
users.
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+4, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+6, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+6, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+6, -0)
ansible/roles/heat/templates/heat.conf.j2 (+6, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+6, -0)
ansible/roles/designate/templates/designate.conf.j2 (+3, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+3, -0)
ansible/roles/nova/templates/nova.conf.j2 (+6, -0)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+3, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+3, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+3, -0)
ansible/roles/zun/templates/zun.conf.j2 (+6, -0)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+3, -0)
ansible/roles/nova-cell/tasks/discover_computes.yml (+1, -1)
ansible/roles/watcher/templates/watcher.conf.j2 (+3, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+3, -0)
releasenotes/notes/add-queue-manager-3ce79655ac37c345.yaml (+11, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+3, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+3, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+6, -0)
ansible/roles/trove/templates/trove.conf.j2 (+3, -0)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+6, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+6, -0)
ansible/group_vars/all.yml (+1, -1)
ansible/roles/manila/templates/manila.conf.j2 (+3, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+3, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+1, -1)
",-3.079377,-0.35685,3.882015,-0.842118,-0.020821,0.322583,-0.91988,-0.415434,-0.498464,-0.37276,-0.602323,0.207017,-0.209592,-0.304208,-0.074341
openstack/kolla-ansible,Ib89048c7e0f250182c4bf57d8c8a1b5478e9b4ab,0,0,0.4286,7.1585,0.155,188,10.4,852,0,Bug Fix,0,0,0,7,0.001807,1.0,0,0.4286,5,3,0,0.7039,7.324,4.01,15.69,15.7,1,0,0.0,1,0.663,0,0,0,0,0,"Don't notify handlers during copy-cert

This is a prerequisite for patchset #745164

This fixes unwanted restarts during copying of certificates.
By removing conditional statements from role handlers in #745164,
copying certificates caused containers to restart, this is unwanted
during the genconfig process. However, if we would remove handler
notifiers from copying certificates, the container would never
restart, since from #745164, containers will restart only if any
of the files specified in config.json change. Certificates are now
copied to intermediary location inside of the container, from which
the script kolla_copy_cacerts will install them in the trust store.

Depends-on: https://review.opendev.org/c/openstack/kolla/+/926882
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron-openvswitch-agent-xenapi.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-account-replication-server.json.j2 (+7, -1)
ansible/roles/nova-cell/templates/nova-conductor.json.j2 (+7, -1)
ansible/roles/swift/templates/swift-container-updater.json.j2 (+7, -1)
ansible/roles/cyborg/templates/cyborg-api.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-bgp-dragent.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-container-server.json.j2 (+7, -1)
ansible/roles/keystone/templates/keystone.json.j2 (+7, -2)
ansible/roles/heat/defaults/main.yml (+2, -0)
ansible/roles/manila/templates/manila-share.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-rsyncd.json.j2 (+7, -1)
ansible/roles/trove/templates/trove-api.json.j2 (+7, -1)
ansible/roles/nova-cell/templates/nova-novncproxy.json.j2 (+7, -1)
ansible/roles/barbican/tasks/config.yml (+1, -1)
ansible/roles/gnocchi/templates/gnocchi-statsd.json.j2 (+6, -0)
ansible/roles/aodh/templates/aodh-api.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-container-replication-server.json.j2 (+7, -1)
ansible/roles/etcd/templates/etcd.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-linuxbridge-agent.json.j2 (+7, -1)
ansible/roles/skyline/tasks/config.yml (+1, -1)
ansible/roles/prometheus/templates/prometheus-blackbox-exporter.json.j2 (+7, -1)
ansible/roles/horizon/tasks/config.yml (+1, -1)
ansible/roles/ceilometer/templates/ceilometer-ipmi.json.j2 (+6, -0)
ansible/roles/keystone/tasks/config.yml (+1, -1)
ansible/roles/letsencrypt/templates/letsencrypt-lego.json.j2 (+7, -1)
ansible/roles/ironic/tasks/config.yml (+1, -1)
ansible/roles/grafana/templates/grafana.json.j2 (+7, -1)
ansible/roles/prometheus/templates/prometheus-server.json.j2 (+9, -4)
ansible/roles/prometheus/templates/prometheus-memcached-exporter.json.j2 (+7, -1)
ansible/roles/keystone/templates/keystone-fernet.json.j2 (+6, -0)
ansible/roles/etcd/tasks/config.yml (+1, -1)
ansible/roles/neutron/templates/neutron-server.json.j2 (+7, -1)
ansible/roles/swift/templates/swift-object-auditor.json.j2 (+7, -1)
ansible/roles/masakari/templates/masakari-instancemonitor.json.j2 (+6, -0)
ansible/roles/prometheus/templates/prometheus-elasticsearch-exporter.json.j2 (+7, -1)
ansible/roles/rabbitmq/tasks/copy-certs.yml (+4, -50)
ansible/roles/cinder/templates/cinder-volume.json.j2 (+6, -0)
ansible/roles/prometheus/templates/prometheus-libvirt-exporter.json.j2 (+9, -1)
ansible/roles/kuryr/templates/kuryr.json.j2 (+6, -0)
ansible/roles/aodh/templates/aodh-notifier.json.j2 (+6, -0)
ansible/roles/gnocchi/templates/gnocchi-api.json.j2 (+6, -1)
ansible/roles/neutron/templates/neutron-openvswitch-agent.json.j2 (+7, -1)
ansible/roles/ironic/defaults/main.yml (+2, -0)
ansible/roles/swift/templates/swift-account-server.json.j2 (+7, -1)
ansible/roles/manila/templates/manila-scheduler.json.j2 (+6, -0)
ansible/roles/octavia/templates/octavia-api.json.j2 (+8, -2)
ansible/roles/trove/templates/trove-conductor.json.j2 (+7, -1)
ansible/roles/nova-cell/templates/nova-serialproxy.json.j2 (+7, -1)
ansible/roles/masakari/templates/masakari-engine.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-tls-proxy.json.j2 (+7, -1)
ansible/roles/skyline/defaults/main.yml (+2, -0)
ansible/roles/neutron/defaults/main.yml (+5, -0)
ansible/roles/common/templates/fluentd.json.j2 (+7, -1)
ansible/roles/glance/templates/glance-tls-proxy.json.j2 (+7, -1)
ansible/roles/trove/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/templates/nova-ssh.json.j2 (+7, -1)
ansible/roles/barbican/templates/barbican-api.json.j2 (+6, -0)
ansible/roles/designate/templates/designate-central.json.j2 (+6, -0)
ansible/roles/horizon/templates/horizon.json.j2 (+7, -0)
ansible/roles/manila/templates/manila-data.json.j2 (+6, -0)
ansible/roles/cloudkitty/templates/cloudkitty-processor.json.j2 (+6, -0)
ansible/roles/keystone/defaults/main.yml (+5, -0)
ansible/roles/nova/templates/nova-super-conductor.json.j2 (+7, -1)
ansible/roles/glance/defaults/main.yml (+5, -0)
ansible/roles/octavia/templates/octavia-housekeeping.json.j2 (+6, -0)
ansible/roles/heat/tasks/config.yml (+1, -1)
ansible/roles/designate/templates/designate-sink.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-dhcp-agent.json.j2 (+6, -0)
ansible/roles/skyline/templates/skyline-apiserver.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-metadata-agent.json.j2 (+6, -0)
ansible/roles/venus/templates/venus-manager.json.j2 (+7, -1)
ansible/roles/neutron/tasks/config.yml (+1, -1)
ansible/roles/cinder/templates/cinder-scheduler.json.j2 (+6, -0)
ansible/roles/designate/templates/designate-producer.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-account-replicator.json.j2 (+7, -1)
ansible/roles/mistral/templates/mistral-executor.json.j2 (+6, -0)
ansible/roles/tacker/templates/tacker-server.json.j2 (+6, -0)
ansible/roles/cinder/tasks/config.yml (+1, -1)
ansible/roles/loadbalancer/templates/haproxy-ssh/haproxy-ssh.json.j2 (+7, -1)
ansible/roles/watcher/templates/watcher-api.json.j2 (+6, -0)
ansible/roles/glance/tasks/config.yml (+1, -1)
ansible/roles/octavia/defaults/main.yml (+2, -0)
ansible/roles/watcher/templates/watcher-engine.json.j2 (+6, -0)
ansible/roles/ironic/templates/ironic-conductor.json.j2 (+6, -0)
ansible/roles/aodh/templates/aodh-evaluator.json.j2 (+6, -0)
ansible/roles/ironic/templates/ironic-prometheus-exporter.json.j2 (+7, -1)
ansible/roles/zun/templates/zun-wsproxy.json.j2 (+6, -0)
ansible/roles/ceilometer/templates/ceilometer-compute.json.j2 (+6, -0)
ansible/roles/nova-cell/templates/nova-libvirt.json.j2 (+6, -0)
ansible/roles/letsencrypt/templates/letsencrypt-webserver.json.j2 (+7, -1)
ansible/roles/neutron/templates/neutron-infoblox-ipam-agent.json.j2 (+7, -1)
ansible/roles/masakari/templates/masakari-api.json.j2 (+6, -0)
ansible/roles/ceilometer/templates/ceilometer-notification.json.j2 (+6, -0)
ansible/roles/masakari/templates/masakari-hostmonitor.json.j2 (+7, -1)
ansible/roles/neutron/templates/neutron-metering-agent.json.j2 (+6, -0)
ansible/roles/trove/templates/trove-taskmanager.json.j2 (+6, -0)
ansible/roles/placement/templates/placement-api.json.j2 (+6, -0)
ansible/roles/horizon/defaults/main.yml (+5, -0)
ansible/roles/service-cert-copy/tasks/main.yml (+0, -6)
ansible/roles/common/templates/kolla-toolbox.json.j2 (+6, -0)
ansible/roles/ironic/templates/ironic-dnsmasq.json.j2 (+7, -1)
ansible/roles/nova/templates/nova-scheduler.json.j2 (+7, -1)
ansible/roles/designate/templates/designate-worker.json.j2 (+7, -1)
ansible/roles/swift/templates/swift-proxy-server.json.j2 (+7, -1)
ansible/roles/barbican/templates/barbican-keystone-listener.json.j2 (+6, -0)
ansible/roles/glance/templates/glance-api.json.j2 (+6, -0)
ansible/roles/watcher/templates/watcher-applier.json.j2 (+6, -0)
ansible/roles/cinder/defaults/main.yml (+1, -0)
ansible/roles/neutron/templates/neutron-mlnx-agent.json.j2 (+7, -1)
ansible/roles/swift/templates/swift-container-auditor.json.j2 (+7, -1)
ansible/roles/tacker/templates/tacker-conductor.json.j2 (+6, -0)
ansible/roles/gnocchi/templates/gnocchi-metricd.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-object-updater.json.j2 (+7, -1)
ansible/roles/ceilometer/templates/ceilometer-central.json.j2 (+7, -1)
ansible/roles/designate/templates/designate-backend-bind9.json.j2 (+7, -1)
ansible/roles/neutron/templates/neutron-eswitchd.json.j2 (+7, -1)
ansible/roles/octavia/templates/octavia-worker.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-account-auditor.json.j2 (+7, -1)
ansible/roles/skyline/templates/skyline-console.json.j2 (+6, -0)
ansible/roles/magnum/templates/magnum-api.json.j2 (+6, -0)
ansible/roles/prometheus/templates/prometheus-cadvisor.json.j2 (+7, -1)
ansible/roles/rabbitmq/templates/rabbitmq.json.j2 (+6, -0)
ansible/roles/mistral/templates/mistral-engine.json.j2 (+6, -0)
ansible/roles/rabbitmq/tasks/config.yml (+2, -1)
ansible/roles/octavia/tasks/config.yml (+1, -1)
ansible/roles/opensearch/templates/opensearch.json.j2 (+7, -1)
ansible/roles/etcd/defaults/main.yml (+5, -0)
ansible/roles/neutron/templates/neutron-ovn-metadata-agent.json.j2 (+6, -0)
ansible/roles/barbican/defaults/main.yml (+2, -0)
ansible/roles/telegraf/templates/telegraf.json.j2 (+7, -1)
ansible/roles/rabbitmq/defaults/main.yml (+1, -0)
ansible/roles/trove/defaults/main.yml (+2, -0)
ansible/roles/ironic/templates/ironic-inspector.json.j2 (+5, -0)
ansible/roles/placement/tasks/config.yml (+1, -1)
ansible/roles/venus/templates/venus-api.json.j2 (+7, -1)
ansible/roles/manila/templates/manila-api.json.j2 (+6, -0)
ansible/roles/blazar/templates/blazar-manager.json.j2 (+6, -0)
ansible/roles/etcd/tasks/copy-certs.yml (+4, -48)
ansible/roles/octavia/templates/octavia-health-manager.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-object-replicator.json.j2 (+7, -1)
ansible/roles/nova-cell/templates/nova-compute.json.j2 (+6, -0)
ansible/roles/nova/defaults/main.yml (+2, -0)
ansible/roles/cyborg/templates/cyborg-agent.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-account-reaper.json.j2 (+7, -1)
ansible/roles/zun/templates/zun-api.json.j2 (+6, -0)
ansible/roles/cyborg/templates/cyborg-conductor.json.j2 (+6, -0)
ansible/roles/common/templates/cron.json.j2 (+7, -1)
ansible/roles/heat/templates/heat-api.json.j2 (+7, -1)
releasenotes/notes/copy-certs-02ff11e9041800eb.yaml (+14, -0)
ansible/roles/aodh/templates/aodh-listener.json.j2 (+6, -0)
ansible/roles/mistral/templates/mistral-event-engine.json.j2 (+6, -0)
ansible/roles/magnum/templates/magnum-conductor.json.j2 (+6, -0)
ansible/roles/mistral/templates/mistral-api.json.j2 (+6, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.json.j2 (+7, -1)
ansible/roles/loadbalancer/templates/haproxy/haproxy.json.j2 (+7, -1)
ansible/roles/nova-cell/templates/nova-spicehtml5proxy.json.j2 (+7, -1)
ansible/roles/blazar/templates/blazar-api.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-object-server.json.j2 (+7, -1)
ansible/roles/octavia/templates/octavia-driver-agent.json.j2 (+6, -0)
ansible/roles/placement/defaults/main.yml (+2, -0)
ansible/roles/cloudkitty/templates/cloudkitty-api.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-l3-agent.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-object-expirer.json.j2 (+7, -1)
ansible/roles/swift/templates/swift-object-replication-server.json.j2 (+7, -1)
ansible/roles/neutron/templates/neutron-ovn-agent.json.j2 (+6, -0)
ansible/roles/swift/templates/swift-container-replicator.json.j2 (+7, -1)
ansible/roles/neutron/templates/ironic-neutron-agent.json.j2 (+7, -1)
ansible/roles/designate/templates/designate-mdns.json.j2 (+6, -0)
ansible/roles/prometheus/templates/prometheus-alertmanager.json.j2 (+7, -1)
ansible/roles/opensearch/templates/opensearch-dashboards.json.j2 (+7, -1)
ansible/roles/neutron/templates/neutron-sriov-agent.json.j2 (+6, -0)
ansible/roles/nova-cell/templates/nova-compute-ironic.json.j2 (+6, -0)
ansible/roles/nova/tasks/config.yml (+1, -1)
ansible/roles/designate/templates/designate-api.json.j2 (+6, -0)
ansible/roles/barbican/templates/barbican-worker.json.j2 (+7, -0)
ansible/roles/heat/templates/heat-engine.json.j2 (+6, -0)
ansible/roles/zun/templates/zun-cni-daemon.json.j2 (+7, -1)
ansible/roles/prometheus/templates/prometheus-openstack-exporter.json.j2 (+7, -1)
ansible/roles/nova/templates/nova-api.json.j2 (+6, -0)
ansible/roles/loadbalancer/templates/keepalived/keepalived.json.j2 (+7, -1)
ansible/roles/prometheus/templates/prometheus-node-exporter.json.j2 (+7, -1)
ansible/roles/cinder/templates/cinder-api.json.j2 (+7, -1)
ansible/roles/cinder/templates/cinder-backup.json.j2 (+6, -0)
ansible/roles/zun/templates/zun-compute.json.j2 (+6, -0)
ansible/roles/ironic/templates/ironic-http.json.j2 (+7, -1)
ansible/roles/heat/templates/heat-api-cfn.json.j2 (+7, -1)
ansible/roles/keystone/templates/keystone-ssh.json.j2 (+7, -1)
ansible/roles/prometheus/templates/prometheus-mysqld-exporter.json.j2 (+7, -1)
",-2.124834,-0.328483,1.274578,0.013676,-0.363419,-0.007932,0.20403,-0.122662,0.022325,-0.202954,0.000491,-0.059034,-0.128065,0.037749,-0.048585
openstack/kolla-ansible,Ia94cc960abff2850e64d60ac997e8a2e249e4ac4,0,0,0.6364,2.3979,0.1,2,11.33,289,0,Feature,0,0,0,11,0.065868,0.5217,0,0.332,4,2,0,0.7025,0.971,3.0,-1.24,15.12,1,0,0.0,1,26.2727,0,0,0,0,0,"common: support custom cron-logrotate-global.conf

This extends the functionality of being able to add per-node custom
configuration to the cron-logrotate config, similar to what we already
have in place for other configuration files.
[SEP]
FILES CHANGED:
ansible/roles/common/tasks/config.yml (+5, -1)
releasenotes/notes/custom-cron-logrotate-global-5cb26fda7d1ba85b.yaml (+4, -0)
",0.434912,-0.876334,-0.516166,1.019546,0.327957,-0.509879,0.635573,-0.232252,-0.193163,-0.258105,-0.263052,0.152395,-0.068411,0.104102,0.075506
openstack/openstack-ansible-os_neutron,I7af67908920bf386d204e28cbf5b936fea76ecd0,1,0,1.0,1.0986,0.5,1,14.5,275,0,Feature,0,0,0,4,0.235294,1.0,0,1.0,1,1,0,0.8889,0.0,1.0,-17.92,15.46,1,0,0.0,0,91.6667,0,0,0,0,0,"Correct 'neutron-policy-override' tag

Rename the 'neutron-policy-overrides' tag to 'neutron-policy-override'
so that it's consistent with the other tagged task in this role and all
other openstack-ansible service roles.
[SEP]
FILES CHANGED:
tasks/neutron_post_install.yml (+1, -1)
",-0.160633,1.404861,-0.994415,1.638355,1.052065,-0.536926,0.676661,-0.183831,0.170202,-0.492482,0.095838,0.381229,-0.172593,0.117023,0.286566
openstack/ansible-role-uwsgi,I2e0961be7890f2871f664c359d4d42d4a6098de7,1,1,0.9497,1.0986,0.0,2,7.33,383,0,Bug Fix,0,0,0,179,0.052416,1.0,0,0.9497,1,1,0,1.0,1.0,1.0,24.42,11.12,0,0,0.0,0,127.6667,0,6,0,23,0,"Ensure uWSGI is built with pcre support

Presence of PCRE is required to ensure that uWSGI is built with
routing[1] support. Routing is a handy subsystem that can add some
extra logging or overrides whenever needed.

[1] https://uwsgi-docs.readthedocs.io/en/latest/InternalRouting.html

Closes-Bug: #2073873
Related-Bug: #1742538
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
vars/debian.yml (+1, -0)
",-1.316601,0.816254,-0.501568,0.468245,-0.433685,0.071424,-0.165656,0.368975,0.129472,0.476349,0.003692,-0.441642,0.256918,-0.309479,0.110202
openstack/kolla,I5a9162a30b23cfabb64dabe5c12c226fa8627abd,1,1,0,2.8904,0.3529,2,17.0,526,0,Bug Fix,0,0,0,0,0.0,0.4667,0,0.0,2,2,0,0.7149,0.9367,2.0,15.4,17.98,1,0,0.0,1,29.2222,0,6,0,11,0,"Fix symlinking of openstack-base source

Original symlinking works fine with a tarball source for the
requirements repo.

However, when user supplies git type source of it, we cannot
guarantee that the source direcotry name contains ``requirements``.

This patch fixes it by moving plugins directory outside of
openstack-base directory, which ultimately allow us to use simpler
symlinking as openstack-base-archive would be the only directory
inside.

Closes-Bug: #2074075
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+5, -6)
releasenotes/notes/fix-git-build-23c8fe6c4b0d92c4.yaml (+6, -0)
",-0.289815,-1.321748,0.571299,0.293249,-0.057667,-0.517806,0.462521,0.194371,0.024564,-0.291768,0.199584,-0.134106,0.094358,0.104577,0.2415
openstack/kolla-ansible,Ia7bd309479f098bc0b65ecf76dc294d893dadbc4,1,0,0.6291,2.9444,1.0,1,10.0,102,0,Doc,0,0,0,151,0.015228,0.8333,1,0.5243,3,1,0,0.701,0.0,3.0,35.95,16.0,0,0,0.0,0,5.3684,0,0,0,0,0,"docs: Remove Stream 8 and Jammy past references
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+0, -18)
",2.547198,0.240781,0.767279,-0.560525,0.196775,0.586193,-0.815318,0.695601,-0.414909,0.288944,-0.17954,-0.131162,0.545105,-0.115492,-0.464535
openstack/openstack-ansible-os_keystone,Ib10022bc2b29e556d5254827122c138e90381c0b,1,1,0.95,1.7918,1.0,3,10.0,352,0,Bug Fix,0,0,0,180,0.052678,1.0,0,0.95,1,1,0,1.0,1.5219,1.0,21.14,12.0,0,0,0.0,0,58.6667,0,6,0,23,0,"Do not install uWSGI as part of Keystone

uWSGI isntallation is expected to be handled by our uwsgi role, thus
it's installation with keystone is not needed neither for source nor for
distro path.

Related-Bug: #2073873
Depends-On: https://review.opendev.org/c/openstack/ansible-role-uwsgi/+/924922
[SEP]
FILES CHANGED:
vars/redhat.yml (+0, -2)
vars/debian.yml (+0, -2)
defaults/main.yml (+0, -1)
",-0.995976,0.766076,-0.630944,0.165485,-0.70121,-0.249,0.398818,0.116192,0.025572,-0.273746,0.107615,-0.161725,0.353773,-0.221809,0.28175
openstack/openstack-ansible-openstack_hosts,Idb31e2644511e07d7bbb8064f8c749870b14397e,1,0,0.9503,1.7918,0.2,4,16.5,446,0,CI,0,0,0,181,0.052893,1.0,0,0.9503,1,1,0,0.8182,1.9219,1.0,50.37,13.87,0,0,0.0,0,74.3333,0,0,0,0,0,"Ensure python3-packaging is installed for distros

With modern setuptools presence of packaging module for python might
be essential for some tools to operate properly. In most cases the
package is being pre-shipped in the image, though it's still worth to
ensure it's presence rather then rely on the specific image build.
This should also ensure that we have the module inside LXC as well.
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+1, -1)
vars/ubuntu-22.04.yml (+1, -0)
vars/ubuntu-24.04.yml (+1, -0)
vars/debian.yml (+1, -0)
",-0.232495,-2.09968,0.195814,0.69969,-0.368213,-0.324249,0.980255,-0.270612,-0.348917,0.143574,-0.02109,-0.052277,0.187215,-0.325958,0.229445
openstack/ansible-collection-kolla,I9cf650de544155ff0b9119ad50a0402f06f7aa96,0,0,0.375,6.2086,0.3185,16,5.17,304,0,Feature,0,0,0,8,0.005533,1.0,0,0.375,3,1,0,0.7692,3.3633,3.0,-3.09,18.84,0,0,0.0,0,0.6117,0,0,0,0,0,"Add uninstall tasks

During migration, old container engine and it's packages
should be removed, these new tasks are responsible for that.
[SEP]
FILES CHANGED:
roles/podman/tasks/install.yml (+2, -0)
roles/podman/tasks/uninstall.yml (+49, -0)
roles/docker/tasks/install.yml (+10, -0)
roles/podman/defaults/main.yml (+9, -0)
roles/docker/defaults/main.yml (+10, -0)
roles/docker/tasks/uninstall.yml (+68, -0)
roles/podman_sdk/tasks/uninstall.yml (+15, -0)
roles/docker_sdk/defaults/main.yml (+6, -1)
roles/podman/tasks/main.yml (+1, -3)
roles/podman_sdk/tasks/main.yml (+1, -79)
roles/docker/tasks/main.yml (+1, -11)
roles/docker_sdk/tasks/main.yml (+1, -63)
roles/docker_sdk/tasks/install.yml (+64, -0)
roles/docker_sdk/tasks/uninstall.yml (+15, -0)
roles/podman_sdk/tasks/install.yml (+80, -0)
roles/podman_sdk/defaults/main.yml (+6, -1)
",1.684936,-1.312018,0.219886,0.603897,-0.055606,0.478509,0.064731,-0.619285,-0.298027,-0.380164,-0.567181,0.469283,-0.16645,0.673086,-0.654926
openstack/kolla-ansible,I169e27899f7350f5eb8adb1f81a062c51e6cbdfc,0,1,0.375,4.2047,0.4394,27,3.14,327,1,Bug Fix,0,0,0,8,0.001551,1.0,0,0.375,4,3,0,0.7016,4.6026,3.85,-107.84,13.98,1,0,0.0,1,4.8806,0,6,0,5,0,"Put memcache_security_strategy in single place at all.yml

For possible config options see docs
https://docs.openstack.org/keystonemiddleware/latest/middlewarearchitecture.html#memcache-protection

Closes-bug: #1850733
[SEP]
FILES CHANGED:
ansible/roles/swift/templates/proxy-server.conf.j2 (+1, -1)
ansible/roles/tacker/templates/tacker.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
releasenotes/notes/bug-1850733-aa3b0d335c8e4e1e.yaml (+7, -0)
ansible/roles/manila/templates/manila-share.conf.j2 (+3, -3)
ansible/roles/aodh/templates/aodh.conf.j2 (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
ansible/roles/heat/templates/heat.conf.j2 (+1, -1)
ansible/roles/masakari/templates/masakari.conf.j2 (+1, -1)
ansible/roles/designate/templates/designate.conf.j2 (+1, -1)
ansible/roles/placement/templates/placement.conf.j2 (+1, -1)
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -1)
ansible/roles/nova/templates/nova.conf.j2 (+1, -1)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+1, -1)
ansible/roles/zun/templates/zun.conf.j2 (+2, -2)
ansible/roles/watcher/templates/watcher.conf.j2 (+1, -1)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -1)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -1)
ansible/roles/neutron/templates/neutron.conf.j2 (+1, -1)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+1, -1)
ansible/roles/octavia/templates/octavia.conf.j2 (+2, -2)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/manila/templates/manila.conf.j2 (+1, -1)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+1, -1)
ansible/roles/barbican/templates/barbican.conf.j2 (+1, -1)
",-0.290703,0.9985,-1.07182,-0.045588,-0.642261,-0.320992,-0.145018,0.435121,0.40096,-0.536412,-0.654323,-0.415996,-0.510974,-0.389475,0.286182
openstack/kolla-ansible,I2c06ce5e138f52259c1725dae37f25c1b00d1e6b,0,0,0.5,3.989,0.0,7,19.33,420,0,Feature,0,0,0,2,0.009852,1.0,0,0.5,5,3,0,0.7002,2.3126,3.57,26.76,16.01,1,0,0.0,1,7.7778,0,0,0,0,0,"Add frontend TLS ability to ProxySQL

This patch ads an ability to receive TLS connections
to ProxySQL. Certificates and variable lookups are
added in order for TLS to be enabled by
<project_name>_database_internal_tls_enable.
Note that in order for this to work, mysql
connection strings need to have TLS enabled,
which can be added in separate per-service patches
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/copy-certs.yml (+9, -0)
ansible/roles/proxysql-config/templates/users.yaml.j2 (+3, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/certificates/tasks/generate.yml (+12, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.json.j2 (+19, -0)
releasenotes/notes/proxysql-internal-tls-dd68e952d97540a1.yaml (+8, -0)
ansible/roles/proxysql-config/defaults/main.yml (+1, -0)
",-0.759158,-0.895526,-0.249341,1.011682,0.204327,-0.280994,-0.333917,0.032621,0.375389,0.597595,-0.401763,-0.459749,-0.017332,-0.236937,-0.264982
openstack/kolla-ansible,I816d051e933a560629d9b9c95362f668abe4ade7,0,0,0.3333,2.3026,0.1111,3,8.5,160,0,Feature,0,0,0,3,0.011719,0.5714,0,0.1905,4,3,0,0.6988,1.5305,3.33,4.13,22.22,1,0,0.0,1,16.0,0,0,0,0,0,"Add frontend database TLS for Keystone

This patch enables internal TLS database
connection for Keystone.
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/keystone.conf.j2 (+1, -1)
releasenotes/notes/proxysql-internal-tls-keystone-5e3574a356afc819.yaml (+4, -0)
ansible/roles/keystone/defaults/main.yml (+3, -0)
",2.058439,-1.207797,0.416769,0.64065,0.13291,0.269856,-0.407116,1.240442,0.37314,0.041376,-0.638681,0.509146,-0.031176,-0.203865,-0.001515
openstack/charm-ceph-rbd-mirror,I5a2a5cf200c32823c7d2a83b8f6afbcddb8cacc9,0,0,0.4667,7.0121,0.7259,13,5.5,409,0,CI,0,0,1,15,0.00518,1.0,0,0.4667,3,4,0,1.0,2.7711,1.54,20.52,9.47,1,0,0.6817,1,0.3685,0,0,0,0,0,"Add charmcraft 3 support

Update the charmcraft.yaml file to use base and platforms, only
allowing noble support. Remove test bundles for older bases.

Also modernize build process using the reactive plugin, and modernize
tox.ini, update build.lock pins and remove cruft.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1255
[SEP]
FILES CHANGED:
osci.yaml (+1, -1)
src/metadata.yaml (+1, -2)
src/tests/tests.yaml (+1, -11)
src/tests/bundles/focal-yoga.yaml (+0, -187)
requirements.txt (+0, -10)
src/tests/bundles/jammy-bobcat.yaml (+0, -180)
src/tests/bundles/jammy-yoga.yaml (+0, -186)
src/wheelhouse.txt (+2, -1)
charmcraft.yaml (+23, -18)
src/build.lock (+264, -0)
tox.ini (+8, -22)
src/tests/bundles/jammy-antelope.yaml (+0, -184)
src/tests/bundles/noble-caracal.yaml (+4, -3)
",-0.706583,0.174248,-0.48436,0.235697,-0.399745,-0.92899,0.5131,0.585611,-0.106261,-0.119507,-0.105257,-0.352605,0.098229,0.197527,-0.050217
openstack/charms.ceph,I7a49f988a10d9654d586864579233f517b32d4a3,0,0,0.4375,4.7707,0.0769,4,12.0,107,0,Feature,0,0,0,16,0.003995,1.0,0,0.4375,1,2,0,0.5,0.8851,0.75,46.61,11.47,1,0,0.7863,0,0.9068,0,0,0,0,0,"Allow users to skip WAL or DB for Bluestore (quincy)
[SEP]
FILES CHANGED:
charms_ceph/broker.py (+1, -1)
charms_ceph/utils.py (+16, -6)
.gitreview (+1, -0)
unit_tests/test_utils.py (+90, -2)
",1.333717,1.762261,-0.255032,0.804442,1.200196,0.79161,0.370318,-0.412763,-0.64318,-0.392913,0.518106,0.416925,0.614332,-0.566313,-0.743803
openstack/openstack-ansible,Ie84e232d8742b71200983c92aaadac965bb9a202,1,0,0.9505,0.6931,1.0,1,13.33,269,0,Feature,1,0,0,182,0.053108,0.0,0,0.0,2,1,0,0.9326,0.0,2.0,60.06,10.33,0,0,1.0,0,134.5,0,0,0,0,0,"Remove the get_md5 parameter from ansible stat tasks

Ansible 9 removes the get_md5 parameter and it is an error to use it.
So let's remove it now before jobs will start failing once Zuul will
bump ansible version.
[SEP]
FILES CHANGED:
zuul.d/playbooks/post.yml (+0, -1)
",0.078944,-0.774324,-0.749848,0.511851,0.20601,-0.133404,0.182755,-0.809207,-0.696744,0.084118,0.311578,-0.227478,-0.378312,-0.140648,-0.042006
openstack/kolla-ansible,I384068572d8a1a495c60b401dc4144a0a80802f1,1,0,1.0,4.7536,0.3478,6,7.33,510,0,CI,0,0,0,2,0.1,0.6667,0,0.6667,4,2,0,0.6973,1.8956,2.0,41.73,10.81,1,0,0.9217,1,4.3966,0,0,0,0,0,"Add support for Ubuntu Noble Numbat (24.04 LTS)

ubuntu-ceph is broken for now due to [1], also there are no
download.ceph.com packages for Noble - so we're using Ubuntu
provided ones from proposed - because current version
in regular repos is built from git sha instead of a release
and is not suitable for running outside of Ceph upstream CI.

[1]: https://tracker.ceph.com/issues/66389

Depends-On: https://review.opendev.org/c/openstack/kolla/+/907589
[SEP]
FILES CHANGED:
releasenotes/notes/ubuntu-noble-936f8c63ce5801e3.yaml (+4, -0)
tests/pre.yml (+28, -0)
zuul.d/nodesets.yaml (+13, -13)
zuul.d/jobs.yaml (+26, -26)
ansible/roles/prechecks/vars/main.yml (+1, -0)
roles/cephadm/tasks/pkg_debian.yml (+3, -1)
",-1.080256,0.36611,0.148948,-0.5733,-1.015097,-0.323576,0.626861,0.309746,-0.701779,-0.022047,0.116101,-0.132116,0.054557,-0.098977,-0.247334
openstack/kolla-ansible,I7be701d8673dea8345a5fe7a95ad69633f1b7648,1,0,0.3529,1.3863,0.3333,1,4.8,278,0,Bug Fix,0,0,1,17,0.049708,0.7143,1,0.2521,0,1,0,0.698,0.0,0.0,-20.11,15.25,0,0,0.0,0,69.5,0,0,0,0,0,"CI: fix lint requirements for python 3.12

see: https://github.com/PyCQA/flake8/issues/1845#issuecomment-1766073353
pycodestyle >= 2.11 requires newer `hacking` version as well
[SEP]
FILES CHANGED:
lint-requirements.txt (+2, -1)
",0.159879,1.582686,-1.072878,-0.364063,-0.53155,0.259995,-0.423482,0.105905,0.04432,0.496759,-0.495841,-0.19113,-0.345932,-0.317746,0.556888
openstack/kolla-ansible,I4ef5147eacef32ed93c21d44bf23b664adf1eb91,1,0,0.3889,1.6094,0.5,1,7.0,195,0,Bug Fix,0,0,0,18,0.052174,0.0,0,0.0,1,1,0,0.6986,0.0,1.0,14.42,14.23,0,0,0.0,0,39.0,0,0,0,0,0,"fix flake8 error in database_shards.py

wrong use of a f-string when no variable is templated
[SEP]
FILES CHANGED:
kolla_ansible/database_shards.py (+2, -2)
",2.145112,-0.447054,0.429731,-0.21928,-0.146441,-0.06441,0.698597,-0.687696,0.187415,-0.498639,0.146104,-0.248991,-0.670981,-0.084852,0.04396
openstack/octavia-dashboard,I8d90a7225361a88ebfd68e7f16724b302031eda6,1,1,0.7576,2.1972,0.125,2,13.33,318,0,Bug Fix,0,0,0,99,0.008346,1.0,0,0.7576,2,2,0,0.3333,0.9544,1.5,21.99,15.33,0,0,0.0,1,35.3333,0,6,0,12,0,"Fixed incorrect region endpoint in multi-region

When using multi-region, octavia-dashboard used the keystone catalog of
auth endpoint linked to the horizon session. But it should use the
keystone endpoint of the selected region if it exists.

Closes-Bug: #2076074
[SEP]
FILES CHANGED:
octavia_dashboard/sdk_connection.py (+2, -1)
releasenotes/notes/fix-incorrect-region-endpoint-1afc5ebdc6fc4110.yaml (+5, -0)
",0.558146,-1.12922,-0.415,0.337368,-0.415249,-0.110022,0.315689,0.467483,0.227065,-0.745856,0.270911,0.482433,0.088258,0.018129,0.169453
openstack/kolla,Ia1bdff87cba73587a03124ab78a56b21c6176373,1,1,0.3333,3.6109,0.0278,4,14.0,632,0,Bug Fix,0,0,0,9,0.001723,0.5312,0,0.1771,2,3,0,0.716,1.7842,2.0,25.44,16.55,1,0,0.0,1,17.0811,0,4,0,6,0,"Refactor dev mode

Provides mechanism for future work to fix bug where when package file
manifest changes, the changes were not reflected in to devmode-enabled
container.

It changes the strategy of installing projects in dev mode in containers.
Instead of bind mounting the project's git repository to the venv
of the container, the repository is bind mounted to
/dev-mode/<project_name> from which the it is installed using pip
on every startup of the container using kolla_install_projects script.

Related-bug: #1814515
[SEP]
FILES CHANGED:
docker/base/start.sh (+3, -0)
docker/base/Dockerfile.j2 (+5, -1)
docker/base/install_projects.sh (+12, -0)
releasenotes/notes/bug-1814515-99197e13a6280861.yaml (+15, -0)
",-1.011147,-1.774,0.564652,0.208579,-0.186049,-0.577011,0.156695,0.431066,0.128826,-0.077457,-0.074668,-0.032882,0.056235,0.351216,-0.131393
openstack/kolla-ansible,If191cd0e3fcf362ee058549a1b6c244d109b6d9a,1,1,0.4,5.3471,0.4641,29,10.5,819,0,Bug Fix,0,0,0,10,0.001901,1.0,0,0.4,4,3,0,0.6992,4.6073,3.9,26.17,14.49,1,0,0.0,1,3.9,0,4,0,6,0,"Refactor dev mode

Build upon changes in kolla which change strategy of installing projects
in containers when in dev mode. This fixes problems where when package
file manifest changes, the changes were not reflected in to
devmode-enabled container.

It changes the strategy of installing projects in dev mode in containers.
Instead of bind mounting the project's git repository to the venv
of the container, the repository is bind mounted to
/dev-mode/<project_name> from which the it is installed using pip
on every startup of the container using kolla_install_projects script.

Also updates docs to reflect the changes.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/925712
Closes-Bug: #1814515
Singed-off-by: Roman Krƒçek <roman.krcek@tietoevry.com>
[SEP]
FILES CHANGED:
ansible/roles/mistral/defaults/main.yml (+4, -4)
ansible/roles/nova-cell/defaults/main.yml (+9, -9)
ansible/roles/horizon/defaults/main.yml (+1, -2)
ansible/roles/neutron/defaults/main.yml (+11, -11)
ansible/roles/heat/defaults/main.yml (+3, -3)
ansible/roles/cinder/defaults/main.yml (+4, -4)
ansible/roles/manila/defaults/main.yml (+4, -4)
doc/source/contributor/kolla-for-openstack-development.rst (+3, -2)
ansible/roles/cloudkitty/defaults/main.yml (+2, -2)
ansible/roles/blazar/defaults/main.yml (+2, -2)
ansible/roles/placement/defaults/main.yml (+1, -1)
ansible/roles/kuryr/defaults/main.yml (+2, -2)
ansible/roles/keystone/defaults/main.yml (+1, -1)
ansible/roles/glance/defaults/main.yml (+1, -1)
ansible/roles/designate/defaults/main.yml (+6, -6)
releasenotes/notes/bug-1814515-217c5cd59d7d251f.yaml (+15, -0)
ansible/roles/barbican/defaults/main.yml (+3, -3)
ansible/roles/tacker/defaults/main.yml (+2, -2)
ansible/roles/trove/defaults/main.yml (+3, -3)
ansible/roles/masakari/defaults/main.yml (+4, -4)
ansible/roles/octavia/defaults/main.yml (+5, -5)
ansible/roles/venus/defaults/main.yml (+2, -2)
ansible/roles/ceilometer/defaults/main.yml (+4, -4)
ansible/roles/aodh/defaults/main.yml (+4, -4)
ansible/roles/nova/defaults/main.yml (+4, -4)
ansible/roles/ironic/defaults/main.yml (+3, -3)
ansible/roles/magnum/defaults/main.yml (+2, -2)
ansible/roles/zun/defaults/main.yml (+4, -4)
ansible/roles/watcher/defaults/main.yml (+3, -3)
",-2.50692,0.530768,1.718226,-0.408239,-0.602828,-0.089036,0.095436,0.183408,-0.088252,-0.509109,0.115142,0.057413,0.08582,0.190989,-0.218945
openstack/openstack-ansible-os_octavia,I541b52fdf87703fcf434742b6d259c57cc9e281a,1,0,0.9508,1.9459,0.5,2,4.62,388,0,Doc,0,0,0,183,0.053384,0.9273,0,0.8817,1,2,0,0.75,0.9183,1.0,-15.08,13.74,0,0,0.0,0,55.4286,0,0,0,0,0,"Ensure Octavia communicates with Neutron through internal URL

Since 2023.2 release `endpoint_type` option was deprecated in favor of
`valid_interfaces` [1]. For rest services there's no such deprecation
notes, so leaving them ""as is"".

[1] https://docs.openstack.org/octavia/latest/configuration/configref.html#neutron.endpoint_type
[SEP]
FILES CHANGED:
templates/octavia.conf.j2 (+2, -2)
defaults/main.yml (+1, -1)
",-0.844301,1.64464,-0.465467,0.856886,-0.350288,0.08125,0.293171,0.21749,0.277739,0.317269,-0.018209,-0.386037,-0.47745,-0.381136,-0.198899
openstack/kolla-ansible,I651f8e3fe9d0a247fa505e327847557ed426f6cf,1,0,0.8793,1.0986,0.5,1,10.0,96,0,Bug Fix,1,0,0,58,0.056475,0.4211,0,0.3702,2,1,0,0.6998,0.0,2.0,27.49,12.0,1,0,1.0,0,32.0,0,0,0,0,0,"CI: Fix variable name for Nova noVNC FQDN
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -1)
",2.155682,0.012228,1.050233,0.142926,1.261528,0.155206,-0.391996,0.854992,0.10223,-0.023051,0.056812,-0.3037,0.368,-0.345808,-0.153594
openstack/kolla-ansible,I989d0d6c134d85bada227fca8233fb0ac290625a,1,0,0.6316,1.3863,0.3333,1,7.0,84,0,CI,0,0,0,152,0.015301,0.0,0,0.0,3,1,0,0.7004,0.0,3.0,-5.73,19.94,0,0,0.0,0,21.0,0,0,0,0,0,"CI: Pin openstackclient to <7
[SEP]
FILES CHANGED:
roles/openstack-clients/defaults/main.yml (+2, -1)
",2.605712,0.843985,1.279902,0.037616,0.501138,0.301152,-0.661365,0.727698,-0.067612,0.806752,-0.185454,0.140886,0.122814,-0.382199,0.202231
openstack/kolla-ansible,I516bbbb3a0f194e8fa08d04c0290b586963b8b55,1,0,0.634,2.0794,0.4286,4,17.0,145,0,Feature,0,0,1,153,0.015397,0.75,0,0.4755,2,4,0,0.701,1.9502,1.0,25.36,20.92,0,0,0.0,1,18.125,0,0,0,0,0,"Bump codespell pin to <3

Adapt files to match new requirements, add assertIn to whitelist
[SEP]
FILES CHANGED:
releasenotes/notes/move-storage-passwords-09b5afc839284321.yaml (+1, -1)
ansible/group_vars/all.yml (+1, -1)
lint-requirements.txt (+1, -1)
.codespell-ignore (+1, -0)
",1.519814,-1.036325,-0.244239,0.174058,0.627801,-0.076232,-0.364644,-0.156715,-0.093274,0.305184,-0.584765,-0.157364,0.001906,0.100927,-0.446706
openstack/kolla,I5ba67d6e4bbe1b6d6caa842715b56720a027dc76,1,1,0.725,2.1972,0.125,2,9.5,210,0,Bug Fix,0,0,0,40,0.013059,0.0,0,0.0,3,2,0,0.7172,0.8113,2.5,-20.99,16.43,0,0,0.0,1,23.3333,0,6,0,4,0,"Fix build of prometheus-ovn-exporter

This patch fixed build of prometheus-ovn-exporter
when building with --image-name-prefix option.

Closes-Bug: #2076249
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2076249-96b7f39fbdcf2293.yaml (+6, -0)
docker/prometheus/prometheus-ovn-exporter/Dockerfile.j2 (+1, -1)
",0.231579,1.329914,-0.883877,0.574353,0.267506,-0.55827,-0.641678,-0.145101,-0.073007,-0.419023,0.223092,0.141527,0.273526,0.199791,0.838184
openstack/kolla-ansible,I29a3f86b59aeaa8ca64d5e6780fa094b903d0039,1,0,0.6364,1.3863,0.0,2,8.0,92,0,CI,0,0,0,154,0.015487,0.3333,0,0.2121,3,1,0,0.7016,0.9183,3.0,8.37,18.2,0,0,0.0,0,23.0,0,0,0,0,0,"CI: Use u-c in openstack-clients role
[SEP]
FILES CHANGED:
roles/openstack-clients/defaults/main.yml (+2, -0)
roles/openstack-clients/tasks/main.yml (+1, -0)
",2.267686,1.294507,0.713871,0.004175,0.977744,-0.681319,0.036734,0.245084,-0.272856,-0.197839,-0.013924,0.268266,0.36833,0.11761,0.081488
openstack/kolla-ansible,Ifa2c455a0ac5d239cbd7de329521474b366b3c76,0,0,0.6387,1.3863,0.6667,1,9.0,189,0,CI,0,1,0,155,0.015583,0.5,0,0.3194,3,1,0,0.7022,0.0,3.0,33.2,12.49,0,0,0.0,0,47.25,0,0,0,0,0,"Revert ""CI: Pin openstackclient to <7""

This reverts commit 9a5059d4408a11f23c23f2543c404292ac9d088a.

Reason for revert: let's use UC
[SEP]
FILES CHANGED:
roles/openstack-clients/defaults/main.yml (+1, -2)
",0.273768,-0.630759,-2.156296,-1.660406,0.880369,0.584773,0.504812,-0.182712,0.011754,0.329094,-0.227627,0.43383,-0.201545,0.123228,0.126262
openstack/kolla-ansible,I444fc345e5d21ed969f48aa9a6230905cc411149,1,1,0.625,1.6094,0.25,1,5.29,421,0,Bug Fix,0,0,0,24,0.073394,0.5,0,0.3125,4,1,0,0.7008,0.0,4.0,-29.47,17.25,0,0,0.0,0,84.2,0,6,0,13,0,"Restart OVS container after hw-offload change

OpenvSwitch container needs to be restarted for hw offload to be
enabled/disabled properly [1].

OpenvSwitch container will also be restarted when system-id or
hostname changes.

Closes-Bug: #2076335

[1] https://docs.openstack.org/neutron/2024.1/admin/config-ovs-offload.html#configure-open-vswitch-hardware-offloading
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/tasks/post-config.yml (+3, -1)
",-2.278821,1.49829,-0.374473,0.403409,-0.117425,-0.514751,-0.176573,0.376586,0.164424,-0.051952,0.093902,-0.02835,0.313913,0.040107,0.043774
openstack/kolla-ansible,Id80c7823fcc5d934b7369c7c0722cd78188e2ccf,0,1,0.8125,5.8464,0.3797,17,9.3,849,0,Bug Fix,0,0,0,16,0.082051,1.0,0,0.8125,5,4,0,0.7014,3.089,3.65,-10.92,20.49,1,0,0.0203,1,2.4538,0,6,0,4,0,"Fix TLS settings when letsencrypt turned on

- Introduced `letsencrypt_managed_certs`
  variable to handle whether letsencrypt
  will generate internal, external or both
  certificates.
- Updated certificate generation logic to use
  `letsencrypt_managed_certs` conditionally,
  replacing the previous `enable_letsencrypt` boolean.
- Adjusted tasks and templates to support
  internal/external certificate management based
  on the new variable.
- Enhanced Let's Encrypt script (`letsencrypt-lego-run.sh.j2`)
  to handle both internal and external certificates depending
  on VIP configurations.
- Refined HAProxy configuration templates to correctly map
  certificates based on TLS settings and new management logic.

Closes-bug: #2076331

Co-Authored-By: Michal Arbet <michal.arbet@ultimum.io>
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/copy-certs.yml (+64, -18)
ansible/roles/loadbalancer/tasks/precheck.yml (+29, -35)
releasenotes/notes/bug-2076331-f4ef64ad0a12aa85.yaml (+21, -0)
ansible/roles/service-cert-copy/defaults/main.yml (+1, -0)
ansible/roles/service-cert-copy/tasks/main.yml (+2, -2)
tests/templates/globals-default.j2 (+4, -3)
ansible/roles/loadbalancer/templates/haproxy/haproxy.json.j2 (+3, -4)
ansible/roles/rabbitmq/defaults/main.yml (+5, -0)
doc/source/admin/tls.rst (+15, -0)
ansible/roles/certificates/tasks/main.yml (+1, -1)
ansible/roles/loadbalancer/tasks/config.yml (+2, -36)
ansible/group_vars/all.yml (+4, -0)
ansible/roles/certificates/tasks/generate.yml (+50, -23)
ansible/roles/letsencrypt/defaults/main.yml (+0, -1)
ansible/roles/letsencrypt/templates/crontab.j2 (+6, -4)
ansible/roles/letsencrypt/templates/letsencrypt-lego-run.sh.j2 (+6, -4)
ansible/roles/loadbalancer/defaults/main.yml (+1, -0)
",-2.53802,0.572157,1.839581,-0.082161,0.213234,-0.200758,-0.441028,0.421558,0.241828,-0.477429,0.11506,-0.247246,0.219897,-0.08874,0.106664
openstack/openstack-ansible,I339bdd11a4c212cd48e9cdf659166ad0af1e84f4,1,0,0.9511,2.3979,0.0,1,16.4,573,0,CI,0,0,0,184,0.053582,0.0,0,0.0,1,1,0,0.9333,0.0,1.0,38.53,15.83,0,0,0.0,0,52.0909,0,0,0,0,0,"Verify OS for containers installation

It could easily happen that while target host was upgraded but
containers left running old OS. In this case running openstack_hosts
role will result in adding weird repo, like adding osbpo on Ubuntu 20.04
as it will be treated as debian due to missing more specific match.

Moreover, if running setup-hosts and metal hosts were not updated to
supported OS, and will fail during openstack-hosts-setup, this will not
prevent containers from attempting running openstack_hosts role.
[SEP]
FILES CHANGED:
playbooks/containers-lxc-create.yml (+10, -0)
",-1.233868,-1.967774,0.373834,0.43496,0.161575,-0.796021,0.216984,0.099886,-0.264394,0.088111,0.094829,0.033245,0.276514,-0.057496,-0.062847
openstack/kolla,Ided63ff1462f7554302c8e2958ac46cc370c8455,0,0,0.6346,1.0986,0.0,1,17.0,417,0,CI,0,0,0,156,0.015678,0.5,0,0.3173,2,1,0,0.7184,0.0,2.0,5.45,18.56,0,0,0.0,0,139.0,0,0,0,0,0,"horizon: Copy wsgi.py to /etc/openstack-dashboard/

Every time new Debian/Ubuntu/Rocky comes out - we need
to do a dance with passing distro_python_version from kolla
to kolla-ansible, updating kolla-ansible distro_python_version
and then removing the additional variables in CI
This patch will allow smoother migrations to newer OSes with
newer Python versions.
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+2, -0)
",-0.895027,-0.530629,-0.360492,0.304755,0.351136,-0.713196,0.446679,0.288842,-0.714021,-0.243045,-0.066451,-0.258837,-0.030309,0.098066,0.310005
openstack/kolla-ansible,I84b115ec2f9a509c079aa7ccc6e4d60c9e1ce33d,0,0,0.6306,1.9459,0.6667,1,11.2,485,0,CI,0,0,0,157,0.015776,1.0,0,0.6306,4,1,0,0.7,0.0,4.0,2.1,16.62,0,0,0.0,0,69.2857,0,0,0,0,0,"horizon: Use versionless path for wsgi.py and static

Every time new Debian/Ubuntu/Rocky comes out - we need
to do a dance with passing distro_python_version from kolla
to kolla-ansible, updating kolla-ansible distro_python_version
and then removing the additional variables in CI
This patch will allow smoother migrations to newer OSes with
newer Python versions.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/925979
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/horizon.conf.j2 (+2, -4)
",-1.638868,0.178872,-0.137301,-0.030072,-0.095759,-0.500732,0.076848,0.149662,-0.51405,-0.178996,-0.106257,-0.145042,0.002175,-0.070714,0.09585
openstack/ansible-collection-kolla,Ibd2ab4379aac9cccf49d98b6bf3c12526eacdbd1,1,0,0.6266,3.9318,0.1,4,9.75,310,0,Doc,0,0,0,158,0.015867,0.8571,0,0.5371,3,1,0,0.7143,1.4009,3.0,29.91,14.16,1,0,0.0,0,6.0784,0,0,0,0,0,"docker/podman_sdk: Install sdk from deb when python externally managed

Since we're adding Ubuntu 24.04 that has python3.12 - we need to
install python3-docker/podman also there - future proof solution
is to check for existence of EXTERNALLY-MANAGED file.
[SEP]
FILES CHANGED:
roles/podman_sdk/tasks/main.yml (+21, -1)
roles/docker_sdk/tasks/main.yml (+22, -2)
roles/docker_sdk/defaults/main.yml (+1, -1)
roles/podman_sdk/defaults/main.yml (+1, -1)
",0.283148,-0.96907,-0.497949,0.161484,-0.008662,-0.742468,0.259634,0.227023,-0.769607,0.163223,-0.244508,-0.115085,-0.025896,0.067208,0.353587
openstack/ansible-collection-kolla,I106fd52090be926100d4f5af3a5f15544a802eef,0,0,0.6289,1.6094,0.5,2,8.0,89,0,Feature,0,0,0,159,0.015887,0.6667,0,0.4193,3,1,0,0.7333,1.0,3.0,-12.78,23.2,1,0,0.0,0,17.8,0,0,0,0,0,"sdk: Stop enabling osbpo on Ubuntu
[SEP]
FILES CHANGED:
roles/podman_sdk/tasks/main.yml (+1, -1)
roles/docker_sdk/tasks/main.yml (+1, -1)
",2.643071,0.615922,0.866481,-0.125545,0.264384,-0.148588,-0.08133,0.2365,-0.677143,0.288839,0.298361,-0.225078,-0.18327,-0.282577,0.170024
openstack/openstack-ansible,I4d3b4af4b7a9ddd86b0f53d64714a724413c0207,1,0,0.9514,2.5649,0.0833,2,12.25,376,0,CI,0,0,0,185,0.053717,0.0,0,0.0,2,2,0,0.9341,0.4138,2.0,32.11,17.14,0,0,0.0,1,28.9231,0,0,0,0,0,"Do not install Skyline with os-infra_hosts

A lot of deployments might have os-infra_hosts defined in their o_u_c
which would result in creation of Skyline containers and replacing
Horizon with Skyline on upgrade. Such behaviour migh be unwanted
during upgrades, so we remove os-infra_hosts from Skyline env.d
defenition.
[SEP]
FILES CHANGED:
inventory/env.d/skyline.yml (+0, -1)
releasenotes/notes/skyline_not_infra_hosts-58190dad1c43ed9a.yaml (+11, -0)
",-1.152408,-0.499175,-0.427048,0.685826,0.842927,-0.424464,-0.31367,-0.110616,-0.768574,-0.210535,0.065173,-0.332708,0.194658,-0.307316,-0.076635
openstack/kolla,I6af9baf09a19a7dbcaf98585870aa44ff79398d3,1,1,0.8372,2.8904,0.0,2,5.0,180,0,Bug Fix,0,0,0,43,0.034846,1.0,0,0.8372,2,2,0,0.7154,0.9774,2.0,-35.12,20.67,1,0,0.0,1,10.0,0,6,0,19,0,"Configure Apache services to use correct locale

Closes-Bug: #2076453
[SEP]
FILES CHANGED:
releasenotes/notes/configure-apache-locale-d0150e5881f00e65.yaml (+7, -0)
docker/base/httpd_setup.sh (+10, -0)
",1.402329,-0.157587,-0.812923,-0.530167,-0.356454,1.02313,-0.934721,0.1353,0.186314,-0.158214,0.58504,-0.187422,0.11009,-0.200149,-0.029386
openstack/kayobe,Ied06ee3380a149c4c8d082562c93f9b771457cb4,1,1,0.8571,2.1972,0.125,2,2.25,121,0,Bug Fix,0,0,0,14,0.024096,1.0,0,0.8571,2,2,0,0.9099,0.8113,1.0,25.95,18.68,0,0,0.0,1,13.4444,0,6,0,13,0,"Bump stackhpc.systemd_networkd role to v1.0.6

Closes-Bug: #2073100
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
releasenotes/notes/fix-systemd-networkd-enabling-10bf4e5f0903c311.yaml (+6, -0)
",1.318685,0.096153,-0.980521,-0.784367,-0.203187,0.263235,-0.44346,0.886799,0.2178,-0.005755,0.273152,-0.132375,-0.883598,0.136939,0.422507
openstack/kayobe,Ied06ee3380a149c4c8d082562c93f9b771457cb4,1,1,0.8667,2.1972,0.125,2,2.25,121,0,Bug Fix,0,0,0,15,0.025467,1.0,0,0.8667,2,2,0,0.9107,0.8113,1.0,25.95,18.68,0,0,0.0,1,13.4444,0,6,0,13,0,"Bump stackhpc.systemd_networkd role to v1.0.6

Closes-Bug: #2073100
[SEP]
FILES CHANGED:
requirements.yml (+1, -1)
releasenotes/notes/fix-systemd-networkd-enabling-10bf4e5f0903c311.yaml (+6, -0)
",1.318685,0.096153,-0.980521,-0.784367,-0.203187,0.263235,-0.44346,0.886799,0.2178,-0.005755,0.273152,-0.132375,-0.883598,0.136939,0.422507
openstack/kolla-ansible,I09a45d26a6075554b204e007f64122f23de5f53c,1,0,0.875,4.4067,0.0,5,17.0,137,0,Feature,0,0,0,16,0.026801,1.0,0,0.875,4,4,0,0.6986,1.723,2.4,35.31,13.86,1,0,0.0,1,1.6707,0,0,0,0,0,"Add command to upgrade to a target version of RMQ

Required before a SLURP upgrade
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-target-upgrade-command-d5f9d9fc27fa28f8.yaml (+6, -0)
doc/source/reference/message-queues/rabbitmq.rst (+44, -0)
ansible/roles/rabbitmq/defaults/main.yml (+2, -0)
tools/kolla-ansible (+8, -0)
ansible/rabbitmq-upgrade.yml (+21, -0)
",2.215249,-0.376074,0.240265,0.717287,0.225479,0.667263,0.701251,0.682245,0.184898,0.137252,0.096395,0.800443,-0.504564,0.08751,-0.001139
openstack/kolla-ansible,I1244f453af8f339cc3db7300951e366196e5291a,0,0,0.8824,3.4965,0.9688,1,14.0,216,0,CI,1,0,0,17,0.025074,0.5,0,0.4412,1,1,0,0.6992,0.0,1.0,44.58,14.17,1,0,1.0,0,6.5455,0,0,0,0,0,"Remove RabbitMQ queue migrations from upgrade test

RabbitMQ uses quorum queues by default in both Dalmatian and Caracal, so
we don't need to run the migrations.
[SEP]
FILES CHANGED:
tests/upgrade.sh (+1, -31)
",1.367311,-0.170735,-0.106555,0.748337,0.434377,0.128514,0.424579,-0.020938,-0.852744,-0.248507,0.14597,0.34702,-0.289832,-0.266986,0.124736
openstack/kolla,Ie133d6efc2e4c00002b8f0724e0183eaab35d1c5,1,0,0.8333,2.0794,0.1429,2,14.0,208,0,Feature,0,0,0,18,0.025352,0.4,0,0.3333,2,2,0,0.7166,0.8631,2.0,44.58,11.31,1,0,0.0,0,26.0,0,0,0,0,0,"Add support for checking incoming RabbitMQ version

Will be used to check if the current RabbitMQ version is high enough
before upgrading to the new one.
[SEP]
FILES CHANGED:
docker/rabbitmq/extend_start.sh (+5, -0)
docker/rabbitmq/Dockerfile.j2 (+1, -1)
",1.420085,-1.266472,0.313473,0.970882,-0.049347,0.615033,0.546694,-0.049865,0.003346,0.391152,-0.470784,0.583408,-0.462303,-0.097748,0.129062
openstack/kolla-ansible,Id8a5ebe19a50ebdc59d12667889472c803b8d7c8,1,0,0.8421,4.1744,0.0156,3,18.0,262,0,Feature,0,0,0,19,0.026499,1.0,0,0.8421,4,2,0,0.6978,0.4714,4.0,33.47,14.98,1,0,0.0,0,4.0308,0,0,0,0,0,"Add a precheck to catch RMQ SLURP upgrades

Given we bump the RabbitMQ version each release, there is a manual
upgrade to an intermediary RabbitMQ version needed before a skip-level
upgrade can be performed.
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+59, -0)
ansible/roles/rabbitmq/tasks/upgrade.yml (+2, -0)
doc/source/reference/message-queues/rabbitmq.rst (+2, -1)
",1.277719,-0.918384,0.160195,0.801068,0.304585,0.485176,0.824629,-0.070722,0.091311,0.090183,-0.187298,0.881089,-0.200579,-0.366144,0.65662
openstack/oslo.serialization,Ifbcf5a1b3d42516bdf73f7ca6b2a7338f3985283,1,1,0,2.8904,0.0,2,4.6,478,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,2,1,0,0.0,0.9975,1.5,10.9,14.88,1,1,0.5294,0,26.5556,0,6,0,13,0,"[jsonutils] Add handling of datetime.date format

Recent patch from keystone[1] do not work when
osprofiler is enabled as osprofiler does jsonutils.dumps
and datetime.date is not handled so it fails.
This patch adds the handling for it.

[1] https://review.opendev.org/c/openstack/keystone/+/924892

Needed-By: https://review.opendev.org/q/I1b71fb3881dc041db01083fbb4f2592400096a31
Related-Bug: #2074018
Closes-Bug: #2076430
[SEP]
FILES CHANGED:
oslo_serialization/tests/test_jsonutils.py (+9, -0)
oslo_serialization/jsonutils.py (+8, -0)
",-3.552916,1.320287,1.395878,-2.181453,0.382167,0.12297,0.653181,0.048272,0.127978,0.014348,0.065063,-0.160253,0.086494,-0.223852,-0.105429
openstack/kolla-ansible,Ied43b9d0c4b33bb514d367f3f99c2e30e104d139,1,1,0.4211,2.3026,0.1111,2,4.89,754,0,Bug Fix,0,0,0,19,0.054441,0.411,0,0.173,2,2,0,0.6984,0.7642,2.0,31.76,10.99,1,0,0.0,1,75.4,0,6,0,13,0,"external/internal vip: use proper ip comparison

The variable kolla_same_external_internal_vip in group_vars/all.yml
was set to true or false depending on the jinja2 equality operator
- == - which only checks if two objects are the same.

This is problematic because IPs can be the same but have different
string representations, e.g. leading zeroes in some octets, but still
repesent the same instance of an IP.

Example: 192.168.1.1 and 192.168.001.001 are the same.

Fix this, by using the ansible.utils.ipaddr() jinja2 filter instead
to increase robustness.

Closes-Bug: #2076889
Introduced-By: https://review.opendev.org/c/openstack/kolla/+/285005
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
releasenotes/notes/use_proper_ip_comparison-1ed77a21eb560079.yaml (+7, -0)
",-2.667733,0.291238,1.42678,-0.592015,-0.394271,0.031516,-0.14431,-0.1875,0.086504,0.021212,0.17247,-0.344585,-0.071525,-0.012217,-0.134282
openstack/kolla-ansible,Ib9afd84cac1fcbd96f98b4720ea9c6503bbdb124,1,1,0.8409,1.0986,0.0,1,4.33,473,0,Bug Fix,0,0,0,44,0.035172,0.0,0,0.0,4,1,0,0.699,0.0,4.0,-34.01,16.09,1,0,0.0,0,157.6667,0,8,0,21,0,"Fix issue with Swift Recon middleware

Follow-up on I343d8f45a78ebc3c11ed0c68fe8bec24f9ea7929

According the documentation [1] we forgot to share statistics data
for swift-account-server and swift-container-server. This change will
fix the issue.

1. https://docs.openstack.org/swift/latest/admin_guide.html#cluster-telemetry-and-monitoring

Closes-Bug: #1941611
[SEP]
FILES CHANGED:
ansible/roles/swift/tasks/start.yml (+2, -0)
",-1.180067,1.099293,-0.899095,-0.743372,-0.125941,-0.176758,0.533116,0.181168,0.429568,-0.04799,-0.102214,0.112812,0.208087,0.01468,0.192918
openstack/kolla-ansible,I9adf34747a22d7d5aef31fad3f68f7880e18f022,1,1,0.6667,2.3026,0.2222,2,6.67,200,0,Bug Fix,0,0,0,3,0.007194,0.5556,0,0.3704,4,2,0,0.6996,0.9911,3.0,1.26,18.67,1,0,0.0,1,20.0,0,6,0,10,0,"Fix prometheus.yml templating

This change fixes a bug in the prometheus.yml template which breaks
alertmanager configuration

Closes-Bug: 2076660
[SEP]
FILES CHANGED:
releasenotes/notes/prometheus-template-fix-b971aad477a8fdc9.yaml (+5, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+2, -2)
",0.39037,-0.408835,-0.341693,-0.2424,0.048307,0.078707,-0.623348,0.136205,0.049449,-0.12422,0.368356,-0.197071,-0.210101,-0.019291,0.432034
openstack/kolla-ansible,Ief90861b2c422e0e6c2dd9cb605c94e86c0f2ba1,1,0,0.45,3.9703,0.0,3,5.25,470,0,Bug Fix,0,0,0,20,0.055866,0.6667,0,0.3,4,3,0,0.7002,1.4521,3.0,-26.11,16.39,1,0,0.0,1,8.8679,0,0,0,0,0,"CI: validate prometheus configs

check if generated prometheus config is valid
via promtool.

This should help prevent bugs like:
https://bugs.launchpad.net/kolla-ansible/+bug/2076660

prior art: haproxy config validation:
https://review.opendev.org/c/openstack/kolla-ansible/+/922840

also add some basic documentation for the
`kolla-ansible validate-config` command.
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/config_validate.yml (+27, -0)
releasenotes/notes/validate_prometheus_config-45b4bd5e651e61cd.yaml (+9, -0)
doc/source/user/multinode.rst (+16, -0)
",-1.228677,0.997845,-0.546984,-0.223655,-0.780216,-0.594355,0.145632,0.155075,0.089092,-0.141742,-0.183188,-0.484872,0.243166,0.125948,0.057983
openstack/oslo.serialization,Ifbcf5a1b3d42516bdf73f7ca6b2a7338f3985283,1,1,1.0,2.8904,0.0,2,5.1,547,0,Bug Fix,0,0,0,1,0.055556,1.0,0,1.0,2,1,0,0.5,0.9975,1.5,12.55,14.59,1,1,0.5294,0,30.3889,0,6,0,13,0,"[jsonutils] Add handling of datetime.date format

Recent patch from keystone[1] do not work when
osprofiler is enabled as osprofiler does jsonutils.dumps
and datetime.date is not handled so it fails.
This patch adds the handling for it.

[1] https://review.opendev.org/c/openstack/keystone/+/924892

Needed-By: https://review.opendev.org/q/I1b71fb3881dc041db01083fbb4f2592400096a31
Related-Bug: #2074018
Closes-Bug: #2076430
(cherry picked from commit f6e879db55465e6d5f17f054ed2757cbfcfc43bc)
[SEP]
FILES CHANGED:
oslo_serialization/tests/test_jsonutils.py (+9, -0)
oslo_serialization/jsonutils.py (+8, -0)
",-3.552916,1.320287,1.395878,-2.181453,0.382167,0.12297,0.653181,0.048272,0.127978,0.014348,0.065063,-0.160253,0.086494,-0.223852,-0.105429
openstack/openstack-ansible,I16b5ad1efa1831348c70f0c332b7ba674f9e40c3,1,0,0.8529,1.0986,0.5,1,8.0,195,0,Feature,0,0,0,34,0.164251,1.0,0,0.8529,3,1,0,0.9348,0.0,3.0,47.14,13.2,0,0,0.0,0,65.0,0,0,0,0,0,"Remove extra slash character from horizon haproxy healthcheck url.

This would end up as //auth/login and can cause the healthcheck to
fail.
[SEP]
FILES CHANGED:
inventory/group_vars/horizon_all/haproxy_service.yml (+1, -1)
",1.146649,-0.905735,-0.290787,0.276258,0.076483,0.277572,0.352422,-0.831207,-0.20203,-0.294064,-0.153552,-0.042565,-0.018647,0.033269,-0.159488
openstack/kolla-ansible,Ib257f8342c392b78e02ae31588ce5c6f8943f5b8,1,0,0.25,0.6931,0.0,1,7.71,363,0,Bug Fix,1,0,0,4,0.015094,0.4444,0,0.1111,1,1,0,0.7008,0.0,1.0,54.87,9.75,1,0,1.0,0,181.5,0,0,0,0,0,"CI: Fix upgrade jobs failing on adding new certificates

There is a bug in current `tests/upgrade.sh`. If a
developer adds a new type of certificate i.e. for
RabbitMQ, it is not generated on upgrade because the
script does not run the `certificates` role.
This fix adds the `certificates` role to the script.
[SEP]
FILES CHANGED:
tests/upgrade.sh (+1, -0)
",0.063163,-0.133935,-0.213717,0.93972,-0.108142,0.283123,0.710088,-0.193866,0.219345,-0.034806,0.342316,-0.163016,-0.209698,0.089576,-0.22356
openstack/kolla-ansible,Id80e45357ea8054f2bacb8a7c687b335c74d5feb,0,0,0.7317,2.0794,0.2857,2,12.5,650,0,CI,0,0,0,41,0.013351,0.3333,0,0.2439,4,2,0,0.7014,0.5917,4.0,51.17,11.4,1,0,0.0,0,81.25,0,0,0,0,0,"Use more descriptive libvirt secret names corresponding to reality

This patch changes the name for libvirt secrets, as the user might not
necessarily use the 'nova' and 'cinder' usernames, but completely
different names. The names 'client.nova' and 'client.cinder' might
suggest to the user that they are templatable, but they are not.
In Kolla, there can only be one secret for the nova service and one
for cinder, regardless of how many clusters are being used.
Therefore, I use a name that does not resemble the Ceph keyring to
prevent this from happening. A description has also been added.
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/external_ceph.yml (+4, -2)
ansible/roles/nova-cell/templates/secret.xml.j2 (+1, -0)
",-1.605866,-0.754756,0.519215,0.957536,-0.11297,-0.203799,0.707183,-0.468154,-0.334875,0.320717,0.292822,0.056425,0.113457,-0.012161,-0.201546
openstack/charm-ceph-mon,Id9fd3c8bad504bfe7610de856798114f2b8c0fd3,1,1,1.0,2.8904,0.2941,2,13.33,375,0,Bug Fix,0,0,1,13,0.025391,1.0,0,1.0,1,2,0,0.9211,0.5226,0.5,36.79,15.33,0,0,0.0,0,20.8333,0,10,0,17,0,"Defer cos-prometheus for bootstrap

When the cluster is not yet bootstrapped, we need to defer the event of
enabling the prometheus module. This is the same logic as
I3d274c09522f9d7ef56bc66f68d8488150c125d8.

Closes-bug: #2074337
Related-bug: #2042891
(cherry picked from commit 8f59007236bae09cfaf1df38c650c4144ca84ee7)
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
src/ceph_metrics.py (+11, -4)
",-1.506717,-0.423497,-1.04548,-1.634791,0.948295,0.112212,0.924818,-0.044136,0.325862,0.238977,0.365153,0.06886,0.201561,-0.137405,0.19968
openstack/kolla,I0de9928b2657ab5f31580325e866bff28f2b5510,1,1,0.8351,3.3322,0.037,3,5.9,491,0,Bug Fix,0,0,0,97,0.02439,0.0,0,0.0,3,3,0,0.7177,1.3516,2.67,41.68,11.17,0,0,0.0,1,17.5357,0,8,0,12,0,"Pin OpenSearch Dashboards to 2.15

OpenSearch Dashboards 2.16.0 discover page hangs after initial
deployment due to an upstream bug [1].

This change fixes the issue by pinning OpenSearch Dashboards to 2.15.

Note that it seemed safer not to pin OpenSearch to fix this issue, to
avoid breaking deployments that have already deployed 2.16.

[1] https://github.com/opensearch-project/OpenSearch-Dashboards/issues/7626

Closes-Bug: #2077319
[SEP]
FILES CHANGED:
docker/opensearch/opensearch-dashboards/Dockerfile.j2 (+14, -1)
releasenotes/notes/bug-2077319-a47a06175a589a1a.yaml (+9, -0)
docker/opensearch/opensearch-dashboards/apt_preferences_opensearch_dashboards (+3, -0)
",-1.69932,0.485953,-0.224664,0.255406,-0.455874,0.247528,-0.30866,0.376984,-0.363908,0.838768,0.379102,-0.008724,0.146298,-0.082882,0.173526
openstack/kolla,Ieb52291529eb0d94206b3f30195c4d2527c9dc52,0,0,0.625,2.1972,0.875,2,7.5,128,0,Feature,0,0,0,160,0.015981,0.6,0,0.375,3,2,0,0.7189,0.9544,3.0,58.22,5.67,1,0,0.0,0,14.2222,0,0,0,0,0,"nova: Drop xen remnants

Xen support in Nova has been dropped cycles ago.
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+1, -2)
docker/nova/nova-libvirt/extend_start.sh (+0, -5)
",1.081834,-0.102666,-0.390463,0.180979,-0.321083,1.132175,-0.42453,0.067686,-0.977413,-0.073619,0.523964,0.401215,-0.131858,0.262106,-0.168327
openstack/kolla,I48251e0a96f22a3ca6e1cc2523b81e3e1aa1ae71,0,0,0.6211,1.9459,1.0,1,10.5,169,0,Feature,0,0,0,161,0.016068,0.5,0,0.3106,3,1,0,0.716,0.0,3.0,14.89,15.63,1,0,0.0,0,24.1429,0,0,0,0,0,"nova: drop dmidecode

It's basically noop since dmidecode is in libvirt deps
in all distributions for a long time.
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+0, -6)
",1.494012,-0.775522,-0.126731,-0.175654,0.036317,-0.027243,0.351607,-0.814634,-0.954279,-0.262934,0.104849,-0.148148,-0.456892,-0.04961,0.280772
openstack/octavia,Iae2b075de5412bb183db6a21f7f8376801853e00,1,1,0,4.3438,0.0921,4,15.5,290,0,Bug Fix,0,0,0,0,0.0,0.4118,0,0.0,6,2,0,0.6046,1.1781,4.25,0.07,21.68,1,0,0.75,1,3.7662,0,16,0,48,0,"Fix loadbalancer stuck in cascade delete

- Fix loadbalancer stuck in PENDING_DELETE in cascade delete
with TERMINATED_HTTPS listener if TLS storage not available

Closes-Bug: #2077348
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/flows/flow_utils.py (+6, -4)
octavia/tests/unit/controller/worker/v2/test_controller_worker.py (+56, -1)
octavia/controller/worker/v2/controller_worker.py (+2, -2)
releasenotes/notes/fix-loadbalancer-stuck-on-delete-da5950cf87fc8507.yaml (+5, -0)
",0.648299,-0.794635,-0.61712,-0.140231,0.39689,0.400549,-0.485599,0.169739,0.101271,-0.52642,0.415039,-0.380867,0.357693,-0.210973,0.340896
openstack/kolla-ansible,I41968a4dee0d2b571475c3da25fdd9807ac4cb4c,0,0,0.6173,4.1744,0.3125,11,5.67,254,0,Feature,0,0,0,162,0.016158,0.5,0,0.3086,4,2,0,0.7,3.0432,3.64,-87.55,18.74,1,0,0.0625,0,3.9077,0,0,0,0,0,"service-python-path: Introduce a role to get python_path of an image

Inspired by [1].

[1]: https://opendev.org/openstack/openstack-ansible-os_horizon/commit/3c20e3607ec1d4ad488c532df5d87ecb8f1e20ce
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/horizon.conf.j2 (+2, -4)
ansible/roles/service-python-path/tasks/main.yml (+21, -0)
ansible/roles/skyline/tasks/config.yml (+6, -0)
ansible/group_vars/all.yml (+0, -8)
ansible/roles/horizon/tasks/config.yml (+5, -0)
tests/templates/globals-default.j2 (+0, -4)
ansible/roles/ironic/templates/ironic-prometheus-exporter-wsgi.conf.j2 (+1, -2)
ansible/roles/skyline/templates/nginx.conf.j2 (+1, -1)
ansible/roles/ironic/tasks/config.yml (+5, -0)
ansible/roles/service-python-path/defaults/main.yml (+2, -0)
ansible/roles/skyline/templates/skyline-console.json.j2 (+1, -1)
",-1.029618,1.887618,-2.038232,-0.529742,0.320921,-0.486445,1.091586,0.190364,0.872985,0.163178,-0.663808,-0.106824,0.137919,-0.127777,0.027267
openstack/ironic,Icf0d9b5781edd193b2313441e8586b745574edbb,1,0,1.0,3.8286,0.0444,5,7.0,251,0,CI,0,0,0,5,0.098039,1.0,0,1.0,5,3,0,0.9573,1.8921,3.6,12.4,17.09,0,0,0.5333,1,5.4565,0,0,0,0,0,"Update network_data.json to include dns nameservers

This patch updates network_data to include dns nameservers. This
is especially important when booting virtual media in a dhcp-less
environment.
[SEP]
FILES CHANGED:
ironic/tests/unit/common/json_samples/neutron_subnet_show.json (+1, -1)
ironic/tests/unit/common/test_neutron.py (+20, -0)
releasenotes/notes/fix-network-data-dns-nameservers-f363b3a66c109b4d.yaml (+9, -0)
ironic/tests/unit/common/json_samples/neutron_subnet_show_ipv6.json (+1, -1)
ironic/common/neutron.py (+12, -0)
",-0.148445,0.096306,-0.798127,1.355696,1.005661,-0.093024,-0.027346,-0.118962,-0.009508,-0.322264,-0.108111,-0.07033,-0.135299,-0.330554,-0.136992
openstack/oslo.messaging,Ide5eb73164632c4e7be8582ba7bc2acde8287c78,1,0,1.0,2.3979,0.5,2,8.8,344,0,Bug Fix,0,0,0,3,0.3,1.0,0,1.0,2,1,0,0.6207,0.7219,2.0,30.63,10.79,0,0,0.0,0,31.2727,0,0,0,0,0,"Reduce log level to DEBUG for new messages

The change [1] introduced new logging that
uses INFO loglevel instead of DEBUG with
messages that doesn't help and instead
when there is a lot of messages fills
up the log file.

[1] https://review.opendev.org/c/openstack/oslo.messaging/+/889425
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/amqpdriver.py (+4, -4)
oslo_messaging/_drivers/impl_rabbit.py (+1, -1)
",-0.663989,-0.038829,-0.162164,0.222006,-0.996036,-0.25645,0.365014,-0.138635,0.095374,0.415036,-0.367777,-0.585899,-0.00463,-0.056626,0.038762
openstack/oslo.serialization,Ifbcf5a1b3d42516bdf73f7ca6b2a7338f3985283,1,1,0,2.8904,0.0,2,5.6,616,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,0.6667,0.9975,1.5,13.82,14.38,1,1,0.5294,0,34.2222,0,6,0,13,0,"[jsonutils] Add handling of datetime.date format

Recent patch from keystone[1] do not work when
osprofiler is enabled as osprofiler does jsonutils.dumps
and datetime.date is not handled so it fails.
This patch adds the handling for it.

[1] https://review.opendev.org/c/openstack/keystone/+/924892

Needed-By: https://review.opendev.org/q/I1b71fb3881dc041db01083fbb4f2592400096a31
Related-Bug: #2074018
Closes-Bug: #2076430
(cherry picked from commit f6e879db55465e6d5f17f054ed2757cbfcfc43bc)
(cherry picked from commit b7c9063a9bff428bbfd13ebd2d94040254f3d3ab)
[SEP]
FILES CHANGED:
oslo_serialization/tests/test_jsonutils.py (+9, -0)
oslo_serialization/jsonutils.py (+8, -0)
",-3.552916,1.320287,1.395878,-2.181453,0.382167,0.12297,0.653181,0.048272,0.127978,0.014348,0.065063,-0.160253,0.086494,-0.223852,-0.105429
openstack/kolla,I891749598247a5e951ed4a873b16acfd0566f59c,0,0,0.7143,4.3175,0.5135,9,13.0,452,0,Doc,0,0,0,42,0.013645,0.7143,0,0.5102,3,4,0,0.7131,2.3626,2.11,-4.84,20.58,1,0,0.2432,1,6.0267,0,0,0,0,0,"Switch to Dynamic Python Version Detection

This commit removes the hardcoded KOLLA_DISTRO_PYTHON_VERSION
and replaces it with dynamic Python version detection during
container images build. Dockerfiles and scripts now use general
python3 references, simplifying maintenance and ensuring
compatibility with future Python versions.

Test cases relying on distro_python_version were also cleaned up.
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+1, -1)
docker/openstack-base/Dockerfile.j2 (+3, -1)
docker/skyline/skyline-apiserver/extend_start.sh (+1, -1)
kolla/image/kolla_worker.py (+0, -8)
docker/base/Dockerfile.j2 (+0, -1)
docker/horizon/extend_start.sh (+1, -1)
docker/kolla-toolbox/Dockerfile.j2 (+25, -7)
releasenotes/notes/remove-kolla-base-distro-d0376ae3aafffcc3.yaml (+5, -0)
kolla/tests/test_build.py (+0, -18)
",-0.944646,-1.277124,-0.632149,0.738678,0.449535,0.107496,-0.478591,0.735053,-0.160797,0.250486,0.013845,0.005112,-0.201575,-0.31591,0.06128
openstack/kolla-ansible,I85431b058b4184d96600cf17aaf8de871a018d61,0,0,0.6977,2.8904,0.7059,3,12.17,671,0,CI,0,0,0,43,0.013642,0.4133,0,0.2884,2,3,0,0.6986,1.4681,2.0,-12.96,21.85,1,0,0.2353,1,37.2778,0,0,0,0,0,"Standardize python version paths

This patch removes the hardcoded `distro_python_version`
mapping and usage from the configuration and templates,
aligning with the dynamic Python version detection
introduced in the dependent patch below.

The changes simplify the kolla-ansible roles by using
general `python3` paths, ensuring compatibility across
distributions without requiring version-specific handling.

Template files for Horizon, Ironic, Skyline, and others
have been updated to reflect this,
improving maintainability and reducing complexity.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/926744
[SEP]
FILES CHANGED:
releasenotes/notes/standarize-python-version-paths-dec41acd66446168.yaml (+4, -0)
ansible/group_vars/all.yml (+1, -8)
tests/templates/globals-default.j2 (+0, -4)
",-1.805895,-0.410028,0.537765,0.175801,-0.167043,0.096274,-0.381502,0.33129,0.121856,-0.099985,-0.404415,0.297053,-0.102394,-0.348568,-0.060978
openstack/kolla-ansible,I9d78d149fc41ac6286342cc6af892cd537d50fb5,0,0,0.6135,1.3863,0.3333,1,10.0,111,0,Doc,0,0,0,163,0.016155,0.0,0,0.0,2,1,0,0.6973,0.0,2.0,10.56,20.0,0,0,0.0,0,27.75,0,0,0,0,0,"kolla_toolbox: Add handling for bytes literals in docker
[SEP]
FILES CHANGED:
ansible/library/kolla_toolbox.py (+2, -1)
",1.762955,0.498674,0.998353,-0.398955,0.339399,-0.413787,-0.732752,-0.103928,0.075883,-0.109177,-0.204213,-0.426227,0.017076,-0.891398,0.239644
openstack/kolla,I5120f1874f25a9ca8326e6db8b12dee4c81feb56,0,0,0.4545,4.1271,0.3279,1,9.4,1503,0,CI,0,0,0,11,0.002011,0.0,0,0.0,2,1,0,0.7103,0.0,2.0,21.34,12.48,1,0,0.0,0,24.2419,0,0,0,0,0,"Change copy-cacerts behaviour

So far, the certificates were not part of config.json
files for containers. With future patches that will remove
container restarts based on triggers from config and
service-copy-cert, it is important that all files that change
during config are specified in config.json so that
kolla-set-configs --check can detect those changes and based
on that restart the container. This patch provides prerequisite
for future patch in kolla-ansible.

Comments from kevko:

The script also takes into account whether review [1] is
merged or not, ensuring that it will function correctly in
both cases thanks to review [2], because using the state
file, we can effectively verify whether the config.json that
copies CA certs to /var/lib/kolla/share is being used or not.

If we didn‚Äôt handle it this way, we would have to rely on
checking whether the directory /var/lib/kolla/share exists or
some another magic, which is insufficient because various
states and combinations of Kolla image and Kolla-Ansible
versions could result in certificates always being copied.
This method provides a clear and definitive distinction.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/924651
[2] https://review.opendev.org/c/openstack/kolla/+/915440

Co-Authored-By: Michal Arbet <michal.arbet@ultimum.io>
Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/924651
[SEP]
FILES CHANGED:
docker/base/copy_cacerts.sh (+41, -20)
",-3.347476,2.184226,3.508629,-0.558547,-0.635153,0.333068,-0.241971,-0.628398,-0.53183,-0.269593,-0.521761,0.341947,0.070554,0.112494,0.023008
openstack/kolla,I097ad8988a4707173c19006d83b4d76cec5d0940,1,1,1.0,2.1972,0.0,2,10.0,120,0,Bug Fix,0,0,0,2,0.074074,0.0,0,0.0,3,2,0,0.7075,1.0,2.5,-23.27,24.0,1,0,0.0,1,13.3333,0,14,0,12,0,"Add missing iso packages to ironic-conductor

Closes-Bug: #2067133
[SEP]
FILES CHANGED:
releasenotes/notes/ironic-packages-009b388b10fab6f0.yaml (+4, -0)
docker/ironic/ironic-conductor/Dockerfile.j2 (+4, -0)
",1.491622,-0.009745,-0.854248,-0.984096,-0.373718,0.515038,-0.952235,0.364941,0.001738,-0.623964,0.389822,0.022798,0.256941,0.025919,0.264921
openstack/kolla,Ifb41c0c48c4743e70e95fa7e1d329e91362e966c,0,0,0.6098,3.4657,0.4194,5,4.54,653,0,Feature,0,0,0,164,0.016249,0.6154,0,0.3752,2,3,0,0.7087,2.0084,2.0,-2.82,12.66,1,0,0.0,1,20.4062,0,0,0,0,0,"mariadb: Bump to 11.4

11.4 is the next LTS release (see [1])

New variable ``VERIFY_DB_SERVER_CERT`` is added to mitigate the MariaDB
client variable ``ssl-verify-server-cert`` change from ``FALSE`` to
``TRUE``. [2]
This variable can be overidden by assigning ``TRUE`` to environment
variable with the same name.

[1]: https://mariadb.org/11-4-lts/
[2]: https://jira.mariadb.org/browse/MDEV-31857

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/928487
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/958281
[SEP]
FILES CHANGED:
docker/mariadb-server/extend_start.sh (+7, -7)
docker/mariadb-server/backup_replica.sh (+2, -1)
releasenotes/notes/mariadb-11.4-b66b5baf9f5e6cd0.yaml (+5, -0)
kolla/template/repos.yaml (+3, -4)
docker/mariadb-server/Dockerfile.j2 (+1, -1)
",-3.279886,4.075657,0.979282,0.154143,-0.347218,0.451551,0.194692,-0.072745,0.200331,-0.17419,0.200039,-0.074516,-0.175274,-0.083584,0.032561
openstack/kolla,Ia1142a5d67009c28ab820652785deb45263a548b,0,0,0.6061,1.0986,0.5,1,11.0,227,0,Feature,0,1,0,165,0.016298,0.4,0,0.2424,2,1,0,0.7059,0.0,2.0,34.16,13.49,0,0,0.0,0,75.6667,0,0,0,0,0,"Revert ""[release] Change RDO's DELOREAN_DEPS repo to Caracal""

This reverts commit 8102d0278255bcc42129d1f51bc78284e110f178.

Reason for revert: Let's switch back to master
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",-0.60236,-0.602311,-2.183666,-1.484403,0.725083,0.643022,-0.110928,-0.149135,-0.322522,0.06769,0.182207,0.233309,-0.16847,-0.078256,-0.655912
openstack/charm-ceph-radosgw,I4a8076192269aaeaca50668ebcebc0a52c6d2c84,1,0,1.0,7.2998,0.0034,21,9.55,978,0,Doc,0,0,0,3,0.038961,1.0,0,1.0,2,5,0,0.9375,3.2883,1.05,-5.09,15.63,1,0,0.4726,1,0.6608,0,0,0,0,0,"Add group policy configuration

Allow configuration of a zone group default sync policy. This is useful
in scenarios where we want to have selective buckets sync. Valuable
especially with the new `cloud-sync` relation.

This is based on Ceph multisite sync policy:
https://docs.ceph.com/en/latest/radosgw/multisite-sync-policy/

Additionally, three more Juju actions are added to selectively enable,
disable, or reset buckets sync:
* `enable-buckets-sync`
* `disable-buckets-sync`
* `reset-buckets-sync`

These new actions are meant to be used in conjunction with a default
zone group sync policy that allows syncing, but it's disabled by default.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1193
(cherry picked from commit 4e608c14859c3d151254fcb8209dee59917ad7bc)
[SEP]
FILES CHANGED:
hooks/hooks.py (+91, -0)
hooks/utils.py (+47, -0)
unit_tests/testdata/test_create_sync_group_flow.json (+20, -0)
unit_tests/testdata/test_list_sync_groups.json (+45, -0)
unit_tests/test_ceph_radosgw_utils.py (+19, -3)
unit_tests/test_multisite.py (+230, -0)
config.yaml (+28, -0)
hooks/multisite.py (+401, -0)
README.md (+3, -0)
unit_tests/testdata/test_get_sync_group.json (+45, -0)
unit_tests/test_ceph_radosgw_context.py (+6, -1)
actions/actions.py (+178, -0)
actions/reset-buckets-sync (+1, -0)
unit_tests/test_hooks.py (+105, -0)
actions/enable-buckets-sync (+1, -0)
unit_tests/test_actions.py (+176, -0)
hooks/primary-relation-changed (+1, -0)
unit_tests/testdata/test_create_sync_group_pipe.json (+49, -0)
actions/disable-buckets-sync (+1, -0)
hooks/install_deps (+1, -1)
actions.yaml (+26, -0)
",-3.447851,1.440395,1.86075,-0.524657,0.152781,-0.224468,-0.080287,0.086432,0.11182,-0.316088,-0.3912,0.20525,0.407656,0.075693,-0.044421
openstack/charm-ceph-radosgw,I4a8076192269aaeaca50668ebcebc0a52c6d2c84,1,0,1.0,7.2499,0.0021,19,11.22,919,0,Doc,0,0,0,4,0.002571,1.0,0,1.0,2,5,0,0.9412,3.1117,1.05,-2.23,15.97,1,0,0.4805,1,0.6527,0,0,0,0,0,"Add group policy configuration

Allow configuration of a zone group default sync policy. This is useful
in scenarios where we want to have selective buckets sync. Valuable
especially with the new `cloud-sync` relation.

This is based on Ceph multisite sync policy:
https://docs.ceph.com/en/latest/radosgw/multisite-sync-policy/

Additionally, three more Juju actions are added to selectively enable,
disable, or reset buckets sync:
* `enable-buckets-sync`
* `disable-buckets-sync`
* `reset-buckets-sync`

These new actions are meant to be used in conjunction with a default
zone group sync policy that allows syncing, but it's disabled by default.

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1269
(cherry picked from commit 4e608c14859c3d151254fcb8209dee59917ad7bc)
[SEP]
FILES CHANGED:
hooks/hooks.py (+91, -0)
unit_tests/testdata/test_create_sync_group_flow.json (+20, -0)
unit_tests/testdata/test_list_sync_groups.json (+45, -0)
unit_tests/test_ceph_radosgw_utils.py (+3, -3)
unit_tests/test_multisite.py (+230, -0)
config.yaml (+28, -0)
hooks/multisite.py (+401, -0)
README.md (+3, -0)
unit_tests/testdata/test_get_sync_group.json (+45, -0)
unit_tests/test_ceph_radosgw_context.py (+1, -0)
actions/actions.py (+178, -0)
actions/reset-buckets-sync (+1, -0)
unit_tests/test_hooks.py (+105, -0)
actions/enable-buckets-sync (+1, -0)
unit_tests/test_actions.py (+175, -0)
hooks/primary-relation-changed (+1, -0)
unit_tests/testdata/test_create_sync_group_pipe.json (+49, -0)
actions/disable-buckets-sync (+1, -0)
actions.yaml (+26, -0)
",-3.447851,1.440395,1.86075,-0.524657,0.152781,-0.224468,-0.080287,0.086432,0.11182,-0.316088,-0.3912,0.20525,0.407656,0.075693,-0.044421
openstack/kolla,I66421b14668722607b58865a2ad100204fd387f7,0,0,0.64,3.6636,0.7895,4,8.67,537,0,Doc,0,0,0,25,0.075529,1.0,0,0.64,3,3,0,0.7031,1.6182,2.25,-19.97,18.85,1,0,0.0,1,13.7692,0,0,0,0,0,"Drop prometheus-msteams container images

The prometheus-msteams project is no longer maintained [1]. As a result
we are removing its associated container images from our repository.
Users are encouraged to switch to the native Prometheus Alertmanager
integration with Microsoft Teams [2], which offers ongoing support and
features.

[1] https://github.com/prometheus-msteams/prometheus-msteams/issues/343
[2] https://prometheus.io/docs/alerting/latest/configuration/#msteams_config
[SEP]
FILES CHANGED:
releasenotes/notes/drop-prometheus-msteams-1ead141af684ada1.yaml (+8, -0)
kolla/image/unbuildable.py (+0, -1)
docker/prometheus/prometheus-msteams/Dockerfile.j2 (+0, -19)
kolla/common/sources.py (+0, -10)
",-1.577385,1.871108,-0.498979,1.015126,-0.291165,-0.126796,0.596745,0.651689,-0.061382,0.204679,0.345362,0.281146,-0.158348,-0.339458,-0.133903
openstack/kolla-ansible,I93d28ef138b4e784465f3a7eaa11101ea5877050,0,0,0.6154,4.9488,0.95,13,7.33,494,0,Doc,0,0,0,26,0.070461,0.6429,0,0.3956,4,4,0,0.6959,3.1805,3.08,-27.49,15.66,1,0,0.0214,1,3.5035,0,0,0,0,0,"Drop prometheus-msteams support

The prometheus-msteams project is no longer maintained [1]. As a result
support for deploying prometheus-msteams via kolla-ansible has been
dropped. Users are encouraged to migrate to the native Prometheus
Alertmanager integration with Microsoft Teams [2].

[1] https://github.com/prometheus-msteams/prometheus-msteams/issues/343
[2] https://prometheus.io/docs/alerting/latest/configuration/#msteams_config
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -3)
ansible/roles/prometheus/templates/prometheus-alertmanager.yml.j2 (+0, -10)
ansible/inventory/all-in-one (+0, -3)
ansible/roles/prometheus/templates/prometheus-msteams.yml.j2 (+0, -2)
ansible/roles/prometheus/tasks/config.yml (+0, -30)
ansible/group_vars/all.yml (+0, -5)
ansible/roles/prometheus/templates/prometheus-msteams.json.j2 (+0, -24)
releasenotes/notes/drop-prometheus-msteams-9f8a90f4f03745c6.yaml (+7, -0)
ansible/roles/prometheus/defaults/main.yml (+0, -21)
ansible/roles/prometheus/tasks/precheck.yml (+0, -15)
tests/templates/inventory.j2 (+0, -3)
etc/kolla/globals.yml (+0, -1)
ansible/roles/prometheus/handlers/main.yml (+0, -16)
",-2.063606,2.524116,-0.790232,1.06679,-0.047462,-0.20919,0.3924,0.59365,-0.158194,0.170936,0.633755,0.301999,-0.259764,-0.38942,0.068351
openstack/kolla-ansible,I7e30ee5754ca2ecf9d4a2d3519f9e0bdf3f0aeea,1,1,0,2.7081,0.0714,1,10.0,321,0,Bug Fix,0,0,0,0,0.0,0.6,0,0.0,2,1,0,0.6946,0.0,2.0,31.72,13.0,0,0,0.0,0,21.4,0,8,0,19,0,"Fix links in docs for unmaintained releases

Links in docs for unmaintained branches (Yoga and Zed) are still
pointing to stable/<release> branches in repository. Instead they
should point to unmaintained/<release>. This patch aims to fix that.

Closes-Bug: #2066052
[SEP]
FILES CHANGED:
doc/source/conf.py (+13, -1)
",-1.11803,0.576444,-1.243666,0.823101,0.389642,0.504546,-0.265881,-0.569307,-0.474592,0.171307,0.294352,-0.032573,0.698441,-0.070512,-0.119341
openstack/ironic,Ib3b285ff63c5ab10239954f68080f4ceb5292f1d,1,0,1.0,1.0986,0.5,1,9.0,100,0,Bug Fix,0,0,0,2,0.044444,1.0,0,1.0,2,1,0,0.9576,0.0,2.0,19.1,16.93,1,1,0.0,0,33.3333,0,0,0,0,0,"[Trivial] Fix typo of exception error message
[SEP]
FILES CHANGED:
ironic/common/exception.py (+1, -1)
",1.081893,1.711626,0.632907,0.559534,0.536728,1.19471,-0.201271,-0.219219,0.355278,0.522391,0.923402,-0.047009,0.390352,-0.246269,-0.566488
openstack/kolla-ansible,I6a3ac49f20d0a74198adc868c2a2260f7a6d5cfc,1,0,0.6024,2.7081,0.5,6,9.33,236,0,CI,0,0,0,166,0.016393,1.0,0,0.6024,4,2,0,0.6951,2.5216,4.0,31.18,12.3,1,0,0.0,0,15.7333,0,0,0,0,0,"mariadb: switch to use mariadb flavored commands

MariaDB 11.4 does not include mysql* commands, so let's switch
to mariadb* equivalents, especially that mysql* ones are deprecated.
[SEP]
FILES CHANGED:
ansible/roles/mariadb/handlers/main.yml (+1, -1)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+1, -1)
ansible/roles/mariadb/tasks/recover_cluster.yml (+2, -2)
ansible/roles/mariadb/templates/mariadb.json.j2 (+1, -1)
ansible/roles/mariadb/tasks/check.yml (+1, -1)
ansible/roles/mariadb/tasks/restart_services.yml (+1, -1)
",0.321604,0.102109,-0.692906,0.66763,0.55173,-0.226374,0.422286,-0.239549,-1.011438,0.52114,0.329636,0.176467,-0.185197,-0.516774,0.017919
openstack/kolla-ansible,I75b10803815e3c76675eb115857a7e48212df32a,0,0,0.6048,3.9318,0.0,3,8.0,357,0,Feature,0,0,0,167,0.016469,0.75,0,0.4536,4,2,0,0.6957,0.6396,4.0,-12.78,15.7,1,0,0.0,0,7.0,0,0,0,0,0,"mariadb: Disable wsrep_provider plugin

Since [1] wsrep_provider_options are not dynamic and we use that
capability in Galera cluster bootstrap.

This change also adds mariadb_server container image label
handling.

[1]: https://github.com/MariaDB/server/commit/79d0194eef314271d1694540267180ef91bc9a87
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+4, -0)
ansible/roles/mariadb/tasks/config.yml (+2, -0)
ansible/roles/mariadb/tasks/config_labels.yml (+44, -0)
",-1.098482,0.373466,-0.675943,-0.543049,0.486979,-0.262433,0.385478,0.467147,0.314648,0.224225,-0.052408,-0.529238,-0.136398,-0.411056,-0.077414
openstack/kolla,I7f0f723b37e552c4ea01bf51b6354209608d904a,1,0,0.6012,2.3026,1.0,3,27.0,360,0,CI,1,0,0,168,0.016487,0.875,0,0.526,1,1,0,0.7004,1.585,1.0,38.43,18.95,0,0,1.0,0,36.0,0,0,0,0,0,"CI: Disable CentOS/Rocky/Ubuntu aarch64 jobs

Since Linaro shut down their nodepool provider - OpenDev infra
is left with OSUOSL cloud with max 15 instances running - let's
not put any additional strain on CI (especially that it seems
there are some I/O or similar issues that cause our jobs to
time out).
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+0, -3)
.zuul.d/ubuntu.yaml (+0, -3)
.zuul.d/rocky.yaml (+0, -3)
",-0.029492,-2.108281,-0.08372,-0.217292,-0.375872,-0.425209,0.101153,-0.03248,-1.105639,0.102826,-0.084563,-0.293584,0.513046,-0.244815,0.100973
openstack/kolla,I876f3c88c5bcd3c0a7c776796e9870c8512f90e2,0,0,0.5926,1.6094,1.0,1,6.83,335,0,CI,0,0,0,27,0.053045,0.0,0,0.0,5,1,0,0.7016,0.0,5.0,28.64,11.51,0,0,0.0,1,67.0,0,0,0,0,0,"Remove incorrect reno

The cAdvisor update change [1] mistakenly added a reno to the wrong
folder. Moving it back to the correct folder would accidentally add it
to the master branch. Therefore, the reno is being removed.

[1] https://review.opendev.org/c/openstack/kolla/+/704018
[SEP]
FILES CHANGED:
docker/prometheus/prometheus-cadvisor/releasenotes/notes/upgrade-cadvisor-13704412132e390b.yaml (+0, -4)
",-0.586399,0.738628,-0.630328,0.436712,-1.149723,0.437499,0.708373,-0.258444,0.165544,0.05614,0.261268,-0.170908,-0.22046,0.328058,-0.39585
openstack/openstack-ansible-os_skyline,I7e7c7053cce96d774199f37c7255e70c49e2969a,1,1,0.9516,3.1355,0.0,3,22.5,599,0,Bug Fix,0,0,0,186,0.053819,1.0,0,0.9516,1,2,0,1.0,1.342,1.0,39.24,17.44,0,0,0.0,0,26.0435,0,6,0,9,0,"Enable SSLProxyProtocol for internal backends behind TLS

In cases when internal backends are covered with TLS
(ie
`haproxy_ssl_all_vips` is set to True), Apache will fail to ProxyPass
traffic if it needs to be encrypted. For that, SSL module should be
installed and enabled as well as SSLProxyEngine should be turned on.

We also introduce SSL protocol and cipher variables which will be used
in the future to cover connection between HAProxy and Apache in the
future, while now service the same purpose for the TLS proxy.

Closes-Bug: #2077904
[SEP]
FILES CHANGED:
vars/redhat.yml (+2, -0)
templates/skyline.vhost.j2 (+11, -0)
defaults/main.yml (+9, -0)
",-0.82581,-1.88851,0.795864,-0.062524,-0.208837,-0.183713,-0.00385,0.473455,0.019209,-0.045429,0.005128,-0.225466,-0.054201,-0.682178,0.006814
openstack/openstack-ansible-os_octavia,I67f934d0543311d5977c997d8324374fc2b604cf,1,0,0.9519,1.0986,0.5,1,12.5,238,0,Feature,0,0,0,187,0.053767,1.0,0,0.9519,1,1,0,0.8,0.0,1.0,8.03,16.2,0,0,0.0,0,79.3333,0,0,0,0,0,"Remove superfluous quote from enabled_provider_agents

At the moment we do have an extra quote for enabled_provider_agents
defenition which prevents variable from properly renderring.
[SEP]
FILES CHANGED:
templates/octavia.conf.j2 (+1, -1)
",-0.018405,-1.386134,-0.777903,0.437289,1.065245,0.128374,-0.82819,-0.718345,-0.146838,-0.279536,-0.232424,-0.037962,-0.729271,-0.275084,-0.032082
openstack/kolla,I93ac9c28332644f51fa350d5a7a6207ae822e4cf,0,0,0.6036,1.7918,0.2,1,5.5,145,0,Feature,0,0,0,169,0.01657,0.0,0,0.0,2,1,0,0.6988,0.0,2.0,-60.24,24.02,0,0,0.0,0,24.1667,0,0,0,0,0,"mariadb: Sync packages across distros
[SEP]
FILES CHANGED:
docker/mariadb-server/Dockerfile.j2 (+4, -1)
",2.44407,1.373317,1.088321,-0.058051,0.768707,0.170641,-0.002272,0.364428,-0.68125,0.19749,-0.031172,-0.029307,-0.211885,-0.452403,-0.355688
openstack/openstack-ansible-os_octavia,I82b4cd6749f42220be799c3a3e0d6bc14255125f,1,0,0.9521,2.3026,0.3333,2,20.5,508,0,Feature,0,0,0,188,0.054023,1.0,0,0.9521,1,2,0,0.8333,0.9911,1.0,45.72,16.0,0,0,0.0,0,50.8,0,0,0,0,0,"Define ovn provider agent when OVN is used

Defining OVN provider agent is required for the OVN driver as it is
responsible for connection to NB DB and listens to the events in it.

Without the any provider being enabled octavia-driver-agent service is
not doing anything. Moreover, assinged FIP to the LB VIP will not be
working properly, as that needs update to the LB inside of OVN, which
is performed only when agent detects changes to the VIP port.
[SEP]
FILES CHANGED:
templates/octavia.conf.j2 (+3, -2)
defaults/main.yml (+3, -1)
",-1.017292,-2.04807,0.510518,0.969382,-0.022393,-0.477956,0.492466,0.468188,0.03792,-0.171735,0.140836,0.221196,0.110405,0.083577,-0.209369
openstack/kolla,Ic0f9521c66240f13ff5b7fc94480dbbb76498339,0,0,0.85,2.0794,0.8571,2,6.0,324,0,Feature,0,1,0,20,0.025608,1.0,0,0.85,2,2,0,0.6962,0.8631,2.0,-21.33,10.73,1,0,0.0,0,40.5,0,0,0,0,0,"Revert ""Add support for checking incoming RabbitMQ version""

This reverts commit 36a7cd053d5b13ecc9fad1866f244a733fdd58e5.

Reason for revert: feature not needed anymore, see here:
https://review.opendev.org/c/openstack/kolla-ansible/+/926146/comment/e593d721_7c48143b/
[SEP]
FILES CHANGED:
docker/rabbitmq/extend_start.sh (+0, -5)
docker/rabbitmq/Dockerfile.j2 (+1, -1)
",-0.544654,1.567899,-1.781073,-1.432954,-0.195712,0.245604,1.735534,-0.007921,0.485948,-0.026501,0.137291,-0.339011,0.033796,-0.152255,0.006789
openstack/ironic,I5c42accf5e020ad3ecf652bcabdb8b8521f95907,1,0,1.0,1.0986,0.5,1,8.5,140,0,Bug Fix,0,0,0,4,0.008147,0.0,0,0.0,2,1,0,0.958,0.0,2.0,48.91,8.11,0,0,0.0,1,46.6667,0,0,0,0,0,"Use the correct command to fetch ovs state

Typo fix: s/osv/ovs/ in the command name.
[SEP]
FILES CHANGED:
playbooks/ci-workarounds/get_extra_logging.yaml (+1, -1)
",1.794406,-0.057288,-0.185858,0.481287,-0.057265,-0.32186,0.783424,-0.120368,-0.198012,-0.731796,0.217432,-0.376912,-0.374432,0.288703,-0.104425
openstack/kolla,I51c69d0673280e351daa410d943f769d33a10d6c,1,1,0.6,2.3979,0.1,1,12.67,309,0,Bug Fix,0,0,0,170,0.01666,0.0,0,0.0,3,1,0,0.6935,0.0,3.0,29.23,16.65,0,0,0.0,0,28.0909,0,6,0,13,0,"keystone: Fix requests-kerberos installation

Since it was bundled with plugins installation, and we did not
have any plugins in keystone container - it was not installed
at all.

Adding in libkrb5 dependencies for requests-kerberos.

Closes-Bug: #2078305
[SEP]
FILES CHANGED:
docker/keystone/keystone/Dockerfile.j2 (+9, -1)
",0.859843,-1.177257,-0.158236,-0.22563,-0.667748,-0.394998,0.080168,0.18152,-0.556004,-0.222877,0.10021,0.063897,0.10779,0.186916,0.439309
openstack/kolla-ansible,I7c72faecbdb66c7fd196acd3e7b2351851983490,0,0,0.5714,1.0986,0.5,1,4.83,372,0,Feature,0,0,0,28,0.054581,1.0,0,0.5714,6,1,0,0.6944,0.0,6.0,-40.2,11.59,0,0,0.0,0,124.0,0,0,0,0,0,"Add fluentd_enable_watch_timer to Let‚Äôs Encrypt

When merging change [1], fluentd_enable_watch_timer was
unintentionally missed in Let‚Äôs Encrypt, as change [2] had been
merged earlier.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/785309
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/899895
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/input/11-letsencrypt.conf.j2 (+1, -1)
",-2.421161,4.006418,-0.869623,0.937014,-0.186798,0.359208,0.294439,-0.609556,-0.207614,0.070592,0.591656,-0.182269,-0.072049,-0.321897,0.012595
openstack/kolla-ansible,Idb8a8d2e560206f7697c0771c9ae3913268fa6dd,0,1,0.4762,4.9698,0.007,30,5.0,635,0,Bug Fix,0,0,0,21,0.05122,0.6667,0,0.3175,4,4,0,0.6931,4.3534,3.77,-13.59,14.36,1,0,0.2168,1,4.4097,0,10,0,9,0,"Rabbitmq: enable quorum for transient queues

This helps to improve the reliability of openstack services when
a rabbitmq node has issues.

See also: https://bugs.launchpad.net/oslo.messaging/+bug/2031497

Adjust the upgrade tests similar to what was done
during the introduction of quorum queues in I6c033d460a5c9b93c346e9e47e93b159d3c27830

Closes-Bug: #2078339
Partial-Bug: #2077448
Depends-On: https://review.opendev.org/c/openstack/oslo.messaging/+/888479
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/924623
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+3, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+3, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+3, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+3, -0)
ansible/roles/heat/templates/heat.conf.j2 (+3, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+3, -0)
ansible/roles/designate/templates/designate.conf.j2 (+3, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+3, -0)
ansible/roles/nova/templates/nova.conf.j2 (+3, -0)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+3, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+3, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+3, -0)
tests/upgrade.sh (+31, -0)
ansible/roles/zun/templates/zun.conf.j2 (+3, -0)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+3, -0)
releasenotes/notes/enable_quorum_queues_transient-020b373831acda36.yaml (+12, -0)
ansible/roles/watcher/templates/watcher.conf.j2 (+3, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+3, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+3, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+3, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+3, -0)
ansible/roles/trove/templates/trove.conf.j2 (+3, -0)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+3, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+3, -0)
ansible/group_vars/all.yml (+5, -0)
ansible/roles/manila/templates/manila.conf.j2 (+3, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+3, -0)
ansible/roles/rabbitmq/tasks/precheck.yml (+16, -1)
",-3.453894,2.04762,0.369229,-0.981672,-0.15647,0.127688,-0.020232,0.015957,-0.008766,-0.121252,-0.15235,-0.127454,0.221,-0.168396,0.367888
openstack/kolla-ansible,I43ca7d782bdcc53dcbc59dcf82ac1daa48e85ad5,1,1,0.4545,1.0986,0.5,1,9.75,356,0,Bug Fix,1,0,0,22,0.039783,0.4545,0,0.2066,1,1,0,0.6917,0.0,1.0,16.89,16.21,1,0,1.0,0,118.6667,0,6,0,6,0,"CI: also redirect stderr during cert generation

When cert generation during upgrade was fixed
it was omitted to also redirect stderr to the log file.

This commit fixes that.

Introduced-By: Ib257f8342c392b78e02ae31588ce5c6f8943f5b8
Closes-Bug: #2078364
[SEP]
FILES CHANGED:
tests/upgrade.sh (+1, -1)
",-0.335559,-0.576712,-1.247692,-1.164706,0.400294,0.373415,0.427814,-0.36803,0.396215,0.386617,-0.066528,-0.250626,0.303449,0.160959,0.263439
openstack/openstack-ansible-os_ceilometer,If85c163dde83475f7126b0ecdeebebcfd0720a0a,1,0,1.0,3.3322,0.0,3,12.0,210,0,Feature,0,0,0,49,0.063885,1.0,0,1.0,2,3,0,1.0,1.3801,1.33,0.78,16.47,0,0,0.0,1,7.5,0,0,0,0,0,"Add support for Magnum notifications

Ceilometer is currently missing configuration for Magnum
which can result in unconsumed queues if Magnum is deployed.
[SEP]
FILES CHANGED:
releasenotes/notes/add-magnum-integration-a7a21c4feae9cbeb.yaml (+6, -0)
templates/ceilometer.conf.j2 (+5, -0)
defaults/main.yml (+16, -0)
",0.831087,-1.475585,0.007336,0.197493,-0.023763,0.143102,-0.756277,0.058817,-0.049718,-0.061186,-0.308072,0.528842,-0.173191,-0.41747,-0.291179
openstack/kolla,Icbd001f1f487b25c4bfd6f6a78106a7f0ed1c8c8,1,0,0.4,1.9459,0.1667,2,2.0,259,0,Feature,0,0,0,5,0.018797,0.375,0,0.15,2,2,0,0.6947,0.9183,2.0,-19.38,10.8,1,0,0.0,1,37.0,0,0,0,0,0,"Gnocchi: Bump to 4.6.4

This makes Gnocchi work with Redis Sentinel + TLS [1][2].

[1] https://github.com/gnocchixyz/gnocchi/releases/tag/4.6.3
[2] https://github.com/gnocchixyz/gnocchi/releases/tag/4.6.4
[SEP]
FILES CHANGED:
kolla/common/sources.py (+1, -1)
releasenotes/notes/gnocchi-4_6_4-5d2b27e744f7d309.yaml (+4, -0)
",-2.855044,4.552377,-1.81309,1.304144,0.041828,0.385759,-0.197226,0.008725,-0.688094,1.293096,0.044274,-0.354039,0.106187,0.11456,-0.025286
openstack/kolla,Ia678484c001c66a9db675035dbb4505b0448bf58,1,1,0,2.1972,0.25,1,7.5,190,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,1,0,0.6958,0.0,3.0,7.46,19.0,1,0,0.0,0,21.1111,0,8,0,18,0,"Fix cinder-backup: add missing sysfsutils,lsscsi package

Closes-Bug: #2078886
[SEP]
FILES CHANGED:
docker/cinder/cinder-backup/Dockerfile.j2 (+6, -2)
",1.589108,-0.690109,-0.613117,-1.126172,0.097239,-0.16128,-0.763785,0.347101,-0.339524,-0.488587,0.120965,-0.183468,0.038483,-0.186852,0.285287
openstack/openstack-ansible-os_neutron,I717f3cf13a8001a1f2077a325c4ec451f45f9f74,1,0,0.9524,1.3863,0.3333,1,17.0,548,0,Feature,0,0,0,189,0.05417,0.75,0,0.7143,1,1,0,0.8947,0.0,1.0,44.27,13.39,0,0,0.0,0,137.0,0,0,0,0,0,"Use cgroupsv2 for L3 cleanup

During OpenStack upgrades we need to ensure that no process is running
with the old code base. For that we used to kill L3 agent processes
except ones running haporoxy/keepalived.

However that handler was broken with migration of systems to cgroupsv2
as it was relying on a filepath for cgroups.
As all modern operating systems already migrated to cgroupsv2 or use
them in compatability mode, let's detect the actual path and use it
instead of the hardcoded one.
[SEP]
FILES CHANGED:
handlers/main.yml (+2, -1)
",-1.034356,-1.992335,0.666069,0.298567,-0.150874,-0.423582,0.44761,0.067756,-0.552432,0.281279,-0.029912,0.07819,0.060327,-0.148592,0.075315
openstack/openstack-ansible-os_neutron,I86655567810c61dbed0415afd2e7ff343f20c736,1,0,0.9526,1.0986,0.5,1,17.0,218,0,Feature,0,0,0,190,0.05441,0.7778,0,0.7409,1,1,0,0.9,0.0,1.0,62.68,10.33,0,0,0.0,0,72.6667,0,0,0,0,0,"Do not kill ipsec on L3 cleanup

In case VPNaaS driver is enabled ipsec process also runs as part of the
l3 agent service and should not be touched by the handler.
[SEP]
FILES CHANGED:
handlers/main.yml (+1, -1)
",1.612204,-1.000962,0.483154,0.597701,-0.204616,-0.126823,0.665441,-0.109988,-0.189342,-0.493088,-0.070227,0.352545,-0.195202,-0.189318,-0.083152
openstack/kolla-ansible,I273444fc828678d3c6803bce1bc8db1c5366b9b6,1,1,0.5,3.6376,0.4324,4,8.8,408,0,Bug Fix,0,0,0,2,0.090909,0.5,0,0.25,2,2,0,0.6923,1.9727,2.0,1.78,17.16,1,0,0.0,1,10.7368,0,6,0,9,0,"Set KOLLA_SERVICE_NAME in Podman containers

Fixes issue in PodmanWorker where it didn't set KOLLA_SERVICE_NAME
environment variable when creating new container.
Additionally, two methods were moved from DockerWorker
to ContainerWorker as they are applicable to both engines.

Closes-Bug: #2078940
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+0, -11)
ansible/module_utils/kolla_container_worker.py (+11, -0)
releasenotes/notes/bug-2078940-45db7a8cc224d586.yaml (+7, -0)
ansible/module_utils/kolla_podman_worker.py (+3, -5)
",-1.146087,-0.432024,-0.804848,0.593794,0.301926,0.4571,-0.812109,0.206824,-0.210541,-0.063299,0.512035,-0.343216,0.206099,0.097339,0.210546
openstack/kolla-ansible,Ie73d7eef294e9e579314a61b39382f3ff3ba4b4b,1,1,1.0,2.1972,0.0,2,14.0,138,0,Bug Fix,0,0,0,2,0.04878,0.0,0,0.0,4,2,0,0.6929,0.5436,3.0,11.34,22.74,1,0,0.0,1,15.3333,0,20,0,19,0,"Fix os-brick multipathd del map fails for SAN multipath devices

Closes-Bug: 2078973
[SEP]
FILES CHANGED:
ansible/roles/multipathd/templates/multipath.conf.j2 (+1, -0)
releasenotes/notes/fix-multipathd-kpartx-disable-44732c1378ae2291.yaml (+7, -0)
",1.743404,-0.324223,-0.303959,-1.13881,-0.14928,0.096819,-0.693309,0.383067,-0.243726,-0.593781,0.319977,-0.086403,0.434376,-0.230623,0.226549
openstack/kolla,I22d05d1a1c6ab92ed5507d6c90b8c2281abfc7af,1,1,0,2.7726,0.1333,2,11.67,290,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.697,0.9183,2.5,23.38,17.24,1,0,0.0,1,18.125,0,6,0,4,0,"Add libnetfilter-log to l3 agent container

neutron-fwaas requires libnetfilter-log1 when fwaas_v2_log is
enabled on l3 agent.

As this package isn't easily available via rpm, this is only
added for deb platforms.

Partial-Bug: #2079775
[SEP]
FILES CHANGED:
releasenotes/notes/fix-fwaas-l3-log-aed85e0782dece8d.yaml (+10, -0)
docker/neutron/neutron-l3-agent/Dockerfile.j2 (+3, -2)
",-0.023249,-0.76846,-0.792348,0.058572,-0.138131,-0.875786,-0.069841,0.273052,-0.101658,-0.142833,0.04125,-0.17675,-0.236707,0.016816,0.346626
openstack/kolla-ansible,I44bf48fb86f639d7f0acb786392573ebfed7ee97,0,0,0.4167,3.8918,0.5,4,10.0,831,0,Feature,0,0,0,12,0.00217,0.5,0,0.2083,4,2,0,0.6935,1.8554,3.0,41.59,12.0,1,0,0.0,1,16.9592,0,0,0,0,0,"Refactor nova upgrade task

This is a prerequisite for patchset #924651

Nova runs checks before upgrading. A new nova_upgrade_checks container
is started for that purpose. This container uses the new nova-api
image, but the old config.json file. The image expects CA certificates
in a certain location, but due to the old config.json file, they will
not be present. This results in the container not trusting keystone SSL
certificate and the upgrade fails, since it can't connect. Moving the
config section before the checks ensures that the new container has
all the certificates it needs to connect to Keystone.

Also nova_enable_rolling_upgrade is no longed used, so there was no
point in keeping upgrade tasks split.
[SEP]
FILES CHANGED:
ansible/roles/nova/tasks/rolling_upgrade.yml (+0, -16)
releasenotes/notes/refactor-nova-upgrade-2474a97fc38ef0b8.yaml (+4, -0)
ansible/roles/nova/tasks/upgrade.yml (+15, -1)
etc/kolla/globals.yml (+5, -7)
",-1.775008,-1.49426,1.501944,0.100652,-0.152344,-0.106039,0.054047,0.022554,-0.025146,-0.166306,0.268134,0.161863,-0.372386,-0.026673,0.147589
openstack/kolla-ansible,Ief26303993128e327228ee438fe4fec5ff5c46e7,0,0,0.6023,1.9459,0.0,1,19.0,201,0,Bug Fix,1,0,0,171,0.016742,0.2857,0,0.1721,2,1,0,0.6922,0.0,2.0,4.99,20.23,0,0,1.0,0,28.7143,0,0,0,0,0,"CI: Fix prometheus upgrade jobs

prometheus-msteams group got removed with I93d28ef138b4e784465f3a7eaa11101ea5877050
and is needed in upgrade jobs
[SEP]
FILES CHANGED:
tests/templates/inventory.j2 (+6, -0)
",0.37774,-0.168605,-1.886134,-1.588396,1.654056,0.18221,0.090574,-0.41683,-0.147043,-0.009251,-0.684746,0.370703,-0.158488,-0.353691,0.134426
openstack/kolla-ansible,I2dfb6f6d8b85d8b51e817b6f2a7abd6930383e9f,1,0,0.5988,3.1355,0.0909,1,11.0,112,0,CI,1,0,0,172,0.01683,0.5217,0,0.3124,1,1,0,0.6908,0.0,1.0,11.09,18.95,0,0,1.0,1,4.8696,0,0,0,0,0,"CI: Add globals-default and inventory trigger to all jobs
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+20, -2)
",2.644292,0.203219,1.180026,0.468336,1.129531,-0.421322,-0.228537,0.242493,0.16279,0.169107,-0.628677,-0.35427,0.829903,0.28895,-0.228214
openstack/kolla-ansible,I2ebb17459043ce677e72528bc7490b5728af396a,1,0,0.4783,1.7918,0.4,1,10.25,314,0,CI,1,0,0,23,0.041441,0.6,0,0.287,1,1,0,0.6914,0.0,1.0,39.61,11.9,1,0,1.0,0,52.3333,0,0,0,0,0,"CI: increase timeout during server resize

this is now more in line with other retry mechanisms:
use a local variable, use 10 attempts, sleep 10 seconds.

reason: there are still occasional resize failures in CI.
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+3, -2)
",1.360656,-1.801033,0.317465,-0.087046,-0.68464,0.224825,0.164051,-0.887714,-0.199149,0.389516,-0.490531,-0.141992,0.223126,-0.205598,0.241351
openstack/kolla-ansible,If78f944ea8d63f3d37398f72e9a432cc22eb5c6e,1,0,0.5833,0.6931,0.0,1,13.0,125,0,Feature,0,0,0,12,0.067797,0.0,0,0.0,4,1,0,0.692,0.0,4.0,-1.59,20.58,1,0,0.0,0,62.5,0,0,0,0,0,"manila: add missing become to ""Copying over existing policy file"" task
[SEP]
FILES CHANGED:
ansible/roles/manila/tasks/config.yml (+1, -0)
",2.121579,-0.968985,1.108801,-0.449162,-0.080698,0.177949,-0.098571,-0.035318,0.007346,0.081933,0.144005,-0.18725,-0.202597,0.200101,-7.9e-05
openstack/kolla-ansible,If43052aaead032734ab570af754f60563b3f7cd5,0,0,0.6012,3.2958,0.1154,3,3.6,215,0,Feature,0,0,0,173,0.016891,0.7143,0,0.4294,4,2,0,0.6926,0.9294,4.0,15.18,12.55,1,0,0.0,0,7.963,1,0,0,0,0,"mariadb: Switch to rsync sst_method on upgrade

Due to [1].

[1]: https://jira.mariadb.org/browse/MDEV-27437
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+2, -3)
ansible/roles/mariadb/tasks/upgrade.yml (+20, -0)
ansible/roles/mariadb/defaults/main.yml (+1, -0)
",-0.083669,2.101359,-1.31595,0.085872,-1.061408,0.388188,-0.504772,-0.005959,-0.018674,0.410384,0.038997,-0.298871,-0.593838,-0.118367,-0.218817
openstack/python-ironicclient,I949cfca6386a13558f93da9b5a3acefaba7454aa,1,0,1.0,1.0986,0.5,1,11.0,181,0,Bug Fix,0,0,0,3,0.06383,1.0,0,1.0,2,1,0,1.0,0.0,2.0,14.93,18.95,1,0,0.0,0,60.3333,0,0,0,0,0,"Fix detailed node history list

Node history controller does not implement a /detail URL,
Client should pass a query argument.
[SEP]
FILES CHANGED:
ironicclient/v1/node.py (+1, -1)
",2.179772,-1.393891,0.333208,0.619325,-0.192019,-0.09724,0.413443,0.105607,0.290311,-0.315589,-0.45422,-0.067187,0.027064,0.131157,-0.463027
openstack/kolla,I47848bb1e9847821c9b5fa25f0d817ef00358dd6,0,0,0.6818,2.6391,1.0,1,17.4,566,0,CI,0,0,0,44,0.013885,0.0,0,0.0,2,1,0,0.6981,0.0,2.0,40.39,16.62,0,0,0.0,0,40.4286,0,0,0,0,0,"Removal of deletion of the proxysql database

It seems that at the time of implementing proxysql,
it did not have the --reload parameter, or I overlooked
it back then. In any case, it is available now, and this
patch just removes the deletion of the proxysql database
and keeps it there. The deletion was in the extended start
precisely because proxysql ignored changes in the configuration
file, so the internal database was always rebuilt during
a restart. However, this now works with the --reload parameter.
[SEP]
FILES CHANGED:
docker/proxysql/kolla_extend_start (+0, -13)
",-0.767656,-1.976983,0.806465,0.550138,-0.568976,0.255472,0.464319,-0.424602,-0.302338,0.36241,0.446206,0.14065,-0.313852,0.132388,0.314936
openstack/kolla-ansible,I9215d6cef3795030676c44a8184d99ba46dcb60c,0,0,0.6667,0.6931,0.0,1,15.5,252,0,Feature,0,0,0,45,0.014142,0.0,0,0.0,5,1,0,0.6913,0.0,5.0,8.26,19.1,1,0,0.0,0,126.0,0,0,0,0,0,"Add parameter to always merge config into proxyql

The --reload parameter ensures that any changes
in the proxysql configuration file are applied
to the already existing internal proxysql database.
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/proxysql/proxysql_run.sh.j2 (+1, -0)
",0.643941,-1.187254,0.210741,1.315492,0.41654,-0.320845,0.546541,0.201813,0.410244,-0.10866,-0.429403,0.537897,-0.53672,-0.023268,-0.048162
openstack/kolla-ansible,I8776cdc0a6ec9e4e35a2424dd0984488514a711f,0,0,0.6522,4.2627,0.0,8,6.4,301,0,Doc,0,0,0,46,0.014452,0.6667,0,0.4348,5,4,0,0.69,2.4014,3.0,4.7,13.81,1,0,0.2143,1,4.2394,0,0,0,0,0,"Add option to enable proxysql's prometheus exporter

From version 2.1, ProxySQL has a built-in ProxySQL
Prometheus exporter. This patch adds an option to
easily enable this exporter [1].

[1] https://proxysql.com/documentation/prometheus-exporter
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/precheck.yml (+27, -0)
releasenotes/notes/proxysql-prometheus-exporter-7eec65a67a61f724.yaml (+7, -0)
ansible/group_vars/all.yml (+2, -0)
tests/templates/globals-default.j2 (+1, -0)
tests/test-core-openstack.sh (+14, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+3, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+13, -0)
ansible/roles/loadbalancer/defaults/main.yml (+3, -0)
",-0.574295,1.133599,-0.620876,1.027954,-0.264506,-0.145105,0.126931,0.511125,0.247372,0.856964,0.042039,0.10528,-0.143575,-0.532698,-0.05869
openstack/kolla-ansible,Ib85ce252374fae917d329e1824800a288c6bc9f1,1,0,0.6383,4.5109,0.0,26,11.8,819,0,Feature,0,0,0,47,0.014448,1.0,0,0.6383,4,1,0,0.6887,4.3706,3.92,49.32,12.18,1,0,0.0,0,9.0,0,0,0,0,0,"Support mounting host's /dev/shm into container

The Oslo.messaging project implemented a nice feature called Queue
Manager. This means that instead of using random queue names in
RabbitMQ, it uses queue names composed of hostname, process-name and a
counter. For proper functioning, the code stores some informations in
/dev/shm. This is needed to avoid creating queues with the same name.
We'd otherwise hit this where multiple services run under mod_wsgi, or
with services such as Magnum just within a single container as it needs
to create multiple ""reply"" queues.

This patch mounts /dev/shm in containers where oslo_messaging is used.

This is enabled when ``om_enable_queue_manager`` is set to ``True``.
Queue Manager will be supported in a follow-up patch.
[SEP]
FILES CHANGED:
ansible/roles/mistral/defaults/main.yml (+4, -0)
ansible/roles/nova-cell/defaults/main.yml (+5, -0)
ansible/roles/neutron/defaults/main.yml (+16, -0)
ansible/roles/heat/defaults/main.yml (+3, -0)
ansible/roles/cinder/defaults/main.yml (+2, -0)
ansible/roles/manila/defaults/main.yml (+3, -0)
ansible/roles/cyborg/defaults/main.yml (+3, -0)
ansible/roles/cloudkitty/defaults/main.yml (+2, -0)
ansible/roles/blazar/defaults/main.yml (+2, -0)
ansible/roles/keystone/defaults/main.yml (+1, -0)
ansible/roles/glance/defaults/main.yml (+2, -0)
ansible/roles/designate/defaults/main.yml (+7, -0)
ansible/roles/barbican/defaults/main.yml (+3, -0)
ansible/roles/tacker/defaults/main.yml (+2, -0)
ansible/roles/trove/defaults/main.yml (+3, -0)
ansible/roles/masakari/defaults/main.yml (+4, -0)
ansible/roles/octavia/defaults/main.yml (+5, -0)
ansible/roles/venus/defaults/main.yml (+2, -0)
ansible/roles/ceilometer/defaults/main.yml (+4, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/aodh/defaults/main.yml (+4, -0)
ansible/roles/nova/defaults/main.yml (+3, -0)
ansible/roles/ironic/defaults/main.yml (+1, -0)
ansible/roles/magnum/defaults/main.yml (+2, -0)
ansible/roles/zun/defaults/main.yml (+3, -0)
ansible/roles/watcher/defaults/main.yml (+3, -0)
",-2.164596,-0.817962,1.771147,0.182843,-0.091089,0.030245,0.127749,0.171293,-0.07833,-0.145587,-0.006922,-0.224371,-0.187054,-0.341229,0.005579
openstack/kolla-ansible,Ided3b2bce03ea11fb34820fc40b4a3d694b8b44c,1,0,0.6458,4.2627,0.0,14,11.12,652,0,Feature,0,0,0,48,0.014358,1.0,0,0.6458,4,1,0,0.6893,3.8074,4.0,33.95,14.79,1,0,0.0,0,9.1831,0,0,0,0,0,"Set lock_path for openstack services

The Oslo.messaging project implemented a nice feature
called Queue Manager. This means that instead of using
random queue names in RabbitMQ, it uses queue names composed
of hostname, process-name and some integer. For proper
functioning, the code using lockutils from oslo_concurrency
and it's failing if lock_path is not set.

This patch simply set lock_path of oslo_concurrency for
services which can potentionally use Queue Manager.

This is enabled when ``om_enable_queue_manager`` is set to ``True``.
Queue Manager will be supported in a follow-up patch.
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+5, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+5, -0)
ansible/roles/keystone/templates/keystone.conf.j2 (+5, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+5, -0)
ansible/roles/heat/templates/heat.conf.j2 (+5, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+5, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+5, -0)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+5, -0)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+5, -0)
ansible/roles/trove/templates/trove.conf.j2 (+5, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+5, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+5, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+5, -0)
ansible/roles/venus/templates/venus.conf.j2 (+5, -0)
",-1.671359,-1.149864,1.203797,0.308042,0.099352,-0.16606,-0.256589,0.128418,0.115162,-0.072274,0.005392,-0.260793,-0.47971,-0.216361,-0.0091
openstack/kolla-ansible,I3375e303bc358fc79d1fa2e219e6ec1dba7a38ba,0,1,0.6531,2.8904,0.1765,4,8.0,346,0,Bug Fix,0,0,0,49,0.014357,0.0,0,0.0,5,2,0,0.6898,1.9928,3.75,-33.93,18.2,0,0,0.0,1,19.2222,0,6,0,5,0,"Fix indentation in haproxy config

Commit [1] introduced a bug into kolla-ansible
where there is incorrect indentation in the haproxy
configuration file. This patch fixes it.

[1] https://github.com/openstack/kolla-ansible/commit/b13fa5a92cb6d768c5839bd11667e2ca72a7cd2f

Closes-Bug: #2080034
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/haproxy/haproxy_main.cfg.j2 (+3, -1)
ansible/roles/glance/templates/glance-tls-proxy.cfg.j2 (+3, -1)
releasenotes/notes/bug-2080034-b217a4200a6c6eda.yaml (+5, -0)
ansible/roles/neutron/templates/neutron-tls-proxy.cfg.j2 (+3, -1)
",-1.575443,1.451913,-1.511492,-0.37218,0.289149,0.010671,0.514083,-0.016778,0.314444,0.502779,0.074492,-0.188197,0.398903,-0.14325,0.188917
openstack/openstack-ansible,Ic3b4b543e58904f8f6fef36e7ae7cb97638c1d3c,1,0,0.8571,1.9459,0.3333,1,11.33,473,0,CI,0,0,0,35,0.167464,1.0,0,0.8571,1,1,0,0.9355,0.0,1.0,60.97,11.0,0,0,0.0,0,67.5714,0,0,0,0,0,"Ensure ""parallel"" package is installed for CI log collection

The log collection requirements are installed at the start of the
job, running from the starting upgrade branch. We need to ensure
that the tools needed by the destination branch are present.

In the case of a 2023.1 to 2024.1 SLURP upgrade, these tools are
missing so this patch is a partial backport of [1].

[1] Ief03c33b76eac6e256477cfaa16c8a59acd7d702
[SEP]
FILES CHANGED:
scripts/scripts-library.sh (+4, -2)
",-0.87522,-0.878095,-0.046553,-0.361861,0.418674,0.056523,1.239189,0.509995,0.454399,0.616731,0.26577,0.370191,-0.071309,0.086359,0.0118
openstack/openstack-ansible-os_octavia,Ia34be7a05593b034003bd40c866fbf6561a154e5,1,0,0.9529,1.9459,0.0,2,13.25,433,0,Feature,0,0,0,191,0.054665,0.9322,0,0.8883,2,2,0,0.8571,0.65,1.5,13.01,17.38,0,0,0.0,1,61.8571,0,0,0,0,0,"Return `amphora` provider back

As Magnum does rely on `amphora` provider as a default and we got
a notice from Octavia devs that `amphora` provider is gonna stay
while potentially `amphorav2` might be sunsetted in the future,
it makes sense to partially revert the [1] and return `amphora` back.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_octavia/+/885519
[SEP]
FILES CHANGED:
releasenotes/notes/return_amphora_provider-05deae1d173dbb1f.yaml (+5, -0)
defaults/main.yml (+1, -0)
",-1.694262,0.997896,-0.58015,0.298807,-0.362552,-0.107881,0.345521,-0.476382,-0.4248,0.008208,0.386765,-0.301046,-0.117224,-0.384697,-0.020667
openstack/kolla,I429f00ed4bdcd24409d14453ab53c5fa11fdb00b,0,0,0.5977,2.7726,0.0,1,8.75,324,0,Feature,0,0,0,174,0.016946,0.0,0,0.0,3,1,0,0.6955,0.0,3.0,40.84,9.21,1,0,0.0,0,20.25,0,0,0,0,0,"Add ovn-sb-db-relay image with newer ovn-ctl

We need newer ovn-ctl with [1] - for now download that from
ovn-org/ovn@master - once 25.03 is branched we should
get that the normal way.

[1]: https://github.com/ovn-org/ovn/commit/2ecba75432cf90ffb5d6a3a53b8aed521ecf0f44
[SEP]
FILES CHANGED:
docker/ovn/ovn-sb-db-relay/Dockerfile.j2 (+15, -0)
",-1.206305,1.452925,-0.882023,-0.514718,0.139515,-0.500258,1.345527,0.018017,-0.278545,0.188778,0.099615,-0.177138,0.148219,0.19846,0.307924
openstack/kolla-ansible,I6946321aeb892e8c7ba5c0d80ecf17398429d204,0,0,0.5943,2.6391,0.0769,3,15.0,128,0,CI,1,0,0,175,0.017018,0.7308,0,0.4343,1,1,0,0.6886,1.4196,1.0,39.33,11.33,0,0,1.0,1,9.1429,0,0,0,0,0,"CI: Change mariadb jobs to voting and gating

Add also missing Debian job
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
zuul.d/project.yaml (+4, -0)
zuul.d/jobs.yaml (+7, -0)
",1.380748,-0.195662,-0.605832,0.341247,0.691868,0.201977,-0.206199,0.146447,-0.581284,0.212323,0.405648,0.206337,0.211176,-0.143887,-0.524299
openstack/kolla-ansible,I0da1ad16bfab00bed7e935cca118551a6c5860c6,1,0,0.8095,1.3863,0.0,1,11.5,182,0,Doc,0,0,0,21,0.02665,1.0,1,0.8095,4,1,0,0.6873,0.0,4.0,37.0,13.3,1,0,0.0,0,45.5,0,0,0,0,0,"Be clear that rabbitmq-upgrade is not idempotent

This isn't obvious from reading of the docs, let's make sure users are
aware.
[SEP]
FILES CHANGED:
doc/source/reference/message-queues/rabbitmq.rst (+3, -0)
",1.191984,-0.736168,-0.512131,0.304724,-0.582988,0.608514,0.96698,-1.368658,-0.979139,0.2754,0.533634,0.241983,-0.362354,-0.435324,0.195569
openstack/kolla-ansible,I7934bda26a134fe38a63716f9878a27b4f3819ce,1,0,0.8182,2.3979,0.0,1,11.0,104,0,Doc,0,0,0,22,0.027813,0.8571,1,0.7013,3,1,0,0.6879,0.0,3.0,41.85,11.67,1,0,0.0,0,9.4545,0,0,0,0,0,"Docs: point to RMQ SLURP handing in upgrade guide
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+10, -0)
",3.315226,0.059926,1.36268,-0.465122,-0.039216,0.22582,0.383013,0.955708,-0.26324,-0.357742,0.278587,0.078728,-0.047161,-0.399337,-0.337078
openstack/kolla,Ib3e5f63d8dd0a5eb19362516d70c15e7e0c225a7,0,0,0.8261,3.912,0.3673,6,3.58,537,0,Doc,0,0,0,23,0.028714,0.5926,0,0.4895,3,4,0,0.6929,2.4524,2.17,-46.67,9.81,0,0,0.0816,1,10.74,0,0,0,0,0,"Rocky/CentOS: Switch to RMQ Cloudsmith mirrors

PackageCloud is discontinued as of August 18th [1].

Also corrects the versions docs for RabbitMQ and Erlang.

Use new RMQ Cloudsmith repo URLs for Debian/Ubuntu, these now use
*.rabbitmq.com domains [2].

1. https://www.rabbitmq.com/blog/2024/08/11/package-repository-updates#packagecloud-will-be-discontinued-on-aug-18th-2024
2. https://www.rabbitmq.com/blog/2024/08/11/package-repository-updates#mirrors-now-use-rabbitmqcom-domains
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-erlang-migrate-from-packagecloud-59d7e9e0a10e1da0.yaml (+7, -0)
doc/source/contributor/versions.rst (+8, -8)
kolla/template/repos.yaml (+4, -4)
docker/base/rabbitmq_rabbitmq-server.repo (+5, -2)
docker/base/rabbitmq_rabbitmq-erlang.repo (+5, -2)
kolla/tests/test_methods.py (+2, -2)
",-3.520583,3.672271,-0.069262,0.485659,-0.08459,-0.283403,0.080612,0.191081,-0.477568,-0.21863,0.007263,0.48969,0.450742,0.240226,0.259361
openstack/kolla-ansible,I7ccae4c501ce332519edef336bcceefae9f9568b,1,1,0.64,2.4849,0.0,2,25.0,415,0,Bug Fix,0,0,0,50,0.014577,0.3333,0,0.2133,4,2,0,0.6884,0.9457,3.0,0.42,21.2,1,0,0.0,1,34.5833,0,6,0,4,0,"Do not copy TLS files for backend if turned off

This patch fixes an issue where backend related
certificates are attempted to be copied when
``kolla_copy_ca_into_containers`` is enabled but
``kolla_enable_tls_backend`` is disabled.

The fix consists of these specific tasks now
being limited by the condition ``kolla_enable_tls_backend``

Closes-Bug: #2080381
[SEP]
FILES CHANGED:
ansible/roles/service-cert-copy/tasks/main.yml (+4, -0)
releasenotes/notes/bug-2080381-3cf5ed810a5ac690.yaml (+7, -0)
",-1.275409,-0.665585,-0.195548,0.450607,0.428811,0.150923,-0.610905,0.020843,0.573146,-0.039331,0.151256,-0.697106,-0.411024,-0.395257,0.625934
openstack/kolla,I2cce3dd2540c878878ff0aae80ee5a7e0f455da7,1,0,0.7917,3.912,0.3673,6,3.33,511,0,Doc,0,0,0,24,0.028235,0.5714,0,0.4524,3,4,0,0.6903,2.4524,2.17,-46.12,8.33,0,0,0.0816,1,10.22,0,0,0,0,0,"rabbitmq: Switch to Cloudsmith mirrors

PackageCloud is discontinued as of August 18th [1].

Also corrects the versions docs for RabbitMQ and Erlang.

Use new RMQ Cloudsmith repo URLs, these now use
*.rabbitmq.com domains [2].

1. https://www.rabbitmq.com/blog/2024/08/11/package-repository-updates#packagecloud-will-be-discontinued-on-aug-18th-2024
2. https://www.rabbitmq.com/blog/2024/08/11/package-repository-updates#mirrors-now-use-rabbitmqcom-domains
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq-erlang-migrate-from-packagecloud-59d7e9e0a10e1da0.yaml (+7, -0)
doc/source/contributor/versions.rst (+8, -8)
kolla/template/repos.yaml (+4, -4)
docker/base/rabbitmq_rabbitmq-server.repo (+5, -2)
docker/base/rabbitmq_rabbitmq-erlang.repo (+5, -2)
kolla/tests/test_methods.py (+2, -2)
",-3.071786,3.944634,-0.227382,0.60509,-0.031228,-0.314327,0.197491,0.08457,-0.336346,-0.161741,0.022982,0.478357,0.362034,0.328662,0.344015
openstack/kolla-ansible,If14285f033ed4914fd3b28d7efcc95e1c9f273a5,1,1,0.5,2.5649,0.0833,3,8.0,277,0,Bug Fix,0,0,0,24,0.042857,0.8,0,0.4,4,3,0,0.689,1.0409,3.33,-37.46,19.87,1,0,0.0,1,21.3077,0,6,0,3,0,"make OIDCClaimDelimiter configurable

Add a new variable keystone_federation_oidc_claim_delimiter
to make this configurable for keycloak OIDC federation.

Closes-Bug: #2080394
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -1)
ansible/roles/keystone/defaults/main.yml (+1, -0)
releasenotes/notes/fix-hardcoded-oidc-claim-delimiter-06ca81b1fce0eba7.yaml (+9, -0)
",-0.367625,0.461427,-1.401008,0.733849,0.962808,0.266355,-0.901993,0.189511,0.734783,-0.435065,0.417437,-0.0576,-0.378574,-0.41347,0.42993
openstack/kolla-ansible,Idf750fb882dae2864922da8620cd2a143bc0ecce,1,1,0.52,2.6391,0.0,3,7.0,166,0,Bug Fix,0,0,0,25,0.043706,0.8333,0,0.4333,4,3,0,0.6896,1.2389,3.33,-11.77,19.94,1,0,0.0,1,11.8571,0,14,0,8,0,"Add an option to set OIDCXForwardedHeaders

Closes-Bug: #2080402
[SEP]
FILES CHANGED:
releasenotes/notes/add-keystone-oidc-forwarded-headers-option-d153c6292cf20b26.yaml (+8, -0)
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -0)
ansible/roles/keystone/defaults/main.yml (+4, -0)
",1.06167,-0.608654,-0.816688,-0.665627,0.176246,0.729989,-1.332658,0.464601,0.447881,0.102397,0.334502,-0.317924,-0.104554,-0.657426,0.11641
openstack/kolla,Ibf7e40e8b059d733e114963022df06180249c650,1,1,0.6471,4.9836,0.0069,3,24.8,797,0,Bug Fix,0,0,0,51,0.014821,0.3333,0,0.2157,3,3,0,0.6914,0.431,2.67,44.53,17.66,1,0,0.0,1,5.4589,0,6,0,3,0,"Add way to backup from MariaDB replica server

ProxySQL reports its version to MySQL clients,
causing the backup process to fail when ProxySQL is used.

This patch adds a new script that handles backups from
the replica server directly, without modifying the original
backup script. The new script retrieves the server address
via the load balancer and connects directly to the replica
server to execute the backup.

Moreover, this reduces the risk that the backup will be inconsistent
or that it will block OpenStack MySQL clients, because they are
connected to a different server, and no one is connected to the replica,
or that it will overload the load balancer (such as ProxySQL or HAProxy)
which listens on the VIP.

Closes-Bug: #2080818
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-server/Dockerfile.j2 (+4, -1)
docker/mariadb/mariadb-server/backup_replica.sh (+135, -0)
releasenotes/notes/bug-2080818-9eacce36a8c18f8f.yaml (+5, -0)
",-2.250549,-1.52571,1.407071,0.527519,-0.002916,0.150982,-0.170433,0.094941,0.170328,-0.059086,0.26205,0.435867,0.08666,0.066417,-0.063877
openstack/kolla-ansible,I26b5db3a3eeebd758ad05d9cb9aa689a68e1816f,0,1,0.6538,1.9459,0.0,2,7.25,290,0,Bug Fix,0,0,0,52,0.014501,0.3333,0,0.2179,4,2,0,0.6902,0.65,3.0,-1.81,12.56,1,0,0.0,1,41.4286,0,6,0,4,0,"Fix mariadb backup not working

This trivial fix simply consists of
adding the forgotten action after
the kolla-ansible was reworked in review [1].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/911417

Closes-Bug: #2080408
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/backup.yml (+1, -0)
releasenotes/notes/bug-2080408-b25015799c646b13.yaml (+5, -0)
",-0.576485,0.886062,-1.130237,-0.285623,-1.043045,0.163123,-0.058627,-0.090988,0.075292,0.115086,0.099201,-0.308168,-0.13322,-0.158167,-0.008146
openstack/octavia-dashboard,I25d07dce1379dd9489a2a809bb21e826954de2c7,1,0,0.1818,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,22,0.229167,0.0,1,0.0,2,1,0,0.3529,0.5917,2.0,40.6,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2024.2

Add file to the reno documentation build to show release notes for
stable/2024.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2024.2.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/2024.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.183224,-0.916654,-0.113094,0.106308,-0.054322,-0.208257,-0.439611,0.522207,0.098575,0.783011,-0.764214,-0.065218,-0.173877,0.855748,0.38859
openstack/openstack-ansible-os_horizon,I2dfae4fa31d397938077bfa817261b6a42259482,1,0,0.9531,2.8904,0.6471,1,19.14,830,0,Bug Fix,0,0,0,192,0.054857,1.0,0,0.9531,1,1,0,1.0,0.0,1.0,45.35,13.93,0,0,0.0,0,46.1111,0,0,0,0,0,"Fix custom policies rollout

In case of horizon_policy_overrides defenition role will fail due to
multiple reasons. First of all, policies are in YAML format for a while
now, so json is not applicable. On top of that rollout process
is off, since default horizon policies are basically empty files, as all
policies in them are commented out.

So once we read them and supply as content - override is failing, as
it's treating the content as None, since there's nothing to merge with.

With that in mind, it makes sense to simplify the process by removing
original policy fetch and just fully override it by user supplied
content.

We keep the old format of horizon_policy_overrides where services
are split be sections, so each service will be placed in it's own
policy file.
[SEP]
FILES CHANGED:
tasks/horizon_post_install.yml (+6, -11)
",-1.89235,-1.649946,1.943364,-0.018316,-0.469347,-0.048057,0.386358,-0.598802,-0.308079,-0.266201,0.038319,-0.248666,-0.153307,-0.04822,0.054448
openstack/kolla-ansible,Iad0476d4511f28c837794352c9a3e2f47113d9a1,1,1,0.8814,2.3979,0.1,2,11.14,567,0,Bug Fix,0,0,0,59,0.057337,0.0,0,0.0,2,2,0,0.6889,0.971,2.0,45.85,12.15,1,0,0.0,1,51.5455,0,6,0,18,0,"Separate outputs of kolla_toolbox inner module

Inner modules called by the kolla_toolbox module were returning stdout
and stderr as a single output object. This could break JSON parsing if
any data was present in stderr, for example warnings such as:

    [WARNING]: Collection ansible.posix does not support Ansible version 2.14.17

Fix by using demux=True to separate the two streams. The stderr content
is logged as it could be useful for troubleshooting or catching
deprecation notices.

Closes-Bug: #2080544
[SEP]
FILES CHANGED:
ansible/library/kolla_toolbox.py (+3, -1)
releasenotes/notes/kolla-toolbox-demux-c5e8d27bc7214069.yaml (+6, -0)
",-0.998831,-1.460387,0.695313,-0.132277,-0.371887,-0.453631,0.058254,0.257857,-0.12171,0.245903,0.259491,-0.369098,-0.069651,-0.033145,-0.009206
openstack/kolla-ansible,Ic3acb15f7c6ba7269ef62ccc8895b6bea4fc1f4d,1,1,0.5909,0.6931,0.0,1,5.12,709,0,Bug Fix,0,0,0,176,0.017094,1.0,0,0.5909,2,1,0,0.6895,0.0,2.0,26.24,11.81,0,0,0.0,0,354.5,0,0,0,0,0,"systemd: Add Wants=docker.service for docker

In I70dd1751dea6bfc9bb265aeda04b3392e135324c we removed
Requires=docker.service and left only After=docker.service.

In a case where something starts docker.service that's enough,
but if docker.service is disabled or no service is dependent on
it - it won't be started.

This patch adds Wants=docker.service which will try to start
docker.service if it is not started or enabled but does not
impose a dependency which causes restart of kolla systemd units
when docker.service is restarted (see [1]).

Closes-Bug: #2065168

[1]: https://www.freedesktop.org/software/systemd/man/latest/systemd.unit.html#Wants=
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_systemd_worker.py (+1, -0)
",-2.369183,-0.029992,1.308144,-0.959924,-0.177187,0.005003,-0.028899,-0.249794,-0.353968,-0.04885,0.13221,-0.204483,0.069208,0.061977,-0.144711
openstack/kolla,Ie135a8e678cdd408311001e8fb33e17f6c08e64e,0,0,0.5932,1.0986,0.5,1,9.0,109,0,Feature,0,0,0,177,0.017189,0.381,0,0.226,2,1,0,0.6926,0.0,2.0,-27.9,25.82,0,1,0.0,0,36.3333,0,0,0,0,0,"[release] Change RDO's DELOREAN_DEPS repo to Dalmatian
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",0.25297,1.656584,-0.413101,0.499776,1.103468,0.505654,-0.885698,1.09641,-0.85647,-0.117695,0.595926,0.190806,-0.509777,-0.584613,-1.278031
openstack/kolla-ansible,Ic8aaa57f75479a17c215c27ac5e6df0f18c74edc,0,0,0.6415,3.0445,0.2,3,3.89,334,0,Feature,0,0,0,53,0.014755,0.7037,0,0.4514,2,2,0,0.69,1.4388,1.0,24.02,9.56,1,0,0.55,1,15.9048,0,0,0,0,0,"Drop support for py38, py39

Kolla-ansible itself requires ansible-core>=2.16,<2.18,
but ansible-core in this version no longer supports
python38 and python39 as per [1].

So let's just drop this old python support.

[1] https://github.com/ansible/ansible/blob/v2.16.11/setup.cfg
[SEP]
FILES CHANGED:
releasenotes/notes/drop-py38-and-py39-3fd79da5557fca7b.yaml (+5, -0)
zuul.d/project.yaml (+10, -1)
setup.cfg (+1, -3)
",-1.050403,1.851729,-0.482006,0.60396,-0.511757,-0.188766,0.241481,0.090023,-0.581643,1.008822,-0.020451,-0.113573,0.063639,0.205688,0.103756
openstack/kolla,I9359df23a41a600dd46dbc1812a54be57fd33f71,0,0,0,4.2767,0.3803,2,1.32,542,0,CI,0,0,0,0,0.0,0.4444,0,0.0,2,2,0,0.69,0.7941,2.0,-6.0,13.33,0,0,0.0,1,7.5278,0,0,0,0,0,"Prometheus update all exporters to the latest versions

prometheus-alertmanager: 0.27.0 -> 0.28.0
prometheus-blackbox-exporter: 0.24.0 -> 0.25.0
prometheus-cadvisor: 0.49.1 -> 0.49.2
prometheus-elasticsearch-exporter: 1.7.0 -> 1.8.0
prometheus-memcached-exporter: 0.14.2 -> 0.15.0
prometheus-mtail: 3.0.0-rc54 -> 3.0.8
prometheus-mysqld-exporter: 0.15.1 -> 0.16.0
prometheus-node-exporter: 1.7.0 -> 1.8.2
prometheus 2.50.1 -> 2.55.1

Co-authored-by: Piotr Parczewski <piotr@stackhpc.com>
[SEP]
FILES CHANGED:
kolla/common/sources.py (+27, -27)
releasenotes/notes/update-prometheus-services-dd195876e162251c.yaml (+17, -0)
",-4.092738,4.564768,0.578176,0.279365,0.53737,0.089676,-0.119071,0.383785,-0.176778,0.781617,0.361094,0.277383,-0.135043,1.284117,0.629803
openstack/kolla,I2a290da38ea34b05ce3da8fb8b39b6252bf2da47,1,1,0.6296,3.0445,0.0,2,9.75,633,0,Bug Fix,0,0,0,54,0.01495,1.0,0,0.6296,2,2,0,0.6875,0.8813,2.0,27.74,13.13,1,0,0.0,1,30.1429,0,6,0,4,0,"Fix state checking via kolla_set_configs

Kolla checks the status of its configurations
using kolla_set_configs --check. However, this
doesn't work for the command block in the config.json
file. This means that if only the command value changes,
but not the config_files block, which is common practice
in Kolla-Ansible btw, the container will not report the
changes.

This is undesirable and important to fix, especially
considering the planned rework of notifiers in
Kolla-Ansible [1].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/773243/14

Closes-Bug: #2080861
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+14, -0)
releasenotes/notes/bug-2080861-a46761ea9e7bbf91.yaml (+6, -0)
",-1.970136,-0.106241,0.981942,-0.394337,-0.664473,-0.291906,-0.171482,-0.047782,-0.018886,-0.172161,0.204243,-0.224201,-0.316071,-0.097054,-0.096718
openstack/openstack-ansible-openstack_hosts,I0d6bb175edae9a45d5cbc3bf8ad21ada98d2abc0,1,1,0.9534,0.6931,0.0,1,19.67,425,0,Bug Fix,0,0,0,193,0.054876,1.0,0,0.9534,1,1,0,0.8333,0.0,1.0,19.11,19.39,0,0,0.0,0,212.5,0,0,0,0,0,"Ensure python libselinux bindings for containers

Due to a CentOS Stream behaviour, which occasionally tries to enforce
selinux inside LXC containers and requires for libselinux python binding
to be present install containers for modules to execute.

This mainly occurs for utility container, but we add for all containers
just to be on a safe side.

Closes-Bug: #2080765
[SEP]
FILES CHANGED:
vars/redhat-9.yml (+1, -0)
",0.105434,-1.745106,0.174196,0.21484,-0.296217,-0.527902,0.268334,0.203507,-0.183546,0.197112,-0.085162,-0.331349,0.386216,-0.253892,0.400652
openstack/kolla-ansible,I65fb8fb028a085f0f1c980417c021522b4eea20d,1,0,0.5899,1.3863,0.0,1,6.0,82,0,CI,1,0,0,178,0.017283,0.4412,0,0.2602,1,1,0,0.6888,0.0,1.0,31.55,22.4,0,0,1.0,1,20.5,0,0,0,0,0,"CI: Mark aarch64 non-voting
[SEP]
FILES CHANGED:
zuul.d/jobs.yaml (+3, -0)
",2.848406,1.143896,1.221297,0.037815,0.45532,0.447521,0.062574,0.136954,0.236352,0.427388,0.103945,0.570324,0.249619,0.199121,-0.169678
openstack/openstack-ansible-ceph_client,I5b4e050871f12de0c725b3d375143390457b54e6,1,0,0.9536,1.6094,0.0,1,23.0,583,0,Feature,0,0,0,194,0.055145,0.9667,0,0.9218,1,1,0,0.9167,0.0,1.0,45.56,14.42,1,0,0.0,0,116.6,0,0,0,0,0,"Ensure apparmor folder exists for ceph caching

Right now we're using blockinfile towards file that might not be
present on filesystem, as we're leveraging apparmor local overrides
folder for that.
Adding `create` argument ensures that target file will be created if
it is absent for some reason.

The downside of the approach is that it will create a file even
when it's not particularly needed, but that's the only way to
get the code revert changes by disabling the variable and not
loosing any 3rd party content of the file.
[SEP]
FILES CHANGED:
tasks/main.yml (+4, -0)
",-0.335775,-2.370612,1.123139,0.397068,-0.495009,-0.258814,0.979882,-0.456937,-0.039246,0.175834,0.127319,-0.134386,0.109929,-0.003401,0.139152
openstack/openstack-ansible-os_keystone,Ia3e4af7986166f0729840d2a61fb8f52ea053676,1,0,0.9538,3.4657,0.0323,3,12.57,649,0,Feature,0,0,0,195,0.055366,1.0,0,0.9538,1,1,0,1.0,1.14,1.0,28.72,15.03,1,0,0.0,0,20.2812,0,0,0,0,0,"Ensure that selected Apache MPM is enforced

At the moment services might have different MPM selected while all
operating the same Apache setup, ie on metal setup.
This results in failures to set selected MPMs, so eventually second run
of roles after initial deployment will end up in failure (ie upgrade).

This patch ensures that all except selected MPMs are disabled and do
role get's the desired state of deployment.

We also need to align selected MPM across all roles to avoid
future conflicts.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/930446
[SEP]
FILES CHANGED:
vars/debian.yml (+8, -0)
defaults/main.yml (+1, -1)
tasks/keystone_apache.yml (+21, -0)
",-1.658929,-0.188297,0.825141,0.167116,-0.207911,0.070129,0.236909,-0.057796,0.016821,-0.284566,0.056521,0.179271,0.028743,-0.335369,-0.043939
openstack/openstack-ansible-os_horizon,I480222993a63af41cfba65464f5b5c8585b2d4fd,1,0,0.9541,3.7842,0.093,4,8.36,833,0,Feature,0,0,0,196,0.055165,1.0,0,0.9541,2,2,0,1.0,1.5861,1.25,0.64,14.65,1,0,0.0,1,18.9318,0,0,0,0,0,"Ensure that selected Apache MPM is enforced

At the moment services might have different MPM selected while all
operating the same Apache setup, ie on metal setup.
This results in failures to set selected MPMs, so eventually second run
of roles after initial deployment will end up in failure (ie upgrade).

This patch ensures that all except selected MPMs are disabled and do
role get's the desired state of deployment.

We also need to align selected MPM across all roles to avoid
future conflicts.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/930272
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-repo_server/+/929690
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-rabbitmq_server/+/930446
[SEP]
FILES CHANGED:
tasks/horizon_apache.yml (+22, -0)
releasenotes/notes/horizon_apache_mpm-2a34436635f1bef9.yaml (+8, -0)
vars/debian.yml (+8, -4)
defaults/main.yml (+1, -0)
",-3.562583,2.825903,1.516176,0.289459,-0.191324,0.211842,0.131659,-0.197229,-0.069612,-0.525378,-0.217688,0.251506,0.29537,-0.264227,0.21179
openstack/openstack-ansible-os_skyline,I3288c6e4060fe954b2c2725865783aa18bf6bc0d,1,0,0.9543,3.6376,0.1081,3,12.57,633,0,Feature,0,0,0,197,0.054783,1.0,0,0.9543,1,1,0,1.0,1.2667,1.0,33.53,15.03,1,0,0.0,0,16.6579,0,0,0,0,0,"Ensure that selected Apache MPM is enforced

At the moment services might have different MPM selected while all
operating the same Apache setup, ie on metal setup.
This results in failures to set selected MPMs, so eventually second run
of roles after initial deployment will end up in failure (ie upgrade).

This patch ensures that all except selected MPMs are disabled and do
role get's the desired state of deployment.

We also need to align selected MPM across all roles to avoid
future conflicts.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/929892
[SEP]
FILES CHANGED:
vars/debian.yml (+8, -4)
defaults/main.yml (+3, -0)
tasks/skyline_apache.yml (+22, -0)
",-1.551016,-0.243879,0.769769,0.244242,-0.254122,0.199865,0.236268,-0.136679,0.023179,-0.122485,0.034293,0.10276,0.122837,-0.264154,-0.07976
openstack/kolla-ansible,Icd15e8d04771cf50bc704f0c40006a8ac0aeb3ef,1,1,0,1.0986,0.5,1,4.0,112,0,Bug Fix,0,0,0,0,0.0,0.3429,0,0.0,2,1,0,0.6893,0.0,2.0,-51.02,21.6,0,0,0.0,0,37.3333,0,6,0,13,0,"Fixing typo in etc/kolla/globals.yml

Closes-bug: #2077511
[SEP]
FILES CHANGED:
etc/kolla/globals.yml (+1, -1)
",1.069,0.878998,-1.08166,-0.998102,-0.388564,0.102476,-0.686415,0.031158,-0.178215,-0.335382,0.278882,-0.633605,-0.463205,0.006943,0.298148
openstack/ansible-collection-kolla,I08347655533dfb49d6ecc68ec6ab415302978f2e,0,0,0.5922,3.091,0.9048,3,7.0,93,0,CI,0,0,1,179,0.017375,0.6207,0,0.3676,0,3,0,0.6875,1.41,0.0,-17.81,25.66,0,0,0.1905,1,4.2273,0,0,0,0,0,"CI: Bump ansible-core and ansible-lint
[SEP]
FILES CHANGED:
.yamllint (+0, -12)
test-requirements.txt (+2, -2)
tox.ini (+0, -5)
",1.014935,3.061881,-0.384927,0.596911,1.617264,-0.962711,-0.711692,-0.396157,-0.759124,0.125078,0.379938,0.307626,0.039327,-0.208262,0.240921
openstack/kolla-ansible,I29172448c14a1ca9a5fa23abe701366f875959e0,1,0,0.8,1.0986,0.5,1,16.0,129,0,Bug Fix,0,0,0,25,0.027809,1.0,1,0.8,4,1,0,0.6899,0.0,4.0,31.97,11.4,1,0,0.0,0,43.0,0,0,0,0,0,"Fix typo in RabbitMQ versions pinning

We don't use dots in the image name
[SEP]
FILES CHANGED:
doc/source/reference/message-queues/rabbitmq.rst (+1, -1)
",4.04733,0.036116,1.401913,0.073074,-0.628179,0.629096,1.466976,-0.309855,-0.239174,-0.239158,0.164288,-0.156309,0.152569,-0.058156,0.180085
openstack/kolla-ansible,I81d6ee944b3ed0e75129772bb993ce7a6147c3e8,0,0,0.6364,3.912,0.0,2,10.5,171,0,CI,1,0,0,55,0.015143,0.375,0,0.2386,2,2,0,0.6905,0.1437,1.5,31.01,11.82,1,1,1.0,0,3.42,0,0,0,0,0,"[CI] Add mariadb backup into mariadb scenario

We are not testing mariadb backup, let's test
it in mariadb scenario.
[SEP]
FILES CHANGED:
tests/test-mariadb.sh (+48, -0)
tests/templates/globals-default.j2 (+1, -0)
",0.589132,0.536453,-0.96428,0.841879,1.06395,0.137377,0.519113,-0.480471,-1.111049,-0.150818,0.904925,0.55213,-0.449469,-0.22815,-0.441715
openstack/kolla-ansible,I11ddfe73c79cc59a97d119091c8b9a3f5eda001d,1,0,0.625,0.6931,0.0,1,12.0,224,0,Bug Fix,0,0,0,56,0.015213,0.5385,0,0.3365,4,1,0,0.6892,0.0,4.0,-6.27,18.13,1,1,0.0,0,112.0,0,0,0,0,0,"[Trivial] Fix ironic when proxysql is enabled

This patch adds missing ironic_database_shard_id
which is used by proxysql-config role to generate
proxysql configuration.
[SEP]
FILES CHANGED:
ansible/roles/ironic/defaults/main.yml (+1, -0)
",0.162185,-0.73672,-0.561577,0.324089,0.743643,-0.300665,-0.712349,0.092765,0.023957,-0.325385,0.07193,0.070681,-0.511569,-0.281552,-0.090525
openstack/kolla-ansible,Ic92c8959972329adbd4b89c521aa87678f25b4e4,1,1,0.6316,2.1972,0.125,2,18.5,568,0,Bug Fix,0,0,0,57,0.015481,1.0,0,0.6316,4,2,0,0.6898,0.8113,3.0,25.72,16.05,1,0,0.0,1,63.1111,0,18,0,20,0,"Fix mariadb backup unable to create history table

The backup user was missing the necessary CREATE
privilege for the mariadb_backup_history table
within the mysql schema, causing backups to fail
when attempting to create this table.

This patch addresses the issue by granting the backup
user the required CREATE permission specifically for
the mariadb_backup_history table. With this change,
the backup process can now complete successfully
without manual intervention for user permissions.

Closes-Bug: #2061889
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2061889-f54e356f43c0fae3.yaml (+6, -0)
ansible/roles/mariadb/tasks/register.yml (+1, -1)
",-1.617838,-1.180055,-0.022873,0.554899,0.362896,0.237357,-0.537998,-0.007006,0.487853,0.035563,0.349662,0.288279,-0.231438,0.143458,0.180718
openstack/kolla-ansible,Ic166b8d9a500023c8d23ec9fee03b28b268b26e7,1,1,0.6379,2.3979,0.2,2,16.67,408,0,Bug Fix,0,0,0,58,0.015718,0.3333,0,0.2126,5,2,0,0.6903,0.971,3.5,19.03,18.67,1,0,0.0,1,37.0909,0,6,0,15,0,"Fix IPv6 address format in ProxySQL configuration

This patch resolves an issue where ProxySQL could not
bind due to incorrectly formatted IPv6 addresses in the
`mysql_ifaces` configuration. The kolla's
`put_address_in_context` filter is now used, ensuring
the addresses are properly enclosed in square brackets
for correct binding.

Closes-Bug: #2081106
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2081106-ef0df790780c612d.yaml (+6, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+2, -2)
",-0.631268,-1.309483,-0.101467,0.144631,0.059116,0.056868,-0.615368,0.113601,0.739933,-0.169533,-0.027903,-0.263737,-0.079664,-0.34267,0.059089
openstack/kolla,I6e726d8ebf9dbc6d019dd72d6d0be9d9957a3f22,0,0,0.6441,3.091,0.4286,5,1.86,118,0,Feature,0,0,0,59,0.015946,0.5862,0,0.3776,3,4,0,0.6886,2.1659,2.2,68.29,6.9,1,0,0.0,1,5.3636,0,0,0,0,0,"Bump proxysql to 2.7.x

This patch bump proxysql 2.6.x to 2.7.x
[SEP]
FILES CHANGED:
docker/base/proxysql.repo (+2, -2)
doc/source/contributor/versions.rst (+2, -2)
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+4, -4)
releasenotes/notes/bump-proxysql-version-aa1fb531f2b8f08a.yaml (+3, -0)
",-0.506669,2.460482,-0.981936,1.191266,1.335396,0.639107,-0.261645,0.20575,-1.021088,1.592644,0.132536,0.200083,-0.922454,0.536349,0.746956
openstack/kolla-ansible,Iaa31bae739110094affb5e402ed9ac40b153ac3d,1,0,0.8077,4.8675,0.3876,3,6.75,219,0,CI,0,0,0,26,0.028857,1.0,0,0.8077,4,2,0,0.6909,0.3511,3.33,33.92,13.07,1,0,0.0,1,1.6846,0,0,0,0,0,"Prevent accidental downgrades of RabbitMQ

As version-check.yml is added to deploy.yml, we must make sure the
tasks are only run when the rabbitmq container exists.
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+72, -50)
releasenotes/notes/rabbitmq-catch-downgrade-1005c7475a97bf19.yaml (+5, -0)
ansible/roles/rabbitmq/tasks/deploy.yml (+2, -0)
",0.962417,0.093607,-0.080281,0.802555,0.114568,-0.119446,0.896381,-0.243498,-0.33684,-0.159638,-0.078366,0.261813,-0.508192,-0.141979,0.188508
openstack/kolla-ansible,I9969492571e5e9864d4acb95b1af172264cfbd66,1,1,0.0,2.1972,0.125,2,9.0,108,0,Bug Fix,0,0,0,1,0.013889,0.5,0,0.0,4,2,0,0.6915,0.8113,3.0,-9.1,21.38,0,0,0.0,1,12.0,0,0,0,0,0,"Typo for purestorage nvme driver

Closes-Bug: #2081149
[SEP]
FILES CHANGED:
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
releasenotes/notes/bug-2081149-af26d3f8c0e44297.yaml (+6, -0)
",1.803369,-0.455856,-0.723754,-1.175399,-0.392213,0.734796,-0.845608,0.533379,-0.147706,-0.563277,0.64582,-0.053157,0.095557,-0.261678,0.341104
openstack/kolla-ansible,Ic28801519cdb35ed2387a1468b9df661847a5476,0,0,0.6333,3.2958,0.0,3,16.07,1933,0,CI,0,0,0,60,0.016125,0.5,0,0.3167,5,3,0,0.692,1.5579,3.0,8.34,17.38,1,0,0.0,1,71.5926,0,0,0,0,0,"Improvement of ProxySQL Monitoring Configuration

This update enhances the monitoring of the databasecluster
in ProxySQL. The default monitoring intervals were insufficient
for reliably detecting failures in the Galera cluster environment.

A detailed configuration for monitoring intervals has been
introduced, providing better control over how quickly and accurately
ProxySQL can identify issues.

  - Variables such as `mariadb_monitor_connect_interval`,
    `mariadb_monitor_galera_healthcheck_interval, and
    `mariadb_monitor_ping_interval` significantly reduce
    the time between connection checks.

  - Timeouts like `mariadb_monitor_galera_healthcheck_timeout`
    and `mariadb_monitor_ping_timeout` allow faster failure
    detection, while `mariadb_monitor_galera_healthcheck_max_timeout_count`
    sets the maximum number of allowed timeouts before marking a node as down.

Calculation:

 - Galera healthcheck:

   4 seconds (interval) + 1 second (timeout) + 4 seconds (interval)
   + 1 second (timeout) = 10 seconds.

 - Ping healthcheck:

   3 seconds (interval) + 2 seconds (timeout) + 3 seconds (interval)
   + 2 seconds (timeout) = 10 seconds.

Both the health check and ping check mechanisms will detect a node failure
within a maximum of 10 seconds. Both processes (health check and ping)
operate independently, and failure in either mechanism will mark the node
as failed.

Health Check Failure Detection: Up to 10 seconds.
Ping Failure Detection: Up to 10 seconds.
Connect Attempts: ProxySQL also tries to connect every 2 seconds, which
helps monitor connectivity.

These changes ensure that ProxySQL can detect issues in 10 seconds
as haproxy, significantly reducing downtime compared to default settings.
This adjustment enables faster and more reliable monitoring, improving system
stability and reducing potential downtime in production environments.
[SEP]
FILES CHANGED:
releasenotes/notes/proxysql-monitor-0adc0594c06c7362.yaml (+11, -0)
ansible/group_vars/all.yml (+8, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+7, -0)
",-3.893655,1.427553,3.45675,-0.054291,0.758889,1.003976,-1.384909,-0.643335,-0.173616,0.1098,-0.58391,0.253955,0.122863,-0.058899,0.163659
openstack/kolla,Ice2d601eddb54bbb0e7e3be6f03ba6db58256c1f,0,0,0.623,2.8904,0.0588,2,14.0,230,0,Bug Fix,0,0,0,61,0.01628,1.0,0,0.623,2,2,0,0.6861,0.9367,2.0,11.34,17.03,1,0,0.0,1,12.7778,1,0,0,0,0,"Enhance logging format for better readability

Added timestamp with milliseconds, log level, and custom
date format to improve clarity and make logs more useful
for debugging.
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+5, -1)
releasenotes/notes/kolla-container-logformat-259885637cbeb0e6.yaml (+11, -0)
",1.339858,-1.643734,0.081568,0.478972,0.270091,0.076228,0.090115,-0.365305,0.228851,0.00516,-0.966824,0.178943,0.209812,-0.498648,-0.384663
openstack/kolla-ansible,I4bbfef3a391b8582ae73cbe06138715b43584dec,0,0,0.8444,3.0445,0.15,3,8.2,363,0,Feature,0,0,0,45,0.035914,1.0,0,0.8444,4,3,0,0.6908,1.5,3.33,21.06,14.99,1,0,0.0,1,17.2857,1,0,0,0,0,"Add configuration for NTP server in Ironic Inspector DHCP server

Followup on Ib69fc0017b3bfbc8da4dfd4301710fbf88be661a. This change
adds the ability to provide the NTP (time source) server for multiple
DHCP ranges in the Ironic Inspector DHCP server.
[SEP]
FILES CHANGED:
releasenotes/notes/ironic-inspector-multiple-ranges-ntp-32568dcf640a7fc1.yaml (+5, -0)
ansible/roles/ironic/templates/ironic-dnsmasq.conf.j2 (+2, -3)
doc/source/reference/bare-metal/ironic-guide.rst (+10, -0)
",-0.080666,-1.076437,-0.94564,-0.554502,0.900658,-0.072849,0.28262,0.92737,0.241591,0.084616,-0.754201,0.517296,-0.206559,-0.28547,-0.23533
openstack/kolla-ansible,I9cc721555a6d19409b6ac24432b6b34a83efc42c,0,0,0.6129,1.0986,0.5,1,14.0,484,0,Bug Fix,0,0,0,62,0.016472,0.0,0,0.0,5,1,0,0.6895,0.0,5.0,8.32,15.6,1,0,0.0,0,161.3333,0,0,0,0,0,"Fix ProxySQL startup mode to use --initial

The ProxySQL startup script was incorrectly using
the `--reload` flag, which only reloads/merges the configuration
without initializing the database from the config file [1]. This
change corrects it to use the `--initial` flag, ensuring that
the database is always reloaded from the configuration at startup.

[1] https://proxysql.com/documentation/configuring-proxysql/#initialstartup
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/proxysql/proxysql_run.sh.j2 (+1, -1)
",-1.505447,0.032962,0.169461,1.084601,0.043657,-0.150836,0.248642,0.15725,0.084865,0.496086,0.172389,-0.059739,-0.121819,0.011466,-0.128987
openstack/octavia,Ia92fa6140b0fc608281e846d0635dd28217f2630,1,1,1.0,2.6391,0.0769,2,11.67,539,0,Bug Fix,0,0,0,1,0.055556,0.8333,0,0.8333,2,2,0,0.6057,0.9612,2.0,24.58,14.38,1,0,0.0,1,38.5,0,34,0,28,0,"Fix verification of certificates signed by a private CA

When using a certificate that was signed by a private CA (including
self-signed certs) on Neutron endpoints, certificate verification fails.

This was because the custom certificate was not used when creating
user's session even though the custom certificate file path is provided
in octavia.conf.

Fixing by feeding neutron cafile as a keyword argument.

Closes-Bug: #2046382
Co-authored-by: Ilia Kerbs <ikerbs@protonmail.com>
[SEP]
FILES CHANGED:
releasenotes/notes/fix-verification-of-private-ca-signed-certificates-b9386a0d92627b03.yaml (+5, -0)
octavia/common/clients.py (+7, -1)
",-1.13407,-1.002253,0.287309,0.060497,-0.474122,0.128848,0.016618,0.190517,0.140028,-0.085743,0.487366,0.072052,0.165049,0.210773,-0.415118
openstack/ironic,Ie1c64b4807ecf29fa0da54501798d363675977c8,1,0,0.9737,4.6151,0.16,5,11.75,356,0,Bug Fix,0,0,0,38,0.012141,0.5,0,0.4868,6,2,0,0.9583,1.7781,3.6,36.51,14.91,1,0,0.82,1,3.5248,0,0,0,0,0,"Fix double transition to INSPECTFAIL on aborting in-band inspection

Both the driver and the conductor code try to transition the node to
INSPECTFAIL, with the 2nd attempt failing. Rework the driver code to
only do implementation-specific clean-up. Also safeguard the conductor
code against this case.
[SEP]
FILES CHANGED:
ironic/drivers/modules/inspector/agent.py (+4, -4)
ironic/tests/unit/conductor/test_manager.py (+31, -11)
ironic/tests/unit/drivers/modules/inspector/test_agent.py (+40, -0)
ironic/conductor/inspection.py (+4, -1)
releasenotes/notes/inspect-abort-8add5e6e6b599357.yaml (+5, -0)
",-0.399784,-0.21993,-0.367647,1.289352,0.251794,0.591363,0.402884,-0.707307,0.163991,0.084257,0.394274,0.459315,0.220393,-0.229184,0.314581
openstack/kayobe,Id597daad620d90d30187fa74f9d21d220cafacd5,1,0,0.8833,1.0986,1.0,1,8.0,99,0,Feature,0,0,0,60,0.057748,1.0,0,0.8833,2,1,0,0.9115,0.0,2.0,-23.36,28.2,0,0,0.0,0,33.0,0,0,0,0,0,"Remove duplicate description of filename key
[SEP]
FILES CHANGED:
etc/kayobe/apt.yml (+0, -2)
",3.365227,0.668009,1.834025,1.040794,1.1575,1.133199,0.930304,-0.30429,1.224886,-0.239248,-0.506913,-0.10567,-0.035191,0.453984,-0.201153
openstack/openstack-ansible,If43d721abb978d305abba8ee01d6de2ed2bf2553,1,1,0.9545,1.3863,0.3333,1,7.44,633,0,Bug Fix,0,0,0,198,0.0545,1.0,0,0.9545,2,1,0,0.9362,0.0,2.0,-6.54,16.11,0,0,0.0,0,158.25,0,6,0,13,0,"Use node FQDN for nova-restore-compute-id

Hypervisor list for Nova get's populated with node FQDNs, which might
be completely different then nodename.

This is also reproducible in AIO, where ansible_facts['nodename'] is
`aio1`, while ansible_facts['fqdn'] is `aio1.openstack.local`.
And the fqdn is defined in hypervisor listing.

Since there could be a confusion in hostname/nodename/fqdn from
deployment to deployment, we make the fact variable configurable.

Related-Bug: #2081741
Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-openstack_hosts/+/930272
[SEP]
FILES CHANGED:
scripts/upgrade-utilities/nova-restore-compute-id.yml (+2, -1)
",-2.711119,1.326039,0.779001,0.099517,0.254447,-0.211494,0.010785,-0.003832,0.153508,-0.670119,-0.061741,-0.276398,-0.087652,-0.145908,-0.13855
openstack/kolla-ansible,Ib02389c03ab8f61fdd3827cb30fcc18f3dc952a9,1,1,0.5889,1.0986,0.5,1,5.5,369,0,Bug Fix,0,0,0,180,0.017437,0.5455,0,0.3212,4,1,0,0.6883,0.0,4.0,-48.7,13.11,0,0,0.0,0,123.0,0,0,0,0,0,"magnum: Add k8s_cluster_api_rockylinux to CAPI drivers list

It has been added in magnum-cluster-api driver in v0.15.0

[1]: https://github.com/vexxhost/magnum-cluster-api/commit/2a53f3e340524deee3ddbf08b41071fba070d7d3#diff-50c86b7ed8ac2cf95bd48334961bf0530cdc77b5a56f852c5c61b89d735fd711R53

Closes-Bug: #2047360
[SEP]
FILES CHANGED:
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -1)
",-2.611916,1.53713,-1.029093,-1.865791,1.251247,-0.192131,1.196489,0.316423,0.450285,0.151029,0.156663,0.091695,-0.119357,-0.147019,0.210653
openstack/kolla,I219418411470bdeae9af84277f5150a623c05e69,1,0,0.5912,3.6636,0.4211,6,8.0,105,0,Feature,0,0,0,181,0.01753,0.5667,0,0.335,3,4,0,0.6836,2.3633,2.17,-23.36,23.2,0,0,0.0,1,2.6923,0,0,0,0,0,"erlang/aarch64: Move to openstack-kolla owned COPR
[SEP]
FILES CHANGED:
doc/source/contributor/versions.rst (+2, -2)
docker/base/hrw-copr-erlang-for-rabbitmq.repo (+0, -11)
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+2, -2)
releasenotes/notes/copr-move-5d0464c50dc85ccf.yaml (+6, -0)
docker/base/copr-rabbitmq-erlang.repo (+11, -0)
",2.26984,0.02656,0.4416,-1.093807,-0.24124,-0.830539,0.00643,1.001814,-0.449489,-0.061879,-0.215793,0.220128,-0.318808,-0.12695,-0.100654
openstack/ansible-hardening,Ia5cea0533eb174b52009a54fceeee36b9e4dfe8b,1,1,0.8611,2.3979,0.5,1,14.5,231,0,Bug Fix,0,0,0,36,0.167442,0.9365,0,0.8064,1,1,0,1.0,0.0,1.0,22.92,14.08,0,0,0.0,0,21.0,0,6,0,15,0,"Apply architecture specific audit rules

Some audit rules do not work on arm systems, so disable this
subset when the target system is aarch64 architecture.

Closes-Bug: 2081831
[SEP]
FILES CHANGED:
defaults/main.yml (+5, -5)
",0.747932,-1.4162,-0.328148,0.217634,-0.28335,0.174329,-0.437183,-0.042127,0.148234,0.195009,-0.074619,0.147173,0.261825,-0.409681,0.040624
openstack/ansible-collection-kolla,Iafc2d1af1a4a8bc49ef4d8e592786587de6daad9,0,0,0.5934,2.8904,0.4706,4,3.67,189,0,Feature,0,0,0,182,0.017562,1.0,0,0.5934,3,2,0,0.6471,1.7922,2.75,-112.21,26.92,0,0,0.0,1,10.5,0,0,0,0,0,"Drop OpenEuler support

Following Id5e10872de413e7b476c5343360d73c109b9667a

Co-Authored-By: Maksim Malchuk <maksim.malchuk@gmail.com>
[SEP]
FILES CHANGED:
roles/packages/tasks/main.yml (+0, -1)
roles/docker/defaults/main.yml (+3, -3)
roles/packages/defaults/main.yml (+0, -4)
releasenotes/notes/drop-openeuler-55b80a861905225b.yaml (+6, -0)
",-1.128857,1.19001,-2.325308,-1.536548,0.831227,0.785159,-0.437362,-0.115063,0.017531,0.187689,0.050525,0.79407,0.00108,0.191305,-0.626714
openstack/kolla,Idf14e334d50abeb1719563b1733af0b8425b3b55,0,0,0.5902,1.7918,0.2,2,14.5,234,0,Feature,0,0,0,183,0.01763,1.0,0,0.5902,2,2,0,0.6848,0.971,2.0,20.0,18.21,0,0,0.0,0,39.0,0,0,0,0,0,"dev-mode: Run kolla_install_projects using sudo

Since packages are installed using root during image build - we
need to use sudo when updating those packages when using dev-mode.
[SEP]
FILES CHANGED:
docker/base/start.sh (+1, -1)
docker/base/sudoers (+3, -0)
",0.995401,-0.606694,-0.437719,0.598743,0.243031,-0.38426,-0.073523,-0.292167,-0.890018,-0.403244,-0.319714,0.037973,0.267322,-0.235391,0.157218
openstack/kolla,I20d8b7b6de007866f73c41272682f4532987c9e7,1,0,0.587,2.5649,0.0833,3,16.0,232,0,CI,1,0,0,184,0.017718,0.8333,0,0.4891,2,2,0,0.6823,1.325,1.67,58.41,15.15,0,0,1.0,0,17.8462,0,0,0,0,0,"CI: Build aarch64 images on x86

Since aarch64 OpenDev nodes currently have issues
that cause builds to time out (and we can't extend
over 3 hours since that's OpenDev maximum).
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+1, -0)
.zuul.d/debian.yaml (+4, -1)
tests/playbooks/pre.yml (+6, -0)
",1.16024,-1.114,0.004359,-0.179471,-0.259294,0.322821,-0.170642,-0.523415,-0.87203,0.309665,-0.490605,0.112657,0.1607,-0.424716,0.166972
openstack/kolla,Icc810554dc877c9dedaf26609d59a93059a38ba7,1,0,0.5517,3.3322,0.963,3,4.75,269,0,Bug Fix,0,1,0,29,0.056311,1.0,0,0.5517,3,3,0,0.6835,1.3516,2.67,-25.07,12.43,0,0,0.0,1,9.6071,0,0,0,0,0,"Revert ""Pin OpenSearch Dashboards to 2.15""

This reverts commit 3c49991a86cb26dd0447fa748d1df9df5aed92bb.

Reason for revert: bug fixed upstream https://github.com/opensearch-project/OpenSearch-Dashboards/pull/8097
[SEP]
FILES CHANGED:
docker/opensearch/opensearch-dashboards/Dockerfile.j2 (+1, -14)
releasenotes/notes/bug-2077319-a47a06175a589a1a.yaml (+0, -9)
docker/opensearch/opensearch-dashboards/apt_preferences_opensearch_dashboards (+0, -3)
",-0.693145,2.072426,-2.32177,-0.847742,0.422815,0.674511,0.3667,-0.063871,0.027837,0.083777,-0.156227,-0.054799,0.078225,-0.192626,0.083136
openstack/kayobe,I4da3a3739d57817ffbd094caea0fc80c3ad8eff8,1,1,1.0,2.9444,0.1111,2,15.5,217,0,Bug Fix,0,0,0,3,0.022222,0.0,0,0.0,4,2,0,0.9123,0.9641,3.0,41.01,13.94,1,0,0.0,1,11.4211,0,10,0,8,0,"Get the list of ironic nodes - use correct scope

Use correct system scope - all - while getting the list of ironic
nodes in ipa-images role.

Closes-Bug: #2083014
[SEP]
FILES CHANGED:
ansible/roles/ipa-images/tasks/set-driver-info.yml (+9, -2)
releasenotes/notes/bug-2083014-set-driver-info-86ff04d3d32cdb8c.yaml (+7, -0)
",1.368212,-1.223141,0.049889,0.025187,-0.17297,-0.330931,-0.06321,0.081734,-0.026952,-0.450889,-0.321985,-0.002581,0.539149,0.260462,0.008432
openstack/octavia,Ifecc4c8a3dcbf0d1d789ecbb606bfdb7fb0f4f3d,0,0,0,2.4849,1.0,1,20.0,1078,0,Bug Fix,1,0,0,0,0.0,0.0,0,0.0,1,1,0,0.6068,0.0,1.0,10.08,16.57,0,0,1.0,0,89.8333,0,0,0,0,0,"Fix image-tests.sh script error
""ERROR: Amphora image is in the wrong format (should be installed)""

The script fails for every image build test. This is due to the verification used to check the builded image format :

virt-inspector --xpath '/operatingsystems/operatingsystem/format' | grep -q '<format>installed</format>'

The parameter '/operatingsystems/operatingsystem/format' no longuer exists in newer versions of virt-inspector package,
which causes the script to display the error message :""ERROR: Amphora image is in the wrong format (should be installed)"".

I fixed the problem by deleting the whole section. Logically, if the packages ""HAProxy"" and ""KeepAlived"" are present in the builded image, this implies directly that the builded image is in the installed format.
The presence of those packages is checked by the output of the argument :  '/operatingsystems/operatingsystem/applications/application/name[text()=""haproxy""]'

The change has been tested on different verions of Openstack and works perfectly.
[SEP]
FILES CHANGED:
diskimage-create/image-tests.sh (+0, -11)
",-3.414116,0.737396,2.748337,-0.00354,0.007601,-0.105094,0.389908,0.123184,-0.126595,-0.373426,0.352061,0.106163,-0.126723,0.235108,-0.089467
openstack/kolla,I3ba85069c265844bd2f8b5e6d2b14f32e4898cfd,1,0,0.6032,0.6931,0.0,1,8.43,581,0,CI,0,0,0,63,0.016729,0.5278,0,0.3183,2,1,0,0.6846,0.0,2.0,-25.41,16.93,0,0,0.0,0,290.5,0,0,0,0,0,"Added systemd-standalone-sysusers package for Debuntu

This package provides a standalone sysusers binary with
minimal dependencies, designed for use in non-systemd
environments.

This package simply ensures that all packages that want
to install systemd as dependency will have to settle for
this one because the systemd package breaks
systemd-standalone-sysusers, as it is an alternative.

[1] https://packages.debian.org/bookworm/systemd-standalone-sysusers
[2] https://packages.ubuntu.com/noble/systemd-standalone-sysusers
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -0)
",-2.5348,0.96477,-0.151073,0.750026,0.36499,-0.644925,0.091139,-0.038776,-0.471589,0.044178,0.014813,0.255493,0.422267,0.140541,0.285429
openstack/kolla-ansible,I4172cf1d49e9f988cbf2bbe3c3f6835f0de4944d,0,0,0.6094,1.6094,0.5,2,17.5,559,0,Doc,0,0,0,64,0.01699,1.0,0,0.6094,4,1,0,0.6888,1.0,4.0,6.58,20.14,1,0,0.0,0,111.8,0,0,0,0,0,"Update MySQL monitor user privileges for ProxySQL monitoring

The MySQL monitor user privileges were updated to include
the REPLICATION CLIENT privilege in addition to USAGE in
order to align with ProxySQL documentation [1].
This change ensures that the monitor user can check replication
lag, as previously only the USAGE privilege was granted,
which was sufficient for basic connection and read-only
checks but not for replication monitoring.

[1] https://proxysql.com/documentation/backend-monitoring/
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/loadbalancer.yml (+1, -1)
ansible/roles/mariadb/tasks/register.yml (+1, -1)
",-1.601862,-0.271948,0.192762,1.227684,0.079992,0.015881,0.046959,0.534358,0.57951,0.379678,-0.080056,0.328142,0.062748,-0.370492,-0.10105
openstack/kolla,If615c27f3cdf779b773f333845419d09a552aa9b,1,0,0.5892,2.7726,0.2,3,10.0,218,0,CI,1,1,0,185,0.017794,1.0,0,0.5892,1,1,0,0.6857,1.585,1.0,27.49,12.0,0,0,1.0,0,13.625,0,0,0,0,0,"Revert ""CI: Disable CentOS/Rocky/Ubuntu aarch64 jobs""

This reverts commit fd4f1a8a82686bd0766526f007620ad8217b42e5.

Reason for revert: Switching to builds on x86
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+4, -1)
.zuul.d/ubuntu.yaml (+4, -1)
.zuul.d/rocky.yaml (+4, -1)
",0.359449,-0.25698,-1.843042,-1.560276,0.711427,0.528205,0.913047,0.137009,0.092815,0.007892,-0.025753,0.13206,0.007581,-0.088454,-0.172962
openstack/kolla-ansible,I85982366d97e40d0e6ba97ce4c4c1ddd2c10b749,0,0,0.5914,1.0986,0.5,1,9.0,103,0,CI,1,0,0,186,0.017864,0.3846,0,0.2275,1,1,0,0.6876,0.0,1.0,-18.5,25.82,0,0,1.0,0,34.3333,0,0,0,0,0,"CI: Build skyline images in skyline-sso scenario
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",2.752298,0.613413,1.33906,-0.366216,0.496783,-0.227327,-0.249999,0.248515,-0.082553,-0.449794,-0.058836,0.24052,0.684587,0.339194,0.105414
openstack/kolla,I5c69d288a427d708b42deadac872a3a7368181e3,0,0,0.5882,1.7918,0.4,2,9.0,90,0,Bug Fix,1,0,0,187,0.017957,0.7778,0,0.4575,2,2,0,0.6868,0.7219,1.5,28.5,12.49,0,0,1.0,0,15.0,0,0,0,0,0,"CI: Fix aarch64 publish jobs on x86
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+2, -2)
.zuul.d/base.yaml (+1, -0)
",2.994478,0.053004,1.459173,-0.729787,0.334601,-0.173894,-0.136491,0.456628,-0.534751,0.519298,-0.279368,-0.350717,0.399443,-0.248505,0.133011
openstack/kolla,Ic7cb4e97deb04a82fd73238adbe5b4b74a6a50a0,0,0,0.5851,2.5649,0.25,2,2.33,84,0,Feature,0,0,0,188,0.018044,0.4,0,0.234,2,2,0,0.6844,1.0,2.0,-13.08,12.36,0,0,0.0,1,6.4615,0,0,0,0,0,"etcd: Bump version to v3.5.16
[SEP]
FILES CHANGED:
kolla/common/sources.py (+3, -3)
releasenotes/notes/etcd-3.5-30f3c030fd5296a9.yaml (+6, -0)
",1.883898,1.525062,0.347477,-0.208242,0.141041,0.53062,0.326215,0.760305,-0.260674,1.656134,-0.14477,0.371752,-1.006,0.802175,0.516576
openstack/kolla-ansible,I972608b81edb2f5c118cf9a2f734f83ea399a849,1,0,0.6,0.6931,0.0,1,10.0,106,0,Bug Fix,1,0,0,65,0.017237,0.36,0,0.216,2,1,0,0.6864,0.0,2.0,19.03,20.0,0,1,1.0,0,53.0,0,0,0,0,0,"[CI] Fix OVN jobs - add required neutron_dns_domain
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -0)
",1.215948,1.021658,0.126236,0.511211,1.451858,-0.139435,-0.66244,0.348962,-0.20974,-0.26614,0.045802,-0.537889,-0.024181,-0.443478,-0.491429
openstack/kolla,I4febdf6b391bb7320ea30e1ca71fed81e332021d,0,0,0.582,2.3979,0.1,4,17.0,180,0,Bug Fix,0,0,0,189,0.018119,1.0,0,0.582,3,2,0,0.682,1.9219,1.5,20.38,16.21,0,0,0.6,0,16.3636,0,0,0,0,0,"CI: Fix aarch64 builds on x86 after switching to role

bf04bd90a15e7d3949214d15a8b8e25f2050bb65 omitted the --platform
option
[SEP]
FILES CHANGED:
roles/kolla-build/tasks/main.yml (+3, -1)
.zuul.d/centos.yaml (+2, -0)
.zuul.d/ubuntu.yaml (+2, -0)
.zuul.d/rocky.yaml (+2, -0)
",0.312964,-0.670653,-1.675512,-2.0773,1.537511,0.035649,0.119617,-0.275147,-0.042193,0.511389,-1.008068,0.378195,-0.151216,-0.177568,0.357107
openstack/kolla,Ieb413f7a4bd1989d7f29309368b6b218d1395e0b,1,0,0.5667,1.0986,0.5,1,8.5,134,0,Bug Fix,0,0,0,30,0.055351,0.5,0,0.2833,2,1,0,0.6796,0.0,2.0,73.8,10.46,0,0,0.0,0,44.6667,0,0,0,0,0,"aarch64: fix name of rabbitmq copr repo

it should be the same as in repos.yaml
[SEP]
FILES CHANGED:
docker/base/copr-rabbitmq-erlang.repo (+1, -1)
",1.800196,-0.566932,0.067353,-0.43586,-0.458873,-0.463571,0.758757,-0.271716,-0.893034,-0.103384,0.336196,-0.360277,-0.969415,0.447219,-0.137412
openstack/kolla,I3eea308a0a70e47dd3b185eece106185b25616f5,1,1,0.5806,1.9459,0.1667,1,16.0,262,0,Bug Fix,0,0,0,31,0.056985,0.5,0,0.2903,3,1,0,0.6807,0.0,3.0,13.46,22.65,0,0,0.0,0,37.4286,0,6,0,11,0,"aarch64: Exclude syslinux from ironic conductor packages

The 'syslinux' package is not available on aarch64, so it is only
included in the ironic conductor packages for x86_64 systems.

Related-Bug: #1749780
[SEP]
FILES CHANGED:
docker/ironic/ironic-conductor/Dockerfile.j2 (+5, -1)
",0.371387,-0.469176,-0.561988,0.322806,-0.078777,0.174492,-0.068367,0.041705,-0.129978,0.071339,-0.055653,0.086307,0.239432,-0.294786,0.063697
openstack/charm-ceph-osd,Ic9f6c5260e1396980b7a5316484ca5e970172de9,0,0,0.9167,0.6931,0.0,1,7.88,551,0,Doc,0,0,0,12,0.00385,0.7143,0,0.6548,2,1,0,0.8182,0.0,2.0,5.47,15.21,1,0,0.0,0,275.5,0,0,0,0,0,"Add antelope to the UCA codename map

According to https://docs.openstack.org/charm-guide/latest/project/charm-delivery.html#tracks-for-the-openstack-charms-project
quincy is the supported release for OpenStack 2023.1 (antelope),
so antelope must be included in the UCA codename map.

Otherwise the charm cannot determine correctly what action
should be taken after upgrading the `source` to antelope.
This can result in the charm potentially attempting to upgrade
to version `None` and crashing.
[SEP]
FILES CHANGED:
lib/charms_ceph/utils.py (+1, -0)
",-1.758088,1.539768,-0.417538,0.945397,0.17579,0.101056,0.393403,-0.134598,0.331511,-0.090977,0.010719,0.63174,-0.103715,-0.062481,-0.13063
openstack/kolla-ansible,I9b33e5d0a9a4094ccf8a32e5562ab10f577487b3,1,0,0.8852,2.1972,0.0,1,8.0,95,0,Doc,0,0,0,61,0.058598,1.0,1,0.8852,3,1,0,0.6869,0.0,3.0,-44.51,23.2,1,0,0.0,0,10.5556,0,0,0,0,0,"Document dev mode with custom repository
[SEP]
FILES CHANGED:
doc/source/contributor/kolla-for-openstack-development.rst (+8, -0)
",3.664998,0.361328,2.350691,0.37371,0.083378,0.332322,0.879906,1.1592,0.295855,-0.528626,-0.582585,-0.12579,0.176203,0.005482,-0.287119
openstack/kolla,I0ce9e907594fd160a08ad7929d5bc4bca9abf536,0,0,0.5789,4.0604,0.5614,6,4.67,201,0,Feature,0,0,0,190,0.018197,0.6364,0,0.3684,2,4,0,0.6818,2.4571,2.0,-81.92,21.87,1,0,0.2456,1,3.4655,0,0,0,0,0,"CentOS/Rocky: use CentOS Cloud SIG repo instead of Delorean (Dalmatian)

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/933312
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+2, -14)
docker/base/ci-centos.repo (+8, -0)
releasenotes/notes/rdo-dalmatian-bab7a517c219cb23.yaml (+5, -0)
tests/templates/template_overrides.j2 (+1, -13)
docker/base/ci-rocky.repo (+8, -0)
kolla/common/config.py (+1, -5)
",0.158711,2.874499,-1.720333,-0.220258,-1.169278,0.191161,0.397492,0.123825,-0.490762,-0.846332,-0.206575,0.097066,0.248476,-0.420203,-0.338075
openstack/kolla,I5f2177b7c2edc0e35ed2e8e9bdfc4be2f262309f,0,0,0.5759,2.7726,0.4667,5,5.0,71,0,CI,0,0,1,191,0.018194,0.6102,0,0.3514,2,2,0,0.6794,2.2566,1.6,-35.12,18.0,1,0,0.1333,0,4.4375,0,0,0,0,0,"CI: bump hacking
[SEP]
FILES CHANGED:
kolla/template/methods.py (+2, -1)
test-requirements.txt (+1, -1)
kolla/image/kolla_worker.py (+2, -2)
kolla/common/sources.py (+2, -2)
kolla/hacking/checks.py (+1, -1)
",4.479011,1.901769,2.400044,-0.326258,0.024722,1.272177,-0.246727,-0.372242,0.594412,0.193385,0.045842,-0.550152,0.777056,0.254359,0.341292
openstack/kayobe,I973c6484ccd2a36990cf39df102e65be0376f08c,1,1,0.8148,2.0794,0.0,2,5.25,445,0,Bug Fix,0,0,0,27,0.026214,0.8333,0,0.679,2,2,0,0.913,0.8631,1.5,0.08,13.53,0,0,0.0,1,55.625,0,6,0,12,0,"Adds support for using Cumulus switches with NGS

Support for NCLU was added in Networking Generic Switch in the Zed
release[1].

Support for NVUE was added in Networking Generic Switch in the
2023.2 release[2].

[1] https://review.opendev.org/c/openstack/networking-generic-switch/+/743269
[2] https://review.opendev.org/c/openstack/networking-generic-switch/+/907551

Closes-Bug: #2083840
[SEP]
FILES CHANGED:
releasenotes/notes/cumulus-support-ngs-c4a6e6f3d45f5783.yaml (+5, -0)
ansible/kolla-openstack.yml (+2, -0)
",-1.929396,3.134464,-0.487947,0.563369,-0.408022,0.404562,0.27446,0.543306,0.079982,0.291978,0.30916,0.310065,0.19884,-0.12057,0.078863
openstack/kayobe,I43295cd21fc4947fa877aa242070e3c132532fab,1,1,0.8871,2.8904,0.0588,3,3.42,412,0,Bug Fix,0,0,0,62,0.059104,0.9167,0,0.8132,2,2,0,0.9138,1.3793,1.33,7.34,11.12,1,0,0.0,1,22.8889,0,6,0,7,0,"Bump stackhpc.linux to v1.3.0

Release 1.3.0 of stackhpc.linux fixes configuration of kernel parameters
for IOMMU when the GRUB_CMDLINE_LINUX_DEFAULT variable is absent from
/etc/default/grub.

Include a release note about a notable change in the sriov role.

[1] https://github.com/stackhpc/ansible-collection-linux/releases/tag/v1.3.0

Closes-Bug: #2083874
[SEP]
FILES CHANGED:
releasenotes/notes/bump-stackhpc-linux-1.3.0-892bc5ae7574508b.yaml (+9, -0)
releasenotes/notes/handle-missing-grub-cmdline-linux-default-f4079def0b1357e7.yaml (+6, -0)
requirements.yml (+1, -1)
",-1.630574,1.263979,-0.302632,0.110099,-0.396794,-0.300433,0.150656,0.800478,0.143605,0.245451,0.00458,-0.241898,-0.263386,0.16916,0.310295
openstack/kolla-ansible,I3ae03aa2e09bc445f0f5a95a43bf210f06685cc1,1,1,0.5729,2.3979,0.1,2,14.0,347,0,Bug Fix,0,0,0,192,0.018263,0.8,0,0.4583,4,2,0,0.6875,0.7219,3.0,47.6,12.27,0,0,0.0,1,31.5455,0,12,0,9,0,"ovn: Fix FQDN-based deployments

Since [1] Neutron puts requested-chassis entry with a name taken
from the agent, which results in FQDN-based name on FQDN-based
deployments. It does not match what we set in hostname in OVS.

[1]: I4e3c001dd3bb37b86fda8b9495a3c5178c3e736d

Closes-Bug: #2080552
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/defaults/main.yml (+1, -1)
releasenotes/notes/bug-2080552-714078144170a5bd.yaml (+8, -0)
",-0.128279,-0.606171,-0.27077,-0.860974,0.28208,-0.194677,1.224949,0.5177,0.256725,0.171293,0.231714,-0.242889,0.394432,0.150415,-0.17356
openstack/openstack-ansible-rabbitmq_server,Ie453f327850f9c9ae54823c17b0292517fa56a82,1,0,0.9548,1.0986,0.0,1,11.86,631,0,Feature,0,0,0,199,0.05473,1.0,0,0.9548,1,1,0,0.8462,0.0,1.0,34.77,11.97,0,0,0.0,0,210.3333,0,0,0,0,0,"Proceed with installation/upgrade even if cluster not healthy

At the moment rabbitmq_upgrade flag is being used on unhealthy
clusters to repair them. However with change [1] we've introduced
running this task standalone very early during the playbook.

In case cluster is unhelathy - there is no good way to repair it anymore
as
`rabbitmqctl cluster_status` might fail right away with.

So let's ignore failures at this point and run feature_flags only if
we were successfull on fetching the status.

[1] https://review.opendev.org/q/Idf33b6810e1afb3a89dad5e65a48e86ac0a58a67
[SEP]
FILES CHANGED:
tasks/rabbitmq_feature_flags.yml (+2, -0)
",-2.01224,-0.664744,1.009868,-1.014471,-0.060161,0.023158,0.427788,-0.553693,-0.083977,0.079072,0.078023,-0.113439,-0.303686,-0.149038,-0.002446
openstack/ironic,I156ba389e437c49ae75411cfbf0e29bcd54733bc,1,1,1.0,2.9957,0.0526,3,9.0,115,0,Bug Fix,0,0,0,1,0.111111,1.0,0,1.0,6,1,0,0.9587,1.087,4.67,-18.5,25.82,1,0,0.7368,0,5.75,0,14,0,8,0,"Gracefully handle bad request exception

Closes-Bug: #1619235
[SEP]
FILES CHANGED:
ironic/api/controllers/v1/portgroup.py (+2, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+14, -0)
ironic/api/controllers/v1/node.py (+2, -1)
",1.888643,-0.737562,-0.351837,-1.162991,-0.652132,1.078918,-1.103834,0.151953,0.581644,-0.090993,0.569608,0.120406,0.09841,-0.337426,0.257365
openstack/ansible-collection-kolla,I75be15fd24aeedf54bb22b9744bc0ee498a62645,0,0,0.5751,5.2933,0.4949,20,16.0,158,0,Bug Fix,0,0,0,193,0.018341,1.0,0,0.5751,3,1,0,0.6111,3.9646,3.0,5.53,18.9,0,0,0.0,0,0.794,0,0,0,0,0,"Adapt code in preparation for ansible-lint bump

Rename True/False to true/false
Fix permissions values
[SEP]
FILES CHANGED:
roles/podman/tasks/install.yml (+2, -2)
roles/baremetal/defaults/main.yml (+3, -3)
roles/docker/tasks/install.yml (+4, -4)
roles/podman/tasks/config.yml (+12, -12)
roles/docker/defaults/main.yml (+1, -1)
roles/docker_sdk/defaults/main.yml (+2, -2)
roles/baremetal/tasks/configure-ceph-for-zun.yml (+4, -4)
roles/baremetal/tasks/post-install.yml (+2, -2)
roles/docker/tasks/repo-Debian.yml (+10, -10)
roles/docker/tasks/repo-RedHat.yml (+4, -4)
roles/docker/tasks/configure-containerd-for-zun.yml (+4, -4)
roles/podman_sdk/tasks/main.yml (+6, -5)
roles/docker/handlers/main.yml (+5, -5)
roles/docker_sdk/tasks/main.yml (+8, -7)
roles/apparmor_libvirt/tasks/remove-profile.yml (+1, -1)
roles/baremetal/tasks/install.yml (+3, -3)
roles/docker/tasks/config.yml (+16, -16)
roles/etc_hosts/tasks/etc-hosts.yml (+6, -6)
roles/podman_sdk/defaults/main.yml (+2, -2)
roles/kolla_user/tasks/main.yml (+5, -5)
",1.887606,0.150132,0.326825,-0.138408,0.493615,-0.238067,-0.22077,-0.53768,-0.165047,-0.087607,-0.165113,-0.196606,0.114996,0.00405,-0.155606
openstack/kolla-ansible,I3b44c8f4ff3c55023d8bab4e9a88a86ca72cae5d,1,1,1.0,2.5649,0.1667,2,11.0,146,0,Bug Fix,0,0,0,3,0.085714,0.3571,0,0.3571,4,2,0,0.6881,0.9183,3.0,-58.13,22.58,1,0,0.0,1,11.2308,0,6,0,16,0,"Fix health checks for neutron_ovn_agent and neutron_ovn_metadata_agent

Closes-Bug: #2084128
[SEP]
FILES CHANGED:
releasenotes/notes/fix_ovn_agents_hc-f6e4a39b9d64e9f1.yaml (+8, -0)
ansible/roles/neutron/defaults/main.yml (+2, -2)
",0.146042,0.766736,-1.916818,-0.305409,1.052151,0.585948,-1.226636,-0.065279,-0.291968,-0.741688,0.793644,-0.269379,-0.304286,-0.148095,0.321772
openstack/kolla,Ife426c073048ff27bdfd9f3af30aaaab8c2e4497,1,1,1.0,2.1972,0.0,3,12.0,129,0,Bug Fix,0,0,0,4,0.085106,0.6667,0,0.6667,3,2,0,0.6771,1.0613,2.67,-9.79,21.47,1,0,0.0,1,14.3333,0,0,0,0,0,"Fix missing tss user in Ubuntu/Debian nova containers

Closes-Bug: #2067050
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+1, -0)
releasenotes/notes/fix_nova_tpm_user-98f56190196a00d2.yaml (+6, -0)
docker/nova/nova-compute/Dockerfile.j2 (+1, -0)
",2.010008,0.416343,-0.304351,-0.884893,-0.084388,0.626977,-0.352246,0.498686,-0.271951,-0.425655,0.529363,0.032656,0.472483,-0.373026,0.342118
openstack/kolla,I02f3adf9825636e2b81c50543d6f95ea986019b6,1,0,0.5722,4.7362,0.0088,6,4.0,118,0,Feature,0,0,0,194,0.018095,0.0,0,0.0,3,3,0,0.6782,2.3974,2.83,-51.02,26.6,1,0,0.0,0,1.0351,0,0,0,0,0,"Add Valkey
[SEP]
FILES CHANGED:
docker/valkey/valkey-sentinel/extend_start.sh (+32, -0)
kolla/common/users.py (+5, -1)
docker/valkey/valkey-base/Dockerfile.j2 (+17, -0)
docker/valkey/valkey-server/Dockerfile.j2 (+23, -0)
docker/valkey/valkey-sentinel/Dockerfile.j2 (+26, -0)
docker/valkey/valkey-base/extend_start.sh (+9, -0)
",5.269918,2.669142,2.491129,0.183217,0.154933,1.574027,0.844017,-0.099077,0.92761,-0.255689,-0.317775,-0.575164,0.307491,0.607911,-0.609578
openstack/kolla-ansible,I65d058842fb1bdfccc41f5d7b5a175cdf4ef4969,1,0,0.8889,1.9459,0.5,1,7.5,124,0,Bug Fix,0,0,0,63,0.059099,0.0,1,0.0,3,1,0,0.6886,0.0,3.0,41.3,13.67,1,0,0.0,0,17.7143,0,0,0,0,0,"Fix reference to generating a private CA

Also fix a typo while here.
[SEP]
FILES CHANGED:
doc/source/admin/tls.rst (+3, -3)
",2.647552,-1.850221,1.366854,-0.405085,-0.716388,0.532197,0.503357,-0.404432,0.113397,0.456725,0.1164,-0.361118,0.180613,0.27862,-0.2067
openstack/kolla-ansible,Ib67b80fce34f956cb6a54724836b8250e419c0be,0,1,1.0,2.1972,0.125,2,6.83,342,0,Bug Fix,0,0,0,2,0.064516,0.0,0,0.0,4,2,0,0.6892,0.8113,3.0,24.51,17.37,1,0,0.0,1,38.0,0,10,0,10,0,"Use bootstrap.yml on upgrade instead of bootstrap_service.yml

There is a bug that upgrading Octavia from 2023.1 to later
release fails because Octavia persistence database user is
missing.

This ensures creating Octavia persistence database user on
service upgrade.

Closes-Bug: #2065591
[SEP]
FILES CHANGED:
ansible/roles/octavia/tasks/upgrade.yml (+1, -1)
releasenotes/notes/fix-octavia-service-upgrade-9610e35cfdd512f6.yaml (+6, -0)
",-0.315425,-0.409688,-0.562308,0.267352,-0.060272,0.223739,0.072071,0.313351,-0.143522,-0.155155,0.50354,-0.033261,-0.143248,0.150928,0.315398
openstack/openstack-ansible-os_neutron,I28c928362ef009c1b49673005463b653d038faf9,1,0,0.955,1.7918,0.6,1,11.17,577,0,Feature,0,0,0,200,0.054975,0.8,0,0.764,1,1,0,0.9048,0.0,1.0,19.99,15.21,0,0,0.0,0,96.1667,0,0,0,0,0,"Ensure that services that intended to stay disabled are not started

This mainly affects neutron-rpc-server service, which intended to stay
disabled/stopped.

While we've introduced logic in vars, which is respected by systemd role
it is not respected by the role handlers, which brings service back up
running unconditionally.

This actually breaks neutron behaviour after merging of [1], which relies
on neutron-rpc-server being disabled.

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_neutron/+/927881
[SEP]
FILES CHANGED:
handlers/main.yml (+2, -3)
",-1.652128,-0.306107,0.416269,0.045179,-0.542806,-0.497055,0.256132,0.039468,-0.159955,-0.017159,0.034892,0.027877,-0.098411,-0.164678,-0.056457
openstack/kolla-ansible,Ic631a9c87f7be30f7694706928d9ede62015ed6d,1,1,0.0,2.3026,0.0,3,6.33,199,0,Bug Fix,0,0,0,1,0.019608,0.5,0,0.0,4,3,0,0.6879,1.3516,3.33,0.04,17.27,1,0,0.0,1,19.9,0,6,0,7,0,"Add logrotate config for redis

Add missing logrotate config for redis.

Closes-Bug: 2084523
[SEP]
FILES CHANGED:
ansible/roles/common/templates/cron-logrotate-redis.conf.j2 (+3, -0)
ansible/roles/common/tasks/config.yml (+1, -0)
releasenotes/notes/bug-2084523-a02f38eecf6c957a.yaml (+5, -0)
",0.688173,-0.998767,-0.708158,-0.015508,0.494658,0.241508,-1.020922,0.119614,-0.044023,0.032703,-0.022955,-0.323242,0.210821,0.012638,-0.043985
openstack/kolla-ansible,I70becdc3fcb4ca8f7ae31d26097d95bdc6dd67eb,0,0,0.6061,3.3322,0.0,3,15.67,376,0,CI,0,0,0,66,0.017497,0.4,0,0.2424,5,3,0,0.6885,1.3743,3.0,23.53,18.18,1,0,0.0,1,13.4286,0,0,0,0,0,"Adjust ProxySQL shunning behavior for single-node clusters

In single-node clusters, ProxySQL shuns the server on MySQL
errors, causing failures during upgrades or container restarts.
This change increases the timeout to 10 seconds, allowing
the backend time to recover and preventing immediate errors
in CI environments.
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+14, -0)
releasenotes/notes/proxysql-option-shun-on-failures-559781bbee1235e2.yaml (+10, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+3, -0)
",-0.273117,-1.059308,-0.256926,1.177698,0.162229,0.443558,0.155115,0.065922,0.284221,0.093862,-0.211269,0.592052,0.567213,-0.537793,-0.014872
openstack/kolla-ansible,Ie2b0b2d5fca7b9d7c613a67a134c4650de2a5af6,0,0,0.5744,1.0986,0.5,1,10.0,95,0,CI,0,0,0,195,0.017999,0.3902,0,0.2241,2,1,0,0.6873,0.0,2.0,10.56,20.0,0,0,0.0,0,31.6667,0,0,0,0,0,"CI: Switch to use noble images on Ubuntu
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",2.48258,1.199723,0.854621,0.619821,0.481968,0.642662,0.378185,-0.181226,-0.933722,0.581448,0.546152,-0.33438,0.900238,-0.264023,-0.105665
openstack/charm-ceph-mon,If1b0595446d78fe451ce331d968b5d653f027291,1,1,0.9375,2.5649,0.6667,2,8.0,240,0,Bug Fix,0,0,0,48,0.004366,1.0,0,0.9375,1,1,0,0.9231,0.8113,1.0,-2.21,18.2,1,0,0.25,0,18.4615,0,8,0,10,0,"Fix: add scrape configs on non-leaders as well

Also remove deprecated network_get patch in unit testing

Closes-bug: #2084663
[SEP]
FILES CHANGED:
src/ceph_metrics.py (+3, -6)
unit_tests/test_ceph_metrics.py (+1, -2)
",1.664403,-0.477628,-0.326204,-0.888613,-0.266077,0.419985,-0.592653,-0.450032,-0.089088,-0.394666,0.227761,-0.277301,0.410097,-0.123976,0.230345
openstack/charm-ceph-mon,If1b0595446d78fe451ce331d968b5d653f027291,1,1,0.9388,2.5649,0.6667,2,8.0,240,0,Bug Fix,0,0,0,49,0.004452,1.0,0,0.9388,1,1,0,0.925,0.8113,1.0,-2.21,18.2,1,0,0.25,0,18.4615,0,8,0,10,0,"Fix: add scrape configs on non-leaders as well

Also remove deprecated network_get patch in unit testing

Closes-bug: #2084663
[SEP]
FILES CHANGED:
src/ceph_metrics.py (+3, -6)
unit_tests/test_ceph_metrics.py (+1, -2)
",1.664403,-0.477628,-0.326204,-0.888613,-0.266077,0.419985,-0.592653,-0.450032,-0.089088,-0.394666,0.227761,-0.277301,0.410097,-0.123976,0.230345
openstack/charm-ceph-mon,If1b0595446d78fe451ce331d968b5d653f027291,1,1,0.94,2.3026,0.6667,1,5.33,182,0,Bug Fix,0,0,0,50,0.004538,1.0,0,0.94,1,1,0,0.9268,0.0,1.0,-10.08,19.63,1,0,0.0,0,18.2,0,8,0,10,0,"Fix: add scrape configs on non-leaders as well

Closes-bug: #2084663
[SEP]
FILES CHANGED:
src/ceph_metrics.py (+3, -6)
",1.664403,-0.477628,-0.326204,-0.888613,-0.266077,0.419985,-0.592653,-0.450032,-0.089088,-0.394666,0.227761,-0.277301,0.410097,-0.123976,0.230345
openstack/ironic,I2e84aa285b5673bcc911d35439ba80a739460f59,1,0,0.9744,5.8111,0.4685,5,14.5,408,0,CI,0,0,0,39,0.012074,1.0,0,0.9744,6,2,0,0.959,1.6073,4.4,41.88,14.08,1,0,0.7868,1,1.2216,0,0,0,0,0,"Actually ignore [inspector]power_off with fast track

The option's help says that the option is ignored when fast track is on,
but in reality it only happens with the legacy inspection.

The clean-up logic diverges between the two inspection implementation,
so change the new implementation to reuse the old clean-up code.

Add a few missing unit tests.
[SEP]
FILES CHANGED:
ironic/drivers/modules/inspector/agent.py (+2, -21)
releasenotes/notes/inspect-off-099e3c73edaf6082.yaml (+9, -0)
ironic/drivers/modules/inspector/interface.py (+20, -19)
ironic/tests/unit/drivers/modules/inspector/test_agent.py (+49, -3)
ironic/tests/unit/drivers/modules/inspector/test_interface.py (+97, -113)
",-0.823483,-1.785204,-0.232943,1.070836,-0.221961,0.188779,0.371141,-0.589582,-0.212758,0.46013,0.26009,-0.020569,0.180037,-0.144989,0.168045
openstack/ironic-python-agent,Ie4e62a378dc4a2089944f4302df3a8671b7c960f,1,1,0.975,4.2047,0.0303,2,19.67,390,0,Bug Fix,0,0,0,40,0.011226,1.0,0,0.975,4,1,0,0.9333,0.866,3.0,56.39,13.97,1,0,0.7121,0,5.8209,0,6,0,12,0,"Warn when the provided checksum algorithm does not match the detected

I have a case where a user provided the checksum URL with SHA256
checksums, while Metal3 defaulted os_hash_algo to ""md5"". We're going
to change the Metal3 defaults in the next API version, but for now let
us issue a clear warning in such case.

Closes-Bug: #2085331
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/extensions/test_standby.py (+45, -2)
ironic_python_agent/extensions/standby.py (+19, -0)
",-0.306359,-1.062736,-0.231356,0.338592,-0.181856,0.193522,0.417493,-0.376307,0.061981,0.207628,0.507482,-0.198604,-0.007726,-0.340538,0.491375
openstack/kolla-ansible,I6c5734b6fff1bd42929851a263620bb4d959ac25,0,0,0.3846,6.8469,0.2926,4,5.0,212,0,Doc,0,0,0,13,0.002331,0.2,0,0.0769,2,2,0,0.6861,1.4282,1.25,15.64,18.0,1,0,0.617,0,0.2253,0,0,0,0,0,"Move kolla_toolbox to high level client

Move from APIClient to PodmanClient and DockerClient clients.
[SEP]
FILES CHANGED:
tests/kolla-toolbox-testsuite.yml (+0, -89)
ansible/library/kolla_toolbox.py (+186, -174)
tests/test-kolla-toolbox.yml (+0, -12)
tests/test_kolla_toolbox.py (+479, -0)
",1.050803,0.541986,-0.709092,0.815163,0.514512,0.009057,0.289331,1.169338,-0.512356,-0.489672,0.228034,0.150553,-0.329554,0.070944,-0.577996
openstack/octavia,I97acfbd9b26fefbc38b61e36f72f483072390b23,1,1,1.0,4.3438,0.1184,3,17.33,376,0,Bug Fix,0,0,0,2,0.018868,0.7143,0,0.7143,7,2,0,0.6051,1.1952,4.67,39.56,13.09,0,0,0.6711,1,4.8831,0,6,0,13,0,"Do not fail on revert PlugVIPAmphora due undefined db_lb

- changed order: get db_lb before getting subnet info, to avoid useless
  message without db_lb.vip
- added default db_lb value for case, when DB calls are failed.
  in this case error message will be generated without information about
  VIP

Closes-Bug: 2085427
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+51, -0)
octavia/controller/worker/v2/tasks/network_tasks.py (+9, -9)
releasenotes/notes/handle_empty_db_lb_on_plug_vip_revert-5c24af124498b246.yaml (+7, -0)
",0.032158,-1.69754,0.146512,-0.060103,0.077935,0.067345,0.082812,0.045924,0.123538,-0.375503,0.127612,-0.547602,0.27407,0.218525,0.102567
openstack/kolla,I9a671d63dc6c6919609b667704bc3ce6d91fa22b,0,0,0.5938,1.0986,0.5,1,3.33,172,0,Feature,0,0,0,32,0.058182,0.3478,0,0.2065,2,1,0,0.6793,0.0,2.0,-101.11,25.33,0,1,0.0,0,57.3333,0,0,0,0,0,"[release] Use Dalmatian sources by default

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/933312
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",0.476865,4.103552,-1.63098,0.040661,-1.291395,0.45378,0.322152,-0.404137,-0.058451,-0.736787,-0.434456,0.269406,-0.049642,-0.570522,-0.432629
openstack/octavia,Ia8b4612cd25a68b44d55b113f704756818eb8a5b,1,1,1.0,4.0604,0.2105,3,10.83,489,0,Bug Fix,0,0,0,3,0.016484,0.5833,0,0.5833,7,2,0,0.6062,1.3307,4.67,37.05,12.95,0,0,0.5965,1,8.431,0,6,0,13,0,"Remove amphora_health record on revert CreateAmphoraInDB

Record in amphora_health created by first UDP request from booted
amphora.
It's possible to run creation/failover LB where Amphora will be booted
and reverted on the final tasks (e.g. AmphoraPostVIPPlug) as result
record in amphora_health will be created, but not be removed on revert.
This patch adds logic to remove amphora_health record on revert flow.

Closes-Bug: 2085530
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_database_tasks.py (+28, -6)
releasenotes/notes/delete_amphora_health_row_on_amphora_revert-082f94459ecacaa2.yaml (+7, -0)
octavia/controller/worker/v2/tasks/database_tasks.py (+10, -6)
",-1.29497,-0.778328,-0.231192,0.278081,0.225443,0.071646,0.027973,0.038191,-0.055724,-0.360759,0.342331,-0.094607,-0.077968,0.303236,-0.159376
openstack/kolla-ansible,I4336ec62a0a2dfbe815842f1bacb02135bcf4c0e,1,0,0.5714,1.3863,0.3333,1,8.14,483,0,CI,1,0,0,196,0.018088,0.8,0,0.4571,1,1,0,0.6849,0.0,1.0,27.89,10.98,1,0,1.0,0,120.75,0,0,0,0,0,"CI: Add ProxySQL exception to check-logs.sh

After switching to ProxySQL as default we see following logs:
CRITICAL neutron [None req-c214fdae-5da7-402d-92b0-0572c278a5b5 - - - - - -] Unhandled error: sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (9001, 'Max connect timeout reached while reaching hostgroup 0 after 10150ms')

Mainly in upgrade jobs, which otherwise pass successfuly - just fail on this
check.
[SEP]
FILES CHANGED:
tests/check-logs.sh (+2, -1)
",-1.326352,-0.124454,-0.370174,-0.736907,-0.054195,0.05307,0.15084,0.136153,0.337001,0.369178,0.238819,-0.18319,0.347007,0.34987,-0.12634
openstack/kolla-ansible,I5124f7078e15645979b68986dceb51948c89a520,0,0,0.5736,0.6931,0.0,1,5.2,261,0,Bug Fix,0,0,0,197,0.018175,1.0,0,0.5736,3,1,0,0.6854,0.0,3.0,19.34,14.39,0,0,0.0,0,130.5,0,0,0,0,0,"CI: cephadm: Add python3-yaml to Ubuntu packages

Ubuntu package does not have that in dependencies and cephadm
fails without that. See [1].

[1]: https://bugs.launchpad.net/ubuntu/+source/ceph/+bug/2085603
[SEP]
FILES CHANGED:
roles/cephadm/tasks/pkg_debian.yml (+1, -0)
",-0.692112,0.41317,-1.106317,-0.243437,-0.782544,-0.236134,-0.238052,0.091683,-0.4287,0.500545,-0.042471,-0.423262,0.266597,0.036059,-0.089631
openstack/kolla-ansible,Iae51daa7b64b4498471b1a0d48ee7a4d227794ce,0,0,0.5707,3.3673,1.0,1,8.0,93,0,CI,1,0,0,198,0.018266,0.7143,0,0.4076,1,1,0,0.6842,0.0,1.0,-12.78,23.2,0,0,1.0,0,3.2069,0,0,0,0,0,"CI: Remove usage of Ubuntu workarounds
[SEP]
FILES CHANGED:
tests/pre.yml (+0, -28)
",2.215602,0.625482,0.823345,0.184081,0.650916,0.489418,-0.728793,0.157983,-0.415399,0.249838,-0.193562,-0.126027,0.478206,-0.739529,-0.172628
openstack/kayobe,I683b685bf4e2f625144e4656bcd69c03eda7aa51,1,0,0.8906,2.1972,0.0,2,6.5,448,0,Feature,0,0,0,64,0.059701,0.6667,0,0.5938,4,2,0,0.9145,0.9544,3.0,29.41,8.75,1,0,0.0,1,49.7778,0,0,0,0,0,"Add support for building the proxysql image

This should have been added when proxysql was added to kolla [1] and
kolla-ansible [2].

ProxySQL is disabled by default in this change to allow backports. It
will be enabled in a follow-up patch only for the master branch.

[1] https://review.opendev.org/c/openstack/kolla/+/769385
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/770215
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/kolla (+3, -0)
releasenotes/notes/build-proxysql-image-ec09332ef0b7dae0.yaml (+5, -0)
",-2.072152,2.34809,-0.484796,0.605622,-0.585691,0.054948,0.543717,0.042986,-0.125159,0.383996,0.272395,0.151895,-0.066047,-0.11542,-0.160377
openstack/kolla-ansible,I12d287b9f7f1e5ddf754b7f2ca1dee39778e710e,0,0,0.5678,5.5094,0.9959,9,15.0,165,0,CI,0,0,0,199,0.018311,0.5294,0,0.3006,4,3,0,0.683,0.9254,3.56,16.77,19.33,0,0,0.0,0,0.668,0,0,0,0,0,"cinder: Drop Hitachi HNAS NFS driver support

It has been removed in I23867aa98f68298beb5db4558c66c1ffd4e7d6f1
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+0, -13)
doc/source/reference/storage/index.rst (+0, -1)
doc/source/reference/storage/cinder-guide.rst (+0, -4)
ansible/roles/cinder/tasks/precheck.yml (+0, -1)
ansible/group_vars/all.yml (+0, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -13)
ansible/roles/cinder/tasks/config.yml (+1, -1)
etc/kolla/globals.yml (+0, -1)
doc/source/reference/storage/cinder-guide-hnas.rst (+0, -210)
",0.673748,0.418998,-2.337676,-1.99725,1.251083,0.686612,0.890555,-0.386141,0.202468,-0.201172,-0.444422,0.489546,-0.335438,-0.434392,-0.013971
openstack/openstack-ansible-os_keystone,Icfcc1ccf7970853f480a922c40a8e0f5b7bbe4f2,1,0,1.0,1.9459,0.0,1,13.67,301,1,Bug Fix,0,0,0,50,0.062972,0.0,0,0.0,1,1,0,1.0,0.0,1.0,44.4,14.25,0,0,0.0,0,43.0,0,0,0,0,0,"federation: ensure cloud credentials are found on utility host

During upgrade, we found that these tasks were asking for an
auth_url, indicating the credentials could not be found.

Fixing these tasks to match the ones above resolved this issue.
[SEP]
FILES CHANGED:
tasks/keystone_federation_sp_idp_setup.yml (+6, -0)
",1.172402,-1.88557,0.048291,0.532193,-0.576589,0.433886,0.408777,-0.495025,0.067367,0.066827,-0.034718,0.039459,-0.152352,-0.088891,0.136596
openstack/ansible-collection-kolla,Ic2c7ab65a2a387892ad977edd2cbe714387da21e,0,0,0.2174,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,23,0.223301,1.0,1,0.2174,2,1,0,0.5789,0.5917,2.0,36.57,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2024.2

Add file to the reno documentation build to show release notes for
stable/2024.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2024.2.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/2024.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.183224,-0.916654,-0.113094,0.106308,-0.054322,-0.208257,-0.439611,0.522207,0.098575,0.783011,-0.764214,-0.065218,-0.173877,0.855748,0.38859
openstack/kolla-ansible,I6065eeffd397f5e14b570f5e4731e40d92d06b99,0,0,0.2083,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,24,0.218182,0.5,1,0.1042,2,1,0,0.6818,0.5917,2.0,42.62,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2024.2

Add file to the reno documentation build to show release notes for
stable/2024.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2024.2.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/2024.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.183224,-0.916654,-0.113094,0.106308,-0.054322,-0.208257,-0.439611,0.522207,0.098575,0.783011,-0.764214,-0.065218,-0.173877,0.855748,0.38859
openstack/kolla,Ib8db1e811fc8bae9600730536a48b6358cbcf76d,0,0,0.2,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,25,0.213675,0.3333,1,0.0667,2,1,0,0.677,0.5917,2.0,44.63,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2024.2

Add file to the reno documentation build to show release notes for
stable/2024.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2024.2.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/2024.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-0.183224,-0.916654,-0.113094,0.106308,-0.054322,-0.208257,-0.439611,0.522207,0.098575,0.783011,-0.764214,-0.065218,-0.173877,0.855748,0.38859
openstack/kolla-ansible,Ic15b8cb334c207a6923aa8d1908f98ecf8710c1e,1,0,0.8923,1.0986,0.5,1,7.0,88,0,Bug Fix,0,0,0,65,0.060185,0.0,0,0.0,1,1,0,0.6806,0.0,1.0,-17.81,25.66,0,0,0.0,0,29.3333,0,0,0,0,0,"Fix typo in kolla-ansible metavar
[SEP]
FILES CHANGED:
kolla_ansible/ansible.py (+1, -1)
",2.301107,1.54961,0.555334,-0.052223,0.629469,-0.676636,0.565928,-0.040547,0.078816,-0.308651,0.527156,0.393464,-0.150827,-0.385682,0.26075
openstack/openstack-ansible-ceph_client,I81c2290d764e5faaf0a57fd3131c6667ade521bf,1,1,0.9552,2.6391,0.0769,1,17.0,240,0,Bug Fix,0,0,0,201,0.055174,0.8947,0,0.8547,1,1,0,0.9231,0.0,1.0,32.82,17.39,0,0,0.0,0,17.1429,0,0,0,0,0,"Fix a list of packages allowed from epel

Ceph 18 requires a couple of extra packages which are provided by EPEL
and that we historically missed adding to the role.

Closes-Bug: #2085146
[SEP]
FILES CHANGED:
vars/redhat.yml (+12, -1)
",0.704962,-1.776227,-0.218393,-0.249726,-0.477371,0.258219,-0.52804,-0.11583,-0.319647,0.147142,-0.179006,0.100683,0.164877,-0.332197,0.385144
openstack/kolla-ansible,Icdc2cedaa6a6e3a6b4351b1f4369e2e8b3a2dc97,1,0,0.8939,2.8904,0.3529,1,7.43,805,0,Bug Fix,0,0,0,66,0.060998,0.0,0,0.0,1,1,0,0.6812,0.0,1.0,19.52,15.28,1,0,0.0,0,44.7222,0,0,0,0,0,"Fix detection of editable installation

When installing kolla-ansible with `pip install ./kolla-ansible`, pip
always creates a direct_url.json file, even when not using an editable
installation.

We see this behaviour with Python 3.12, while direct_url.json is only
created for editable installations on Python 3.9, which was used when
this code was initially developed for Kayobe.

When using a regular (non-editable) installation, this would make
kolla-ansible invoke site.yml from the source directory instead of the
virtualenv installation, causing a failure to load Ansible collections:

    Invalid plugin FQCN (ansible.utils.ipaddr): unable to locate collection ansible.utils

Fix by returning the source URL only if dir_info.editable is True.
[SEP]
FILES CHANGED:
kolla_ansible/utils.py (+11, -6)
",-2.268466,-0.325458,1.644498,-0.091852,0.000973,-0.377503,-0.135437,0.20913,-0.152098,-0.153911,0.192236,-0.034246,-0.197806,0.05077,-0.204336
openstack/kolla-ansible,I7215df2a6294d76d8c5ac3d5811b8d838ccf1997,0,0,0.8955,0.6931,0.0,1,3.0,81,0,Feature,0,0,0,67,0.060965,0.1591,0,0.1425,0,1,0,0.6817,0.0,0.0,20.49,21.2,1,0,0.0,0,40.5,0,0,0,0,0,"Add Python 3.12 classifier
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",3.799442,1.302656,1.837183,0.380597,0.359835,0.533398,0.833577,1.481598,0.431209,1.572707,-0.40612,0.281658,-0.455339,0.264814,0.674703
openstack/kolla-ansible,Idb2ad18eca72756571bbd854ad392c9999685703,0,0,0.565,6.5653,1.0,18,21.0,316,0,Feature,0,0,0,200,0.017995,0.0,0,0.0,4,3,0,0.6806,3.571,3.28,34.45,16.02,0,0,0.0,1,0.4451,0,0,0,0,0,"Remove contrib/bash-completion and demos

demos are so old, that they are not compatible with current Magnum, Tacker and
Heat code - and we're not going to update them.

kolla-ansible bash-complation is not irrelevant, because the client was
rewritten to python
[SEP]
FILES CHANGED:
contrib/demos/heat/README.rst (+0, -15)
contrib/demos/magnum/redis-kube/redis-sentinel-service.yaml (+0, -14)
contrib/demos/heat/steak.yaml (+0, -55)
contrib/demos/magnum/redis (+0, -5)
contrib/demos/magnum/redis-kube/README.rst (+0, -197)
contrib/demos/tacker/cleanup-tacker (+0, -20)
contrib/demos/heat/launch (+0, -18)
contrib/demos/magnum/redis-kube/redis-controller.yaml (+0, -28)
contrib/demos/magnum/redis-kube/redis-master.yaml (+0, -34)
contrib/demos/magnum/redis-kube/redis-sentinel-controller.yaml (+0, -24)
contrib/bash-completion/kolla-ansible (+0, -21)
contrib/demos/magnum/redis-kube/redis-proxy.yaml (+0, -15)
contrib/demos/heat/steak-rg.yaml (+0, -44)
contrib/demos/tacker/README.rst (+0, -20)
contrib/demos/magnum/stop (+0, -9)
contrib/demos/tacker/deploy-tacker-demo-sfc (+0, -83)
contrib/demos/tacker/deploy-tacker-demo (+0, -73)
contrib/demos/magnum/start (+0, -34)
",1.146053,-1.583679,-0.443107,-0.003824,-0.787445,-0.520504,0.831254,-0.307724,-0.904316,-0.260305,-0.002329,0.034398,0.036827,0.049403,0.087473
openstack/kolla-ansible,I26827322199365a4466f180a1abba50ca6a1515f,1,0,0.8824,2.3026,0.3333,2,4.2,225,0,Feature,0,0,0,68,0.061818,0.4,0,0.3529,4,2,0,0.6794,0.9911,3.0,-19.0,13.11,1,0,0.0,1,22.5,0,0,0,0,0,"Remove deleted nova option [api] use_forwarded_for

This option was deleted from Nova in the 2024.1 release [1].

[1] https://review.opendev.org/c/openstack/nova/+/903339
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova.conf.j2 (+1, -3)
releasenotes/notes/nova-remove-use-forwarded-for-69f98132b0f164c1.yaml (+5, -0)
",-0.295797,1.588602,-1.047164,-0.003875,-0.981478,0.236713,-0.255632,0.349388,0.13326,0.28641,-0.306068,-0.108262,-0.441936,-0.208393,-0.395744
openstack/kolla-ansible,Ia9e43f7043c0757e11e1924c3df9fe16c037d484,1,1,0.8214,2.1972,0.125,2,9.5,176,0,Bug Fix,0,0,0,28,0.027001,0.5,0,0.4107,4,2,0,0.6799,0.8113,3.0,27.99,18.54,0,0,0.0,1,19.5556,0,6,0,13,0,"Fix cinder etcd3gw backend_url

Multiple parameters in the URL should be prefixed with an ampersand.

Closes-Bug: #2085908
[SEP]
FILES CHANGED:
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
releasenotes/notes/fix-cinder-etcd-backend-url-3ca1fa04293c16b5.yaml (+6, -0)
",0.765905,-1.012405,-0.52246,-0.686261,-0.098381,0.161531,-0.540921,0.193825,0.233896,-0.09759,0.133599,-0.235953,-0.301282,-0.17065,0.020862
openstack/openstack-ansible-repo_server,I42663e8316ef87c12a229517ac0f95f8c6c2c14b,1,0,0.9554,1.7918,0.0,1,16.25,455,0,CI,0,0,0,202,0.055252,0.0,0,0.0,1,1,0,1.0,0.0,1.0,36.76,13.88,0,0,0.0,0,75.8333,0,0,0,0,0,"Increase timeouts and add retries for UC fetching over HTTP

In CI we've spotted multiple occurances of connection timeouts towards
Gitea resulting in intermittent failures.

Default timeout for get_url module is 10 seconds, which might be not
enough for fetching the file.
A retry is also being added here as another layer of protection for
remote operations
to reduce risk of intermittent failures.
[SEP]
FILES CHANGED:
tasks/repo_install_constraints.yml (+5, -0)
",-0.52681,-2.252093,0.132118,0.577545,-0.308075,0.021476,0.377649,-0.324266,0.239433,0.480226,-0.206216,-0.085573,0.404052,-0.507264,0.314079
openstack/kolla-ansible,I4001ddad198dcf40f71e9196e126cc78a19d1437,1,1,0.8276,2.0794,0.0,2,12.0,125,0,Bug Fix,0,0,0,29,0.027751,1.0,0,0.8276,4,2,0,0.6805,0.5917,3.0,25.46,14.8,0,0,0.0,1,15.625,0,6,0,16,0,"Fix: add common options to RabbitMQ version check

Closes-Bug: #2086171
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+1, -0)
releasenotes/notes/rabbitmq-version-check-add-common-options-05edc24b779a3630.yaml (+6, -0)
",2.698747,-0.104123,0.318929,-0.879647,-0.5232,0.793195,-0.35764,0.495721,0.156504,0.141783,0.183889,-0.317042,0.199361,-0.226327,0.549096
openstack/kolla-ansible,I84d71558c2666ba2cfa47054f782d25ff0c1f691,1,0,0.5622,2.0794,0.4286,3,20.0,368,0,Bug Fix,0,0,0,201,0.017001,0.381,0,0.2142,2,3,0,0.681,1.5567,1.33,54.0,15.33,0,0,0.5714,0,46.0,0,0,0,0,0,"Fix Octavia cert generation

I have no clue how it worked previously in CI, but now
it's using default path to the inventory - which does
not exist.

In addition to that, type=int in cliff will default to
None, so the check had to be rewritten - because we
always did cert expiry check instead of generating them.
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+1, -1)
tests/run.yml (+1, -1)
kolla_ansible/cli/commands.py (+2, -1)
",0.326408,-2.484424,0.259826,0.048236,-0.947753,-0.173472,0.418565,-0.750163,-0.552287,0.476799,0.009901,-0.431989,0.164692,0.097398,0.087868
openstack/kolla-ansible,I548b22b27dff111d625361835029354557d8c9ca,1,0,0.5644,4.7622,0.6121,2,8.67,219,0,CI,0,0,0,202,0.017075,0.5556,0,0.3135,1,2,0,0.6816,0.1257,0.5,35.35,11.16,0,0,0.9828,1,1.8718,0,0,0,0,0,"CI: Add pre/run.yml to files in all base jobs

Rework the base jobs structure to include a mid-level
kolla-ansible-scenario-base that includes common
files: stanza.
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+44, -70)
tox.ini (+1, -1)
",0.971475,-0.491272,-0.550976,0.210906,0.244506,-0.794522,-0.008075,0.127594,0.126131,-0.527355,-0.430968,0.070744,-0.440465,0.488741,-0.070503
openstack/kolla-ansible,I6ced070ca10b63c4d27ac76c1e82dc4312c1b165,1,1,0.3571,1.0986,0.5,1,9.75,297,0,Bug Fix,0,0,0,14,0.002148,0.5,0,0.1786,4,1,0,0.6821,0.0,4.0,51.6,10.05,1,0,0.0,0,99.0,0,0,0,0,0,"Fix destroy command with new python CLI

One task in destroy role was missing arguments that were
supplied by the old bash CLI but not supplied by
the new python CLI.

Closes-Bug: #2086187
[SEP]
FILES CHANGED:
ansible/roles/destroy/tasks/cleanup_host.yml (+1, -1)
",0.500225,-1.906545,-0.089902,0.262939,-0.463757,0.403215,-0.567974,0.026503,-0.004118,-0.129233,-0.189374,0.336271,0.057679,0.317166,0.540974
openstack/kolla,Ie8485a7098743e1d736145e8fd9441cf13c929d7,1,0,0.5758,3.7136,0.0,3,3.5,243,0,Doc,0,0,0,33,0.059783,0.75,0,0.4318,3,3,0,0.6747,1.054,2.67,-22.32,10.92,0,0,0.0,1,5.9268,0,0,0,0,0,"Ironic: Add ESP image for UEFI virtual media

UEFI virtual media boot requires an ESP image [1].

[1] https://docs.openstack.org/ironic/2024.2/admin/drivers/redfish.html#virtual-media-boot
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+30, -0)
releasenotes/notes/ironic-esp-image-886b5fb5b01e7b56.yaml (+6, -0)
docker/ironic/ironic-pxe/Dockerfile.j2 (+4, -0)
",-0.80091,3.011328,-1.426738,0.785998,-0.497042,0.290252,-0.178189,0.408147,0.259694,0.187823,-0.74414,0.039013,0.224093,0.035384,-0.422576
openstack/kolla-ansible,Ife2acdb0d4360c58c7de68cf259a0ed4a86234c2,1,0,0.8841,3.1355,0.5,1,7.5,140,0,Feature,0,0,0,69,0.062218,0.0,0,0.0,2,1,0,0.6827,0.0,2.0,-3.82,16.33,1,0,0.0,1,6.087,0,0,0,0,0,"Add removal of --key parameter to CLI rewrite note

Also rewrite/reformat while here.
[SEP]
FILES CHANGED:
releasenotes/notes/python-cli-3e568065b8706e73.yaml (+11, -11)
",2.70821,-0.93609,0.878002,0.296202,-0.260314,0.188793,0.13144,-0.337497,0.072641,-0.034082,-0.386619,-0.448868,-0.118788,0.284727,-0.378091
openstack/kolla-ansible,I1cf0b7a6b7506a68876bce2de5080718280a47be,1,0,0.8857,2.9957,0.4211,2,15.0,500,0,Bug Fix,0,0,0,70,0.061892,1.0,0,0.8857,4,2,0,0.6832,0.8315,2.0,55.12,11.87,1,0,0.0,1,25.0,0,0,0,0,0,"docs: minor fixes to external Ceph guide

When a path is broken into two separate lines, the generated HTML
includes an incorrect space character in the middle of the path.

We need to ignore doc8 linting on this file as this change breaks the
max line length check. I tried using ``ignore-path-errors`` to exclude
only D001 for this file, but doc8 does not like a relative path for this
option [1].

[1] https://github.com/PyCQA/doc8/issues/162
[SEP]
FILES CHANGED:
doc/source/reference/storage/external-ceph-guide.rst (+6, -8)
tox.ini (+5, -0)
",-0.681858,-0.658451,0.365352,0.125676,-0.745436,-0.214158,0.425904,-0.237232,0.130147,0.474238,0.115212,-0.317934,0.092994,-0.211661,-0.189297
openstack/kolla-ansible,I6c56b144a81f800e062d6670733ca606733c9e1b,0,1,0.597,2.4849,0.4545,4,18.29,983,0,Bug Fix,0,0,0,67,0.017636,0.381,0,0.2274,4,3,0,0.6838,1.7899,3.0,13.79,16.69,1,0,0.0,1,81.9167,0,6,0,4,0,"Fix proxysql-config's TLS DB configuration

This patch removes `proxysql_project_database_internal_tls_enable`
variable and also 'use_ssl: 1' option from ProxySQL's user
configuration. The reason for this removal is that when
'use_ssl: 1' option is enabled on the ProxySQL frontend
side, ProxySQL does not allow non-TLS connections.

This, of course, breaks upgrades or reconfigurations
when an operator enables TLS, as it blocks all non-TLS service
connections at the moment of switching.
Simply said, we do not need to, nor can we, strictly enforce
user connections over TLS because it disrupts reconfiguration
and upgrades. Instead, it is sufficient to reconfigure
the service to connect over TLS - which is already implemented.

It also corrects the `database_enable_tls_internal`
variable, ensuring it is enabled only when
`kolla_enable_tls_internal` is enabled, rather than
`kolla_enable_tls_backend`.

Closes-Bug: #2086466
[SEP]
FILES CHANGED:
ansible/roles/proxysql-config/templates/users.yaml.j2 (+0, -3)
ansible/group_vars/all.yml (+1, -1)
releasenotes/notes/bug-2086466-dc13b40f8da39542.yaml (+5, -0)
ansible/roles/proxysql-config/defaults/main.yml (+0, -1)
",-3.046143,-0.194089,2.873486,-0.287593,0.236214,0.013096,-0.696051,-0.128942,0.132432,-0.248691,0.066008,-0.008345,-0.363319,-0.350997,0.120717
openstack/kolla-ansible,I052c763073c5da29cb8e78004a01a22217dde5da,0,0,0.5882,6.4862,0.2336,202,8.4,323,0,Feature,0,0,0,68,0.017848,1.0,0,0.5882,4,3,0,0.6826,7.3479,3.99,35.15,10.98,1,0,0.0,1,0.4924,0,0,0,0,0,"Add TLS support for MariaDB Connections

Since Kolla-Ansible now supports TLS for MariaDB,
this patch adds support for services that can use
this feature.

This feature can be used only when ProxySQL is used
as LB.
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron-openvswitch-agent-xenapi.json.j2 (+1, -1)
ansible/roles/nova-cell/defaults/main.yml (+8, -0)
ansible/roles/neutron/templates/neutron-bgp-dragent.json.j2 (+1, -1)
ansible/roles/heat/defaults/main.yml (+7, -1)
ansible/roles/barbican/tasks/config.yml (+1, -1)
ansible/roles/glance/tasks/bootstrap.yml (+2, -0)
ansible/roles/blazar/tasks/bootstrap.yml (+2, -0)
ansible/roles/magnum/tasks/config.yml (+1, -1)
ansible/roles/keystone/tasks/config.yml (+1, -1)
ansible/roles/mistral/tasks/bootstrap.yml (+2, -0)
ansible/roles/ironic/tasks/config.yml (+1, -1)
ansible/roles/gnocchi/tasks/bootstrap.yml (+2, -0)
ansible/roles/opensearch/tasks/config.yml (+1, -1)
ansible/roles/neutron/templates/neutron-server.json.j2 (+1, -1)
ansible/roles/watcher/tasks/config.yml (+1, -1)
ansible/roles/manila/tasks/bootstrap.yml (+2, -0)
ansible/roles/tacker/tasks/config.yml (+1, -1)
ansible/roles/cinder/templates/cinder-volume.json.j2 (+1, -1)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -1)
ansible/roles/trove/templates/trove.conf.j2 (+1, -1)
ansible/roles/neutron/templates/neutron-openvswitch-agent.json.j2 (+1, -1)
ansible/roles/gnocchi/tasks/config.yml (+1, -1)
ansible/roles/letsencrypt/defaults/main.yml (+5, -0)
ansible/roles/octavia/templates/octavia-api.json.j2 (+1, -1)
ansible/roles/trove/templates/trove-conductor.json.j2 (+1, -1)
ansible/roles/keystone/tasks/bootstrap.yml (+2, -0)
ansible/roles/keystone/tasks/upgrade.yml (+2, -0)
ansible/roles/designate/tasks/bootstrap.yml (+2, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
ansible/roles/neutron/defaults/main.yml (+4, -1)
ansible/roles/glance/templates/glance-tls-proxy.json.j2 (+1, -1)
ansible/roles/placement/templates/placement.conf.j2 (+1, -1)
ansible/roles/trove/tasks/config.yml (+1, -1)
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -1)
ansible/roles/manila/defaults/main.yml (+8, -0)
ansible/roles/cyborg/tasks/config.yml (+1, -1)
ansible/roles/ironic/tasks/bootstrap.yml (+2, -0)
releasenotes/notes/tls-for-database-6b203025b6f31a17.yaml (+5, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -1)
ansible/roles/grafana/tasks/config.yml (+1, -1)
ansible/roles/nova/templates/nova-super-conductor.json.j2 (+1, -1)
ansible/roles/octavia/templates/octavia-housekeeping.json.j2 (+1, -1)
ansible/roles/skyline/templates/skyline-apiserver.json.j2 (+1, -1)
ansible/roles/designate/defaults/main.yml (+8, -0)
ansible/roles/neutron/templates/neutron-metadata-agent.json.j2 (+1, -1)
ansible/roles/neutron/tasks/config.yml (+1, -1)
ansible/roles/cinder/templates/cinder-scheduler.json.j2 (+1, -1)
ansible/roles/horizon/tasks/bootstrap.yml (+2, -0)
ansible/roles/masakari/defaults/main.yml (+8, -0)
ansible/roles/octavia/defaults/main.yml (+6, -1)
ansible/roles/venus/defaults/main.yml (+8, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+1, -1)
ansible/roles/telegraf/defaults/main.yml (+5, -0)
ansible/roles/ironic/templates/ironic-conductor.json.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-prometheus-exporter.json.j2 (+1, -1)
ansible/roles/masakari/tasks/config.yml (+1, -1)
ansible/roles/neutron/templates/neutron-infoblox-ipam-agent.json.j2 (+1, -1)
ansible/roles/venus/templates/venus.conf.j2 (+1, -1)
ansible/roles/trove/templates/trove-taskmanager.json.j2 (+1, -1)
ansible/roles/placement/templates/placement-api.json.j2 (+1, -1)
ansible/roles/ceilometer/tasks/config.yml (+1, -1)
ansible/roles/aodh/templates/aodh.conf.j2 (+1, -1)
ansible/roles/masakari/templates/masakari.conf.j2 (+2, -2)
ansible/roles/designate/templates/designate.conf.j2 (+1, -1)
ansible/roles/glance/templates/glance-api.json.j2 (+1, -1)
ansible/roles/grafana/tasks/bootstrap.yml (+2, -0)
ansible/roles/nova/templates/nova.conf.j2 (+2, -2)
ansible/roles/nova/templates/nova-api-bootstrap.json.j2 (+7, -1)
ansible/roles/blazar/defaults/main.yml (+8, -0)
ansible/roles/skyline/templates/skyline-console.json.j2 (+1, -1)
ansible/roles/rabbitmq/templates/rabbitmq.json.j2 (+1, -1)
ansible/roles/skyline/tasks/bootstrap.yml (+2, -0)
ansible/roles/neutron/templates/neutron-ovn-metadata-agent.json.j2 (+1, -1)
ansible/roles/trove/defaults/main.yml (+7, -1)
ansible/roles/placement/tasks/config.yml (+1, -1)
ansible/roles/barbican/tasks/bootstrap.yml (+2, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+2, -2)
ansible/roles/octavia/templates/octavia-health-manager.json.j2 (+1, -1)
ansible/roles/octavia/templates/octavia.conf.j2 (+3, -2)
ansible/roles/nova/defaults/main.yml (+2, -1)
ansible/roles/magnum/defaults/main.yml (+8, -0)
ansible/roles/mariadb/tasks/config.yml (+2, -0)
ansible/roles/zun/defaults/main.yml (+10, -0)
ansible/roles/mistral/defaults/main.yml (+8, -0)
ansible/roles/tacker/templates/tacker.conf.j2 (+1, -1)
ansible/roles/heat/templates/heat-api.json.j2 (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
ansible/roles/aodh/tasks/bootstrap.yml (+2, -0)
ansible/roles/cyborg/defaults/main.yml (+8, -0)
ansible/roles/placement/tasks/bootstrap.yml (+2, -0)
ansible/roles/octavia/templates/octavia-driver-agent.json.j2 (+1, -1)
ansible/roles/neutron/templates/neutron-l3-agent.json.j2 (+1, -1)
ansible/roles/masakari/tasks/bootstrap.yml (+2, -0)
ansible/roles/neutron/templates/neutron-ovn-agent.json.j2 (+1, -1)
ansible/roles/manila/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/tasks/create_cells.yml (+2, -2)
ansible/roles/common/defaults/main.yml (+5, -0)
ansible/roles/neutron/templates/ironic-neutron-agent.json.j2 (+1, -1)
ansible/roles/aodh/tasks/config.yml (+1, -1)
ansible/roles/nova/tasks/config.yml (+1, -1)
ansible/roles/tacker/tasks/bootstrap.yml (+2, -0)
ansible/roles/watcher/tasks/bootstrap.yml (+2, -0)
ansible/roles/nova-cell/tasks/config.yml (+1, -1)
ansible/roles/skyline/templates/skyline.yaml.j2 (+1, -1)
ansible/roles/barbican/templates/barbican-worker.json.j2 (+1, -1)
ansible/roles/gnocchi/defaults/main.yml (+10, -0)
ansible/roles/ceilometer/defaults/main.yml (+5, -0)
ansible/roles/nova/templates/nova-api.json.j2 (+1, -1)
ansible/roles/cinder/templates/cinder-api.json.j2 (+1, -1)
ansible/roles/cinder/templates/cinder-backup.json.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-http.json.j2 (+1, -1)
ansible/roles/keystone/templates/keystone-ssh.json.j2 (+1, -1)
ansible/roles/keystone/templates/keystone.json.j2 (+1, -1)
ansible/roles/trove/templates/trove-api.json.j2 (+1, -1)
ansible/roles/cloudkitty/tasks/config.yml (+1, -1)
ansible/roles/cinder/tasks/bootstrap.yml (+2, -0)
ansible/roles/etcd/templates/etcd.json.j2 (+1, -1)
ansible/roles/neutron/templates/neutron-linuxbridge-agent.json.j2 (+1, -1)
ansible/roles/skyline/tasks/config.yml (+1, -1)
ansible/roles/cloudkitty/defaults/main.yml (+8, -0)
ansible/roles/horizon/tasks/config.yml (+1, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+1, -1)
ansible/roles/letsencrypt/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/tasks/bootstrap.yml (+2, -0)
ansible/roles/keystone/templates/keystone-fernet.json.j2 (+1, -1)
ansible/roles/etcd/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/tasks/get_cell_settings.yml (+1, -1)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -1)
ansible/roles/nova/tasks/config_bootstrap.yml (+12, -0)
ansible/roles/cloudkitty/tasks/bootstrap.yml (+2, -0)
ansible/roles/nova-cell/templates/nova-cell-bootstrap.json.j2 (+7, -1)
ansible/roles/telegraf/tasks/config.yml (+1, -1)
ansible/roles/ironic/defaults/main.yml (+8, -2)
ansible/roles/watcher/defaults/main.yml (+8, -0)
ansible/roles/neutron/templates/neutron-tls-proxy.json.j2 (+1, -1)
ansible/roles/nova/tasks/map_cell0.yml (+4, -3)
ansible/roles/skyline/defaults/main.yml (+8, -2)
ansible/roles/heat/templates/heat.conf.j2 (+1, -1)
ansible/roles/mariadb/tasks/check.yml (+4, -5)
ansible/roles/barbican/templates/barbican-api.json.j2 (+1, -1)
ansible/roles/prometheus/tasks/config.yml (+1, -1)
ansible/roles/horizon/templates/horizon.json.j2 (+1, -1)
ansible/roles/venus/tasks/bootstrap.yml (+2, -0)
ansible/roles/keystone/defaults/main.yml (+1, -1)
ansible/roles/glance/defaults/main.yml (+4, -1)
ansible/roles/heat/tasks/config.yml (+1, -1)
ansible/roles/neutron/templates/neutron-dhcp-agent.json.j2 (+1, -1)
ansible/roles/nova-cell/tasks/config_bootstrap.yml (+12, -0)
ansible/roles/prometheus/tasks/bootstrap.yml (+1, -0)
ansible/roles/tacker/defaults/main.yml (+8, -0)
ansible/roles/trove/tasks/bootstrap.yml (+2, -0)
ansible/roles/cinder/tasks/config.yml (+1, -1)
ansible/roles/watcher/templates/watcher.conf.j2 (+1, -1)
ansible/roles/mariadb/tasks/register.yml (+4, -0)
ansible/roles/glance/tasks/config.yml (+1, -1)
ansible/roles/manila/templates/manila.conf.j2 (+1, -1)
ansible/roles/opensearch/defaults/main.yml (+5, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+1, -1)
ansible/roles/blazar/tasks/config.yml (+1, -1)
ansible/roles/zun/tasks/config.yml (+1, -1)
ansible/roles/neutron/templates/neutron-metering-agent.json.j2 (+1, -1)
ansible/roles/zun/tasks/bootstrap.yml (+2, -0)
ansible/roles/ironic/templates/ironic-dnsmasq.json.j2 (+1, -1)
ansible/roles/nova/templates/nova-scheduler.json.j2 (+1, -1)
ansible/roles/barbican/templates/barbican-keystone-listener.json.j2 (+1, -1)
ansible/roles/cinder/defaults/main.yml (+8, -1)
ansible/roles/neutron/templates/neutron-mlnx-agent.json.j2 (+1, -1)
ansible/roles/kuryr/defaults/main.yml (+5, -0)
ansible/roles/neutron/templates/neutron-eswitchd.json.j2 (+1, -1)
ansible/roles/mariadb/defaults/main.yml (+8, -0)
ansible/roles/octavia/templates/octavia-worker.json.j2 (+1, -1)
ansible/roles/zun/templates/zun.conf.j2 (+1, -1)
ansible/roles/rabbitmq/tasks/config.yml (+1, -1)
ansible/roles/octavia/tasks/config.yml (+1, -1)
ansible/roles/common/tasks/config.yml (+1, -1)
ansible/roles/grafana/defaults/main.yml (+5, -0)
ansible/roles/mariadb/tasks/loadbalancer.yml (+1, -0)
ansible/roles/barbican/defaults/main.yml (+7, -1)
ansible/roles/ironic/templates/ironic-inspector.json.j2 (+1, -1)
ansible/roles/designate/tasks/config.yml (+1, -1)
ansible/roles/loadbalancer/tasks/config.yml (+1, -1)
ansible/roles/venus/tasks/config.yml (+1, -1)
ansible/roles/aodh/defaults/main.yml (+8, -0)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+2, -2)
ansible/roles/heat/tasks/bootstrap.yml (+2, -0)
ansible/roles/glance/tasks/bootstrap_service.yml (+2, -0)
ansible/roles/mistral/tasks/config.yml (+1, -1)
ansible/roles/neutron/tasks/bootstrap.yml (+2, -0)
ansible/roles/kuryr/tasks/config.yml (+1, -1)
ansible/roles/octavia/tasks/bootstrap.yml (+4, -0)
ansible/roles/placement/defaults/main.yml (+7, -1)
ansible/roles/cyborg/tasks/bootstrap.yml (+2, -0)
ansible/roles/prometheus/defaults/main.yml (+5, -0)
ansible/roles/magnum/tasks/bootstrap.yml (+2, -0)
ansible/roles/nova/tasks/bootstrap.yml (+2, -0)
ansible/roles/ironic/templates/ironic-api.json.j2 (+6, -0)
ansible/roles/neutron/templates/neutron-sriov-agent.json.j2 (+1, -1)
ansible/roles/heat/templates/heat-engine.json.j2 (+1, -1)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+2, -2)
ansible/roles/glance/tasks/rolling_upgrade.yml (+2, -0)
ansible/roles/heat/templates/heat-api-cfn.json.j2 (+1, -1)
",0.10135,-1.611149,-0.255472,0.610285,-0.604665,-0.185263,-0.806043,0.470592,-0.102055,0.545089,-0.531788,0.337913,0.172024,-0.372561,-0.281386
openstack/oslo.messaging,Iaeb52791008a7a6736c99459f66d2bdbb2dea17b,0,0,0.8182,8.8462,0.9977,20,5.86,393,0,Feature,0,0,1,11,0.025943,1.0,0,0.8182,3,7,0,0.6333,2.7156,2.1,4.87,14.05,0,0,0.3378,1,0.0566,0,0,0,0,0,"Remove deprecated AMQP1 driver

The AMQP1 driver has been deprecated for several years, since 14.4.0 and
is no longer maintained or widely used. This commit removes the AMQP1
driver from the code base.

References:
- Original deprecation commit: https://opendev.org/openstack/oslo.messaging/commit/0f63c227f5425995ae8c61f1d40ec85e7728528a
[SEP]
FILES CHANGED:
doc/source/admin/index.rst (+0, -1)
oslo_messaging/_drivers/amqp1_driver/__init__.py (+0, -0)
oslo_messaging/_drivers/amqp1_driver/eventloop.py (+0, -404)
oslo_messaging/opts.py (+0, -2)
.zuul.yaml (+1, -19)
oslo_messaging/_drivers/amqp1_driver/controller.py (+0, -1336)
releasenotes/notes/remove-amqp1-c924ea548dadffaa.yaml (+6, -0)
doc/source/admin/AMQP1.0.rst (+0, -639)
oslo_messaging/tests/test_opts.py (+1, -2)
tools/test-setup.sh (+0, -20)
bindep.txt (+0, -9)
oslo_messaging/_drivers/amqp1_driver/opts.py (+0, -270)
oslo_messaging/_drivers/amqp1_driver/addressing.py (+0, -294)
doc/source/reference/transport.rst (+0, -1)
oslo_messaging/tests/drivers/test_amqp_driver.py (+0, -2324)
doc/source/admin/kafka.rst (+7, -10)
oslo_messaging/_drivers/impl_amqp1.py (+0, -449)
oslo_messaging/conffixture.py (+0, -3)
setup.cfg (+1, -4)
oslo_messaging/_drivers/amqp1_driver/oslo_messaging_amqp_driver_overview.rst (+0, -1144)
",-1.433565,0.754932,-0.661409,-0.303145,-0.097444,0.052795,0.953018,0.716132,0.484729,0.622394,0.187523,0.087874,-0.125694,0.049334,0.112756
openstack/ansible-collection-kolla,I788cc3893369a531ad216d80aebcab141137cef3,0,1,0,2.3979,0.0,3,16.5,253,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,3,2,0,0.55,1.2955,2.67,31.14,15.08,0,0,0.0,1,23.0,0,6,0,4,0,"add docker_apt_key_env variable to docker role

feat: In some cases, having the option to set enviroment variables
to the get_url module can be useful to pass http proxy config.

Closes-Bug: #2086700
[SEP]
FILES CHANGED:
roles/docker/defaults/main.yml (+3, -0)
releasenotes/notes/add-docker-apt-key-env-1fa084e207f068f7.yaml (+6, -0)
roles/docker/tasks/repo-Debian.yml (+1, -0)
",0.807801,-1.656678,-0.309418,-0.076386,-0.18739,-0.384096,-0.28699,0.06157,0.317618,-0.026635,-0.42832,-0.452197,-0.297589,-0.288732,-0.015735
openstack/ironic,Ic93b5d7c6ea27a3c47daa6b2c6671aaa401b5427,1,1,0.0,2.3026,0.1111,2,8.5,302,0,Bug Fix,0,0,0,1,0.090909,1.0,0,0.0,3,2,0,0.9593,0.7642,2.5,26.52,12.81,1,0,0.0,1,30.2,0,6,0,4,0,"Instance provisioning fails on SQLite

The following error occurs when using SQLite:
oslo_config.cfg.NoSuchOptError: no such option hostname in group [DEFAULT]

`hostname` is not defined in [DEFAULT] group, use `host` instead.

Closes-Bug: #2086682
[SEP]
FILES CHANGED:
releasenotes/notes/fix-sqlite-lock-61232cfe81adbde4.yaml (+7, -0)
ironic/db/sqlalchemy/api.py (+1, -1)
",-0.457351,-0.449253,-0.614098,0.216617,-0.082537,0.474333,-0.748343,0.093335,0.276345,0.014424,0.247149,-0.567617,-0.090202,0.021598,-0.737424
openstack/octavia,I35e96fdd2c28a005811d6fdedb570ccc65e30e0a,1,1,0.5417,2.6391,0.2308,3,13.5,234,1,Bug Fix,0,0,0,24,0.003473,0.6,0,0.325,6,2,0,0.6073,1.5486,4.0,11.4,20.21,1,0,0.2308,1,16.7143,0,6,0,16,0,"Handle undefined protocol field in security group rules correctly

Prevent AttributeError when protocol field is None and skip
processing of the rule instead.

Closes-Bug: #2086768
[SEP]
FILES CHANGED:
octavia/tests/unit/network/drivers/neutron/test_allowed_address_pairs.py (+2, -1)
releasenotes/notes/fix-attributeerror-when-securitygroup-rule-has-protocol-none-9b7217c5477d01b6.yaml (+5, -0)
octavia/network/drivers/neutron/allowed_address_pairs.py (+3, -2)
",0.846158,-1.365074,-0.161117,-0.132596,-0.203586,0.724589,-1.006384,-0.298796,0.637667,-0.22199,-0.01947,-0.101532,0.241214,-0.327874,-0.14005
openstack/kolla-ansible,I5e3c29faae4c2531b269c37874ade368c1aab39f,1,1,0.8333,2.9444,0.1111,3,11.5,362,0,Bug Fix,0,0,0,30,0.028517,0.5455,0,0.4545,4,3,0,0.6814,1.2516,3.33,33.32,12.43,0,0,0.0,1,19.0526,0,10,0,15,0,"Give ironic-inspector system scope ``all``

The ``ironic-inspector`` service user is now assigned the system scope
``all``. This allows it to create baremetal ports during node inspection
again.

Default project and domain vars are removed as you cannot combine these
with system scope.

Closes-Bug: #2064655
[SEP]
FILES CHANGED:
releasenotes/notes/give-ironic-inspector-user-system-scope-all-5fe5cb7f9a03ee7b.yaml (+12, -0)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -2)
ansible/roles/ironic/defaults/main.yml (+3, -0)
",-0.090435,-0.966442,-0.38709,0.558679,0.029448,-0.088444,-0.019477,0.226489,0.123815,-0.208162,0.211608,-0.125404,-0.048397,0.104347,0.002793
openstack/kolla-ansible,Ie7fe78ab67b1bf8a19def25fef321de5c2d80aa9,1,0,0.8387,2.4849,0.2727,2,8.11,596,0,Doc,0,0,0,31,0.028972,0.5,0,0.4194,4,2,0,0.682,0.9457,3.0,16.65,11.46,0,0,0.0,1,49.6667,0,0,0,0,0,"Update user role assignments

Adds support for setting the system scope to user role assignments.
Also updates the domain assignment so it can be customised.

Note that the scope assignments follow the precedence of
project->domain->system [1]. As such, the previous default value of
domain was being ignored as we always set a project, so the removal of
the default domain in this patch has no effect on existing behaviour.

1. https://docs.ansible.com/ansible/latest/collections/openstack/cloud/role_assignment_module.html#parameter-system
[SEP]
FILES CHANGED:
releasenotes/notes/update-user-role-assignments-c8e487445a6cadef.yaml (+4, -0)
ansible/roles/service-ks-register/tasks/main.yml (+4, -3)
",-1.0533,0.225308,0.533935,0.910484,-0.233977,-0.195027,0.663892,0.173655,0.614384,0.150737,-0.040615,-0.022178,-0.164543,-0.207294,-0.164752
openstack/kolla,I204c288399992b66682415b4ccb4845cfa9ea064,1,0,0.75,1.6094,0.0,1,11.5,185,0,Doc,0,0,0,8,0.080808,1.0,1,0.75,3,1,0,0.6758,0.0,3.0,33.32,11.56,1,0,0.0,0,37.0,0,0,0,0,0,"Update release-management doc with openstack-manuals step

After a release is made, kolla docs need to be added to the docs index.
[SEP]
FILES CHANGED:
doc/source/contributor/release-management.rst (+4, -0)
",1.365144,-0.475112,-0.130566,0.626144,0.125389,-0.114224,0.803099,0.049717,0.218183,-0.531177,-0.346472,0.595341,-0.310851,-0.029835,-0.495262
openstack/kolla-ansible,If982d397e7c8ed8ac36f6274cbb3438cb04075b3,1,1,0.8873,2.0794,0.1429,2,11.0,122,0,Bug Fix,0,0,0,71,0.061739,0.4444,0,0.3944,4,2,0,0.6825,0.8631,3.0,26.47,18.95,1,0,0.0,1,15.25,0,6,0,8,0,"Fix internal endpoint for the heat-cfn service

Closes-Bug: #2087537
[SEP]
FILES CHANGED:
ansible/roles/heat/defaults/main.yml (+1, -1)
releasenotes/notes/heat-cfn-internal-endpoint-bug-2087537-0f5fb5d997e5a92b.yaml (+5, -0)
",2.966818,0.32232,0.090187,-1.074647,-0.825859,0.479095,-0.09409,0.519685,0.449637,-0.725231,0.290033,-0.025248,0.125798,-0.056741,0.510742
openstack/kolla-ansible,I69d9a44db037fce42cb5a25b5688313eece15484,1,1,0,2.3026,0.2222,3,22.5,337,0,Bug Fix,0,0,0,0,0.0,0.3077,0,0.0,2,2,0,0.6831,0.9864,2.0,18.56,19.67,0,0,0.0,1,33.7,0,6,0,3,0,"Fix inventory file for cyborg control services

Fix a scheduling issue in the multinode and all-in-one inventory files,
that would cause cyborg api and conductor service to also be scheduled
on compute nodes rather then exclusively staying on the control plane.

Closes-Bug: #2087552
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -1)
releasenotes/notes/fix-cyborg-api-conductor-placement-f0cdf7274d31ffc0.yaml (+7, -0)
ansible/inventory/all-in-one (+0, -1)
",-0.004688,-1.770083,-0.018319,0.203501,-0.133045,-0.442463,-0.511018,0.299154,0.124278,-0.127684,-0.57654,0.347475,0.284331,0.055058,0.164976
openstack/kolla-ansible,I728249cc7d855508d3cbbe28aa4b659509831dc4,0,1,0.8261,4.4886,0.25,11,7.25,284,0,Bug Fix,0,0,0,46,0.036135,1.0,0,0.8261,4,4,0,0.6836,3.1229,3.73,6.94,16.69,1,0,0.0,1,3.191,0,8,0,5,0,"Make certificates role more configurable

This change moves the hardcoded settings for certificates to the role
defaults, making it more configurable.

Partial-Bug: #2087707
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/generate-backend.yml (+1, -1)
doc/source/admin/tls.rst (+22, -0)
ansible/roles/certificates/defaults/main.yml (+16, -0)
ansible/roles/certificates/tasks/generate-root.yml (+2, -2)
ansible/roles/certificates/templates/openssl-kolla-backend.cnf.j2 (+4, -4)
ansible/roles/certificates/tasks/generate-libvirt.yml (+1, -1)
releasenotes/notes/make-certificates-configurable-c56d00362c863aa9.yaml (+6, -0)
ansible/roles/certificates/tasks/generate.yml (+2, -2)
ansible/roles/certificates/templates/openssl-kolla-libvirt.cnf.j2 (+4, -4)
ansible/roles/certificates/templates/openssl-kolla-internal.cnf.j2 (+4, -4)
ansible/roles/certificates/templates/openssl-kolla.cnf.j2 (+4, -4)
",0.532776,-1.257352,-0.635961,0.218391,-0.152077,0.593466,-0.563692,-0.137374,0.246715,0.033838,-0.163521,0.19457,-0.199951,-0.239819,0.11307
openstack/kolla,I83e618a861b4d51b6a7893f79c50fdfc35228891,0,1,1.0,2.5649,0.25,1,17.5,442,0,Bug Fix,0,0,0,2,0.1,0.5,0,0.5,3,1,0,0.6769,0.0,3.0,50.09,15.0,1,0,0.0,0,34.0,0,6,0,7,0,"Allow specification of a key type

Letsencrypt allows using a specific key type for certificates. If
the user has an internal letsencrypt mechanism, such as Vault Acme,
then they have to provide a specific key type as the default is
not supported.

This change will allow a user to specify a key type and use the lego
default in the event that they don't specify it.

Partial-Bug: 2087860
[SEP]
FILES CHANGED:
docker/letsencrypt/letsencrypt-lego/letsencrypt-certificates.sh (+9, -3)
",-0.858076,-1.395365,-0.164066,0.922968,-0.195825,-0.061563,0.241899,-0.33589,0.405409,0.360855,0.159535,0.142911,0.249373,0.062948,-0.10557
openstack/kolla-ansible,I9ba49b1150e656dcb16ee3cf3b79b56e7ef2d3a5,0,1,0.6667,2.5649,0.1667,3,9.14,486,0,Bug Fix,0,0,0,3,0.09375,0.3514,0,0.2342,4,2,0,0.6824,1.5546,3.33,33.64,13.03,1,0,0.0,0,37.3846,0,6,0,7,0,"Add key type for letsencrypt certificate

Allows the insertion of a key type for letsencrypt, due to the
fact that there are other 3rd party solutions (i.e. Vault) that
require specific RSA key types.

This change allows the ability to use vault instead of the public
DNS so we can effectively provide private DNS certificates
to an environment.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/934681
Closes-Bug: 2087860
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/defaults/main.yml (+3, -0)
etc/kolla/globals.yml (+5, -0)
ansible/roles/letsencrypt/templates/letsencrypt-lego-run.sh.j2 (+2, -2)
",-1.544156,-0.104756,-0.052009,0.292465,-0.566347,-0.018435,0.114064,0.206487,0.110653,0.125504,-0.185224,-0.146068,0.513891,-0.250689,-0.100195
openstack/kolla,I0a9c782ca1177ef84e4323cb1e5bfac0fb3f383c,0,0,0.6667,4.5109,0.0778,5,13.75,942,0,Doc,0,0,0,3,0.076923,0.5263,0,0.3509,3,3,0,0.6746,1.1279,2.4,6.76,18.59,1,0,0.0,1,10.3516,0,0,0,0,0,"Change Bifrost Python upper-constraints source

Users can override the upper-constraints.txt by setting the source of
openstack-base in kolla-build.conf.

However, bifrost-base Dockerfile so far doesn't pass overridden
upper-constraints file to Bifrost install playbook resulting the
playbook not acknowledging it and just use upstream one.

This change sets the source of Bifrost upper-constraints to use
upper-constraints of openstack-base for consistency among all Kolla
images

With this, change the environment variable UPPER_CONSTRAINTS_FILE is
only affecting kolla-toolbox image.
Therefore, moved UPPER_CONSTRATINS_FILE variable example to the
``kolla_toolbox_pip_conf`` block of kolla-toolbox Dockerfile.

Additionally, updated 'Python packages build options' section of
documentation to represent latest method of changing Python package
related options (including this change).
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+1, -0)
doc/source/admin/image-building.rst (+63, -5)
docker/base/Dockerfile.j2 (+0, -1)
docker/kolla-toolbox/Dockerfile.j2 (+5, -1)
releasenotes/notes/change-bifrost-upper-constraints-source-e93cb72e88823d56.yaml (+14, -0)
",-3.241456,-0.03368,2.142921,0.164481,0.54515,-0.473557,-0.309823,0.845239,0.210508,-0.78152,-0.096933,0.167335,-0.321338,0.0834,0.071575
openstack/kolla,If15ba52acfd305aa9bbae382fe7429c11041e93f,0,0,0.5665,2.7081,0.3571,6,3.0,76,0,Feature,0,0,0,203,0.016993,0.5,0,0.2833,3,5,0,0.6723,2.5216,2.17,-7.71,14.53,0,0,0.0,1,5.0667,0,0,0,0,0,"rabbitmq: Bump to 4.0
[SEP]
FILES CHANGED:
docker/rabbitmq/apt_preferences_rabbitmq.ubuntu (+1, -1)
releasenotes/notes/rabbitmq-4-0-ee1a5f2ef212f6a6.yaml (+4, -0)
doc/source/contributor/versions.rst (+1, -1)
docker/rabbitmq/Dockerfile.j2 (+1, -1)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
docker/rabbitmq/apt_preferences_rabbitmq.debian (+1, -1)
",2.372908,1.924874,0.984615,-0.30496,0.188288,0.934607,0.088705,0.201506,-0.510188,1.123764,0.347486,0.197775,-1.098291,0.147196,0.69144
openstack/kolla-ansible,Icbe25c0f4107128db899c0111af3acf3c513008f,1,1,1.0,3.1355,0.0,3,9.25,322,0,Bug Fix,0,0,0,1,0.142857,0.6364,0,0.6364,4,3,0,0.6813,1.5644,3.33,-1.48,21.0,1,0,0.0,1,14.0,0,6,0,13,0,"Enables override of Octavia notification topics

Octavia was missing an override for enabling notification topics,
this aligns the overrides with how all the other project roles
handle the topic.

Closes-Bug: #2087997
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+9, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+6, -0)
releasenotes/notes/octavia-notifications-98a91ab02d9cbee6.yaml (+7, -0)
",-0.10844,-1.462622,-0.545078,0.215875,-0.096914,0.409607,-0.782425,-0.189753,-0.157861,-0.321977,-0.071534,-0.000955,0.208402,-0.242478,0.328704
openstack/kolla,Ifa92999672ed267ce877c492c9140fbee271b8b3,1,1,0.0,0.6931,0.0,1,11.33,286,0,Bug Fix,0,0,0,1,0.090909,0.5,0,0.0,3,1,0,0.67,0.0,3.0,16.18,17.47,0,0,0.0,0,143.0,0,10,0,4,0,"Added libvirt dependency to nova-libvirt debian based containers

fix: added mdevctl to nova-libvirt debian based containers, mdevctl is an
optional dependency of libvirt needed in 2024.2 for nova vGPU feature.

Closes-Bug: #2088055
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+1, -0)
",0.260016,-0.502798,-0.448239,0.167389,0.316193,-0.635711,0.071107,0.581797,-0.310571,-0.042302,0.046448,-0.082543,0.330244,-0.254284,0.572106
openstack/ironic,I18c56cb4becf9e6181689ddc0f1c7433327a3aa6,1,1,0.975,4.7449,0.0614,3,14.44,879,0,Bug Fix,0,0,0,40,0.013477,1.0,0,0.975,4,2,0,0.9597,1.2441,3.33,45.75,12.85,0,0,0.6491,1,7.6435,0,6,0,12,0,"Fix policy checks added with runbooks

In the runbooks change, I43555ef72cb882adcada2ed875fda40eed0dd034,
new policies were added for a user sending a list of service steps
or clean steps to the API.

This was done with the generic check_policy helper, however the helper
does not understand how to populate the ``node`` mapping data to enable
RBAC rule value matching. Doing so requires a special node policy
checker method.

As such, the policy checker was changed, and additional tests were added.

One final note, strucutrally the new policies were being checked *after*
we stated to do state verification of the request. RBAC checks should be
performed upfront... which also eases the burden of testing the RBAC
model. Accordingly, the policy checks were moved together
in the provision state logic.

Closes-Bug: 2086823
[SEP]
FILES CHANGED:
releasenotes/notes/fix-set-provision-state-subpolicy-13ae3ef7497d20c1.yaml (+12, -0)
ironic/tests/unit/api/test_rbac_project_scoped.yaml (+74, -0)
ironic/api/controllers/v1/node.py (+21, -7)
",-2.065886,-1.530224,2.033897,-0.52884,-0.131557,0.337476,0.079892,0.045345,0.278014,-0.15077,-0.067039,0.180655,-0.245289,-0.215479,0.107185
openstack/kolla-ansible,I76956cb9b30ceef5fe8ccd13feb22cc40e6dc305,1,1,0.8438,2.1972,0.0,2,10.0,123,0,Bug Fix,0,0,0,32,0.029602,0.5625,0,0.4746,4,2,0,0.6818,0.5436,3.0,-31.73,20.0,0,0,0.0,1,13.6667,0,10,0,15,0,"Remove service role from ironic-inspector user

Related-Bug: #2064655
[SEP]
FILES CHANGED:
releasenotes/notes/remove-ironic-inspector-service-role-765027c3d91016d1.yaml (+7, -0)
ansible/roles/ironic/defaults/main.yml (+1, -0)
",2.820108,0.380576,0.239911,-0.742261,-0.717062,0.172987,-0.360248,0.495186,0.356823,-0.527357,0.341088,-0.02925,0.191249,0.16645,0.169922
openstack/kolla-ansible,I5bb26d351218b8f8d9712d6a2a894b951826e96d,1,0,0.8485,2.1972,0.125,2,7.0,93,0,Feature,0,0,0,33,0.030303,0.6667,0,0.5657,4,2,0,0.6824,0.9544,3.0,-17.81,25.66,0,0,0.0,1,10.3333,0,0,0,0,0,"Support removing user role assignments
[SEP]
FILES CHANGED:
releasenotes/notes/support-removing-user-role-assignments-97f5463a8a653158.yaml (+5, -0)
ansible/roles/service-ks-register/tasks/main.yml (+2, -1)
",3.194336,0.756016,2.155306,0.870498,1.413335,0.773016,0.087816,-0.04664,0.795929,-0.276211,-0.643054,-0.30073,0.270633,-0.073286,-0.124494
openstack/kolla-ansible,Ie32b4ed956c62b48058d43b8bf5cc3434310c381,1,1,0,1.0986,1.0,1,8.44,626,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,1,0,0.6829,0.0,4.0,47.99,10.22,1,0,0.0,0,208.6667,1,6,0,4,0,"Remove --db-sb-addr and --db-nb-addr from ovn-ctl

Prevent conflicting remotes for ovn-db by removing unnecessary remote.
By default we will use --remote on ovn-ctl to start ovsdb on api_interface_address
and we have added a remote in connections table in bootstrap-db which sets to 0.0.0.0,
which will conflict if you have multiple seperated networks, you can see issue on ovsdb:
https://github.com/openvswitch/ovs-issues/issues/344
This change will prevent this log: ovsdb_jsonrpc_server|ERR|ptcp:6641:0.0.0.0: listen
failed: Address already in use

Closes-Bug: #2088380
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/defaults/main.yml (+0, -2)
",-2.430753,0.544342,0.927418,-0.311481,-0.049957,-0.359059,-0.013353,0.129639,-0.053001,-0.384574,0.401785,-0.356452,-0.037045,0.24276,-0.048483
openstack/oslo.log,I2ef0a819860d668b626b5bfafb67f6d2c059e498,1,0,0.9286,2.0794,0.0,1,6.0,277,0,Feature,0,0,0,14,0.057613,1.0,0,0.9286,1,1,0,1.0,0.0,1.0,-21.33,15.73,0,0,0.0,0,34.625,0,0,0,0,0,"Add missing contextmanager interfaces to PipeMutex

Log handler in python 3.13 requires that its lock instance is a context
manager[1].

[1] https://github.com/python/cpython/commit/74723e11109a320e628898817ab449b3dad9ee96
[SEP]
FILES CHANGED:
oslo_log/pipe_mutex.py (+7, -0)
",-0.371586,1.204562,-1.217527,-0.568222,0.468764,0.105233,0.16535,0.08836,0.458548,0.823228,-0.692287,-0.297096,0.186834,-0.098156,-0.057207
openstack/kolla-ansible,I57f621e5480db7caa7c939b31cb4080d51d02ff0,0,0,0.7647,3.3673,0.0714,5,3.0,150,0,Feature,0,0,0,17,0.031481,0.3421,0,0.2616,4,3,0,0.6834,2.1036,3.2,-50.01,18.98,1,0,0.0,1,5.1724,0,0,0,0,0,"Add Let's Encrypt EAB support

Depends-on: https://review.opendev.org/c/openstack/kolla/+/916617
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/tasks/precheck.yml (+11, -0)
ansible/roles/letsencrypt/defaults/main.yml (+2, -0)
releasenotes/notes/add-letsencrypt-eab-support-7951e7a572718ce9.yaml (+4, -0)
etc/kolla/globals.yml (+7, -0)
ansible/roles/letsencrypt/templates/letsencrypt-lego-run.sh.j2 (+2, -2)
",0.694754,4.459602,-1.331241,-0.076228,-1.514903,0.830661,0.542251,-0.596835,0.025316,-0.843323,-0.441582,0.03131,0.046322,-0.510888,-0.003964
openstack/ansible-collection-kolla,Ib46b935b6668062408b82bed883c4d9900b75830,0,0,0.5637,1.6094,0.5,1,12.0,313,0,Doc,0,1,0,204,0.017057,0.7778,0,0.4385,3,1,0,0.5238,0.0,3.0,41.91,11.47,0,0,0.0,0,62.6,0,0,0,0,0,"Revert ""docker_sdk: Pin requests to <2.32 due to docker-py incompatibility""

This reverts commit cf7b405c4aa788bb307020b739c93094ae0050a9.

Reason for revert: New docker_sdk supports new requests

In addition to that - docker-py version has been bumped to 7+
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+2, -2)
",-0.942056,-0.698685,-1.512083,-0.814943,0.555029,-0.045204,0.116268,0.206649,-0.00478,0.375843,-0.122511,0.144942,-0.189639,0.023075,0.221273
openstack/charm-ceph-nfs,Ib76f6889bf8bf72465f00e592c557af043a00731,1,0,0.9412,1.0986,0.5,1,3.67,187,0,Bug Fix,0,0,0,51,0.004625,0.9388,0,0.8836,0,1,0,0.6667,0.0,0.0,-73.76,26.92,1,0,0.0,1,62.3333,0,0,0,0,0,"Fix: source default
[SEP]
FILES CHANGED:
config.yaml (+1, -1)
",5.389897,0.978029,2.957135,-0.520612,-0.838944,1.081071,-0.123268,-0.321385,0.711914,0.193063,-0.358984,-0.890446,0.761164,0.482702,0.028241
openstack/kolla-ansible,I8cf38c2f7db1493e7303e94c212251fbeafaced3,1,1,0.561,1.6094,0.5,1,8.67,412,0,Bug Fix,0,0,0,205,0.017135,0.5,0,0.2805,1,1,0,0.6823,0.0,1.0,38.6,12.7,0,0,0.0,0,82.4,0,6,0,8,0,"cli: Add check=True to catch Ansible failures

From [1]:
If check is true, and the process exits with a non-zero
exit code, a CalledProcessError exception will be raised.
Attributes of that exception hold the arguments, the exit
code, and stdout and stderr if they were captured.

[1]: https://docs.python.org/3/library/subprocess.html

Closes-Bug: #2089173
[SEP]
FILES CHANGED:
kolla_ansible/utils.py (+2, -2)
",-1.280258,-0.493185,-0.203988,0.18349,-0.758027,0.337155,-0.307758,-0.152685,0.423162,0.677817,0.113191,-0.21528,0.281117,0.424688,-0.293178
openstack/kolla-ansible,I7cbc6a94608baf4f04ef231cc88397fc5dcf0a9b,1,1,0,2.5649,0.0833,2,14.0,138,0,Bug Fix,0,0,0,0,0.0,0.25,0,0.0,4,2,0,0.6828,0.65,3.0,29.47,17.03,1,0,0.0,1,10.6154,0,6,0,12,0,"Fix external ceph cinder keyring

Change from file to template

Closes-Bug: #2089229
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/external_ceph.yml (+1, -1)
releasenotes/notes/external-ceph-cinder_key-1a4c38fff3e2ab3c.yaml (+10, -0)
",1.497999,-1.310664,-0.404066,-1.136844,-0.29834,0.20073,-1.069063,0.664062,0.058119,-0.364795,0.069121,-0.188883,0.00087,0.070622,0.092732
openstack/kayobe,I6e33f9897dc7efc57987872ffccdfbe0fc78cc52,1,1,1.0,3.2189,0.375,3,16.67,455,0,Bug Fix,0,0,0,1,0.083333,1.0,0,1.0,4,3,0,0.9153,1.0434,3.33,-19.89,20.27,1,0,0.0,1,18.2,0,6,0,16,0,"Ensure ironic-python-agent matches ironic-lib

If ironic-python-agent is not installed in the IPA image using
upper-constraints, the ironic-lib selected by pip for installation may
be newer than ipa.

Use upper-constraints for the same version as ironic-python-agent when
installing it, by passing the DIB_REPOREF_requirements environment
variable to ironic-python-agent-builder.

Closes-Bug: #2089263
[SEP]
FILES CHANGED:
doc/source/configuration/reference/ironic-python-agent.rst (+8, -9)
ansible/inventory/group_vars/all/ipa (+1, -0)
releasenotes/notes/pin-ipa-requirements-f9566011b2400e6c.yaml (+6, -0)
",-1.317478,-0.113393,-0.387873,0.79312,0.291904,-0.845017,-0.115077,0.470332,0.08545,-0.185848,0.260583,0.077437,0.03271,0.351622,0.407559
openstack/ironic,Ia0b543aaedc03d4030e0335236b9b336ef0ce355,0,0,1.0,0.6931,0.0,1,6.25,196,0,Doc,0,0,0,6,0.041379,1.0,0,1.0,2,1,0,0.96,0.0,2.0,27.91,15.3,1,0,0.0,1,98.0,0,0,0,0,0,"Use quay.io registry image for metal3 job

As alternative to docker registry image.
This is to avoid issues related to dockerhub rate limits.
[SEP]
FILES CHANGED:
playbooks/metal3-ci/run.yaml (+1, -0)
",1.179567,-1.239716,-0.215818,0.556433,-0.309252,-0.065253,0.713977,0.506363,-0.178848,-0.402366,-0.193184,0.148303,0.020633,-0.191783,-0.400929
openstack/kolla-ansible,I3434eb7f751553a3a29a718ac20975529736bc3b,1,0,0.5631,1.0986,0.5,1,7.0,91,0,CI,1,0,0,206,0.017213,0.3571,0,0.2011,1,1,0,0.6833,0.0,1.0,-41.98,25.66,0,0,1.0,0,30.3333,0,0,0,0,0,"CI: Use libpod/registry for registry
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",2.899485,2.068916,1.20991,0.452173,0.413154,-0.333589,0.238089,0.255057,-0.522072,-0.254483,-0.330279,-0.808957,-0.059889,0.036096,-0.069468
openstack/kolla,I581ff79993d011b421d69295a6552cb14b8e2e66,0,0,0.5652,2.7726,0.4667,3,7.0,96,0,Feature,0,0,0,207,0.017293,0.4706,0,0.266,3,2,0,0.6711,1.5058,2.33,-29.9,25.66,1,0,0.0,1,6.0,0,0,0,0,0,"Move uwsgi installation to openstack-base
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+3, -0)
docker/barbican/barbican-base/Dockerfile.j2 (+0, -7)
releasenotes/notes/uwsgi-openstack-base-ac583652d29ea0e4.yaml (+5, -0)
",1.730737,1.208855,1.112087,0.607028,0.845784,-0.640912,0.504309,0.980235,-0.255176,-0.522785,0.056365,0.072976,-0.23634,0.265567,0.687896
openstack/kolla-ansible,I084ed924a60ae266c3f51a44c22834402ef7f00e,0,0,0.5625,4.3694,0.1282,5,3.33,154,0,Feature,0,0,0,208,0.017355,0.4,0,0.225,4,3,0,0.6839,2.1867,3.6,-75.73,17.33,1,0,0.0,1,1.9494,0,0,0,0,0,"nova: Add support for using uWSGI

Depends-On: https://review.opendev.org/c/openstack/kolla/+/935974
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova-api.json.j2 (+10, -3)
ansible/roles/nova/defaults/main.yml (+7, -1)
releasenotes/notes/uwsgi-aef85ccbc76dab3e.yaml (+13, -0)
ansible/roles/nova/tasks/config.yml (+27, -2)
ansible/roles/nova/templates/nova-metadata.json.j2 (+11, -4)
",0.075754,3.42948,-1.642974,-0.19052,-1.40451,0.497683,-0.298292,-0.444668,-0.080326,-0.659532,-0.855739,-0.128904,0.150402,-0.528312,-0.072296
openstack/charm-mysql-innodb-cluster,Ide1b222c36edbe65de123a57630fe3dc24c4d6b6,1,1,0.8182,3.6109,0.0833,3,17.0,521,0,Bug Fix,0,0,0,22,0.019802,1.0,0,0.8182,4,2,0,1.0,1.5752,2.33,36.55,13.86,1,0,0.0,1,14.0811,0,52,0,4,0,"Add gtid-purged-mode option

When creating a backup of a database, the --set-gtid-purged settin must
be set to OFF if the dump is to be restored on a different MySQL
cluster. This change creates a knob in the mysql dump action of the
charm that allows setting this option to one of the supported values.

Closes-Bug: #2040159

(cherry picked from commit d931f05933278c24aa86b86db187f9df85d032fb)
[SEP]
FILES CHANGED:
src/actions.yaml (+11, -0)
src/lib/charm/openstack/mysql_innodb_cluster.py (+12, -2)
src/actions/actions.py (+10, -1)
",-1.305288,-0.571149,-0.254497,-0.357436,0.442928,0.082783,0.904297,-0.043037,0.574989,0.104058,0.686815,0.256092,0.022375,-0.10143,0.10552
openstack/ironic,Ib2fd5ddcbee9a9d1c7e32770ec3d9b6cb20a2e2a,1,0,0.8571,3.5835,0.0571,3,10.4,389,1,Bug Fix,0,0,0,7,0.0175,0.0,0,0.0,4,2,0,0.9524,1.519,2.67,35.21,13.39,1,0,0.3714,1,10.8056,0,0,0,0,0,"Calculate missing checksum for file:// based images

The fix for CVE-2024-47211 results in image checksum being required in
all cases. However there is no requirement for checksums in
file:// based images.

This change checks for this situation. When checksum is missing for
file:// based image_source it is now calculated on-the-fly.
[SEP]
FILES CHANGED:
ironic/common/checksum_utils.py (+13, -2)
ironic/tests/unit/common/test_checksum_utils.py (+13, -0)
releasenotes/notes/missing_file_checksum-4931c98031951486.yaml (+7, -0)
",-1.159397,-0.404238,-0.106375,0.784159,0.227144,0.33932,-0.429346,-0.39925,0.451927,0.517082,-0.190355,0.112476,0.487021,-0.204081,0.318416
openstack/ironic,I62403120c758caac38a4d2b3912a9c43f65161cc,1,0,0,2.3979,0.0,3,10.5,203,0,CI,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.9528,1.2955,2.0,6.83,17.53,1,0,0.0,1,18.4545,0,0,0,0,0,"Update Node Cache after Successful Clean/Service

This commits makes sure we call update_node_cache
after we finish a successful cleaning/servicing.
[SEP]
FILES CHANGED:
releasenotes/notes/update-node-cache-after-successful-servicing-cleaning-7433c493e31742b0.yaml (+6, -0)
ironic/conductor/servicing.py (+3, -0)
ironic/conductor/cleaning.py (+1, -0)
",1.53494,-0.432673,-0.029546,0.624387,0.182392,0.495181,0.01855,-0.573534,-0.080062,-0.406329,-0.055369,-0.43297,-0.25299,0.196144,0.036918
openstack/charm-manila,I8328a4bf63df20685ce78517571ebcc8e94f30c2,1,0,1.0,4.2905,0.0,1,4.67,240,0,Feature,0,0,0,4,0.307692,0.0,0,0.0,3,1,0,1.0,0.0,3.0,17.79,16.15,1,0,0.0,1,3.2877,0,0,0,0,0,"Update paste configuration for >= caracal

oslo_middleware.ssl was removed at 2024.1; pick the api-paste.ini
from the upstream caracal branch to use for OpenStack releases
after 2024.1.
[SEP]
FILES CHANGED:
src/templates/caracal/api-paste.ini (+72, -0)
",1.199206,-0.717898,-0.201203,-0.08095,-0.459052,-0.328253,-0.139985,0.98186,-0.319776,-0.018021,-0.435316,0.076293,-0.989248,0.05859,0.513652
openstack/charm-ceph-radosgw,I295baab496d1eb95daaa8073d4119d01b90d0b38,1,1,0,5.0499,0.1806,11,9.5,274,0,Bug Fix,0,0,1,0,0.0,1.0,0,0.0,2,5,0,0.9444,2.7783,0.91,-38.8,14.33,0,0,0.471,1,1.7564,0,26,0,15,0,"Add a config option for virtual hosted bucket

func-test-pr: https://github.com/openstack-charmers/zaza-openstack-tests/pull/1187

Closes-Bug: #1871745
(cherry picked from commit 6f2a7540e8102fc7575731e7e059695cd1c28a76)
[SEP]
FILES CHANGED:
hooks/hooks.py (+13, -1)
hooks/utils.py (+7, -2)
unit_tests/test_ceph_radosgw_context.py (+62, -0)
lib/charms_ceph/utils.py (+2, -2)
test-requirements.txt (+6, -5)
hooks/ceph_radosgw_context.py (+12, -1)
templates/ceph.conf (+4, -0)
lib/charms_ceph/broker.py (+1, -1)
config.yaml (+10, -0)
templates/openstack_https_frontend.conf (+3, -0)
tox.ini (+7, -16)
",-0.746638,1.336122,-1.754495,-1.347042,0.118364,-0.10411,0.339624,0.068358,0.37517,0.038752,-0.257916,-0.143681,0.407026,0.070888,0.263066
openstack/kolla-ansible,If929c79a59816ec46a0263b8238bede396f73c2d,1,0,1.0,2.9444,1.0,2,11.67,301,0,CI,0,0,0,4,0.026144,0.6154,1,0.6154,3,1,0,0.6827,1.0,3.0,8.87,19.52,1,0,0.0,0,15.8421,0,0,0,0,0,"Quickstart guide - remove Ansible dependency

Removes Ansible from virtual environment dependencies install in
Quick Start guide for deployment and development as it's installed
as a requirement along Kolla-ansible since 2024.2 Dalmatian release.
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+0, -9)
doc/source/user/quickstart.rst (+0, -9)
",0.396574,-1.3622,-0.391406,0.000934,0.111903,-0.23385,-0.606844,0.724465,-0.597174,-0.065608,-0.468402,0.427978,-0.202912,0.15068,0.005028
openstack/kolla-ansible,I49bf9a45b8d926f85a4c2bc3308d0f1fd698309a,1,0,0.8889,1.6094,0.5,1,10.0,253,0,Feature,0,0,0,72,0.06223,0.6154,0,0.547,4,1,0,0.6833,0.0,4.0,16.21,16.0,1,0,0.0,0,50.6,0,0,0,0,0,"Avoid double quotes in HAProxy configuration

This avoids generating HAProxy configuration for Keystone that contains
double quotes. Although not invalid, it is unlike the rest of the
configuration.
[SEP]
FILES CHANGED:
ansible/roles/keystone/defaults/main.yml (+2, -2)
",0.849551,-1.635441,0.155846,0.952425,-0.086056,0.526438,-0.173018,0.014797,0.198597,0.216021,-0.441461,0.406171,0.030973,-0.335955,-0.196176
openstack/kolla-ansible,I0e07271312bbed49be7a986a2beda04f316dfc8f,1,0,0.5882,1.0986,0.5,1,3.5,107,0,Feature,0,0,0,34,0.057432,0.3765,0,0.2215,2,1,0,0.6838,0.0,2.0,-98.86,18.54,0,0,0.0,0,35.6667,0,0,0,0,0,"update openstack_previous_release_name var to 2024.1
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -1)
",0.814295,1.04396,0.205946,0.008767,1.197184,0.125396,-0.874576,0.369249,0.88713,0.273961,-0.223929,-0.716816,-1.664721,0.018635,0.310428
openstack/kolla,I06e61ab388d9ecfa78e5d1fe1ae9cb8602d1cd36,1,1,0.0,1.9459,0.5,2,6.6,361,0,Bug Fix,0,0,0,1,0.090909,0.6667,0,0.0,3,1,0,0.6689,0.9183,3.0,-17.77,18.4,0,0,0.0,0,51.5714,0,6,0,13,0,"Adds missing nvme package in cinder-backup

The package moved to the cinder-base image since it already added to
the cinder-volume in I84c7633765749a5e9ced983505ef290c32154ccc.

Closes-Bug: #2089587
[SEP]
FILES CHANGED:
docker/cinder/cinder-volume/Dockerfile.j2 (+0, -2)
docker/cinder/cinder-base/Dockerfile.j2 (+3, -1)
",-0.166604,-1.106907,-1.597323,-1.434218,0.6197,0.005181,0.004743,0.060324,0.014668,-0.292845,-0.227931,0.171015,-0.075292,0.334609,0.166676
openstack/kolla-ansible,I7c7213eed10dc408238071a43fd89d5e66665e7b,0,0,0.5598,5.2832,0.1071,11,17.0,152,0,CI,0,0,0,209,0.017326,0.4167,0,0.2333,4,4,0,0.6843,2.7811,3.27,0.47,23.27,1,0,0.0153,1,0.7716,0,0,0,0,0,"nova: Split out metadata to a separate container

This is needed for introducing standalone uWSGI
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+3, -0)
ansible/roles/nova/templates/nova-metadata-wsgi.conf.j2 (+51, -0)
ansible/roles/nova/templates/nova.conf.j2 (+2, -0)
releasenotes/notes/nova-metadata-split-d1c9ff2010390352.yaml (+5, -0)
ansible/roles/nova/defaults/main.yml (+30, -0)
ansible/roles/nova/tasks/config.yml (+10, -0)
ansible/roles/nova/templates/nova-api-wsgi.conf.j2 (+1, -21)
ansible/roles/nova/templates/nova-metadata.json.j2 (+50, -0)
tests/templates/inventory.j2 (+3, -0)
ansible/roles/nova/handlers/main.yml (+17, -0)
ansible/inventory/all-in-one (+3, -0)
",2.31994,-1.192623,0.430604,-0.053353,-0.396004,0.823975,-0.022579,-0.033365,-0.497054,-0.30278,-0.454332,0.397185,-0.025499,0.256513,-0.277235
openstack/kolla,I3fab494e939478458c2c299303f5c2c91943e0ec,1,0,0.5571,2.3026,0.0,1,9.0,100,0,CI,1,0,0,210,0.01713,0.625,0,0.3482,2,1,0,0.67,0.0,2.0,-9.1,21.38,0,0,1.0,0,10.0,0,0,0,0,0,"CI: Use debian/ubuntu images from quay mirror
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+9, -0)
",2.471538,1.181163,0.602427,0.252112,0.678356,-0.108417,0.565963,0.65598,-1.16508,-0.142617,0.238066,0.01313,0.754558,0.090038,-0.374001
openstack/kolla-ansible,I46af6ff709dff4f7a0942df4dadf001c653f44fa,0,0,0.5592,3.912,0.0,4,10.67,255,0,Feature,0,0,0,211,0.017199,0.0,0,0.0,4,3,0,0.6832,1.6324,3.5,16.23,15.52,1,0,0.0,1,5.1,0,0,0,0,0,"Add service-uwsgi-config role

This role is a standard service role to be used in all
respective services roles to generate uwsgi configuration.

It is mainly based on Devstack configuration template.
[SEP]
FILES CHANGED:
ansible/roles/service-uwsgi-config/tasks/main.yml (+9, -0)
ansible/roles/service-uwsgi-config/defaults/main.yml (+8, -0)
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+28, -0)
releasenotes/notes/service-uwsgi-config-cf82829aa6457a92.yaml (+4, -0)
",1.134825,-1.091553,0.001447,0.908495,0.105747,-0.297355,0.366484,0.186935,0.223377,-0.371728,-0.50344,0.360964,-0.049291,0.320177,-0.359414
openstack/kolla-ansible,I14d3ee3f94b8138188f70b2b5106145d33943eaf,1,0,0.5566,0.6931,0.0,1,10.0,99,0,CI,1,0,0,212,0.017212,0.3846,0,0.2141,2,1,0,0.682,0.0,2.0,44.41,16.0,0,0,1.0,0,49.5,0,0,0,0,0,"CI: skip Cinder HA precheck for zun scenario
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -0)
",2.37486,0.14667,1.05851,-0.091239,1.107815,0.154454,-0.15537,0.094232,-0.129241,-0.209316,0.219094,-0.22257,0.496738,-0.422193,0.099514
openstack/kolla-ansible,Ib83c5da6534f06e38bb50b298f68302fd637f8d9,1,0,0.5587,0.6931,0.0,1,4.5,107,0,CI,1,0,0,213,0.017292,0.5385,0,0.3008,1,1,0,0.6826,0.0,1.0,23.67,19.58,0,0,1.0,1,53.5,0,0,0,0,0,"CI: Add group_vars/all.yml trigger for all scenarios
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
",1.541615,1.232454,0.621955,0.153767,0.758661,-0.785926,-0.405286,0.152444,0.030001,0.236077,-0.286175,-0.949675,-0.634256,0.425718,-0.070897
openstack/ansible-collection-kolla,Ib037f75269e545d6130d913aeaeae0579cafd8fb,0,0,0.1923,1.0986,0.5,1,3.4,180,0,Feature,0,0,0,26,0.209677,0.0,1,0.0,2,1,0,0.5,0.0,2.0,14.28,13.12,1,0,0.0,0,60.0,0,0,0,0,0,"reno: Update master for unmaintained/2023.1

Update the 2023.1 release notes configuration to build from
unmaintained/2023.1.
[SEP]
FILES CHANGED:
releasenotes/source/2023.1.rst (+1, -1)
",0.558606,0.484571,-0.783791,0.442685,0.494514,0.153121,-0.225812,0.685103,-0.39934,0.389587,-0.274881,0.243845,-0.5489,0.655385,0.300511
openstack/kolla-ansible,Ie70802d0b66abdad82dcaf7181f7222a2f7e7132,0,0,0.1852,1.0986,0.5,1,3.4,180,0,Feature,0,0,0,27,0.214286,0.0,1,0.0,2,1,0,0.6831,0.0,2.0,4.33,13.12,1,0,0.0,0,60.0,0,0,0,0,0,"reno: Update master for unmaintained/2023.1

Update the 2023.1 release notes configuration to build from
unmaintained/2023.1.
[SEP]
FILES CHANGED:
releasenotes/source/2023.1.rst (+1, -1)
",0.558606,0.484571,-0.783791,0.442685,0.494514,0.153121,-0.225812,0.685103,-0.39934,0.389587,-0.274881,0.243845,-0.5489,0.655385,0.300511
openstack/kolla,Ie2a747223b33039684650bede8863af0c8906d2f,0,0,0.5607,4.0604,0.4386,6,12.0,236,0,Feature,0,1,0,214,0.017372,0.5833,0,0.3271,2,4,0,0.6711,2.4571,2.0,14.88,16.47,1,0,0.2456,1,4.069,0,0,0,0,0,"Revert ""CentOS/Rocky: use CentOS Cloud SIG repo instead of Delorean (Dalmatian)""

This reverts commit db0f87d3c8e1e7eccdeb1ea46216d530711680d3.

Reason for revert: Epoxy cycle is on
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+14, -2)
docker/base/ci-centos.repo (+0, -8)
releasenotes/notes/rdo-dalmatian-bab7a517c219cb23.yaml (+0, -5)
tests/templates/template_overrides.j2 (+13, -1)
docker/base/ci-rocky.repo (+0, -8)
kolla/common/config.py (+5, -1)
",0.568337,-0.077891,-1.916938,-1.481634,0.488559,0.38777,1.427155,0.256587,-0.118823,-0.308844,0.168891,0.21168,0.049075,-0.02107,-0.332114
openstack/kolla,I1265633f0913b7927955564fac911a682615004a,0,0,0.5581,2.0794,0.4286,4,5.0,471,0,Feature,0,1,0,215,0.017372,0.3333,0,0.186,3,2,0,0.6689,1.9502,2.5,13.95,13.2,1,0,0.0,0,58.875,0,0,0,0,0,"Revert ""[release] Use Dalmatian sources by default""

This reverts commit 5af5febf50bc0a02422b437b16598570d0c5ffe3.

Reason for revert: Epoxy cycle is on

In addition to the revert skyline-apiserver aiosqlite u-c
is removed until [1] is merged, designate rootwrap.conf.sample
file has been renamed to rootwrap.conf and pycadf is bumped to 4.0.0.

[1]: https://review.opendev.org/c/openstack/skyline-apiserver/+/935604
[SEP]
FILES CHANGED:
docker/skyline/skyline-apiserver/Dockerfile.j2 (+2, -0)
kolla/common/sources.py (+1, -1)
docker/designate/designate-base/Dockerfile.j2 (+0, -1)
kolla/common/config.py (+1, -1)
",-1.215516,0.766291,0.117569,-1.202031,-0.213846,-0.132154,1.112632,0.378751,0.089095,-0.096282,0.395219,0.12161,-0.710972,-0.006218,-0.188325
openstack/kolla-ansible,I044affa85290caf9d71e8ba5bc7cf0f5be8941e7,1,0,0.5556,2.1972,0.0,1,14.0,170,0,CI,1,0,0,216,0.017443,0.4,0,0.2222,1,1,0,0.682,0.0,1.0,-30.96,22.74,0,0,1.0,0,18.8889,0,0,0,0,0,"CI: Use debian/ubuntu mirrored images on build

(cherry picked from commit ce4ff5a0b82d12d1399506b270aaf763a3b7304c)
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+8, -0)
",0.573836,-0.152608,-1.955969,-2.475586,1.658833,0.334649,0.476776,-0.681238,-0.3968,0.310062,-0.648105,0.490715,0.023802,0.010508,-0.375022
openstack/magnum,I3e5560dd487525d9566930772b0c56d52d974500,1,1,0.5576,1.3863,0.3333,1,4.5,225,0,Bug Fix,0,0,0,217,0.017513,0.0,0,0.0,3,1,0,0.9,0.0,3.0,-9.23,15.13,0,0,0.0,0,56.25,0,6,0,8,0,"Fix sqlalchemy with osprofiler

Breakage seen in magnum-capi-helm unit tests after [1].

[1]: https://review.opendev.org/c/openstack/magnum/+/927446

Closes-Bug: #2089934
[SEP]
FILES CHANGED:
magnum/db/sqlalchemy/api.py (+2, -1)
",0.404567,1.199974,-1.076975,-0.625227,-1.202047,-0.106257,0.039176,0.414861,0.290363,-0.166307,-0.088201,-0.149072,-0.117511,-0.256221,0.053379
openstack/kolla-ansible,Ic0e33c4f2939c36ed80caa3ec1015cf53a4d93e2,1,0,0.5596,3.434,0.2,2,6.0,81,0,Feature,0,0,0,218,0.017589,0.6667,0,0.3731,2,2,0,0.6825,0.65,1.5,-53.05,22.4,0,0,0.0,1,2.6129,0,0,0,0,0,"Retry Ansible Galaxy calls
[SEP]
FILES CHANGED:
kolla_ansible/utils.py (+19, -6)
releasenotes/notes/install-deps-retries-fbe2a3abb41abb6d.yaml (+5, -0)
",3.474832,1.455212,1.373776,0.35189,0.564569,0.776148,0.177297,0.420996,0.324179,-0.277043,0.445122,-0.074779,0.561884,-0.57164,0.022505
openstack/kolla,I56cf5a869e854f760874d207802173c89b04c0df,1,0,0.8904,0.6931,0.0,1,3.0,81,0,Feature,0,0,0,73,0.062877,0.1522,0,0.1355,0,1,0,0.6667,0.0,0.0,20.49,21.2,1,0,0.0,0,40.5,0,0,0,0,0,"Add Python 3.12 classifier
[SEP]
FILES CHANGED:
setup.cfg (+1, -0)
",3.799443,1.302656,1.837184,0.380596,0.359835,0.533399,0.833577,1.481598,0.431209,1.572707,-0.40612,0.281658,-0.455339,0.264814,0.674703
openstack/kolla,I15f9b5cf3976f4298cdc7da4530f2d7d09614e88,0,0,0.5797,1.9459,0.5,3,16.0,478,0,Feature,0,0,0,69,0.015454,0.0,0,0.0,3,2,0,0.6678,0.9183,3.0,26.68,17.03,1,1,0.0,0,68.2857,0,0,0,0,0,"[letsencrypt] Rename script for updating certificates

This patch renames the update-haproxy-cert script to
update-loadbalancer-cert to make the name more generic.
The change is necessary because support for ProxySQL
will be introduced in the next patch, requiring a name
that reflects broader applicability.

To keep the diff in the following patch clean and easier
to review, this patch focuses exclusively on the rename.
[SEP]
FILES CHANGED:
docker/haproxy/haproxy-ssh/update-loadbalancer-cert.sh (+0, -0)
docker/letsencrypt/letsencrypt-lego/sync-and-update-certificate.sh (+2, -2)
docker/haproxy/haproxy-ssh/Dockerfile.j2 (+1, -1)
",-0.501842,-1.094857,0.158581,0.724572,-0.243897,0.056292,0.279584,-0.032769,0.283675,0.301911,0.024414,0.289753,-0.147927,-0.093486,-0.019583
openstack/kolla-ansible,Iff41d14e931cd958f28a3767febc51248662508b,0,0,0.8529,3.3322,0.2222,6,5.0,697,0,CI,0,0,0,34,0.030994,0.4545,0,0.3877,4,3,0,0.683,2.1603,3.67,-12.99,14.31,1,0,0.0,1,24.8929,0,0,0,0,0,"Cinder: move to block-storage in service catalog

There are movements to standardise on this new name [1].
Tempest testing does not work out-the-box without this change, as they
moved to ``block-storage`` already [2].

Also replace references to cinder via catalog_info to just selecting the
interface instead. This makes the configuration more consistent across
all services.

1. https://lists.openstack.org/archives/list/openstack-discuss@lists.openstack.org/thread/QQ7L44VE4MOWOQVOFCZQPTIVI35A6SCK/
2. https://github.com/openstack/tempest/commit/1a744c8042d3c5c5ad153ef1e645975428ba0dfe

Co-Authored-By: Seunghun Lee <seunghun@stackhpc.com>
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+10, -1)
ansible/roles/nova/templates/nova.conf.j2 (+1, -1)
ansible/roles/nova-cell/templates/nova.conf.j2 (+1, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -2)
ansible/roles/skyline/templates/skyline.yaml.j2 (+1, -1)
releasenotes/notes/cinder-use-block-storage-in-service-catalog-7063d6b7d1039e36.yaml (+8, -0)
",-3.322856,1.90181,1.166187,-1.05966,-0.091518,0.219484,0.637061,-0.046091,0.071485,-0.14523,0.189478,-0.049014,-0.062492,-0.104083,-0.120906
openstack/kolla-ansible,Id5305aae4e92fbb9a12aa0f569fb7600b5f2d069,1,0,0.6154,2.8904,0.2353,2,11.0,118,0,Feature,0,0,0,13,0.073034,0.0,0,0.0,4,2,0,0.6819,0.9975,3.0,-4.29,22.58,1,0,0.0,1,6.5556,0,0,0,0,0,"keystone: handle OIDC metadata & attribute mappings as template
[SEP]
FILES CHANGED:
releasenotes/notes/template-config-federation-oidc-8e62742de5fcb376.yaml (+9, -0)
ansible/roles/keystone/tasks/config-federation-oidc.yml (+4, -4)
",2.005479,-0.002125,1.195313,0.459249,1.398091,-0.191707,-0.292501,0.267825,0.284196,-0.117095,-0.525287,-0.345944,0.385134,-0.875541,0.023116
openstack/kolla-ansible,Ifeb36cc01eaf584f7c3c6048b5088f64ae33b9f3,1,0,0.8286,2.7726,0.2667,2,7.0,94,0,Feature,0,0,0,35,0.031139,0.75,0,0.6214,4,2,0,0.6824,0.9183,3.0,-17.81,25.66,0,0,0.0,1,5.875,0,0,0,0,0,"Support deleting services and endpoints
[SEP]
FILES CHANGED:
releasenotes/notes/support-deleting-services-and-endpoints-78341a638b939d68.yaml (+5, -0)
ansible/roles/service-ks-register/tasks/main.yml (+6, -4)
",2.791133,1.823107,2.119092,1.371461,1.4665,0.434218,0.169256,0.03903,0.306912,0.019,-1.087353,-0.607335,0.715724,0.014761,-0.050025
openstack/kolla-ansible,I20f3b082d169816e16e6a8d31caf5d493579771a,0,1,1.0,4.5109,0.5,9,13.5,395,0,Bug Fix,0,0,0,2,0.068966,1.0,1,1.0,4,1,0,0.6829,2.5872,3.22,34.9,17.25,1,0,0.0,0,4.3407,0,6,0,7,0,"Updates docs for newer kolla-ansible CLI syntax

2024.2 introduced a rewritten kolla-ansible CLI in Python
which is more sensitive to what place the inventory is specifed.

The new syntax is `kolla-ansible <action> <arguments>` so this
updates the docs to change the out of date examples for using the
kolla-ansible CLI.

Closes-Bug: 2090620
[SEP]
FILES CHANGED:
doc/source/admin/tls.rst (+2, -2)
doc/source/admin/password-rotation.rst (+2, -2)
doc/source/admin/mariadb-backup-and-restore.rst (+5, -5)
doc/source/user/quickstart-development.rst (+3, -3)
doc/source/user/quickstart.rst (+3, -3)
doc/source/reference/containers/magnum-guide.rst (+1, -1)
doc/source/reference/networking/octavia.rst (+2, -2)
doc/source/user/adding-and-removing-hosts.rst (+9, -9)
doc/source/user/operating-kolla.rst (+18, -18)
",-0.859933,-0.499676,-0.48152,0.37562,-0.076771,-0.215209,0.020316,0.120613,-0.048425,0.061367,0.124875,0.019409,0.120252,-0.088271,0.310595
openstack/kolla-ansible,Ibcef3e642e5ff87aab6d8f73bda9860016cf715a,0,0,0.5616,1.9459,0.5,3,3.0,391,0,Feature,0,0,0,219,0.017627,1.0,0,0.5616,4,1,0,0.6818,1.585,3.67,-19.64,14.53,0,0,0.0,0,55.8571,0,0,0,0,0,"Replace ipaddr with ansible.utils.ipaddr

[DEPRECATION WARNING]: Filter ""ansible.netcommon.ipaddr"" has been deprecated.
Use 'ansible.utils.ipaddr' module instead. This feature will be removed from
ansible.netcommon in a release after 2024-01-01.
Deprecation warnings can be disabled by setting deprecation_warnings=False in
ansible.cfg.
[SEP]
FILES CHANGED:
roles/multi-node-managed-addressing/tasks/main.yml (+1, -1)
ansible/roles/loadbalancer/tasks/precheck.yml (+1, -1)
ansible/roles/ovs-dpdk/defaults/main.yml (+1, -1)
",-1.264841,2.094947,-0.548295,1.23349,0.157315,0.202662,0.022343,-0.025836,0.307819,0.263776,0.536855,-0.096236,-0.40683,-0.006213,-0.111212
openstack/kolla-ansible,If8ad229281b2dca565570d651065779c2c871528,0,0,0.5591,3.2958,0.8462,4,8.5,154,0,CI,0,0,1,220,0.017699,0.7778,0,0.4348,0,3,0,0.6807,1.5326,0.0,24.03,15.16,0,0,0.0,1,5.7037,0,0,0,0,0,"CI: Bump ansible-lint to <26

Remove yamllint usage - it duplicates what reno lint/ansible-lint do.
[SEP]
FILES CHANGED:
.yamllint (+0, -16)
lint-requirements.txt (+1, -1)
tox.ini (+0, -5)
.ansible-lint (+3, -0)
",0.956662,0.640087,-0.594266,0.107278,0.209684,-0.742593,-0.062076,-0.68701,-1.116436,0.143695,0.463584,0.101272,-0.364361,-0.256235,0.430968
openstack/kolla,I733a50b5ca455cfa4b248dc324500d78c17c817b,1,1,0.5,2.3979,0.1,2,13.25,409,0,Bug Fix,0,0,0,2,0.025,0.5,0,0.25,2,2,0,0.6656,0.971,2.0,33.76,16.62,0,0,0.0,1,37.1818,0,8,0,8,0,"Time mismatch in /etc/localtime and /etc/timezone

Python3-pip installs the dependent package tzdata
and blocks the mount of the /etc/localtime file in docker.

After deleting the symbolic link docker correctly mounts
the external localtime file.
Applies only to ubuntu 24.04, in previous versions
of ubuntu there was no such problem

Closes-Bug: #2091161
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2091161-a99c5c243c2514ac.yaml (+6, -0)
docker/base/Dockerfile.j2 (+3, -1)
",-0.638608,-1.612369,0.131816,-0.0877,-0.433609,-0.506729,0.151589,0.65496,-0.162396,0.266071,0.048361,-0.282231,0.117009,0.54316,0.271953
openstack/kolla,I406ff10edec9dc94b1a3de005080e149ee3ab3f2,0,0,0.5714,3.1355,0.4545,1,9.0,691,0,Bug Fix,0,0,0,70,0.015656,0.3333,0,0.1905,3,1,0,0.6667,0.0,3.0,3.83,12.49,1,0,0.0,0,30.0435,0,0,0,0,0,"Fix EAB support in letsencrypt

This patch fixes recently merged [1] patch.

 - Original patch added params function args
   eab, hmac, key_id, but then
   EXTERNAL_ACCOUNT_BINDING_OPTS var is passed
   into obtain_or_renew_certificate which
   can't work

 - This patch correctly set EXTERNAL_ACCOUNT_BINDING,
   HMAC, KEY_ID defaults and then call obtain_or_renew_certificate
   function with them. This will ensure that arguments are always
   set, so we can write if condtional correctly and process.

[1] https://review.opendev.org/c/openstack/kolla/+/916617

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/933924
[SEP]
FILES CHANGED:
docker/letsencrypt/letsencrypt-lego/letsencrypt-certificates.sh (+12, -10)
",-2.852138,1.624928,1.563639,-0.074878,0.111282,0.168784,-0.047645,-0.218907,0.025969,-0.266892,0.291083,-0.531888,0.042325,-0.073203,0.017769
openstack/kolla-ansible,Ie7ae47e5a624da31cf6cc5cd3c9239450487b8ed,1,0,0.5634,2.7081,0.5,1,5.77,684,1,Bug Fix,1,0,0,71,0.015802,0.25,0,0.1408,2,1,0,0.6796,0.0,2.0,15.99,12.97,1,1,1.0,0,45.6,1,0,0,0,0,"[CI] Fix testing inventory template due Ansible 2.16.14 breakage

Ansible 2.16.14 includes a fix for CVE-2024-11079 [1], which results
in the following error:

    jinja2.exceptions.UndefinedError:
        'ansible.vars.hostvars.HostVarsVars
         object' has no attribute 'ansible_host'

This issue occurs because Ansible now includes `localhost` in
`hostvars` without the `ansible_host` variable set, which
unexpectedly breaks our test inventory rendering.

This patch adds a filter to exclude `localhost`
during the rendering process, as it is irrelevant for our purposes.

[1] https://github.com/ansible/ansible/pull/84353
[SEP]
FILES CHANGED:
tests/templates/inventory.j2 (+7, -7)
",-2.202593,1.202398,1.296958,-0.133223,-0.289436,0.189837,0.077989,-0.069959,0.175238,0.206166,0.427222,-0.336042,-0.094371,-0.052256,-0.16771
openstack/kolla-ansible,I194529c178efcff0cb2a0ee1e14273389cd8f87f,1,0,0.8919,1.6094,0.5,2,5.0,192,0,Bug Fix,1,0,0,74,0.063683,0.4074,0,0.3634,2,1,0,0.6801,1.0,2.0,49.48,8.0,1,1,1.0,0,38.4,1,0,0,0,0,"[CI] Fix Ansible 2.16.14 breakage (cephadm jobs)

This is a follow up to Ie7ae47e5a624da31cf6cc5cd3c9239450487b8ed, but
for cephadm jobs.
[SEP]
FILES CHANGED:
tests/templates/ceph-inventory.j2 (+1, -1)
tests/templates/globals-default.j2 (+1, -1)
",0.203129,-0.296657,-2.139648,-1.709137,1.077288,0.278312,0.787007,-0.099784,-0.134131,0.280377,-0.362056,0.328766,-0.107316,-0.303044,-0.33235
openstack/kolla-ansible,I5b369caf7ff121aab31bb2aca269f6ba4c2d899e,1,0,0.5694,1.6094,0.5,1,3.5,95,0,CI,1,0,0,72,0.015975,0.0,0,0.0,1,1,0,0.6806,0.0,1.0,-14.26,18.54,1,1,1.0,0,19.0,1,0,0,0,0,"[CI] Use letsencrypt/pebble from quay.io
[SEP]
FILES CHANGED:
tests/deploy.sh (+2, -2)
",1.843462,2.013973,-0.122365,-0.029431,0.571931,-0.309145,0.181099,-0.190991,-0.867975,-0.176693,0.52878,-0.426954,-0.430529,-0.109632,-0.807287
openstack/kolla,I9c805b866ee359d2da150438ca78be25b1462988,1,0,0.5566,1.3863,0.6667,1,6.0,183,0,CI,0,0,0,221,0.017742,0.0,0,0.0,3,1,0,0.6645,0.0,3.0,49.17,9.07,0,0,0.0,0,45.75,0,0,0,0,0,"CI: Stop using LABEL for ephemeral0

For some reason it doesn't work in raxflex, i.e. the created filesystems
label is not seen.
[SEP]
FILES CHANGED:
roles/configure-ephemeral/tasks/main.yml (+1, -2)
",0.637256,-1.019301,-0.42154,0.066704,-0.045868,0.277142,-0.685592,-0.73633,-0.696581,0.207203,0.075968,-0.159144,-0.182653,-0.121736,-0.32412
openstack/kolla-ansible,Ie8c90ff5c8682aec07e851909bc820cba7602bec,1,0,0.8933,1.6094,0.25,1,7.0,361,0,Bug Fix,0,0,0,75,0.064322,0.0,1,0.0,4,1,0,0.6812,0.0,4.0,22.47,11.37,1,0,0.0,0,72.2,0,0,0,0,0,"docs: fix link to Cinder HA page

Fix URL by switching from KOLLA_OPENSTACK_RELEASE to OPENSTACK_RELEASE
introduced in [1]. This replaces `master` by `latest` in the URL.

The link was also not rendered correctly because of a syntax error.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/937440
[SEP]
FILES CHANGED:
doc/source/reference/storage/cinder-guide.rst (+3, -1)
",-1.36902,1.035254,-0.621738,0.157264,-0.496746,0.135413,-0.039367,0.304723,0.125296,0.250089,0.307201,-0.388465,-0.05665,-0.012985,-0.515239
openstack/kolla-ansible,I2d8393856249d2f999acb1a22424f6ef200f6e2d,1,0,0.8947,2.5649,0.4167,1,5.0,296,0,Doc,0,0,0,76,0.064957,0.619,0,0.5539,2,1,0,0.6817,0.0,2.0,-9.74,14.0,1,0,0.0,0,22.7692,0,0,0,0,0,"docs: define OPENSTACK_RELEASE

Update GLOBAL_VARIABLE_MAP to include OPENSTACK_RELEASE which is the
release name as returned by openstackdocstheme.ext._get_series_name().

Also mark 2023.1 (Antelope) as unmaintained and remove yoga and zed.
[SEP]
FILES CHANGED:
doc/source/conf.py (+7, -5)
",-0.396314,0.327741,-0.6657,0.408643,0.587003,0.256837,-0.298638,0.167199,0.216401,-0.375179,0.215773,-0.376845,-0.634554,0.013005,-0.43113
openstack/kolla-ansible,I706adef8efbd44e6d9f82f67f5a3cdb529f02fff,0,0,0.5586,3.8501,0.1087,5,7.0,194,0,Feature,0,0,0,222,0.017818,0.5,0,0.2793,4,3,0,0.6822,1.7919,3.6,14.42,12.32,1,0,0.0,1,4.1277,0,0,0,0,0,"placement: Add support for using uWSGI

Needed to set log_file because logs ended up with following name:
<frozen importlib._bootstrap>.log
[SEP]
FILES CHANGED:
ansible/roles/placement/templates/placement-api.json.j2 (+10, -3)
ansible/roles/placement/defaults/main.yml (+6, -0)
releasenotes/notes/uwsgi-aef85ccbc76dab3e.yaml (+2, -0)
ansible/roles/placement/templates/placement.conf.j2 (+1, -1)
ansible/roles/placement/tasks/config.yml (+22, -1)
",0.803287,-1.210187,-0.097499,-0.335598,0.006879,0.053672,-0.842626,-0.194657,-0.285991,-0.263336,-0.380723,-0.569998,-0.405387,0.011227,0.045228
openstack/kolla-ansible,I627c2e1f309297b625aa97e1bd1cbad7aa85f5b0,0,0,0.5561,3.7842,0.093,4,3.33,157,0,CI,0,0,0,223,0.017833,0.3125,0,0.1738,4,3,0,0.6811,1.6188,3.5,-75.73,17.33,1,0,0.0,1,3.5682,0,0,0,0,0,"cinder: Add support for using uWSGI

Depends-On: https://review.opendev.org/c/openstack/kolla/+/938185
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+6, -0)
ansible/roles/cinder/templates/cinder-api.json.j2 (+10, -3)
releasenotes/notes/uwsgi-aef85ccbc76dab3e.yaml (+2, -0)
ansible/roles/cinder/tasks/config.yml (+21, -1)
",0.95097,3.728607,-1.175096,-0.198235,-1.63172,0.50023,0.251552,-0.380776,0.145917,-0.662858,-0.734094,-0.105391,0.106833,-0.629941,0.091099
openstack/kolla-ansible,I969db1f2b6c7a7ea821ec51c73e9e9a519febc4c,1,0,0.5536,2.1972,0.0,1,12.0,286,0,Bug Fix,1,0,0,224,0.017851,0.4286,0,0.2372,2,1,0,0.68,0.0,2.0,32.5,9.24,0,0,1.0,0,31.7778,0,0,0,0,0,"CI: Increase mariadb_monitor_read_only_interval and RMQ timeouts

Since we switched to proxysql as default - we've been seeing healthy
mariadb nodes being marked as OFFLINE_HARD by proxysql due to timeouts.

This seems to fix that.
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+8, -0)
",-0.285388,-0.975575,-0.996753,0.424388,0.260569,-0.074881,-0.265285,-0.409215,-0.510757,-0.096661,0.433836,-0.389575,-0.082824,-0.588215,0.198941
openstack/kolla,Ife393e7f1b00fa37921e7822668d6a40dd467d5b,1,0,0.5556,2.3026,1.0,1,7.33,209,0,Bug Fix,1,1,0,225,0.01792,0.5,0,0.2778,2,1,0,0.6656,0.0,2.0,57.11,6.57,0,0,1.0,0,20.9,0,0,0,0,0,"Revert ""CI: Pin requests to <2.32 for publish jobs""

This reverts commit 428f37124986019bedc897469f9b1f3470b62082.

Reason for revert: Should be fixed now
[SEP]
FILES CHANGED:
tests/playbooks/publish.yml (+0, -9)
",0.630201,-0.133544,-1.627782,-1.634978,0.526763,0.843851,0.274825,-0.36321,0.32375,0.15023,-0.196846,0.162461,-0.276467,0.061945,-0.053981
openstack/kolla-ansible,Ie6be273e729f54b8a3fe364abcdd46ff4615cfea,0,0,0.5575,2.1972,0.25,1,7.5,138,0,CI,1,0,0,226,0.017986,0.4091,0,0.2281,1,1,0,0.6805,0.0,1.0,24.38,13.67,0,0,1.0,0,15.3333,0,0,0,0,0,"CI: Switch to stable/2024.2 tinyipa due to failures

Revert once master works again
[SEP]
FILES CHANGED:
tests/run.yml (+6, -2)
",2.005557,-1.033768,-0.310964,-0.852077,-0.58164,0.592672,0.128915,0.004113,-0.761379,0.45254,0.309987,0.068059,-0.211041,0.025666,-0.102668
openstack/python-magnumclient,I0337d55c1b24ffce7c798a81a286989c402efcc1,1,0,0,1.0986,0.5,1,3.29,663,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,1,0,1.0,0.0,2.0,-12.54,13.46,1,1,0.0,0,221.0,0,0,0,0,0,"[FIX]: check_hostname requires server_hostname in Magnum client

Resolve issue with Magnum client when using HTTPS endpoints in Python 3.12.
The error occurs due to `check_hostname` requiring `server_hostname` to be set
when `CERT_REQUIRED` is used in `SSLContext.wrap_socket`.

References:
- Python 3.12 SSL documentation: https://docs.python.org/3.12/library/ssl.html#ssl.SSLContext.check_hostname
- Related Magnum client commit from version 4.6.0: https://opendev.org/openstack/python-magnumclient/commit/5d8fd3840052e07418e007f336deb99fd58b7e92

Closes-bug: https://bugs.launchpad.net/magnum/+bug/2091103
[SEP]
FILES CHANGED:
magnumclient/common/httpclient.py (+1, -1)
",-3.229938,2.240421,0.918789,-0.570785,0.212862,0.239038,0.042584,0.238836,0.420157,-0.017394,-0.164413,-0.363016,-0.448383,-0.338399,0.091252
openstack/kolla-ansible,I316f6fc364bcff58c1f3ea1d884ec52de6e1675f,0,0,0.5551,5.3471,1.0,5,8.5,303,0,CI,0,0,0,227,0.018055,0.0,0,0.0,3,3,0,0.6794,1.9563,2.6,24.03,10.46,0,0,0.0622,0,1.4429,0,0,0,0,0,"Remove tacker demos from contrib and their usage in nfv CI

These are not usable for long time, based on legacy API [1],
CI fails with non-existent openstack client commands.

[1]: https://review.opendev.org/c/openstack/python-tackerclient/+/900977
[SEP]
FILES CHANGED:
contrib/demos/tacker/cleanup-tacker (+0, -20)
contrib/demos/tacker/README.rst (+0, -20)
tests/test-scenario-nfv.sh (+0, -13)
contrib/demos/tacker/deploy-tacker-demo-sfc (+0, -83)
contrib/demos/tacker/deploy-tacker-demo (+0, -73)
",-0.511752,0.570257,-0.864222,0.2021,-0.793729,-0.283525,0.330186,0.239253,-0.216926,-0.065127,-0.382146,-0.233056,0.208434,-0.26351,-0.193426
openstack/kolla,I97a97da73a7ccb27789e979656867e4adfe8a633,0,0,0.5526,5.0876,0.4161,15,5.0,247,0,CI,0,0,1,228,0.017838,1.0,0,0.5526,3,4,0,0.6667,3.4729,1.67,-47.81,16.0,0,0,0.5031,1,1.5247,0,0,0,0,0,"CI: Use ansible-lint for CI roles and playbooks

Removing dbus-python deps because now a-c-k handles that.

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/942179
[SEP]
FILES CHANGED:
roles/configure-ephemeral/tasks/main.yml (+7, -7)
.yamllint (+0, -10)
test-requirements.txt (+1, -0)
roles/kolla-build-deps/tasks/main.yml (+8, -18)
.ansible-lint (+12, -0)
tests/playbooks/run.yml (+11, -8)
roles/kolla-build-config/tasks/main.yml (+4, -1)
roles/kolla-build/tasks/main.yml (+5, -0)
tests/playbooks/pre.yml (+2, -1)
tests/vars/zuul.yml (+5, -1)
roles/configure-ephemeral/meta/main.yml (+4, -0)
tests/playbooks/post.yml (+11, -5)
test-requirements.yml (+5, -0)
tox.ini (+2, -2)
tests/playbooks/publish.yml (+17, -14)
",-0.481165,1.453514,-1.406265,-0.139158,-0.819875,-0.716543,-0.114262,-0.106846,-0.39096,-0.392402,-0.47077,-0.277621,0.411722,-0.055434,0.124524
openstack/ansible-role-systemd_networkd,Ia6b2f6e1e4cc62d2761e13c06b726bb7998f9ff9,1,0,0.9557,1.0986,0.0,1,7.0,97,0,Feature,0,0,0,203,0.055449,0.9677,0,0.9248,1,1,0,1.0,0.0,1.0,-17.81,19.94,0,0,0.0,0,32.3333,0,0,0,0,0,"Restart systemd-networkd on routes changes
[SEP]
FILES CHANGED:
tasks/main.yml (+2, -0)
",2.44417,0.894696,1.286125,0.502074,0.665635,-0.432675,0.142614,0.248158,-0.225657,-0.37745,-0.283242,-0.08623,0.391716,0.340045,-0.019467
openstack/kolla,I52105f6cbf7529ce107cabf8a38a10525be7435c,1,1,0.5502,2.4849,0.0,2,10.0,123,0,Bug Fix,0,0,0,229,0.017693,0.3077,0,0.1693,3,2,0,0.6645,0.8454,2.5,-31.73,24.0,0,0,0.0,0,10.25,0,6,0,11,0,"magnum: Add helm binary for magnum-cluster-api

Closes-Bug: #2091608
[SEP]
FILES CHANGED:
docker/magnum/magnum-conductor/Dockerfile.j2 (+3, -0)
kolla/common/sources.py (+8, -0)
",1.336742,0.622369,-1.101956,-0.749308,-0.187558,0.171118,-0.731171,0.387884,-0.157336,-0.621384,0.485566,0.497449,0.075446,0.075041,0.272472
openstack/kolla-ansible,Ice0eb62f2bb26ca6e3ac8d02c6ea787b60408a86,1,1,0.8961,3.4657,0.0,3,14.5,219,0,Bug Fix,0,0,0,77,0.065144,1.0,0,0.8961,4,3,0,0.6783,1.5095,2.33,14.17,18.21,1,0,0.0,1,6.8438,0,8,0,15,0,"Generate system scoped public-openrc

It can be useful to run Ironic commands on the public API if access to
the internal API is not possible.

Related-Bug: #2051837
[SEP]
FILES CHANGED:
ansible/roles/common/templates/public-openrc-system.sh.j2 (+15, -0)
ansible/post-deploy.yml (+9, -0)
releasenotes/notes/public-openrc-system-e52c9f5440b6f594.yaml (+7, -0)
",1.297594,-1.382773,-0.260206,0.165973,-0.892642,0.159958,-0.152207,0.221573,0.028963,0.006712,-0.321026,0.384326,0.072099,0.124452,-0.155004
openstack/kolla-ansible,I70f10a185a95aa0aad7285dfb0644fe9db536f67,1,1,0.8333,2.3979,0.4,2,8.67,231,0,Bug Fix,0,0,0,36,0.031607,1.0,0,0.8333,4,2,0,0.6789,0.971,3.0,25.58,12.7,0,0,0.0,1,21.0,0,6,0,5,0,"Remove problematic comments from fluentd.conf

Putting the path into these comments can cause a container restart when
no actual configuration has changed.

Closes-Bug: #2091703
[SEP]
FILES CHANGED:
ansible/roles/common/templates/fluentd.conf.j2 (+0, -4)
releasenotes/notes/fix-undesirable-restarts-of-fluentd-95a3bad7de82fd56.yaml (+6, -0)
",1.121595,-1.600606,-0.237789,-0.487163,-0.659508,0.344362,-0.544433,-0.123005,0.150768,-0.091335,-0.294786,-0.075765,-0.011178,0.382504,-0.149681
openstack/kolla-ansible,I33dd9b626e85ace41807f2f2b83452c6b8491a0f,0,0,0.5522,5.0239,0.2053,5,25.0,218,0,Feature,0,0,0,230,0.017755,0.4483,0,0.2475,5,3,0,0.6794,1.9783,3.0,22.41,18.0,0,0,0.0132,1,1.4342,0,0,0,0,0,"proxysql: Revert to upstream defaults for most settings

Add options to configure those settings that were hardcoded

Stop Kolla-Ansible from owning those defaults
[SEP]
FILES CHANGED:
releasenotes/notes/proxysql-revert-to-upstream-defaults-235abb7fb10bfcfd.yaml (+53, -0)
ansible/group_vars/all.yml (+0, -21)
tests/templates/globals-default.j2 (+2, -0)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+38, -10)
ansible/roles/loadbalancer/defaults/main.yml (+27, -0)
",0.934667,-1.631231,-0.301761,0.07157,0.008297,-0.107637,-0.471352,-0.251546,-0.50985,-0.165052,-0.373787,0.12842,-0.028321,-0.441568,-0.186916
openstack/kolla-ansible,I6d1e9e77abc48d82ffd6ade33997c83bb601b0eb,1,0,0.5498,2.1972,0.0,2,26.0,244,0,CI,0,0,0,231,0.017627,0.2857,0,0.1571,5,2,0,0.6783,0.9544,4.5,-24.55,22.71,0,0,0.0,0,27.1111,0,0,0,0,0,"proxysql: Add mariadb_monitor_read_only_interval

It's needed to be configured on environments like our CI, because of low
cpu/network resources proxysql marks healthy nodes as OFFLINE_HARD
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+3, -0)
ansible/roles/loadbalancer/defaults/main.yml (+5, -0)
",-0.198745,-0.470929,-1.071557,0.347489,0.722915,-0.143797,-0.48618,-0.231915,-0.368431,-0.503742,0.273559,-0.285596,-0.249231,-0.600693,-0.049327
openstack/kayobe,Id3d68b55e18dfe9c44805b6e2602e00eadecc76a,1,1,0.8378,2.1972,0.125,2,16.0,234,0,Bug Fix,0,0,0,37,0.032202,1.0,0,0.8378,2,2,0,0.916,0.8113,1.5,45.19,15.15,0,0,0.0,1,26.0,0,6,0,13,0,"Fix overcloud deprovision hosts list in prompt

Hosts that weren't part of the overcloud group would be included in the
list when this is run without a limit.

Closes-Bug: #2091621
[SEP]
FILES CHANGED:
ansible/overcloud-deprovision.yml (+1, -1)
releasenotes/notes/fix-overcloud-deprovision-prompt-host-lists-cfb701162c114c60.yaml (+6, -0)
",1.623416,-0.747943,-0.209296,0.05817,-0.69925,0.367865,0.423281,-0.316487,-0.064596,-0.397148,0.106375,-0.105667,0.206076,-0.029303,0.1086
openstack/kolla,Id81ce23fed7c19211aa8b15abce185d990be8389,0,0,0.4,2.0794,0.1429,2,8.0,103,0,Feature,0,0,0,5,0.021186,0.5,0,0.2,2,2,0,0.6656,0.8631,2.0,-65.66,28.2,1,0,0.0,1,12.875,0,0,0,0,0,"Remove deprecated AngularJS plugins from Grafana
[SEP]
FILES CHANGED:
docker/grafana/Dockerfile.j2 (+1, -1)
releasenotes/notes/grafana-remove-angular-plugins-4c9ea2087c5c2bf2.yaml (+5, -0)
",2.54379,1.578797,0.767404,0.418609,0.725004,0.492626,0.341214,0.930914,-0.38586,-0.508658,0.205187,0.164965,0.037849,-0.38902,-0.142463
openstack/kolla,I979df16dea4499b470ce7a4e23df7927a5952aa7,1,0,0.7222,2.5649,0.25,2,7.0,88,0,Feature,0,0,0,18,0.03169,0.3571,0,0.2579,2,2,0,0.6635,1.0,2.0,-29.9,14.23,0,0,0.0,1,6.7692,0,0,0,0,0,"Update Let's Encrypt lego version
[SEP]
FILES CHANGED:
releasenotes/notes/update-letsencrypt-version-36a0cd7d2997c6c7.yaml (+6, -0)
kolla/common/sources.py (+3, -3)
",3.77852,0.497265,1.675437,-0.581676,0.287496,0.553039,0.493636,1.138404,-0.113954,-0.564897,0.544311,-0.164232,-0.434029,-0.035049,-0.426154
openstack/kolla-ansible,If450941a51ebc5404e39003b702309ee3c66e1ea,0,0,0.5517,3.0445,0.5,2,6.5,187,0,CI,1,0,0,232,0.017692,0.5556,0,0.3065,1,1,0,0.6788,0.469,1.0,73.34,7.22,0,0,1.0,1,8.9048,0,0,0,0,0,"CI: Switch previous_release to 2024.2 and slurp to 2024.1

Switch Jammy jobs to Noble as well - since we switched to
Noble in 2024.2
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
zuul.d/jobs.yaml (+9, -9)
",0.643102,-0.169896,-0.757101,0.089584,-0.089823,0.556467,-0.354834,-0.080131,-1.002083,0.729758,0.352583,0.068843,-0.296618,0.458287,0.229732
openstack/kolla-ansible,I1d4e44d5cc7941eb524230661d1a024738ee015c,0,0,0.5494,1.7918,0.0,1,10.0,192,0,CI,1,1,0,233,0.017742,0.6786,0,0.3728,1,1,0,0.6777,0.0,1.0,57.1,8.0,0,0,1.0,1,32.0,0,0,0,0,0,"Revert ""CI: Disable SLURP jobs for D cycle""

This reverts commit f0688f792243256371c6cadf95860902579c6b01.

Reason for revert: E is SLURP
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+5, -0)
",0.510772,-0.444443,-1.766364,-1.754082,0.906414,0.805943,0.321137,-0.003021,0.241014,-0.022179,-0.083355,0.278674,-0.104385,0.087428,-0.13523
openstack/kolla-ansible,I1bd4a7f96f77c34fb46ca21f37023dddf73e8f05,1,1,1.0,4.4188,0.5,9,29.0,280,0,Bug Fix,0,0,0,5,0.02924,0.7778,1,0.7778,4,1,0,0.6767,2.7002,3.22,-3.47,25.39,0,0,0.0,0,3.3735,0,6,0,3,0,"Docs update - kolla-ansible cli parameters

With rewrite of kolla-ansible CLI to Python in
I9749b320d4f5eeec601a055b597dfa7d8fb97ce2 the order of parameters have to be:
`kolla-ansible <action> <arguments>`

Closes-bug: 2087920
[SEP]
FILES CHANGED:
doc/source/admin/tls.rst (+2, -2)
doc/source/admin/password-rotation.rst (+2, -2)
doc/source/admin/mariadb-backup-and-restore.rst (+5, -5)
doc/source/user/quickstart-development.rst (+3, -3)
doc/source/user/quickstart.rst (+3, -3)
doc/source/reference/containers/magnum-guide.rst (+1, -1)
doc/source/reference/networking/octavia.rst (+2, -2)
doc/source/user/adding-and-removing-hosts.rst (+9, -9)
doc/source/user/operating-kolla.rst (+14, -14)
",-1.531318,-0.071236,-1.643681,-0.758426,1.298163,-0.30726,-0.362641,-0.087462,0.133499,0.012944,-0.152075,0.014856,0.249216,0.080836,0.089263
openstack/kolla-ansible,I84483ea638ff1f45e20b73fc061e7505801f24fa,0,0,0.547,2.7726,0.3333,1,7.5,127,0,CI,1,0,0,234,0.017811,0.6552,0,0.3584,1,1,0,0.6772,0.0,1.0,58.22,11.0,0,0,1.0,1,7.9375,0,0,0,0,0,"CI: Mark slurp jobs as non voting for now

These are unstable currently.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+10, -5)
",1.757732,-0.973129,0.034522,-0.052843,-0.529672,0.556033,-0.615976,-0.686733,-0.595383,0.569404,0.182487,-0.112,0.253291,-0.180613,-0.454466
openstack/openstack-ansible-rabbitmq_server,I9fbe7806b3531921b90ac91c17b6a07deca2a4d2,1,0,0.8649,1.0986,0.0,1,19.0,631,0,Feature,0,0,0,37,0.164444,0.0,0,0.0,1,1,0,0.8571,0.0,1.0,40.61,15.18,0,0,0.0,0,210.3333,0,0,0,0,0,"Service must always be restarted during an upgrade

The service is unconditionally stopped during the upgrade
prep tasks. There are several conditions that will notify
the handler to restart the service, such as updating the
config file or installing a new version of the rabbitmq
package. It is possible that none of these things happen
resulting in the service not being restarted during an upgrade.

This patch ensures that the service is always restarted
during an upgrade by notifying the restart handler when
the service is sucessfully stopped in the upgrade prep tasks.
[SEP]
FILES CHANGED:
tasks/rabbitmq_upgrade_prep.yml (+2, -0)
",-1.108452,-2.038274,0.704384,0.91634,-0.071131,0.120009,0.411258,-0.231797,0.414986,0.503145,0.223408,0.53614,-0.201872,0.170367,0.319657
openstack/kolla,I46da8fad93febbc462cbe42a0d96ef7d423b8965,0,0,0.5447,1.3863,0.0,1,32.0,247,0,Bug Fix,0,0,0,235,0.017867,0.0,0,0.0,3,1,0,0.6645,0.0,3.0,5.16,22.8,1,0,0.0,0,61.75,0,0,0,0,0,"cinder: Fix log dir permission

In order to add support to uwsgi (which is opening the log file
after dropping privileges) we need to set proper permissions
for /var/log/kolla/cinder directory
[SEP]
FILES CHANGED:
docker/cinder/cinder-base/extend_start.sh (+3, -0)
",0.628803,-0.990993,-0.378949,0.22839,0.084108,-0.491076,0.106997,-0.290256,-0.503811,-0.15018,-0.585942,-0.323728,-0.033953,-0.195637,-0.379094
openstack/kolla-ansible,I4313b6918c381ec5e79e78df2f9a0cbaf25df53e,0,0,0.5424,2.1972,0.375,2,4.12,347,0,CI,1,0,0,236,0.017939,0.8333,0,0.452,1,1,0,0.6761,0.8113,1.0,0.12,13.77,0,0,1.0,0,38.5556,0,0,0,0,0,"CI: Add unreadable files to check-logs.sh

fluentd emits a warn message when it can't read a file
""unreadable. It is excluded and would be examined next time.""

Depends-On: https://review.opendev.org/c/openstack/kolla/+/939055
Depends-On: https://review.opendev.org/c/openstack/kolla/+/939088
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -3)
tests/get_logs.sh (+2, -0)
",-1.489667,3.072065,-0.990499,0.659645,-0.768216,0.192287,0.530668,-0.562347,0.033666,0.05992,0.211041,-0.400422,0.342811,0.11582,-0.029822
openstack/openstack-ansible-repo_server,Idc35c22b17baa5bba45cdb7f0bcc4aa7e3eacb10,1,0,0.9559,2.8332,0.375,1,21.5,306,0,Bug Fix,0,0,0,204,0.055692,0.9688,0,0.926,1,1,0,1.0,0.0,1.0,35.49,16.97,1,0,0.0,0,18.0,0,0,0,0,0,"Fix tags usage for the role

Tags were not properly applied for include_tasks, which caused their
ignorance.
Instead of applying tags to all includes, some of them were converted
to static imports as there was no reason for including tasks dynamically
[SEP]
FILES CHANGED:
tasks/main.yml (+10, -6)
",0.463597,-1.822862,-0.188866,0.765389,0.057132,0.229713,0.267003,-0.842065,-0.222566,-0.029371,-0.38439,-0.01499,0.087963,-0.328791,-0.119487
openstack/kolla-ansible,I80c3e20de0b7503de6331b55879e85892323b3d6,1,1,0.5401,2.3026,0.1111,2,4.0,400,0,Bug Fix,0,0,0,237,0.018004,0.3333,0,0.18,6,2,0,0.675,0.7642,4.0,-37.81,14.1,0,0,0.0,1,40.0,0,10,0,12,0,"fluentd: rework openstack logs match

Add global_request_id according to oslo.log defaults [1],
also support lines like:

2024-12-23 20:48:29.905 2 ERROR oslo_service.periodic_task ['Traceback (most recent call last):\\n'

[1]: https://docs.openstack.org/oslo.log/latest/configuration/#DEFAULT.logging_context_format_string

Closes-Bug: #2044370
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2044370-2285fc3952981cae.yaml (+7, -0)
ansible/roles/common/templates/conf/input/00-global.conf.j2 (+1, -1)
",-0.375787,-0.47212,0.02812,-1.002664,-0.78624,-0.448581,-0.130137,0.823693,0.599216,-0.055301,0.037302,-0.783599,-0.25424,0.242645,-0.03521
openstack/openstack-ansible-os_skyline,I7ca3c2ecf9435f3d5cc07b62dd9fe90245135779,1,0,0.9561,1.0986,0.5,1,15.0,252,0,CI,0,0,0,205,0.055722,0.0,0,0.0,1,1,0,1.0,0.0,1.0,28.05,18.0,0,0,0.0,0,84.0,0,0,0,0,0,"Ensure proper db connection string with SSL enabled

MariaDB now requires secure connection by default, which results in
connection failure unless `ssl=true` is set explicitly in connection
string.
[SEP]
FILES CHANGED:
templates/skyline.yaml.j2 (+1, -1)
",0.846579,-1.031477,0.306145,0.612463,0.326647,0.375704,-0.194933,-0.336848,0.290606,0.090171,-0.480742,-0.276791,-0.071366,-0.563291,-0.14305
openstack/kolla-ansible,I41fb046b85509b56611ffd575f15088834187ba8,0,0,0.542,3.0445,0.35,5,17.5,332,0,Bug Fix,0,0,0,238,0.018067,0.5625,0,0.3049,4,2,0,0.6755,1.7855,2.8,24.71,16.14,0,0,0.0,1,15.8095,0,0,0,0,0,"Fix l7 haproxy check for opensearch-dashboards and prometheus-server

After I839f7f1051182fe797394e5436571d64d5c5b5a4 prometheus-opensearch
jobs are broken - this patch fixes that.

opensearch-dashboards will respond to ""OPTIONS /"" with 404 and
prometheus will respond with 400
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -0)
etc/kolla/passwords.yml (+1, -0)
ansible/roles/opensearch/defaults/main.yml (+2, -4)
ansible/roles/prometheus/defaults/main.yml (+7, -3)
releasenotes/notes/haproxy_healthchecks_to_l7-b05e8c7b177d1544.yaml (+2, -0)
",-1.172904,-0.206753,-1.316658,-0.696205,1.150897,-0.656463,0.227675,0.00646,-0.240166,-0.079655,-0.282529,0.119841,0.218199,-0.002048,0.316486
openstack/kolla-ansible,I068aa288fb4fe6f99501857960bf3e8810f10b14,1,1,1.0,1.6094,0.5,2,11.5,197,0,Bug Fix,0,0,0,6,0.023715,0.625,1,0.625,3,1,0,0.6745,1.0,3.0,37.0,13.3,0,0,0.0,0,39.4,0,6,0,4,0,"Docs update - install missing dbus-1 on Noble

Added dbus-1 package missing on Ubuntu noble to dependency install section.

Closes-bug: 2092712
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+1, -1)
doc/source/user/quickstart.rst (+1, -1)
",1.241551,-0.769899,-0.601234,-0.657348,-0.250017,-0.182472,-0.528346,0.381094,-0.327392,-0.024917,0.105756,0.067326,0.456496,0.268342,0.061193
openstack/kolla,Idae2e87bfc8a556a090085e46f96d11279080f0f,1,0,0.5397,2.1972,0.875,2,13.67,327,0,Bug Fix,0,0,0,239,0.018116,0.75,0,0.4048,3,1,0,0.6624,0.8113,3.0,17.57,21.08,0,0,0.0,0,36.3333,0,0,0,0,0,"nova/aarch64: Fix qemu-efi build failures

It probably has been omitted in Ubuntu 24.04 introduction since
aarch64 build jobs have not been stable.

Removing from nova-compute since it's already in nova-base,
nova-libvirt's parent is base - so updating to qemu-efi-aarch64
[SEP]
FILES CHANGED:
docker/nova/nova-base/Dockerfile.j2 (+1, -1)
docker/nova/nova-compute/Dockerfile.j2 (+0, -6)
",-0.537472,-0.171844,-0.662049,0.257808,0.004993,-0.680892,0.406394,0.103679,-0.761349,0.016203,0.229425,0.068266,-0.078896,0.21928,0.452258
openstack/kolla-ansible,Ic99804967b5a62b5a9e39486749474520734ba48,0,0,0.7778,4.0775,0.431,25,12.2,531,0,Feature,0,0,0,9,0.087379,0.5833,0,0.4537,4,2,0,0.675,4.5132,3.92,1.67,13.4,1,0,0.0,1,9.0,0,0,0,0,0,"Use public keystone URL for www_authenticate_uri

The `www_authenticate_uri` parameter is used to indicate to clients
where they should get a token from in order to authenticate against a
service. Most clients are not expected to be able to talk to the
internal identity endpoint, so this parameter should refer to the public
endpoint instead, see also [0].

[0] https://opendev.org/openstack/keystonemiddleware/src/branch/master/keystonemiddleware/auth_token/_opts.py#L31-L50
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+1, -1)
releasenotes/notes/use-public-www-authenticate-uri-1144df4d205f8ebd.yaml (+8, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
ansible/roles/aodh/templates/aodh.conf.j2 (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
ansible/roles/heat/templates/heat.conf.j2 (+1, -1)
ansible/roles/masakari/templates/masakari.conf.j2 (+1, -1)
ansible/roles/designate/templates/designate.conf.j2 (+1, -1)
ansible/roles/placement/templates/placement.conf.j2 (+1, -1)
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -1)
ansible/roles/nova/templates/nova.conf.j2 (+1, -1)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+1, -1)
ansible/roles/zun/templates/zun.conf.j2 (+2, -2)
ansible/roles/watcher/templates/watcher.conf.j2 (+1, -1)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -1)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -1)
ansible/roles/neutron/templates/neutron.conf.j2 (+1, -1)
ansible/roles/trove/templates/trove.conf.j2 (+1, -1)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+1, -1)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
ansible/roles/manila/templates/manila.conf.j2 (+1, -1)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+1, -1)
ansible/roles/barbican/templates/barbican.conf.j2 (+1, -1)
",-2.020993,1.046863,-0.131672,0.872714,-0.103215,-0.358324,0.526404,0.300028,0.494495,0.092294,0.062827,-0.258203,-0.55741,-0.356577,-0.313947
openstack/ansible-collection-kolla,Ib9fe0120faddca07a1344f79057361ebb23f767b,0,0,0.5417,2.9444,0.0556,1,8.0,116,0,Bug Fix,0,0,0,240,0.01818,0.7,0,0.3792,3,1,0,0.4783,0.0,3.0,-65.66,33.2,0,0,0.0,0,6.1053,0,0,0,0,0,"docker/podman_sdk: Fix dbus-python installation in virtualenv
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+17, -1)
",1.647559,0.407371,0.357977,-0.387325,0.455999,-1.355129,-0.108542,0.794333,-0.285516,-0.429126,0.054138,-0.217514,-0.5658,-0.281549,0.212386
openstack/kolla,I57e36ef07e8840eead2efde77e0ab9dfd4842931,1,1,0.5394,2.4849,0.0,2,4.75,211,0,Bug Fix,0,0,0,241,0.018231,0.0,0,0.0,3,2,0,0.6635,0.684,3.0,6.1,12.43,0,0,0.0,0,17.5833,0,8,0,17,0,"neutron-dhcp-agent: change dnsmasq.log rights

Fixes /var/log/kolla/neutron/dnsmasq.log rights so
fluentd can read logs from that file.

Closes-Bug: #1693712
[SEP]
FILES CHANGED:
docker/neutron/neutron-dhcp-agent/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-dhcp-agent/extend_start.sh (+9, -0)
",-0.572058,0.558606,-1.492261,0.023392,0.225037,-0.770336,-0.262249,0.17254,-0.270554,-0.62428,0.043962,-0.460801,-0.075669,0.225488,0.186864
openstack/kolla-ansible,I33d9f32dd842a12b893f5062f2e1e278af7b30a1,0,0,0.5413,3.912,0.1429,6,7.4,356,0,Feature,0,0,0,242,0.018292,1.0,0,0.5413,4,3,0,0.6739,2.0767,3.33,2.69,15.93,1,0,0.0,1,7.12,0,0,0,0,0,"keystone: Add support for using uWSGI

Switching the default to uWSGI due to the changes that are happening
in OpenStack - with projects dropping wsgi_file(s) and moving
to modules.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/938402

Signed-Off-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+1, -0)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/roles/keystone/templates/keystone.json.j2 (+9, -4)
ansible/roles/keystone/tasks/config.yml (+20, -1)
ansible/roles/keystone/defaults/main.yml (+6, -0)
ansible/roles/keystone/templates/keystone-startup.sh.j2 (+4, -2)
",-1.044977,1.740691,-0.622622,0.16095,-0.849666,0.054861,0.462394,0.200618,-0.24171,-0.196905,0.468023,-0.181169,0.411225,0.056498,-0.036555
openstack/kolla,I38688e442b995d38e9826fbb545b6ab09e06bdf5,0,0,0.5391,0.6931,1.0,1,3.33,168,0,Feature,0,0,0,243,0.0183,0.0,0,0.0,3,1,0,0.6646,0.0,3.0,-101.11,21.33,1,0,0.0,0,84.0,0,0,0,0,0,"keystone: Remove ARGS to support uwsgi

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/952093
[SEP]
FILES CHANGED:
docker/keystone/keystone/extend_start.sh (+0, -1)
",0.110754,2.987608,-1.649926,-0.414142,-1.223534,-0.018962,-0.203921,-0.261084,-0.178748,-0.786386,-0.766007,-0.003411,0.047214,-0.534616,0.039874
openstack/openstack-ansible-lxc_container_create,I6a759c748469ce8c644727cb24bd4fa18cff3eda,1,0,0,1.0986,0.5,1,14.67,534,0,Feature,0,0,0,0,0.0,0.0,0,0.0,1,1,0,1.0,0.0,1.0,58.32,13.14,1,0,0.0,0,178.0,1,0,0,0,0,"Solving naming issue of OVS ports for lxc

There is a limitation of 15 characters for
ovs port names. So this role will use
the 15 ending characters of the container name
to generate port names(OVS and VNIC).
But veth-cleanup script will consider
this limitation only for OVS ports and not for the
virtual interface. So I added a condition to
also consider this limitation.
Note that the actual virtual interface has
the same name as OVS port and there is no problem
in the role.
[SEP]
FILES CHANGED:
templates/veth-cleanup.sh.j2 (+1, -1)
",-0.830325,-2.209702,0.541279,0.37158,-0.186952,-0.235035,-0.007038,0.07877,0.048825,0.183155,-0.016542,0.029076,0.189136,0.000922,-0.132271
openstack/openstack-ansible-repo_server,Ic4f4405ad7ffe1427791a012bb56f8fefa16d145,1,1,0.9563,0.6931,1.0,1,13.14,689,0,Bug Fix,0,0,0,206,0.055963,0.0,0,0.0,1,1,0,1.0,0.0,1.0,29.81,14.82,0,0,0.0,0,344.5,0,6,0,9,0,"Remove access limitations to repo vhost

With migration from Nginx to Apache [1] an IP limitation was introduced
which was not present before.
It is based on asumption that container_networks are defined which is
not the case for some metal deployments.

We need to make a fix backportable and focus of the change was migraton
from Nginx to Apache rather then change behaviour.

With that in mind revert of the behaviour change is proposed, while
re-implementation
of limitation can be re-implemented later with a follow-up patch.

[1] https://review.opendev.org/c/openstack/openstack-ansible-repo_server/+/924162

Closes-Bug: #2093011
[SEP]
FILES CHANGED:
templates/openstack_slushee.vhost.j2 (+0, -1)
",-1.895326,-0.764245,1.30667,-0.566209,-0.846439,-0.029431,0.052708,0.103435,0.194437,-0.030829,-0.087803,0.261112,-0.373104,-0.320936,0.118324
openstack/kolla-ansible,I6fe4b106853fd253ea28111409370e01cb678fe9,1,0,0.5369,1.9459,0.3333,2,7.8,289,0,CI,1,0,0,244,0.018373,0.7143,0,0.3835,1,2,0,0.6729,0.9183,1.0,53.58,10.3,0,0,1.0,1,41.2857,0,0,0,0,0,"CI: Remove OpenSearch connectivity check in fluentd logs

It broke OpenSearch CI jobs because we restart OpenSearch in there.

Also add check-logs.sh and get_logs.sh to files that
trigger all jobs run so we don't break anything again.
[SEP]
FILES CHANGED:
tests/check-logs.sh (+1, -1)
zuul.d/base.yaml (+3, -1)
",0.620978,-0.80936,-0.584127,0.438591,-0.129364,-0.404483,0.353296,-0.431619,-1.016148,-0.380713,-0.141623,-0.771289,0.264255,0.476572,0.106585
openstack/kolla,Idfc26fe380a546d0fd712a531e5913090b01d808,1,1,0.5388,3.7612,0.1905,4,10.0,179,0,Bug Fix,0,0,0,245,0.01844,1.0,0,0.5388,2,3,0,0.6625,1.6894,1.0,35.95,18.0,0,0,0.4286,1,4.1628,0,22,0,12,0,"Fix genconfig

Currently tox -e genconfig fails with stevedore issues,
because tox is not doing sdist.

Closes-Bug: #2051575
[SEP]
FILES CHANGED:
.zuul.d/tox.yaml (+12, -0)
.zuul.d/project.yaml (+6, -0)
tox.ini (+1, -2)
kolla/common/config.py (+15, -6)
",0.816842,-1.32674,-0.418871,-0.962085,-0.328621,-0.043323,-1.035273,-0.140343,-0.718982,-0.148679,0.101307,-0.294465,0.108515,-0.101331,0.218929
openstack/kolla-ansible,I2f2bdbc9e1c6ad6da4ac7098ddd36143123c3062,0,1,0.5407,2.3026,0.3333,4,9.0,113,0,Bug Fix,0,0,0,246,0.018457,0.5882,0,0.318,4,2,0,0.6734,1.8366,3.5,-9.1,25.82,0,0,0.2222,0,11.3,0,8,0,18,0,"ironic: Change Prometheus metrics dir

Closes-Bug: #2062401
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
ansible/roles/ironic/defaults/main.yml (+2, -2)
tests/templates/globals-default.j2 (+2, -0)
ansible/roles/ironic/tasks/precheck.yml (+1, -0)
",1.945129,-0.240381,-0.571872,-1.412122,-0.984328,0.784634,-1.314998,0.472792,0.195343,-0.211846,0.768786,-0.31207,0.166788,-0.019753,0.041253
openstack/kolla-ansible,I50c5a1443c5d2012388debed20b96274bc69e7e7,0,0,0,4.3694,0.0,9,6.0,83,0,Feature,0,0,0,0,0.0,0.4762,0,0.0,4,4,0,0.6724,2.3952,3.33,-24.85,15.73,1,0,0.0,1,1.0506,0,0,0,0,0,"add lightbits driver support
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+13, -0)
doc/source/reference/storage/index.rst (+1, -0)
doc/source/reference/storage/cinder-guide.rst (+3, -0)
releasenotes/notes/add-lightbits-cinder-plugin-support-f5445f2dbb1a56ed.yaml (+4, -0)
ansible/roles/cinder/tasks/precheck.yml (+11, -0)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+11, -0)
doc/source/reference/storage/cinder-guide-lightbits.rst (+33, -0)
etc/kolla/globals.yml (+1, -0)
",4.146298,2.356174,2.340043,0.735527,0.689542,0.286969,1.008876,0.423643,0.423443,0.082247,-0.528357,0.063116,0.865566,-0.535996,0.583833
openstack/kolla-ansible,I3c419b4b2a86eb059744b05e4be797ea7ace8816,1,0,0.5385,1.3863,0.0,1,8.0,91,0,Doc,1,0,0,247,0.01852,0.4194,0,0.2258,2,1,0,0.6713,0.0,2.0,-23.36,18.2,0,0,1.0,0,22.75,0,0,0,0,0,"CI: Use Zuul cache/mirror for docker
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+3, -0)
",2.937089,0.716375,1.105277,-0.286686,0.082851,-0.271005,-0.2527,0.527857,-0.862226,-0.325064,-0.205135,-0.35685,0.27759,-0.563589,-0.086387
openstack/kayobe,I15d17f45d15c04aced0a4c0fe97e1d798ff46799,1,1,0,4.1431,0.371,4,17.33,375,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.9167,1.7752,3.5,39.56,13.86,1,0,0.0,1,5.9524,0,6,0,10,0,"infra-vm: efficiently handle `hostvars` during deploy and destroy

Pass only the required variables from `hostvars` for a given infra vm to
significantly reduce wait time during `kayobe infra vm provision` and
`kayobe infra vm deprovision`. Time to create and destroy a VM now take
a minute or less.

Closes-Bug: #2093255
[SEP]
FILES CHANGED:
ansible/roles/infra-vms/tasks/main.yml (+15, -2)
ansible/roles/infra-vms/tasks/deploy.yml (+13, -16)
ansible/roles/infra-vms/tasks/destroy.yml (+5, -5)
releasenotes/notes/improve-infra-vm-action-performance-5d8a218b75574be2.yaml (+6, -0)
",-0.850938,-0.572862,-0.346262,0.377289,0.488252,0.080809,-0.292647,-0.180817,-0.072184,-0.167702,-0.196848,-0.077517,0.255989,0.100708,-0.062589
openstack/kolla-ansible,I5c63192ab78e0c50a05d72abd754e99e7cf83976,0,0,0.5403,1.3863,0.6667,1,4.43,362,0,CI,1,0,0,248,0.018591,0.4375,0,0.2364,2,1,0,0.6718,0.0,2.0,-24.17,12.09,0,0,1.0,0,90.5,0,0,0,0,0,"CI: Bump mariadb_monitor_galera_healthcheck_timeout to 30 seconds

We're often observing:
2025-01-08 19:27:29 MySQL_Monitor.cpp:2314:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.0.2.3:3306 after 1001ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -2)
",-1.250747,0.966846,-0.661989,0.19364,0.071233,0.174246,-0.022914,0.399924,0.663939,0.458029,0.716325,-0.602996,-0.291615,0.490942,0.513929
openstack/magnum,Ib73f66a8c7360820e13a7ab24bb4f656584124e5,1,0,0,5.3033,0.0,10,9.67,240,0,Feature,0,0,0,0,0.0,1.0,0,0.0,6,2,0,0.9048,3.0436,4.0,30.74,13.52,0,0,0.545,1,1.194,0,0,0,0,0,"add validation for boot volume size

if both boot_volume_size label and flavor's root_gb are zero,
cluster node creation fails.
This should be filtered at the creation/update operation.
[SEP]
FILES CHANGED:
magnum/api/controllers/v1/nodegroup.py (+21, -0)
magnum/api/controllers/v1/cluster.py (+19, -0)
magnum/tests/unit/api/controllers/v1/test_cluster.py (+17, -0)
magnum/api/attr_validator.py (+20, -0)
magnum/tests/unit/api/controllers/v1/test_nodegroup.py (+9, -0)
releasenotes/notes/add-boot-volume-size-check-0262c2b61abc7ccf.yaml (+5, -0)
magnum/tests/unit/api/controllers/v1/test_cluster_template.py (+36, -0)
magnum/tests/unit/api/test_attr_validator.py (+47, -0)
magnum/api/controllers/v1/cluster_template.py (+21, -0)
magnum/common/exception.py (+5, -0)
",0.547896,-0.908368,-0.269313,0.676499,0.518826,0.148456,-0.125233,-0.263027,0.742487,-0.46764,-0.466638,0.163075,-0.397686,0.193601,-0.564383
openstack/kolla-ansible,Ida740649753a9b74a52b8e7b99f3775ca6d27cb4,0,0,0.5382,1.9459,0.0,1,8.0,105,0,Feature,0,0,0,249,0.018661,0.0,0,0.0,4,1,0,0.6708,0.0,4.0,-44.51,23.2,0,0,0.0,0,15.0,0,0,0,0,0,"uwsgi: Add logfile-chown and logfile-chmod options
[SEP]
FILES CHANGED:
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+6, -0)
",1.809779,0.759117,0.710999,0.362751,1.269238,-0.731544,-0.715537,-0.372328,-0.026435,0.165761,-0.456873,-0.540712,0.230161,0.468982,0.437246
openstack/kolla-ansible,I682d13551fbb8374769d6f90aacada824a053720,0,0,0.536,3.1781,0.0435,3,6.0,80,0,Feature,0,0,0,250,0.018728,0.5,0,0.268,6,2,0,0.6698,0.9665,5.33,3.34,15.73,0,0,0.0,0,3.3333,0,0,0,0,0,"fluentd: Add uwsgi config
[SEP]
FILES CHANGED:
ansible/roles/common/templates/conf/input/13-uwsgi.conf.j2 (+18, -0)
ansible/roles/common/tasks/config.yml (+2, -0)
ansible/roles/common/templates/conf/input/00-global.conf.j2 (+2, -1)
",3.130775,0.992162,1.44527,-0.191246,0.915115,-0.269666,0.408955,0.223347,-0.142634,-0.205668,-0.424538,-0.374288,0.032892,0.001648,0.362066
openstack/kolla,I11b7e19ac3a12147138a98fc1e030767f70b44c9,1,1,0.6,1.3863,0.0,1,9.25,321,0,Bug Fix,0,0,0,35,0.058923,0.3333,0,0.2,2,1,0,0.6635,0.0,2.0,16.81,18.84,0,0,0.0,0,80.25,0,6,0,20,0,"fix sources.py based cross-arch builds

Derive debian_arch from base_arch by default when not set by the user.
This ensures that cross-architecture builds correctly download
the appropriate binaries, while preserving any explicit user override.

Closes-Bug: #2103810
[SEP]
FILES CHANGED:
kolla/common/config.py (+3, -0)
",0.386874,-0.466667,-0.586671,0.720405,0.126282,0.297797,0.213378,-0.130422,0.076565,-0.25177,0.226124,0.178081,0.187451,-0.055537,0.243959
openstack/kolla-ansible,I7061aa65673a3b8d2e95e43f124587546e21b715,1,1,0.6667,2.1972,0.125,2,13.0,132,0,Bug Fix,0,0,0,3,0.033333,0.5294,0,0.3529,4,2,0,0.6687,0.8113,3.0,11.42,20.58,0,0,0.0,1,14.6667,0,6,0,7,0,"Prometheus: Fix target when TLS for rabbitmq is disabled

Closes-Bug: #2093335
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2093335-88ecb9b12a003b20.yaml (+6, -0)
ansible/roles/prometheus/defaults/main.yml (+1, -1)
",1.672422,0.321671,-0.281878,-0.900781,-0.391396,0.809176,-1.159822,0.188022,-0.205868,0.13496,0.321964,-0.330263,0.1364,-0.522175,0.329435
openstack/kolla-ansible,I91570ba0ecf66551cb8e13a80c1d9aacabfc944a,0,0,0.5339,2.4849,0.1818,3,16.0,367,0,Feature,0,0,0,251,0.018771,0.3667,0,0.1958,2,2,0,0.6692,1.3093,2.0,7.3,16.4,0,0,0.0,1,30.5833,0,0,0,0,0,"ironic: change enable_ironic_neutron_agent default to no

networking-baremetal is only required when bare metal servers
are using flat network type.

In most cases it's vlan - so let's not impose additional agent
(with a separate agent in `openstack network agent list` per
Ironic baremetal) on users needlessly.
[SEP]
FILES CHANGED:
releasenotes/notes/ironic_neutron_agent_change_default-aa914434b7c119f7.yaml (+7, -0)
ansible/group_vars/all.yml (+1, -1)
etc/kolla/globals.yml (+1, -1)
",0.185455,-1.926152,0.01218,0.158699,-0.070959,-0.865593,0.238124,0.091497,-0.194918,-0.276692,-0.229839,-0.338447,-0.036839,-0.212295,-0.138158
openstack/charm-ceph-dashboard,Ief48e2f67130f45b4aa83840636b11313a44bb96,1,0,0.9423,5.451,0.0259,5,7.33,217,0,Bug Fix,0,0,1,52,0.004714,1.0,0,0.9423,1,3,0,0.8235,1.4621,0.6,-4.42,15.66,1,0,0.5948,1,0.9313,0,0,0,0,0,"SSL handling: check cert/key before attempting to set

Also update some dependencies and fix tox config
[SEP]
FILES CHANGED:
test-requirements.txt (+1, -1)
src/charm.py (+10, -0)
src/ceph_dashboard_commands.py (+70, -1)
tox.ini (+9, -4)
unit_tests/test_ceph_dashboard_commands.py (+136, -0)
",3.031223,-1.243778,0.744197,0.046305,0.04212,0.000249,0.788415,-0.596894,0.078726,-0.2474,-0.307808,-0.95903,0.394283,-0.104039,-0.350874
openstack/kolla,Iedfb2df027c0cefc45668a76d45ce62193aba9ef,1,1,0.5317,2.5649,0.0,3,9.0,113,0,Bug Fix,0,0,0,252,0.01883,0.0,0,0.0,3,1,0,0.6646,1.4834,3.0,-18.5,25.82,0,0,0.0,0,8.6923,0,34,0,10,0,"openvswitch: Fix logs dir permission

Closes-Bug: #1795609
[SEP]
FILES CHANGED:
docker/openvswitch/openvswitch-db-server/extend_start.sh (+5, -0)
docker/openvswitch/openvswitch-base/extend_start.sh (+2, -0)
docker/openvswitch/openvswitch-vswitchd/extend_start.sh (+5, -0)
",2.73803,0.221805,0.196322,-1.252593,-0.723076,0.713113,-0.517053,0.44103,0.482805,-0.522382,0.5539,-0.392864,0.130312,-0.050415,0.263879
openstack/ironic,Ifc00069b075fed6bdf79bf4104cfdee62bb7b42a,1,1,1.0,2.9957,0.3158,3,8.0,160,0,Bug Fix,0,0,0,2,0.071429,1.0,0,1.0,3,2,0,0.9531,1.2674,2.33,34.8,13.2,1,0,0.0,1,8.0,0,6,0,5,0,"Resolve portgroup deletion failure

Add a join query and fix ``id``/``uuid`` mix-up.

Closes-Bug: #2093853
[SEP]
FILES CHANGED:
ironic/db/sqlalchemy/api.py (+7, -5)
ironic/objects/portgroup.py (+1, -1)
releasenotes/notes/resolve-portgroup-deletion-failure-3b3b8b3253c0b902.yaml (+5, -0)
",0.851942,-0.269342,-0.904175,-0.386985,0.044514,0.656055,-0.940945,0.010639,0.536034,-0.230528,0.014881,-0.226958,-0.035497,-0.148025,0.067272
openstack/kolla,I3f45178c07a9cd054e572ff80d0e19fb014d69d3,1,1,0.5336,2.7726,0.0,2,4.0,111,0,Bug Fix,0,0,0,253,0.018888,0.0,0,0.0,2,2,0,0.6656,0.7219,2.0,-8.72,26.6,0,0,0.0,0,6.9375,0,6,0,5,0,"ironic: Fix dnsmasq.log permissions

Closes-Bug: #2093881
[SEP]
FILES CHANGED:
docker/dnsmasq/Dockerfile.j2 (+3, -0)
docker/dnsmasq/extend_start.sh (+12, -0)
",1.735574,-0.51652,-0.546832,-1.44843,-0.665164,0.330089,-1.112199,0.327675,0.033211,-0.354963,0.771404,-0.386045,-0.088235,-0.064369,0.108439
openstack/openstack-ansible,I20967f1b6e26977a64ec338780cc85006bc1f846,1,0,0.8684,1.7918,0.4,1,13.29,744,0,Bug Fix,0,0,0,38,0.167401,1.0,0,0.8684,1,1,0,0.9368,0.0,1.0,22.33,15.64,0,0,0.0,0,124.0,0,0,0,0,0,"Fix inventory adjustment for legacy container naming

Patch [1] adjusted the default container names to contain dashes
rather than underscores. Inventories created prior to this patch
will still have container names with underscores, and these
are not handled correctly when making adjustments to env.d as the
""type_and_name"" variable in the inventory generator will always
contain dashes in recent releases. This results in the legacy
container name never matching the new type_and_name, so components
added to, or moved between host groups in env.d will never be
assigned to those hosts.

[1] https://github.com/openstack/openstack-ansible/commit/d74d03803242ae1fb0137db4cf95def5b50474ca
[SEP]
FILES CHANGED:
osa_toolkit/generate.py (+3, -2)
",-2.341152,0.385186,0.707171,-0.076244,0.5692,0.115861,0.256045,-0.405215,0.311746,0.094218,-0.311785,-0.024994,-0.095616,-0.218459,-0.141108
openstack/kayobe,I09bd59d085c7ec3fa0ccd6abb84bd2d0c8b9825d,0,0,0.7647,6.3886,0.3687,26,10.5,829,0,Feature,0,0,0,17,0.011806,1.0,0,0.7647,7,6,0,0.9174,2.449,2.88,26.98,16.01,0,0,0.0,1,1.3933,0,0,0,0,0,"Support built-in inspector

Switches to using the builtin inspector rather than the standalone
ironic-inspector service since this has now been dropped from
kolla-ansible. Where possible, the new service has been configured to
maintain the same behaviour of the old standalone service.

When using the standalone inspector, Kayobe has a few opinionated
defaults for the set of processing hooks.  These defaults have been
translated over to the built-in inspector equivalents for a more
consistent experience.

Inspection rules have rewritten to use the new format.

CLI invocations have been updated to use the commands for the new
inspection service.

Depends-On:  https://review.opendev.org/c/openstack/kolla-ansible/+/961266
[SEP]
FILES CHANGED:
ansible/kolla-bifrost-hostvars.yml (+1, -1)
playbooks/kayobe-overcloud-upgrade-base/run.yml (+0, -1)
etc/kayobe/bifrost.yml (+1, -1)
ansible/inventory/group_vars/all/kolla (+7, -1)
playbooks/kayobe-overcloud-base/run.yml (+0, -1)
ansible/roles/kolla-bifrost/defaults/main.yml (+1, -1)
doc/source/configuration/reference/bifrost.rst (+2, -2)
ansible/inventory/group_vars/all/bifrost (+2, -2)
dev/functions (+2, -2)
ansible/baremetal-compute-introspection-data-save.yml (+2, -2)
ansible/roles/ironic-inspector-rules/defaults/main.yml (+1, -1)
ansible/inventory/group_vars/all/inspector (+194, -167)
etc/kayobe/inspector.yml (+19, -17)
ansible/overcloud-introspection-rules.yml (+20, -0)
ansible/kolla-openstack.yml (+1, -1)
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+1, -1)
ansible/inventory/group_vars/all/openstack (+33, -0)
releasenotes/notes/adds-support-for-configuring-builtin-inspector-04ab4ea4f1a1c3c8.yaml (+26, -0)
ansible/seed-introspection-rules.yml (+1, -1)
ansible/roles/kolla-openstack/templates/kolla/config/ironic.conf (+32, -0)
ansible/roles/ironic-inspector-rules/library/os_ironic_inspector_rule.py (+14, -7)
requirements.yml (+1, -1)
ansible/overcloud-introspection-data-save.yml (+1, -1)
ansible/roles/ironic-inspector-rules/tasks/main.yml (+8, -5)
ansible/roles/kolla-openstack/defaults/main.yml (+3, -1)
ansible/roles/kolla-bifrost/templates/kolla/config/bifrost/bifrost.yml (+2, -2)
",-2.241126,-0.448234,1.325555,0.153836,-0.623142,-0.15469,0.120884,0.18248,0.135577,-0.285606,-0.046092,0.524959,-0.172742,-0.28236,0.322813
openstack/kayobe,I31bc776b2cd7f6543705c44609fbcf22d9259be5,1,0,0.8974,1.0986,0.5,1,6.0,76,0,Bug Fix,0,0,0,78,0.064303,1.0,0,0.8974,2,1,0,0.9098,0.0,2.0,59.75,9.07,1,0,0.0,1,25.3333,0,0,0,0,0,"Fix release note link
[SEP]
FILES CHANGED:
releasenotes/notes/pin-ipa-requirements-f9566011b2400e6c.yaml (+1, -1)
",4.845076,1.995735,2.05809,-0.074723,0.171571,0.563333,1.649855,0.046851,0.876342,-0.297811,0.26233,-0.7213,0.659969,0.47029,-0.044038
openstack/kayobe,I134bcbece0f28bf5234f0afd8349b602ce2940a1,1,0,0.8987,1.0986,0.5,1,6.0,78,0,Bug Fix,0,0,0,79,0.065021,1.0,0,0.8987,2,1,0,0.9106,0.0,2.0,-10.75,15.73,1,0,0.0,1,26.0,0,0,0,0,0,"Fix release note markup
[SEP]
FILES CHANGED:
releasenotes/notes/fix-overcloud-deprovision-prompt-host-lists-cfb701162c114c60.yaml (+1, -1)
",4.405886,1.91199,2.485024,0.125475,0.477266,0.951405,1.005882,-0.145742,0.912878,-0.232536,-0.002253,-0.563506,0.747674,0.187069,0.323884
openstack/kolla-ansible,I1b5329d814432604640990b0ecc28906845e29d6,0,1,0.7222,4.804,0.1157,11,3.2,268,0,Bug Fix,0,0,0,18,0.00885,0.75,0,0.5417,4,4,0,0.6682,2.8045,3.36,-92.51,28.78,1,0,0.0083,1,2.1967,0,6,0,5,0,"Support ironic-pxe-filter

Closes-Bug: #2094790
Depends-On: https://review.opendev.org/c/openstack/kolla/+/939256
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+3, -0)
ansible/group_vars/all/ironic.yml (+1, -0)
ansible/roles/ironic/templates/ironic-pxe-filter.json.j2 (+23, -0)
ansible/roles/ironic/defaults/main.yml (+26, -1)
releasenotes/notes/ironic-pxe-filter-8376c424cb533bd3.yaml (+6, -0)
tests/templates/globals-default.j2 (+1, -0)
ansible/roles/ironic/tasks/rolling_upgrade.yml (+10, -12)
ansible/roles/ironic/tasks/config.yml (+1, -1)
etc/kolla/globals.yml (+1, -0)
ansible/roles/ironic/handlers/main.yml (+15, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+20, -0)
",0.122665,3.207488,-1.561151,-0.69275,-1.488441,0.474649,-0.271433,-0.218304,0.276168,-0.760197,-0.409383,-0.061801,0.279684,-0.30943,0.286902
openstack/kolla,I17811f2225edd64fb20cc44f0d40e14e9edb1413,0,1,0.6842,3.989,0.0,4,3.89,472,0,Bug Fix,0,0,0,19,0.008817,1.0,0,0.6842,3,3,0,0.6667,1.6853,2.5,-75.08,23.27,1,0,0.0,1,8.7407,0,6,0,5,0,"Adds ironic-pxe-filter container

Used in conjunction with the inspector implementation built into Ironic
and based on the Ironic documentation[1].

[1] https://docs.openstack.org/ironic/latest/admin/inspection/pxe_filter.html

Partial-Bug: #2094790

Depends-On: https://review.opendev.org/c/openstack/ironic/+/959850
[SEP]
FILES CHANGED:
releasenotes/notes/ironic-pxe-filter-b3b29090b0661ca2.yaml (+4, -0)
docker/ironic/ironic-pxe-filter/extend_start.sh (+6, -0)
docker/dnsmasq/extend_start.sh (+19, -0)
docker/ironic/ironic-pxe-filter/Dockerfile.j2 (+24, -0)
",-1.466513,2.056387,-0.78798,0.043563,-1.139336,-0.104405,-0.174226,0.312426,0.187906,0.12541,-0.102325,-0.294443,0.19384,-0.021248,-0.253633
openstack/kayobe,Ib7f9884c89437d645645ae48825c62c7680566ad,1,0,0.8421,1.0986,0.5,1,3.5,368,0,CI,0,0,1,38,0.032844,0.0,1,0.0,0,1,0,0.9113,0.0,0.0,-14.26,12.83,0,0,0.0,0,122.6667,0,0,0,0,0,"CI: pin to ansible-compat<25.0.0

The new release of ansible-compat[1] has broken our tox molecule
jobs:

```
'Invalid plugin FQCN (community.molecule.from_yaml): unable to locate collection community.molecule'
```

Pins to the previous version.

[1] https://github.com/ansible/ansible-compat/releases/tag/v25.0.0
[SEP]
FILES CHANGED:
molecule-requirements.txt (+1, -1)
",-1.711892,1.411251,-0.45817,0.205514,-0.257948,-0.461625,-0.340351,0.354157,-0.083534,0.596032,0.140755,-0.324922,-0.292564,0.41688,-0.249221
openstack/kolla-ansible,Id7d6973668d8b2b194913b533f8cb756c6708536,0,0,0.5354,5.624,0.0145,21,7.58,758,0,Doc,0,0,0,254,0.018941,1.0,0,0.5354,4,7,0,0.6672,3.8064,3.24,27.15,12.26,0,0,0.0217,1,2.7365,0,0,0,0,0,"ovn: Add support for OVN SB Relay

Add support for deploying OVN SB relays [1].
This is enabled by default to improve large scale scenarios.

Default mechanism deploys one relay group per 50 ovn-controller hosts
and uses random but idempotent method to choose a relay for a given host.

neutron-server and Octavia will connect directly to SB cluster, not via
the relays.

kolla-ansible check subcommand does not support ,,iterated'' containers
for now - but will be introduced in a subsequent patch.

[1]: https://docs.ovn.org/en/latest/tutorials/ovn-ovsdb-relay.html

Co-Authored-By: Krzysztof Tomaszewski <ktomaszewski@cloudferro.com>

Depends-On: https://review.opendev.org/c/openstack/kolla/+/928898
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+3, -0)
releasenotes/notes/ovn-sb-relay-809c170090887f68.yaml (+15, -0)
ansible/roles/service-check-containers/tasks/iterated.yml (+36, -0)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+17, -0)
ansible/roles/ovn-db/templates/ovn-sb-db-relay.json.j2 (+18, -0)
tests/test-ovn.sh (+3, -0)
ansible/roles/ovn-db/templates/ovsdb-relay.json.j2 (+20, -0)
doc/source/reference/networking/neutron.rst (+27, -0)
ansible/inventory/all-in-one (+3, -0)
ansible/roles/ovn-db/tasks/config-relay.yml (+35, -0)
ansible/roles/neutron/templates/ml2_conf.ini.j2 (+1, -1)
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -1)
ansible/group_vars/all.yml (+10, -1)
ansible/roles/ovn-db/defaults/main.yml (+40, -0)
ansible/roles/ovn-db/tasks/config.yml (+7, -0)
tools/validate-all-file.py (+3, -0)
tests/templates/inventory.j2 (+3, -0)
ansible/roles/ovn-db/handlers/main.yml (+14, -0)
ansible/roles/service-check-containers/tasks/main.yml (+13, -0)
ansible/roles/service-check/vars/main.yml (+2, -0)
ansible/roles/ovn-db/templates/ovn-northd.json.j2 (+1, -1)
",-2.952716,1.06942,1.829457,-0.611047,-0.65106,-0.173782,-0.084006,0.378561,-0.084287,-0.422186,0.069997,0.151641,0.00019,-0.069392,-0.317412
openstack/ironic-python-agent,Ic8bd473801fcb92fc814f6ad4e1d6dc316783bf3,1,1,0,3.7612,0.5,3,6.57,390,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,3,1,0,0.9355,0.7229,2.33,36.48,9.59,1,0,0.9524,0,9.0698,0,6,0,14,0,"Fix RAID volume name

Use just md<index> as the default volume name if a volume name is not defined.
The original change (https://review.opendev.org/c/openstack/ironic-python-agent/+/853182)
introduced an error:

mdadm: Value ""/dev/md0"" cannot be set as name. Reason: Not POSIX compatible.\n

This change fixes it.

Closes-Bug: #2073406
[SEP]
FILES CHANGED:
ironic_python_agent/tests/unit/test_raid_utils.py (+2, -2)
ironic_python_agent/raid_utils.py (+1, -1)
ironic_python_agent/tests/unit/test_hardware.py (+18, -18)
",-1.08513,0.16371,-0.411307,-0.268576,-0.914133,0.030355,-0.266647,0.019571,0.284436,0.125018,-0.037085,-0.35819,0.125619,0.23493,-0.22237
openstack/ironic,I8c23db46b4a5772d907f6c73ed5b975fdaaf80c8,1,0,0.9756,3.7612,0.0952,5,8.57,439,0,Bug Fix,0,0,0,41,0.013303,1.0,0,0.9756,4,2,0,0.9535,1.9368,2.8,48.68,9.43,0,0,0.5952,1,10.2093,0,0,0,0,0,"Fix hold/wait step logic in step validation

Somehow... the hold and wait steps were dropped or were lost in
from when hold/wait step logic was developed. This fixes it and
adds them to a test which exercises the validation logic.

Also takes into account the unhold verb call from Dmitry's change
in https://review.opendev.org/c/openstack/ironic/+/913707 and
adds a test accordingly.
[SEP]
FILES CHANGED:
ironic/conductor/manager.py (+8, -1)
ironic/tests/unit/conductor/test_steps.py (+3, -1)
ironic/conductor/steps.py (+2, -1)
ironic/tests/unit/conductor/test_manager.py (+20, -1)
releasenotes/notes/fix-hold-wait-service-steps-37dc91fd7393b180.yaml (+5, -0)
",-0.9718,-0.248312,-0.09268,0.325498,-0.649315,0.163386,0.588172,-0.408608,-0.179303,0.253393,0.039296,-0.379487,0.351136,-0.12501,0.383456
openstack/oslo.messaging,Ie89783d1e8a2891bfbb5b516eff08ed694353d6d,1,1,0.8462,2.7081,0.0714,2,9.71,461,0,Bug Fix,0,0,0,39,0.03365,1.0,0,0.8462,2,2,0,0.6129,0.9852,2.0,58.88,10.36,0,0,0.0,1,30.7333,0,14,0,12,0,"Fix Queue Manager in podman containerised env

When commands such as ``nova-manage`` are invoked via a podman call,
e.g. ``podman exec nova_conductor nova-manage ...``, the process group
ID assigned is 0. This break the check of start time since system boot
as ``/proc/0`` does not exist.

Fix this behaviour by instead using the process ID to look up the start
time since system boot.

Closes-Bug: #2095178
[SEP]
FILES CHANGED:
releasenotes/notes/fix-queue-manager-with-podman-36078437037fa198.yaml (+6, -0)
oslo_messaging/_drivers/amqpdriver.py (+7, -1)
",-0.816133,-1.292356,0.198869,0.053133,0.260706,-0.310435,0.014683,0.044812,0.069539,-0.173418,0.105533,-0.40717,0.080907,0.168433,0.004613
openstack/openstack-ansible-os_ironic,I7edc658f57de5ffc6d4aa158b02d26fa3ad71c9d,1,0,1.0,3.7377,0.4146,3,13.8,510,0,Bug Fix,0,0,0,51,0.06375,0.9375,0,0.9375,1,2,0,1.0,1.4052,1.0,26.08,14.8,0,0,0.0,0,12.1429,0,0,0,0,0,"Fix quorum queue support for ironic-inspector

Configuration of RPC for ironic-inspector was a bit of a mixed
bag, with some config fixed at defaults which are only relevant
for HA queues. This conforms it to the way the majority of
variables are managed.

Note that this changes the default for
ironic_inspector_oslomsg_rpc_use_ssl, but this should be set via
oslomsg_rpc_use_ssl anyway.

This also removes various unused inspector notification defaults.
[SEP]
FILES CHANGED:
defaults/main.yml (+4, -16)
templates/inspector.conf.j2 (+15, -1)
vars/main.yml (+5, -0)
",-1.419445,-0.743788,0.125614,0.660027,0.326075,-0.431096,0.181548,0.221813,0.193162,-0.088084,0.585074,-0.420291,-0.503062,-0.44192,0.453801
openstack/kolla-ansible,Ie74ea3ea66380063cf67f2e0edb2a0e160d89cd7,0,0,0.85,2.7081,0.0,3,11.0,276,0,Doc,0,0,0,40,0.034101,0.25,0,0.2125,4,3,0,0.6662,1.2638,2.67,18.78,17.73,1,0,0.0,1,18.4,0,0,0,0,0,"Allow ignoring missing containers in service-stop

The kolla docker/podman workers already have support for ignoring when
containers are missing. This patch just exposes that to the CLI with the
flag ``--ignore-missing``.
[SEP]
FILES CHANGED:
kolla_ansible/cli/commands.py (+8, -0)
releasenotes/notes/kolla-ansible-stop-ignore-missing-be57276213f0a7cd.yaml (+5, -0)
ansible/roles/service-stop/tasks/main.yml (+1, -0)
",1.059189,0.023173,-0.321602,1.130324,-0.116282,-0.090139,0.493261,-0.318921,0.006034,-0.186711,-0.008213,0.189235,0.369078,-0.082127,0.177318
openstack/kolla-ansible,I218a7a4245065115e5823c761704fcee9995d275,1,0,0.5333,1.0986,0.5,1,11.0,147,0,Bug Fix,1,0,0,255,0.018632,0.4375,0,0.2333,1,1,0,0.6651,0.0,1.0,-19.68,22.58,0,0,1.0,0,49.0,0,0,0,0,0,"CI: Fix ironic scenario image builds

Needed after I2f2bdbc9e1c6ad6da4ac7098ddd36143123c3062
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",0.993463,-0.19643,-2.095746,-2.76199,1.623966,0.479845,0.739023,-0.649167,-0.1439,-0.049254,-0.6421,0.345957,-0.206752,-0.073581,-0.10764
openstack/kayobe,I539a29c77a0165d43ca2ce359105c5460f450cd8,1,0,0.8293,2.3026,0.2222,2,8.0,219,0,Bug Fix,0,0,0,41,0.034541,0.0,0,0.0,3,1,0,0.912,0.7642,3.0,22.47,16.53,0,0,0.0,0,21.9,0,0,0,0,0,"Fix Depends-On

Use version checked out by Zuul so Depends-On works and only override
version for previous release.

Co-Authored-By: Will Szumski <will@stackhpc.com>
[SEP]
FILES CHANGED:
roles/kayobe-galaxy-requirements/defaults/main.yml (+1, -1)
roles/kayobe-galaxy-requirements/tasks/main.yml (+6, -1)
",-1.070328,0.165506,-1.530036,-1.237575,0.330064,0.196725,0.665785,0.020745,0.024622,0.224729,0.331199,0.005178,0.55778,0.231257,-0.333445
openstack/kolla-ansible,I51c10c614f8e5a553d0faaf4920454fd0541646e,1,1,1.0,2.3026,0.2222,1,9.5,173,0,Bug Fix,0,0,0,7,0.027237,1.0,0,1.0,4,1,0,0.6656,0.0,4.0,41.35,14.33,1,0,0.0,0,17.3,0,6,0,17,0,"Fix Opensearch role support for Ansible check mode

Fixed check mode support for Opensearch role.

Closes-Bug: 2095515
[SEP]
FILES CHANGED:
ansible/roles/opensearch/tasks/post-config.yml (+7, -2)
",0.638246,-0.576924,-0.731264,-0.384444,0.072478,0.113513,-1.183082,0.85303,-0.038343,0.083258,0.263367,0.286207,0.390398,-0.52701,0.113354
openstack/kolla-ansible,I6627e12e53e7223340b26cfbe6e6e1f2c6a3d4fe,1,1,1.0,0.6931,0.0,1,14.0,221,0,Bug Fix,0,0,0,8,0.030075,0.5,0,0.5,4,1,0,0.6662,0.0,4.0,41.55,11.31,1,0,0.0,0,110.5,0,6,0,16,0,"Fix Magnum role support for Ansible check mode

Fixed Magnum role failed to create trustee user role when running
with Ansible check mode enabled.

Closes-Bug: 2095519
[SEP]
FILES CHANGED:
ansible/roles/magnum/tasks/register.yml (+1, -0)
",0.421214,-1.13358,-0.555455,-0.211152,0.041059,0.296757,-1.139315,0.40251,-0.034994,-0.188605,0.413633,0.081273,0.628595,-0.378686,-0.000146
openstack/kolla-ansible,I18d3ecac6e3d92029b12b3f9d6f27e3e6579a8c7,1,0,0.5352,1.6094,0.0,2,13.0,159,0,Bug Fix,0,0,0,256,0.018703,0.4,0,0.2141,5,2,0,0.6667,0.8113,4.5,-53.65,17.51,0,0,0.0,0,31.8,0,0,0,0,0,"proxysql: Add support for mysql-verbose_query_error

Default value is taken from openstack_logging_debug
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+3, -0)
ansible/roles/loadbalancer/defaults/main.yml (+1, -0)
",1.946529,-0.156792,-0.158382,-0.319042,-0.213331,-0.270705,-0.118691,0.004855,0.525996,-0.731793,0.416935,-0.465786,-1.184792,-0.50611,0.409521
openstack/openstack-ansible-plugins,I03a9bf483916833e9992be30f60422ebbbbc7597,1,1,0.8718,1.0986,0.5,1,8.0,356,0,Bug Fix,0,0,0,39,0.168103,1.0,0,0.8718,2,1,0,1.0,0.0,2.0,23.17,14.2,0,0,0.0,0,118.6667,0,6,0,5,0,"Fix remote_user with ssh connection plugin

Many paramters are passed in the task_keys variable, and these
were thrown away and replaced with None in the openstack-ansible
connection plugin.

See https://paste.opendev.org/show/bPM5qp2zp83YzLt1iCYS/ for an
example set of task_keys.

Closes-Bug: 2044229
[SEP]
FILES CHANGED:
plugins/connection/ssh.py (+1, -1)
",-0.961051,-0.417446,-0.890102,-0.338311,-0.616148,-0.048813,0.226788,-0.132645,0.393702,0.152152,-0.070245,-0.768646,0.190434,0.007754,0.247415
openstack/kolla-ansible,If9319e6d4ed21eedbccffa5d01e44cba0af77281,0,0,0.537,1.0986,0.5,1,10.0,103,0,CI,1,0,0,257,0.01877,0.5517,0,0.2963,1,1,0,0.6672,0.0,1.0,2.11,12.0,0,0,1.0,1,34.3333,0,0,0,0,0,"CI: Add mariadb jobs trigger on proxysql changes
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",2.163027,-0.028318,0.864782,-0.107996,1.02957,-0.676803,0.170884,0.621824,-0.684891,-0.106986,-0.119238,-0.400602,-0.079996,-0.653277,-0.239967
openstack/kolla-ansible,I742e257b9d156a56dec29ca7d9b2cd93199995b8,1,0,0.5349,1.0986,0.5,1,9.5,183,0,CI,1,0,0,258,0.01884,0.4118,0,0.2202,2,1,0,0.6662,0.0,2.0,19.09,14.33,0,0,1.0,0,61.0,0,0,0,0,0,"CI: Bump mariadb_monitor_connect_timeout to 60000

We're observing galera status sync timeouts in ProxySQL and that
should help.
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+1, -1)
",0.825508,-0.514013,-0.884823,0.091918,0.065012,0.262782,-0.245128,-0.283949,-0.260402,-0.205018,0.578181,-0.403013,-0.580899,-0.385078,0.06227
openstack/kolla-ansible,If5adcb3c2dc0d71122fec74a0fe44be80949ca4e,1,0,0.5367,1.6094,0.5,1,4.5,88,0,CI,1,0,0,259,0.018911,0.5,0,0.2683,1,1,0,0.6667,0.0,1.0,23.67,10.69,0,0,1.0,0,17.6,0,0,0,0,0,"CI: zun - use alpine from quay.io
[SEP]
FILES CHANGED:
tests/test-zun.sh (+2, -2)
",1.926625,1.529367,-0.520707,0.049303,0.411725,-0.579078,0.156453,-0.424956,-1.084428,-0.115828,0.697172,0.02639,0.21505,0.199051,-0.051765
openstack/kolla-ansible,Ibe5a132e109bc46ab7875b70f8357a2f580f931e,1,1,1.0,1.7918,0.2,2,12.0,202,0,Bug Fix,0,0,0,9,0.033708,0.25,0,0.25,4,1,0,0.6672,0.7219,4.0,36.03,14.8,1,0,0.0,0,33.6667,0,6,0,16,0,"Fix Grafana role support for Ansible check mode

Fixed Grafana role tasks failing when running
with Ansible check mode enabled.

Closes-Bug: 2095592
[SEP]
FILES CHANGED:
ansible/roles/grafana/tasks/post_config.yml (+1, -0)
ansible/roles/grafana/tasks/config.yml (+3, -1)
",0.198927,-0.724139,-0.63728,-0.064864,0.266829,0.320208,-1.311452,0.474589,-0.087219,-0.068431,0.334552,0.201683,0.483086,-0.620416,0.123652
openstack/kolla-ansible,I13dc1822f2b803b5a4dbc99cc63ab05ce6016613,0,0,0.5385,5.4931,0.9711,7,9.33,196,0,Bug Fix,0,0,0,260,0.018978,0.6333,0,0.341,2,3,0,0.6677,2.3946,1.14,70.46,10.88,1,0,0.9793,1,0.8066,0,0,0,0,0,"swift: Deprecate for removal in 2025.2

Disable CI jobs as well - those have been failing for some time
and there's no volunteer to fix them.
[SEP]
FILES CHANGED:
tests/init-swift.sh (+0, -57)
tests/test-swift.sh (+0, -71)
tests/run.yml (+2, -43)
zuul.d/base.yaml (+0, -14)
zuul.d/project.yaml (+0, -6)
releasenotes/notes/deprecate-swift-7a30a80aa16c3e48.yaml (+5, -0)
zuul.d/jobs.yaml (+0, -44)
",0.945026,-0.548215,-0.391736,0.157276,-0.908234,0.802365,0.035058,-1.203513,-0.711192,0.447251,0.289715,0.364662,-0.189238,0.222389,-0.02617
openstack/kolla-ansible,Ie1372ce307011c6f2560c7f1fcd520187810fab8,1,1,0.5364,2.4849,0.0909,3,27.0,335,0,Bug Fix,0,0,0,261,0.01872,0.4706,0,0.2524,4,3,0,0.6667,1.3093,3.33,7.1,22.65,0,0,0.0,1,27.9167,0,6,0,13,0,"fluentd: Add placement to list of supported services

Closes-Bug: #2095607
(cherry picked from commit fec66c1334fe798d073954002a668662065be277)
(cherry picked from commit 1845fb8100cc3f3031cfe238c091ecbb2224026f)
(cherry picked from commit 81c2d0725e313a149fcc3a847dae4c89d68592c9)
[SEP]
FILES CHANGED:
ansible/roles/common/defaults/main.yml (+2, -0)
ansible/roles/placement/templates/placement-api-wsgi.conf.j2 (+1, -1)
releasenotes/notes/bug-2095607-f4d9d5aebebddfc8.yaml (+7, -0)
",-1.747836,-0.286877,-1.837231,-2.326548,1.7156,0.234189,1.072793,-0.160809,0.089844,0.448362,0.324803,0.024283,0.606621,0.082989,-0.132431
openstack/kolla,Ie62060b806c3d66653901bf6f2b5ea8941e7a6be,0,0,0.5382,2.4849,0.0,2,4.0,93,0,Feature,0,0,0,262,0.018777,0.6,0,0.3229,2,2,0,0.6646,0.9457,2.0,23.0,21.6,1,0,0.0,1,7.75,0,0,0,0,0,"swift: Deprecate for removal in 2025.2
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+7, -0)
releasenotes/notes/deprecate-swift-fe9f5586f698ba03.yaml (+4, -0)
",1.908655,2.500139,0.297143,0.498607,-0.227939,1.748067,-0.296735,-0.33334,-0.188025,1.234377,0.191935,0.415612,-0.807967,0.083734,0.234247
openstack/charm-ceph-radosgw,Ieb248434b482f513060ca8b453e2068d51fde9cf,1,0,0.9434,2.3026,0.3333,3,4.5,256,0,CI,0,0,1,53,0.004706,1.0,0,0.9434,1,3,0,0.9474,1.5305,0.33,-60.93,19.58,0,0,0.3333,1,25.6,0,0,0,0,0,"Tests: pin boto3

For https://github.com/boto/boto3/issues/4398

Also lint updates

Cherry picked from 41d4c74ec9697d93c4b683a401517c4aba29bebd
[SEP]
FILES CHANGED:
hooks/utils.py (+2, -2)
test-requirements.txt (+3, -0)
tox.ini (+1, -1)
",-0.462866,1.0863,-2.006919,-1.457956,0.484794,0.286959,0.203318,-0.402764,-0.027104,0.212926,-0.621862,-0.150171,0.050802,0.096641,0.081825
openstack/kolla-ansible,Ice51ef729f4e27c6315815fc1d0efed21728d141,1,0,1.0,1.9459,0.0,2,4.0,174,0,CI,1,0,0,2,0.055556,0.5161,0,0.5161,2,2,0,0.6672,0.65,1.5,-72.17,21.6,1,0,1.0,1,24.8571,0,0,0,0,0,"CI: IPV6 - Enable Prometheus in IPV6 scenario

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/940126
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+5, -0)
zuul.d/base.yaml (+1, -0)
",-0.462161,3.46037,-1.851697,-0.082856,-0.994657,0.333777,-0.550743,-0.2639,-0.093329,-0.567349,-0.717154,0.095105,0.452682,-0.383099,-0.037568
openstack/kolla-ansible,I64d09767099baa9028b3b06d876c2b30c34ddf79,0,0,0.5361,3.7377,0.122,4,3.5,211,0,Feature,0,0,0,263,0.018834,0.4,0,0.2144,4,3,0,0.6677,1.6704,3.5,-56.56,18.54,1,0,0.0,1,5.0238,0,0,0,0,0,"gnocchi: Add support for using uWSGI

Depends-On: https://review.opendev.org/c/openstack/kolla/+/960437
[SEP]
FILES CHANGED:
ansible/roles/gnocchi/templates/gnocchi-api.json.j2 (+11, -4)
ansible/roles/gnocchi/tasks/config.yml (+17, -1)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/roles/gnocchi/defaults/main.yml (+6, -0)
",0.360937,2.944323,-1.43718,-0.435113,-1.529631,0.309561,-0.244276,-0.291016,-0.035188,-0.594492,-0.767883,-0.179918,-0.034172,-0.553056,-0.017446
openstack/kolla-ansible,Ibf97abc8bd4c2e7e734b7b1b0f8303cc8ab48123,0,0,0.9,2.3979,0.4,5,4.0,92,0,Feature,0,0,0,80,0.065735,0.6471,0,0.5824,4,3,0,0.6667,2.1219,3.0,12.43,16.6,1,0,0.0,1,8.3636,0,0,0,0,0,"Drop support for Ubuntu Jammy (22.04)
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+1, -1)
doc/source/user/quickstart.rst (+1, -1)
doc/source/user/support-matrix.rst (+0, -1)
ansible/roles/prechecks/vars/main.yml (+0, -1)
releasenotes/notes/remove-ubuntu-jammy-22-04-support-46d5d441a3cbc93d.yaml (+4, -0)
",2.536514,2.184431,-0.121342,-0.014864,0.186648,1.265238,0.43524,0.566318,-1.044816,0.727618,0.397399,0.443556,0.030929,0.283747,0.060578
openstack/kolla-ansible,Ib035534e2d1a27d5f496cfc6fa1d24a3dbe1dd41,1,1,1.0,2.5649,0.1667,3,17.0,314,0,Bug Fix,0,0,0,3,0.071429,0.0,0,0.0,6,2,0,0.6657,1.2516,4.0,0.47,24.45,1,0,0.0,1,24.1538,0,6,0,4,0,"Fix IPv6 addresses for prometheus exporters

Ensure that IPv6 listen addresses for libvirt-exporter and
fluentd prometheus exporter are formatted correctly by
passing them through put_address_in_context as with other
prometheus exporters.

Closes-Bug: #2096659
[SEP]
FILES CHANGED:
releasenotes/notes/promethus-exporters-ipv6-c87b57cd21cb6bfe.yaml (+8, -0)
ansible/roles/prometheus/templates/prometheus-libvirt-exporter.json.j2 (+1, -1)
ansible/roles/common/templates/conf/input/08-prometheus.conf.j2 (+1, -1)
",-0.67469,-1.437615,-0.469546,0.117054,0.529974,-0.601372,-1.11312,0.268762,0.064738,-0.227925,-0.48991,-0.255463,0.239156,-0.40972,0.21686
openstack/kolla-ansible,I8e246419bbb783fa7c55f407986f45476a251252,1,1,1.0,2.0794,0.1429,2,14.0,154,0,Bug Fix,0,0,0,1,0.333333,0.0,0,0.0,4,2,0,0.6662,0.5917,3.0,-6.79,25.6,1,0,0.0,1,19.25,0,6,0,16,0,"Fix Grafana datasource update

Removing hardcoded version number from template

Closes-Bug: #2096664
[SEP]
FILES CHANGED:
ansible/roles/grafana/templates/prometheus.yaml.j2 (+0, -1)
releasenotes/notes/grafana_update_datasources-706e3cdc964c5272.yaml (+6, -0)
",1.29941,-1.187604,-0.678485,-1.121278,-0.147142,0.614588,-1.314998,0.626626,0.249016,-0.405571,0.187188,-0.116693,-0.12611,-0.135486,-0.079457
openstack/kolla-ansible,Ibbce77b18ceb23d0be898fe2d060d7cb0dba2e8f,0,0,0.8889,2.1972,0.75,1,8.33,243,0,CI,1,1,0,81,0.066015,0.375,0,0.3333,1,1,0,0.6667,0.0,1.0,19.02,14.53,0,0,1.0,0,27.0,1,0,0,0,0,"Revert ""CI: Switch to stable/2024.2 tinyipa due to failures""

This reverts commit 3d8d34d486226a370be24e99eff1d1f9fcc622c7.

Reason for revert: TinyIPA images from master are working again
[SEP]
FILES CHANGED:
tests/run.yml (+2, -6)
",-0.149977,-0.605664,-2.002636,-1.56714,0.553065,0.404326,0.704418,-0.066637,0.087429,0.409616,-0.174342,-0.0997,0.096568,0.175198,-0.091601
openstack/kayobe,I539a29c77a0165d43ca2ce359105c5460f450cd8,1,0,0.8333,2.9957,0.3684,3,9.67,288,0,Bug Fix,0,0,0,42,0.035117,1.0,0,0.8333,3,1,0,0.9127,1.36,2.67,13.24,16.28,0,0,0.0,0,14.4,0,0,0,0,0,"Fix Depends-On

Use version checked out by Zuul so Depends-On works and only override
version for previous release.

Co-Authored-By: Will Szumski <will@stackhpc.com>
(cherry picked from commit 0b7d8015251d5f5dc7cba584a8e2ca86a46f758a)
[SEP]
FILES CHANGED:
playbooks/kayobe-base/pre.yml (+5, -5)
roles/kayobe-galaxy-requirements/defaults/main.yml (+1, -1)
roles/kayobe-galaxy-requirements/tasks/main.yml (+6, -1)
",-1.070328,0.165506,-1.530036,-1.237575,0.330064,0.196725,0.665785,0.020745,0.024622,0.224729,0.331199,0.005178,0.55778,0.231257,-0.333445
openstack/openstack-ansible-os_ironic,Id41a9a3deaaff6b110755d7b0f4d23c5937748d1,1,0,0,1.0986,0.5,1,4.0,88,0,Bug Fix,0,0,0,0,0.0,0.9385,0,0.0,1,1,0,1.0,0.0,1.0,23.0,16.6,0,0,0.0,0,29.3333,0,0,0,0,0,"Fix Ironic IPA version for 2024.2
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
",3.092068,0.670357,1.381331,-0.178909,0.021534,0.84779,0.211924,1.510579,0.274703,1.102603,-0.322759,0.03755,-0.40624,0.300414,0.361423
openstack/ironic,I5198d9169cff8474c7a990332639b2d0758e6e1a,1,1,0.9762,4.0775,0.0862,10,29.0,767,0,Bug Fix,0,0,0,42,0.013444,1.0,0,0.9762,5,3,0,0.9538,3.0951,2.7,35.91,18.15,1,0,0.4138,1,13.0,0,6,0,12,0,"Fix agent from being locked out with complex steps

When mixing in-band out-of-band steps, the out-of-band status polling
flag was not being cleared, and was being left to remain in the node
driver_internal_info field, thus preventing future heartbeat operations
from the baremetal node from being processed to check the actual
completion status of a step.

We now always clear the field based upon the workflow in-progress
before starting a new step and should asynchronous steps also
be recorded as a result of any step's actions such as if a reboot
is required.

Special thanks goes to keekz for promptly providing upstream with
the information necessary for us to identify the root cause.

Closes-Bug: 2096938
[SEP]
FILES CHANGED:
ironic/common/async_steps.py (+5, -1)
ironic/conductor/servicing.py (+4, -0)
releasenotes/notes/fix-polling-lockout-for-steps-b9645f0cae18da1e.yaml (+13, -0)
ironic/tests/unit/conductor/test_cleaning.py (+3, -1)
ironic/tests/unit/conductor/test_deployments.py (+3, -1)
ironic/conductor/cleaning.py (+5, -0)
ironic/conductor/deployments.py (+4, -0)
tox.ini (+1, -1)
ironic/tests/unit/conductor/test_servicing.py (+3, -1)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+12, -0)
",-1.374343,-2.113777,1.565292,-0.058419,-0.277667,-0.049045,0.221201,-0.294404,0.283717,-0.136538,-0.075846,0.326894,-0.061428,-0.126844,0.225213
openstack/ironic,Idf792c982a883a4c07ae1dad72e3c54bc73b96a1,1,1,0.7,2.5649,0.0833,2,15.5,239,0,Bug Fix,0,0,0,10,0.062112,1.0,0,0.7,4,2,0,0.9542,1.0,3.0,43.73,13.94,1,0,0.0,1,18.3846,0,6,0,12,0,"Fix redfish session cache on missing password

The redfish_password option is optional, make sure that the SessionCache
does not throw an error when it is not set.

Closes-Bug: 2097019
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/utils.py (+5, -1)
releasenotes/notes/redfish-allow-missing-password-ce4fb161d35a6850.yaml (+6, -0)
",0.462954,-0.976833,-0.570026,0.205136,-0.319138,0.664622,-0.648487,-0.706031,0.220005,-0.060229,0.243486,-0.152059,0.065581,-0.008916,0.192534
openstack/kolla,I6248cb6646b2b0c7af1c29f9a0a244cef1c4cf05,1,1,0.6111,3.8712,0.0,2,13.0,218,0,Bug Fix,1,0,0,36,0.060302,0.625,0,0.3819,4,2,0,0.6625,0.1485,3.0,50.47,11.35,0,0,1.0,0,4.5417,0,6,0,20,0,"tests: Add cross-arch test for etcd

Ensure that when building etcd with --base-arch aarch64, Kolla
uses the arm64 tarball instead of amd64.

Related-Bug: #2103810
[SEP]
FILES CHANGED:
kolla/tests/docker/etcd/Dockerfile.j2 (+1, -0)
kolla/tests/test_build.py (+46, -0)
",1.021124,-0.558318,-0.541808,-0.282611,-0.269743,-0.186821,-0.238484,0.207649,-0.238775,-0.3535,-0.180898,0.132914,0.34183,0.227672,0.213457
openstack/openstack-ansible-os_neutron,Id38a671ff8b5535f232c09a8365963f613eb5bc8,1,1,0.9565,3.912,0.5918,3,14.0,268,0,Bug Fix,0,1,0,207,0.056219,0.9394,0,0.8986,2,2,0,0.9091,1.4262,1.33,23.43,17.03,0,0,0.0,1,5.36,0,10,0,29,0,"Revert ""Re-enable uWSGI as default for Neutron""

This reverts commit 48a935d7c8a8a96d6e66f0cc1b4b7fb7b33760bb.

Reason for revert: A bug was reported regarding uWSGI issue with multinode
setup

Closes-Bug: #2096937
[SEP]
FILES CHANGED:
releasenotes/notes/neutron_uwsgi_re_disable-45f28da6a4e29e54.yaml (+17, -0)
defaults/main.yml (+3, -4)
vars/main.yml (+0, -25)
",-0.707222,-0.567124,-1.653012,-1.497947,0.528613,0.331256,0.29434,0.207386,0.332505,0.047258,0.16022,0.097639,-0.02368,0.001471,0.264373
openstack/kolla-ansible,I19dfa02b15040cb12b04c41015ff65e2829bf210,0,1,0.7273,2.8904,0.7647,2,16.0,288,0,Bug Fix,0,1,0,11,0.063584,1.0,0,0.7273,4,2,0,0.6657,0.9975,3.0,34.61,17.65,1,0,0.0,1,16.0,0,14,0,5,0,"Revert ""keystone: handle OIDC metadata & attribute mappings as template""

This reverts commit 7223bb75c9578026e83949bd06c89d1a1d3e4b6f.

Reason for revert: seems this is not working as intended, see the linked bug

Closes-Bug: 2097005
[SEP]
FILES CHANGED:
releasenotes/notes/template-config-federation-oidc-8e62742de5fcb376.yaml (+0, -9)
ansible/roles/keystone/tasks/config-federation-oidc.yml (+4, -4)
",-0.271978,-1.125361,-1.670609,-1.518771,0.423607,0.307942,0.439979,-0.098282,0.377859,0.00898,0.117369,-0.229162,0.11283,-0.186851,-0.148019
openstack/kolla-ansible,I360f2b7118731554d8fc81cb192809e605b627fc,1,1,0.5753,1.7918,0.0,1,4.25,410,0,Bug Fix,0,0,0,73,0.016183,0.4,0,0.2301,4,1,0,0.6647,0.0,4.0,-41.33,19.35,0,0,0.0,0,68.3333,0,6,0,7,0,"Fix ironic's metrics when prometheus exporter enabled

This patch is just fixing ironic's configuration when
ironic's prometheus exporter is turned on. More in
documentation here [1].

[1] https://docs.openstack.org/ironic-prometheus-exporter/latest/configuration.html

Closes-Bug: #2097096
Depends-On: https://review.opendev.org/c/openstack/kolla/+/940514
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+5, -0)
",-0.963067,1.859738,-0.428312,0.02142,-1.180981,-0.11032,0.345899,0.285083,0.187961,0.019864,0.105382,-0.453615,0.155195,-0.290032,0.116249
openstack/kolla-ansible,I93bbaa61b2d8b5cb0d1a11783086b37a860173b6,0,0,0.5811,3.9318,0.58,22,15.0,808,0,CI,0,0,0,74,0.016386,1.0,0,0.5811,4,1,0,0.6652,4.4182,4.0,15.16,17.81,0,0,0.0,0,15.8431,0,0,0,0,0,"Ensure consistent lock_path across all services

This patch removes the conditional check
`om_enable_queue_manager` for `oslo_concurrency` as
it was inconsistently applied across services and
is actually unrelated to the queue manager. Simply
said somewhere the conditional was present and somewhere
it wasn't.

While `oslo.concurrency` itself does not
require a specific path, the implementation of the queue
manager expects locks to be placed under
`/var/lib/<service>/tmp`, making it necessary to define
this path explicitly. Therefore, the lock path is set
accordingly across all services, regardless of whether
the queue manager is used.

Additionally, this patch adds missing `lock_path`
configurations where they were absent to ensure uniformity.
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+0, -2)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+3, -0)
ansible/roles/ironic/templates/ironic.conf.j2 (+0, -2)
ansible/roles/keystone/templates/keystone.conf.j2 (+0, -2)
ansible/roles/manila/templates/manila-share.conf.j2 (+3, -0)
ansible/roles/aodh/templates/aodh.conf.j2 (+0, -2)
ansible/roles/heat/templates/heat.conf.j2 (+0, -2)
ansible/roles/masakari/templates/masakari.conf.j2 (+0, -2)
ansible/roles/kuryr/templates/kuryr.conf.j2 (+3, -0)
ansible/roles/blazar/templates/blazar.conf.j2 (+0, -2)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+0, -2)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+3, -0)
ansible/roles/nova-cell/templates/nova.conf.j2 (+0, -1)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+0, -2)
ansible/roles/trove/templates/trove.conf.j2 (+0, -2)
ansible/roles/octavia/templates/octavia.conf.j2 (+0, -2)
ansible/roles/glance/templates/glance-cache.conf.j2 (+3, -0)
ansible/roles/masakari/templates/masakari-monitors.conf.j2 (+3, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+0, -2)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+3, -0)
ansible/roles/barbican/templates/barbican.conf.j2 (+0, -2)
ansible/roles/venus/templates/venus.conf.j2 (+0, -2)
",-2.285863,-1.041508,1.316948,0.274422,0.176228,-0.041411,-0.483501,-0.204815,0.298301,-0.110901,-0.12127,-0.149365,-0.446299,-0.242888,-0.009946
openstack/kolla,Ic46b895775edf5e5fb2b637be49e2de1eb4adf36,1,1,0.5733,2.7726,0.0667,3,10.5,189,0,Bug Fix,0,0,0,75,0.016426,0.0,0,0.0,3,3,0,0.6636,1.2419,3.0,22.95,15.63,1,0,0.0,0,11.8125,0,6,0,7,0,"Fix permissions for ironic metrics

This patch adds creation of metrics folder, set
permissions  and  SetGID bit.

Closes-Bug: #2097098
[SEP]
FILES CHANGED:
docker/ironic/ironic-base/ironic_sudoers (+3, -0)
docker/ironic/ironic-base/extend_start.sh (+10, -0)
docker/ironic/ironic-base/Dockerfile.j2 (+1, -1)
",0.552756,-1.539982,-0.262626,-0.426326,-0.016893,0.518884,-1.690292,0.364281,0.390292,-0.193008,-0.551253,-0.322366,0.338157,0.186051,0.118065
openstack/kolla,I7c086ed5da0e3713ac15aaeaceb38f4a05b84bf0,0,0,0.5789,1.3863,0.6667,2,3.29,238,0,Feature,0,0,0,76,0.01659,0.4,0,0.2316,3,2,0,0.6646,0.9183,2.5,-13.52,11.75,0,0,0.0,0,59.5,0,0,0,0,0,"Bump pycadf version to 4.0.1

This patch also removing copy of
ceilometer_api_audit_map.conf file as it is
now removed [1].

[1] https://review.opendev.org/c/openstack/pycadf/+/930971
[SEP]
FILES CHANGED:
kolla/common/sources.py (+1, -1)
docker/ceilometer/ceilometer-base/Dockerfile.j2 (+0, -1)
",-0.678806,1.330046,-0.961309,-0.047878,-0.765561,-0.176996,0.313656,0.415853,0.142502,0.298083,-0.04191,-0.496433,-0.863719,0.027912,-0.051228
openstack/kolla,I022aa4c403f08385beb83b5d0c81f8abb42eb4a7,0,0,0.5714,3.3322,0.6296,11,7.62,547,0,Bug Fix,0,0,0,77,0.016798,0.75,0,0.4286,3,2,0,0.6626,3.3619,2.82,10.48,11.57,1,0,0.0,0,19.5357,0,0,0,0,0,"Install pycadf from pypi package

Previously, the `pycadf` package did not include
configuration files, so they were manually installed
from source. However, this was fixed in pycadf's upstream
in [1], allowing us to rely on the package itself.

Additionally, the `ceilometer_api_audit_map.conf` file
has been removed, as it was dropped in pycadf's upstream
commit here [2]

[1] https://review.opendev.org/c/openstack/pycadf/+/936741
[2] https://review.opendev.org/c/openstack/pycadf/+/930971
[SEP]
FILES CHANGED:
docker/glance/glance-base/Dockerfile.j2 (+1, -1)
docker/nova/nova-base/Dockerfile.j2 (+1, -1)
docker/openstack-base/Dockerfile.j2 (+1, -4)
docker/trove/trove-base/Dockerfile.j2 (+1, -1)
docker/heat/heat-base/Dockerfile.j2 (+1, -1)
kolla/common/sources.py (+0, -4)
docker/cinder/cinder-base/Dockerfile.j2 (+1, -1)
docker/neutron/neutron-base/Dockerfile.j2 (+1, -1)
docker/swift/swift-base/Dockerfile.j2 (+1, -1)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+1, -1)
docker/ironic/ironic-base/Dockerfile.j2 (+1, -1)
",-2.240252,2.5124,0.320895,0.405082,-0.343461,0.188598,0.50961,-0.064845,-0.266793,-0.112615,0.416969,-0.088759,-0.593098,-0.070462,-0.00321
openstack/networking-generic-switch,Ib6e6557fd14621c628fd80158fd4974408ae63dc,1,0,1.0,4.1897,0.6462,2,11.29,610,0,Bug Fix,0,0,0,1,0.2,0.0,0,0.0,3,1,0,0,0.5802,2.0,36.89,11.6,1,0,0.1385,0,9.2424,0,0,0,0,0,"Fix ngs_allowed_vlans validation

The validation was added in [0] was not covering all cases
as port parameters may be updated when port is actually bound
and they may be propagated via update_port_postcommit function.
Move check added in [0] to _is_link_valid method which is
called in all pleases where we handle ports.

Make bind_port lighweigh and do not call heavy switch functions
as it stated in docstring. All actual work will should be done in
update_port_postcommit.

[0] https://review.opendev.org/c/openstack/networking-generic-switch/+/888047
[SEP]
FILES CHANGED:
networking_generic_switch/tests/unit/test_generic_switch_mech.py (+5, -4)
networking_generic_switch/generic_switch_mech.py (+18, -38)
",-1.317515,-0.18243,1.039421,-0.212398,-0.38975,-0.227701,0.045099,-0.402973,0.247428,-0.163274,0.012938,-0.358006,-0.505436,-0.17882,-0.158381
openstack/kolla-ansible,I6ea35de42abf7e865337e85dc1807dd2ee6afe25,0,0,0.5641,2.3026,0.1111,3,17.38,1016,0,CI,0,0,0,78,0.016916,0.4545,0,0.2564,4,3,0,0.6642,1.2244,3.33,12.7,18.46,1,0,0.0,1,101.6,0,0,0,0,0,"cinder: Allow configuring backend_name for Ceph backends

This commit introduces the ability to configure `backend_name` for Ceph
backends in Cinder. Previously, `volume_backend_name` was directly set
to `name`, but in some cases, it is necessary to use a different backend name.

Benefits of this change:
- Provides flexibility in naming backends without modifying `name`.
- Allows uniform configuration in environments with multiple Ceph clusters.
- Maintains backward compatibility ‚Äì if `backend_name` is not defined,
  it defaults to `name`, ensuring the same behavior as before.

This change is particularly useful in multi-AZ deployments where backend
names may differ, but Cinder scheduling requires a consistent identifier.

Additionally, this separation between `name` and `backend_name` is useful when
the same storage type is shared across multiple zones, as it allows defining a
common backend name while keeping distinct configurations for each AZ.
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+1, -0)
releasenotes/notes/cinder-ceph-backend-name-0984e44da7905a81.yaml (+6, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
",-3.087052,-0.103773,2.062668,0.596545,0.607042,0.512215,-0.433077,-0.044063,0.308808,-0.01226,-0.28327,0.076499,-0.105863,-0.552428,-0.205665
openstack/oslo.messaging,I8a31c0c38b42f333bba92159332e7b3b79d70854,1,0,0.5,1.0986,0.5,1,8.43,448,0,Bug Fix,0,0,0,2,0.016,1.0,0,0.5,2,1,0,0.625,0.0,2.0,37.68,12.18,0,0,0.0,0,149.3333,0,0,0,0,0,"Fixed: use self.start_time in QManager shm

In a previous patch, start_time was introduced to take care of
containerized services.
Unfortunately, a bug has been introduced during this change.

The start_time written in /dev/shm was using the previous start_time
written in the file instead of the new one computed at boot of the
service.
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/amqpdriver.py (+1, -1)
",-0.354917,-1.160851,0.166049,0.783154,-0.358262,0.362789,0.238957,-0.265118,0.152346,0.115882,0.044274,-0.047534,-0.33534,0.238459,0.342915
openstack/kolla-ansible,I19521de28e15f51ab99c88c977d0ed7cf08487d5,1,1,0.5,2.7726,0.0667,2,9.0,327,0,Bug Fix,0,0,0,2,0.033333,0.0,0,0.0,4,2,0,0.6632,0.971,3.0,-2.05,15.82,1,0,0.0,1,20.4375,0,6,0,4,0,"Fix usage of multiple OVN availability zones

Use the correct separator in neutron OVN availability zones.
Additionally improve extendability of `ovn-cms-options` by applying
`join` filter on a list.

Closes-Bug: 2097292
[SEP]
FILES CHANGED:
ansible/roles/ovn-controller/tasks/setup-ovs.yml (+8, -1)
releasenotes/notes/bug-2097292-1a41e87d33e7c6a8.yaml (+6, -0)
",0.18763,-0.814978,-0.467081,0.40425,0.108151,-0.065353,-0.7074,0.321096,0.492723,-0.499885,-0.509437,0.024827,0.074416,-0.210707,-0.253834
openstack/kolla-ansible,I7092f3b7ca00019822b8d8f6f425fbb13db9d8ae,0,0,0.0,2.3026,0.2222,1,9.75,314,0,Doc,0,0,0,3,0.007712,0.0,1,0.0,4,1,0,0.6637,0.0,4.0,36.42,14.16,1,1,0.0,0,31.4,0,0,0,0,0,"[Pure Storage] Update Pure reference page in documentation

From the release of 2024.2 (Dalmatian) the SDK required by the
Pure Cinder driver changes from ``purestorage`` to ``py-pure-client``.
This patch updates the Pure documentation to reflect this change.
[SEP]
FILES CHANGED:
doc/source/reference/storage/cinder-guide-pure.rst (+7, -2)
",-0.239457,0.495712,-0.944565,0.788502,-0.105917,0.552211,-0.070766,0.806841,0.441492,0.25921,-0.218362,0.735168,-0.411744,-0.090345,-0.495525
openstack/kolla-ansible,Id4a3b4f3934622572c8493678f109fa67ccfdec6,0,0,0.8372,3.434,0.5,1,13.0,258,0,Doc,0,0,0,43,0.035391,1.0,1,0.8372,4,1,0,0.6627,0.0,4.0,63.49,10.33,1,0,0.0,0,8.3226,0,0,0,0,0,"Upgrade RabbitMQ docs for the Epoxy release

Updates the HA section to account for the change to quorum queues and
streams by default.

Also adds a note to the SLURP section as it's not needed for Epoxy.
[SEP]
FILES CHANGED:
doc/source/reference/message-queues/rabbitmq.rst (+15, -15)
",0.304904,-0.858814,-0.331803,0.843582,-0.043945,0.375624,0.005466,0.286301,-0.071122,0.165073,-0.175056,0.146363,-0.067443,-0.213163,0.005294
openstack/kolla-ansible,Ic6ad64bf8c62bbff175e15029eb121814032c40e,0,0,0.8182,5.9375,0.7487,57,7.0,207,0,Feature,0,0,0,44,0.035341,0.8333,0,0.6818,4,3,0,0.6617,5.6648,3.86,57.72,11.37,1,0,0.0,1,0.5462,0,0,0,0,0,"Don't allow quorum queues to be disabled

We will be upgrading RabbitMQ to version 4.0 in Epoxy. This will not
work without quorum queues being enabled.
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+5, -5)
ansible/roles/keystone/templates/keystone.conf.j2 (+0, -6)
ansible/roles/aodh/templates/aodh.conf.j2 (+0, -6)
ansible/roles/heat/defaults/main.yml (+3, -3)
ansible/roles/masakari/templates/masakari.conf.j2 (+0, -6)
ansible/roles/designate/templates/designate.conf.j2 (+0, -6)
ansible/roles/cinder/defaults/main.yml (+2, -2)
ansible/roles/nova/templates/nova.conf.j2 (+0, -6)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+0, -6)
ansible/roles/cloudkitty/defaults/main.yml (+2, -2)
ansible/roles/blazar/defaults/main.yml (+2, -2)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -6)
ansible/roles/zun/templates/zun.conf.j2 (+0, -6)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+0, -6)
ansible/roles/barbican/defaults/main.yml (+3, -3)
releasenotes/notes/enable_quorum_queues_transient-020b373831acda36.yaml (+0, -4)
ansible/roles/trove/defaults/main.yml (+3, -3)
ansible/roles/magnum/templates/magnum.conf.j2 (+0, -6)
releasenotes/notes/add-queue-manager-3ce79655ac37c345.yaml (+2, -4)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+0, -6)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+0, -6)
ansible/roles/nova-cell/templates/nova.conf.j2 (+0, -6)
ansible/roles/trove/templates/trove.conf.j2 (+0, -6)
ansible/roles/octavia/templates/octavia.conf.j2 (+0, -6)
ansible/roles/aodh/defaults/main.yml (+4, -4)
ansible/roles/nova/defaults/main.yml (+3, -3)
ansible/roles/ironic/defaults/main.yml (+1, -1)
ansible/roles/magnum/defaults/main.yml (+2, -2)
ansible/roles/rabbitmq/tasks/precheck.yml (+2, -6)
ansible/roles/zun/defaults/main.yml (+3, -3)
ansible/roles/watcher/defaults/main.yml (+3, -3)
ansible/roles/mistral/defaults/main.yml (+4, -4)
ansible/roles/tacker/templates/tacker.conf.j2 (+0, -6)
ansible/roles/ironic/templates/ironic.conf.j2 (+0, -6)
ansible/roles/neutron/defaults/main.yml (+16, -16)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -6)
ansible/roles/heat/templates/heat.conf.j2 (+0, -6)
ansible/roles/blazar/templates/blazar.conf.j2 (+0, -6)
ansible/roles/manila/defaults/main.yml (+3, -3)
ansible/roles/cyborg/defaults/main.yml (+3, -3)
releasenotes/notes/rabbitmq-fanout-stream-queue-type-5b73723aa5e9b231.yaml (+1, -3)
ansible/roles/mistral/templates/mistral.conf.j2 (+0, -6)
ansible/roles/keystone/defaults/main.yml (+1, -1)
ansible/roles/glance/defaults/main.yml (+2, -2)
ansible/roles/designate/defaults/main.yml (+7, -7)
ansible/roles/tacker/defaults/main.yml (+2, -2)
ansible/roles/watcher/templates/watcher.conf.j2 (+0, -6)
ansible/roles/masakari/defaults/main.yml (+4, -4)
ansible/roles/octavia/defaults/main.yml (+5, -5)
ansible/roles/venus/defaults/main.yml (+2, -2)
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -6)
ansible/roles/ceilometer/defaults/main.yml (+4, -4)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+0, -6)
ansible/group_vars/all.yml (+1, -12)
ansible/roles/manila/templates/manila.conf.j2 (+0, -6)
ansible/roles/prechecks/tasks/service_checks.yml (+0, -9)
ansible/roles/barbican/templates/barbican.conf.j2 (+0, -6)
",0.71996,-0.096874,-0.46855,0.977758,-0.194051,0.787567,0.435543,-0.540362,-0.830112,0.497159,0.430376,0.312335,-0.260875,-0.501585,0.039833
openstack/kolla-ansible,Ide75a8c9086798bf4bdf5bc02d4a1be17017884f,0,0,0.8,4.8598,0.9453,33,6.33,184,0,Feature,0,0,0,45,0.027726,1.0,0,0.8,4,3,0,0.6608,4.6994,3.88,4.49,10.95,1,0,0.0,1,1.4264,0,0,0,0,0,"Remove om_enable_rabbitmq_high_availability

We're going to upgrade RabbitMQ to 4.0, so this option will not longer
be supported.
[SEP]
FILES CHANGED:
ansible/roles/tacker/templates/tacker.conf.j2 (+0, -3)
ansible/roles/rabbitmq/tasks/upgrade.yml (+0, -2)
ansible/roles/ironic/templates/ironic.conf.j2 (+0, -3)
ansible/roles/keystone/templates/keystone.conf.j2 (+0, -3)
ansible/roles/aodh/templates/aodh.conf.j2 (+0, -3)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -3)
ansible/roles/heat/templates/heat.conf.j2 (+0, -3)
ansible/roles/masakari/templates/masakari.conf.j2 (+0, -3)
ansible/roles/designate/templates/designate.conf.j2 (+0, -3)
ansible/roles/rabbitmq/templates/definitions.json.j2 (+0, -6)
ansible/roles/blazar/templates/blazar.conf.j2 (+0, -3)
ansible/roles/nova/templates/nova.conf.j2 (+0, -3)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+0, -3)
ansible/roles/rabbitmq/tasks/deploy.yml (+0, -2)
ansible/roles/mistral/templates/mistral.conf.j2 (+0, -3)
releasenotes/notes/remove-om_enable_rabbitmq_high_availability-0e9ecae0240c516c.yaml (+7, -0)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -3)
ansible/roles/zun/templates/zun.conf.j2 (+0, -3)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+0, -3)
ansible/roles/watcher/templates/watcher.conf.j2 (+0, -3)
ansible/roles/magnum/templates/magnum.conf.j2 (+0, -3)
ansible/roles/cyborg/templates/cyborg.conf.j2 (+0, -3)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+0, -3)
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -3)
ansible/roles/nova-cell/templates/nova.conf.j2 (+0, -3)
ansible/roles/trove/templates/trove.conf.j2 (+0, -3)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+0, -3)
ansible/roles/octavia/templates/octavia.conf.j2 (+0, -3)
ansible/group_vars/all.yml (+0, -2)
ansible/roles/manila/templates/manila.conf.j2 (+0, -3)
ansible/roles/prechecks/tasks/service_checks.yml (+0, -7)
ansible/roles/barbican/templates/barbican.conf.j2 (+0, -3)
ansible/roles/rabbitmq/tasks/precheck.yml (+0, -24)
",0.523927,0.41379,-1.034797,0.744873,0.40259,0.581722,-0.565398,-0.594658,-0.322585,0.267194,0.154665,0.057478,-1.197557,-0.428029,0.270775
openstack/openstack-ansible,Idcacbd259a704a09512c2008e47f73a268f52799,1,0,1.0,2.5649,0.5833,1,5.5,117,0,Doc,0,0,0,52,0.061831,1.0,1,1.0,4,1,0,0.9375,0.0,4.0,24.36,9.47,0,0,0.0,0,9.0,0,0,0,0,0,"docs: adjust rabbitmq quorum queue guidance for 2024.2 onwards
[SEP]
FILES CHANGED:
doc/source/admin/upgrades/major-upgrades.rst (+5, -7)
",2.061857,-0.315456,1.046008,-0.366993,0.458453,-0.067397,-0.130719,0.801128,-0.182259,0.746271,-0.544372,-0.115569,-0.429651,-0.54256,0.466628
openstack/ironic,I8d0d693d757edeb16f7781a09b01a487a170d08d,1,0,1.0,1.0986,0.5,1,8.67,198,0,Bug Fix,0,0,0,5,0.010142,0.5,0,0.5,2,1,0,0.9545,0.0,2.0,28.84,15.77,0,0,0.0,0,66.0,0,0,0,0,0,"Fix invalid command in grenade destroy

This command is invalid and produces errors. Based on context, assuming
it was intended to be a delete.
[SEP]
FILES CHANGED:
devstack/upgrade/resources.sh (+1, -1)
",1.915236,-1.823239,0.102087,-0.052183,-0.750879,0.578398,0.20926,-0.902462,0.011867,0.189278,0.137342,0.337143,-0.03902,0.304837,-0.303753
openstack/kolla-ansible,I035d1c06ac4076b4a9de9a0bf31c09e65a9bbbe4,1,1,0.75,3.091,0.2381,3,8.25,371,0,Bug Fix,0,0,0,4,0.040816,1.0,0,0.75,4,3,0,0.6598,1.4937,3.33,-45.08,25.12,0,0,0.0,1,16.8636,0,6,0,3,0,"Letsencrypt disabled redundant entries in configs

Configuration with letsencrypt disabled generates
in haproxy unnecessary backend 'acme_client_back'
and 'path_reg ^/.well-known/acme-challenge/.+'.

Backend 'acme_client' change enabled from
'enable_horizon' to 'enable_letsencrypt' seems right

Closes-Bug: #2097452
[SEP]
FILES CHANGED:
ansible/roles/horizon/defaults/main.yml (+5, -5)
releasenotes/notes/bug-2097452-6b635e49606ebe26.yaml (+7, -0)
ansible/roles/haproxy-config/templates/haproxy_single_service_split.cfg.j2 (+4, -0)
",-0.858165,-0.910834,-0.738085,-0.355348,0.624926,-0.677608,-0.299212,0.354667,-0.025929,-0.619632,0.045157,-0.978803,-0.092178,-0.052478,0.415993
openstack/openstack-ansible-rabbitmq_server,I3c2751da86492c8659252cf5d7b691ce2cc111cf,1,0,1.0,2.3979,0.0,1,6.0,93,0,Feature,0,0,0,1,0.333333,1.0,0,1.0,1,1,0,0.8667,0.0,1.0,-10.75,29.07,0,0,0.0,0,8.4545,0,0,0,0,0,"Workaround rabbitmq-server issue #3369
[SEP]
FILES CHANGED:
tasks/rabbitmq_upgrade_prep.yml (+10, -0)
",1.569588,1.936324,0.59747,-0.703667,0.123464,0.420018,-0.497965,0.159698,0.091289,-0.034038,0.509141,-0.096864,-0.013524,-0.65309,1.06094
openstack/ironic,I9b08579d0b2620e8bf63db1f189b01cf1fdc537b,1,0,1.0,2.1972,0.125,2,11.0,180,0,CI,0,0,0,4,0.081633,1.0,0,1.0,2,2,0,0.9549,0.9544,2.0,41.85,15.31,1,0,0.0,1,20.0,1,0,0,0,0,"Add servicing to stuck states on recovery

servicing is an intermediate state that should be cleaned up
on conductor startup.
[SEP]
FILES CHANGED:
ironic/common/states.py (+2, -1)
releasenotes/notes/fix-stuck-on-servicing-9a86f32d9687461a.yaml (+5, -0)
",0.790152,-0.701037,-0.328939,0.98545,0.259796,0.684305,-0.187672,-1.036162,0.000855,0.110073,-0.337961,0.635275,-0.221258,0.268155,0.070599
openstack/ironic,Idc145f4eea87a8db69202b8d7953975d7d5cba2c,1,0,0.9767,2.7726,0.2,2,29.25,722,0,CI,0,0,0,43,0.013514,1.0,0,0.9767,2,1,0,0.9552,0.9968,1.5,44.82,16.83,0,0,0.0,0,45.125,0,0,0,0,0,"CI: Only artificially pin down the mtu in multinode

So the prime driver behind pinning the MTU down on our interfaces is so
traffic can cross mutlinode vxlan tunnels between nodes where the devstack
plugin is executing to support more complex tests.

But the reality is that doesn't always make sense, and when Neutron
has a default mtu override based upon ""upstream"" traffic constraints,
that is likey okay as well.

Part of the CI configuration auto-pins the MTU down, which is fine
for single node testing, however with multinode we need to pin the
MTU further down to try and prevent packets from being dropped on
the internal interfaces use to wire up test VMs.
[SEP]
FILES CHANGED:
devstack/lib/ironic (+7, -0)
devstack/settings (+5, -3)
",-1.624502,-1.637085,1.37765,0.070267,-0.107227,-0.311862,0.251528,-0.200859,-0.514776,-0.144147,0.234573,0.053207,0.145648,-0.350845,0.133984
openstack/kolla,I7d2367d4c277287f4db2885f5720a35d934f94b7,1,1,0.8,2.3979,0.6,2,9.5,301,0,Bug Fix,0,0,0,5,0.042017,0.5,0,0.4,3,1,0,0.6606,1.0,3.0,52.48,12.22,0,0,0.0,0,27.3636,0,6,0,13,0,"Opensearch and opensearch-dashboard image size reduction

When building an image, the RUN command grants
permissions which causes the previous layer
to be copied.

During the test, the image was reduced from 2.84GB to 1.57GB

Closes-Bug: #2104007
[SEP]
FILES CHANGED:
docker/opensearch/opensearch-dashboards/Dockerfile.j2 (+2, -3)
docker/opensearch/opensearch/Dockerfile.j2 (+2, -3)
",-0.467898,-1.194614,-0.764213,0.051233,-0.076266,0.395951,-0.521491,0.294298,0.114611,0.129714,0.042741,0.314836,-0.030385,0.363865,-0.08825
openstack/ironic,Iad0d8086e1e79b59da3f9940b83128a3b34d4787,1,0,1.0,2.8904,0.1765,3,9.0,94,0,Feature,0,0,0,3,0.06383,1.0,0,1.0,5,2,0,0.9556,1.5799,3.33,19.1,12.49,0,0,0.3529,1,5.2222,0,0,0,0,0,"Pass agent token to get command results
[SEP]
FILES CHANGED:
ironic/drivers/modules/agent_client.py (+6, -0)
releasenotes/notes/include-agent-token-to-get-requests-982bacce85d95ce8.yaml (+5, -0)
ironic/tests/unit/drivers/modules/test_agent_client.py (+3, -3)
",4.04985,-0.478698,2.165101,0.561362,0.229256,-0.137041,1.410457,0.300673,0.654815,0.027227,-0.364632,-0.41438,0.083063,0.468182,-0.190472
openstack/magnum,I262501b19c62afe090329959d5a538d56486104c,1,0,0,1.7918,0.4,1,16.0,135,0,Bug Fix,0,0,0,0,0.0,0.0,1,0.0,3,1,0,0.9091,0.0,3.0,31.97,18.9,0,0,0.0,0,22.5,0,0,0,0,0,"Install and configure for Red Hat Enterprise Linux and CentOS - fix few mistakes
[SEP]
FILES CHANGED:
doc/source/install/install-rdo.rst (+3, -2)
",1.826632,-0.060969,0.934102,0.246108,0.739824,0.034225,0.002059,0.426187,-1.024903,0.651739,0.040801,0.178034,1.112865,-0.317507,0.022922
openstack/kolla-ansible,I3ac18bd12ed1dceef206040b3e793faa79717a19,1,1,0.3333,2.6391,0.2308,2,8.4,308,0,Bug Fix,0,0,0,6,0.024691,0.5455,0,0.1818,4,2,0,0.6603,0.9957,3.0,47.24,10.03,1,0,0.0,1,22.0,0,6,0,3,0,"Fix regex for blackbox exporter targets

Fixes the regex used to match blackbox exporter targets in the
prometheus.yml.j2 template to be less strict. Previously we were using
\w which did not allow for names with periods or hyphens.

Closes-Bug: #2098511
[SEP]
FILES CHANGED:
releasenotes/notes/fix-blackbox-regex-b16f3f86563de6db.yaml (+7, -0)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+3, -3)
",0.028006,-0.418731,-0.599173,0.335232,-0.008289,-0.180784,-0.035418,-0.029301,0.074018,0.118082,0.220577,-0.271604,0.212121,-0.263816,0.035772
openstack/kolla-ansible,I6b11672ba093c65cef4d20f8ef716e459c2a92c3,1,0,0.4,1.3863,0.0,1,9.8,409,0,Bug Fix,0,0,0,15,0.002301,0.0,0,0.0,2,1,0,0.6608,0.0,2.0,19.06,13.72,1,0,0.0,0,102.25,0,0,0,0,0,"Fix kolla_container_facts performance

If a container has been running for some time,
it will accumulate MBs worth of healthcheck logs
that kolla_container_facts module will forward
to ansible when action ""get_container"" is called.
That causes the execution of this module to
slow down considerably.
[SEP]
FILES CHANGED:
ansible/library/kolla_container_facts.py (+3, -0)
",-0.52631,-1.095238,-0.328974,0.453241,0.125954,-0.015258,-0.280575,-0.957909,-0.291221,-0.318974,-0.068894,-0.269934,-0.081057,-0.000811,0.189138
openstack/kolla-ansible,I9ace3c1d802bc00ce692b3ca755384c6b62bd72d,0,0,0.4375,4.5109,0.1778,2,8.0,344,0,Doc,0,0,0,16,0.002453,0.2,0,0.0875,2,1,0,0.6613,0.929,1.5,12.59,16.2,1,0,0.3444,0,3.7802,1,0,0,0,0,"Add ability to get stopped container's facts

kolla_container_facts could only get running containers,
this patch adds the ability to specify, that user wants
even stopped containers.
Also updates module's docs and corrects few typos.
[SEP]
FILES CHANGED:
ansible/library/kolla_container_facts.py (+49, -10)
tests/test_kolla_container_facts.py (+25, -6)
",0.650915,-1.416467,-0.003022,0.534822,-0.141735,-0.276527,0.047173,-0.680434,-0.095153,-0.156753,-0.42735,-0.395203,0.124041,0.01269,-0.130659
openstack/kolla-ansible,I1128f44c2d1731407969fdea337f7923efe91ade,0,0,1.0,4.1109,0.4833,10,4.0,124,0,Feature,0,0,1,2,0.2,0.7,0,0.7,4,5,0,0.6603,3.0775,1.3,26.53,14.93,1,0,0.5,1,2.0328,1,0,0,0,0,"Bump ansible-core versions to 2.17 and 2.18

Bump Ansible collections
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
releasenotes/notes/ansible-core-bump-2-18-a131f759cf2f23c7.yaml (+6, -0)
tests/run.yml (+6, -1)
lint-requirements.txt (+1, -1)
tests/templates/globals-default.j2 (+0, -4)
doc/source/conf.py (+4, -4)
requirements-core.yml (+4, -4)
zuul.d/base.yaml (+2, -2)
zuul.d/jobs.yaml (+5, -10)
ansible/roles/prechecks/vars/main.yml (+2, -2)
",0.1821,1.070099,-0.833045,0.618028,1.132382,0.063949,-0.740949,0.733822,-0.771518,0.92638,-0.223494,0.787698,-0.275264,0.503516,0.188692
openstack/kolla-ansible,I46e1c87f1e69e291f2d38af236da8e406cc253ee,0,0,0.6216,3.091,1.0,3,5.0,174,0,CI,0,0,0,37,0.057453,0.5,0,0.3108,4,1,0,0.6594,1.585,4.0,19.87,14.0,0,0,0.0,0,7.9091,0,0,0,0,0,"Remove not needed service role assignment during upgrades.

For Ironic, Nova, Cinder. It is not needed since Dalmatian.
[SEP]
FILES CHANGED:
ansible/roles/cinder/tasks/upgrade.yml (+0, -7)
ansible/roles/nova/tasks/upgrade.yml (+0, -7)
ansible/roles/ironic/tasks/upgrade.yml (+0, -7)
",1.773058,-0.793961,-0.246588,0.266561,-0.28435,0.506586,-0.328699,0.359259,-0.51989,0.003258,0.012295,0.551869,-0.07773,-0.148694,-0.696613
openstack/kolla-ansible,Ibd5095f55c64031d13160107dcbd9fed98a1bd87,0,0,0.5341,2.4849,1.0,2,11.0,126,0,CI,1,0,0,264,0.01885,0.5152,0,0.2751,1,2,0,0.6584,0.8454,1.0,-27.37,22.58,0,0,1.0,1,10.5,0,0,0,0,0,"CI: Remove unnecessary ansible values (after migration to ansible-core)
[SEP]
FILES CHANGED:
tests/run.yml (+0, -3)
zuul.d/base.yaml (+0, -8)
",1.109705,2.270066,-0.359872,0.852113,1.323287,0.471374,-0.142198,-0.610741,-0.685093,-0.006291,0.179447,0.354218,0.454029,-0.458969,-0.580923
openstack/kolla-ansible,If87b5debcacdbc5001c869440397cd11605a5574,1,1,1.0,2.7081,0.1429,3,15.5,275,0,Bug Fix,0,0,0,5,0.090909,0.5,0,0.5,5,2,0,0.6574,1.1981,2.67,21.9,17.81,1,0,0.0714,1,18.3333,0,6,0,5,0,"Fix for external-frontend-map file not being copied

There was an ``if`` condition preventing the file from being
copied into haproxy container when ``kolla_enable_tls_external``
is set to ``false``.

Closes-Bug: #2098765
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
ansible/roles/loadbalancer/templates/haproxy/haproxy.json.j2 (+2, -2)
releasenotes/notes/haproxy_template_fix-ea89b4cf1110602f.yaml (+9, -0)
",0.514157,-0.605425,-0.363911,-0.015028,-0.272116,0.223393,-0.353315,-0.053255,0.538897,-0.323406,-0.004181,-0.70656,-0.415913,-0.177505,0.33142
openstack/kolla-ansible,I5d4a7895d54aebcf0612e72d315defeda37bb178,1,1,0,1.6094,0.5,1,13.33,338,0,Bug Fix,0,0,0,0,0.0,0.25,1,0.0,4,1,0,0.6579,0.0,4.0,15.64,13.33,1,0,0.0,0,67.6,0,10,0,3,0,"docs: Correct typo in variable name

This commit addresses a typo in the documentation where the variable
""neutron_physical_network"" was incorrectly used. The correct variable
name is ""neutron_physical_networks"", which reflects the actual value
used in the code.

Closes-Bug: #2088062
[SEP]
FILES CHANGED:
doc/source/reference/networking/neutron.rst (+2, -2)
",-0.641199,-0.85458,-0.618443,0.24641,-0.09916,0.474956,-0.790752,-0.084823,0.634555,-0.123842,0.042796,0.036001,-0.461221,0.007099,0.280112
openstack/ansible-collection-kolla,I9ab5f986c9d8c7a0447db2fe2562ea3c7827eaff,0,0,0.5321,2.9444,0.0556,1,8.0,109,0,Bug Fix,0,0,0,265,0.018907,0.4,0,0.2128,3,1,0,0.4583,0.0,3.0,-44.51,28.2,0,0,0.0,0,5.7368,0,0,0,0,0,"podman_sdk: Fix dbus-python installation in virtualenv
[SEP]
FILES CHANGED:
roles/podman_sdk/defaults/main.yml (+17, -1)
",1.554025,0.25726,0.857159,-0.608456,0.496963,-1.03157,-0.434004,0.635539,-0.187221,-0.283632,0.154418,-0.065221,-0.528851,-0.07308,0.295992
openstack/kolla,Iec21fc2363e03133ec77326da7392bc25b40132a,1,1,0.557,1.9459,0.0,2,14.75,437,1,Bug Fix,0,0,0,79,0.0171,0.6667,0,0.3713,2,2,0,0.6616,0.65,2.0,26.97,16.75,0,0,0.0,1,62.4286,0,6,0,4,0,"Remove Git remote origin after cloning sources

When kolla is cloning a Git repository during the build
process, the `.git/config` file retains the remote
origin URL, which may expose sensitive credentials if
authentication tokens are embedded in the URL.

This fix ensures that the remote is removed after cloning
to prevent unintended exposure of credentials.

Closes-Bug: #2098904
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2098904-4c5670049a7e1a66.yaml (+5, -0)
kolla/image/tasks.py (+1, -0)
",-0.728222,-1.827746,-0.342911,0.513246,-0.133921,0.060255,-0.375379,0.190491,0.479715,-0.16301,-0.197839,-0.177668,0.130403,0.199739,-0.182081
openstack/ansible-collection-kolla,Iaa529e00f1a43c0c7e6ef8a4b9faf03efaa97f13,0,0,0.5625,1.6094,0.5,1,5.8,306,0,Bug Fix,0,0,0,80,0.017294,0.6364,0,0.358,3,1,0,0.44,0.0,3.0,-20.76,17.49,0,0,0.0,0,61.2,0,0,0,0,0,"Fix variable lookup for OS-specific dependencies

Replaced `vars[]` with `lookup('vars', ...)` to ensure reliable
resolution of `docker_sdk_packages_dbus_deps_*` based on
`ansible_facts.os_family`.

This prevents failures when accessing role defaults.
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+2, -2)
",-0.171614,0.027383,-0.567474,0.243714,0.850471,-0.215367,-0.701056,0.027991,0.190388,-0.696802,-0.567692,-1.049506,-0.357313,-0.38439,-0.428139
openstack/openstack-ansible-os_neutron,I21302b2cccea794fdf567056eee52ac073aadfb2,1,0,0.9567,3.3322,0.0,2,14.0,370,0,CI,0,0,0,208,0.055749,0.9403,0,0.8996,1,1,0,0.913,0.3809,1.0,9.33,19.89,0,0,0.0,0,13.2143,0,0,0,0,0,"Return defenition for wsgi-required workers

During revert of the change Id38a671ff8b5535f232c09a8365963f613eb5bc8 it
was also accidentally reverted introduction of services which
were required for uWSGI mode.

Without these services being defined, they will not be stopped/managed
while disabling uWSGI on upgrade.
[SEP]
FILES CHANGED:
defaults/main.yml (+2, -0)
vars/main.yml (+25, -0)
",-0.09401,-1.212295,-0.695968,-0.624308,0.572112,0.002092,0.60314,-0.123789,0.170284,-0.117115,-0.387164,0.263573,0.15303,-0.225208,0.168715
openstack/kolla,I57e05a235359547a4477dc869e92047818dc5c15,1,0,0.5301,1.0986,0.5,1,4.0,101,0,CI,1,0,0,266,0.018954,0.0,0,0.0,2,1,0,0.6626,0.0,2.0,-8.72,16.6,0,0,1.0,0,33.6667,0,0,0,0,0,"CI: Add rocky support to process_build_logs.py
[SEP]
FILES CHANGED:
tests/files/process_build_logs.py (+1, -1)
",1.44339,1.270709,-0.154904,0.262899,0.433851,-0.158066,-0.414195,0.135284,-0.128422,-0.067082,0.074895,-0.873424,-0.9202,-0.113785,0.290728
openstack/kolla-ansible,I75bab5ee1491a94ee4eee5da1e0be34b619d9975,1,1,0.5318,4.0604,0.0,2,4.0,174,0,Bug Fix,0,0,0,267,0.019023,0.6667,0,0.3546,6,2,0,0.6584,0.1274,3.5,-58.08,18.27,1,0,0.0175,1,3.0,0,6,0,16,0,"fluentd: Add ovn logs to input

Closes-Bug: #2115244

Depends-On: https://review.opendev.org/c/openstack/kolla/+/952566
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
ansible/roles/common/templates/conf/input/10-openvswitch.conf.j2 (+56, -0)
",0.525149,1.978595,-1.2364,-0.875024,-1.611512,0.304143,-0.294394,0.011387,0.236813,-0.487022,-0.568937,-0.427677,0.134275,-0.193863,-0.008425
openstack/kolla-ansible,I7f9bea3fd3e733345778c59798e5a92fd66d7947,1,0,0.5336,4.7449,0.1579,1,11.0,103,0,CI,1,0,0,268,0.019017,0.75,0,0.4002,1,1,0,0.6589,0.0,1.0,41.85,11.67,0,0,1.0,0,0.8957,0,0,0,0,0,"CI: Test for log files missing in fluentd config
[SEP]
FILES CHANGED:
tests/check-logs.sh (+96, -18)
",3.162685,0.620253,1.326714,0.509355,0.61235,-0.067711,0.561455,0.13648,0.066931,0.026912,-0.009807,-0.601089,0.436228,-0.203321,-0.148942
openstack/ironic,I1842e2651fd2bd8455646db9a3a80c3b9ece5c97,1,1,0,4.1271,0.5246,4,18.7,1221,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.9559,1.7968,3.0,44.44,14.75,1,0,0.541,1,19.6935,0,6,0,6,0,"fix glance metadata layout

The code here builds a dictionary from a glance v2 image object that
roughly resembles the glance v2 image object. The current behavior
nests the 'properties' set on the image under it's own 'properties' key
resulting in the image properties never being seen by the Ironic code.
The breakage results from the change from glanceclient to the SDK which
changed the shape of the returned object. The glanceclient object shape
was that of FakeImage while the SDK returns a Resource based object
which includes attributes for all possible fields which are defined at
the top-level of the object. Since the tests run against a different
value they did not cature the failure. Just changing to the SDK object
results in us copying all these new values to the properties dict which
is definitely not the intention. For maximum compatibility to backport
this filters any value not set from being set into properties and sets
the rest. The broken path is any user of get_image_properties()
(both copies from common/images and deploy_utils) checking for user
supplied properties.

Closes-Bug: 2099953
[SEP]
FILES CHANGED:
ironic/tests/unit/stubs.py (+0, -27)
ironic/common/glance_service/service_utils.py (+15, -3)
ironic/tests/unit/common/test_glance_service.py (+4, -2)
releasenotes/notes/bug-2099275-glance-image-properties-check-2a11337c9e517a5c.yaml (+10, -0)
",-2.467108,-1.654552,3.015988,-0.334699,-0.353443,0.110121,0.208716,-0.034698,0.074419,-0.182054,-0.148409,0.141076,-0.187694,-0.006845,0.081459
openstack/kolla,I6c15cf0fd7b8f1cc3339936c58ad8a8581cfc570,0,0,0.6667,1.6094,0.5,2,6.0,78,0,Feature,0,0,0,3,0.042857,0.8333,0,0.5556,2,2,0,0.6636,1.0,2.0,-10.75,29.07,1,1,0.0,0,15.6,0,0,0,0,0,"[release] Use UCA Epoxy
[SEP]
FILES CHANGED:
docker/base/sources.list.ubuntu.aarch64 (+1, -1)
docker/base/sources.list.ubuntu (+1, -1)
",2.684872,3.599027,0.71898,0.727798,0.832285,1.662809,0.048353,0.365425,-0.370996,0.161028,0.865248,0.268463,0.469742,-0.417832,-1.724798
openstack/kolla,I00ccc47f7a993f13e2b2feb3f6a2565dad32b80c,1,0,0.6667,2.5649,0.25,2,9.33,238,0,Feature,0,0,0,12,0.063158,0.6667,0,0.4444,3,2,0,0.6616,0.9183,2.5,22.12,13.73,1,0,0.0,1,18.3077,0,0,0,0,0,"Add mtools package to ironic-conductor image

In certain deployments ironic-conductor needs to create floppy images to
mount in virtual media. This needs the mtools package installed.
[SEP]
FILES CHANGED:
releasenotes/notes/ironic-mtools-2938ccfe951f5dc5.yaml (+4, -0)
docker/ironic/ironic-conductor/Dockerfile.j2 (+5, -3)
",0.745231,0.512559,-0.165949,1.059803,0.434486,-0.191399,0.460335,0.083383,-0.517359,-0.492689,0.16831,0.297191,0.310653,0.036382,0.106115
openstack/ironic,I5be6380e8c8c3eac5bea1c189b205b05a9fae625,1,1,0.6923,3.5553,0.3529,3,10.25,280,0,Bug Fix,0,0,0,13,0.064356,1.0,0,0.6923,5,2,0,0.9562,1.3272,3.33,58.18,9.95,1,0,0.6176,1,8.0,0,6,0,10,0,"Make floppy images more floppy

Some vendors insist that floppy images need to be exactly 1440 KiB in
size and have a suffix of "".img"". Let's adapt to this and assume that
this doesn't break other vendors.

Closes-Bug: 2100276
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/test_image_utils.py (+12, -9)
ironic/drivers/modules/image_utils.py (+5, -3)
releasenotes/notes/floppy-image-quirks-32e14d32a37b0742.yaml (+5, -0)
",-0.013761,-0.843312,-0.981794,0.373741,-0.295489,0.578113,0.155845,-0.830429,-0.344554,0.413358,0.12453,-0.009622,0.221726,-0.150296,0.144264
openstack/kolla-ansible,I2d7f9f9e47f2c254709ec9d48545c46c9a163fdf,1,1,0.5556,2.9444,0.2222,2,14.33,354,0,Bug Fix,0,0,0,81,0.017495,0.3913,0,0.2174,4,2,0,0.6594,0.9183,3.0,15.22,18.76,1,0,0.0,1,18.6316,0,6,0,9,0,"Fix Redis Sentinel authentication for octavia's jobboard HA

This change ensures proper authentication for both Redis master
and Sentinel, fixing potential issues with high availability and
failover. Without this, Octavia jobboard might fail to reconnect
after a master switch.

Closes-Bug: #2100927
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2100927-5926d812ffa98ac4.yaml (+6, -0)
ansible/roles/octavia/templates/octavia.conf.j2 (+8, -4)
",0.281697,-1.460283,-0.390187,0.250377,-0.171426,0.369644,0.023335,0.45133,0.009185,-0.187698,0.25908,0.212198,0.549454,-0.61126,0.220112
openstack/openstack-ansible-lxc_hosts,Ie5b0f215cceb8e8002b75543f4050042732525a7,1,0,0.9569,1.9459,0.1667,3,8.25,249,0,CI,0,0,0,209,0.055615,1.0,0,0.9569,1,1,0,1.0,1.585,1.0,42.08,11.78,1,0,0.0,0,35.5714,0,0,0,0,0,"Use distro-specific SSH service name

Some Ubuntu 24.04 images do not contain sshd service anymore,
thus fail on the handler.

Let's use distro-specific service name, like we do in other places.
[SEP]
FILES CHANGED:
vars/debian-host.yml (+2, -0)
handlers/main.yml (+1, -1)
vars/redhat-host.yml (+2, -0)
",1.719422,-0.809828,0.433814,0.728847,-0.353212,0.091958,1.012173,-0.305808,-0.664731,-0.172126,-0.238948,-0.289791,0.092422,0.008171,-0.15416
openstack/kolla-ansible,I904a7b959f8fd151ab40bf6ac830dcf13d899239,1,1,1.0,4.8675,0.0,6,10.11,711,0,Bug Fix,0,0,0,4,0.074074,0.0,0,0.0,4,2,0,0.6599,1.4035,3.67,27.37,13.28,1,0,0.0,1,5.4692,0,6,0,8,0,"Prevent accidental Libvirt downgrades

Add a version check for nova_libvirt during deploy and upgrade.
Resolve the target image digest once on the first compute host.
Compare it with each running container digest before version check.
This runs the assertion only on hypervisors that would change
image and leaves other hosts untouched.

Adds a tiny macro role ``service-image-info`` to resolve container
image info (Docker/Podman) once per service. The nova-libvirt version
check now uses it to compare running vs target image.

Closes-bug: #2120290

Co-Authored-By: Bartosz Bezak <bartosz@stackhpc.com>
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/upgrade.yml (+2, -0)
releasenotes/notes/libvirt-catch-downgrade-d297347d745211f0.yaml (+8, -0)
ansible/roles/service-image-info/defaults/main.yml (+3, -0)
ansible/roles/nova-cell/tasks/deploy.yml (+2, -0)
ansible/roles/service-image-info/tasks/main.yml (+26, -0)
ansible/roles/nova-cell/tasks/version-check.yml (+88, -0)
",-1.709088,-0.393564,0.775677,-0.181899,-0.172818,-0.288856,0.133161,0.371239,0.036671,-0.482074,0.378397,0.037163,0.068419,-0.135439,-0.277501
openstack/kolla-ansible,I15a3a4cda6f87c72e1c3d3e4b9781c69ce2eb33e,0,1,1.0,2.0794,0.1429,2,15.0,248,0,Bug Fix,0,0,0,5,0.027322,1.0,0,1.0,4,2,0,0.6604,0.8631,3.0,25.23,15.33,1,0,0.0,1,31.0,1,6,0,8,0,"Fix RabbitMQ version check logic

The existing check for a running RabbitMQ container will never
return true, as it misrepresents the structure of the
container_facts fact.

Closes-Bug: #2102662
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+1, -1)
releasenotes/notes/fix-rabbitmq-version-check-8ace4c607fce543f.yaml (+5, -0)
",0.511836,-1.960912,-0.048883,-0.334538,-0.496481,0.480647,-0.728029,-0.060117,0.391106,-0.078153,-0.012259,0.03727,-0.239251,-0.324691,0.281688
openstack/kayobe,If7c727b98c3b821a40062520e6c8e111d44ac1c0,1,1,0.4286,2.1972,0.125,2,2.6,258,0,Bug Fix,0,0,0,7,0.027344,0.8571,0,0.3673,2,2,0,0.9134,0.8113,1.0,5.71,13.35,1,0,0.0,1,28.6667,0,6,0,10,0,"Bump Michael.Rigart.Interfaces version to 1.15.3

Bump Michael.Rigart.Interfaces version to 1.15.3 to fix an issue where
NetworkManager was not restarted before bouncing interfaces.

Closes-Bug: #2100792
[SEP]
FILES CHANGED:
releasenotes/notes/bump-michael-rigart-interfaces-61def9d407e5de3e.yaml (+6, -0)
requirements.yml (+1, -1)
",-1.129761,1.243286,-1.176381,0.961357,-0.038974,0.918626,-0.691532,0.380376,-0.363635,0.588582,0.51434,0.206856,-0.061603,0.537275,0.347633
openstack/kolla-ansible,I6b536f73433cfc64881ac66e53aa0a5eed709ce6,0,1,0,4.6151,0.1,5,7.6,329,0,Bug Fix,0,0,0,0,0.0,0.5556,0,0.0,2,2,0,0.6595,2.2432,2.0,0.98,16.72,1,0,0.44,1,3.2574,0,8,0,6,0,"Assign labels to kolla volumes

Kolla volumes do not have assigned any labels, that makes
identification and filtering for kolla specific volumes hard.
This change allows for easier volume management.

Closes-bug: #1630545
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+17, -2)
tests/kolla_container_tests/test_docker_worker.py (+21, -1)
tests/kolla_container_tests/test_podman_worker.py (+21, -1)
ansible/module_utils/kolla_podman_worker.py (+22, -6)
releasenotes/notes/assign-labels-to-kolla-volumes-4c733756a7c746d2.yaml (+9, -0)
",0.009618,-1.004444,-0.64372,0.440565,0.060018,0.253455,-0.640512,-0.341247,-0.040013,-0.004592,-0.170589,-0.123554,0.542123,-0.415312,-0.172455
openstack/octavia,I8aa5f128011068321c88f66b1fa986f2ead19034,1,1,1.0,3.6636,0.0789,3,18.0,160,0,Bug Fix,0,0,0,4,0.016736,0.75,0,0.75,7,2,0,0.6085,1.4618,4.67,33.47,16.09,0,0,0.3684,1,4.1026,0,6,0,16,0,"Ignore load_balancer graph in task results to avoid break write data in jobboard DB

Closes-Bug: #2101883
[SEP]
FILES CHANGED:
octavia/tests/unit/controller/worker/v2/tasks/test_network_tasks.py (+14, -0)
octavia/controller/worker/v2/tasks/network_tasks.py (+15, -3)
releasenotes/notes/do-not-serialize-full-loadbalancer-graph-on-get-amphora-network-configs-347a0a4340ee222b.yaml (+6, -0)
",2.351903,-1.124505,-0.408396,-0.753972,-0.523389,0.426081,0.437284,0.467826,0.353165,-0.943425,0.400879,-0.2334,-0.225885,-0.296936,-0.239242
openstack/kolla-ansible,I0d2ab43e5b9ad17cd9fd8ce40315de48350869f9,0,0,0.878,1.3863,1.0,1,3.67,337,0,Feature,0,0,0,82,0.066397,0.2941,0,0.2582,4,1,0,0.6585,0.0,4.0,-27.61,17.22,1,0,0.0,0,84.25,0,0,0,0,0,"Remove deprecated secure_proxy_ssl_header option

This configuration option is deprecated in Nova 31.0.0 (Epoxy) [1]. It
can be replaced by http_proxy_to_wsgi in oslo.middleware, which is
enabled by default in api-paste.ini.

[1] https://review.opendev.org/c/openstack/nova/+/817927
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova.conf.j2 (+0, -3)
",-0.340129,1.561462,-0.794799,0.171768,-0.857335,-0.046695,0.512828,0.21991,0.327023,0.122345,0.249659,-0.415676,-0.532399,-0.089263,-0.26324
openstack/kolla-ansible,Icc6d0c1b24fdcfe13ff516310116849916faea76,1,0,0.8675,1.0986,0.5,1,3.5,93,0,Bug Fix,0,0,0,83,0.067044,0.4545,0,0.3943,4,1,0,0.6576,0.0,4.0,-2.17,18.54,1,0,0.0,0,31.0,0,0,0,0,0,"Fix path to heat config-generator.conf
[SEP]
FILES CHANGED:
ansible/roles/heat/defaults/main.yml (+1, -1)
",2.911888,1.884695,0.887603,0.428796,0.472381,-0.673301,0.90733,0.32262,0.18453,-0.383686,-0.251427,-0.66326,-0.663753,1.0629,-0.049843
openstack/kolla-ansible,I184cf4281f55aac35ecc249b956a0abb9e541145,1,0,0.869,1.3863,1.0,1,2.83,227,0,Feature,0,0,0,84,0.067742,0.2727,0,0.237,4,1,0,0.658,0.0,4.0,-69.75,17.6,1,0,0.0,0,56.75,0,0,0,0,0,"Remove oslo_concurrency from keystone.conf

Keystone stopped using oslo.concurrency in the Ussuri release [1].

[1] https://review.opendev.org/c/openstack/keystone/+/713425
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/keystone.conf.j2 (+0, -3)
",-0.126834,2.740677,-1.261769,0.356597,-0.58077,0.145797,-0.099853,0.190448,-0.013791,-0.115857,-0.035539,-0.36403,-0.576525,-0.128622,-0.277783
openstack/kolla-ansible,I4a0e056eef797afcb446833347fbe139fd7d6677,1,0,0.5353,3.2958,0.0,1,10.0,107,0,CI,1,0,0,269,0.018934,0.0,0,0.0,1,1,0,0.6585,0.0,1.0,10.56,16.0,1,0,1.0,0,3.963,0,0,0,0,0,"CI: Wait until containers exit health starting state
[SEP]
FILES CHANGED:
tests/check-failure.sh (+26, -0)
",2.87613,-0.133648,1.453646,0.21309,0.496192,0.410738,-0.056666,-0.112502,0.297222,0.570725,-0.086202,-0.391714,0.860004,0.265027,-0.335462
openstack/kolla-ansible,I1aa1299f7b932c04492d719d602efcfc38721361,0,0,0,1.6094,0.5,1,3.67,134,0,Bug Fix,0,0,0,0,0.0,0.8,1,0.0,3,1,0,0.659,0.0,3.0,10.84,16.01,1,0,0.0,0,26.8,0,0,0,0,0,"Fix typo in prechecks command
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+2, -2)
",2.898665,1.834774,2.082635,0.218197,0.64704,0.708201,0.475548,-0.66313,0.251517,0.007909,0.41056,-0.812589,0.534626,0.355299,0.719805
openstack/kolla-ansible,Ia601d84283dd8bc45e56e1029106de8836139173,0,0,0.561,5.0689,0.5,34,11.0,260,0,Bug Fix,0,0,0,82,0.017642,1.0,0,0.561,5,1,0,0.6581,4.6986,4.03,36.72,14.1,0,0,0.0,0,1.6352,0,0,0,0,0,"Fix boolean representation in all configurations

In the past, we agreed to use lowercase letters
for boolean representation. This patch implements
exactly that, just changing True -> true, False -> false.
[SEP]
FILES CHANGED:
ansible/roles/swift/templates/proxy-server.conf.j2 (+1, -1)
ansible/roles/tacker/templates/tacker.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic.conf.j2 (+2, -2)
ansible/roles/keystone/templates/keystone.conf.j2 (+4, -4)
ansible/roles/manila/templates/manila-share.conf.j2 (+6, -6)
ansible/roles/aodh/templates/aodh.conf.j2 (+1, -1)
ansible/roles/neutron/templates/openvswitch_agent.ini.j2 (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+9, -9)
ansible/roles/heat/templates/heat.conf.j2 (+2, -2)
ansible/roles/masakari/templates/masakari.conf.j2 (+2, -2)
ansible/roles/neutron/templates/fwaas_driver.ini.j2 (+1, -1)
ansible/roles/designate/templates/designate.conf.j2 (+4, -4)
ansible/roles/placement/templates/placement.conf.j2 (+2, -2)
ansible/roles/blazar/templates/blazar.conf.j2 (+1, -1)
ansible/roles/nova/templates/nova.conf.j2 (+4, -4)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+1, -1)
ansible/roles/mistral/templates/mistral.conf.j2 (+2, -2)
ansible/roles/glance/templates/glance-api.conf.j2 (+5, -5)
ansible/roles/zun/templates/zun.conf.j2 (+2, -2)
ansible/roles/swift/templates/container.conf.j2 (+1, -1)
ansible/roles/trove/templates/trove-guestagent.conf.j2 (+1, -1)
ansible/roles/neutron/templates/neutron_taas.conf.j2 (+1, -1)
ansible/roles/watcher/templates/watcher.conf.j2 (+1, -1)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -1)
ansible/roles/neutron/templates/dhcp_agent.ini.j2 (+3, -3)
ansible/roles/neutron/templates/neutron.conf.j2 (+7, -7)
ansible/roles/nova-cell/templates/nova.conf.j2 (+1, -1)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+1, -1)
ansible/roles/neutron/templates/ml2_conf.ini.j2 (+2, -2)
ansible/roles/nova-cell/templates/nova.conf.d/libvirt.conf.j2 (+2, -2)
ansible/roles/masakari/templates/masakari-monitors.conf.j2 (+2, -2)
ansible/roles/manila/templates/manila.conf.j2 (+1, -1)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+1, -1)
ansible/roles/barbican/templates/barbican.conf.j2 (+3, -3)
",0.388989,-1.418088,-0.084907,0.596504,-0.167135,0.530506,-0.205622,-0.801767,-0.507377,0.759855,-0.444465,0.038992,-0.023603,-0.173605,-0.023442
openstack/charm-keystone-openidc,I38c2733921fd56275cdd1396c6fb09d9fef72b4c,1,1,0.8261,3.434,0.0667,4,8.83,441,0,Bug Fix,0,0,0,23,0.020052,1.0,0,0.8261,1,3,0,1.0,1.8556,0.75,20.69,13.34,1,0,0.3333,1,14.2258,0,18,0,13,0,"Add OIDCOutgoingProxy to Apache configuration

When the juju model-config key juju-https-proxy is set, its value will
be used to pass it to mod_auth_openidc in the configuration stanza
OIDCOutgoingProxy.

When trying to fetch the metadata url content the configured proxy
settings will be used as well, as returned by
charmhelpers.core.hookenv.env_proxy_settings().

Closes-Bug: #2102156
[SEP]
FILES CHANGED:
templates/apache-openidc-location.conf (+3, -0)
src/charm.py (+10, -1)
unit_tests/test_charm.py (+9, -1)
README.md (+6, -0)
",-0.830968,-0.68842,-0.00331,0.257852,0.163001,-0.393342,-0.13041,0.567057,0.715546,-0.383506,0.130084,-0.275571,-0.408937,0.131814,-0.183906
openstack/kolla-ansible,I330678d8971d286e67f115eace1cb606d30433b6,0,0,0.0,5.5094,0.4959,19,5.67,291,0,Bug Fix,0,0,0,1,0.2,1.0,1,0.0,4,1,0,0.6571,3.7134,3.58,34.37,14.03,1,0,0.0,0,1.1781,0,0,0,0,0,"Fix docs rendering errors.

I was reading https://docs.openstack.org's version of the kolla-ansible
advanced configuration guide and noticed some RST rendering errors.
This patch corrects those errors so that the page renders correctly.
[SEP]
FILES CHANGED:
doc/source/reference/logging-and-monitoring/prometheus-guide.rst (+2, -2)
doc/source/reference/storage/manila-hnas-guide.rst (+14, -14)
doc/source/user/quickstart.rst (+3, -3)
doc/source/admin/advanced-configuration.rst (+13, -11)
doc/source/reference/logging-and-monitoring/central-logging-guide.rst (+3, -3)
doc/source/reference/networking/neutron.rst (+1, -1)
doc/source/contributor/release-notes.rst (+5, -5)
doc/source/reference/compute/vmware-guide.rst (+2, -2)
doc/source/admin/tls.rst (+9, -9)
doc/source/reference/networking/designate-guide.rst (+5, -5)
doc/source/reference/compute/libvirt-guide.rst (+2, -2)
doc/source/reference/storage/manila-guide.rst (+7, -7)
doc/source/contributor/setup-identity-provider.rst (+14, -14)
doc/source/reference/storage/cinder-guide.rst (+6, -6)
doc/source/user/quickstart-development.rst (+3, -3)
doc/source/reference/storage/cinder-guide-pure.rst (+2, -2)
doc/source/reference/networking/octavia.rst (+27, -27)
doc/source/user/operating-kolla.rst (+2, -2)
doc/source/contributor/adding-a-new-service.rst (+4, -4)
",0.102741,-0.683043,-0.633636,0.333927,-0.824626,0.214421,-0.023015,-0.301449,-0.013406,-0.219234,-0.181663,0.427824,-0.271465,-0.237119,0.016608
openstack/kolla-ansible,I91816c413ba2044330d27ad871b6916ddad88400,0,0,0.7143,1.0986,0.5,1,7.0,148,0,CI,0,0,0,14,0.059322,0.3529,0,0.2521,4,1,0,0.6562,0.0,4.0,6.36,14.23,0,0,0.0,0,49.3333,0,0,0,0,0,"neutron-metadata-agent: Disable healthcheck

It has been recently failing - let's unblock CI.
[SEP]
FILES CHANGED:
ansible/roles/neutron/defaults/main.yml (+1, -1)
",3.194029,0.463683,0.247268,-0.233933,-1.104621,-0.353415,0.798749,-0.453759,-0.468786,-0.577381,0.421866,0.42014,-0.090229,0.218226,0.17649
openstack/kolla-ansible,I3301f881bbcd1d10497e97afc0d65677aa7fc8de,1,0,0.0,1.0986,0.5,1,3.75,173,0,Bug Fix,0,0,0,1,0.2,0.3095,0,0.0,2,1,0,0.6553,0.0,2.0,-5.65,20.17,1,0,0.0,0,57.6667,0,0,0,0,0,"Fix variable name in globals.yml for enabling the memcached_exporter
[SEP]
FILES CHANGED:
etc/kolla/globals.yml (+1, -1)
",0.976629,1.18104,0.37315,0.786247,1.18019,-0.656068,-0.181388,-0.168043,0.251573,-0.209904,0.024117,-0.85703,-1.085189,-0.244664,0.273861
openstack/kolla,I86a894398f5a41e996735f06fe170fc5e305abbf,0,0,0.5,1.0986,0.5,1,7.0,89,0,Feature,0,0,0,4,0.054054,0.3571,0,0.1786,2,1,0,0.6627,0.0,2.0,-54.07,31.37,0,1,0.0,0,29.6667,0,0,0,0,0,"[release] Use RDO's Epoxy packages
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",2.579458,2.350197,0.797513,0.62079,0.398444,1.054482,0.0142,0.681406,-0.634247,-0.079685,0.479381,0.236303,0.172545,-0.615402,-1.580183
openstack/kolla,Ic342d9d96dfd8ea03f89cdf04ff28e4a7070a54c,0,0,0.537,1.9459,0.0,1,15.0,139,0,CI,0,0,0,270,0.01897,0.0,0,0.0,3,1,0,0.6607,0.0,3.0,16.77,16.67,0,0,0.0,0,19.8571,0,0,0,0,0,"CI: Add qemu-user-static back

It was misssed when moving kolla-build-deps to a role
[SEP]
FILES CHANGED:
roles/kolla-build-deps/tasks/main.yml (+6, -0)
",2.137126,0.675961,-0.422347,-0.511524,-0.532366,-0.451194,0.386467,-0.335299,-0.66418,-0.697812,0.263407,0.684105,-0.166638,0.141663,0.328997
openstack/kolla-ansible,I4c20d268c202e1699f44f7d672c159d3ffa895eb,0,0,0.5351,4.4886,0.0,7,10.0,210,0,CI,0,0,0,271,0.019032,0.6129,0,0.3279,3,4,0,0.6558,2.1839,1.43,-10.59,22.0,1,0,0.9545,1,2.3596,0,0,0,0,0,"CI: Add telemetry scenario

Removing python-ceilometerclient since it didn't have
a release since 2017
[SEP]
FILES CHANGED:
roles/openstack-clients/defaults/main.yml (+4, -0)
tests/test-telemetry.sh (+42, -0)
tests/run.yml (+7, -0)
tests/templates/globals-default.j2 (+6, -0)
zuul.d/base.yaml (+14, -0)
zuul.d/project.yaml (+1, -0)
zuul.d/jobs.yaml (+14, -0)
",2.134086,-0.87247,0.025137,-0.349521,-0.831566,0.440706,0.060544,0.104146,-0.595232,-0.391605,0.295227,0.557758,-0.502711,0.004303,0.307796
openstack/openstack-ansible-os_nova,I7a57c829803fc5baa8b1d3a1805c102f04b8ab2c,1,1,0,1.0986,0.5,1,14.14,2526,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,1,1,0,1.0,0.0,1.0,26.7,13.33,1,0,0.0,0,842.0,0,10,0,16,0,"Fix ansible `difference()` filter use

The `difference()` filter inputs a list, and takes another list as
parameter, computes a set difference between the two, and returns
the resulting (unordered) list.

This is documented here:
https://docs.ansible.com/ansible/latest/collections/ansible/builtin/difference_filter.html

This filter was changed in:
https://github.com/ansible/ansible/commit/7d3d4572edcb4e436883a9aca2859f620077390a

The behaviour changed in ansible-core between 2.15 and 2.16:

```
    ################################################################
    ### Testing ansible-core==2.16
    ################################################################

    PLAY [Test ansible difference filter] ******************************************

    TASK [debug] *******************************************************************
    ok: [localhost] => {
        ""msg"": ""diff with a string: ['one', 'two', 'six'] | difference('two')   => ['one', 'six', 'two']""
    }

    TASK [debug] *******************************************************************
    ok: [localhost] => {
        ""msg"": ""diff with a list:   ['one', 'two', 'six'] | difference(['two']) => ['one', 'six']""
    }

    PLAY RECAP *********************************************************************
    localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

    ################################################################
    ### Testing ansible-core==2.15
    ################################################################

    PLAY [Test ansible difference filter] ******************************************

    TASK [debug] *******************************************************************
    ok: [localhost] => {
        ""msg"": ""diff with a string: ['one', 'two', 'six'] | difference('two')   => ['one', 'six']""
    }

    TASK [debug] *******************************************************************
    ok: [localhost] => {
        ""msg"": ""diff with a list:   ['one', 'two', 'six'] | difference(['two']) => ['one', 'six']""
    }

    PLAY RECAP *********************************************************************
    localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

The above was generated by using: https://github.com/vincent-legoll/test_ansible_diff

Closes-Bug: #2096936
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+1, -1)
",-3.960871,2.404178,3.136582,-0.830855,0.313695,1.442581,-2.130617,-1.056534,-0.761627,0.638908,-0.599884,0.021167,0.466907,0.566478,-0.245422
openstack/kolla,I954106dc32b4c08604d5c40e00fe53e5bb18b266,1,0,0.5331,2.0794,0.1429,2,7.0,92,0,Feature,0,0,0,272,0.018985,0.5122,0,0.273,2,2,0,0.6587,0.8631,2.0,-17.81,25.66,0,0,0.0,1,11.5,0,0,0,0,0,"debian: Use Dalmatian extrepo release
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
releasenotes/notes/debian-dalmatian-65fed830f10946e2.yaml (+5, -0)
",3.282899,0.682319,0.815859,-0.216884,0.772774,-0.174491,0.534382,1.107313,-0.763847,-0.571869,0.389087,0.166343,-0.49086,-0.330467,-0.532503
openstack/kolla-ansible,I9b83e206aff694a9b8caf68da2e50b5c34e7ad23,1,0,0.5348,4.5643,0.4316,5,16.0,151,0,Bug Fix,0,0,0,273,0.019046,1.0,0,0.5348,4,1,0,0.6548,2.3112,4.0,-10.33,18.9,0,0,0.0,0,1.5729,0,0,0,0,0,"mariadb: Use mysql_query instead of command

Also fix hardcoded root username in multiple places
[SEP]
FILES CHANGED:
ansible/roles/mariadb/handlers/main.yml (+11, -8)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+11, -11)
ansible/roles/mariadb/tasks/recover_cluster.yml (+11, -8)
ansible/roles/mariadb/tasks/check.yml (+10, -5)
ansible/roles/mariadb/tasks/restart_services.yml (+11, -9)
",2.477112,-0.758845,0.744556,-0.516427,-0.12471,0.119478,0.358167,-0.322708,-0.333815,-0.210983,0.184002,-0.181387,-0.618012,-0.33677,-0.284376
openstack/kolla-ansible,Ie12da610e7ddd100e8b881a06598d94b7a6f43b0,0,0,0.8706,2.3979,0.0,2,4.0,437,0,Bug Fix,0,0,1,85,0.068383,0.7,0,0.6094,1,2,0,0.6553,0.469,0.5,-21.41,12.6,1,0,0.1,1,39.7273,0,0,0,0,0,"CI: Fix documentation jobs

The documentation jobs (including build-openstack-deploy-guide) are
broken due to the migration to Ubuntu Noble [1]. Fix by installing pcre
via bindep.txt.

Adding bindep.txt to irrelevant-files since it's only used in docs job.

[1] https://lists.openstack.org/archives/list/openstack-discuss@lists.openstack.org/thread/JOMDY26TCW7OX3NXRGOYQCIDXNNJ4E25/
[SEP]
FILES CHANGED:
bindep.txt (+9, -0)
zuul.d/base.yaml (+1, -0)
",-1.801052,0.572397,-0.314076,-0.708969,-0.225137,-0.475067,0.276184,0.261532,-0.256088,0.189781,0.303146,-0.66887,0.088682,0.226473,-0.331644
openstack/kolla,If0cd6444e5d0c898d199a98204588f8ffa4351b9,0,0,0.5365,1.0986,0.5,1,3.0,79,0,Feature,0,0,0,274,0.01899,0.3448,0,0.185,2,1,0,0.6597,0.0,2.0,34.59,14.53,0,0,0.0,0,26.3333,0,0,0,0,0,"Switch to 2025.1 sources
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",3.086353,1.732477,1.548478,0.307013,-0.292407,0.899901,0.412468,0.985741,0.088713,1.669337,-0.280573,0.127865,-0.182623,1.073967,0.235145
openstack/octavia-dashboard,I5ba8ca741b5b0822e9d75f3f3616e763f7b65014,1,0,0.1786,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,28,0.21875,0.1,1,0.0179,2,1,0,0.3714,0.5917,2.0,42.62,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2025.1

Add file to the reno documentation build to show release notes for
stable/2025.1.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.1.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/index.rst (+1, -0)
releasenotes/source/2025.1.rst (+6, -0)
",-0.162587,-0.865866,-0.154865,0.164781,-0.056731,-0.234699,-0.347055,0.563249,0.092233,0.818468,-0.720503,-0.049224,-0.15969,0.855043,0.332572
openstack/kolla,If5610148fc80acf13d4eb79fef78349764f08a17,1,0,0.8333,2.8904,0.0588,3,17.5,253,0,Feature,0,0,0,6,0.031579,0.8,0,0.6667,3,3,0,0.6577,1.2533,2.67,44.04,13.86,1,0,0.0,1,14.0556,0,0,0,0,0,"Add support for aarch64 ipxe to ironic-pxe image

Support aarch64 ipxe only when using Ubuntu and Rocky
Linux base images, as the Debian ipxe package does not
provide a suitable aarch64 ipxe binary.
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+6, -1)
releasenotes/notes/aarch64-ipxe-51888a5972528d77.yaml (+9, -0)
docker/ironic/ironic-pxe/Dockerfile.j2 (+1, -0)
",0.47208,-1.013088,-0.038525,0.491719,0.599076,-0.504428,0.059052,0.445678,-0.210835,0.058385,-0.36675,0.479434,0.067688,-0.356653,0.365134
openstack/kolla-ansible,I1e106a979708cf1d2fb0a30962bd8f53153ffd0f,0,1,0,0.6931,0.0,1,12.0,234,0,Bug Fix,0,0,0,0,0.0,0.3077,0,0.0,4,1,0,0.6544,0.0,4.0,-27.42,21.47,1,0,0.0,0,117.0,0,6,0,4,0,"Add nova-metadata to nova_services_require_policy_json

This is required otherwise the nova_metadata container
does not start when using a nova custom policy.

Closes-bug: #2103562
[SEP]
FILES CHANGED:
ansible/roles/nova/defaults/main.yml (+1, -0)
",0.157523,-1.161495,-1.260826,0.025429,0.056513,-0.205086,-0.947601,-0.11816,0.044513,-0.6971,0.062873,-0.248338,-0.25465,0.14928,0.131858
openstack/kolla-ansible,Ib7fc12415c8b415925e8af7ba41f597289dbcc66,1,0,0.6667,1.0986,0.5,1,14.0,287,0,Feature,1,0,0,15,0.063025,0.5,0,0.3333,1,1,0,0.6535,0.0,1.0,59.68,12.27,1,0,1.0,1,95.6667,0,0,0,0,0,"zuul: Bump base job timeout to 2.5h

The old timeout is 2h and we are recently seeing rather frequent
timeouts when the jobs are running on slow (rax) nodes where the job is
terminated quite close to possibly successfully finishing.
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",0.442832,-1.583238,-0.162908,0.150559,-0.395378,0.319102,0.386528,-0.741352,-0.294754,0.205147,-0.170945,-0.116404,-0.028461,-0.009237,0.223315
openstack/kolla,I0bdef4252d4f2850d2b1a40feac3c373e5c453e7,0,0,0.4,1.9459,0.1667,2,3.5,95,0,Feature,0,0,0,5,0.065789,0.45,0,0.18,2,2,0,0.6588,0.9183,2.0,-38.43,24.26,1,0,0.0,1,13.5714,0,0,0,0,0,"kolla-toolbox: Bump ansible-core to 2.18
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-core-2.18-582103463aba6e8a.yaml (+4, -0)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",1.179985,2.366248,-0.225947,-0.09815,0.41832,-0.591158,-0.346246,0.13939,-0.625441,0.287631,0.10078,0.681715,-0.528014,-0.056991,0.605534
openstack/kolla-ansible,Iba5bc0466019f634c57e487e1e7b8586e3071d02,1,0,0.8605,0.6931,0.0,1,4.0,97,0,Doc,0,0,0,86,0.068635,0.3333,1,0.2868,3,1,0,0.654,0.0,3.0,-19.3,26.6,1,0,0.0,0,48.5,0,0,0,0,0,"Document Ubuntu Noble (24.04) as supported
[SEP]
FILES CHANGED:
doc/source/user/support-matrix.rst (+1, -0)
",1.609684,1.744067,0.559803,0.232622,0.394571,0.957428,-0.240584,0.761768,-0.482698,1.165392,-0.192726,0.765246,0.041727,0.243668,-0.112858
openstack/openstack-ansible,Id3eb93a3c226185c614e324609bf7be5d789f248,1,1,0.9571,1.0986,0.5,1,16.75,511,0,Bug Fix,0,0,0,210,0.055792,0.0,0,0.0,1,1,0,0.9381,0.0,1.0,30.74,14.46,0,0,0.0,0,170.3333,0,6,0,7,0,"Use first utility host as default host for openstack_resources

At the moment openstack_service_setup_host is not actually respected as
group_vars defaults provisionment happens during runtime of
the playbook.

With that, openstack_service_setup_host does have the same value
by default for both distro and source installations, which is the
first utility host.

Let's use this value as default since it might fit most of the usecases.

Closes-Bug: #2096939
[SEP]
FILES CHANGED:
playbooks/openstack-resources.yml (+1, -1)
",-1.278197,-1.470266,0.333976,0.39293,-0.079183,-0.132967,-0.102833,-0.106672,0.107922,-0.175761,0.26643,-0.331292,-0.273649,-0.118954,0.127776
openstack/kolla-ansible,I08e92aaeea644053fd25f80ce1f276a495cebbfc,0,0,0.5345,8.0024,0.992,86,15.5,230,0,CI,0,0,0,275,0.019056,1.0,0,0.5345,4,7,0,0.6544,5.2658,3.48,43.73,13.94,1,0,0.0114,1,0.077,0,0,0,0,0,"Remove Swift role

Since Swift is broken and since deprecation nobody did
pick up the work to make it working - let's remove
swift role and associated integrations/CI scripts.
[SEP]
FILES CHANGED:
ansible/roles/swift/tasks/deploy-containers.yml (+0, -2)
ansible/roles/swift/templates/swift-account-replication-server.json.j2 (+0, -36)
ansible/roles/swift/templates/swift-container-updater.json.j2 (+0, -42)
README.rst (+0, -1)
ansible/roles/swift/tasks/rolling_upgrade.yml (+0, -68)
ansible/roles/swift/templates/swift-container-server.json.j2 (+0, -36)
ansible/site.yml (+0, -23)
ansible/roles/swift/templates/swift-proxy-server.json.j2 (+0, -56)
ansible/roles/swift/templates/swift-rsyncd.json.j2 (+0, -17)
tests/setup_disks.sh (+0, -8)
doc/source/reference/storage/swift-guide.rst (+0, -315)
ansible/roles/glance/templates/glance-api.json.j2 (+0, -6)
ansible/roles/swift/templates/swift-container-replication-server.json.j2 (+0, -36)
ansible/roles/swift/templates/swift-container-auditor.json.j2 (+0, -36)
ansible/roles/swift/templates/swift-object-updater.json.j2 (+0, -50)
ansible/roles/swift/tasks/start.yml (+0, -317)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -12)
etc/kolla/globals.yml (+3, -35)
ansible/roles/swift/templates/swift-account-auditor.json.j2 (+0, -36)
ansible/roles/swift/templates/container.conf.j2 (+0, -41)
ansible/roles/swift/tasks/check.yml (+0, -1)
ansible/roles/swift/templates/swift-object-auditor.json.j2 (+0, -50)
ansible/roles/common/tasks/config.yml (+0, -1)
tests/templates/globals-default.j2 (+0, -4)
ansible/roles/swift/tasks/config_validate.yml (+0, -1)
ansible/roles/swift/templates/object.conf.j2 (+0, -52)
releasenotes/notes/remove-swift-5ebd7b5c4a2cb5b7.yaml (+4, -0)
roles/openstack-clients/defaults/main.yml (+0, -4)
ansible/roles/trove/templates/trove.conf.j2 (+0, -1)
ansible/roles/swift/templates/swift-object-replicator.json.j2 (+0, -50)
ansible/roles/swift/tasks/loadbalancer.yml (+0, -7)
ansible/roles/swift/templates/swift.conf.j2 (+0, -3)
tools/validate-all-file.py (+0, -2)
ansible/roles/swift/templates/swift-account-server.json.j2 (+0, -36)
ansible/library/kolla_container_facts.py (+4, -4)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+0, -11)
tests/templates/inventory.j2 (+0, -16)
ansible/roles/swift/tasks/register.yml (+0, -20)
ansible/roles/swift/tasks/main.yml (+0, -2)
ansible/roles/swift/tasks/stop.yml (+0, -151)
ansible/roles/swift/templates/swift-account-reaper.json.j2 (+0, -36)
ansible/inventory/multinode (+0, -16)
ansible/roles/swift/templates/proxy-server.conf.j2 (+0, -103)
ansible/roles/swift/tasks/upgrade.yml (+0, -6)
ansible/roles/glance/templates/glance-swift.conf.j2 (+0, -8)
ansible/roles/ironic/templates/ironic.conf.j2 (+0, -14)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -8)
doc/source/admin/advanced-configuration.rst (+3, -4)
ansible/roles/swift/tasks/deploy.yml (+0, -10)
ansible/roles/swift/tasks/pull.yml (+0, -74)
ansible/roles/swift/tasks/reconfigure.yml (+0, -111)
ansible/inventory/all-in-one (+0, -16)
ansible/roles/swift/templates/swift-object-server.json.j2 (+0, -50)
ansible/roles/prometheus/defaults/main.yml (+1, -6)
ansible/roles/glance/defaults/main.yml (+1, -4)
ansible/roles/swift/templates/swift-object-expirer.json.j2 (+0, -56)
ansible/roles/swift/templates/swift-object-replication-server.json.j2 (+0, -50)
ansible/roles/swift/vars/main.yml (+0, -2)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -13)
ansible/roles/swift/defaults/main.yml (+0, -110)
ansible/roles/ceilometer/tasks/register.yml (+0, -16)
ansible/roles/destroy/tasks/cleanup_host.yml (+0, -1)
ansible/roles/swift/templates/swift-container-replicator.json.j2 (+0, -36)
doc/source/reference/storage/index.rst (+0, -1)
ansible/roles/common/defaults/main.yml (+0, -8)
etc/kolla/passwords.yml (+0, -4)
tests/setup_gate.sh (+0, -4)
ansible/roles/swift/tasks/config.yml (+0, -230)
tests/pre.yml (+1, -1)
ansible/roles/swift/handlers/main.yml (+0, -4)
doc/source/conf.py (+0, -1)
ansible/roles/skyline/templates/nginx.conf.j2 (+1, -11)
ansible/roles/swift/templates/swift-account-replicator.json.j2 (+0, -36)
ansible/roles/skyline/templates/skyline.yaml.j2 (+1, -1)
ansible/roles/swift/templates/account.conf.j2 (+0, -40)
ansible/roles/gnocchi/defaults/main.yml (+0, -7)
ansible/roles/glance/tasks/config.yml (+0, -16)
ansible/roles/swift/tasks/copy-certs.yml (+0, -6)
ansible/roles/swift/tasks/legacy_upgrade.yml (+0, -35)
ansible/group_vars/all.yml (+4, -23)
ansible/roles/swift/tasks/precheck.yml (+0, -132)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+0, -6)
ansible/roles/swift/templates/rsyncd.conf.j2 (+0, -28)
doc/source/admin/production-architecture-guide.rst (+1, -9)
doc/source/reference/shared-services/glance-guide.rst (+0, -15)
tools/cleanup-host (+0, -6)
",1.180156,-1.788921,-0.068806,0.167274,-0.225571,-0.19382,0.142169,-0.430714,-1.03416,-0.082316,-0.102178,-0.187186,-0.029016,-0.131586,0.10344
openstack/kolla,I05a96f27b47a0f87bcf435872dd08ec0927232e3,0,0,0.5326,6.2897,0.9944,18,6.0,84,0,Feature,0,0,0,276,0.015846,1.0,0,0.5326,3,7,0,0.6568,2.001,2.44,-38.95,29.07,1,0,0.0,0,0.1558,0,0,0,0,0,"Remove swift container images
[SEP]
FILES CHANGED:
docker/swift/swift-proxy-server/Dockerfile.j2 (+0, -21)
doc/source/support_matrix.rst (+1, -3)
docker/swift/swift-rsyncd/extend_start.sh (+0, -4)
docker/swift/swift-account/Dockerfile.j2 (+0, -15)
docker/swift/swift-base/swift_sudoers (+0, -2)
docker/swift/swift-object-expirer/Dockerfile.j2 (+0, -15)
kolla/common/sources.py (+0, -4)
README.rst (+0, -1)
docker/swift/swift-object/Dockerfile.j2 (+0, -15)
docker/swift/swift-rsyncd/Dockerfile.j2 (+0, -25)
docker/kolla-toolbox/Dockerfile.j2 (+1, -3)
kolla/common/config.py (+0, -1)
kolla/common/users.py (+1, -1)
docker/swift/swift-container/Dockerfile.j2 (+0, -15)
doc/source/matrix_aarch64.csv (+0, -1)
roles/kolla-build-config/defaults/main.yml (+0, -1)
docker/swift/swift-base/Dockerfile.j2 (+0, -48)
docker/kolla-toolbox/find_disks.py (+0, -360)
",4.158896,0.852015,2.246456,0.192078,0.504488,0.374347,0.699548,0.808564,0.438008,-0.734061,-0.7515,-0.239734,0.652582,1.023566,-0.437876
openstack/kolla-ansible,Ibaac480503338085eb2c0c17b1fd04c0593c5380,1,1,0.5307,1.3863,0.0,2,10.0,127,0,Bug Fix,0,0,0,277,0.015427,0.5263,0,0.2793,4,1,0,0.6535,0.9183,4.0,-6.35,24.0,0,0,0.0,0,31.75,0,16,0,7,0,"prometheus: Fix running blackbox-exporter on podman

Closes-Bug: #2103732
[SEP]
FILES CHANGED:
ansible/roles/prometheus/defaults/main.yml (+2, -0)
ansible/roles/prometheus/handlers/main.yml (+1, -0)
",2.678818,0.38089,-0.332167,-1.068884,-0.65822,0.137635,-0.334443,0.364894,-0.030228,-0.54553,0.575926,-0.064383,0.034564,-0.183132,0.458194
openstack/kolla,I0e7ce418508f6684a20539c6b6129a134f91c71c,0,0,0.3333,3.6109,0.1111,2,3.33,164,0,Feature,0,0,0,6,0.073171,0.4286,0,0.1429,3,2,0,0.6549,0.5033,2.5,-84.19,17.33,0,0,0.0,1,4.4324,0,0,0,0,0,"bifrost: bump Ansible version to 11

Depends-on: https://review.opendev.org/c/openstack/kolla-ansible/+/945498
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+28, -4)
releasenotes/notes/bifrost-ansible-11-d14b635f9f766675.yaml (+4, -0)
",0.24824,4.081308,-1.728716,-0.059279,-1.084489,0.209488,0.393937,-0.684894,-0.105764,-0.753175,-0.542384,0.218248,-0.067023,-0.38493,0.245152
openstack/kayobe,If15bcfed7f212b9592049287514d8d601b70a41b,1,1,0.5,2.1972,0.0,2,15.5,304,0,Bug Fix,0,0,0,4,0.031008,1.0,0,0.5,4,2,0,0.9141,0.8113,3.0,-2.66,21.68,1,0,0.0,1,33.7778,0,6,0,11,0,"Fix netplan packages do not getting fully removed

Remaining netplan packages ``libnetplan1`` and ``netplan-generator``
templates default network configs which prevents systemd-networkd
to apply Kayobe generated network configs.

Closes-Bug: #2103794
[SEP]
FILES CHANGED:
releasenotes/notes/fix-netplan-not-get-fully-removed-b3770cf475569a6c.yaml (+6, -0)
ansible/roles/network-debian/tasks/main.yml (+2, -0)
",0.309347,-1.288614,-0.343938,-0.127333,0.337406,-0.798726,-0.495439,0.604743,-0.094258,-0.390585,-0.302649,-0.222699,0.029322,0.005804,0.186242
openstack/kolla-ansible,If08aff20fb7803aadcf1a0014b98af1ebbfcca65,0,0,0.4118,1.0986,1.0,1,6.8,313,0,Feature,0,0,0,17,0.002571,0.0,0,0.0,4,1,0,0.654,0.0,4.0,3.36,15.66,1,0,0.0,0,104.3333,1,0,0,0,0,"Remove notifiers from uwsgi service role

No handlers should be triggered during config. Container
will be restarted automatically when kolla_set_configs --check
is ran when applying config to container.
[SEP]
FILES CHANGED:
ansible/roles/service-uwsgi-config/tasks/main.yml (+0, -2)
",1.830331,-1.992498,0.014434,-0.042661,-0.027951,-0.604978,0.1444,0.161781,-0.062553,-0.730123,-0.438848,-0.583221,-0.606678,0.414812,-0.30117
openstack/kolla,I18cea367e94ff2433346c1b388d606e41b1831ad,1,0,0.6053,2.3026,0.5556,4,9.0,99,0,CI,1,0,0,38,0.057143,0.8182,0,0.4952,1,1,0,0.6529,1.9749,1.0,37.9,12.49,0,0,1.0,0,9.9,0,0,0,0,0,"CI: Switch aarch64 builds to native platform
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+1, -2)
.zuul.d/centos.yaml (+1, -1)
.zuul.d/ubuntu.yaml (+1, -1)
.zuul.d/rocky.yaml (+1, -1)
",2.695074,0.684494,1.276074,0.109566,0.617046,0.264758,-0.042425,0.759796,-0.452086,0.693605,-0.150158,0.31468,0.293247,-0.114082,0.240186
openstack/kolla-ansible,I7c51eb7d62a209c2ff53b0a6f49dcbdcdabd7c6d,0,0,0.6154,1.9459,0.5,3,4.17,311,0,Feature,0,0,0,39,0.057864,0.5,0,0.3077,1,2,0,0.6531,1.585,0.67,-24.12,17.67,0,0,0.6667,0,44.4286,0,0,0,0,0,"setup.cfg: Replace dashes with underscores

setuptools 78.0.1 disallowed deprecated dash-separated
and uppercase options in setup.cfg [1]

[1] https://github.com/pypa/setuptools/pull/4870

(cherry picked from commit 0aa7766c1b791d9e311aad7b3cf7d01ff2a64c62)
[SEP]
FILES CHANGED:
tests/run-hashi-vault.yml (+1, -1)
tests/run.yml (+1, -1)
setup.cfg (+1, -1)
",-1.121585,1.175321,-1.31798,-0.901087,0.569309,-0.054804,0.886601,-0.019205,-0.06558,0.771327,0.191933,-0.458613,0.352502,0.18372,-0.193608
openstack/kolla-ansible,Ib9ae56cc256a4f377d366fb33b1f3b2db976f709,0,0,0.5324,1.6094,0.0,1,9.0,97,0,Bug Fix,1,0,0,278,0.01548,0.4444,0,0.2366,1,1,0,0.6522,0.0,1.0,28.5,21.38,0,0,1.0,0,19.4,0,0,0,0,0,"CI: Fix ipv6 scenario triggered from Kolla
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+4, -0)
",2.10662,0.622665,0.62126,-0.546238,0.127437,0.801937,-0.520127,0.369827,-0.007401,0.383762,0.671322,-0.339724,0.502978,-0.173958,0.209828
openstack/ironic,Ia9d1ef48ebcf0cc1f1a987fd02f2dd7e74b96271,1,0,1.0,1.3863,0.0,1,16.0,235,0,Bug Fix,0,0,0,5,0.087719,1.0,0,1.0,2,1,0,0.9565,0.0,2.0,42.55,12.65,1,0,0.0,0,58.75,0,0,0,0,0,"Fix confusing logs on tenant network configuration

port like obj can be passed to smartnic checker while it's not aware
of portgroups, giving a confusing log of unknown port data.
[SEP]
FILES CHANGED:
ironic/common/neutron.py (+3, -0)
",1.567772,-2.357348,0.705213,0.215345,-0.092222,-0.456451,0.518021,-0.525287,0.052818,-0.236429,-0.595326,0.028409,-0.125424,-0.26236,-0.20621
openstack/ironic,If6d77a2caf873a716ae8d96eea7ee9b3fd3fbe40,1,0,1.0,6.6758,0.0063,13,2.75,183,0,Doc,0,0,0,4,0.0625,0.0588,0,0.0588,4,4,0,0.9568,2.8994,2.92,-134.36,26.55,1,0,0.0,1,0.2308,0,0,0,0,0,"doc: Migrate Inspection Rules

Document inspection rules.

Related-Change: https://review.opendev.org/c/openstack/ironic/+/939217
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+106, -0)
doc/source/admin/inspection/migration.rst (+1, -2)
api-ref/source/samples/inspection-rule-create-request.json (+34, -0)
api-ref/source/index.rst (+1, -0)
api-ref/source/samples/inspection-rule-list-response.json (+55, -0)
api-ref/source/samples/inspection-rule-update-request.json (+28, -0)
api-ref/source/baremetal-api-v1-inspection-rules.inc (+260, -0)
api-ref/source/samples/inspection-rule-update-response.json (+43, -0)
doc/source/admin/inspection.rst (+1, -3)
api-ref/source/samples/inspection-rule-show-response.json (+39, -0)
api-ref/source/samples/inspection-rule-create-response.json (+21, -0)
api-ref/source/samples/inspection-rule-detail-response.json (+43, -0)
doc/source/admin/inspection/index.rst (+155, -0)
",-0.161213,2.867303,-1.404435,-0.172161,-1.468868,0.354934,-0.577114,0.025132,0.350987,-0.495463,-0.718068,-0.034593,-0.119312,-0.02528,-0.290674
openstack/ironic,Ibd6c697387d4b083673a5a522e162d5b12c6e1ad,1,0,1.0,6.1181,0.2163,6,4.75,235,0,Bug Fix,0,0,0,5,0.005841,0.0,0,0.0,4,2,0,0.9571,1.7057,3.0,-56.24,20.85,1,0,0.5828,1,0.5176,0,0,0,0,0,"Fix mismatch in expected loop functionality

Fix mismatch in expected loop functionality in inspection rules.

Related-Change: https://review.opendev.org/c/openstack/ironic/+/939217
[SEP]
FILES CHANGED:
ironic/common/inspection_rules/engine.py (+2, -2)
ironic/common/inspection_rules/operators.py (+39, -25)
releasenotes/notes/fix-loop-functionality-in-inspection-rules-9bf61e8355297804.yaml (+7, -0)
ironic/common/inspection_rules/actions.py (+18, -9)
ironic/common/inspection_rules/base.py (+64, -23)
ironic/tests/unit/common/test_inspection_rule.py (+225, -39)
",-0.279226,2.296435,-0.9985,0.345149,-0.974418,0.471184,-0.198593,-0.382256,0.484743,-0.358378,-0.633949,-0.158237,0.110463,-0.350608,0.150314
openstack/kolla,I0c001c77bae17eace8c9ca9d94828d04101752fe,1,0,0.5305,1.6094,0.5,1,7.0,93,0,CI,1,0,0,279,0.015532,1.0,0,0.5305,1,1,0,0.654,0.0,1.0,-41.98,25.66,0,0,1.0,0,18.6,0,0,0,0,0,"CI: Sort alphabetically zuul templates
[SEP]
FILES CHANGED:
.zuul.d/project.yaml (+2, -2)
",3.259396,0.780479,1.244911,-0.413092,0.628902,0.558745,-0.132326,-0.056447,-0.115358,-0.254426,0.061782,-0.23273,0.35322,0.439572,-0.555906
openstack/kolla-ansible,Id53640371875bce8ca522a9928149555f29ef05d,0,0,0.5321,3.989,1.0,6,7.0,87,0,Feature,0,0,0,280,0.015584,1.0,0,0.5321,4,2,0,0.6513,2.1661,3.67,-29.9,25.66,0,0,0.2264,0,1.6111,0,0,0,0,0,"Process Epoxy removals from TODO
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/post-config.yml (+0, -8)
ansible/roles/neutron/tasks/upgrade.yml (+0, -7)
ansible/roles/nova-cell/tasks/deploy.yml (+0, -2)
tests/templates/inventory.j2 (+0, -12)
ansible/roles/horizon/tasks/precheck.yml (+0, -22)
ansible/roles/nova-cell/tasks/rolling_upgrade.yml (+0, -2)
",2.536652,0.047295,1.361258,0.013612,0.285418,1.174051,-0.528928,0.424744,-0.430257,-0.412191,0.176262,-0.315916,-0.111529,-0.225857,-0.020747
openstack/kolla-ansible,I5b85efe655978214ad02abf3cda4c4d2b9649add,0,0,0.2857,2.6391,0.3846,3,9.6,381,0,Bug Fix,0,0,0,7,0.059322,0.0,0,0.0,4,3,0,0.6503,1.3347,3.0,24.37,13.84,0,0,0.6154,0,27.2143,0,0,0,0,0,"Disable firewalld in Bifrost container

Not needed inside the container, as firewalld runs on the host.
It was failing bifrost deploy jobs on Rocky.

Make directory creation idempotent during bootstrap.

Fix Bifrost tests by using python-ironicclient instead of python-openstackclient, which is not installed in the container.
[SEP]
FILES CHANGED:
ansible/roles/bifrost/templates/bifrost.yml.j2 (+3, -0)
ansible/roles/bifrost/tasks/bootstrap.yml (+1, -1)
tests/test-bifrost.sh (+4, -4)
",-0.585275,-0.907493,-0.252894,0.699307,-0.003332,-0.287754,0.343306,0.211539,-0.414045,-0.455999,0.371814,0.111358,0.123018,0.017565,0.079495
openstack/kolla,I6b4e6edc110eebb524396138d24b873cb4ea6726,0,0,0.5302,1.9459,0.0,1,19.5,296,0,Feature,0,0,0,281,0.015594,0.0,0,0.0,2,1,0,0.655,0.0,2.0,9.17,24.21,1,0,0.0,1,42.2857,0,0,0,0,0,"Deprecate bifrost

It has long been sort of an abomination of the container world,
let's use this deprecation notice as a motivation to work out
a kolla-ansible mechanism utilising regular ironic container
images to deploy standalone ironic.
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-bifrost-dd93b6d8eb04cac6.yaml (+6, -0)
",0.526997,-2.05311,-0.681622,0.106777,-0.344644,-0.154276,0.269633,-0.433754,-0.505694,-0.148233,-0.114183,0.695135,-0.251925,-0.457228,0.205626
openstack/kolla-ansible,I67a429d7ba5abbe617795a3dd024d294cf5e378d,0,0,0.5284,2.0794,0.0,1,7.0,118,0,Feature,0,0,0,282,0.015644,0.0,0,0.0,2,1,0,0.6494,0.0,2.0,-126.58,31.37,1,0,0.0,1,14.75,0,0,0,0,0,"Deprecate bifrost and deploy-bifrost/deploy-servers subcommands
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-bifrost-2819678ca6456ab1.yaml (+7, -0)
",0.811553,1.438268,-0.482491,0.503278,1.611036,-1.236937,-0.19065,0.302772,-0.94446,-0.610557,-0.056183,0.536949,-0.407263,0.237149,0.188791
openstack/kolla-ansible,Iae2c5ef5251d6695daf3262ed208c4bd914d7fb3,0,0,0.5265,5.9428,0.7947,14,5.2,275,0,Feature,0,0,0,283,0.015693,0.3636,0,0.1915,4,5,0,0.6485,2.9617,3.64,12.83,12.85,1,0,0.2632,1,0.7218,0,0,0,0,0,"glance: Switch to use uWSGI

Glance is removing their warning around running in WSGI [1],
so let's switch.

[1]: https://review.opendev.org/c/openstack/glance/+/963294
[SEP]
FILES CHANGED:
kolla_ansible/tests/unit/test_filters.py (+0, -100)
ansible/roles/fluentd/defaults/main.yml (+0, -6)
ansible/roles/loadbalancer/tasks/upgrade.yml (+9, -0)
doc/source/admin/advanced-configuration.rst (+0, -4)
ansible/roles/glance/templates/glance-tls-proxy.cfg.j2 (+0, -49)
ansible/roles/glance/templates/glance-tls-proxy.json.j2 (+0, -23)
ansible/roles/glance/templates/glance-api.json.j2 (+19, -1)
ansible/roles/glance/tasks/upgrade.yml (+9, -0)
ansible/roles/glance/tasks/config.yml (+18, -26)
ansible/roles/glance/tasks/stop.yml (+9, -0)
ansible/group_vars/all/glance.yml (+0, -1)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -4)
ansible/roles/glance/defaults/main.yml (+7, -88)
releasenotes/notes/uwsgi-glance-97f43edefef2112b.yaml (+7, -0)
",-0.348011,1.283124,-1.022916,0.000316,-1.074226,0.090444,-0.350448,-0.262864,-0.40012,0.297828,-0.463049,-0.483943,0.008549,-0.328289,-0.06144
openstack/kolla-ansible,Ief6e5482e54c34ffdc703bb650bda51bae2bcb5b,1,0,0.5246,1.0986,0.5,1,16.0,131,0,CI,1,0,0,284,0.015424,0.5,0,0.2623,1,1,0,0.6476,0.0,1.0,37.26,13.9,0,0,1.0,0,43.6667,0,0,0,0,0,"CI: bump amphora image to jammy

focal is not getting builds since July 2024
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+1, -1)
",2.126664,-0.37421,0.056144,-0.583248,0.080155,0.139633,-0.066596,-0.120353,-0.72891,-0.090647,0.214411,0.09253,-0.218748,0.123871,0.071112
openstack/kolla-ansible,Ib633667ccb025c87da237894f0c9a5d793bc62f8,1,1,0.6,4.4308,0.3855,5,10.25,423,0,Bug Fix,0,0,0,5,0.036496,0.5,0,0.3,4,2,0,0.6481,2.2486,3.6,-20.23,21.66,1,0,0.0,1,5.0357,0,6,0,4,0,"Fix config.json templates for Prometheus exporters

4 exporters prometheus-cadvisor, prometheus-elasticsearch-exporter,
prometheus-memcached-exporter and prometheus-node-exporter templates
JSON object for copying CA into containers in wrong JSON array.

Corrected this by moving the JSON object templating from
``permissions`` to ``config_files``.

Closes-Bug: #2104253
[SEP]
FILES CHANGED:
ansible/roles/prometheus/templates/prometheus-cadvisor.json.j2 (+11, -8)
ansible/roles/prometheus/templates/prometheus-memcached-exporter.json.j2 (+11, -8)
ansible/roles/prometheus/templates/prometheus-node-exporter.json.j2 (+11, -8)
ansible/roles/prometheus/templates/prometheus-elasticsearch-exporter.json.j2 (+11, -8)
releasenotes/notes/fix-prometheus-config-template-for-copying-ca-into-containers-8b0429bdbd979e3c.yaml (+7, -0)
",-0.704192,0.51303,-0.469023,0.403494,0.197485,-0.854626,0.037064,0.609111,-0.015636,-0.518476,0.142009,-0.378814,0.098715,0.286756,0.108049
openstack/kolla-ansible,Iac15261a0916d14094afdd9b3cb5cba88f505d0f,1,0,0.5,1.6094,0.0,1,4.67,151,0,Doc,0,0,0,2,0.285714,0.6667,1,0.3333,3,1,0,0.6486,0.0,3.0,14.77,16.15,1,0,0.0,0,30.2,0,0,0,0,0,"docs: add validate-config to cli tips & tricks
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+4, -0)
",2.27169,0.98643,0.817275,0.417559,0.888769,-0.507422,-0.041316,-0.668001,-0.468128,0.050764,-0.506242,-0.570988,0.751885,-0.144102,0.055976
openstack/kolla-ansible,Iaecc2a5999ff1dbc5abf56d400f9b9ac5293d1d7,0,0,0.25,3.434,0.1667,4,6.0,523,0,Doc,0,0,0,8,0.061069,0.5,0,0.125,4,2,0,0.6491,1.8799,3.0,-44.24,15.73,0,0,0.0,1,16.871,0,0,0,0,0,"Improve Ironic pin_release_version configuration

This change improves the configuration of Ironic's pin_release_version setting
by:

1. Renaming the variable from openstack_previous_release_name to
   ironic_pin_release_version to better reflect its purpose
2. Making the setting optional by default
3. Adding proper documentation explaining when to use this setting

See: https://docs.openstack.org/ironic/latest/configuration/config.html#DEFAULT.pin_release_version
[SEP]
FILES CHANGED:
ansible/group_vars/all.yml (+0, -3)
ansible/roles/ironic/defaults/main.yml (+8, -0)
ansible/roles/ironic/tasks/rolling_upgrade.yml (+6, -2)
releasenotes/notes/improve-ironic-pin-release-version-8f9e2b3c4d5a6b7c.yaml (+11, -0)
",-2.320008,0.835797,-0.224967,0.83525,0.492979,0.282373,-0.531257,0.025463,0.369286,0.210772,0.034275,-0.363456,-0.430128,-0.024606,0.12646
openstack/kolla,I4113976db743d3c5c4ff62f2876e224888f05a36,0,0,0.7368,3.3322,0.2963,3,2.67,153,0,Feature,0,0,0,19,0.032759,0.3333,0,0.2456,3,3,0,0.6531,1.5677,2.33,-113.12,26.07,1,0,0.0,1,5.4643,0,0,0,0,0,"Upgrade Prometheus to v3

Needed-by: https://review.opendev.org/c/openstack/kolla-ansible/+/945611
[SEP]
FILES CHANGED:
docker/prometheus/prometheus-server/Dockerfile.j2 (+4, -4)
releasenotes/notes/upgrade-prometheus-to-v3-d305280498e0fcaf.yaml (+11, -0)
kolla/common/sources.py (+4, -4)
",0.010445,4.097833,-1.908586,-0.12717,-1.425536,0.223884,0.045985,-0.451309,-0.093695,-0.547752,-0.845964,0.21013,-0.173748,-0.258237,0.081767
openstack/kolla-ansible,I6dcee9c503fd67127d5ea611691e206921b1a8a0,0,0,0.7,4.0431,0.0357,3,2.67,146,0,Feature,0,0,0,20,0.032949,0.55,0,0.385,4,2,0,0.6482,1.1516,3.33,-113.12,26.07,1,0,0.0,1,2.5614,0,0,0,0,0,"Upgrade Prometheus to v3

Depends-on: https://review.opendev.org/c/openstack/kolla/+/945604
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/upgrade.yml (+38, -0)
ansible/roles/prometheus/defaults/main.yml (+2, -2)
releasenotes/notes/upgrade-prometheus-to-v3-bdf73866e7a93194.yaml (+14, -0)
",-0.020307,4.279224,-1.741951,-0.042046,-1.566435,0.685619,0.150976,-0.615076,-0.10823,-0.613502,-0.824018,0.069881,-0.175857,-0.263114,-0.027055
openstack/kolla-ansible,Icb9759807598ccb23522f8478300ac29df789d65,0,0,0.5542,0.6931,0.0,1,12.0,537,0,Bug Fix,0,0,0,83,0.01727,0.4167,0,0.2309,4,1,0,0.6473,0.0,4.0,11.36,14.8,0,0,0.0,0,268.5,0,0,0,0,0,"Fix octavia's config and add newline after jobboard_backend_hosts

Jinja without an explicit newline after {% endfor %} merges the next line
``jobboard_backend_password`` onto the same line as ``jobboard_backend_hosts``,
producing invalid configuration.

This change adds a newline to separate the config options properly and
is follow-up to [1], which caused this issue by reordering config options
alphabetically.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/942799
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -0)
",-1.704786,0.378663,0.126639,0.115003,0.042604,-0.048411,0.079859,-0.230663,0.189242,-0.112581,0.140009,-0.306751,-0.369332,-0.180384,-0.154875
openstack/kolla-ansible,I2683156ea3f241381d58830153dd77b608b6fb6a,1,0,0.5263,0.6931,0.0,1,6.0,252,0,Bug Fix,0,0,0,285,0.015477,0.4,0,0.2105,4,1,0,0.6464,0.0,4.0,-3.7,14.07,0,0,0.0,0,126.0,0,0,0,0,0,"Fix octavia.conf generation after jobboard fix

Add Jinja2 option to not delete trailing newlines in for loops
Followup after [1]

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/942799
[SEP]
FILES CHANGED:
ansible/roles/octavia/templates/octavia.conf.j2 (+1, -0)
",0.435751,1.436697,-0.861099,-0.291587,-1.177803,-0.182552,0.65264,0.037163,0.148084,-0.243142,-0.151525,-0.590212,0.002144,-0.216999,-0.149237
openstack/kolla-ansible,I51aca294d256c33ae52eaab4dcc67860cfc876af,0,0,0.2222,1.3863,0.3333,1,7.5,143,0,Feature,1,0,0,9,0.055901,0.7778,0,0.1728,1,1,0,0.6469,0.0,1.0,7.46,19.0,0,0,1.0,0,35.75,0,0,0,0,0,"Adding new placement error to expected critical msgs

It's expected during upgrade jobs.
[SEP]
FILES CHANGED:
tests/check-logs.sh (+2, -1)
",2.905916,-1.59957,0.400408,0.078334,-0.553835,0.720574,0.348369,-0.358021,0.55788,0.117247,0.026116,-0.057142,-0.305684,0.333952,-0.372655
openstack/kolla-ansible,I52fc5656d07c2586cf8f184183465f5f9af744de,0,0,0.65,1.0986,0.5,1,11.5,221,0,Feature,0,0,0,20,0.009058,0.4375,0,0.2844,4,1,0,0.646,0.0,4.0,29.64,13.3,0,0,0.0,0,73.6667,0,0,0,0,0,"Correct lock path for ironic-inspector

Follow up to I93bbaa61b2d8b5cb0d1a11783086b37a860173b6 which
used a path that did not exist in the ironic-inspector
container.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+1, -1)
",0.108927,-0.601952,-1.475052,-1.346311,1.416354,-0.168732,0.601102,-0.329213,0.096552,0.087198,-0.716576,0.496874,-0.123768,0.082373,0.117356
openstack/ansible-collection-kolla,I53ed8b2f553c1eea263770b30860d224375b26b3,0,0,0.8571,3.1355,0.0909,2,10.0,957,0,Doc,0,0,0,7,0.033816,0.5,0,0.4286,3,2,0,0.4231,0.976,2.5,3.64,13.09,1,0,0.0,1,41.6087,0,0,0,0,0,"Allow creating /etc/hosts without Ansible facts

When fact gathering for specific groups is disabled, the
etc_hosts role does not have enough information to determine
either the IP address of the API network, or the Ansible
hostname/nodename of all hosts [1].

Allow operators to statically override the API network address
of a host in ``/etc/hosts`` by setting ``etc_hosts_api_address``
as an inventory variable. If specified, this takes precedence
over the API interface address currently used.

Also, if the ansible nodename and hostname facts are
not available for a host, fall-back to determining FQDN and
hostname from Ansible special variables [2], which do not
require fact gathering.

[1] https://docs.openstack.org/kolla-ansible/latest/user/ansible-tuning.html#delegated-fact-gathering
[2] https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html#special-variables
[SEP]
FILES CHANGED:
roles/etc_hosts/tasks/etc-hosts.yml (+11, -2)
releasenotes/notes/etc-hosts-no-facts-0b3a1a6fa15d3b2f.yaml (+9, -0)
",-3.481599,1.478306,2.309424,0.21204,0.066313,-0.350793,-0.016986,0.112859,0.358112,-0.263684,-0.450658,-0.027678,-0.065776,-0.155365,-0.369104
openstack/ironic,I7735bce5ce9a91979ec1b561c4047952123735ce,1,1,1.0,2.1972,0.5,1,10.33,396,0,Bug Fix,0,0,0,2,0.028571,1.0,0,1.0,2,1,0,0.9574,0.0,2.0,-11.06,11.88,1,0,0.0,0,44.0,0,6,0,4,0,"Fix passing vtep fields to neutron

Neutron uses folling fields [0]
 * vtep-logical-switch
 * vtep-physical-switch

Fix key name that we pass, replace '_' with '-'

[0] https://github.com/openstack/neutron/blob/196b2c9874df42f53685f5886ae45414c99c5f88/neutron/plugins/ml2/drivers/ovn/mech_driver/ovsdb/ovn_client.py#L376

Closes-Bug: #2105492
[SEP]
FILES CHANGED:
ironic/common/neutron.py (+4, -4)
",-2.702043,1.998423,-0.961227,-0.571283,0.537834,-0.557578,0.546145,0.261757,0.093512,-0.050616,0.212708,-0.344531,0.146205,0.042597,-0.060497
openstack/kolla-ansible,I5b8e9a3ad7d596e1efe7bdb32e3c712342b065bd,0,0,0.528,3.7612,0.0952,4,6.0,144,0,Feature,0,0,0,286,0.01553,0.6154,0,0.3249,4,3,0,0.6451,1.587,3.5,-53.05,22.4,1,0,0.0,1,3.3488,0,0,0,0,0,"octavia: Add support for using uWSGI
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+5, -0)
ansible/roles/octavia/tasks/config.yml (+21, -1)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/roles/octavia/templates/octavia-api.json.j2 (+10, -3)
",2.565712,0.373968,1.343085,-0.211656,-0.276337,0.275448,-0.720219,0.291012,-0.206862,0.525206,-0.330166,-0.083662,0.174595,-0.796828,0.474965
openstack/kolla-ansible,I8f6339af3b88e8cf436192d5b85abca5c4cae9c2,0,0,0.5261,4.654,0.1346,5,3.5,208,0,Feature,0,0,0,287,0.015549,0.5,0,0.2631,4,3,0,0.6442,2.0769,3.6,-74.69,21.4,1,0,0.0,1,1.981,0,0,0,0,0,"heat: Add support for using uWSGI

Depends-On: https://review.opendev.org/c/openstack/kolla/+/954891

Signed-Off-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
ansible/roles/heat/templates/heat-api.json.j2 (+14, -6)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+13, -0)
ansible/roles/heat/defaults/main.yml (+7, -0)
ansible/roles/heat/templates/heat-api-cfn.json.j2 (+14, -6)
ansible/roles/heat/tasks/config.yml (+42, -2)
",-1.019595,2.747336,-2.052322,-0.188745,-0.872458,0.323411,-0.278039,-0.198483,-0.215282,-0.568527,0.062048,0.21899,0.266356,-0.072968,-0.426936
openstack/kolla-ansible,I2b72712479a05a73b82d8e30235333db2c92ebfd,0,0,0.5243,3.8286,0.1111,5,6.0,143,0,Feature,0,0,0,288,0.015516,0.4762,0,0.2497,4,3,0,0.6433,1.8091,3.6,-31.9,22.4,1,0,0.0,1,3.1087,0,0,0,0,0,"ironic: Add support for using uWSGI
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/roles/ironic/defaults/main.yml (+6, -0)
ansible/roles/ironic/templates/ironic-api.json.j2 (+10, -3)
ansible/roles/ironic/tasks/config.yml (+21, -1)
",2.578561,0.54514,1.53896,0.154597,-0.030805,0.581079,-0.694676,0.172213,-0.030054,0.643628,-0.44863,-0.245597,0.144554,-0.63754,0.494979
openstack/kolla-ansible,I799dc6e6fdccc483784fc3c2088ada69f24412e9,1,1,0.6667,2.3979,0.0,2,13.14,710,0,Bug Fix,0,0,0,6,0.027273,0.5,0,0.3333,4,2,0,0.6425,0.7219,3.0,36.25,12.65,1,0,0.0,1,64.5455,0,6,0,7,0,"Fix unrestricted copying of backend TLS certs

With the change
https://review.opendev.org/c/openstack/kolla-ansible/+/915901
K-A copies backend TLS certificates to all containers of projects
when backend TLS for the project is enabled because of less strict
conditional check.

However, this causes K-A to attempt copying non-existent certificates
from hosts that is not part of backend TLS to containers that are
also not part of backend TLS.

This change makes service-copy-certs task check if a host is part of
``tls-backend`` group when copying backend TLS certificate and key.

Cloeses-Bug: #2105505
[SEP]
FILES CHANGED:
releasenotes/notes/fix-unrestricted-copying-of-backend-tls-2bade63581b84c80.yaml (+8, -0)
ansible/roles/service-cert-copy/tasks/main.yml (+2, -0)
",-1.738011,-0.127149,0.84592,-0.028663,-0.243663,-0.402233,-0.180362,0.243456,0.289726,-0.127499,-0.162892,0.153034,0.193208,-0.144969,-0.019063
openstack/kolla-ansible,I1b972c607c1d9fd387e977b73a7529c3e2574387,0,0,0.5476,3.1781,0.5217,6,7.17,414,0,Feature,0,0,0,84,0.017475,0.3333,0,0.1825,4,3,0,0.643,2.3861,3.5,8.72,12.17,0,0,0.0,1,17.25,0,0,0,0,0,"Remove distro_python_version variable

This patch drops the ``distro_python_version``
variable from Kolla Ansible, as it is no longer needed,
the paths have already been handled at the image level.

More details can be found in [1].

[1] https://review.opendev.org/q/topic:%22kolla-distro-python-version%22
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/horizon.conf.j2 (+2, -4)
ansible/group_vars/all/common.yml (+0, -2)
ansible/roles/ironic/templates/ironic-prometheus-exporter-wsgi.conf.j2 (+3, -4)
ansible/roles/skyline/templates/nginx.conf.j2 (+1, -1)
releasenotes/notes/remove-distro-python-version-09adac8895cb87d1.yaml (+4, -0)
ansible/roles/skyline/templates/skyline-console.json.j2 (+1, -1)
",-1.470465,1.400235,-0.748979,0.951623,-0.27541,0.284987,-0.136934,-0.184918,0.237794,0.333749,0.239858,-0.253373,-0.361841,0.27494,-0.136054
openstack/kayobe,Iee558eef66d56c6e3ceae756ed35c967b1d84efc,0,1,0.7826,2.1972,0.125,2,9.0,122,0,Bug Fix,0,0,0,46,0.026271,1.0,0,0.7826,4,2,0,0.9147,0.8113,3.0,-56.1,21.38,0,0,0.0,1,13.5556,0,6,0,4,0,"Fix kolla_ironic_inspector_host in KA template

Closes-Bug: #2105992
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/overcloud-services.j2 (+1, -1)
releasenotes/notes/correct-kolla_ironic_inspector_host-lookup-1e6879a2bbbe1a4d.yaml (+6, -0)
",1.961483,-0.362293,-0.33292,-1.361572,-0.09216,0.109638,-0.740592,0.233443,0.34895,-0.645006,0.65928,-0.440526,-0.686469,-0.344735,0.337241
openstack/kolla,I679ac66186d457ae53f89469fe22c5662089019a,0,0,0.5225,5.6664,0.0,12,16.33,366,0,Feature,0,0,0,289,0.015532,1.0,0,0.5225,3,3,0,0.6512,3.035,3.0,40.05,13.88,0,0,0.0,0,1.2664,0,0,0,0,0,"neutron: Add agents wrappers in the neutron-base image

These scripts have been based on TripleO version of the
same feature.

Unfortunately due to the fact that Neutron/python is
stripping env vars when it's running dnsmasq/haproxy/etc
processes - we need to do the ,,config'' handling in
copy-wrappers script.
[SEP]
FILES CHANGED:
docker/neutron/neutron-dhcp-agent/extend_start.sh (+8, -0)
docker/neutron/neutron-l3-agent/extend_start.sh (+39, -0)
docker/neutron/neutron-base/neutron_sudoers (+1, -0)
docker/neutron/neutron-base/neutron-keepalived-state-change (+40, -0)
docker/neutron/neutron-base/copy-wrappers (+9, -0)
docker/neutron/neutron-base/delete-wrappers (+6, -0)
docker/neutron/neutron-base/Dockerfile.j2 (+4, -0)
docker/neutron/neutron-base/keepalived (+47, -0)
docker/neutron/neutron-base/dnsmasq (+45, -0)
docker/neutron/neutron-base/haproxy (+45, -0)
docker/neutron/neutron-base/radvd (+42, -0)
docker/neutron/neutron-l3-agent/Dockerfile.j2 (+2, -0)
",-0.215408,-2.379635,0.176497,-0.209247,-0.563548,-0.9734,0.001814,0.437345,-0.638736,-0.063649,-0.521318,-0.486871,0.062653,0.139181,0.187655
openstack/kolla-ansible,I083284285879b5c2cbc9c41615767224faad05b2,1,1,1.0,0.6931,0.0,1,13.0,301,0,Bug Fix,0,0,0,1,0.1,0.0,0,0.0,4,1,0,0.6421,0.0,4.0,33.12,16.48,1,0,0.0,0,150.5,0,26,0,12,0,"Manage mysqld db user only from db related hosts

Task of managing prometheus database user should be only executed from
machines that are hosting database as my.cnf configuration files are
not configured on non-mysqld hosts.

Closes-Bug: #2106006
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/bootstrap.yml (+1, -0)
",0.179644,-1.288265,-0.505278,0.517067,0.115223,-0.497006,0.313337,0.524764,-0.120827,-0.554553,-0.12866,-0.045586,0.226033,0.067443,-0.036465
openstack/kolla-ansible,I05b587364ad174d8944c95e54e6e6853d34ec83c,0,0,0.3889,2.7081,0.5714,3,7.0,325,0,Feature,0,0,0,18,0.002721,0.5,0,0.1944,4,1,0,0.6426,1.5567,3.0,-0.89,17.66,1,0,0.0,0,21.6667,0,0,0,0,0,"Remove notifiers from loadbalancer config

No handlers should be triggered during config. Container
will be restarted automatically when check-containers
is ran for the loadbalancer containers if config
has changed.
[SEP]
FILES CHANGED:
ansible/roles/proxysql-config/tasks/main.yml (+0, -4)
ansible/roles/haproxy-config/tasks/main.yml (+0, -4)
ansible/site.yml (+6, -0)
",1.159487,-1.858069,-0.115269,0.54198,0.235004,-0.634065,-0.116964,0.108146,-0.063146,-0.375812,-0.727069,-0.061891,-0.211982,0.570865,-0.148749
openstack/kolla-ansible,Ic7969b05bde258c38ee31fe2821aeb4e9c77a567,0,1,1.0,3.434,0.0,6,5.75,447,0,Bug Fix,0,0,0,2,0.181818,0.6429,0,0.6429,5,4,0,0.6417,2.372,3.5,4.21,16.21,1,0,0.0,1,14.4194,0,14,0,5,0,"Add support for libvirt swtpm (vTPM) configuration.

Since both nova-compute and nova-libvirt Kolla images have swtpm
packages installed [1], it is possible to configure vTPM for libvirt
instances. This patch adds support for such configuration in
kolla-ansible.

[1] https://bugs.launchpad.net/kolla/+bug/2062572

Closes-Bug: #2106219
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+4, -0)
ansible/roles/nova-cell/templates/nova.conf.d/libvirt.conf.j2 (+5, -0)
ansible/roles/nova-cell/templates/qemu.conf.j2 (+5, -0)
doc/source/reference/compute/nova-guide.rst (+10, -0)
releasenotes/notes/bug-2073159-67532593585a1e10.yaml (+5, -0)
etc/kolla/globals.yml (+1, -0)
",-1.638874,0.173165,-0.711433,0.115524,-0.063847,-0.627137,-0.303101,0.674405,-0.329859,0.519322,0.171753,0.007356,0.203767,-0.176416,-0.187222
openstack/kolla,Ie19fcb441a2e54a60762e5c8483487b713a29ddd,1,0,0.75,2.4849,0.0909,2,7.6,334,0,Bug Fix,0,0,0,8,0.034934,0.8333,0,0.625,3,2,0,0.6493,0.994,2.5,23.24,15.67,1,0,0.0,1,27.8333,0,0,0,0,0,"Fix preparation of /tftpboot for ironic-pxe

Copy aarch64 snponly.efi to /tftpboot during bootstrapping
of Centos- and Rocky-based ironic-pxe.

Don't use $KOLLA_BASE_ARCH when symlinking to
/tftpboot/ipxe.efi, because an aarch64 variant of this
binary doesn't exist, just x86_64.
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+4, -1)
releasenotes/notes/el-aarch64-ipxe-snponly-e7fc23bdc7edfe3d.yaml (+6, -0)
",-1.219374,0.110393,-0.15197,0.298483,0.361368,-0.748794,0.501145,0.700944,-0.566381,-0.014364,0.380109,-0.408267,-0.102626,0.320752,0.353381
openstack/kolla-ansible,I143e3267622b106fa65bc952d62412ffcaeeae7c,1,1,0,1.0986,0.5,1,7.5,184,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,1,1,0,0.6408,0.0,1.0,-20.74,24.33,1,0,0.0,0,61.3333,0,6,0,8,0,"Correctly append --ask-vault-password as a single argument

Closes-Bug: #2106540
[SEP]
FILES CHANGED:
kolla_ansible/ansible.py (+1, -1)
",2.681856,-0.201381,0.324114,-0.807244,-0.560732,0.175406,-0.079081,-0.130087,0.628261,-0.187465,0.333638,0.095427,0.060006,0.113827,0.403935
openstack/kolla-ansible,Ib0a557adc4b9f8349d54e6e243270e8195dd39e5,1,1,0.7778,2.4849,0.0909,2,6.6,327,0,Bug Fix,0,0,0,9,0.0375,0.4,0,0.3111,4,2,0,0.6413,0.9457,3.0,0.17,14.76,1,0,0.0,1,27.25,0,6,0,6,0,"Fix Nova and Cinder external ceph enabled check

Restore checks that nova_backend == 'rbd' and
cinder_backend_ceph before pushing libvirt secret
xmls for both services. Removed in [1].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/914997

Closes-Bug: #2106720
[SEP]
FILES CHANGED:
releasenotes/notes/fix-nova-backend-rbd-group-var-3c057daa084c0612.yaml (+7, -0)
ansible/roles/nova-cell/tasks/external_ceph.yml (+3, -1)
",-0.76084,0.920228,-1.042729,-0.312307,-0.441482,-0.365603,0.088619,0.667099,0.04431,-0.163337,0.150905,-0.665133,-0.062026,-0.16539,-0.165835
openstack/kolla-ansible,I8417545735ea02d14dc1f83e18aa75b94213f814,1,0,0.5412,2.1972,0.5,1,20.75,636,0,Doc,1,0,0,85,0.017598,0.25,0,0.1353,1,1,0,0.6418,0.0,1.0,29.82,14.57,0,1,1.0,0,70.6667,0,0,0,0,0,"[CI] Use ss instead of netstat

In case of rabbitmq container is unhealthy
let's use `ss` command instead of `netstat` as
``netstat`` is not present in distros anymore and
in containers we already have iproute2 [debian/ubuntu]
and iproute [rhel based] package installed.

[1] https://zuul.opendev.org/t/openstack/build/c70df1ecb52841579207c26cdc159327

+ echo 'rabbitmq - netstat -an'
rabbitmq - netstat -an
+ sudo docker exec rabbitmq netstat -an
OCI runtime exec failed: exec failed: unable to start container process: exec: ""netstat"": executable file not found in $PATH: unknown
[SEP]
FILES CHANGED:
tests/check-failure.sh (+4, -4)
",-2.997079,0.519587,0.837069,-0.834553,0.580967,-0.326842,0.049723,-0.107132,-0.290048,-0.182122,0.25465,-0.407572,0.1115,0.028357,-0.382541
openstack/kolla-ansible,Ifea75c2e14ffececbe271bee1549e92bded90d48,0,0,0.5465,4.0943,0.4576,3,18.56,1213,0,Bug Fix,1,0,0,86,0.017776,0.5,0,0.2733,2,3,0,0.6423,0.702,1.33,24.37,16.76,0,1,1.0,0,20.2167,0,0,0,0,0,"[CI] Fix bootstrap testing

This patch adjusts the CI in such a way that we
can finally test the correctness of bootstrap-servers.

 - It correctly installs the virtualenv at the beginning
 - It sets ansible_python_interpreter to this virtualenv
 - It runs bootstrap-servers between upgrades
 - It moves package installation from the CI playbook
   to ansible-collections-kolla

To summarize: this patch aligns behavior and tests the code
within the boundaries it should be tested in - that is, inside
a virtualenv. This naturally also tests the correctness of
ansible-collection-kolla, which installs packages and other
dependencies (now not mixed with OS py interpreter).
This is important, especially due to a bug in older versions
of Docker and requests, which required running bootstrap-servers.
Proof of this is that the rocky9-octavia job is finally working,
with no more issues with package cryptography (which was read from OS
python environment by ansible).

TL;DR: From now on, it runs correctly inside a virtualenv,
and the OS interpreter no longer interferes.

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/946983
[SEP]
FILES CHANGED:
tests/run.yml (+25, -26)
tests/templates/globals-default.j2 (+2, -1)
tests/upgrade.sh (+5, -0)
",-2.938829,-0.108353,3.292454,-0.764214,-0.467255,-0.167365,-0.384756,0.010943,-0.459425,-0.30572,-0.25863,0.508965,-0.006934,0.054218,0.042171
openstack/ansible-collection-kolla,I288a32d46d2c18594cebf8f2fc40e6bd08607659,1,1,0.5402,4.0604,0.0526,4,19.0,1097,0,Bug Fix,0,0,0,87,0.017766,0.5833,0,0.3151,3,2,0,0.4074,1.8621,2.75,25.03,16.81,0,0,0.0,1,18.9138,0,14,0,6,0,"Fix bootstrapping in kolla-ansible

The idea behind kolla-ansible is to provide the ability to
bootstrap a server in such a way that kolla can orchestrate
the servers and operate against them. Historically, this part
of the code was moved from the kolla-ansible repository to the
ansible-collection-kolla repository, which is supposed to handle
the installation of podman/docker SDK and other dependencies -
whether through system packages or through a virtual environment.

However, the problem is that our CI never showed an error because
those dependencies were installed even before the actual kolla-ansible
bootstrap took place, but in real world this was not working.

This patch fixes exactly that: the dependencies that must be installed
beforehand so that other packages can be installed via pip are now handled
by ansible-collection-kolla. This code was removed from the Zull CI playbook,
as can be seen in the ""needed-by"" section below.

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/946963
Closes-Bug: #2109509
[SEP]
FILES CHANGED:
roles/docker_sdk/tasks/install.yml (+19, -0)
roles/podman_sdk/tasks/install.yml (+19, -0)
releasenotes/notes/fix-bootstrap-b86bd73b0a05d76e.yaml (+5, -0)
roles/docker_sdk/defaults/main.yml (+11, -3)
",-3.241429,0.028194,2.538762,-0.453094,-0.517314,-0.174922,-0.077703,-0.146994,-0.372752,-0.17967,0.07653,0.431606,-0.035513,0.029728,0.267316
openstack/kayobe,Ieaa1f56de7579ff5f989b207e29de29e148086be,1,1,0.8085,3.3673,0.0714,7,6.9,1114,0,Bug Fix,0,0,0,47,0.034533,1.0,0,0.8085,4,5,0,0.9077,2.4622,3.43,24.79,12.97,1,0,0.0,1,38.4138,1,6,0,10,0,"Add the ability to override the system's default repositories

Ubuntu 24.04 is the first release where package sources for Ubuntu are
stored in a `.sources` file called
`/etc/apt/sources.list.d/ubuntu.sources`, instead of the traditional
`sources.list`.

This means that we have lost the ability to override the system's
default repositories. Previously, we could use the
`apt_disable_sources_list` setting to disable default repositories and
provide our own using `apt_repositories`. However, this is no longer
possible.

Now, each element of `apt_repositories` contains a field called `name`,
which specifies the name of the repository file (without the `.sources`
suffix). The default value of this field is `kayobe` and it may be
omitted. The user can override the default by providing a different
name, such as `ubuntu`, and new repository data. This way, the default
file, `/etc/apt/source.list.d/ubuntu.sources`, will be overwritten by
the provided repository configuration.

Closes-Bug: #2107280
[SEP]
FILES CHANGED:
etc/kayobe/apt.yml (+2, -0)
ansible/roles/apt/templates/kayobe.sources.j2 (+3, -1)
releasenotes/notes/ubuntu-sources-configure-c2aff9915db76d07.yaml (+11, -0)
ansible/inventory/group_vars/all/apt (+2, -0)
ansible/roles/apt/defaults/main.yml (+2, -0)
doc/source/configuration/reference/hosts.rst (+2, -0)
ansible/roles/apt/tasks/repos.yml (+4, -1)
",-3.066581,0.539458,2.927306,0.002911,-0.072851,0.26344,-0.106685,-0.040052,0.223388,-0.409524,-0.243466,-0.020481,-0.64928,0.221196,-0.238996
openstack/oslo.messaging,I89eb7b34b0acf64dcff52af0cd45845e4dad4639,0,0,0.9333,2.3979,0.2,2,7.6,297,0,Feature,0,0,0,15,0.06,0.7222,0,0.6741,2,2,0,0.6364,0.7219,2.0,56.64,9.36,0,0,0.0,1,27.0,0,0,0,0,0,"Remove quorum options with typo

These were deprecated during 2023.2 cycle and we even backported
the renaming to 2023.1 so that users can use the correct name. So
these are now ready for removal.

[1] 115cfb5b7cff2a9803d64d02b98250b7b0fc09f0
[SEP]
FILES CHANGED:
releasenotes/notes/remove-old-quorum-opts-with-typo-5e013064fb6df062.yaml (+8, -0)
oslo_messaging/_drivers/impl_rabbit.py (+0, -2)
",-0.69729,-1.2732,-1.216588,-0.969821,0.448099,0.101052,0.712264,-0.273965,-0.098141,0.980394,-0.405837,-0.128793,-0.089822,0.173487,0.198883
openstack/kolla,Iec5b936ae77f2d8298803fbfe50f55b2ed69f4b3,1,0,1.0,2.1972,0.5,2,2.8,158,0,Feature,0,0,0,1,0.015873,0.3158,0,0.3158,2,2,0,0.6503,0.8113,2.0,-19.59,18.26,1,0,0.0,1,17.5556,0,0,0,0,0,"Update prometheus alertmanager to newest available version

* prometheus-alertmanager: 0.28.0 -> 0.28.1
[SEP]
FILES CHANGED:
kolla/common/sources.py (+3, -3)
releasenotes/notes/update-prometheus-services-dd195876e162251c.yaml (+1, -1)
",1.098611,1.763725,-0.459139,0.551641,0.924352,0.135066,-0.024124,0.605323,-0.056576,0.648935,-0.610018,0.435864,-0.558418,0.369899,0.832723
openstack/kolla-ansible,I122821b6aaf11cbf3d8695340d23c168b3373b58,0,0,0.766,3.9703,1.0,1,9.33,232,0,Doc,0,0,0,47,0.02672,0.8333,1,0.6383,4,1,0,0.6414,0.0,4.0,49.31,12.3,0,0,0.0,0,4.3774,0,0,0,0,0,"Drop RabbitMQ SLURP docs

We don't need to handle extra version upgrades from Caracal -> Epoxy, so
these docs can be dropped.
[SEP]
FILES CHANGED:
doc/source/reference/message-queues/rabbitmq.rst (+0, -52)
",1.376222,-0.6876,-0.738388,0.068494,-0.206257,0.335491,0.216861,-0.03992,-1.183235,-0.025596,0.341364,0.386249,-0.199998,-0.306679,-0.209098
openstack/openstack-ansible-os_horizon,Iabda03cb31f184a61eb1ce3af2e4d46dc99aefb1,1,0,0.9573,0.6931,1.0,1,13.0,217,0,Feature,0,0,0,211,0.056028,1.0,0,0.9573,1,1,0,1.0,0.0,1.0,11.42,17.51,0,0,0.0,0,108.5,0,0,0,0,0,"Ensure post-install is idempotent

At the moment creating link is resetting permission for the original
file, which always trigger web-server restart on role run.
[SEP]
FILES CHANGED:
tasks/horizon_post_install.yml (+0, -1)
",1.226652,-1.320024,0.264175,0.433937,-0.321202,0.301017,0.988735,-0.569913,-0.005272,-0.450645,0.247605,0.28218,-0.269809,-0.017072,-0.175757
openstack/kayobe,I8ea60974e2ace6876514271be4156e6c889d8776,1,0,0.8125,2.3979,0.1,2,6.0,290,0,Feature,0,0,0,48,0.034557,0.0,0,0.0,4,2,0,0.9084,0.7219,3.0,-46.0,22.4,1,0,0.0,1,26.3636,0,0,0,0,0,"Use 'pip_upper_constraints_file' for openstacksdk installation

Use 'pip_upper_constraints_file' for 'openstacksdk' installation
instead of the hard-coded value in the inventory.
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/pip (+1, -1)
releasenotes/notes/fix-openstacksdk-u-c-default-ed0b85cdb9fd6042.yaml (+8, -0)
",-0.301208,0.500524,-0.729808,0.939942,1.367664,-0.379616,-0.533962,-0.013416,-0.247276,-0.581933,-0.173471,-0.475577,-0.830346,0.092503,0.274951
openstack/kolla-ansible,I34d97b16d341c8b09f169559495036e753abda71,0,1,0,2.1972,0.5,4,19.0,305,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,1,0,0.6405,2.0,4.0,18.35,18.13,1,0,0.0,0,33.8889,0,6,0,6,0,"fixed jinja2 template variable parsing

There‚Äôs a small issue in command variable: Using
{{ apache_binary }} inside another Jinja expression
({{ command }}) which won't be resolved correctly
because nested {{ }} doesn't evaluate.

Closes-Bug: #2107983
[SEP]
FILES CHANGED:
ansible/roles/placement/templates/placement-api.json.j2 (+1, -1)
ansible/roles/nova/templates/nova-api.json.j2 (+1, -1)
ansible/roles/cinder/templates/cinder-api.json.j2 (+1, -1)
ansible/roles/nova/templates/nova-metadata.json.j2 (+1, -1)
",0.492261,-1.571375,-0.059754,-0.505149,-0.398108,0.161668,-0.563775,-0.360461,-0.110618,-0.021694,-0.103698,-0.489925,0.058059,0.096156,-0.024265
openstack/kayobe,Iac4c9f98b12dccd50fd42a7d33575aadfb1f1114,1,1,0.75,1.0986,0.5,1,4.75,322,0,Bug Fix,0,0,0,4,0.00939,0.0,0,0.0,3,1,0,0.9091,0.0,3.0,17.23,12.43,1,0,0.0,0,107.3333,0,10,0,30,0,"CI: Fix ipaddr invocation in network bootstrap

The ipaddr filter has been removed from ansible.netcommon from version 8
onwards. Functionality has been moved to ansible.utils. The full name
""ansible.utils.ipaddr"" must be used for compatibility.

Related-Bug: #2107335
[SEP]
FILES CHANGED:
roles/kayobe-network-bootstrap/tasks/main.yml (+1, -1)
",0.280181,0.039889,-0.568012,0.14226,-0.655939,0.164681,0.0174,0.246316,0.133744,-0.027155,0.044093,-0.141354,-0.433996,0.177042,0.298961
openstack/sunbeam-charms,I3516374b875b6d89408a4fe05c8e73d6e29ba19d,1,0,1.0,2.5649,0.4167,2,4.8,235,0,Bug Fix,1,0,1,1,0.083333,0.0,0,0.0,6,1,0,1.0,0.65,4.0,4.56,11.92,1,0,1.0,0,18.0769,0,0,0,0,0,"Fix linting issue in testing framework

Add 503 as possible return code for Gnocchi. It's unavailable without
Ceph.
[SEP]
FILES CHANGED:
ops-sunbeam/ops_sunbeam/test_utils.py (+6, -4)
tests/local/zaza/sunbeam/charm_tests/keystone/setup.py (+1, -1)
",2.359081,-1.358748,0.362044,-0.366109,-0.806152,0.154664,0.175701,0.362466,-0.159371,-0.004221,0.19354,0.035465,-0.207249,-0.37567,0.058098
openstack/kolla,Ib7d0c879b3741ca472cd0bbf3a9a88a0fee25cac,0,0,0,2.8332,0.0625,3,8.86,525,0,Doc,0,0,0,0,0.0,0.25,0,0.0,3,3,0,0.6513,1.2988,2.33,21.82,13.22,1,0,0.0,1,30.8824,0,0,0,0,0,"Enabling support for Thales Luna user id and group id.

The new client software version requires the use of a specific group
called ""hsmusers"", and for consistency reasons, we are specifying both,
the user id and the group id, and inserting the Barbican username inside
of such a group.

More information can be found on
https://www.thalesdocs.com/gphsm/luna/7/docs/pci/Content/install/client_install/linux_install.htm
[SEP]
FILES CHANGED:
kolla/common/users.py (+4, -0)
releasenotes/notes/fix-luna-hsm-deployment-permissions-issue-dfc2d8c92d2eaf57.yaml (+10, -0)
docker/barbican/barbican-base/Dockerfile.j2 (+1, -1)
",-1.644266,0.581059,-0.266044,0.72429,-0.291584,-0.026961,0.400182,0.220934,0.248552,0.137894,-0.320741,-0.058503,-0.020703,0.002248,-0.232341
openstack/ironic,I9b55054a97256cecb9d41029f03b1dfdf69c253c,1,1,1.0,3.091,0.1905,4,23.0,196,0,Bug Fix,0,0,0,6,0.1,1.0,0,1.0,6,2,0,0.9577,1.8736,4.0,21.65,21.37,1,0,0.4286,1,8.9091,1,6,0,8,0,"Allow detach vif in available state

Allow detaching vif in available state to avoid mac
confict during node rescheduling

Closes-Bug: 2109300
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/network/test_common.py (+2, -2)
ironic/drivers/modules/network/common.py (+2, -1)
releasenotes/notes/vif-detach-in-available-acd744acde91fec9.yaml (+9, -0)
ironic/tests/unit/common/test_network.py (+4, -1)
",0.314173,-1.096617,-0.350698,-0.304625,0.490289,0.333598,-0.985388,-0.377758,-0.081531,-0.286697,-0.123094,0.085947,0.428132,-0.084269,0.091941
openstack/kolla-ansible,I57f882aaa3bc9fb707ba384887417806835edd45,1,0,0.8621,1.0986,0.5,1,5.0,420,0,Bug Fix,0,0,0,87,0.069378,0.375,0,0.3233,4,1,0,0.6397,0.0,4.0,-39.95,18.0,1,0,0.0,0,140.0,0,0,0,0,0,"Fix deprecated use of memcache_servers option

Option ""memcache_servers"" from group ""keystone_authtoken"" is deprecated.
Use option ""memcached_servers"" from group ""keystone_authtoken"".

This configuration option is deprecated since 2013 [1].

[1] https://review.opendev.org/c/openstack/python-keystoneclient/+/31612
[SEP]
FILES CHANGED:
ansible/roles/cyborg/templates/cyborg.conf.j2 (+1, -1)
",-1.279887,2.288088,-0.798393,0.929205,0.143793,-0.299623,0.145437,0.381172,0.498034,0.009798,0.270045,-0.399379,-0.515017,-0.070959,0.112572
openstack/kolla-ansible,I5cacf29d2fb9c0b473cf858f1c050bc70890cc42,1,0,0.0,3.434,0.0,1,7.4,318,0,Doc,0,0,0,1,0.009901,0.6923,1,0.0,3,1,0,0.6402,0.0,3.0,25.55,13.77,1,0,0.0,0,10.2581,0,0,0,0,0,"Add documentation for Kolla Ansible CLI command completion

This change adds instructions to the documentation on how to enable
shell command completion for the kolla-ansible CLI. It covers all
necessary steps.
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+30, -0)
",1.110701,-0.405942,-0.133746,1.046066,-0.37808,-0.002881,0.357731,0.37504,0.216575,0.020938,-0.178597,0.640056,-0.039442,-0.165807,0.163058
openstack/kolla-ansible,I1d4fc32e5963a8e8fa4a8fc7c467cadf0f26fd5f,1,0,0.75,2.7726,0.4667,1,7.71,497,0,Doc,0,0,0,48,0.026505,0.7143,1,0.5357,4,1,0,0.6406,0.0,4.0,3.17,11.97,0,0,0.0,0,31.0625,0,0,0,0,0,"Docs: update RabbitMQ HA instructions

``kolla-ansible genconfig`` includes some tasks [1] that require
containers to still be running. Move the config generation to be done
before containers are stopped.

Also make it clearer that containers should not be restarted with the
new config until after RabbitMQ state has been reset.

1. https://github.com/openstack/kolla-ansible/blob/master/ansible/roles/octavia/tasks/get_resources_info.yml#L2
[SEP]
FILES CHANGED:
doc/source/reference/message-queues/rabbitmq.rst (+8, -7)
",-1.281796,1.126894,-0.03646,0.471338,-0.620184,-0.464412,0.76031,0.208423,0.090913,0.06508,0.16451,-0.498528,-0.160175,0.045633,-0.182252
openstack/kolla,I56f86a1c5262e3ee2bcbb52cae53c3b2655ed87f,0,0,0.5207,4.8752,0.6385,21,9.0,243,0,CI,0,0,0,290,0.015348,1.0,0,0.5207,3,4,0,0.6494,3.8475,2.71,6.57,16.93,0,0,0.1077,1,1.855,0,0,0,0,0,"Remove RDO/Delorean

RDO has staffing problems and has decided to only
support SLURP releases - let's drop reliance on that
repository.
[SEP]
FILES CHANGED:
releasenotes/notes/drop-delorean-c0bd3229162faef0.yaml (+5, -0)
docker/nova/nova-base/Dockerfile.j2 (+2, -2)
docker/octavia/octavia-base/Dockerfile.j2 (+13, -3)
docker/ovn/ovn-controller/Dockerfile.j2 (+1, -1)
docker/nova/nova-libvirt/Dockerfile.j2 (+1, -1)
docker/zun/zun-cni-daemon/Dockerfile.j2 (+1, -1)
docker/ovn/ovn-northd/Dockerfile.j2 (+1, -1)
doc/source/admin/image-building.rst (+4, -11)
docker/ovn/ovn-sb-db-server/Dockerfile.j2 (+1, -1)
tests/templates/template_overrides.j2 (+1, -13)
docker/kolla-toolbox/Dockerfile.j2 (+2, -2)
doc/source/contributor/release-management.rst (+0, -17)
kolla/common/config.py (+1, -5)
docker/openstack-base/Dockerfile.j2 (+1, -1)
docker/ovn/ovn-base/Dockerfile.j2 (+1, -1)
docker/base/Dockerfile.j2 (+5, -14)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+2, -4)
docker/ovn/ovn-nb-db-server/Dockerfile.j2 (+1, -1)
docker/neutron/neutron-base/Dockerfile.j2 (+2, -2)
docker/kuryr/kuryr-libnetwork/Dockerfile.j2 (+1, -1)
docker/manila/manila-base/Dockerfile.j2 (+1, -1)
",0.936771,-1.175899,-0.3535,0.04173,-0.266181,-0.092681,-0.342011,-0.024503,-1.05834,0.007825,-0.052167,0.196173,-0.37441,-0.572504,-0.079573
openstack/ansible-collection-kolla,Ifc1b01a1acafc4064ccfad15cf2a691998209904,0,0,0.3684,3.8286,0.0,8,9.29,506,0,Feature,0,0,0,19,0.002866,0.0,0,0.0,3,3,0,0.4286,2.9211,2.88,37.32,11.1,1,0,0.0,1,11.0,0,0,0,0,0,"Move tasks from k-a role common to a-c-k

Move tasks that modified host configuration from kolla-ansible
role common to a-c-k as they need to be run only once on the
bootstrap of the host and are not strongly related to the common
services.
Some extra options like mode and changed_when were added to keep
the linter happy.

Needed-by: https://review.opendev.org/c/openstack/kolla-ansible/+/948526
[SEP]
FILES CHANGED:
roles/baremetal/templates/kolla.target.j2 (+5, -0)
roles/podman/handlers/main.yml (+5, -0)
releasenotes/notes/move-tasks-aefc996d33570bf8.yaml (+7, -0)
roles/podman/tasks/config.yml (+8, -0)
roles/podman/defaults/main.yml (+7, -0)
roles/podman/templates/kolla-directories.conf.j2 (+3, -0)
roles/baremetal/tasks/post-install.yml (+7, -0)
roles/podman/tasks/main.yml (+3, -0)
",-1.089258,0.326462,-0.115069,0.270566,-0.402411,-0.560619,0.707805,-0.047251,-0.134338,-0.100685,-0.012489,-0.011898,0.340445,0.169479,0.103593
openstack/kolla-ansible,I21c36df43425e2390b62f2d0257e99940e098734,0,0,0.35,3.7136,0.825,5,8.5,434,0,Feature,0,0,0,20,0.002997,1.0,0,0.35,4,3,0,0.6411,2.0538,3.4,27.35,12.03,1,0,0.0,1,10.5854,0,0,0,0,0,"Move tasks from k-a role common to a-c-k

Move tasks that modified host configuration from kolla-ansible
role common to a-c-k as they need to be run only once on the
boostrap of the host and are not strongly related to the common
services.

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/948525
[SEP]
FILES CHANGED:
ansible/group_vars/all/common.yml (+0, -7)
ansible/roles/common/tasks/config.yml (+0, -18)
releasenotes/notes/move-tasks-a8e65bbda50dd2a0.yaml (+7, -0)
ansible/roles/common/templates/kolla-directories.conf.j2 (+0, -3)
ansible/roles/common/templates/kolla.target.j2 (+0, -5)
",-0.849303,0.572336,-0.539224,0.276212,-0.43535,-0.852785,0.707474,0.159599,-0.076608,-0.246228,-0.255951,0.128987,0.537235,0.326602,0.075395
openstack/kolla-ansible,I9b626586621f551fb88fad71f93e0a5b1954aecf,0,1,0.7551,2.6391,0.5385,3,9.8,384,0,Bug Fix,0,0,0,49,0.026835,0.5238,0,0.3955,4,2,0,0.6403,1.4196,3.33,27.69,16.16,1,0,0.0,1,27.4286,0,6,0,4,0,"Fix duplicate names in Prometheus volumes

prometheus-alertmanager already uses the ""prometheus"" volume.
This means that the volume migration for prometheus-server fails, as
the volume is not empty. Fix this by using the name ""prometheus_server""
for the new volume.

Updated the release note to reflect this.

Closes-Bug: #2109784
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/upgrade.yml (+2, -2)
ansible/roles/prometheus/defaults/main.yml (+1, -1)
releasenotes/notes/upgrade-prometheus-to-v3-bdf73866e7a93194.yaml (+3, -4)
",-0.299438,-1.315892,-0.60445,0.185995,-0.353199,-0.006502,-0.240806,-0.050513,0.194554,-0.110844,0.199056,-0.05439,-0.063529,0.460912,0.080579
openstack/sunbeam-charms,I42699ec591143fc11d68ce3b903edb9a436e18d7,1,1,1.0,2.1972,0.0,1,6.6,316,0,Bug Fix,0,0,0,2,0.083333,0.0,0,0.0,3,1,0,1.0,0.0,3.0,2.74,15.97,1,0,0.0,0,35.1111,0,6,0,1,0,"cinder-k8s: add block-storage endpoint type

Add block-storage type endpoint as it is the expected endpoint for
VolumeV3. Keep VolumeV3 as an alias for backward compatibility.

Closes-Bug: #2109790
[SEP]
FILES CHANGED:
charms/cinder-k8s/src/charm.py (+8, -0)
",0.707962,-0.437702,-0.759043,0.047057,-0.084619,-0.106573,-0.286622,0.449307,0.180547,-0.291169,-0.019535,0.22081,0.246562,-0.220218,0.139871
openstack/kolla-ansible,I21e0f704ad1ff9bec28af397c7b099e991de7ce2,1,0,0.6875,2.8904,1.0,1,14.0,212,0,Doc,0,0,0,16,0.066667,0.7143,1,0.4911,3,1,0,0.6394,0.0,3.0,32.49,14.17,0,0,0.0,0,11.7778,0,0,0,0,0,"doc: remove keystone admin port cleanup

The removal was done in Zed, which is unmaintained now, this step is no
longer needed for any maintained deployment.
[SEP]
FILES CHANGED:
doc/source/user/operating-kolla.rst (+0, -17)
",2.020613,-1.645769,0.378397,0.151719,-0.731261,0.682098,0.596016,-0.502273,-0.302768,-0.268779,0.207543,0.81527,-0.657757,-0.060466,0.096922
openstack/kolla,I42dd2490d14070074fe1fa7ae9e0a4cbf095b06f,0,0,0.8636,1.3863,0.3333,1,7.2,614,0,Bug Fix,0,0,0,88,0.070064,0.375,0,0.3239,3,1,0,0.6476,0.0,3.0,42.08,9.55,1,0,0.0,0,153.5,0,0,0,0,0,"bifrost: fix creation of python3 lib symlink

When {{ venv_path }}/lib/python3 already exist and we run the ln
command, we end up with:

    /var/lib/kolla/venv/lib/
    ‚îú‚îÄ‚îÄ python3 -> python3.9
    ‚îú‚îÄ‚îÄ python3.12
    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ site-packages
    ‚îî‚îÄ‚îÄ python3.9
        ‚îú‚îÄ‚îÄ python3.12 -> python3.12
        ‚îî‚îÄ‚îÄ site-packages

Instead, it should be:

    /var/lib/kolla/venv/lib/
    ‚îú‚îÄ‚îÄ python3 -> python3.12
    ‚îú‚îÄ‚îÄ python3.12
    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ site-packages
    ‚îî‚îÄ‚îÄ python3.9
        ‚îî‚îÄ‚îÄ site-packages

Remove the existing link first to ensure it is created properly.
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+2, -1)
",-3.406488,0.263708,2.367112,-0.611532,0.664029,-0.112781,-0.582133,0.252226,-0.750656,0.405714,-0.174527,-0.308157,0.182106,0.555709,-0.093579
openstack/sunbeam-charms,I19f76b6e7ad0edbe6e11514f3524ab3cf11b9797,1,1,1.0,3.2189,0.6667,2,9.2,379,0,Bug Fix,0,0,0,14,0.026465,1.0,0,1.0,4,1,0,1.0,0.9183,3.5,17.26,14.11,1,0,0.6667,0,15.16,1,6,0,6,0,"Remove volumev2 from the catalogue

https://docs.openstack.org/api-ref/block-storage/v2/
> Version 2 of the Block Storage API was deprecated in the Pike release
> and was removed during the Xena development cycle.

And Sunbeam deployment actually returns 404 for requests to the v2
endpoint accordingly.

Closes-Bug: #2109846
[SEP]
FILES CHANGED:
charms/keystone-k8s/tests/unit/test_keystone_charm.py (+8, -8)
charms/cinder-k8s/src/charm.py (+0, -8)
",0.202084,-0.076752,-0.396013,-0.086476,-1.183721,0.087853,0.288269,0.844143,0.364456,0.01411,-0.292686,0.127693,-0.309113,0.104013,0.073124
openstack/networking-generic-switch,I56aa22602a41f959255abd69337da13ab89df00d,1,0,0.875,4.2767,0.2113,3,6.86,470,0,Feature,0,0,0,8,0.018391,0.0,0,0.0,3,2,0,1.0,1.1769,2.0,-6.34,17.74,1,0,0.6761,1,6.5278,1,0,0,0,0,"Parse switch config in directories as well as files

Currently only --config-file arguments are considered when parsing
genericswitch groups, and any --config-dir arguments are ignored. Some
deployment tools only use --config-dir. This change discovers config
files in directories in a similar manner to oslo_config[1].

[1] https://opendev.org/openstack/oslo.config/src/branch/master/oslo_config/cfg.py#L3170-L3172
[SEP]
FILES CHANGED:
releasenotes/notes/config-dir-d5f59b536c110841.yaml (+6, -0)
networking_generic_switch/config.py (+16, -1)
networking_generic_switch/tests/unit/test_config.py (+34, -14)
",-1.892083,1.520635,-0.159871,0.812844,-0.031246,-0.660592,0.294305,0.406774,0.252025,0.380312,0.010594,-0.414657,0.100775,-0.101787,-0.301003
openstack/kolla,Ic75fdaedfa62816fae0cc0b7924425b574feb1ee,0,0,0.5189,2.3979,0.5,1,7.0,83,0,Bug Fix,1,0,0,291,0.015296,0.6667,0,0.3459,2,1,0,0.6457,0.0,2.0,6.36,19.94,0,0,1.0,0,7.5455,0,0,0,0,0,"CI: Fix pip mirror multiline
[SEP]
FILES CHANGED:
tests/vars/zuul.yml (+5, -5)
",3.332784,0.977503,1.365884,-0.159355,0.872381,0.155715,-0.212927,-0.067528,-0.211366,0.164449,0.464852,-0.456821,0.579498,-0.251188,0.197301
openstack/sunbeam-charms,I28f58095160c87fd4ec656443aa1f55547dd5561,1,0,1.0,2.6391,0.0,1,9.2,355,0,Feature,0,0,0,3,0.09375,0.0,0,0.0,2,1,0,1.0,0.0,2.0,33.81,11.51,1,0,0.0,0,25.3571,0,0,0,0,0,"ops-sunbeam: remove entry on SecretNotFoundError

When the secret stored in the local store is not found on the juju
controller, the unit should remove the entry for its store. This ensures
on new relation, a new secret can be created.
[SEP]
FILES CHANGED:
ops-sunbeam/ops_sunbeam/relation_handlers.py (+13, -0)
",0.830679,-1.867781,-0.021673,0.478192,-0.443919,-0.046693,0.589221,-0.188408,0.43023,-0.369526,-0.228038,0.551199,-0.445039,0.462872,-0.530962
openstack/sunbeam-charms,I1f14ae77a3bc043b3a194ca9308a22f1e66c7907,1,0,1.0,5.4553,0.0215,6,19.86,1005,0,CI,0,0,0,1,0.007634,0.0,0,0.0,4,3,0,1.0,1.6324,3.5,23.57,14.27,1,0,0.5536,1,4.2949,0,0,0,0,0,"Add config option to disable cinder tests

This commit adds a user config option ""roles"" that allows the user
to skip certain tests that do not pertain to the Sunbeam node roles.
For instance, if there is no storage role defined, the cinder tests
will be skipped by Tempest rather than appearing as failed tests.

Summary of changes:
charmcraft.yaml
  - add user config option ""roles"" (default: storage,compute,control)
charm.py
  - append user-set config roles to Tempest configuration overrides
  - trigger a charm rebuild on config change
  - add check that only rebuilds charm if there is a config change,
    avoiding a costly rebuild when it is not necessary
tempest-run-wrapper.j2
  - set discover-tempest-config to consume TEMPEST_CONFIG_OVERRIDES
tempest-init-j2
  - set discover-tempest-config to consume TEMPEST_CONFIG_OVERRIDES
test_tempest_charm.py
  - add unit tests for various role configurations
  - add unit test for hash comparison
[SEP]
FILES CHANGED:
charms/tempest-k8s/src/charm.py (+25, -1)
charms/tempest-k8s/src/utils/overrides.py (+66, -0)
charms/tempest-k8s/charmcraft.yaml (+7, -0)
charms/tempest-k8s/src/templates/tempest-init.j2 (+1, -1)
charms/tempest-k8s/src/templates/tempest-run-wrapper.j2 (+1, -2)
charms/tempest-k8s/tests/unit/test_tempest_charm.py (+128, -1)
",-3.364447,0.265932,2.841802,-0.170218,0.533251,-0.276763,-0.42879,-0.097623,-0.057574,-0.357326,-0.059676,-0.134272,0.178128,0.138466,-0.012348
openstack/sunbeam-charms,I99469b1782c7012b269c096bc568ba8063004aea,1,1,1.0,3.2581,0.08,3,6.8,324,0,Bug Fix,0,0,0,4,0.088889,1.0,0,1.0,4,1,0,1.0,1.569,3.67,8.34,15.66,1,0,0.28,0,12.4615,0,36,0,7,0,"tempest-k8s: disable cold-migration tests

Cold-migration is not supported in Sunbeam, related tests should not be
run.
Resize is based on cold-migration, hence, it is also disabled.

Related-Bug: #2082056
[SEP]
FILES CHANGED:
charms/tempest-k8s/src/charm.py (+7, -1)
charms/tempest-k8s/src/utils/overrides.py (+10, -0)
charms/tempest-k8s/tests/unit/test_tempest_charm.py (+6, -1)
",0.272881,-0.328257,-0.855223,0.321238,-0.463157,-0.137449,-0.113805,-0.181227,-0.269691,-0.052411,0.324214,0.211496,0.348773,0.013078,-0.009083
openstack/kolla,If301b9ebd7d0dc38bea4d60467e8e80a7a49825d,1,1,0.5171,3.434,0.5,5,4.75,172,0,Bug Fix,0,0,0,292,0.01534,0.8333,0,0.4309,2,3,0,0.6439,2.1736,1.4,28.36,12.43,0,0,0.6667,1,5.5484,0,6,0,11,0,"mariadb: pin to 10.11.11

Temporarily disable upgrade jobs to get epoxy rc1
branched this week.

Closes-Bug: #2110122
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+2, -2)
docker/base/mariadb.repo (+1, -1)
.zuul.d/ubuntu.yaml (+4, -4)
kolla/template/repos.yaml (+4, -4)
.zuul.d/rocky.yaml (+4, -4)
",1.24202,-1.587105,-0.330735,-1.489483,-0.636221,0.084743,-0.827777,0.297334,-0.493935,0.383882,-0.005439,0.067145,-0.309925,0.276514,0.203699
openstack/kolla,If2b9aff8f1900fb98e038972e775c3eddaad373f,1,0,0.0,1.0986,1.0,1,7.4,354,0,Bug Fix,0,0,0,2,0.007968,0.0,0,0.0,3,1,0,0.6449,0.0,3.0,-6.46,15.93,1,0,0.0,0,118.0,0,0,0,0,0,"Remove temporary fix for skyline-apiserver.

skyline-apiserver's Dockerfile has a comment around removing a line when
I2dababab7c79e7c37983c1702178419c88e014a5 merges. Given the
referenced change has now merged, remove the TODO and the temporary
fix.
[SEP]
FILES CHANGED:
docker/skyline/skyline-apiserver/Dockerfile.j2 (+0, -2)
",-0.21608,-0.885486,-1.579195,-0.873645,0.766089,-0.146137,0.713051,-0.099266,0.221075,-0.022709,-0.297278,0.206866,-0.240702,0.06005,0.167146
openstack/sushy,I11696bc158b89fda23ce328c7f34773b093b0575,1,0,1.0,3.7377,0.0976,3,10.6,422,0,CI,0,0,0,3,0.010381,0.0,0,0.0,5,2,0,1.0,1.4538,3.33,46.03,11.79,1,0,0.4146,1,10.0476,0,0,0,0,0,"Skipping UsbCd workaround on Supermicro ARS-111GL-NHR

Most SuperMicro machines (e.g. X11 and X12 models) use ""UsbCd"" device
string for CD based virtual media however it seems that certain models
such as ARS-111GL-NHR require more common ""Cd"" instead.

This change adds conditional logic which prevents applying ""UsbCd"" on
SuperMicro ARS-111GL-NHR model specifically.
[SEP]
FILES CHANGED:
sushy/resources/system/system.py (+14, -4)
sushy/tests/unit/resources/system/test_system.py (+17, -0)
releasenotes/notes/supermicro-vmedia-dev-workaround-cc7a870c9a99d92b.yaml (+6, -0)
",-1.843476,0.282353,-0.365985,0.492599,0.810986,-0.016001,-0.445824,0.542198,-0.550003,0.285509,0.463706,0.103343,0.741966,-0.303717,-0.014815
openstack/octavia,I82c95327810c708068896203cf49805614673ab8,1,0,0,2.1972,0.125,2,8.0,92,0,Bug Fix,0,0,0,0,0.0,0.7778,0,0.0,5,2,0,0.6096,0.9544,3.5,50.67,13.2,0,0,0.0,1,10.2222,0,0,0,0,0,"Fix pep8 tests for translated message
[SEP]
FILES CHANGED:
octavia/controller/worker/v2/tasks/network_tasks.py (+2, -1)
releasenotes/notes/fix-error-message-translation-in-HandleNetworkDelta-1f99354ee7a41c01.yaml (+5, -0)
",2.96801,0.921598,1.756616,-0.023345,0.869839,0.216572,0.392217,0.237907,0.238511,0.362742,0.039534,-0.325931,-0.129018,-0.355449,0.368481
openstack/kolla,Ida32d4fc0b182ef24a694ed08c7f032976eedcd5,0,0,0.5188,3.0445,0.5,3,9.0,90,0,CI,1,0,0,293,0.015368,0.8462,0,0.439,1,1,0,0.6459,1.5219,1.0,28.5,12.49,0,0,1.0,0,4.2857,0,0,0,0,0,"CI: Set upgrade jobs back to voting
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+2, -2)
.zuul.d/ubuntu.yaml (+4, -4)
.zuul.d/rocky.yaml (+4, -4)
",3.209447,1.062567,1.749099,0.728475,0.638699,1.113432,0.074004,-0.42433,0.038158,0.715374,0.036906,-0.285048,0.358314,0.172697,-0.016745
openstack/ansible-collection-kolla,I358e022e1235be03997eb24bab166ca93d79d1a8,0,0,0.2069,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,29,0.214815,1.0,1,0.2069,2,1,0,0.4138,0.5917,2.0,36.57,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2025.1

Add file to the reno documentation build to show release notes for
stable/2025.1.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.1.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/index.rst (+1, -0)
releasenotes/source/2025.1.rst (+6, -0)
",-0.162587,-0.865866,-0.154865,0.164781,-0.056731,-0.234699,-0.347055,0.563249,0.092233,0.818468,-0.720503,-0.049224,-0.159691,0.855043,0.332572
openstack/kolla-ansible,Iafe2077930d425e5200a3693024ce2f4a7c0afcb,0,0,0.2,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,30,0.211268,0.5,1,0.1,2,1,0,0.6399,0.5917,2.0,38.59,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2025.1

Add file to the reno documentation build to show release notes for
stable/2025.1.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.1.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/index.rst (+1, -0)
releasenotes/source/2025.1.rst (+6, -0)
",-0.162587,-0.865866,-0.154865,0.164781,-0.056731,-0.234699,-0.347055,0.563249,0.092233,0.818468,-0.720503,-0.049224,-0.159691,0.855043,0.332572
openstack/kolla,I4842c6c95633743dc949e3d19d6c5e295c89af33,0,0,0.1935,2.0794,0.0,2,7.0,330,0,Doc,0,0,0,31,0.208054,0.3333,1,0.0645,2,1,0,0.6441,0.5917,2.0,44.63,8.51,1,0,0.0,0,41.25,0,0,0,0,0,"Update master for stable/2025.1

Add file to the reno documentation build to show release notes for
stable/2025.1.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.1.

Sem-Ver: feature
[SEP]
FILES CHANGED:
releasenotes/source/index.rst (+1, -0)
releasenotes/source/2025.1.rst (+6, -0)
",-0.162587,-0.865866,-0.154865,0.164781,-0.056731,-0.234699,-0.347055,0.563249,0.092233,0.818468,-0.720503,-0.049224,-0.159691,0.855043,0.332572
openstack/kolla-ansible,I25cd0beee8f6006219d21dfcdeabe994dc19dfbb,0,0,0.517,2.3979,1.0,1,5.0,105,0,CI,1,0,0,294,0.015405,0.5938,0,0.307,1,1,0,0.639,0.0,1.0,49.48,10.0,0,0,1.0,1,9.5455,0,0,0,0,0,"CI: Disable slurp jobs for 2025.2 (current master)
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -10)
",2.43596,0.650795,0.780457,-0.217675,-0.089056,0.5532,-0.160062,0.71177,-0.252862,0.792349,-0.17853,0.100541,0.190933,0.406089,-0.543201
openstack/kolla,I4507fb60d361ea504459a4b502d6f6c42a327064,0,0,0.8333,4.1109,0.4667,5,3.0,188,0,Feature,0,0,0,6,0.046512,0.5938,0,0.4948,3,4,0,0.6423,1.7484,2.2,-71.16,21.2,0,0,0.0,1,3.082,0,0,0,0,0,"Update OpenSearch and OpenSearch Dashboards to version 3.x

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/949478
[SEP]
FILES CHANGED:
releasenotes/notes/opensearch-upgrade-9e263a65f015a376.yaml (+4, -0)
doc/source/contributor/versions.rst (+1, -1)
docker/base/Dockerfile.j2 (+3, -3)
kolla/template/repos.yaml (+16, -16)
docker/base/opensearch.repo (+8, -8)
",0.128365,2.873727,-1.467758,-0.250901,-1.169334,0.115945,-0.077662,0.264118,-0.1286,-0.470919,-0.920195,0.285293,-0.118085,-0.389078,0.016361
openstack/kolla-ansible,Ic6d156a36d7ac9b44118eed6acbf48eb49f979ec,1,0,0.5153,1.3863,0.3333,1,17.0,166,0,CI,1,0,0,295,0.015449,0.6,0,0.3092,1,1,0,0.6382,0.0,1.0,-29.38,23.27,0,0,1.0,0,41.5,0,0,0,0,0,"CI: Use venv ansible_python_interpreter in octavia scenario

cryptography is not installed in global python env
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+2, -1)
",1.572519,-0.908605,-0.238497,-0.143556,0.478591,-0.493822,-0.090659,0.118236,-0.520575,-0.618274,0.55244,-0.126353,-0.815122,-0.405645,-0.002285
openstack/kolla-ansible,I1f47d285cd6c17d1c92fbe4e6981420322ceee2b,0,0,0.7143,1.6094,0.5,1,8.0,173,0,Feature,0,0,0,7,0.037037,0.0,0,0.0,4,1,0,0.6387,0.0,4.0,-23.36,20.7,0,0,0.0,0,34.6,0,0,0,0,0,"opensearch: Switch to recover_after_data_nodes and expected_data_nodes

This is required for OpenSearch upgrade to 3.x
[SEP]
FILES CHANGED:
ansible/roles/opensearch/templates/opensearch.yml.j2 (+2, -2)
",1.010809,0.307745,-1.068922,0.590669,0.604988,0.623766,-0.402426,-0.308246,-0.203334,-0.061526,0.311696,-0.039437,-0.87197,-0.268288,-0.050431
openstack/kolla-ansible,I3bebfb0946477458fcd84831d2aa661215e48844,1,1,0,2.0794,0.1429,2,11.0,119,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,4,2,0,0.6378,0.8631,3.0,26.47,18.95,1,0,0.0,1,14.875,0,10,0,15,0,"Fix handler invocation in the ovs-dpdk role

Closes-Bug: #2088197
[SEP]
FILES CHANGED:
ansible/roles/ovs-dpdk/handlers/main.yml (+1, -1)
releasenotes/notes/bug-2088197-abbdf6178c926eda.yaml (+5, -0)
",2.609705,0.295959,0.109443,-1.138621,-0.544012,0.351501,-0.329767,0.471399,0.365876,-0.616994,0.336089,0.057589,-0.199083,-0.198417,0.716565
openstack/ironic,I5a84907e65ec1282805fa04f0dff75a848e1b09c,1,1,1.0,4.6634,0.0762,5,11.33,307,0,Bug Fix,0,0,0,6,0.004584,1.0,0,1.0,5,2,0,0.958,1.7448,3.4,-1.24,18.65,0,0,0.6,1,2.8962,0,6,0,11,0,"Fix IPA external inspection callback url override

When an `external_callback_url` is configured, we were overriding
only the base IPA API URL and not the inspection callback.

Closes-Bug: #2101173
[SEP]
FILES CHANGED:
ironic/drivers/modules/inspector/agent.py (+2, -6)
releasenotes/notes/use-external-url-in-inspection-callback-79de3338709807ad.yaml (+8, -0)
ironic/tests/unit/drivers/modules/test_image_utils.py (+63, -0)
ironic/drivers/modules/inspect_utils.py (+10, -0)
ironic/drivers/modules/image_utils.py (+14, -2)
",0.159793,-0.945714,-0.623607,0.275945,0.018517,0.558564,-1.119208,-0.115549,0.451876,-0.281991,-0.184363,-0.165591,-0.060456,0.034364,0.094186
openstack/kayobe,Ie4414733ac915faeb9fd10b02f46693651c0d706,1,1,0.8163,2.0794,0.1429,2,5.0,206,0,Bug Fix,0,0,0,49,0.035025,1.0,0,0.8163,4,2,0,0.9098,0.8631,3.0,-40.76,23.33,1,0,0.0,1,25.75,0,6,0,10,0,"Fix ipa_kernel_options_default when ipa_collect_lldp is false

TrivialFix

Closes-Bug: #2110505
[SEP]
FILES CHANGED:
releasenotes/notes/fix-ipa-kernel-options-default-a036666288778fa6.yaml (+5, -0)
ansible/inventory/group_vars/all/ipa (+1, -1)
",0.017343,-0.757486,-1.076078,-1.041613,0.4683,0.238399,-2.065556,-0.004943,0.221649,-0.432472,0.446357,-0.541392,-0.723687,-0.441049,0.284499
openstack/octavia-lib,I42e14233eb040412774db61f211603f7b6528341,1,1,0.5,3.7842,0.0,3,11.5,319,0,Bug Fix,0,0,0,122,0.004256,1.0,0,0.5,5,2,0,0.1429,1.3385,3.33,57.23,14.17,0,0,0.2558,1,7.25,0,10,0,9,0,"Add a ""Conflict"" exception

Provider drivers may need to raise a ""Conflict"" exception. For example
when the requested VIP address is already in use as is the case in the
related bug.
This patch adds this exception for provider drivers to use.

Partial-Bug: #2052682
[SEP]
FILES CHANGED:
releasenotes/notes/Add-Conflict-exception-67bca85f9d660a36.yaml (+6, -0)
octavia_lib/tests/unit/api/drivers/test_exceptions.py (+11, -0)
octavia_lib/api/drivers/exceptions.py (+26, -0)
",0.172001,-1.01348,-0.343909,0.353478,-0.578383,0.689047,-0.05984,-0.155718,0.942749,0.409112,0.133659,0.250945,0.033212,0.052992,0.295201
openstack/python-ironicclient,If28bda0a11f3e4a0d02a6a52040e8ca65611822f,1,0,1.0,3.8286,0.2222,10,6.2,265,0,Feature,0,0,0,6,0.012121,1.0,0,1.0,5,1,0,1.0,2.452,3.2,6.78,14.09,0,0,0.1333,0,5.7609,0,0,0,0,0,"Stop using deprecated format_* from osc_utils

Added our own formatter which replaces the deprecated/removed one.
It's contents are essentially format_dict from osc-lib 3.2.0 stuffed
into a cliff column object.
[SEP]
FILES CHANGED:
ironicclient/osc/v1/baremetal_volume_target.py (+1, -1)
ironicclient/osc/v1/baremetal_chassis.py (+1, -1)
ironicclient/tests/unit/v1/test_node.py (+1, -1)
ironicclient/osc/v1/baremetal_port.py (+1, -1)
ironicclient/osc/v1/baremetal_portgroup.py (+1, -1)
ironicclient/tests/unit/osc/v1/test_baremetal_port.py (+2, -2)
ironicclient/osc/v1/baremetal_conductor.py (+2, -1)
ironicclient/common/utils.py (+24, -0)
ironicclient/osc/v1/baremetal_volume_connector.py (+1, -1)
ironicclient/osc/v1/baremetal_node.py (+1, -1)
",1.190231,-1.311938,-0.267725,-0.19533,-0.55866,0.082994,-0.086238,-0.222475,-0.456515,-0.23107,-0.367256,-0.030047,-0.748619,0.252483,0.223039
openstack/octavia,Iba4aa247a85cc13adf1a53635b4e1adfe35ff585,1,1,0.5041,2.3026,0.0,3,13.0,206,0,Bug Fix,0,0,0,123,0.004284,0.5,0,0.252,2,2,0,0.6106,1.3516,1.67,21.19,14.43,0,0,0.0,1,20.6,0,6,0,6,0,"Fix SSH disable during amphora image build

This patch fixes the ability to disable SSH inside the amphora during
the image build.

Closes-Bug: #2110186
[SEP]
FILES CHANGED:
elements/amphora-agent/package-installs.yaml (+1, -0)
diskimage-create/diskimage-create.sh (+3, -0)
releasenotes/notes/Fix-disable-sshd-470ba6a09278df69.yaml (+5, -0)
",0.603486,-0.897688,-0.49722,0.01553,-0.221462,0.624007,-0.660741,0.177503,0.05843,-0.265637,0.33031,0.368409,0.263539,-0.087716,0.216706
openstack/kolla,Icde03cb349f53c0166bdfc9952b5bdf30d41fb14,0,0,0.625,3.091,0.4286,5,2.75,174,0,Feature,0,0,0,8,0.041451,0.5758,0,0.3598,3,4,0,0.6404,2.1659,2.2,77.14,4.74,0,0,0.0,1,7.9091,0,0,0,0,0,"Bump proxysql to 3.0.x

This patch bump proxysql 2.7.x to 3.0.x
In this version, the MySQL module is considered stable.
[SEP]
FILES CHANGED:
docker/base/proxysql.repo (+2, -2)
doc/source/contributor/versions.rst (+2, -2)
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+4, -4)
releasenotes/notes/bump_proxysql-version-68131c03369a987b.yaml (+3, -0)
",-0.088372,0.973503,-0.684989,0.972934,0.407339,0.588673,0.104964,0.239817,-0.618959,1.322279,0.196694,0.502401,-0.809151,0.236928,0.383952
openstack/openstack-ansible-lxc_hosts,I3de2c45fc1b24424ccbb8035cc7e7603dc5d0976,1,0,0.9575,3.2958,0.0,2,5.56,427,0,Bug Fix,0,0,0,212,0.056278,0.0,0,0.0,2,2,0,1.0,0.9612,1.5,25.23,15.02,0,0,0.0,1,15.8148,0,0,0,0,0,"Patch the usr.bin.lxc-copy apparmor profile

Due to the bug in liblxc-common packaging [1], there is a conflict in
apparmor profiles which prevents any management of existing
profiles. In order to allow apparmor configuration we need to
bushfix the usr.bin.lxc-copy profile until fixed one won't be released.

[1] https://bugs.launchpad.net/ubuntu/+source/lxc/+bug/2110635
[SEP]
FILES CHANGED:
tasks/lxc_install_apt.yml (+16, -0)
releasenotes/notes/lxc_apparmor_issue-e25bbc97e7f2ba62.yaml (+10, -0)
",-1.480338,1.139594,-0.433982,0.588364,-0.197218,-0.51559,0.657417,-0.023173,-0.129448,0.43831,0.376586,-0.057294,0.122826,-0.235972,0.022862
openstack/openstack-ansible-os_neutron,I080734c6c46b235aadf0aed69b50b8d388ce9d5d,1,0,0.9577,2.4849,0.0909,2,19.33,417,0,Feature,0,0,0,213,0.056156,0.0,0,0.0,2,2,0,0.9167,0.8454,1.5,35.52,18.77,0,0,0.0,1,34.75,0,0,0,0,0,"Respect aa-disable exit code when disabling profiles

At the moment, in case aa-disable exits with RC1 due to some
issue, resulting shell script still will exit normally with RC0.

Due to this behyavior OVS scenario on Ubuntu Noble was failing
unobviously with neutron-dhcp-agent being unable to startup
dnsmasq due to apparmor profile remained in enforced mode.
[SEP]
FILES CHANGED:
releasenotes/notes/aa_disable_respect_code-f15967693989df79.yaml (+8, -0)
tasks/neutron_apparmor.yml (+2, -1)
",-0.742956,-2.176991,-0.091607,0.184052,-0.371001,-0.241652,0.15489,-0.024798,-0.037476,0.119288,0.35139,0.11038,0.211104,-0.07301,0.239077
openstack/openstack-ansible-os_neutron,I7fa87a6a7f24c45ae87f2cbafbf471ecf2843744,1,0,0.9579,1.0986,0.5,1,10.8,491,0,Bug Fix,0,0,0,214,0.056257,1.0,0,0.9579,2,1,0,0.92,0.0,2.0,-9.36,13.21,0,0,0.0,1,163.6667,0,0,0,0,0,"Update uwsgi re-disable reno to contain bug ID

Current release note causes job failure, as link naming should be
unique within the renderred notes. While it's not violating the rule
in os_neutron repo, it does make integrated repo reno unhappy
and causes automatic updates of the note like in [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible/+/949143/1/releasenotes/notes/neutron_uwsgi_re_disable-45f28da6a4e29e54.yaml
[SEP]
FILES CHANGED:
releasenotes/notes/neutron_uwsgi_re_disable-45f28da6a4e29e54.yaml (+1, -1)
",-1.836686,0.815494,-0.243283,-0.182574,-0.245993,-0.525122,0.75488,0.221924,0.213125,-0.062653,0.272156,-0.230045,-0.29421,-0.243528,-0.263622
openstack/kolla,I1ba004df309667460aa152928f789aaf6be6051f,1,0,0.5169,2.0794,0.1429,2,6.0,80,0,Feature,0,0,0,296,0.015499,0.4889,0,0.2527,2,2,0,0.6387,0.8631,2.0,-38.95,29.07,1,0,0.0,1,10.0,0,0,0,0,0,"debian: Use Epoxy extrepo
[SEP]
FILES CHANGED:
releasenotes/notes/debian-epoxy-f68eb3e911f5fea3.yaml (+5, -0)
docker/base/Dockerfile.j2 (+1, -1)
",3.534531,0.862797,1.285514,-0.317906,0.339027,0.054364,0.437196,0.698435,-0.90757,-0.459382,0.405864,-0.503038,-0.03851,0.041322,-0.669978
openstack/kolla,I28f474015ffd000a3c2cf4c461c3c2f2b8959b0b,0,0,0.5185,1.0986,0.5,1,9.5,204,0,Feature,0,1,0,297,0.015546,0.3125,0,0.162,2,1,0,0.6397,0.0,2.0,27.99,14.33,1,0,0.0,0,68.0,0,0,0,0,0,"Revert ""[release] Use RDO's Epoxy packages""

This reverts commit 64f171ccfa02bfeb9c92a641e186bd987f0099ae.

Reason for revert: Let's switch to master
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",0.695434,-0.138127,-1.80439,-1.61907,0.658727,0.950687,0.584013,-0.365696,0.046362,-0.137306,0.239567,0.503531,-0.439467,-0.104967,-0.596413
openstack/kolla,If888500a791c66a592f17aa2be1f3784ee009a91,0,0,0.5168,1.0986,0.5,1,4.0,321,0,Feature,0,1,0,298,0.015596,0.303,0,0.1566,2,1,0,0.6379,0.0,2.0,-36.92,14.93,1,0,0.0,0,107.0,0,0,0,0,0,"Revert ""Switch to 2025.1 sources""

This reverts commit 0733a13d7be896dac4004212f9eef48a845b26c2.

Reason for revert: switch back to master

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/956785
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",-0.382099,1.403223,-1.765003,-1.230428,-0.3501,0.336376,1.209276,-0.028958,0.2957,-0.09534,0.060918,-0.060385,-0.037038,0.124451,-0.127321
openstack/kolla-ansible,I9b0d67ba443a680f0eaa4f2ad5bb7137faf396de,1,1,0.619,1.0986,0.5,1,12.5,245,0,Bug Fix,0,0,0,21,0.009502,1.0,0,0.619,1,1,0,0.6383,0.0,1.0,8.03,17.8,0,0,0.0,0,81.6667,0,6,0,10,0,"Fix unconditional use of become in post-deploy

This must have snuck in after we landed the linked related change.

Related-ID: Ied5ef4e1e3c9346342962d44de26702522b06b86
Related-Bug: #2098887
[SEP]
FILES CHANGED:
ansible/post-deploy.yml (+1, -1)
",0.314327,-0.258747,-1.731949,-1.66274,0.54833,0.749303,0.556366,-0.563466,0.342241,-0.205414,-0.13845,0.254798,0.235779,0.058429,0.224988
openstack/ansible-collection-kolla,Ib361383bc320182e4d1ca0aa4fd4d5017215ea58,1,0,0.5455,4.4543,0.3294,6,7.08,785,0,Doc,0,0,0,88,0.017763,0.6154,0,0.3357,3,1,0,0.4,2.0375,3.0,4.7,16.74,1,0,0.0,0,9.1279,0,0,0,0,0,"Improve virtualenv handling and pip installation for SDK roles

Ensure consistent and automatic creation of virtual environments
when defined. Replaced manual `packaging` installation with pip
module usage for better idempotency.
Improved pip binary detection by deriving it from the Python
executable, avoiding hardcoded 'pip3' which can point to diferrent
pip version (pip3.9 instead of pip3.12 for example).

Changes affect both docker_sdk and podman_sdk roles:
- Automatically install both `pip` and `packaging` in the virtualenv.
- Use ansible_facts.python.executable to build pip path dynamically.

This improves compatibility and reduces complexity.

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/949812
[SEP]
FILES CHANGED:
roles/docker_sdk/tasks/install.yml (+25, -7)
roles/docker_sdk/tasks/uninstall.yml (+2, -2)
roles/podman_sdk/tasks/install.yml (+25, -7)
roles/podman_sdk/tasks/uninstall.yml (+2, -2)
roles/docker_sdk/defaults/main.yml (+1, -4)
roles/podman_sdk/defaults/main.yml (+2, -6)
",-2.355268,0.155901,1.407348,-0.292848,-0.026939,-0.496741,0.192264,0.526417,-0.121545,-0.333936,-0.118328,-0.173749,0.044255,-0.19361,-0.161531
openstack/kolla-ansible,I7dc6cf8eda3b1fd48d2000f18b4670a4ef4ce1b4,1,0,0.5506,3.7377,0.0732,4,12.25,1347,0,CI,0,0,0,89,0.017662,0.6667,0,0.367,2,4,0,0.6388,1.7975,1.75,-22.57,18.51,1,0,0.0732,1,32.0714,0,0,0,0,0,"Standardize Python interpreter handling

This patch ensures that the system Python interpreter is always used
during the `bootstrap-servers` phase by setting
`ansible_python_interpreter=auto_silent` via `extra_vars`, while the
`octavia-certificates` command now explicitly uses the same Python
interpreter that was used to invoke the `kolla-ansible` CLI, ensuring
compatibility with the local environment.

Summary:
- The `ansible_python_interpreter` is now dynamically defined in
  `group_vars/all.yml`, falling back to the system interpreter if
  no virtualenv is configured.
- CLI commands now detect and respect user-specified
  `ansible_python_interpreter` values via `-e`, and avoid overriding them.
- The `bootstrap-servers` command always uses the system Python interpreter
  by setting `ansible_python_interpreter=auto_silent`, ensuring a clean
  environment for virtualenv creation.
- The `octavia-certificates` command uses the Python interpreter
  that invoked the `kolla-ansible` CLI, ensuring compatibility with
  locally installed packages (e.g. cryptography).

This improves interpreter handling across commands, especially in environments
with custom Python setups or virtual environments.

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/949767
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+1, -2)
kolla_ansible/cli/commands.py (+14, -1)
releasenotes/notes/use-auto-detected-python-interpreter-for-bootstrap-b83cc25d03e4eeb5.yaml (+8, -0)
ansible/group_vars/baremetal.yml (+15, -0)
",-3.445082,1.50259,3.473868,-0.068436,0.476353,0.17695,-0.587554,-0.047398,0.107729,-0.770299,-0.420343,0.196183,-0.252478,0.010025,0.147182
openstack/kolla,I0a8cdc232e5b46cb47e4a3e1b0af7b2402103690,0,0,0.5151,3.434,0.5,5,3.0,200,0,Feature,0,1,0,299,0.015647,0.7857,0,0.4047,2,3,0,0.6361,2.1736,1.4,15.79,10.09,0,0,0.6667,1,6.4516,0,0,0,0,0,"Revert ""mariadb: pin to 10.11.11""

This reverts commit 535b2f270faf24cfa30b9aa1a896a62c5090f1aa.

Reason for revert: 10.11.12 is revoked upstream
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+2, -2)
docker/base/mariadb.repo (+1, -1)
.zuul.d/ubuntu.yaml (+4, -4)
kolla/template/repos.yaml (+4, -4)
.zuul.d/rocky.yaml (+4, -4)
",0.064371,-0.139679,-2.025717,-1.435611,0.760026,0.272249,0.731685,-0.085468,0.05274,0.807017,-0.078334,0.433825,-0.467014,0.461932,0.121392
openstack/kayobe,Ia8777550b00bd1cf0391a1c7bddbbf99fe7c0d20,1,1,0,2.3026,0.0,2,14.5,283,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,4,2,0,0.9104,0.7642,3.0,-9.17,20.97,0,0,0.0,1,28.3,0,6,0,11,0,"Fix authentication failures due to missing system scope

Ensure the OS_SYSTEM_SCOPE environment variable is present in
openstack_auth to prevent authentication issues occuring in
baremetal-compute playbooks.

Closes-Bug: #2111103
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/openstack (+2, -0)
releasenotes/notes/auth-fix-system-scope-20dadaf18cb43962.yaml (+7, -0)
",-0.500186,-0.762903,-0.959621,0.309084,0.484916,0.065022,-0.930722,0.249716,0.358446,-0.359477,-0.021055,-0.045862,0.18996,-0.540428,0.388356
openstack/kayobe,If1157a56110e26c3668bd54cd0293a9d3f936fc6,0,0,0.8539,1.0986,0.5,1,13.2,558,0,Bug Fix,0,0,0,89,0.070691,1.0,0,0.8539,1,1,0,0.9111,0.0,1.0,28.08,14.98,1,0,0.0,0,186.0,0,0,0,0,0,"Fix execution of kayobe overcloud deprovision

With `kayobe overcloud deprovision`, the task `Get PXE MAC address` runs
the command `openstack baremetal port list` which fails with:

    Traceback (most recent call last):
      File ""/var/lib/kolla/venv/bin/openstack"", line 5, in <module>
        from openstackclient.shell import main
    ModuleNotFoundError: No module named 'openstackclient'

Fix by using the `baremetal port list` command instead. This does not
appear to affect 2024.2 and earlier.
[SEP]
FILES CHANGED:
ansible/overcloud-deprovision.yml (+1, -1)
",-1.348281,0.402216,0.523702,-0.034359,-0.188449,0.038011,0.011054,0.35732,0.006681,0.099005,0.567411,-0.479177,-0.051126,0.254209,-0.23697
openstack/kolla,I69227a0548037411ab81890072aa779708cb85a0,0,0,0.8444,3.6376,0.8919,2,4.67,310,0,Feature,0,1,0,90,0.071372,0.3333,0,0.2815,3,2,0,0.6343,0.4942,2.5,17.79,10.44,0,0,0.0,1,8.1579,0,0,0,0,0,"Revert ""bifrost: bump Ansible version to 11""

This reverts commit c8fdb5550b15f98ed8f331f8d4b88ce150ccf3a5.

Reason for revert: Bifrost is not yet fully compatible with ansible>=10.

See https://review.opendev.org/c/openstack/bifrost/+/948245 for context.
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+4, -29)
releasenotes/notes/bifrost-ansible-11-d14b635f9f766675.yaml (+0, -4)
",-0.733185,1.24834,-1.531014,-0.924941,0.07441,0.095614,1.439088,0.028773,0.177357,0.301907,0.113907,-0.129631,-0.137387,-0.12373,0.121927
openstack/sunbeam-charms,Idcc09344feb9450383f88f236db1c7ba8db410ad,1,0,1.0,1.7918,0.2,2,7.25,276,0,Feature,0,0,0,5,0.071429,1.0,0,1.0,3,1,0,1.0,0.7219,2.5,6.94,16.69,1,0,0.0,0,46.0,0,0,0,0,0,"Allow charms to override db_sync timeout

Override neutron db_sync_timeout as its migration process is expensive
and prone to timeout in lower end hardware.
[SEP]
FILES CHANGED:
charms/neutron-k8s/src/charm.py (+1, -0)
ops-sunbeam/ops_sunbeam/charm.py (+3, -1)
",0.147097,-0.641353,-0.356987,0.812291,0.720888,0.363441,-0.635786,-0.902489,0.062842,-0.399115,0.026734,0.01559,-0.071525,-0.166271,0.098954
openstack/kolla-ansible,I5d4c5d960441025da1fc1b6f197b03476b1be1a9,1,0,0.5556,2.3979,0.6,2,12.67,300,0,CI,1,0,0,90,0.017717,0.4,0,0.2222,2,2,0,0.6393,1.0,1.5,22.55,17.7,1,1,1.0,0,27.2727,0,0,0,0,0,"[CI] Enable virtualenv testing for Debian/Ubuntu

This patch enables testing with a runtime virtualenv on Debian and Ubuntu
in CI jobs and without for RHEL derivatives.

Summary:
- Deployments on Debian/Ubuntu now test virtualenv creation logic.
[SEP]
FILES CHANGED:
tests/run.yml (+0, -5)
tests/templates/globals-default.j2 (+4, -1)
",-0.076683,-0.858523,-0.271343,0.542946,0.158179,0.075651,-0.695477,0.841917,-0.65026,0.292096,-0.46656,0.37695,0.615585,-0.030447,-0.281246
openstack/kolla-ansible,Iaeb4cbb2824bfa3df5e1bde9f3ec0d744386a122,1,1,0.5556,2.3026,0.1111,2,33.0,285,0,Bug Fix,0,0,0,9,0.042056,0.6667,0,0.3704,4,2,0,0.6397,0.7642,3.0,-24.06,28.96,0,0,0.0,1,28.5,0,6,0,7,0,"Unnecessary comma in kolla-tolbox configuration - external rabbitmq

In kolla-toolbox configuration with external rabbitmq
an unnecessary ""comma"" is generated, which is why the
container does not want to start

Closes-Bug: #2111267
[SEP]
FILES CHANGED:
ansible/roles/common/templates/kolla-toolbox.json.j2 (+1, -1)
releasenotes/notes/bug-2111267-5bff269cf10a4239.yaml (+7, -0)
",-0.050187,-0.769123,-0.716502,-0.086477,0.084066,-0.500746,-0.388116,-0.396976,-0.41226,-0.314582,0.111475,0.038049,0.321767,0.124389,0.210482
openstack/kolla,I7074fabcf95184fcfd2561648ae1e05acfb0bc11,1,0,0.5133,5.1705,0.3829,25,16.0,660,0,Feature,0,0,0,300,0.015675,0.75,0,0.385,3,6,0,0.6326,3.9881,2.32,12.94,16.9,1,0,0.4629,1,3.75,0,0,0,0,0,"Move to CentOS Stream 10

Known missing packages:
- mod_auth_mellon - missing SAML support in Keystone/Horizon - built in Kolla COPR
- glusterfs-fuse in manila-share - built in Kolla COPR
- collectd/telegraf - no opstools repository
- redis - needs a switch to valkey
- python3-ethtool - not required for neutron-mlnx-agent since 6 years [1]

Building packages in Kolla COPR is a temporary solution until these show up
in EPEL10.

[1]: Id2cae3ac9ff049e9fc8225551f99e1e99a87fc65

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/951751
[SEP]
FILES CHANGED:
docker/nova/nova-libvirt/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+4, -2)
docker/base/td.repo (+2, -1)
kolla/common/config.py (+3, -3)
docker/openstack-base/Dockerfile.j2 (+1, -1)
docker/base/proxysql.repo (+2, -1)
docker/base/kolla_el10.repo (+10, -0)
docker/nova/nova-compute-ironic/Dockerfile.j2 (+1, -1)
docker/base/Dockerfile.j2 (+6, -8)
docker/base/influxdb.repo (+2, -1)
docker/manila/manila-share/Dockerfile.j2 (+2, -2)
docker/neutron/neutron-mlnx-agent/Dockerfile.j2 (+0, -1)
docker/mariadb/mariadb-server/Dockerfile.j2 (+4, -1)
docker/mariadb/mariadb-base/Dockerfile.j2 (+2, -2)
.zuul.d/centos.yaml (+36, -0)
docker/nova/nova-ssh/extend_start.sh (+1, -1)
tests/templates/template_overrides.j2 (+1, -16)
docker/kolla-toolbox/Dockerfile.j2 (+2, -4)
kolla/tests/test_methods.py (+2, -2)
kolla/image/unbuildable.py (+3, -0)
.zuul.d/base.yaml (+12, -12)
docker/base/ci-centos.repo (+5, -5)
docker/keystone/keystone-base/Dockerfile.j2 (+3, -0)
docker/keystone/keystone-ssh/extend_start.sh (+2, -1)
docker/ironic/ironic-conductor/Dockerfile.j2 (+1, -1)
",-2.540027,0.46513,0.872584,-1.596228,-0.141017,-0.642232,0.116402,0.553384,-0.377812,-0.448364,0.065996,0.118368,0.103655,-0.204707,-0.027406
openstack/kolla,Ib8e2a8a20a828c4c69deedd307c9b726f51489f8,1,0,0.515,3.5835,0.2571,1,4.61,700,0,Bug Fix,1,0,0,301,0.015585,1.0,0,0.515,1,1,0,0.6336,0.0,1.0,33.97,11.0,0,0,1.0,0,19.4444,0,0,0,0,0,"Fix mock_open() expectations for Python 3.13+

Python 3.13 introduces a behavior change in unittest.mock.mock_open(),
which now calls close() when exiting the context manager
as described in bpo-44185 [1]. This causes additional mock calls to appear,
breaking strict mock_calls assertions.

This patch fix tests and add compatibility for Python 3.13.

From mock documentation [2]:
  ""bpo-44185: unittest.mock.mock_open() will call the close() method
   of the file handle mock when it is exiting from the context manager.
   Patch by Samet Yaslan.""

[1] https://bugs.python.org/issue44185
[2] https://mock.readthedocs.io/en/latest/changelog.html
[SEP]
FILES CHANGED:
tests/test_set_config.py (+26, -9)
",-2.401374,1.403356,1.563584,-0.02737,-0.553184,0.358516,0.071959,0.019094,0.159718,0.344073,0.365981,-0.308857,-0.325909,-0.016661,0.093912
openstack/kolla,I4f852176918531ea19210961fd1b4fa63bc0ecca,0,0,0.5166,3.0445,0.4,5,3.0,78,0,Feature,0,0,0,302,0.015608,0.4167,0,0.2152,2,4,0,0.6346,2.3219,2.0,6.39,14.53,0,0,0.0,1,3.7143,0,0,0,0,0,"rabbitmq: Update to 4.1
[SEP]
FILES CHANGED:
docker/rabbitmq/apt_preferences_rabbitmq.ubuntu (+2, -2)
docker/rabbitmq/Dockerfile.j2 (+2, -2)
docker/kolla-toolbox/Dockerfile.j2 (+2, -2)
docker/rabbitmq/apt_preferences_rabbitmq.debian (+2, -2)
releasenotes/notes/rabbitmq-41-d881d0b6bbf46446.yaml (+4, -0)
",3.124496,1.656755,1.252801,-0.41803,-0.359215,0.647376,0.379076,0.688397,-0.195446,1.212378,0.007068,0.13702,-1.113488,0.210674,0.776748
openstack/kolla,I1f9bc50b71f55dd5f579d1536a7ab63d5d554d1e,1,0,0.5149,1.0986,0.5,1,3.0,110,0,Bug Fix,0,0,0,303,0.015644,1.0,0,0.5149,2,1,0,0.6329,0.0,2.0,-106.41,27.87,0,0,0.0,0,36.6667,0,0,0,0,0,"kolla-toolbox: Fix apt_preferences_rabbitmq.ubuntu link
[SEP]
FILES CHANGED:
docker/kolla-toolbox/apt_preferences_rabbitmq.ubuntu (+1, -1)
",1.296186,0.263223,-0.268459,-1.058308,0.665103,-1.337106,-0.104886,0.686269,-0.460942,-0.682298,0.176551,-0.519607,-1.142831,-0.291771,0.339893
openstack/kolla-ansible,I3b3b2c434b393dd268e129d2b2d90cca0d0d67d2,1,1,0.6,3.5264,0.3636,2,4.67,176,0,Bug Fix,0,0,0,10,0.044843,0.0,0,0.0,4,2,0,0.6402,0.684,3.0,-27.53,24.72,0,0,0.0,1,5.1765,0,14,0,6,0,"Fix missing vendordata.json file for nova-metadata

Closes-Bug: #2111328
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2111328-c4f57b50eb5bfecf.yaml (+6, -0)
ansible/roles/nova/tasks/config.yml (+15, -12)
",1.664022,-0.128128,-0.633319,-1.059867,-0.170413,0.009365,-0.510187,0.543386,0.078796,-0.417941,0.276819,-0.122188,-0.292011,0.075971,0.379259
openstack/kolla,I5295bba1e11f84217bb2b28ea4d92cb47812b778,1,0,0.5604,3.3673,0.5,1,7.0,91,0,Bug Fix,0,0,0,91,0.017878,0.3333,1,0.1868,3,1,0,0.6339,0.0,3.0,-17.81,19.94,0,0,0.0,0,3.1379,0,0,0,0,0,"Fix lines in documencation [trivial]
[SEP]
FILES CHANGED:
doc/source/admin/image-building.rst (+14, -14)
",1.926624,1.842119,0.346252,0.524383,1.282984,0.494153,0.419302,-0.722344,-0.226106,0.221198,0.784056,0.086767,-0.130716,-0.565469,-0.658764
openstack/openstack-ansible-os_trove,Ic5747e29050cced51a71a4b4e71352f231758ed8,1,1,0.9581,2.8904,0.0588,3,23.33,474,0,Bug Fix,0,0,0,215,0.05649,0.9697,0,0.9291,2,2,0,1.0,0.8343,1.33,44.17,16.76,0,0,0.0,1,26.3333,0,8,0,5,0,"Do not use group as a ""setup_host"" variable

This fixes an issue, when a host group was passed to mq_setup role,
and delegate logic uses group name instead of host inside of the
group for delegating tasks.

While this patch might break already in-place workarounds, it's
quite important to fix the issue properly, as workarounds are not
trivial and requires quite some understanding of the process.

Closes-Bug: #2111406
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
releasenotes/notes/trove_rabbitmq_guest_setup_host-b1237ed5efe32431.yaml (+14, -0)
defaults/main.yml (+1, -0)
",-0.840621,-1.884384,0.364952,0.316536,-0.387366,0.005488,0.111432,-0.327285,0.186411,0.305083,0.171569,-0.237449,0.079746,-0.146117,0.217735
openstack/kolla-ansible,I82cec9fa54883054421a7f23bfbf174189facb14,0,0,0.8352,2.7726,0.8,1,3.67,340,0,CI,1,0,0,91,0.070108,0.5758,0,0.4809,1,1,0,0.6407,0.0,1.0,-7.1,13.59,0,0,1.0,1,21.25,0,0,0,0,0,"CI: Use openstack-python3-jobs template

OpenStack 2025.2 drops support for Python 3.9 [1], so we can finally
revert to using the openstack-python3-jobs job template.

Sort job templates alphabetically while here.

[1] https://governance.openstack.org/tc/reference/runtimes/2025.2.html
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+3, -12)
",-0.626039,0.677032,-0.488769,0.377932,-0.713663,-0.633701,0.184781,0.693926,-0.126004,0.844768,-0.263049,-0.094058,-0.155936,0.068174,0.010825
openstack/kolla,Idaa6d6cbf0c5f4d88aae3ff32f0e72673df5d2d4,0,0,0.5652,2.0794,0.1429,2,7.0,88,0,Feature,0,0,0,92,0.017976,0.5106,0,0.2886,2,2,0,0.6349,0.8631,2.0,-17.81,25.66,0,0,0.0,1,11.0,0,0,0,0,0,"debian: Use Epoxy extrepo release
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
releasenotes/notes/debian-epoxy-1f33fedb0b7b07ae.yaml (+5, -0)
",3.638804,0.709142,1.14372,-0.407382,0.642685,0.028471,0.622393,0.935079,-0.817815,-0.66069,0.495516,-0.248065,-0.116811,-0.008406,-0.588579
openstack/kolla,Ifd664de82a81830eeda8ccc019b22ee93768635e,1,0,0.5591,2.6391,0.3077,3,10.0,104,0,Feature,0,0,0,93,0.018146,0.5556,0,0.3106,2,2,0,0.6332,1.5766,2.0,19.03,12.0,1,0,0.3077,1,7.4286,0,0,0,0,0,"debian: Use bookworkm suite for rabbitmq APT repo
[SEP]
FILES CHANGED:
releasenotes/notes/debian-rabbitmq-bookworm-34b2e5d9d43241da.yaml (+5, -0)
kolla/template/repos.yaml (+2, -2)
kolla/tests/test_methods.py (+2, -2)
",2.332755,-0.058805,0.472328,-0.273561,0.926913,-0.577377,0.285295,1.16126,-1.11546,-0.57903,0.2129,0.116293,-0.108952,-0.396826,0.074497
openstack/sunbeam-charms,Icd4070f46127144ca521aa5aa998050d6f526973,1,0,0,5.9081,0.0,5,14.0,255,0,Feature,0,0,0,0,0.0,0.0,0,0.0,6,2,0,1.0,0.9596,3.4,2.28,18.46,1,1,0.1172,1,0.6929,0,0,0,0,0,"[openstack-hypervisor] Added relation between hypervisor and consul charm

Added relation related changes in openstack-hypervisor charm send snap name and unix socket file path to consul-client charm.
[SEP]
FILES CHANGED:
charms/openstack-hypervisor/src/charm.py (+25, -0)
charms/openstack-hypervisor/.sunbeam-build.yaml (+1, -0)
charms/openstack-hypervisor/charmcraft.yaml (+3, -0)
libs/external/lib/charms/consul_client/v0/consul_notify.py (+295, -0)
charms/openstack-hypervisor/tests/unit/test_charm.py (+43, -0)
",-0.361564,0.874881,-0.639956,1.393004,1.478128,-0.484349,0.393755,0.55282,-0.279875,-0.455313,0.021234,0.432985,0.316921,-0.0999,-0.498072
openstack/kolla-ansible,Ie3893b002bcc9150143060a229cefbad48600d46,0,0,0.5638,1.0986,0.5,1,3.5,90,0,CI,1,0,0,94,0.018295,0.5128,0,0.2891,1,1,0,0.6398,0.0,1.0,22.0,18.54,1,1,1.0,1,30.0,0,0,0,0,0,"[CI] Set previous_release to 2025.1
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",1.236931,3.156817,-0.051937,0.634848,0.545844,1.498845,-0.494539,-0.193263,0.178762,1.395357,0.441376,-0.071259,-0.425994,0.396423,-0.811532
openstack/kolla,I555deccfd7b58c05d0b62d7d200dcec97b2e6f7d,0,0,0.5164,4.9558,1.0,2,7.5,147,0,CI,1,0,0,304,0.015694,0.6923,0,0.3575,1,1,0,0.6341,0.8085,1.0,30.02,13.67,0,0,1.0,0,1.0352,0,0,0,0,0,"CI: Drop centos9/rocky9 testing

We'll readd it later when introducing centos10 and rocky10.
[SEP]
FILES CHANGED:
.zuul.d/centos.yaml (+0, -35)
.zuul.d/rocky.yaml (+0, -106)
",2.155938,0.490625,-0.251079,-0.381109,0.063089,0.400276,0.185557,-0.220446,-1.394353,-0.060831,0.084459,0.058225,-0.028259,-0.318222,0.515208
openstack/kolla-ansible,Ib43fffc0a261ac302995dc9d2a3e71a80d2783c1,0,0,0.5148,3.5835,1.0,1,7.5,143,0,CI,1,0,0,305,0.015631,0.5588,0,0.2877,1,1,0,0.639,0.0,1.0,35.66,11.0,0,0,1.0,1,3.9722,0,0,0,0,0,"CI: Drop centos9/rocky9 jobs

We'll readd them when adding centos10 and rocky10 support.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -35)
",1.604557,-0.165497,-0.617272,-0.288226,0.205922,0.048448,-0.073301,-0.042132,-1.373553,-0.054348,0.065689,0.037234,0.186559,-0.436546,0.34173
openstack/kolla,Ied6e20f5b1dc5de384f29d317bec998e86f26efa,0,0,0.875,2.1972,0.75,1,6.75,208,0,CI,0,0,0,16,0.061538,0.5758,0,0.5038,0,1,0,0.6324,0.0,0.0,33.92,11.59,0,0,0.0,1,23.1111,0,0,0,0,0,"Drop environments for nose

... because stestr is now used instead of nose.

Also drop the VIRTUAL_ENV environment which is now automatically set
by tox.
[SEP]
FILES CHANGED:
tox.ini (+2, -6)
",0.750988,-1.114711,0.003391,0.264399,0.077696,0.106017,-0.728203,-0.484234,-1.03341,-0.226666,-0.388418,-0.243284,-0.500844,0.273107,-0.075232
openstack/kolla,I562ce5e54752015863a20bf113bce74a69e02331,1,1,0.5579,4.92,0.3456,3,14.6,657,0,Bug Fix,0,0,0,95,0.018482,1.0,0,0.5579,3,2,0,0.6307,1.3408,2.67,-14.27,17.35,0,1,0.0,1,4.7956,0,16,0,13,0,"[mariadb] Fix incremental backup using correct base dir

The original script used --incremental-history-name and compressed
full backups as gzip streams. This failed because mariabackup expects
an actual decompressed base directory for incremental backups.

This patch:
- Decompresses the latest full backup into a temporary directory
- Uses that as --incremental-basedir
- Aligns the backup flow with official Mariabackup documentation:
  https://mariadb.com/kb/en/incremental-backup-and-restore-with-mariabackup/

This makes the incremental process reliable and fully supported.

Closes-Bug: #2111620
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-server/backup_replica.sh (+39, -26)
releasenotes/notes/bug-2111620-e40e1dec6fed309f.yaml (+12, -0)
docker/mariadb/mariadb-server/backup.sh (+38, -21)
",-2.23998,0.276399,0.531763,-0.059349,-0.004743,-0.320292,-0.426506,0.271196,-0.223634,-0.132124,0.107332,0.319154,0.195154,0.203796,0.132941
openstack/kayobe,I852e945ae2e6261f8b9a549fbba75adc450459c6,1,0,0.8261,1.0986,0.5,1,10.5,159,0,Bug Fix,0,0,0,92,0.070069,0.0,0,0.0,4,1,0,0.9044,0.0,4.0,43.09,11.82,0,0,0.0,0,53.0,0,0,0,0,0,"Fix syntax error in drac-pxe role

Probably the result of a copy-paste from an earlier line in the file.
[SEP]
FILES CHANGED:
ansible/roles/drac-pxe/tasks/main.yml (+1, -1)
",1.899705,0.038973,-0.242939,0.168923,-0.5975,0.681115,1.4188,-0.710531,0.284925,-0.336854,0.72445,0.449689,-0.20743,0.477302,0.070328
openstack/kolla-ansible,I4a2beae7613c18cd19e16d4d04f42685a94b4f4f,1,0,0.828,3.8501,0.8913,1,7.33,205,0,Doc,0,0,0,93,0.070722,0.3333,1,0.276,3,1,0,0.6382,0.0,3.0,22.5,13.84,0,0,0.0,0,4.3617,0,0,0,0,0,"Replace outdated core team list by Gerrit links

Copied from the same file in Kolla documentation.
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+5, -41)
",2.226062,-0.243692,0.183835,0.050008,-1.093626,0.630554,0.623162,0.401332,-0.204614,-0.55402,0.339364,-0.107479,-0.502536,0.512532,-0.925175
openstack/kolla,I8e20c77a8f1538162fc1dac9dc92c837348a09f4,1,1,0,2.1972,0.0,2,10.0,118,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,3,2,0,0.6317,0.8113,2.5,2.11,20.0,1,0,0.0,1,13.1111,0,10,0,13,0,"Fix glance-api: add missing lsscsi package

Closes-Bug: #2111828
[SEP]
FILES CHANGED:
docker/glance/glance-api/Dockerfile.j2 (+2, -0)
releasenotes/notes/fix-glance-api-add-missing-lsscsi-package-e6ae949eb8bdbe7b.yaml (+6, -0)
",1.654508,-0.667514,-0.119897,-1.438288,-0.425264,-0.20454,-1.243269,0.384515,-0.101016,-0.034066,-0.09776,-0.149204,0.183092,-0.045486,0.571402
openstack/kolla-ansible,I0b9e97421c78fcb215cc203af12de50ee5cd794f,0,1,0.5625,2.9957,0.1053,2,12.0,289,0,Bug Fix,0,0,0,96,0.018196,0.3333,0,0.1875,4,2,0,0.6386,0.8997,3.0,39.56,14.8,0,1,0.0,1,14.45,0,6,0,3,0,"[rabbitmq] Use stop instead of drain on single-node

Avoid using `drain` when only one RabbitMQ host is targeted, as it's meaningless
outside of clustered setups. Use `stop` for single-node, and `drain` otherwise.

Closes-Bug: #2111916
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2111916-6b2ca611df41dceb.yaml (+6, -0)
ansible/roles/rabbitmq/tasks/restart_services.yml (+11, -2)
",-0.604555,0.638456,-0.852956,0.751419,-0.015933,0.495751,-0.43483,-0.429014,-0.336431,0.022796,0.260645,0.015853,0.382072,-0.164242,-0.177339
openstack/sunbeam-charms,I28a261b85067704221d6ab3d949c5d2a27a4a9d7,1,0,0,7.3434,0.0104,61,15.25,1478,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,5,0,1.0,4.9559,3.69,8.29,15.72,1,0,0.145,1,0.956,0,0,0,0,0,"Enable audit middleware

We're enabling the audit middleware for the following API services:

* cinder
* nova
* neutron
* glance
* heat
* barbican
* octavia
* gnocchi
  * config.verbose was deprecated a long time ago and Gnocchi doesn't
    support a separate ""logging.conf"" file
     * as such, Gnocchi can't be configured to use ""info"" level logging
     * the audit logs will only be emitted in debug mode
  * https://github.com/gnocchixyz/gnocchi/blob/cf001e84286664465ca4217281135e1b936456c1/gnocchi/service.py#L72-L79
* newly defined audit map (the other services had already existing
  definitions, which were updated):
  * aodh
  * designate
  * magnum
  * masakari
    * updated wsgi log configuration

The following services do not support the audit middleware,
the support for api paste was dropped:
* placement
* watcher
* keystone (has its own pycadf audit implementation)
  * emits notifications using oslo.notifications
  * configurable driver, possible options include ""messagingv2"" and ""log""
  * we can't just use the log driver since the user may request amqp
    notifications using:
      ""juju config keystone enable-telemetry-notifications=True""
  * we'll listen for amqp notifications using a separate service

Reference:
* audit middleware configuration: https://docs.openstack.org/keystonemiddleware/latest/audit.html
* api map samples: https://opendev.org/openstack/pycadf/src/tag/3.1.1/etc/pycadf
[SEP]
FILES CHANGED:
charms/neutron-k8s/src/templates/neutron.conf.j2 (+3, -0)
charms/magnum-k8s/src/templates/api-paste.ini.j2 (+6, -1)
tests/local/zaza/sunbeam/charm_tests/api_audit/__init__.py (+0, -0)
charms/nova-k8s/src/templates/api-paste.ini.j2 (+95, -0)
charms/magnum-k8s/src/templates/api_audit_map.conf.j2 (+21, -0)
charms/magnum-k8s/src/templates/magnum.conf.j2 (+3, -0)
charms/gnocchi-k8s/src/templates/gnocchi.conf.j2 (+4, -0)
charms/nova-k8s/src/charm.py (+12, -0)
charms/cinder-k8s/src/templates/cinder.conf.j2 (+3, -0)
charms/octavia-k8s/src/templates/api_audit_map.conf.j2 (+40, -0)
charms/gnocchi-k8s/src/templates/api-paste.ini.j2 (+7, -1)
charms/cinder-k8s/src/templates/api-paste.ini.j2 (+7, -2)
charms/barbican-k8s/src/templates/barbican-api-paste.ini.j2 (+72, -0)
charms/neutron-k8s/src/charm.py (+6, -0)
charms/heat-k8s/src/templates/api-paste.ini.j2 (+7, -2)
charms/glance-k8s/src/templates/api_audit_map.conf.j2 (+29, -0)
charms/designate-k8s/src/templates/api-paste.ini (+77, -0)
charms/designate-k8s/src/charm.py (+10, -0)
charms/heat-k8s/src/templates/api-paste-cfn.ini.j2 (+7, -2)
tests/core/smoke.yaml.j2 (+2, -0)
charms/barbican-k8s/src/templates/barbican.conf (+4, -0)
charms/cinder-k8s/src/charm.py (+3, -0)
charms/masakari-k8s/src/templates/api_audit_map.conf.j2 (+16, -0)
charms/neutron-k8s/src/templates/api-paste.ini.j2 (+6, -1)
charms/glance-k8s/src/charm.py (+12, -0)
tests/all-k8s/smoke.yaml.j2 (+2, -0)
charms/octavia-k8s/src/templates/octavia.conf.j2 (+7, -0)
charms/nova-k8s/src/templates/api_audit_map.conf.j2 (+72, -0)
charms/heat-k8s/src/templates/api_audit_map_cfn.conf.j2 (+32, -0)
charms/barbican-k8s/src/templates/api_audit_map.conf.j2 (+28, -0)
charms/glance-k8s/src/templates/glance-api-paste.ini.j2 (+98, -0)
charms/masakari-k8s/src/templates/wsgi-masakari-api.conf.j2 (+2, -2)
tests/local/zaza/sunbeam/charm_tests/api_audit/tests.py (+204, -0)
charms/heat-k8s/src/charm.py (+12, -0)
charms/designate-k8s/src/templates/designate.conf.j2 (+4, -0)
charms/aodh-k8s/src/templates/api_audit_map.conf.j2 (+18, -0)
charms/masakari-k8s/src/charm.py (+12, -0)
charms/aodh-k8s/src/templates/aodh.conf.j2 (+4, -0)
charms/barbican-k8s/src/charm.py (+20, -0)
charms/octavia-k8s/src/charm.py (+6, -0)
charms/heat-k8s/src/templates/api_audit_map.conf.j2 (+39, -0)
tests/caas/smoke.yaml.j2 (+2, -0)
charms/neutron-k8s/src/templates/api_audit_map.conf.j2 (+108, -0)
charms/aodh-k8s/src/templates/api-paste.ini.j2 (+57, -0)
charms/masakari-k8s/src/templates/masakari.conf.j2 (+5, -0)
charms/magnum-k8s/src/charm.py (+5, -0)
charms/keystone-k8s/src/charm.py (+31, -1)
charms/cinder-k8s/src/templates/api_audit_map.conf.j2 (+55, -0)
charms/glance-k8s/src/templates/glance-api.conf.j2 (+3, -0)
charms/keystone-k8s/src/templates/logging.conf.j2 (+15, -4)
tests/all-k8s/tests.yaml (+12, -0)
charms/nova-k8s/src/templates/nova.conf.j2 (+4, -0)
charms/gnocchi-k8s/src/templates/api_audit_map.conf.j2 (+23, -0)
charms/heat-k8s/src/templates/heat-api-cfn.conf.j2 (+2, -0)
charms/masakari-k8s/src/templates/api-paste.ini.j2 (+51, -0)
tests/ceph/smoke.yaml.j2 (+2, -0)
charms/gnocchi-k8s/src/charm.py (+6, -0)
charms/designate-k8s/src/templates/api_audit_map.conf.j2 (+39, -0)
charms/aodh-k8s/src/charm.py (+30, -0)
charms/keystone-k8s/src/templates/keystone_audit_monitor.py.j2 (+65, -0)
charms/heat-k8s/src/templates/heat.conf.j2 (+2, -0)
",-3.347482,1.43737,3.256698,-1.245633,-0.156214,0.127445,-0.990986,-0.350302,-0.709215,-0.282601,-1.001114,0.208416,0.141871,0.024126,-0.080878
openstack/kolla-ansible,I775648127f216db3dacf61d1bee0fe405ded7074,0,0,0.6364,3.9318,0.14,5,3.5,212,0,Feature,0,0,0,11,0.042969,0.5,0,0.3182,4,3,0,0.6378,1.9052,3.6,-86.77,24.26,1,0,0.0,1,4.1569,0,0,0,0,0,"masakari: Add support for using uWSGI

Depends-On: https://review.opendev.org/c/openstack/kolla/+/954890
[SEP]
FILES CHANGED:
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+4, -0)
ansible/roles/masakari/tasks/config.yml (+18, -1)
ansible/roles/masakari/defaults/main.yml (+6, -0)
ansible/roles/masakari/templates/masakari-api.json.j2 (+13, -6)
",0.256173,2.911577,-1.447807,-0.401647,-1.374929,0.298017,-0.206556,-0.332592,-0.088173,-0.581124,-0.744614,-0.128463,0.033548,-0.562359,-0.130797
openstack/openstack-ansible,Id3ca13aa7e0b521a10318c72c4095c4eb97bdeec,1,0,0.9583,1.6094,0.5,2,15.33,285,0,CI,0,0,0,216,0.0565,1.0,0,0.9583,4,2,0,0.9388,1.0,2.5,60.69,12.22,0,0,0.5,0,57.0,0,0,0,0,0,"Do not require full git & autoconf on EL

There should be no need in installing full git as well as autoconf,
as we are not requiring them on DEB systems either.

They require a lot of Perl dependencies, which we can simply avoid.
[SEP]
FILES CHANGED:
scripts/bootstrap-ansible.sh (+1, -1)
tests/roles/bootstrap-host/vars/redhat.yml (+1, -1)
",-0.136362,-0.943603,-0.360293,0.987486,0.119606,0.008181,0.004305,-1.096038,-1.182321,0.464021,-0.253126,0.074945,0.483398,-0.256719,0.075606
openstack/openstack-ansible-lxc_hosts,I09f04668c1164bde78bbb07615f5c7689caefada,1,0,0.9585,1.9459,0.5,2,12.0,337,0,Feature,0,0,0,217,0.056702,0.0,0,0.0,2,2,0,1.0,0.9183,2.0,43.08,14.8,0,0,0.0,0,48.1429,0,0,0,0,0,"Do not use distro templates by default

With spawning LXC from customly built images, we no longer
need to rely on configuration templates.
Moreover, such templates are not available for EL9 from EPEL.

We also should respect architecture of the LXC hosts in containers
base config.
[SEP]
FILES CHANGED:
templates/meta-data/config.5 (+1, -1)
templates/meta-data/config (+2, -2)
",0.791995,-2.047784,0.132284,0.443948,-0.393632,-0.463507,0.215596,0.106164,-0.732943,-0.195387,-0.54663,-0.135454,0.376284,-0.096866,-0.605764
openstack/openstack-ansible-galera_server,I9c30c8c61bb4f1d015baf997955a66adc4df01c4,1,0,0.9587,0.6931,0.0,1,17.67,349,0,Feature,0,0,0,218,0.056875,0.0,0,0.0,1,1,0,0.9167,0.0,1.0,48.44,13.86,0,0,0.0,0,174.5,0,0,0,0,0,"Do not verify MariaDB version when installed from distro repos

MariaDB which is installed from native distro repositories will not
match our expected version. We also should not really verify it,
as it's not up to the role to manage the upgrade cycle for the
database in case of distro source.
[SEP]
FILES CHANGED:
tasks/galera_server_upgrade.yml (+1, -0)
",0.434162,-1.721793,0.227052,1.048052,-0.021855,-0.219036,0.53258,-0.224798,-0.662926,-0.010768,-0.387952,0.264348,-0.033053,-0.090641,-0.059577
openstack/openstack-ansible-repo_server,I2bdace6e9581bd5e372af9698890c46ec81f837c,1,0,0.9589,1.0986,0.5,1,13.33,295,0,Bug Fix,0,0,0,219,0.057121,1.0,0,0.9589,1,1,0,1.0,0.0,1.0,43.14,14.33,0,0,0.0,0,98.3333,0,0,0,0,0,"Fix role idempotency

Creation of /var/www/repo was conflicting with HTTPD role, which
attempted to set 0755 permissions.

Fixing permissions set in pre_install resolve the conflict and result
in no changed tasks by the end of the role run.
[SEP]
FILES CHANGED:
tasks/repo_pre_install.yml (+1, -1)
",0.814543,-1.764332,0.149118,0.015788,-0.326215,-0.170541,0.268426,0.067607,0.133842,-0.385206,-0.196707,-0.233793,-0.28503,0.148855,-0.089208
openstack/kolla,I00bcb30662bb12ed8711b28a64ef1941dcce893a,1,1,0.5567,2.4849,0.3636,3,10.22,708,1,Bug Fix,0,0,0,97,0.018319,0.7143,0,0.3976,2,3,0,0.6327,1.4949,2.0,13.47,15.83,0,1,0.0,1,59.0,0,6,0,12,0,"[base] Ensure full control over APT sources for Ubuntu

Ubuntu images were occasionally failing to build due to
unavailability or slowness of the official Ubuntu security
repositories. Although Kolla uses `mirror://` URLs to
leverage Ubuntu mirror infrastructure, the original
`/etc/apt/sources.list.d/ubuntu.sources` file was still
present, causing the system to fallback to default sources.

This commit aligns Ubuntu behavior with Debian by
explicitly removing the distro `.sources` file and relying
solely on the sources configured by Kolla. This ensures
consistent and reproducible builds both in CI and
on local environments.

Closes-Bug: #2112140
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
releasenotes/notes/bug-2112140-41a1924c260e531c.yaml (+5, -0)
docker/base/sources.list.ubuntu (+1, -3)
",-2.089416,-0.828211,0.760806,0.205271,0.130353,-0.122576,-0.039126,0.397807,-0.210811,-0.199982,-0.018705,-0.021357,0.109606,-0.432804,-0.11298
openstack/kolla,I30d5093c1997b1ac99a762983248b8d29e677ba3,0,0,0.5612,2.9957,0.4211,5,1.86,118,0,Feature,0,0,0,98,0.01847,0.5676,0,0.3185,3,4,0,0.6337,2.1029,2.2,68.29,6.9,0,0,0.0,1,5.9,0,0,0,0,0,"Bump proxysql to 3.0.x

This patch bump proxysql 2.7.x to 3.0.x
[SEP]
FILES CHANGED:
docker/base/proxysql.repo (+2, -2)
doc/source/contributor/versions.rst (+1, -1)
releasenotes/notes/bump-proxysql-version-5669b13bcc3d88fe.yaml (+3, -0)
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+4, -4)
",-0.031419,2.124094,-0.802923,0.942283,1.172606,0.523088,-0.093729,0.362462,-0.977285,1.550167,0.0401,0.152222,-0.946728,0.51595,0.64194
openstack/kayobe,I2409428e7b929bec32c2b0034e82b4d03b343567,1,1,0.7143,3.091,0.3333,1,13.25,453,0,Bug Fix,0,0,0,7,0.030435,1.0,0,0.7143,1,1,0,0.9051,0.0,1.0,25.78,13.6,0,0,0.0,0,20.5909,0,12,0,11,0,"Make custom Gather facts run with default python for kayobe-target-venv

Fixes an issue introduced in I7cfb600eec268749ea1315112fe3a9429ab3ab8e.

This change make custom 'Gather facts' task for kayobe-target-venv run
with ``ansible_python_interpreter = /usr/bin/python3``.
This is to ensure custom 'Gather facts' can be run even when there was
no ansible facts gathered before.

Closes-Bug: #2112201
[SEP]
FILES CHANGED:
ansible/kayobe-target-venv.yml (+14, -7)
",-1.479242,-0.146334,-0.503029,-0.670803,0.667523,-0.136713,0.228788,0.150622,0.035061,-0.136023,0.322491,-0.156266,0.020275,-0.118826,0.123084
openstack/kolla,I2d7137f3d01eb28f7693113fb690069e2760820f,0,0,0.7059,1.7918,0.4,1,8.0,282,0,Bug Fix,1,0,0,17,0.066148,0.6364,0,0.4492,1,1,0,0.632,0.0,1.0,21.58,14.45,1,0,1.0,0,47.0,0,0,0,0,0,"zuul: make failing job temporarily non-voting

We have multiple CI issues currently, make the
kolla-ansible-debian-upgrade job non-voting so that we can merge fixes
in order.
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+3, -2)
",0.952149,-0.135144,-0.504891,0.366099,-0.107109,-0.623702,0.205643,-0.474667,-0.566302,-0.361656,0.005304,0.439168,0.038857,-0.066357,0.304978
openstack/kolla,Ie3583682ec0d7a55cd9e8bedde9f51550b7c1840,0,0,0.6667,1.7918,0.6,1,8.0,267,0,Feature,1,1,0,18,0.068702,0.5833,0,0.3889,1,1,0,0.6303,0.0,1.0,-5.73,16.53,1,0,1.0,0,44.5,1,0,0,0,0,"Revert ""zuul: make failing job temporarily non-voting""

This reverts commit 2b42c958effd29d7bb397c5ef79de4a58911d14f.

Reason for revert: Make job voting again
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+2, -3)
",0.549762,0.099756,-2.179226,-1.626564,1.072608,0.666522,0.983985,-0.679283,0.251828,-0.190742,-0.035264,0.523839,-0.045465,0.221952,-0.099845
openstack/sunbeam-charms,Id54fae7d6b68b3137144d5cbd581b7ebe5660360,1,0,1.0,6.0707,0.375,2,2.86,730,0,Feature,0,0,0,1,0.000647,0.0,0,0.0,2,2,0,1.0,0.0426,2.0,-55.24,15.75,1,0,0.0,0,1.6859,0,0,0,0,0,"masakari: add missing lightkube dependency

The masakari-k8s charm is missing the lightkube dependency:

unit.masakari/0.install Traceback (most recent call last):
unit.masakari/0.install   File ""/var/lib/juju/agents/unit-masakari-0/charm/./src/charm.py"", line 28, in <module>
unit.masakari/0.install     import ops_sunbeam.charm as sunbeam_charm
unit.masakari/0.install   File ""/var/lib/juju/agents/unit-masakari-0/charm/lib/ops_sunbeam/charm.py"", line 59, in <module>
unit.masakari/0.install     from lightkube.core.client import (
unit.masakari/0.install ModuleNotFoundError: No module named 'lightkube'

We'll need to add it to pyproject.yaml and update the uv.lock file.
[SEP]
FILES CHANGED:
charms/masakari-k8s/pyproject.toml (+2, -0)
charms/masakari-k8s/uv.lock (+268, -162)
",-3.564856,3.046572,1.768083,-0.139696,0.384983,-0.208774,-0.030475,0.279854,-0.3541,-0.337382,0.477059,-0.050988,-0.416674,0.537832,0.090483
openstack/openstack-ansible-os_adjutant,I072d6eed813b6a083939b5913c7803baafe99c90,1,0,1.0,4.2341,0.4853,8,6.5,138,0,Bug Fix,0,0,0,1,0.166667,0.9706,0,0.9706,1,2,0,0,2.6148,1.0,-8.01,21.06,0,0,0.0,0,2.0,0,0,0,0,0,"Fix for usage of modules via FQCN
[SEP]
FILES CHANGED:
tasks/main.yml (+11, -11)
tasks/adjutant_db_sync.yml (+2, -2)
tasks/adjutant_pre_install.yml (+3, -3)
tasks/adjutant_install.yml (+4, -4)
tasks/adjutant_post_install.yml (+1, -1)
handlers/main.yml (+5, -5)
templates/adjutant.yaml.j2 (+2, -0)
defaults/main.yml (+7, -7)
",2.249861,1.728617,1.869135,1.293351,1.477461,0.950648,-0.396784,-0.201544,0.213171,0.114174,-0.62525,-0.572438,0.716181,-0.503719,0.32773
openstack/kolla-ansible,I9a59b2f7c5dafdfeb147eb93d89039e98988049f,1,0,0.5556,2.1972,0.0,2,13.0,677,0,CI,1,0,0,99,0.018592,0.3226,0,0.1792,2,2,0,0.637,0.9544,1.5,27.23,15.31,0,1,1.0,0,75.2222,0,0,0,0,0,"[CI] Override MariaDB memory usage for CI

Our CI environment runs all services (including qemu, libvirt, etc.)
on a single node with only 8 GB RAM. The default MariaDB configuration
is too memory-heavy for such constrained resources.

This change introduces a mariadb-overrides.j2 file that limits key
memory-consuming options:

- max_connections = 300 (instead of 10000)
- innodb_buffer_pool_size = 1024M
- tmp_table_size / max_heap_table_size = 32M

These limits help avoid OOM kills during testing and prevent
unnecessary RAM consumption.

This change is CI-specific and does not impact kolla-ansible user
deployments.
[SEP]
FILES CHANGED:
tests/run.yml (+3, -0)
tests/templates/mariadb-overrides.j2 (+5, -0)
",-2.137353,-0.678479,1.198674,-0.311655,0.149515,-0.337665,-0.33133,0.31442,-0.041444,-0.241034,-0.181684,-0.051466,-0.037379,-0.260338,-0.30384
openstack/kolla-ansible,I4f3380a83fa992c3413e82a4692c26a07b25d57f,1,1,0.56,5.193,0.1229,33,12.3,935,0,Bug Fix,0,0,0,100,0.018751,0.7143,0,0.4,4,3,0,0.6374,4.4013,3.79,28.59,13.05,1,0,0.0056,1,5.1944,0,6,0,4,0,"Fix routing of queries without schema to service's DB shard

Some queries (e.g. SET AUTOCOMMIT, ROLLBACK) may be executed before
schema is selected, causing them to be routed to hostgroup 0, which
does not exist if user using different `mariadb_default_shard_id`.
This change sets default_hostgroup (shard_id) for users to ensure
correct routing even when schema is not specified.

Also adjusts nova-cell user generation logic to include shard assignment,
so queries from nova_<cell> users are properly routed, even if schema is
not used directly.

This avoids silent misrouting and improves reliability in multi-shard
deployments.

Note: These errors are not visible in CI because
mariadb_default_shard_group_id = 0 and ProxySQL routes to hostgroup 0
by default when no routing rule matches.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/951741
Closes-Bug: #2112339
[SEP]
FILES CHANGED:
ansible/roles/mistral/defaults/main.yml (+3, -0)
ansible/roles/nova-cell/defaults/main.yml (+35, -5)
ansible/roles/horizon/defaults/main.yml (+3, -0)
ansible/roles/skyline/defaults/main.yml (+3, -0)
ansible/roles/neutron/defaults/main.yml (+3, -0)
ansible/roles/heat/defaults/main.yml (+3, -0)
ansible/roles/cinder/defaults/main.yml (+3, -0)
ansible/roles/manila/defaults/main.yml (+3, -0)
ansible/roles/cyborg/defaults/main.yml (+3, -0)
ansible/roles/cloudkitty/defaults/main.yml (+3, -0)
ansible/roles/blazar/defaults/main.yml (+3, -0)
ansible/roles/placement/defaults/main.yml (+3, -0)
ansible/roles/keystone/defaults/main.yml (+3, -0)
ansible/roles/glance/defaults/main.yml (+3, -0)
ansible/roles/proxysql-config/templates/rules.yaml.j2 (+8, -0)
ansible/roles/designate/defaults/main.yml (+3, -0)
ansible/roles/grafana/defaults/main.yml (+3, -0)
ansible/roles/barbican/defaults/main.yml (+3, -0)
zuul.d/base.yaml (+1, -0)
ansible/roles/tacker/defaults/main.yml (+3, -0)
ansible/roles/trove/defaults/main.yml (+3, -0)
ansible/roles/gnocchi/defaults/main.yml (+3, -0)
ansible/roles/masakari/defaults/main.yml (+3, -0)
ansible/roles/octavia/defaults/main.yml (+6, -0)
ansible/roles/venus/defaults/main.yml (+3, -0)
releasenotes/notes/bug-2112339-3f67eefc7f0062cc.yaml (+10, -0)
ansible/group_vars/all.yml (+11, -0)
ansible/roles/aodh/defaults/main.yml (+3, -0)
ansible/roles/nova/defaults/main.yml (+3, -16)
ansible/roles/ironic/defaults/main.yml (+8, -1)
ansible/roles/magnum/defaults/main.yml (+3, -0)
ansible/roles/zun/defaults/main.yml (+3, -0)
ansible/roles/watcher/defaults/main.yml (+3, -0)
",-3.053175,0.407218,2.419408,-0.345356,0.202896,0.134795,-0.428038,-0.118899,0.15825,-0.368636,-0.056179,-0.118658,0.036074,-0.168962,-0.254092
openstack/kolla,I99acd1984ee555a5b6c731e6ee460a33677060d0,1,0,0.5644,2.9444,0.2222,1,18.43,958,0,Bug Fix,0,0,0,101,0.018324,0.0,0,0.0,2,1,0,0.6286,0.0,2.0,14.34,16.05,1,0,0.0,0,50.4211,0,0,0,0,0,"Fix ProxySQL rule sanity check to support username-based routing

Kolla Ansible now generates ProxySQL query rules not only based on
the schema name (schemaname), but also on the username. This is
needed to properly route queries that are executed before a database
schema is selected, such as `SET AUTOCOMMIT` or `ROLLBACK`.

To support this, the ProxySQL config sanity check must correctly
deduplicate rules based on both `schemaname` and `username`, and
avoid false positives when both types are used simultaneously.

This change adjusts the logic in `kolla_proxysql_config_sync` to:
- recognize rules by key `schema:<schemaname>` or `user:<username>`
- assign unique rule IDs only to truly distinct rules
- log and skip exact duplicates with appropriate context

This fix is required to support the Kolla Ansible patch below.

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/951599
[SEP]
FILES CHANGED:
docker/proxysql/kolla_proxysql_config_sync (+14, -4)
",-3.387461,0.881305,2.230125,0.088567,0.442049,0.143589,-0.529113,-0.114833,0.254126,-0.176391,-0.224727,0.034802,0.073083,-0.246541,-0.194154
openstack/kolla-ansible,I2fd04e6ed72f3702eb41fe5cf172f47a33e93bbd,0,0,0.5131,5.7621,0.4984,53,6.5,142,0,Doc,0,0,0,306,0.015655,1.0,0,0.5131,4,1,0,0.6379,5.3412,3.96,-21.02,21.06,0,0,0.0,0,0.4465,0,0,0,0,0,"Introduce docker_image_url variable

Stop repeating the same code (actually 158 times).
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+8, -8)
ansible/roles/horizon/defaults/main.yml (+1, -1)
ansible/roles/heat/defaults/main.yml (+3, -3)
ansible/roles/cinder/defaults/main.yml (+4, -4)
ansible/roles/cloudkitty/defaults/main.yml (+2, -2)
ansible/roles/blazar/defaults/main.yml (+2, -2)
ansible/roles/ovn-db/defaults/main.yml (+4, -4)
ansible/roles/kuryr/defaults/main.yml (+1, -1)
ansible/roles/hacluster/defaults/main.yml (+3, -3)
ansible/roles/redis/defaults/main.yml (+2, -2)
ansible/roles/mariadb/defaults/main.yml (+2, -2)
ansible/roles/loadbalancer/defaults/main.yml (+4, -4)
ansible/roles/multipathd/defaults/main.yml (+1, -1)
ansible/roles/etcd/defaults/main.yml (+1, -1)
ansible/roles/grafana/defaults/main.yml (+1, -1)
ansible/roles/barbican/defaults/main.yml (+3, -3)
ansible/roles/bifrost/defaults/main.yml (+1, -1)
ansible/roles/rabbitmq/defaults/main.yml (+1, -1)
ansible/roles/trove/defaults/main.yml (+3, -3)
ansible/roles/memcached/defaults/main.yml (+1, -1)
ansible/roles/aodh/defaults/main.yml (+4, -4)
ansible/roles/letsencrypt/defaults/main.yml (+2, -2)
ansible/roles/nova/defaults/main.yml (+3, -3)
ansible/roles/ironic/defaults/main.yml (+6, -6)
ansible/roles/magnum/defaults/main.yml (+2, -2)
ansible/roles/zun/defaults/main.yml (+4, -4)
ansible/roles/watcher/defaults/main.yml (+3, -3)
ansible/roles/mistral/defaults/main.yml (+4, -4)
ansible/roles/skyline/defaults/main.yml (+2, -2)
ansible/roles/neutron/defaults/main.yml (+16, -16)
ansible/roles/influxdb/defaults/main.yml (+1, -1)
ansible/roles/manila/defaults/main.yml (+4, -4)
ansible/roles/cyborg/defaults/main.yml (+3, -3)
ansible/roles/iscsi/defaults/main.yml (+2, -2)
ansible/roles/placement/defaults/main.yml (+1, -1)
ansible/roles/openvswitch/defaults/main.yml (+2, -2)
ansible/roles/keystone/defaults/main.yml (+3, -3)
ansible/roles/prometheus/defaults/main.yml (+10, -10)
ansible/roles/glance/defaults/main.yml (+2, -2)
ansible/roles/common/defaults/main.yml (+3, -3)
ansible/roles/designate/defaults/main.yml (+7, -7)
ansible/roles/ovs-dpdk/defaults/main.yml (+2, -2)
ansible/roles/tacker/defaults/main.yml (+2, -2)
ansible/roles/gnocchi/defaults/main.yml (+3, -3)
ansible/roles/masakari/defaults/main.yml (+3, -3)
ansible/roles/octavia/defaults/main.yml (+5, -5)
ansible/roles/venus/defaults/main.yml (+2, -2)
ansible/roles/telegraf/defaults/main.yml (+1, -1)
ansible/roles/ceilometer/defaults/main.yml (+4, -4)
ansible/group_vars/all.yml (+1, -0)
ansible/roles/collectd/defaults/main.yml (+1, -1)
ansible/roles/opensearch/defaults/main.yml (+2, -2)
ansible/roles/ovn-controller/defaults/main.yml (+1, -1)
",1.65978,-1.106536,-0.081017,-0.376063,0.004668,0.552777,-0.834765,-0.700188,0.017074,-0.117761,0.27694,-0.261188,-0.487626,0.38285,-0.325303
openstack/kolla-ansible,I0c55f924489657ddcdb2957070cd69563c6d9886,0,0,0.5114,3.5264,0.5152,11,4.5,144,0,Bug Fix,0,0,0,307,0.015455,1.0,0,0.5114,4,2,0,0.6371,3.1287,3.36,-60.93,28.47,1,0,0.0,0,4.2353,0,0,0,0,0,"ansible-lint: Fix yaml[octal-values]
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/config.yml (+1, -1)
ansible/roles/octavia-certificates/tasks/main.yml (+2, -2)
ansible/roles/skyline/tasks/config.yml (+1, -1)
ansible/post-deploy.yml (+5, -5)
ansible/roles/horizon/tasks/config.yml (+1, -1)
ansible/roles/octavia-certificates/tasks/client_ca.yml (+2, -2)
ansible/roles/mariadb/tasks/recover_cluster.yml (+1, -1)
ansible/roles/neutron/tasks/config.yml (+1, -1)
ansible/roles/octavia/tasks/hm-interface.yml (+1, -1)
ansible/roles/octavia/tasks/openrc.yml (+1, -1)
.ansible-lint (+0, -1)
",2.165685,1.096001,0.502162,-0.532378,0.249345,-1.80998,-1.119422,-0.449915,0.392121,0.987856,0.110151,0.161668,-0.037761,-0.102285,-0.55169
openstack/kolla-ansible,I998fdeb51f3f01a878c159f477004b8edf4e0aa9,1,0,0.5097,3.5553,0.0882,5,6.0,140,0,Feature,0,0,0,308,0.01548,1.0,0,0.5097,4,3,0,0.6362,1.8411,1.8,-17.81,19.07,1,0,0.9412,1,4.0,0,0,0,0,0,"Add support for CentOS 10 Stream

Signed-Off-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
tests/templates/nova-compute-overrides.j2 (+1, -2)
zuul.d/project.yaml (+2, -0)
zuul.d/nodesets.yaml (+12, -0)
zuul.d/jobs.yaml (+15, -0)
ansible/roles/prechecks/vars/main.yml (+1, -1)
",-0.413152,2.59747,-1.938903,0.194902,-0.053629,1.038194,-0.525289,-0.062387,-0.54838,-0.541083,0.974651,1.085992,0.030504,0.156445,-0.703032
openstack/kolla-ansible,Id1888bef9a1878252b925988e1c200f9217e8868,1,0,0.5686,2.9444,0.5,5,6.5,207,0,CI,1,0,0,102,0.018445,0.7143,0,0.4062,1,1,0,0.6367,2.1972,1.0,40.8,8.75,1,1,1.0,0,10.8947,0,0,0,0,0,"[CI] Use smaller flavor for CI

On AIO based tests, from time to time VM
is killed by OOM killer.
[SEP]
FILES CHANGED:
tests/test-octavia.sh (+2, -2)
tests/test-container-engine-migration.sh (+1, -1)
tests/test-magnum.sh (+2, -2)
tests/test-ovn.sh (+1, -1)
tests/test-core-openstack.sh (+3, -3)
",1.416342,-0.674848,-0.0352,0.559081,-0.243332,0.635879,-0.192788,0.23029,-0.452847,-0.087281,0.079282,0.571238,0.049366,0.166932,-0.916207
openstack/kolla-ansible,If178c23249370c7c69744843737e61a6309d6a19,0,0,0.5113,6.5971,0.6981,45,10.4,422,0,CI,0,0,0,309,0.015503,1.0,0,0.5113,6,6,0,0.6372,4.411,3.33,10.81,18.01,1,0,0.1148,1,0.5757,0,0,0,0,0,"Remove ironic-inspector deployment

Ironic Inspector has been retired and its functionality has been
moved to Ironic.

Added a change to service-ks-register to make password optional
(to able to remove user without a password being passed in).

Using the opportunity - increasing CI coverage to include
inspection.
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+1, -1)
ansible/roles/bifrost/templates/bifrost.yml.j2 (+0, -6)
ansible/roles/bifrost/tasks/stop.yml (+0, -1)
ansible/roles/fluentd/defaults/main.yml (+0, -2)
ansible/roles/ironic/templates/ironic.conf.j2 (+0, -17)
ansible/site.yml (+0, -1)
ansible/roles/ironic/tasks/precheck.yml (+3, -15)
ansible/roles/ironic/templates/ironic-tftp.json.j2 (+1, -1)
ansible/roles/ironic/tasks/clone.yml (+0, -9)
ansible/inventory/all-in-one (+1, -1)
ansible/roles/ironic/templates/inspector.ipxe.j2 (+0, -18)
ansible/roles/common/templates/cron-logrotate-ironic-inspector.conf.j2 (+0, -3)
ansible/roles/ironic/templates/ironic-dnsmasq.conf.j2 (+2, -2)
tests/get_logs.sh (+1, -7)
ansible/roles/ironic/templates/pxelinux.default.j2 (+1, -1)
ansible/roles/ironic/tasks/bootstrap.yml (+0, -6)
ansible/roles/ironic/templates/ipa.ipxe.j2 (+18, -0)
ansible/roles/bifrost/tasks/bootstrap.yml (+0, -2)
ansible/roles/service-ks-register/tasks/main.yml (+7, -3)
ansible/roles/prometheus/defaults/main.yml (+0, -2)
ansible/roles/ironic/tasks/config.yml (+13, -86)
etc/kolla/globals.yml (+3, -3)
ansible/roles/ironic/handlers/main.yml (+0, -15)
tests/templates/ironic-overrides.j2 (+5, -0)
ansible/roles/loadbalancer/tasks/precheck.yml (+0, -13)
releasenotes/notes/drop-ironic-inspector-38fc91c64517ffc1.yaml (+12, -0)
etc/kolla/passwords.yml (+0, -3)
ansible/roles/loadbalancer/tasks/upgrade.yml (+9, -0)
ansible/roles/common/tasks/config.yml (+0, -1)
ansible/roles/bifrost/defaults/main.yml (+0, -7)
ansible/roles/ironic/tasks/upgrade.yml (+58, -1)
ansible/roles/ironic/templates/ironic-inspector.json.j2 (+0, -28)
tests/test-ironic.sh (+34, -5)
ansible/roles/ironic/tasks/bootstrap_service.yml (+0, -23)
roles/openstack-clients/defaults/main.yml (+0, -2)
ansible/roles/ironic/templates/ironic-inspector.conf.j2 (+0, -103)
ansible/group_vars/all.yml (+0, -8)
ansible/roles/ironic/defaults/main.yml (+10, -88)
ansible/roles/ironic/tasks/deploy.yml (+0, -17)
ansible/roles/ironic/templates/ironic-http.json.j2 (+3, -3)
zuul.d/project.yaml (+2, -0)
ansible/roles/fluentd/templates/conf/filter/01-rewrite.conf.j2 (+1, -1)
tests/templates/inventory.j2 (+6, -0)
zuul.d/jobs.yaml (+24, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+6, -6)
",0.142581,-2.086051,-0.512531,0.137565,-0.571963,-0.231296,-0.391923,0.102049,-0.040361,0.04854,-0.132366,0.290385,0.031565,0.315062,-0.155092
openstack/kolla,I35b233a499c6bf1861b376fc441dc8081cfaf5d6,1,1,0.8,2.3979,0.3,2,8.38,570,0,Bug Fix,0,0,0,5,0.011682,0.3333,0,0.2667,3,2,0,0.6296,0.971,2.5,30.4,13.5,0,0,0.0,1,51.8182,0,6,0,7,0,"Remove dibbler from neutron-l3-agent

The dibbler-client package has been removed from upstream Rocky repos,
breaking neutron-l3-agent container image builds on RL9. Since the
2025.1 release, package is no longer used in Neutron has been removed
because the project is stale and functionality was untested [1].

This change removes the package from the image build for all
distributions.

[1] https://review.opendev.org/c/openstack/neutron/+/934283

Closes-Bug: #2112575
[SEP]
FILES CHANGED:
docker/neutron/neutron-l3-agent/Dockerfile.j2 (+1, -3)
releasenotes/notes/remove-dibbler-537b80d88f9984f5.yaml (+6, -0)
",-1.143909,0.10938,0.188216,-0.189988,-0.65774,-0.297631,0.416039,0.743432,-0.107537,-0.011588,0.266053,0.281648,-0.291707,0.119145,-0.064393
openstack/kolla-ansible,Ide4387d3a041ee424bc7f62fb4ddb38ff3e7cb52,0,0,0.5097,2.0794,0.1429,2,4.33,161,0,CI,0,0,0,310,0.015003,0.57,0,0.2905,0,2,0,0.6364,0.8631,0.0,-31.84,23.27,1,0,0.0,1,20.125,0,0,0,0,0,"CI: ansible-lint: Move exclude paths to .ansible-lint
[SEP]
FILES CHANGED:
tox.ini (+1, -1)
.ansible-lint (+5, -0)
",1.030854,2.64717,-0.438359,0.764494,0.775112,-1.231126,-0.470978,-0.368113,-0.325674,0.633514,0.265963,0.169602,-0.087149,0.03601,-0.047255
openstack/kolla-ansible,I2e30c04bd1597ec15e4c681b31443c7886154194,0,0,0.508,2.9957,0.5263,7,4.5,140,0,Bug Fix,0,0,0,311,0.015046,0.6,0,0.3048,4,2,0,0.6355,2.669,3.14,-79.73,32.91,1,0,0.0,0,7.0,0,0,0,0,0,"ansible-lint: Fix jinja[spacing]
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+1, -1)
ansible/group_vars/all/common.yml (+2, -2)
ansible/group_vars/all/database.yml (+2, -2)
ansible/roles/ovn-db/defaults/main.yml (+1, -1)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+1, -1)
ansible/roles/prometheus/defaults/main.yml (+2, -2)
.ansible-lint (+0, -1)
",1.914446,1.90944,0.190266,-0.310669,0.22079,-1.213112,-1.391581,-0.69607,0.377515,0.967718,0.548178,0.087804,-0.266981,-0.368282,-0.613192
openstack/kayobe,I4548410d533731138de02780dc8b2013e71730d0,1,1,0.8421,2.0794,0.1429,2,12.67,302,0,Bug Fix,0,0,0,19,0.005141,1.0,0,0.8421,2,2,0,0.9058,0.8631,1.5,22.55,17.7,0,0,0.0,1,37.75,0,6,0,16,0,"Fix image registry conditional

`kolla_docker_registry` evaluates to an empty string if neither
a docker or podman registry are configured. This leads to broken
behaviour if an image build is attempted with a regex specified.

Closes-bug: #2112646
[SEP]
FILES CHANGED:
releasenotes/notes/fix-empty-registry-bug.yaml (+5, -0)
ansible/container-image-build.yml (+1, -1)
",0.007597,-0.937404,-0.646547,0.246916,-0.10284,0.167104,-0.479842,-0.225165,0.536859,-0.148667,-0.062854,-0.297001,0.051115,-0.227531,0.161808
openstack/kolla,Ie47aed221d04bbb2b50ccfbd7c398e6ab6022442,0,0,0.85,3.6636,0.8684,3,11.0,246,0,Feature,0,0,0,20,0.005401,0.5,0,0.425,3,3,0,0.6306,1.3592,2.33,34.16,16.52,1,0,0.0,1,6.3077,0,0,0,0,0,"Remove the OVN exporter for Prometheus

Since this exporter is no longer developed, and is not used in Kolla
Ansible, remove it immediately. A replacement has been proposed in
change #951971.
[SEP]
FILES CHANGED:
kolla/common/sources.py (+0, -11)
releasenotes/notes/remove-prometheus-ovn-exporter-c5f5005b4d1a4b12.yaml (+5, -0)
docker/prometheus/prometheus-ovn-exporter/Dockerfile.j2 (+0, -22)
",0.572349,-0.913007,-0.746753,0.483839,-0.721339,0.680874,-0.197894,-0.221074,-0.242742,0.286012,0.213492,0.731564,-0.527311,-0.290071,-0.162255
openstack/kolla-ansible,Idd705a8038c62b0c8ad82da3042acf1944478e58,0,0,0.5064,1.0986,0.5,1,14.5,207,0,Feature,0,0,0,312,0.01508,0.75,0,0.3798,4,1,0,0.6347,0.0,4.0,43.34,14.08,1,0,0.0,0,69.0,0,0,0,0,0,"keystone: Add -DFOREGROUND to parameters

This is required to remove ARGS in the script on Kolla side,
which in turn will allow us to add uWSGI support.
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/keystone-startup.sh.j2 (+1, -1)
",1.085324,-1.567627,-0.16432,0.145318,-0.231436,0.169628,-0.187112,-0.322851,-0.47559,-0.121251,-0.218495,0.128542,-0.03101,-0.424062,-0.306797
openstack/kolla,Ib95fc21ed380d0eccc5ee3434cebc348c1088352,0,0,0.5048,1.6094,0.0,1,5.0,82,0,Feature,0,0,0,313,0.015127,0.0,0,0.0,2,1,0,0.6289,0.0,2.0,-68.96,34.0,0,0,0.0,1,16.4,0,0,0,0,0,"telegraf: Deprecate support
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-telegraf-db2b0b9f30591552.yaml (+4, -0)
",2.7415,1.870551,0.744449,-0.159275,-0.234845,0.854559,0.005599,-0.014429,-0.093969,0.422882,0.544324,0.370315,-0.847944,-0.642494,-0.230575
openstack/kolla,I26550599b8ea7ea17687475154b3070aaed659e9,0,0,0.5032,1.6094,0.0,1,5.0,82,0,Feature,0,0,0,314,0.015173,0.0,0,0.0,2,1,0,0.6273,0.0,2.0,-52.04,26.0,0,0,0.0,1,16.4,0,0,0,0,0,"collectd: Deprecate support
[SEP]
FILES CHANGED:
releasenotes/notes/deprecate-collectd-8ba94052bdc9424b.yaml (+4, -0)
",4.06819,1.478467,1.338075,-0.335434,-0.573775,0.675233,0.63585,-0.057663,-0.054999,0.14807,0.065539,0.112546,-0.388259,-0.288159,-0.308841
openstack/kolla-ansible,I7d45ba8687fca53505af771046fabc0186774acc,1,0,0.5016,1.6094,0.0,1,8.0,99,0,Doc,1,0,0,315,0.015218,0.4,0,0.2006,1,1,0,0.6339,0.0,1.0,-23.36,23.2,0,0,1.0,0,19.8,0,0,0,0,0,"CI: Add docker/podman inspect to unhealthies
[SEP]
FILES CHANGED:
tests/check-failure.sh (+4, -0)
",3.244542,-0.183199,1.165133,-0.373241,0.253766,-0.68827,0.002044,0.209807,-0.538413,-0.253398,-0.445998,-0.480794,0.447214,-0.20667,-0.054379
openstack/kolla-ansible,Iaf863f4e0aaeefd1270030e1b456aa5b258fe5a7,1,0,0.5032,1.0986,0.5,1,13.0,219,0,CI,1,0,0,316,0.015263,0.625,0,0.3145,1,1,0,0.6344,0.0,1.0,17.93,14.43,0,0,1.0,0,73.0,0,0,0,0,0,"CI: Bump instance creation timeout to 5 minutes

In many cases we've seen that current 120 seconds is not enough
Signed-Off-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+1, -1)
",0.13105,1.192687,-1.480502,0.175025,-0.454626,1.051852,0.31445,-0.630757,-0.489341,-0.095603,0.862801,0.547962,0.130804,0.037589,-0.297817
openstack/kolla-ansible,I0b326fe8305066ad9e1d455b92801be126abb451,1,0,0.5047,2.3026,0.2222,2,5.12,341,0,Feature,0,0,0,317,0.01531,0.3434,0,0.1733,2,2,0,0.6348,0.9911,2.0,34.5,12.78,1,0,0.0,1,34.1,0,0,0,0,0,"tls: use ca-bundle.crt instead of ca-bundle.trust.crt

The latter was used when it wasn't really needed - it contains
EV trust flags which are not required for haproxy use.

Changing because EL10 does not generate ca-bundle.trust.crt

Signed-Off-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
releasenotes/notes/ca-bundle-trust-3617e45357c60b80.yaml (+5, -0)
ansible/group_vars/all.yml (+2, -2)
",-1.342183,1.151902,-0.988325,0.718429,0.06091,-0.131797,0.285646,-0.272541,-0.709302,0.068138,0.967845,-0.050538,0.163667,0.317538,-0.247395
openstack/kolla,I56dbc9f8599075b7cc87726f0507c63e74723e0f,1,0,0.5063,2.7726,0.6,2,7.0,155,0,Doc,0,0,0,318,0.015352,0.5,1,0.2531,3,1,0,0.6257,0.8366,3.0,0.32,17.09,0,0,0.0,0,9.6875,0,0,0,0,0,"docs: Update contributor guide

Remove references to blueprints and kolla-ansible-core Gerrit group.
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+4, -7)
doc/source/contributor/adding-a-new-image.rst (+2, -2)
",1.690007,-0.205846,-0.539606,-0.320734,-0.338497,-0.793498,-0.241224,0.89922,-0.190368,-0.80502,-0.384601,0.623038,-0.079659,0.206123,-0.945967
openstack/kolla,I4b1b54983144f5514a6703c255d2cb4fa052a0fb,0,0,0.5078,2.3979,0.6,1,9.75,296,0,Doc,0,0,0,319,0.015389,0.0,0,0.0,2,1,0,0.6266,0.0,2.0,58.11,10.05,0,0,0.0,0,26.9091,0,0,0,0,0,"rabbitmq: Improve healthcheck script output

We've seen multiple occassions of all these healthcheck commands
not being able to be executed in 30s after the switch to RMQ 4.1.
Let's put more information in the Docker/Podman healthcheck logs.
[SEP]
FILES CHANGED:
docker/rabbitmq/healthcheck_rabbitmq (+4, -6)
",1.384413,-1.186266,-0.011482,0.327793,-0.811547,0.043443,1.059603,0.099353,-0.189532,0.061343,-0.181575,-0.031019,-0.15516,-0.082791,0.304916
openstack/kolla,I5eccc1b994c537e1d1adea21520d045674a9d41c,0,0,0.5728,1.0986,0.0,1,7.4,308,0,Feature,0,0,0,103,0.018565,0.5,0,0.2864,3,1,0,0.625,0.0,3.0,16.41,14.85,0,0,0.0,0,102.6667,0,0,0,0,0,"Copy aodh's api-paste to /etc as default

Normally, for other images, we simply copy
etc/*, but Aodh has its api-paste located
elsewhere. This patch copies the default
Aodh api-paste into /etc/aodh/.
[SEP]
FILES CHANGED:
docker/aodh/aodh-base/Dockerfile.j2 (+2, -0)
",-0.417839,0.278873,-0.499959,0.851667,0.378545,-0.115164,0.070272,-0.157847,-1.087464,-0.167586,0.171227,-0.061275,0.182479,0.433491,0.112669
openstack/kolla,I6e0b4aaa5722990e3ac647578023f474db3d4381,1,1,0.5673,4.654,0.0,3,9.0,606,0,Bug Fix,0,0,0,104,0.018739,1.0,0,0.5673,2,2,0,0.6234,1.2534,1.67,30.59,13.97,0,0,0.4231,1,5.7714,0,6,0,7,0,"Fix kolla-set-configs --check to detect state mismatch

If a configuration file is tracked in the state file
but no longer appears in config.json, it should either be
restored or removed.

This patch introduces a new exception StateMismatch and
updates execute_config_check() to detect such cases. If
any destination path is present in the defaults state but
missing from config.json, we now raise StateMismatch.

A dedicated unit test has been added to verify
this behavior.

Closes-Bug: #2114173
[SEP]
FILES CHANGED:
docker/base/set_configs.py (+54, -0)
tests/test_set_config.py (+44, -0)
releasenotes/notes/bug-2114173-70d0b815a42ae239.yaml (+6, -0)
",-1.394066,-0.964787,0.255551,0.271009,-0.430061,-0.016687,-0.199508,-0.224632,0.36341,0.389144,0.383271,-0.078489,-0.122164,0.184272,0.286776
openstack/kolla,Ie6719928e4ec2901d661f44c9f259add35afa269,1,1,0.82,1.3863,0.3333,1,8.0,302,0,Bug Fix,0,0,0,50,0.035562,0.0,0,0.0,3,1,0,0.6244,0.0,3.0,8.37,14.45,1,0,0.0,0,75.5,0,6,0,15,0,"Add rsync package to the nova-ssh container

This change fixes the issue with absent rsync package when
'remote_filesystem_transport = rsync' is enabled in nova_compute.

Closes-Bug: #2113926
[SEP]
FILES CHANGED:
docker/nova/nova-ssh/Dockerfile.j2 (+2, -1)
",0.231442,-0.700621,-0.905612,0.057814,0.021051,-0.196123,-0.236562,0.463915,0.258157,-0.690119,0.245387,-0.08109,-0.391217,-0.171763,0.244813
openstack/kayobe,Ia614645d6b49f10a0c81ae0a0ab2398a9b56912c,1,1,0.8235,2.6391,0.3077,4,4.57,417,0,Bug Fix,0,0,0,51,0.036196,0.8333,0,0.6863,4,3,0,0.9065,1.8843,2.25,-48.96,20.58,1,0,0.0,1,29.7857,0,6,0,18,0,"Remove default(omit) from Bifrost inventory template

The use of default(omit) is for module parameters, not templates.
It will generate something like
'__omit_place_holder__43ba6b6adb2908224e20a191174d53ef36403cfc'.

Closes-Bug: #2045927
Depends-On: https://review.opendev.org/c/openstack/bifrost/+/953336
[SEP]
FILES CHANGED:
ansible/inventory/group_vars/all/bifrost (+2, -2)
releasenotes/notes/fix-bifrost-invenory-05f8a92915998f09.yaml (+5, -0)
etc/kayobe/bifrost.yml (+1, -1)
ansible/kolla-bifrost-hostvars.yml (+1, -1)
",-1.792615,0.769172,-1.20135,-0.867012,0.36364,0.127494,0.271508,-0.213434,0.322511,-0.072592,0.038572,-0.489895,0.230703,-0.062095,-0.09854
openstack/kolla,Icb0e47cf95a67cb4585c71f863e542bc59ff5009,1,1,0.5062,3.8067,0.0,11,13.0,196,0,Bug Fix,0,0,0,320,0.01543,0.0,0,0.0,3,2,0,0.6253,3.325,3.0,66.74,11.35,1,0,0.0,0,4.3556,0,6,0,16,0,"ovn: Fix log permissions

ovn is running as root, and fluentd can't read it's log files,
so we need to precreate these.

Closes-Bug: #2115244
[SEP]
FILES CHANGED:
docker/ovn/ovn-controller/Dockerfile.j2 (+3, -0)
docker/ovn/ovn-controller/extend_start.sh (+6, -0)
docker/ovn/ovn-nb-db-server/extend_start.sh (+6, -0)
docker/ovn/ovn-northd/Dockerfile.j2 (+3, -0)
docker/ovn/ovn-northd/extend_start.sh (+5, -0)
docker/ovn/ovn-sb-db-server/extend_start.sh (+6, -0)
docker/ovn/ovn-nb-db-server/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-sb-db-relay/Dockerfile.j2 (+3, -0)
docker/ovn/ovn-base/extend_start.sh (+2, -0)
docker/ovn/ovn-sb-db-server/Dockerfile.j2 (+2, -0)
docker/ovn/ovn-sb-db-relay/extend_start.sh (+6, -0)
",0.736866,-1.302485,-0.546777,-0.303374,-0.678724,0.207144,-0.428583,-0.767669,-0.665689,-0.131129,0.142588,-0.228055,0.210224,0.10853,-0.29142
openstack/kolla-ansible,I27040054a29b6417c3ee39dc93c32c2df766a708,1,0,0.5714,1.3863,0.0,1,6.5,209,0,CI,1,0,0,105,0.018571,0.5,0,0.2857,1,1,0,0.6353,0.0,1.0,44.05,8.75,0,1,1.0,0,52.25,0,0,0,0,0,"[CI] Create smaller flavor for CI

On AIO based tests, from time to time VM
is killed by OOM killer.
[SEP]
FILES CHANGED:
tests/init-core-openstack.sh (+3, -0)
",1.233159,-0.691419,-0.1256,0.523382,-0.152668,0.633681,-0.323019,0.242203,-0.377451,-0.076978,0.032614,0.60447,0.064266,0.284208,-0.936989
openstack/charms.ceph,Ica8caa97db5d46279ee4f01e8d1a052b0a55a5df,1,0,0.4118,1.0986,0.0,2,6.0,216,0,CI,0,0,0,17,0.004124,0.6,0,0.2471,1,1,0,0.3333,1.0,1.0,-0.18,12.4,1,0,0.5,0,72.0,0,0,0,0,0,"Add necessary caps for RBD mirror

This PR adds missing caps needed for the RBD mirror charm.
[SEP]
FILES CHANGED:
charms_ceph/utils.py (+1, -0)
unit_tests/test_utils.py (+1, -0)
",1.246888,0.17334,-0.057359,1.232498,0.614475,1.176951,-0.135779,0.26992,0.086447,0.086326,-0.048504,0.484614,0.155863,-0.088,-0.370867
openstack/kayobe,I825ab7331fbe8f28c17b87ff79a436144426a78c,1,1,0.8333,3.0445,0.05,3,6.0,490,0,Bug Fix,0,0,0,6,0.013699,1.0,0,0.8333,4,3,0,0.9071,1.2362,2.67,34.37,11.73,0,0,0.0,1,23.3333,0,6,0,7,0,"Fix infinite loop in seed container deployment

The deploy.yml playbook previously called deploy-container.yml, but this
was changed to call itself when podman support was added [1]. It would
then recursively loop until failure. This change reverts that, so
deploy-container.yml is called instead.

Add a test to seed jobs, to catch any regression in CI.

[1] https://review.opendev.org/c/openstack/kayobe/+/909686

Closes-Bug: #2114845
[SEP]
FILES CHANGED:
releasenotes/notes/fix-deploy-containers-24da0992b56a10db.yaml (+5, -0)
playbooks/kayobe-seed-base/overrides.yml.j2 (+13, -0)
ansible/roles/manage-containers/tasks/deploy.yml (+1, -1)
",-0.7688,0.252791,0.287173,-0.250317,-1.14505,-0.080075,0.603969,-0.158074,-0.139252,0.113286,0.582905,-0.43138,-0.161205,0.121111,0.00363
openstack/kayobe,Ic2fef4c6925d2d799f096de6b6fa519d77130c3e,1,0,0.8298,2.3026,0.3333,3,6.75,239,0,Bug Fix,0,0,0,94,0.069067,1.0,0,0.8298,4,3,0,0.9078,1.585,3.33,2.58,17.51,0,0,0.0,0,23.9,0,0,0,0,0,"Fix documentation of seed_containers usage

Pulling a specific image version requires using the tag parameter.

Include docker.io in container image name for compatibility with Podman.
[SEP]
FILES CHANGED:
doc/source/configuration/reference/seed-custom-containers.rst (+2, -1)
etc/kayobe/seed.yml (+2, -1)
ansible/inventory/group_vars/all/seed (+2, -1)
",1.717811,-1.526645,0.246457,0.345795,-0.095687,-0.194401,-0.048953,0.616385,0.146504,-0.328693,-0.508453,-0.079244,-0.212649,0.010663,-0.291023
openstack/ansible-collection-kolla,Id5b92ac423671ba039bc478af829aafdd8548f9c,1,1,0.8316,2.0794,0.0,2,8.29,465,0,Bug Fix,0,0,0,95,0.069343,0.0,0,0.0,3,2,0,0.4194,0.5917,2.5,21.93,17.8,0,0,0.0,1,58.125,0,6,0,12,0,"Fix launching external containers on Ubuntu/Podman

Some external (i.e. non-Kolla) container images can fail to launch on
Ubuntu with Podman, due to the absence of the catatonit package. For
example, this affects the prometheus/node-exporter container image.

This is a small package that we be installed by default in these
environments.

Closes-Bug: #2114998
[SEP]
FILES CHANGED:
roles/podman/defaults/main.yml (+1, -0)
releasenotes/notes/ubuntu-podman-catatonit-d5cb9249473844e0.yaml (+6, -0)
",0.010286,-1.086667,-0.172669,0.123496,-0.6789,-0.372388,0.592609,0.396913,-0.383274,0.027242,0.161335,0.019825,0.492719,-0.154865,-0.074351
openstack/ansible-collection-kolla,I3e453cb82729230ad6e0281605c2492e6b62bdc2,0,0,0.8333,1.6094,1.0,1,6.5,169,0,CI,1,0,0,96,0.069717,0.5405,0,0.4505,1,1,0,0.4375,0.0,1.0,-21.02,21.06,0,0,1.0,1,33.8,0,0,0,0,0,"CI: Drop kolla-ansible rocky9 jobs

See related change Ib43fffc0a261ac302995dc9d2a3e71a80d2783c1 in
kolla-ansible.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -4)
",0.336966,0.706163,-2.250042,-2.003447,1.423369,0.135117,0.506174,-0.506734,-0.091154,-0.210084,-0.426294,0.586021,-0.066767,0.010903,0.143794
openstack/kolla-ansible,I6dd42a220ad7141b9ae4116c1941d60a016b68ee,1,1,0,1.9459,0.5,1,15.33,396,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,4,1,0,0.6358,0.0,4.0,7.36,17.44,1,0,0.0,0,56.5714,0,6,0,4,0,"Fix hacluster_tag does not take effect

When you specify a hacluster_tag that doesn't match openstack_tag,
the tag doesn't take effect.

The patch fixes the issue by changing the values of the following
three variables to hacluster_tag.
* hacluster_corosync_tag
* hacluster_pacemaker_tag
* hacluster_pacemaker_remote_tag

Closes-Bug: #2115021
[SEP]
FILES CHANGED:
ansible/roles/hacluster/defaults/main.yml (+3, -3)
",-1.481719,0.03067,-0.481898,0.538998,0.96664,-0.103792,-0.450348,-0.030096,0.346696,-0.217098,0.600709,-0.330015,-0.331831,0.199851,0.113388
openstack/kayobe,If2a26b42e6fe0152922e10df924c0797259e2e53,1,1,0.8571,2.4849,0.0,2,13.0,360,0,Bug Fix,0,0,0,7,0.015284,0.75,0,0.6429,2,2,0,0.9085,0.9457,1.5,53.72,13.66,1,0,0.0,1,30.0,0,6,0,7,0,"Fix deprovisioning multiple overcloud hosts

Previously, the user prompt ran on one host, but the assertion ran on
all hosts. This meant the check could only pass on one host, all others
would fail every time.

This change ensures the check and assertion always run once on
localhost.

Closes-Bug: #2115037
[SEP]
FILES CHANGED:
ansible/overcloud-deprovision.yml (+4, -0)
releasenotes/notes/bug-2115037-f2ed2a4994511832.yaml (+7, -0)
",-0.072506,-1.946457,0.159533,0.189653,-0.639938,0.324586,-0.094041,-0.302891,-0.054974,0.034913,0.101487,-0.092552,0.387458,0.37305,0.143753
openstack/kayobe,I512d6591ecd5eb3168f94b9d7a5a6d273b2e648f,0,1,0.875,3.1781,0.2609,2,7.17,450,0,Bug Fix,0,0,0,8,0.017058,1.0,0,0.875,4,2,0,0.9091,0.7554,3.0,-12.92,13.1,0,0,0.0,1,18.75,0,6,0,4,0,"Fix apt_disable_sources_list for Noble repo format

Ubuntu Noble changed the location of the default apt sources file and
the file format [1]. This change broke the functionality of
apt_disable_sources_list. This patch updates the apt role to compensate.

[1] https://discourse.ubuntu.com/t/ubuntu-24-04-lts-noble-numbat-release-notes/39890#p-99950-deb822-sources-management

Closes-Bug: #2115048
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2115048-9996209081025cbd.yaml (+5, -0)
ansible/roles/apt/tasks/repos.yml (+12, -6)
",-2.358772,1.665872,-0.894351,0.196043,-0.275969,-0.398716,-0.030618,0.205003,0.272632,0.072374,0.441698,-0.205274,0.315201,0.227134,0.019286
openstack/kayobe,Ia368ff68f4c3ac69406040be25fa09711e221fa3,1,0,0.8247,2.0794,0.1429,2,1.55,224,0,Bug Fix,0,0,0,97,0.070239,0.8667,0,0.7148,2,2,0,0.9028,0.8631,1.0,-28.63,14.74,0,0,0.0,1,28.0,0,0,0,0,0,"Bump stackhpc.linux to 1.3.4

This includes fixes to SR-IOV and VGPU configuration [1].

[1] https://github.com/stackhpc/ansible-collection-linux/compare/v1.3.1...v1.3.4
[SEP]
FILES CHANGED:
releasenotes/notes/bump-stackhpc-linux-1.3.4-0ae3e0ec9f4c25e2.yaml (+5, -0)
requirements.yml (+1, -1)
",-0.902023,2.972415,-1.441454,0.793448,-0.559222,-0.194556,-0.073973,0.594445,-0.068761,0.980283,-0.620353,0.144857,-0.086314,0.255893,0.0642
openstack/kolla-ansible,I276b499f5c560a55e7acf42069066385ad76e94c,1,1,0.75,2.3979,0.2,3,9.38,642,0,Bug Fix,0,0,0,8,0.031873,0.3125,0,0.2344,4,2,0,0.6362,1.371,3.33,7.82,16.02,1,0,0.0,1,58.3636,0,6,0,7,0,"Fix invalid Cinder endpoint option in nova.conf

From the change [1], a new option ``interface`` was added to [cinder]
category to override Cinder endpoint to internalURL for both
service_types. ``block-storage`` and ``volumev3`` (deprecated).

However, this is not a valid option and it fails to override cinder
endpoint, resulting Nova to use public Cinder endpoint instead.

This change set proper overriding by replacing ``interface = internal``
to ``catalog_info = block-storage::internalURL``.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/937038

Closes-bug: #2115064
[SEP]
FILES CHANGED:
ansible/roles/nova/templates/nova.conf.j2 (+1, -1)
ansible/roles/nova-cell/templates/nova.conf.j2 (+1, -1)
releasenotes/notes/fix-invalid-cinder-endpoint-option-in-nova-conf-417aae41d82cbdb2.yaml (+6, -0)
",-1.287068,0.246593,0.979623,-0.385842,-0.467774,-0.27744,0.21164,0.613114,0.270871,-0.34488,-0.025028,-0.119907,-0.321848,-0.222034,-0.290828
openstack/kolla-ansible,I917b63ac93a7370e4e064a3fcce70820521387d4,1,0,0.8269,1.0986,0.5,1,5.0,174,0,CI,0,0,0,52,0.036568,1.0,0,0.8269,1,1,0,0.6367,0.0,1.0,-40.76,20.67,1,0,0.0,0,58.0,1,0,0,0,0,"Allow to override Cirros image URL for air-gapped environments
[SEP]
FILES CHANGED:
tools/init-runonce (+1, -1)
",2.186423,0.172863,1.089016,0.365993,0.792565,-0.249367,0.408061,0.582202,0.249099,-0.453834,-0.593097,0.424558,0.197277,-0.692202,-0.395916
openstack/kolla-ansible,Ib830a9b56ebc67cece37ed41b04dca7f76b74e3b,0,0,0.5078,1.7918,0.4,1,16.0,145,0,CI,1,0,0,321,0.015445,0.5263,0,0.2673,1,1,0,0.6372,0.0,1.0,0.25,21.4,0,0,1.0,1,24.1667,0,0,0,0,0,"CI: Mark debian-upgrade non-voting

It has been failing and is non-voting in Kolla already
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+3, -2)
",2.19238,-0.149653,0.031874,0.029714,-0.203197,0.144027,0.416857,-0.280891,-0.864033,-0.113731,0.589859,0.58251,0.227837,0.188162,-0.022695
openstack/ansible-collection-kolla,Ife0792f84d609f28e4e52885b8ae80cd131d1d49,1,0,0.8265,2.3979,0.4,1,11.0,104,0,CI,1,0,0,98,0.070605,0.5128,0,0.4239,1,1,0,0.4242,0.0,1.0,41.85,15.31,0,0,1.0,1,9.4545,0,0,0,0,0,"CI: Change Kayobe Ubuntu jobs from Jammy to Noble
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+6, -4)
",1.484887,1.308539,-0.435096,0.152632,1.02283,0.810991,0.05954,0.818511,-1.513019,0.380481,1.040726,0.137312,0.569229,-0.111236,-0.596595
openstack/kolla-ansible,I66a76fc8d27bcc97cd3133eed137fd46ea599511,1,0,0.5755,3.7612,0.0476,2,9.83,495,0,Feature,0,0,0,106,0.018738,0.0,0,0.0,4,2,0,0.6364,0.5266,3.0,16.18,16.81,0,1,0.0,1,11.5116,0,0,0,0,0,"[letsencrypt] Avoid rendering empty --key-type argument

The `--key-type` argument was always rendered in the
command, even if the `letsencrypt_key_type` variable was
empty. This caused the command to fail due to an invalid
empty argument.

The template now checks if `letsencrypt_key_type` has a
non-zero length before including `--key-type`, ensuring correct
rendering of the script.
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2115230-4220523768ff2685.yaml (+5, -0)
ansible/roles/letsencrypt/templates/letsencrypt-lego-run.sh.j2 (+35, -2)
",-1.287758,0.676235,0.010241,1.380069,0.635706,0.237351,-0.040173,-0.63386,0.491205,0.023228,0.481987,-0.176726,0.030337,0.193028,-0.100568
openstack/openstack-ansible-openstack_hosts,I31ca2f2db3b26ca365bd539f6878056abe851c63,1,1,0.9591,3.7612,0.5,1,10.67,474,0,Bug Fix,0,0,0,220,0.057351,0.9714,0,0.9317,1,1,0,0.8462,0.0,1.0,33.42,13.64,0,0,0.0,0,11.0233,0,8,0,6,0,"Ensure sudo is installed before configuring it

Debian by default does not have `sudo` package installed, which
creates a race condition, as we are attempting to configure pam.d
before `sudo` package is installed which happens as part of
configure_metal_hosts.
For LXC sudo is part of the image, so it's not an issue out of the box.

Closes-Bug: #2114891
[SEP]
FILES CHANGED:
tasks/main.yml (+21, -21)
",-0.514048,-1.038602,-0.058938,0.363328,-0.463988,0.114264,0.35392,-0.350178,-0.260709,0.058985,0.378793,-0.26146,0.129418,0.135852,0.09391
openstack/openstack-ansible,Icb59ab758601096fc4f6c89fbb6d41f156f06d9d,1,0,0,2.0794,0.0,2,10.33,579,0,Feature,0,0,0,0,0.0,1.0,0,0.0,2,2,0,0.9394,0.8631,1.5,-4.24,18.33,0,0,0.0,1,72.375,0,0,0,0,0,"Set ANSIBLE_LOCAL_TEMP to /tmp to prevent remote_tmp warnings

Configure ANSIBLE_LOCAL_TEMP to avoid permission issues with Ansible temporary directories.

This prevents Ansible to issue a Warning that remote_tmp does not exist, as well as
avoid potential failures during privelege escalation through become.

We already witness failures for molecule with current default for RockyLinux 9 [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/966150
[SEP]
FILES CHANGED:
releasenotes/notes/ansible_tmp_folder-469f1f822fd7217a.yaml (+5, -0)
scripts/openstack-ansible.rc (+2, -0)
",-2.298401,0.625874,-0.298481,0.407205,0.088641,-0.298176,-0.347678,0.099837,-0.233677,0.317029,0.318659,-0.445618,0.183343,-0.325282,-0.114821
openstack/kayobe,Ib27428f89b0e3f2865ab1c498f05de741fa49587,1,1,0.8283,2.3026,0.1111,2,7.5,175,0,Bug Fix,0,0,0,99,0.070815,0.0,0,0.0,4,2,0,0.9034,0.7642,3.0,7.46,16.33,0,0,0.0,1,17.5,0,6,0,16,0,"Support empty strings in dev-tools package lists

Closes-Bug: #2115000
[SEP]
FILES CHANGED:
ansible/roles/dev-tools/defaults/main.yml (+1, -1)
releasenotes/notes/dev-tools-packages-select-filter-17f432df42762625.yaml (+7, -0)
",1.98161,-0.208396,-0.391828,-1.135114,-0.747406,0.260928,-0.845611,0.212205,-0.100945,-0.279091,0.285824,-0.08863,0.347307,0.146158,0.143577
openstack/kolla-ansible,Ie5afd40ffb5517cd0d77c46b55a304ad0c7d4007,1,0,0.5062,2.3026,0.3333,1,5.5,117,0,Bug Fix,1,0,0,322,0.01549,0.7,0,0.3543,1,1,0,0.6368,0.0,1.0,47.43,9.47,0,0,1.0,0,11.7,0,0,0,0,0,"CI: Fix check-logs.sh routine for finding missing fluentd logs
[SEP]
FILES CHANGED:
tests/check-logs.sh (+6, -3)
",1.931639,0.521051,0.499636,0.090517,0.225075,-0.670474,-0.152676,0.255231,-0.203759,0.111092,0.04064,-0.464548,0.268821,0.268028,0.286812
openstack/oslo.messaging,I447e957b9827ec2f7e657f9c20d568b77bbffff6,0,1,0.7778,4.2195,0.1343,2,15.43,787,0,Bug Fix,0,0,0,9,0.034483,0.6842,0,0.5322,2,2,0,0.6176,0.6442,2.0,43.91,14.32,1,0,0.0,1,11.5735,0,20,0,9,0,"Make x-stream-max-segment-size-bytes configurable

The RabbitMQ default size of stream segment is 500MB.
This means segments need to hit the max size to be targetted by
retention policy such as ``x-max-age`` and ``x-max-length-bytes``.
Because fanout queues can be stream from OpenStack 2024.1, this max
segment size can lead keeping outdated fanout messages to be in ready
state in segments for a long time.

This change make the stream queue argument
``x-stream-max-segment-size-bytes`` configurable, so that stream queues
can have reasonably sized segments for the environment.

However, because optimal value is environment specific, the default
value is still set to 500MB which is the default of RabbitMQ.

Closes-Bug: #2089845
[SEP]
FILES CHANGED:
releasenotes/notes/make-x-stream-max-segment-size-bytes-configurable-a1b3e5c45fec53b2.yaml (+11, -0)
oslo_messaging/_drivers/impl_rabbit.py (+47, -9)
",-2.281106,-0.201179,1.557586,0.360608,0.233841,-0.104518,-0.087876,0.026918,0.55148,-0.103742,-0.14249,0.265848,-0.039762,-0.05938,0.354835
openstack/magnum,I13bbb97c8b17fbba2f5f1acfac9d597f12925818,1,1,0.5077,3.5264,0.0,3,11.2,492,0,Bug Fix,0,0,0,323,0.015531,0.0,0,0.0,5,2,0,0.913,1.3596,3.33,12.67,18.05,1,0,0.6061,1,14.4706,0,6,0,7,0,"certs: add subject key identifier extension

Add the subject key identifier extension to the certificate generated
by Magnum. Which should permit Kubernetes clusters to have certificates
that include authority key identifier extension which appears to be a
requirement in Python 3.13 and newer.

Closes-Bug: #2097094
(cherry picked from commit 89f185b1972db25c8af84c7ca50c5ffc2af65613)
[SEP]
FILES CHANGED:
magnum/common/x509/operations.py (+6, -0)
magnum/tests/unit/common/x509/test_sign.py (+20, -0)
releasenotes/notes/add-subject-key-identifer-ae5c6ebe86749239.yaml (+7, -0)
",-1.201664,-0.843705,-0.87858,-0.733858,0.894382,0.082066,0.484854,0.405302,0.402014,0.58389,-0.023891,-0.009327,0.415494,-0.136669,0.01483
openstack/kolla-ansible,I972268857f0389b3f313070491352789bcb1e409,0,0,0.5833,3.8501,0.5,5,13.29,709,0,Bug Fix,0,0,0,12,0.039216,0.0,0,0.0,6,4,0,0.6373,1.6768,3.8,20.51,18.22,0,0,0.0217,1,15.0851,0,0,0,0,0,"fluentd: Switch to direct log shipping to OpenSearch nodes

Fluentd now sends logs directly to OpenSearch node IPs instead of using
a Load Balancer. This change reduces Load Balancer overhead from high
log volumes. The Load Balancer for OpenSearch remains in place, as it
is still used by OpenSearch Dashboards. Fluentd continues to handle node
availability, automatically distributing logs via round-robin, ensuring
log delivery even if individual OpenSearch nodes become unavailable.

Fixed Fluentd configuration template to avoid generating unnecessary
empty lines when optional parameters are not set.
[SEP]
FILES CHANGED:
ansible/roles/fluentd/defaults/main.yml (+1, -4)
releasenotes/notes/fluentd-direct-b37822ae1145355e.yaml (+14, -0)
ansible/roles/fluentd/templates/conf/output/00-local.conf.j2 (+1, -1)
ansible/roles/fluentd/templates/conf/output/03-opensearch.conf.j2 (+7, -17)
tests/test-prometheus-opensearch.sh (+0, -1)
",-1.530706,-0.916296,0.53495,1.060855,0.426859,0.151587,-0.001362,0.508264,-0.024957,0.105687,0.198642,0.095413,0.371944,-0.686029,-0.067164
openstack/ironic,Idf2fa4bc5b844dd2865d98c6de4f78ebf614d3ca,1,1,1.0,4.4543,0.0941,6,5.5,157,0,Bug Fix,0,0,0,7,0.00495,1.0,0,1.0,4,2,0,0.9583,2.0406,3.17,-75.62,31.29,0,0,0.4941,1,1.8256,0,6,0,7,0,"Fix inspection rules validation

Closes-Bug: #2115332
[SEP]
FILES CHANGED:
ironic/api/controllers/v1/inspection_rule.py (+2, -1)
ironic/common/inspection_rules/operators.py (+17, -1)
releasenotes/notes/fixes-inspection-rules-schema-validation-5cac6058d12ce030.yaml (+9, -0)
ironic/common/inspection_rules/validation.py (+4, -5)
ironic/common/inspection_rules/actions.py (+4, -0)
ironic/tests/unit/common/test_inspection_rule.py (+41, -1)
",2.002851,-0.626074,-0.132915,-1.53696,-0.881874,0.949122,-1.302218,0.433944,0.339536,-0.074966,0.495799,-0.355472,0.120047,-0.047175,0.263576
openstack/kolla-ansible,I8670e807facee8096b102fd5648cd41b76ca888c,1,0,0.5093,1.3863,0.0,2,16.0,316,0,Feature,0,0,0,324,0.015554,0.5,0,0.2546,4,1,0,0.6365,0.9183,4.0,61.93,12.23,1,0,0.0,0,79.0,0,0,0,0,0,"ovn: Add sb_relay_group_id to environment

In order to make logs readable via fluentd, we need to precreate
them in Kolla's extend_start.sh - and since we run dynamic number
of relays - we need to pass the relay group id to know which file
should be precreated.
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/defaults/main.yml (+2, -0)
ansible/roles/ovn-db/handlers/main.yml (+1, -0)
",0.233516,-0.966307,-0.406837,0.501348,0.107528,-0.619393,0.370479,-0.494752,-0.268482,-0.400237,-0.333671,-0.322052,-0.186799,-0.049055,-0.10724
openstack/sunbeam-charms,I690844906945ee526137707be889bcd6b202a782,1,0,1.0,1.3863,0.0,1,8.4,334,0,Feature,0,0,0,6,0.08,1.0,0,1.0,3,1,0,1.0,0.0,3.0,23.07,11.93,1,0,0.0,0,83.5,1,0,0,0,0,"barbican-k8s: early return if interfaces list is empty

barbican-k8s uses list of ifaces to setup the egress for vault to allow
communication, early on, that list might be empty. Early return if it's
empty or None.
[SEP]
FILES CHANGED:
charms/barbican-k8s/src/charm.py (+3, -0)
",0.267582,-0.723246,-0.413871,0.262677,-0.131482,-0.364146,0.294842,-0.769966,-0.426287,-0.0218,0.202716,-0.071027,0.123489,0.013044,-0.265919
openstack/charm-cinder,I552457b588183726314faaded21442f062a71ae2,1,1,1.0,3.1781,0.0435,2,6.0,289,0,Bug Fix,0,0,0,32,0.034188,0.9412,0,0.9412,3,2,0,1.0,0.9656,1.5,8.99,15.73,0,0,0.0,1,12.0417,0,6,0,3,0,"Add dns-query-timeout option to config.yaml

Introduced a new configuration option 'dns-query-timeout' to
set the DNS query timeout (in seconds) for the charm.

Closes-Bug: #2112374
[SEP]
FILES CHANGED:
config.yaml (+9, -0)
charmhelpers/contrib/network/ip.py (+13, -1)
",-0.646231,1.574949,-1.446582,1.004599,0.234594,0.228284,-0.498096,-0.491498,0.413355,0.122058,0.283641,0.036646,0.324399,0.412218,0.249226
openstack/kolla,I5c765db0508a2ffec90ba149bb5ea9b90dd31bc8,1,1,0.6,2.1972,0.5,2,9.0,257,0,Bug Fix,0,0,0,40,0.058824,0.0,0,0.0,2,2,0,0.6263,1.0,2.0,12.83,15.45,0,0,0.0,0,28.5556,0,6,0,7,0,"rabbitmq: fix Erlang pin in Debian/Ubuntu

Previous apt preference missed the epoch and sub-packages, so no
pinning was applied.

Closes-Bug: #2115893
[SEP]
FILES CHANGED:
docker/rabbitmq/apt_preferences_rabbitmq.ubuntu (+2, -2)
docker/rabbitmq/apt_preferences_rabbitmq.debian (+2, -2)
",1.321679,-1.210883,-0.36728,-0.889757,-0.758,0.136496,-0.276842,0.401444,-0.315443,-0.255751,0.228726,-0.038401,0.086985,-0.016277,0.23928
openstack/sunbeam-charms,If34911b2cf4f5bde1655078a772c7d7baf95ebcc,1,0,0,5.3566,0.0332,5,7.33,269,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,2,0,1.0,0.8294,2.4,-54.41,17.48,1,0,0.0,1,1.2689,0,0,0,0,0,"Add loadbalancer_annotations config option

This commit adds the `loadbalancer_annotations` config option
for ovn-relay-k8s and designate-bind-k8s charms.
[SEP]
FILES CHANGED:
ops-sunbeam/ops_sunbeam/k8s_resource_handlers.py (+175, -5)
charms/ovn-relay-k8s/charmcraft.yaml (+15, -0)
charms/designate-bind-k8s/src/charm.py (+1, -1)
charms/designate-bind-k8s/charmcraft.yaml (+12, -0)
charms/ovn-relay-k8s/src/charm.py (+1, -1)
",-0.162738,2.245445,-1.007884,1.412818,1.530696,-0.879514,-0.154495,0.169031,0.502631,-0.597943,-0.209575,0.424035,-0.011802,0.00114,0.184938
openstack/ansible-role-pki,I900b22b4059d2f5840cd4784a739f7646f728653,1,0,0.9593,1.0986,0.5,1,10.67,274,0,Feature,0,0,0,221,0.056988,0.0,0,0.0,1,1,0,1.0,0.0,1.0,24.16,18.02,0,0,0.0,0,91.3333,0,0,0,0,0,"Use internal _pki_ca_dirs in vars

Due to a typo we had `pki_ca_dirs` defined both in vars and defaults,
preventing it to be overriden by group/host variables.
[SEP]
FILES CHANGED:
vars/standalone_ca.yml (+1, -1)
",-0.485303,0.466621,-0.943626,1.233069,1.206981,0.273079,-0.504322,-1.159993,-0.371057,-0.241546,-0.041962,-0.766828,-0.484267,-0.554662,-0.071891
openstack/kolla,I87e4135425e721f2f750402b3fcc6404643a3bd3,1,1,0.6098,1.6094,0.5,2,4.25,375,0,Bug Fix,0,0,0,41,0.059593,0.4286,0,0.2613,3,1,0,0.6272,1.0,3.0,5.95,9.94,0,0,0.0,0,75.0,0,6,0,19,0,"Enable EPEL repo for Ceph deps in glance and gnocchi

Ceph Reef client dependencies now require EPEL repo on EL9.
See thread here [1].

[1] https://lists.centos.org/hyperkitty/list/devel%40lists.centos.org/thread/BZM3RO2LNAMB47FBT2QO3ZOSGBHPCO3V/

Closes-Bug: #2115448
[SEP]
FILES CHANGED:
docker/glance/glance-base/Dockerfile.j2 (+1, -1)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+1, -1)
",-1.66223,-0.03554,-1.074299,-0.793221,-0.226811,-0.393751,-0.181568,0.912731,-0.363022,0.186674,0.072226,-0.687087,0.294945,-0.046524,-0.282017
openstack/kolla,I81ad9c5bc404adfdc31eb50fd98e636ae5312eef,1,0,0.619,1.6094,0.25,2,4.6,240,0,Feature,0,0,0,42,0.060694,0.5,0,0.3095,3,2,0,0.6282,1.0,3.0,14.57,10.54,0,0,0.0,0,48.0,0,0,0,0,0,"zun: add wsgi script to use module paths

zun has moved to module paths [1].

[1] https://review.opendev.org/c/openstack/zun/+/953551
[SEP]
FILES CHANGED:
docker/zun/zun-base/Dockerfile.j2 (+1, -1)
docker/zun/zun-base/app.wsgi (+2, -0)
",0.326719,2.256973,-1.036676,0.127619,-0.870565,-0.210567,0.20443,0.142358,-0.14735,0.13446,-0.487869,-0.446472,-0.191414,-0.224039,-0.261692
openstack/kolla,I528a141e1a3ff09e820be803c3467952d77b13c6,1,0,0.6279,1.0986,0.0,1,3.75,220,0,CI,1,0,0,43,0.061782,0.7333,0,0.4605,1,1,0,0.6292,0.0,1.0,-67.69,20.17,0,0,1.0,0,73.3333,0,0,0,0,0,"CI: add kolla-ansible zun job to tests

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/954100
[SEP]
FILES CHANGED:
.zuul.d/ubuntu.yaml (+2, -0)
",-0.027194,4.095362,-1.791364,0.230455,-0.718389,0.121596,0.116636,-0.585114,-0.355984,-0.794722,-0.461246,0.063325,0.239968,-0.322951,0.037169
openstack/kolla-ansible,I14671599653f3ef383d9ac60e2507a322a9d03d3,1,0,0.5108,2.1972,0.5,1,6.0,138,0,CI,1,0,0,325,0.0156,0.5,0,0.2554,1,1,0,0.6369,0.0,1.0,-24.85,22.4,0,0,1.0,0,15.3333,0,0,0,0,0,"CI: Add processes output to ss
[SEP]
FILES CHANGED:
tests/check-failure.sh (+4, -4)
",3.868651,0.980233,1.562355,0.562171,0.301207,0.574887,0.103519,-0.010196,0.244871,0.155796,-0.16048,-0.530984,0.520373,0.483077,-0.498573
openstack/kolla-ansible,I892357e7c4d03c5ae3a9ec90eabd0e8eb95ab8be,1,0,0.6364,1.3863,0.0,1,6.5,146,0,CI,1,0,0,44,0.063037,0.7273,0,0.4628,1,1,0,0.6374,0.0,1.0,-21.02,17.98,0,0,1.0,0,36.5,0,0,0,0,0,"CI: add zun to check-log exception list
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -0)
",3.056992,0.741533,0.789555,0.346044,0.320235,-0.539539,0.458146,-0.342159,0.138975,-0.096942,-0.144804,-0.377342,0.638581,0.633899,-0.26201
openstack/kolla-ansible,I2c47ac30dd8adb1baf78af7a66b0cc0c4b037173,1,0,0.5123,2.3979,0.7,3,6.4,351,0,Feature,0,0,0,326,0.015642,0.75,0,0.3842,6,3,0,0.6379,1.4855,3.67,-5.87,15.06,0,0,0.3,0,31.9091,0,0,0,0,0,"gnocchi: Remove from openstack fluentd services

gnocchi is not using oslo_log anymore, which means it doesn't
match our regex [1].

Remove it for now.

[1]: https://github.com/gnocchixyz/gnocchi/commit/ad2484d61cab955cdd6f8ae5740ea4049b710ba0
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -0)
ansible/roles/common/defaults/main.yml (+0, -2)
ansible/roles/common/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
",-0.936574,0.649562,-1.31172,-0.941272,0.114096,-0.304687,0.751601,-0.209624,-0.106496,0.470853,0.054662,-0.595258,0.110882,-0.075195,-0.037886
openstack/openstack-ansible-os_skyline,I4ce56671921120d55ce47c9eca7fa974fba3184a,1,1,0.9595,2.3026,0.2222,2,15.75,450,0,Bug Fix,0,0,0,222,0.057216,0.9429,0,0.9046,2,2,0,1.0,0.9911,1.5,40.45,13.28,0,0,0.0,1,45.0,0,18,0,8,0,"Ensure u-c are used for Skyline installation

We had U-C commented out, likely due to the reason that Skyline
was not compliant with u-c for some release back in the days (
when project was still emerging).

Now this stroke back and Skyline is broken when fetching latest
httpx, while httpx is defined in u-c

Closes-Bug: #2115986
[SEP]
FILES CHANGED:
releasenotes/notes/skyline_u_c_usage-6167d7c50e6777f5.yaml (+5, -0)
defaults/main.yml (+2, -2)
",-0.175723,-1.471291,-0.010343,-0.299765,-0.424915,0.20511,-0.034277,-0.184583,-0.693718,0.18022,0.207062,-0.120771,0.162691,0.233743,0.479844
openstack/ansible-role-pki,Ifeaac7c98895982fab4e2bb8c4e59e553ac2beb5,1,0,0.875,0.6931,0.0,1,4.0,501,0,Bug Fix,0,0,0,40,0.17094,0.0,0,0.0,3,1,0,1.0,0.0,3.0,-15.78,15.77,0,0,0.0,0,250.5,0,0,0,0,0,"Add python3-setuptools for redhat-10 based distros.

This was previously addressed for ubuntu noble, but also needs fixing
for rh-10-ish distros.

openssl_privatekey module fails without distutils being present.
With python3.12 distutils are not pre-installed by default and provided
by setuptools instead.

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible/+/954316
[SEP]
FILES CHANGED:
molecule/default/group_vars/all.yml (+1, -0)
",-1.077135,0.465015,0.016671,-0.047222,-0.753835,-0.437063,0.495779,0.387206,-0.393732,0.157806,0.167812,-0.209585,0.197335,-0.237839,0.26213
openstack/kayobe,Iebd91d92c603efeaac94cebf009036873dd97093,1,0,0.7778,2.1972,0.0,2,5.5,149,0,Feature,0,0,0,9,0.018293,0.6364,0,0.4949,4,2,0,0.9041,0.9544,3.0,-29.47,24.02,0,0,0.0,1,16.5556,0,0,0,0,0,"Enable building of neutron-bgp-dragent container
[SEP]
FILES CHANGED:
releasenotes/notes/build-neutron-bgp-dragent-a6b28ce7e22d8145.yaml (+5, -0)
ansible/inventory/group_vars/all/kolla (+3, -0)
",2.036065,1.407372,0.639063,0.033896,1.212917,-1.225034,0.019123,1.019244,0.249285,-0.698039,-0.384428,0.633456,0.123515,0.061696,0.289624
openstack/ansible-collection-kolla,I14eb1d3e7096be3ba2926a2fb3bdab91fa3b290a,0,0,0.5138,0.6931,1.0,1,4.4,358,0,Doc,0,0,0,327,0.015683,0.6429,0,0.3303,3,1,0,0.4412,0.0,3.0,-151.41,21.76,0,0,0.0,0,179.0,0,0,0,0,0,"redhat: Remove dbus-glib-devel from packages

It has been removed from RHEL10/Rocky10/CentOS10 repositories, see 1.

[1]: https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10/html/considerations_in_adopting_rhel_10/changes-to-packages
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+0, -1)
",-1.653572,2.181526,-1.569122,0.279828,-0.507037,-0.459343,-0.009279,0.370456,-0.198235,0.072653,-0.545903,-0.355636,-0.106221,-0.492272,0.000581
openstack/kolla-ansible,I85f7bfd0aaa6f2d426ddb28950acbbca9d385aac,1,1,0.5122,4.1271,0.0984,7,11.14,611,0,Bug Fix,0,0,0,328,0.01573,0.5714,0,0.2927,4,4,0,0.6383,2.2512,2.86,48.02,13.18,0,0,0.4918,1,9.8548,0,6,0,7,0,"ovn-db: Add OVN_NB_DB and OVN_SB_DB env variables

It will make running ovn-nbctl and ovn-sbctl working on all
nodes irrespective of their cluster role.

Excerpt from ovn-nbctl:

--db database
    The  OVSDB database remote to contact. If the OVN_NB_DB en‚Äê
    vironment variable is set, its value is  used  as  the  de‚Äê
    fault.  Otherwise,  the default is unix:/ovnnb_db.sock, but
    this default is unlikely to be useful outside of single-ma‚Äê
    chine OVN test environments.

Closes-Bug: #2116313
[SEP]
FILES CHANGED:
releasenotes/notes/ovn-env-variables-b622b4c53ee275f4.yaml (+6, -0)
tests/run.yml (+1, -0)
ansible/roles/ovn-db/defaults/main.yml (+7, -0)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+6, -2)
tests/test-ovn.sh (+25, -4)
ansible/roles/ovn-db/handlers/main.yml (+3, -0)
doc/source/reference/networking/neutron.rst (+7, -0)
",-2.779458,-0.111311,0.912643,0.228693,0.495573,0.037441,-0.382809,0.402974,0.122827,-0.502489,0.584334,-0.145533,-0.222873,-0.159802,0.167521
openstack/kayobe,I29c0c6bf77e919940c3452b1f5d219462552cdff,1,1,0.6444,2.1972,0.0,2,5.57,393,0,Bug Fix,0,0,0,45,0.064194,0.0,0,0.0,4,2,0,0.9048,0.8113,3.0,8.12,15.56,0,0,0.0,1,43.6667,0,6,0,13,0,"public-openrc: avoid duplicate OS_CACERT

Skip the admin OS_CACERT line when rendering public-openrc.
Recent change [1] introduced that.
It occurs only when both admin and public cacert variables are set.

[1] https://review.opendev.org/c/openstack/kayobe/+/949624

Closes-Bug: #2116318
[SEP]
FILES CHANGED:
ansible/roles/public-openrc/templates/public-openrc.sh.j2 (+2, -0)
releasenotes/notes/bug-2116318-44f0c022cde1e686.yaml (+6, -0)
",-1.036743,0.652888,-0.775068,-0.04328,-0.755892,0.086325,-0.135138,0.22173,0.17907,0.201608,0.264878,-0.643866,0.347193,-0.017373,-0.162092
openstack/openstack-ansible-os_skyline,Ida475087736984a2f9237d3c7b1a509166d3a623,1,1,0.9596,1.7918,0.0,2,7.56,575,0,Bug Fix,0,0,0,223,0.057341,0.9412,0,0.9032,2,2,0,1.0,0.7219,1.5,22.5,12.43,0,0,0.0,1,95.8333,0,8,0,7,0,"Disable Peer verification for the proxy

Proxy module does attempt to verify if service does contain the
host name of the peer in destination CNs/SAN [1].

At the moment we disable the check, as leaving it in place might
have an unexpected impact on deployments with user-provided
certificates which needs to be re-issued to add management_address
to CNs.

[1] https://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslproxycheckpeername

Closes-Bug: #2115487
[SEP]
FILES CHANGED:
releasenotes/notes/skyline_tls_scenario-b74769614d94b0df.yaml (+4, -0)
vars/main.yml (+1, -0)
",-1.201742,-0.721804,0.202262,0.10789,-0.5511,-0.282737,0.196037,0.403237,0.441093,0.28444,-0.062949,-0.48323,-0.012802,-0.212638,-0.37051
openstack/openstack-ansible-os_octavia,I358d11a7a0b82b2ed9c6aeaf4650a17e878fe25d,1,1,0.9598,2.1972,0.5,1,10.25,343,0,Bug Fix,0,0,0,224,0.057524,0.9437,0,0.9057,1,1,0,0.875,0.0,1.0,14.85,15.81,0,0,0.0,0,38.1111,0,6,0,15,0,"Add default values to environment lookups

Some deployments may not have an expected env vars defined,
which may lead to unexpected failures.

In order to prevent that, let's add defaults to env lookup

Closes-Bug: #2116312
[SEP]
FILES CHANGED:
defaults/main.yml (+4, -4)
",0.18278,-1.699313,-0.650341,0.297221,-0.164203,0.451725,-0.294177,-0.762265,0.193801,0.430068,-0.374368,-0.212163,0.368703,-0.422614,-0.251024
openstack/kolla-ansible,Ia4be3c25148be1b6455073b3bf6929bc31fe695c,0,0,0.5137,6.4457,0.4134,44,6.5,145,0,Feature,0,0,0,329,0.015732,0.4762,0,0.2446,6,4,0,0.6388,2.9776,4.75,5.01,21.06,0,0,0.0,1,0.2302,0,0,0,0,0,"fluentd: Split out to a separate role
[SEP]
FILES CHANGED:
ansible/roles/fluentd/tasks/stop.yml (+6, -0)
ansible/roles/fluentd/templates/conf/input/01-syslog.conf.j2 (+0, -0)
ansible/roles/fluentd/defaults/main.yml (+147, -0)
ansible/roles/fluentd/templates/conf/input/12-systemd.conf.j2 (+0, -0)
ansible/roles/fluentd/filter_plugins/kolla_common_filters.py (+0, -0)
ansible/roles/fluentd/templates/conf/input/08-prometheus.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/format/wsgi_access.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/filter/02-parser.conf.j2 (+0, -0)
ansible/site.yml (+14, -1)
ansible/roles/fluentd/tasks/config.yml (+130, -0)
ansible/roles/fluentd/tasks/deploy.yml (+9, -0)
ansible/roles/fluentd/tasks/reconfigure.yml (+2, -0)
ansible/roles/fluentd/templates/conf/input/00-global.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/input/11-letsencrypt.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/output/00-local.conf.j2 (+0, -0)
ansible/roles/fluentd/tasks/config_validate.yml (+1, -0)
ansible/roles/fluentd/vars/main.yml (+2, -0)
ansible/roles/fluentd/tasks/deploy-containers.yml (+2, -0)
ansible/roles/fluentd/templates/conf/filter/00-record_transformer.conf.j2 (+0, -0)
ansible/roles/fluentd/tasks/check.yml (+4, -0)
ansible/roles/common/defaults/main.yml (+0, -140)
ansible/roles/fluentd/tasks/bootstrap.yml (+1, -0)
ansible/roles/fluentd/templates/conf/output/01-es.conf.j2 (+0, -0)
ansible/roles/common/tasks/config.yml (+0, -104)
ansible/roles/fluentd/tasks/copy-certs.yml (+6, -0)
ansible/roles/fluentd/tasks/pull.yml (+3, -0)
ansible/roles/fluentd/templates/conf/input/13-uwsgi.conf.j2 (+0, -0)
releasenotes/notes/fluentd-break-out-role-1e5306dac1c41583.yaml (+5, -0)
ansible/roles/fluentd/tasks/upgrade.yml (+7, -0)
ansible/roles/fluentd/templates/conf/input/02-mariadb.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/fluentd.json.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/format/apache_access.conf.j2 (+0, -0)
ansible/roles/fluentd/handlers/main.yml (+14, -0)
ansible/roles/fluentd/tasks/precheck.yml (+6, -0)
ansible/roles/fluentd/tasks/main.yml (+2, -0)
ansible/roles/fluentd/templates/conf/input/03-rabbitmq.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/input/10-openvswitch.conf.j2 (+0, -1)
ansible/roles/fluentd/tasks/check-containers.yml (+3, -0)
ansible/roles/fluentd/templates/fluentd.conf.j2 (+0, -0)
ansible/roles/common/handlers/main.yml (+0, -14)
ansible/roles/fluentd/templates/conf/input/05-libvirt.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/filter/01-rewrite.conf.j2 (+5, -0)
ansible/roles/fluentd/templates/conf/input/04-openstack-wsgi.conf.j2 (+0, -0)
ansible/roles/fluentd/templates/conf/output/03-opensearch.conf.j2 (+0, -0)
",3.06192,0.623633,1.970756,0.142602,-0.139499,0.572258,0.647038,-0.456399,-0.118948,0.205928,-0.18965,0.444738,-0.191592,0.505964,-0.082248
openstack/kayobe,Ie20f74a43bab9074b7207e4d70d1da56adb13e1a,1,0,0.83,2.0794,0.1429,2,3.5,206,0,Feature,0,0,0,100,0.071073,0.875,0,0.7262,2,2,0,0.9054,0.8631,1.0,9.91,10.92,0,0,0.0,1,25.75,0,0,0,0,0,"Bump MichaelRigart.interfaces to v1.15.6

This adds support for CentOS Stream 10 and Rocky Linux 10.
[SEP]
FILES CHANGED:
releasenotes/notes/bump-michaelrigart.interfaces-1.15.6-c5a85320e5b3f4e3.yaml (+5, -0)
requirements.yml (+1, -1)
",1.521787,0.025149,-0.703715,-0.202675,-0.42678,0.432298,-0.045805,1.127581,-0.552363,0.869567,0.037255,0.601318,-0.701632,0.2202,-0.009644
openstack/kolla,I9d1f24b98f1d7c8f29b0dba45105b0263f961ca5,1,0,0.5121,4.4427,1.0,4,5.5,140,0,Doc,1,0,0,330,0.015319,0.75,0,0.3841,2,2,0,0.6301,1.9544,1.25,-21.78,27.65,0,0,1.0,0,1.6471,0,0,0,0,0,"CI: Drop publishing to DockerHub
[SEP]
FILES CHANGED:
.zuul.d/debian.yaml (+0, -26)
.zuul.d/base.yaml (+0, -26)
.zuul.d/ubuntu.yaml (+0, -14)
tests/playbooks/publish.yml (+0, -18)
",3.28728,1.368677,1.180018,0.094215,0.004268,0.737748,-0.094173,0.558763,-0.386251,0.276911,0.365668,-0.273192,0.914437,-0.014368,-0.451018
openstack/kolla-ansible,Ib99d38fa881c1e49c5dc5690f370ae723b63cdb3,1,0,0.5136,1.3863,0.0,1,4.67,158,0,CI,1,0,0,331,0.015306,0.7692,0,0.3951,1,1,0,0.638,0.0,1.0,8.73,19.01,0,0,1.0,0,39.5,0,0,0,0,0,"CI: Add tenks logs to check-logs.sh exception list
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -0)
",2.45389,0.64388,0.213197,0.090661,0.194149,-0.734378,0.094115,0.206593,-0.215121,-0.025755,-0.090679,-0.543286,0.21185,0.787996,-0.14822
openstack/kolla,Ia85f253ecaeaef63c17e75dc4a223e030dbbc58d,0,0,0.5151,3.8501,0.0,2,7.5,160,0,Feature,0,0,0,332,0.01535,0.0,0,0.0,2,2,0,0.631,0.1511,2.0,-3.82,16.33,1,0,0.0,0,3.4043,0,0,0,0,0,"Add httpd image for OIDC/SAML frontend in uWSGI case
[SEP]
FILES CHANGED:
docker/httpd/Dockerfile.j2 (+45, -0)
docker/httpd/extend_start.sh (+1, -0)
",2.140455,0.013368,1.110053,-0.124095,0.678945,-0.732708,0.030441,1.260436,-0.193209,-0.246413,-0.521885,-0.190473,-0.044815,-0.569277,0.240631
openstack/kolla-ansible,I9e09db63b027f3c88f9755c728aa2fb477b9d23b,1,0,0.5135,1.3863,0.3333,1,5.5,149,0,CI,1,0,0,333,0.015363,0.6667,0,0.3423,1,1,0,0.6384,0.0,1.0,-29.47,24.02,0,0,1.0,0,37.25,0,0,0,0,0,"CI: Disable failing dns_integration check
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+2, -1)
",1.455883,1.573135,0.496773,0.73594,1.750554,0.512151,-0.791494,-0.423537,0.393019,-0.182645,0.666693,-0.697708,-0.000703,-0.497422,0.274545
openstack/kolla,Icc2fe528956a0fb47dd66344d414c81212705480,0,0,0.515,1.3863,0.0,1,4.25,236,0,Feature,0,0,0,334,0.015407,0.0,0,0.0,3,1,0,0.6294,0.0,3.0,-76.16,22.88,1,0,0.0,0,59.0,0,0,0,0,0,"masakari: Ensure log files are owned by masakari user

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/954903
[SEP]
FILES CHANGED:
docker/masakari/masakari-base/extend_start.sh (+3, -0)
",-0.526811,3.151858,-2.005044,0.024098,-0.904896,0.174195,-0.072622,-0.427255,-0.139936,-0.756733,-0.498386,0.100879,0.096156,-0.471481,-0.219567
openstack/kolla,I4567aaf352f1f590af2fa7d067768799adad64d1,0,0,0.5134,1.3863,0.0,1,7.5,153,0,Feature,0,0,0,335,0.015451,0.0,0,0.0,3,1,0,0.6278,0.0,3.0,-3.82,16.33,1,0,0.0,0,38.25,0,0,0,0,0,"heat: Ensure log files are owned by heat user
[SEP]
FILES CHANGED:
docker/heat/heat-base/extend_start.sh (+3, -0)
",2.479423,0.625369,0.617079,0.856127,0.864074,0.332381,0.483755,-0.324993,0.197777,-0.200608,0.051147,-0.104588,0.37832,0.049074,-0.771796
openstack/kolla-ansible,I201008d73c5a9a6404a8e386a281bd3bf378f65a,1,0,0.5119,1.3863,0.0,1,11.5,208,0,CI,1,0,0,336,0.015495,0.7857,0,0.4022,1,1,0,0.6389,0.0,1.0,18.61,16.77,0,0,1.0,0,52.0,0,0,0,0,0,"CI: Exclude hacluster logs in fluentd checks

We're not parsing those and masakari jobs fail on this
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -0)
",2.954978,-0.604636,0.420908,-0.26086,-0.30728,0.009133,0.618391,-0.673463,-0.907368,-0.523667,0.247124,-0.17509,0.273707,-0.412408,-0.260309
openstack/kolla-ansible,Iba337f82004573508a74d7837e60c10efa5c7993,1,1,0.5134,1.0986,0.0,1,8.5,188,0,Bug Fix,0,0,0,337,0.015539,0.0,0,0.0,4,1,0,0.6393,0.0,4.0,-10.8,22.22,0,0,0.0,0,62.6667,0,6,0,6,0,"neutron: Do not run netns-cleanup when wrappers are enabled

Closes-Bug: #2116900
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron-l3-agent-wrapper.sh.j2 (+2, -0)
",1.530012,-0.410535,-0.77603,-0.61889,-0.334947,0.255971,-0.840012,-0.205977,-0.381192,-0.436689,0.618398,-0.23136,0.130985,-0.234644,0.218834
openstack/kolla-ansible,Ia74c7d1e78e9d756a83c8adc7d9d8d9adb371751,0,0,0.5148,5.8435,0.3314,73,13.25,394,0,Feature,0,0,0,338,0.015584,0.4545,0,0.234,4,4,0,0.6398,3.3586,3.92,32.17,16.62,0,0,0.0,1,1.142,0,0,0,0,0,"Split out cron to a separate role

We've split out fluentd to move it earlier in the
deployment workflow - cron and kolla-toolbox are currently
the only components in common role.

Splitting it out will help with limiting kolla-ansible
to reconfigure only services managed by cron role.
[SEP]
FILES CHANGED:
ansible/roles/cron/templates/cron-logrotate-skyline.conf.j2 (+0, -0)
ansible/roles/cron/tasks/stop.yml (+6, -0)
ansible/roles/cron/templates/cron-logrotate-manila.conf.j2 (+0, -0)
ansible/site.yml (+14, -1)
ansible/roles/cron/tasks/precheck.yml (+6, -0)
ansible/roles/cron/tasks/check-containers.yml (+3, -0)
ansible/roles/cron/tasks/copy-certs.yml (+6, -0)
ansible/roles/cron/templates/cron-logrotate-global.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-fluentd.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-octavia.conf.j2 (+0, -0)
doc/source/contributor/adding-a-new-service.rst (+3, -3)
ansible/roles/cron/templates/cron-logrotate-etcd.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-placement.conf.j2 (+0, -0)
ansible/roles/cron/tasks/pull.yml (+3, -0)
ansible/roles/cron/tasks/reconfigure.yml (+2, -0)
ansible/roles/cron/templates/cron-logrotate-heat.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-zun.conf.j2 (+0, -0)
ansible/roles/common/tasks/config.yml (+1, -70)
ansible/roles/cron/handlers/main.yml (+14, -0)
ansible/roles/cron/templates/cron-logrotate-glance.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-openvswitch.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-letsencrypt.conf.j2 (+0, -0)
ansible/roles/cron/vars/main.yml (+2, -0)
ansible/roles/cron/templates/cron-logrotate-venus.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-opensearch.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-masakari.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-mariadb.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-ironic.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-hacluster.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-swift.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-trove.conf.j2 (+0, -0)
ansible/roles/common/handlers/main.yml (+0, -14)
ansible/roles/cron/templates/cron-logrotate-aodh.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-grafana.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-haproxy.conf.j2 (+0, -0)
ansible/roles/cron/tasks/upgrade.yml (+7, -0)
ansible/roles/cron/templates/cron-logrotate-cyborg.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-redis.conf.j2 (+0, -0)
releasenotes/notes/cron-break-out-role-fa72289cc100ef53.yaml (+5, -0)
ansible/roles/cron/templates/cron-logrotate-prometheus.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-gnocchi.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-tacker.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-proxysql.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-cinder.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-designate.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-watcher.conf.j2 (+0, -0)
ansible/roles/cron/tasks/config_validate.yml (+1, -0)
ansible/roles/cron/templates/cron-logrotate-influxdb.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-cloudkitty.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-nova-libvirt.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-neutron.conf.j2 (+0, -0)
ansible/roles/cron/tasks/config.yml (+101, -0)
ansible/roles/cron/templates/cron-logrotate-blazar.conf.j2 (+0, -0)
ansible/roles/cron/tasks/check.yml (+4, -0)
ansible/roles/common/defaults/main.yml (+0, -26)
ansible/roles/cron/templates/cron-logrotate-ceilometer.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-glance-tls-proxy.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-mistral.conf.j2 (+0, -0)
ansible/roles/cron/tasks/bootstrap.yml (+1, -0)
ansible/roles/cron/defaults/main.yml (+38, -0)
ansible/roles/cron/templates/cron-logrotate-keystone.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron.json.j2 (+0, -0)
ansible/roles/cron/tasks/main.yml (+2, -0)
ansible/roles/cron/templates/cron-logrotate-nova.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-magnum.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-rabbitmq.conf.j2 (+0, -0)
ansible/roles/cron/tasks/deploy.yml (+9, -0)
ansible/roles/cron/templates/cron-logrotate-ansible.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-horizon.conf.j2 (+0, -0)
ansible/roles/cron/tasks/deploy-containers.yml (+2, -0)
ansible/roles/cron/templates/cron-logrotate-barbican.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-kuryr.conf.j2 (+0, -0)
ansible/roles/cron/templates/cron-logrotate-collectd.conf.j2 (+0, -0)
",0.835053,-1.232541,0.297755,0.416922,-0.267367,-0.496984,0.977754,0.043499,-0.491734,-0.59932,-0.234528,0.224497,-0.132199,0.18206,0.21977
openstack/openstack-ansible-os_cinder,Iaa604a3a1f59360bf0a8b4b67059f2e5396cf0b8,1,0,0.96,1.9459,0.5,1,5.17,335,0,CI,0,0,0,225,0.057663,0.9444,0,0.9067,1,1,0,1.0,0.0,1.0,-14.0,14.97,0,0,0.0,0,47.8571,0,0,0,0,0,"Remove project_id from Cinder endpoint

This is no longer needed with going away from old versioned
endpoints. Simmilar was implemented for devstack [1]

[1] https://review.opendev.org/c/openstack/devstack/+/930011
[SEP]
FILES CHANGED:
defaults/main.yml (+3, -3)
",0.609434,1.154279,-0.553462,0.064276,-1.031434,0.173922,0.478871,0.234181,-0.164396,0.117331,-0.395481,-0.377948,-0.22752,-0.422685,-0.218826
openstack/kolla-ansible,I4df0d520546da141cafc15e9464149059fdc06a6,1,0,0.5133,2.9444,0.5,5,9.5,192,0,Feature,0,0,0,339,0.015386,0.8,0,0.4106,4,2,0,0.639,2.1972,1.6,-3.18,16.43,0,0,0.3333,0,10.1053,0,0,0,0,0,"Remove egrep usage from scripts

egrep: warning: egrep is obsolescent; using grep -E
[SEP]
FILES CHANGED:
ansible/roles/container-engine-migration/files/ce-cleanup.sh (+1, -1)
tests/check-logs.sh (+3, -3)
tools/cleanup-containers (+2, -2)
tools/diag (+2, -2)
tools/pre-commit-hook (+1, -1)
",0.637203,0.110721,-0.849039,0.218958,0.61934,0.194359,-0.796061,-0.726557,-0.593816,-0.183051,0.475222,-0.109674,0.42314,0.030364,-0.189498
openstack/openstack-ansible,I48fce052952f7296fc7a57e5f9fc66add18f05f0,1,0,0.9602,4.7185,0.036,3,2.8,242,0,CI,1,0,0,226,0.05783,0.5,0,0.4801,1,1,0,0.94,1.0208,1.0,-146.49,23.98,1,0,1.0,1,2.1607,0,0,0,0,0,"Add RockyLinux 10 to CI testing

Depends-On: https://review.opendev.org/c/openstack/ansible-role-systemd_networkd/+/962044
[SEP]
FILES CHANGED:
zuul.d/project-templates.yaml (+23, -0)
zuul.d/nodesets.yaml (+6, -0)
zuul.d/jobs.yaml (+78, -4)
",0.587271,3.196872,-1.325721,-0.38666,-1.277416,-0.030705,0.192511,-0.016944,0.170261,-1.139315,-1.064091,0.241929,0.086066,-0.284578,0.13904
openstack/kolla-ansible,I58219d2a3edbb83ef52d8d123b188429642dc1a3,1,1,0.5147,2.1972,0.0,3,10.0,270,0,Bug Fix,0,0,0,340,0.015419,0.2778,0,0.143,2,2,0,0.6394,1.0613,2.0,13.39,16.0,1,0,0.0,1,30.0,0,6,0,25,0,"Add network group to tls-backend

In case of a deployment utilising network nodes the backend TLS
configuration is missing on network nodes.

Closes-Bug: #2117084
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+1, -0)
releasenotes/notes/bug-2117084-60fbff1b0616531d.yaml (+6, -0)
ansible/inventory/all-in-one (+1, -0)
",1.517595,-1.06842,-0.082208,0.186774,-0.091482,0.032085,-0.258565,0.504173,0.419361,-0.286419,-0.329298,0.122073,-0.013364,-0.181599,0.391788
openstack/kayobe,Ie5247cbcc81388d67707b0772ae00fda8ab7262b,1,1,0.5161,2.0794,0.0,2,10.0,270,0,Bug Fix,0,0,0,341,0.015459,0.0,0,0.0,4,2,0,0.906,0.5917,3.0,16.21,16.0,1,0,0.0,1,33.75,0,6,0,25,0,"Add network group to tls-backend

In case of a deployment utilising network nodes the backend TLS
configuration is missing on network nodes.

Closes-Bug: #2117084
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/overcloud-components.j2 (+1, -0)
releasenotes/notes/bug-2117084-8d1eaa375df1d1f8.yaml (+6, -0)
",1.517595,-1.06842,-0.082208,0.186774,-0.091482,0.032085,-0.258565,0.504173,0.419361,-0.286419,-0.329298,0.122073,-0.013364,-0.181599,0.391788
openstack/kolla-ansible,I1f4839676b4f794bb93f1372aa16f8377ae9b269,0,0,0.5175,3.4012,0.4828,2,17.0,522,0,CI,0,0,0,342,0.015499,0.5122,0,0.2651,1,2,0,0.6399,0.2164,1.0,34.07,16.21,0,0,0.0345,1,17.4,0,0,0,0,0,"Move OpenSearch role right after loadbalancer

After fluentd CI log checks have been implemented, in the only scenario
that deploys log management stack (prometheus-opensearch) we're seeing
issues that fluentd is not reconnecting to OpenSearch deployed late in
the workflow.
It's not reconnecting fast enough, and if the connection is not there,
fluentd is not parsing/opening log files - which we're checking for.
[SEP]
FILES CHANGED:
ansible/site.yml (+14, -14)
zuul.d/base.yaml (+1, -0)
",-0.319068,-2.184347,0.478116,0.11844,-0.484551,-0.548452,0.627968,0.066034,-0.625678,-0.083568,0.021889,-0.151976,0.114418,-0.008853,0.310669
openstack/kolla,I92af980a4fd63540297b6bde0d52b2dfd02f72ce,1,1,0.2,1.0986,0.5,1,11.5,245,0,Bug Fix,0,0,0,10,0.060976,0.0,0,0.0,2,1,0,0.6263,0.0,2.0,-14.5,20.25,0,1,0.0,0,81.6667,0,6,0,4,0,"[base/rhel] Disable docker-ce repository in base file

Enabling repo should be handled by enable_extra_repos macro

Closes-bug: #2117249
[SEP]
FILES CHANGED:
docker/base/docker-ce.repo (+1, -1)
",0.640864,-0.462932,-0.813701,-0.638113,-0.16197,0.057584,-0.971594,0.201208,-0.238246,-0.493023,-0.033687,-0.510628,-0.247718,-0.15372,-0.174119
openstack/sunbeam-charms,I4102b2c12fcbf2fe19a29cf57bc369f15fa451d2,1,0,1.0,2.8904,0.6471,3,16.67,657,0,Bug Fix,0,0,0,2,0.181818,1.0,0,1.0,6,1,0,1.0,0.978,4.0,39.33,13.47,1,0,0.0,0,36.5,0,0,0,0,0,"Fix trusted dashboard relation

This change has a number of fixes:

* Do not call clear() in relation broken hook. This can lead to access
denied error given that in relation broken we no longer have access to
the data bag
* Set the trusted dashboard URL regardless of whether or not the remote
end sets any provider. There is no reason to condition the availability
of trusted dashboard on the availability of federated providers.
* Account for the case when TLS is enabled after providers are added and
update the dashboard url.
[SEP]
FILES CHANGED:
charms/horizon-k8s/src/charm.py (+5, -8)
charms/horizon-k8s/lib/charms/horizon_k8s/v0/trusted_dashboard.py (+0, -1)
charms/keystone-k8s/src/charm.py (+1, -2)
",-0.635288,-2.05056,0.810468,0.452717,-0.074409,-0.126451,0.442606,-0.189593,0.203321,0.186492,-0.069827,-0.151309,0.273857,-0.040624,-0.136191
openstack/kolla,I3a0aa82d0903b341156c2fce68393cc4031e7728,1,0,0.6522,1.6094,0.5,1,2.18,273,0,Feature,0,0,0,46,0.06488,0.6667,0,0.4348,2,1,0,0.6272,0.0,2.0,3.7,14.21,0,0,0.0,0,54.6,0,0,0,0,0,"change erlang arm64 repo to rhel based

centos stream diverged too much
nothing provides libcrypto.so.3(OPENSSL_3.4.0)(64bit)
needed by erlang-26.2.5.14-1.el9.aarch64
[SEP]
FILES CHANGED:
docker/base/copr-rabbitmq-erlang.repo (+2, -2)
",0.806213,-0.911647,-0.532819,-1.21336,-0.325031,-0.571033,-0.082546,0.890029,-0.326714,0.473515,-0.540284,-0.311927,-0.700501,0.49511,0.18948
openstack/kolla,Idf35af1b776d0e908fd328f0ec5eb825f1f2ca9c,1,0,0.6596,1.3863,0.3333,1,11.0,198,0,CI,1,0,1,47,0.065919,0.6094,1,0.4019,0,1,0,0.6281,0.0,0.0,14.93,17.13,0,0,1.0,0,49.5,0,0,0,0,0,"CI: Bump ansible-lint to <26

to be in sync with kolla-ansible
also add pin to ansible-core
[SEP]
FILES CHANGED:
test-requirements.txt (+2, -1)
",0.686668,0.508531,-1.048857,-0.011932,0.357184,-0.505237,-0.322336,-0.51904,-0.82408,-0.013911,0.108701,0.518848,-0.311062,-0.000468,0.009733
openstack/octavia,I9c287b5d666e283736773ef2c2eb441c079a2ba6,1,0,0.5081,3.7612,1.0,2,8.33,416,0,Feature,0,0,0,124,0.004318,0.6667,0,0.3387,4,1,0,0.6117,0.9852,3.0,20.72,14.53,0,0,0.4286,0,9.6744,0,0,0,0,0,"Remove duplicate policy file format check

A patch [1] added a common check for the oslo policy file format,
however the existing check was not removed.
This patch removes the check that was existing in octavia-status in
favor of the common check.

[1] https://review.opendev.org/c/openstack/octavia/+/764578
[SEP]
FILES CHANGED:
octavia/cmd/status.py (+0, -24)
octavia/tests/unit/cmd/test_status.py (+0, -18)
",-0.492924,0.505873,-0.383843,0.606789,-0.921697,0.169941,0.930446,0.020737,0.315552,0.059877,0.233787,0.11092,-0.10865,0.032856,-0.069103
openstack/kolla-ansible,I86eb058f88b49fcbbc4e219d5329aa6f0a339b95,1,1,0.7,2.7081,0.2143,2,4.0,378,0,Bug Fix,0,0,0,10,0.030488,0.75,0,0.525,4,2,0,0.6391,1.0,3.0,3.03,12.71,1,0,0.0,1,25.2,0,16,0,12,0,"Tweak RabbitMQ version check to allow 3.13 to 4.1

Since RabbitMQ 4.1 supports the upgrade from 3.13 [1],
the assert condition and ``upgrade_version`` was adjusted accordingly.

[1] https://www.rabbitmq.com/docs/upgrade#rabbitmq-version-upgradability

Closes-Bug: #2118452
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+4, -3)
releasenotes/notes/allow-rabbitmq-3-13-to-4-1-8ae08d265c353301.yaml (+7, -0)
",-0.986937,0.949464,-0.633676,0.440288,-0.282157,0.235556,-0.2537,0.657659,0.207241,0.989858,-0.114435,-0.239803,-0.50997,-0.116813,0.287994
openstack/ironic,I0124e9df57783326fcb2e95a38cb2f205d3f64c0,1,1,1.0,4.0943,0.0508,4,7.0,341,0,Bug Fix,0,0,0,6,0.125,0.0,0,0.0,7,2,0,0.9586,1.9089,5.25,16.03,16.51,0,0,0.5763,1,5.6833,0,6,0,4,0,"Fix inspection IB port client-id

Currently, while IPA still reports the client-id correctly,
existing ports are not getting updated with the client id.

Closes-Bug: 2118579
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/inspector/hooks/test_ports.py (+13, -1)
releasenotes/notes/fix-ipa-IB-client-id-56ac2dd8a37371de.yaml (+7, -0)
ironic/drivers/modules/inspector/hooks/ports.py (+17, -1)
ironic/tests/unit/drivers/modules/inspector/hooks/test_validate_interfaces.py (+19, -1)
",0.884418,-1.113458,-0.269405,0.006385,-0.451712,0.485843,-0.582468,-0.242708,0.19558,-0.330568,-0.014168,0.205368,0.257778,0.115134,0.099924
openstack/ansible-collection-kolla,If1ba49e23e1b3acc57bcc6313a8688f29fce4e37,0,0,1.0,2.9444,0.1111,3,12.33,324,0,Doc,0,0,0,2,0.028169,0.5,0,0.5,3,2,0,0.4286,1.3516,2.67,2.25,16.83,1,0,0.0,1,17.0526,0,0,0,0,0,"feat: install registry `CA` if registry is secure

Provide more control over install the registry `CA` by adding an
additional conditional using the existing `_registry_insecure` variable
for either `Podman` or `Docker`.
[SEP]
FILES CHANGED:
roles/podman/tasks/config.yml (+2, -0)
roles/docker/tasks/config.yml (+8, -2)
releasenotes/notes/improve-container-registry-ca-conditional-0247b0014379ba82.yaml (+6, -0)
",0.28894,0.198126,-0.424689,0.950042,0.779078,0.257177,-0.581704,-0.235079,0.506566,-0.378985,-0.673662,-0.119205,-0.276907,-0.496338,-0.10783
openstack/ironic,Ia57902a9095b78e0128a728693c03e0a01c6421b,1,1,1.0,3.4965,0.0,3,9.0,329,0,Bug Fix,0,0,0,7,0.08642,0.0,0,0.0,7,2,0,0.9589,1.0141,4.67,-9.1,20.27,1,0,0.75,1,9.9697,0,6,0,4,0,"Orphaned accelerators after devices removed

Fixes the issue that when accelerator devices were
removed from node, a re-introspection does not remove
previous accelerator device information from the node.

Closes-Bug: 2118958
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/inspector/hooks/test_accelerators.py (+24, -0)
releasenotes/notes/clean-removed-accelerators-0c67ace5990c2ac3.yaml (+6, -0)
ironic/drivers/modules/inspector/hooks/accelerators.py (+2, -0)
",0.722988,-1.169425,-0.324081,0.405275,-0.0199,0.614889,-0.205075,-0.315086,0.240946,-0.509269,-0.042208,0.108835,0.126112,0.059295,0.135027
openstack/kolla-ansible,I91a5f9c4b0e3c40ef21c25fb4866b07e25fbc017,1,1,0.7273,2.8904,0.0588,3,7.3,707,0,Bug Fix,0,0,0,11,0.032164,0.8,0,0.5818,4,3,0,0.6395,1.3328,2.33,0.09,13.33,1,0,0.5882,1,39.2778,0,6,0,8,0,"Fix RabbitMQ version check always getting skipped

Refactoring kolla_container_facts.py [1] caused breaking change because
of result output structure was changed.
Therefore the condition for the version check block always become false
(``container_facts[service.container_name]`` is always undefined).

Fixing this issue by matching the new kolla_container_facts result
structure.

Additionally, added assertions in tests for ``kolla_container_facts`` to
ensure the container fact result is not in old structure.

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/911505

Closes-Bug: #2102662
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+1, -1)
releasenotes/notes/fix-rabbitmq-version-check-condition-59528341299bab89.yaml (+5, -0)
tests/test_kolla_container_facts.py (+10, -0)
",-1.642655,-0.081496,0.960851,-0.501535,-0.442765,-0.00296,-0.192002,0.097488,0.309255,-0.245783,-0.010342,-0.44567,-0.476532,-0.060884,-0.16414
openstack/sushy,I75e4b4b552172fb33b06e2d404ddd53b5813b916,1,0,1.0,4.0775,0.0172,3,11.0,354,0,Feature,0,0,0,4,0.012121,0.0,0,0.0,3,2,0,1.0,0.9908,2.0,30.32,16.22,1,0,0.7759,1,6.0,0,0,0,0,0,"Improve handling of empty-string eTags.

This change enables sushy to disregard empty string eTags that may be
returned by the BMC, avoiding potential HTTP 412 precondition fail
errors when attempting to use empty string eTags in subsequent requests.
[SEP]
FILES CHANGED:
releasenotes/notes/ignore-empty-string-etags-ee44617d7b0f72ce.yaml (+6, -0)
sushy/connector.py (+6, -1)
sushy/tests/unit/test_connector.py (+45, -0)
",-0.159386,-1.043818,-0.49823,0.708101,0.391399,0.290338,-0.586546,-0.64047,0.363273,0.14602,-0.326543,0.342393,0.374706,-0.539566,0.037281
openstack/kolla-ansible,I1aeb8a11901c40952d44598e50d17325a3ec6cb8,1,0,0.6667,1.0986,0.5,1,6.0,145,0,Doc,1,0,0,48,0.067039,0.4211,0,0.2807,1,1,0,0.64,0.0,1.0,-31.9,22.4,0,0,1.0,0,48.3333,0,0,0,0,0,"CI: Use opendev docker registry mirror
[SEP]
FILES CHANGED:
tests/setup_gate.sh (+1, -1)
",3.276633,0.889562,0.72643,0.110142,0.766324,-0.089526,0.118271,0.761493,-0.71453,-0.469115,0.447,-0.194003,0.285325,-0.53724,-0.268396
openstack/kolla-ansible,I9bacfa953aee8c8f79a5a65c457990a0de9f1dc9,0,0,0.6735,1.7918,0.0,1,2.36,269,0,Doc,1,0,0,49,0.068245,0.4146,0,0.2792,2,1,0,0.6404,0.0,2.0,15.71,10.18,0,0,1.0,0,44.8333,0,0,0,0,0,"CI: Pin docker to 28.3.2

28.3.3 introduced error in CI builds [1],
28.3.2 is last known working version.

[1] https://paste.opendev.org/raw/bH2016mvIOO6hgZTWbI9/
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+5, -0)
",0.023537,0.722141,-1.26269,-0.558009,-0.825581,0.147591,0.437903,0.601635,-0.295876,1.096698,-0.433979,-0.699667,-0.192095,0.406911,0.137272
openstack/kolla-ansible,I516eb2cd967b4d5112fabe77f79cbf3421ec3318,1,1,0.75,2.3026,0.0,2,8.5,506,0,Bug Fix,0,0,0,12,0.033426,0.8571,0,0.6429,4,2,0,0.6397,0.7642,3.0,-10.8,13.6,1,0,0.0,1,50.6,0,10,0,7,0,"Only add OIDCXForwardedHeaders when variable is set

Currently the option OIDCXForwardedHeaders is added to
wsgi-keystone.conf even when
``keystone_federation_oidc_forwarded_headers`` is empty.
However, OIDCXForwardedHeaders cannot be used with empty value.
This change fixes it by adding length check to the value of the
variable ``keystone_federation_oidc_forwarded_headers``.

Closes-Bug: #2119344
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+2, -0)
releasenotes/notes/fix-oidc-x-forwarded-headers-option-edb945bfcb98c691.yaml (+7, -0)
",-2.764771,1.179872,-0.589008,1.20471,1.282249,0.50666,-1.033774,0.08181,0.701558,-0.148556,0.402467,-0.368251,-0.361065,-0.226447,0.260404
openstack/kayobe,I9c3b78cfba1676d75f829cd5bd5b5dc05fd52dbc,0,0,0.6667,3.8286,0.0,5,11.75,375,0,Feature,0,0,0,3,0.033708,1.0,0,0.6667,2,4,0,0.9067,2.0631,1.4,38.31,14.91,1,0,0.0,1,8.1522,1,0,0,0,0,"feat: add command to view passwords

Quality of life improvement to make viewing the contents of
`kolla/passwords.yml` with the introduction of a kayobe command that
removes the need to provide an absolute or relative path to the
`ansible-vault` encrypted passwords file.
[SEP]
FILES CHANGED:
doc/source/usage.rst (+10, -0)
kayobe/cli/commands.py (+8, -0)
kayobe/vault.py (+19, -0)
setup.cfg (+3, -0)
releasenotes/notes/add-passwords-view-command-2f55d83dca037e3d.yaml (+5, -0)
",-0.614574,-0.788107,-0.478412,0.606068,0.117126,-0.351568,-0.274634,-0.011985,0.474441,-0.221619,-0.612269,0.235669,-0.12016,0.07701,0.009809
openstack/kolla,I7a2f3fce223afd74741b40bf62836b325fca5b19,1,1,0.66,3.434,0.1667,2,8.73,787,1,Bug Fix,0,0,0,50,0.069156,0.75,0,0.495,2,1,0,0.6291,0.9183,2.0,29.66,12.66,0,0,0.6667,0,25.3871,0,6,0,12,0,"send empty X-Registry-Auth for anonymous pushes

Since Docker 28.3.3 the daemon rejects a push that carries no
`X-Registry-Auth` header [1]. The SDK already sets this header when it
finds credentials, so the breakage happens only on anonymous pushes.

During `PushTask.push_image()` we now check whether the SDK can resolve
credentials for the target registry; if it cannot, we inject
`auth_config={}`, causing the SDK to send the minimal ""{}"" header that
satisfies the daemon while leaving authenticated pushes unchanged.

Drop this addition when [2] is fixed.

[1] https://github.com/moby/moby/pull/50371
[2] https://github.com/docker/docker-py/issues/3348

Closes-Bug: #2119619
[SEP]
FILES CHANGED:
kolla/image/tasks.py (+10, -0)
kolla/tests/test_build.py (+15, -5)
",-2.296209,1.059417,1.207501,-0.042112,-0.474443,0.407697,0.100605,0.03021,0.136527,-0.019814,0.295868,-0.096736,0.034748,-0.083046,-0.18982
openstack/kolla,I913208b09771bc18ad3214d7518a837d762f6c33,1,0,0.6667,1.0986,0.5,1,9.0,179,0,Feature,0,0,0,51,0.067729,0.4286,1,0.2857,2,1,0,0.63,0.0,2.0,14.4,16.93,0,0,0.0,0,59.6667,0,0,0,0,0,"update debian release in support matrix

it was omitted in Caracal cycle
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+1, -1)
",2.567211,-0.982887,0.285156,-0.41686,-0.460036,0.303759,0.206101,0.138409,-0.627917,-0.441588,0.298718,0.616877,-0.598628,0.284507,-0.046499
openstack/kolla,Idd809f5efd2d308c1565d7635e67af0a431d18f7,1,0,0.516,5.1874,0.3708,13,3.25,216,0,Feature,0,0,0,343,0.015524,1.0,0,0.516,3,6,0,0.6309,2.8235,1.85,-115.34,22.84,1,0,0.5899,1,1.2067,0,0,0,0,0,"Move to Rocky Linux 10

Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/961237
[SEP]
FILES CHANGED:
doc/source/support_matrix.rst (+1, -1)
doc/source/contributor/versions.rst (+1, -1)
zuul.d/rocky.yaml (+61, -0)
doc/source/ceph_versions.csv (+1, -1)
kolla/template/repos.yaml (+4, -2)
tests/templates/template_overrides.j2 (+2, -17)
kolla/common/config.py (+2, -2)
kolla/image/unbuildable.py (+3, -1)
docker/base/Dockerfile.j2 (+6, -0)
releasenotes/notes/rocky-10-4111fa0160be14ab.yaml (+12, -0)
zuul.d/project.yaml (+1, -0)
zuul.d/nodesets.yaml (+18, -6)
docker/base/ci-rocky.repo (+0, -35)
",-0.434784,4.122418,-1.840564,-0.264255,-1.458458,0.195411,-0.131309,-0.461165,-0.102127,-0.813372,-0.841851,0.381719,0.161612,-0.112753,0.098974
openstack/kolla-ansible,I51823808c4e4ac08ae8f080aacf6a3759589571d,1,0,0.5174,5.2311,0.0914,25,6.2,565,0,Feature,0,0,0,344,0.015445,1.0,0,0.5174,4,4,0,0.6401,4.1361,2.56,2.69,14.09,1,0,0.7419,1,3.0214,0,0,0,0,0,"Move to for Rocky Linux 10

CephAdm, Octavia, OVN and NFV jobs are not added here, because these rely on
Valkey/Redis available.
Ironic jobs are not added, because ipxe.efi is not packaged in EL10 and needs
a followup patch.
Let's Encrypt jobs are also not added, due to ssl certificate validation
errors.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/956554
Depends-On: https://review.opendev.org/c/openstack/ansible-collection-kolla/+/961237
[SEP]
FILES CHANGED:
zuul.d/scenarios/skyline.yaml (+12, -0)
zuul.d/scenarios/prometheus-opensearch.yaml (+6, -0)
roles/cephadm/tasks/pkg_redhat.yml (+5, -2)
zuul.d/scenarios/kvm.yaml (+6, -0)
roles/cephadm/defaults/main.yml (+1, -1)
ansible/roles/fluentd/tasks/config.yml (+10, -0)
ansible/roles/prechecks/vars/main.yml (+1, -1)
zuul.d/scenarios/bifrost.yaml (+6, -0)
zuul.d/scenarios/mariadb.yaml (+6, -0)
ansible/roles/hacluster/templates/hacluster-pacemaker-remote.json.j2 (+2, -1)
doc/source/user/quickstart-development.rst (+1, -1)
zuul.d/nodesets.yaml (+44, -0)
zuul.d/scenarios/magnum.yaml (+6, -0)
ansible/group_vars/all/common.yml (+2, -2)
doc/source/user/quickstart.rst (+1, -1)
zuul.d/scenarios/cells.yaml (+6, -0)
zuul.d/scenarios/telemetry.yaml (+6, -0)
zuul.d/scenarios/ipv6.yaml (+6, -0)
zuul.d/scenarios/masakari.yaml (+6, -0)
doc/source/admin/mariadb-backup-and-restore.rst (+3, -3)
doc/source/user/support-matrix.rst (+4, -4)
zuul.d/scenarios/aio.yaml (+16, -0)
zuul.d/scenarios/hashi-vault.yaml (+6, -0)
doc/source/reference/networking/octavia.rst (+1, -1)
zuul.d/scenarios/haproxy-fqdn.yaml (+6, -0)
",-2.312426,1.870818,-0.014548,0.020087,-0.483123,-0.075335,0.186877,0.039663,-0.389597,-0.142368,0.129303,-0.0912,0.28472,-0.298971,-0.119465
openstack/kolla,I5e89a9a241f746a2cbab723ea5fc57ea65ad5ee5,0,0,0.5188,2.5649,0.0833,3,6.5,164,0,Feature,0,0,0,345,0.015361,0.5098,0,0.2645,2,2,0,0.6318,1.3844,2.0,-92.61,24.14,1,0,0.0,0,12.6154,0,0,0,0,0,"debian: Use {{ openstack_release_codename }} for extrepo
[SEP]
FILES CHANGED:
kolla/image/kolla_worker.py (+3, -0)
docker/base/Dockerfile.j2 (+1, -1)
kolla/common/config.py (+7, -0)
",1.595267,0.302258,0.371782,-0.447664,1.265688,-0.34164,-0.947081,0.216247,-0.120772,-0.632117,-0.469329,-0.642288,-1.163151,-0.14892,-0.5869
openstack/kolla,I95500612168871454ce269b3562a8daccdf4de4f,0,0,0.5173,1.3863,1.0,2,8.0,208,0,Feature,0,0,0,346,0.015398,1.0,0,0.5173,3,2,0,0.6303,0.9183,3.0,-28.65,23.2,0,0,0.0,0,52.0,0,0,0,0,0,"ironic: Stop copying rootwrap since Ironic dropped it

See I0a8e26e8990eae8108537541159f7810d35b70f1
[SEP]
FILES CHANGED:
docker/ironic/ironic-base/ironic_sudoers (+0, -1)
docker/ironic/ironic-base/Dockerfile.j2 (+0, -2)
",0.840738,-0.507025,-1.998881,-2.486551,1.267303,0.735054,0.446844,-0.636775,0.028609,0.061692,-0.61534,0.773092,-0.332258,-0.152528,0.091583
openstack/kolla,Ib42be3d56bdb64247ac6f17b8ac1f1baa873f475,0,0,0.5159,2.4849,0.5455,2,8.5,205,0,Feature,0,0,0,347,0.01544,0.6667,0,0.3439,3,2,0,0.6287,0.684,3.0,-10.8,22.22,0,0,0.0,0,17.0833,0,0,0,0,0,"keystone: Add local wsgi file

It has been removed with I9fa7cd60bf27768db06f69681675fce2e55712af
[SEP]
FILES CHANGED:
docker/keystone/keystone-base/Dockerfile.j2 (+3, -6)
docker/keystone/keystone-base/wsgi (+2, -0)
",0.624323,-0.296515,-1.926735,-2.555146,1.530519,0.394447,0.127307,-0.534187,0.153437,-0.180155,-0.741232,0.308543,-0.352716,-0.193962,-0.111038
openstack/kolla,Ia34d848d8641e43681c602c9c4433364e8be1d92,0,0,0.5144,1.7918,0.8,1,11.33,317,0,Feature,0,0,0,348,0.015477,0.0,0,0.0,3,1,0,0.6272,0.0,3.0,28.62,16.3,0,0,0.0,0,52.8333,0,0,0,0,0,"manila: Drop copying of wsgi files

They have been removed with Icaba9424862b883388bf68d2c3d48138b7b906b0

Not creating local versions like with keystone because Kolla-Ansible
does not use WSGI for Manila yet.
[SEP]
FILES CHANGED:
docker/manila/manila-api/Dockerfile.j2 (+1, -4)
",0.224557,-0.764908,-1.566648,-1.443602,0.491798,0.083356,0.479244,-0.113955,-0.319365,-0.176258,-0.196667,0.138568,0.009246,-0.065915,-0.086596
openstack/kolla-ansible,I869b3cc2c35afe20cd7c6fd42ff4053e7d51cd32,1,1,0.7692,1.0986,0.5,1,6.29,357,0,Bug Fix,0,0,0,13,0.035326,0.0,0,0.0,4,1,0,0.6405,0.0,4.0,44.71,12.51,1,0,0.0,0,119.0,0,6,0,7,0,"Fix etcd config.json template

Currently, if etcd TLS is not enabled but copying CA into containers is
enabled, the etcd.json.j2 will produce json file with trailing comma
problem.
Fixing this by wrapping comma with if condition.

Closes-bug: #2119643
[SEP]
FILES CHANGED:
ansible/roles/etcd/templates/etcd.json.j2 (+1, -1)
",0.221766,-1.781314,-0.163275,-0.228342,-0.445234,-0.262879,-0.203928,0.198368,0.056881,-0.036127,-0.111355,-0.343398,-0.012529,0.168789,-0.042919
openstack/octavia,Id71e7b544715255b7db5024c3d3038da36f07816,1,1,0.76,4.4886,0.4773,4,11.25,389,0,Bug Fix,0,0,0,100,0.008425,0.5,0,0.38,7,3,0,0.6128,1.1838,5.0,16.82,20.5,0,0,0.75,1,4.3708,0,6,0,9,0,"Fixed http_version and domain_name in haproxy templates

When using http_version or domain_name in HMs, octavia generated config
files that were not compatible with recent haproxy releases. Updated the
template to make the config compatible with haproxy >1.8

Closes-Bug: #2119489
[SEP]
FILES CHANGED:
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+32, -32)
octavia/common/jinja/haproxy/combined_listeners/templates/macros.j2 (+6, -9)
octavia/tests/unit/common/sample_configs/sample_configs_combined.py (+1, -1)
releasenotes/notes/fix-http-version-domain-name-hm-117ec59c63e18acd.yaml (+7, -0)
",-0.492542,-0.453056,-0.707813,0.444924,0.425907,0.042386,-0.52155,0.224986,-0.290568,0.132287,-0.033145,-0.348848,0.129027,-0.36771,0.398483
openstack/kolla,I136bb702b20e941611dd90830e81c9d358a2e355,1,0,0.6731,1.0986,0.5,1,3.5,226,0,CI,1,0,0,52,0.068874,0.6,0,0.4038,2,1,0,0.6256,0.0,2.0,-98.86,24.26,0,0,1.0,0,75.3333,0,0,0,0,0,"CI: use opendevmirror for debian/ubuntu builds

Depends-On: https://review.opendev.org/c/opendev/system-config/+/956760
[SEP]
FILES CHANGED:
tests/playbooks/run.yml (+1, -1)
",0.129541,3.682572,-1.627227,0.329774,-0.631911,0.19035,0.216533,-0.601551,-0.309334,-0.788598,-0.545486,-0.139292,0.271465,-0.578905,0.095284
openstack/kolla-ansible,I917437834dd159e107309584e84f5b14b72100d2,1,1,0.5129,2.7726,0.4667,5,8.5,185,0,Bug Fix,0,0,0,349,0.015518,0.5,0,0.2564,4,2,0,0.641,2.1736,4.0,4.13,19.87,0,0,0.0,0,11.5625,0,6,0,13,0,"neutron: Template vpnaas config only when it is enabled

Closes-Bug: #2119733
[SEP]
FILES CHANGED:
ansible/roles/neutron/templates/neutron_vpnaas.conf.j2 (+0, -2)
ansible/roles/neutron/templates/neutron-l3-agent-wrapper.sh.j2 (+2, -2)
ansible/roles/neutron/templates/neutron-server.json.j2 (+3, -1)
ansible/roles/neutron/tasks/config.yml (+1, -0)
ansible/roles/neutron/templates/neutron-l3-agent.json.j2 (+2, -2)
",1.883029,-1.031368,-0.329784,-1.148676,-0.801321,0.291063,-0.831175,0.398416,-0.233336,-0.19117,0.416759,-0.055887,-0.223644,-0.168214,-0.084372
openstack/openstack-ansible-plugins,I05d238181585af8acb546e600404ecaef7857f92,1,0,0.9604,0.6931,0.0,1,4.75,241,0,Feature,0,0,0,227,0.056482,0.0,0,0.0,3,1,0,1.0,0.0,3.0,-65.14,22.95,1,0,0.0,0,120.5,0,0,0,0,0,"Install systemd-udev for EL10

systemd-udev provides systemd-tmpfiles-setup-dev service which
is required for glusterfs.
[SEP]
FILES CHANGED:
roles/glusterfs/vars/redhat-10.yml (+1, -0)
",0.777316,1.120729,-0.615767,0.452682,0.800419,-0.79971,-0.316017,0.206805,-0.470122,-0.824836,-0.370164,0.460253,-0.094545,0.316431,0.49881
openstack/openstack-ansible-lxc_hosts,I76e7591c65439af000888134a052c9cefdb9bc2c,1,0,0.9605,2.8332,0.125,1,7.8,280,0,Feature,0,0,0,228,0.056716,0.0,0,0.0,1,1,0,1.0,0.0,1.0,47.07,11.33,1,0,0.0,0,16.4706,0,0,0,0,0,"Use LXC from EPEL for 10

Previously LXC was not yet released in EPEL, thus we had to use COPR
as a source. Now, once LXC is available from EPEL, let's use it.
[SEP]
FILES CHANGED:
vars/redhat-10-host.yml (+14, -2)
",0.681674,0.133441,-0.302047,0.956344,-0.053608,1.00029,0.275594,-0.525912,-1.322351,0.291746,0.331901,0.150189,-0.093811,-0.419072,0.03023
openstack/openstack-ansible-galera_server,I53e42c4ab009f58ddba71c2f67a2f5d05db90d8a,1,0,0.9607,5.4467,0.9957,3,4.33,314,0,Feature,0,0,0,229,0.056739,0.9452,0,0.9081,2,2,0,0.9231,1.0463,1.33,41.91,9.94,1,0,0.0,0,1.3534,0,0,0,0,0,"Bump MariaDB to 11.4.8 for EL10

Previously MariaDB was absent for EL10, thus we were installing
what's available out of the box.
Now, with 11.4.8 we are able to align versions between distros.
[SEP]
FILES CHANGED:
vars/redhat-10.yml (+0, -97)
defaults/main.yml (+1, -1)
files/gpg/RPM-GPG-KEY-MariaDB (+0, -132)
",-0.340975,0.280755,-0.643952,0.946423,0.056032,0.961637,0.203168,-0.182706,-1.09807,0.918219,-0.129374,0.335038,-0.280184,-0.009299,0.498017
openstack/openstack-ansible-galera_server,I7a506b58353b01a4bd1bd49847345b22e6becf94,1,0,0.9609,0.6931,0.0,1,5.75,252,0,Feature,0,0,0,230,0.053902,0.9,0,0.8648,1,1,0,0.9286,0.0,1.0,-23.38,21.43,0,0,0.0,0,126.0,0,0,0,0,0,"Add mariadb-client-utils to packages for removal

This packages does conflict with MariaDB-client when distro->repo
switch is made.
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
",1.302344,-0.283571,-0.425665,0.110267,0.020626,-0.78004,0.260226,0.273721,-0.621862,-0.741189,-0.262178,0.383174,-0.328916,0.199655,-0.153231
openstack/kolla-ansible,I20a669bf7796285df04723a9110f9c74788600e1,0,0,0.5143,6.789,0.9696,29,4.5,127,0,Feature,0,0,0,350,0.015552,1.0,0,0.5143,4,4,0,0.6414,2.9344,3.72,-32.73,24.02,0,0,0.0,1,0.143,0,0,0,0,0,"Drop VMware support
[SEP]
FILES CHANGED:
doc/source/reference/compute/index.rst (+0, -1)
ansible/roles/nova-cell/defaults/main.yml (+0, -6)
ansible/roles/ceilometer/tasks/config.yml (+0, -13)
ansible/roles/neutron/defaults/main.yml (+7, -62)
ansible/roles/cinder/templates/cinder.conf.j2 (+0, -20)
ansible/roles/neutron/templates/fwaas_driver.ini.j2 (+0, -4)
ansible/roles/cinder/defaults/main.yml (+0, -6)
ansible/roles/ceilometer/templates/ceilometer.conf.j2 (+0, -15)
ansible/roles/neutron/templates/nsx.ini.j2 (+0, -50)
doc/source/reference/storage/cinder-guide.rst (+0, -6)
ansible/roles/cinder/tasks/precheck.yml (+0, -2)
doc/source/reference/compute/nova-guide.rst (+1, -7)
ansible/roles/glance/templates/glance-api.conf.j2 (+0, -9)
ansible/roles/glance/defaults/main.yml (+1, -10)
etc/kolla/globals.yml (+2, -16)
releasenotes/notes/drop-vmware-support-6303715d3fb80946.yaml (+6, -0)
ansible/roles/neutron/templates/neutron-server.json.j2 (+5, -10)
etc/kolla/passwords.yml (+0, -10)
ansible/roles/neutron/tasks/config.yml (+0, -16)
ansible/roles/nova-cell/tasks/config.yml (+0, -12)
ansible/roles/neutron/templates/dhcp_agent.ini.j2 (+0, -12)
doc/source/reference/compute/vmware-guide.rst (+0, -488)
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -21)
ansible/roles/nova-cell/templates/nova.conf.j2 (+0, -18)
ansible/roles/neutron/templates/neutron_vpnaas.conf.j2 (+0, -4)
ansible/group_vars/all.yml (+4, -15)
ansible/roles/nova-cell/templates/nova-compute.json.j2 (+0, -6)
ansible/roles/ceilometer/templates/ceilometer-compute.json.j2 (+1, -7)
doc/source/reference/shared-services/glance-guide.rst (+0, -14)
",4.971864,2.590391,3.056792,0.405392,-0.153397,1.714839,0.579977,0.609669,0.229,0.058574,-0.283392,0.039262,0.788268,0.323094,0.274934
openstack/kolla-ansible,Iac99be59139eeb232dd3b00ec90fae0a4ea7547d,0,0,0.5128,6.5162,0.3807,23,17.5,315,0,Feature,0,0,0,351,0.015005,0.8125,0,0.4167,4,6,0,0.6406,3.737,3.39,-4.3,18.43,1,0,0.0593,1,0.466,0,0,0,0,0,"neutron: Switch to uWSGI

Also split services into:
- api
- rpc-worker (only for ML2/OVS)
- periodic-worker
- ovn-maintenance-worker (only for ML2/OVN)

Remove neutron-tls-proxy since it's not needed anymore
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+23, -14)
ansible/roles/neutron/templates/neutron-tls-proxy.json.j2 (+0, -23)
ansible/roles/fluentd/defaults/main.yml (+0, -6)
tests/check-logs.sh (+2, -1)
ansible/roles/neutron/tasks/upgrade.yml (+17, -0)
ansible/roles/neutron/defaults/main.yml (+106, -71)
ansible/roles/neutron/templates/neutron-server.json.j2 (+20, -2)
ansible/roles/loadbalancer/tasks/upgrade.yml (+9, -0)
ansible/roles/common/tasks/config.yml (+0, -1)
doc/source/admin/advanced-configuration.rst (+0, -4)
ansible/roles/neutron/tasks/config.yml (+30, -33)
ansible/roles/neutron/tasks/stop.yml (+9, -0)
ansible/roles/neutron/templates/neutron-ovn-maintenance-worker.json.j2 (+30, -0)
ansible/inventory/all-in-one (+27, -17)
ansible/roles/neutron/templates/neutron-periodic-worker.json.j2 (+30, -0)
ansible/roles/neutron/templates/neutron.conf.j2 (+4, -4)
ansible/roles/common/templates/cron-logrotate-neutron-tls-proxy.conf.j2 (+0, -3)
ansible/roles/neutron/handlers/main.yml (+45, -14)
ansible/group_vars/all.yml (+0, -1)
ansible/roles/neutron/templates/neutron-rpc-server.json.j2 (+30, -0)
tests/templates/inventory.j2 (+23, -14)
releasenotes/notes/neutron-uwsgi-5ac29b1403c02554.yaml (+13, -0)
ansible/roles/neutron/templates/neutron-tls-proxy.cfg.j2 (+0, -49)
",-1.011073,0.409666,-1.017583,0.320083,0.250534,-0.680156,-0.631046,0.021118,-0.859459,-0.218874,-0.129657,0.043235,0.79536,0.524865,-0.258269
openstack/openstack-ansible-os_nova,Ia36a5225aae501e7ffe556e54b459fe7f8fa97bd,1,0,0.961,1.6094,0.0,1,8.6,414,0,Feature,0,0,0,231,0.054124,1.0,0,0.961,1,1,0,1.0,0.0,1.0,-12.41,16.46,1,0,0.0,0,82.8,0,0,0,0,0,"Use mkisofs as config_drive prepare command

xorriso in EL10 no longer contains genisoimage to prepare config_drive
image. mkisofs is already used by devstack on Fedora [1] and
reported to work on SUSE 15 as well

[1] https://opendev.org/openstack/devstack/src/branch/master/lib/nova#L535-L537
[SEP]
FILES CHANGED:
templates/nova.conf.j2 (+4, -0)
",-1.222591,0.870756,-0.575906,0.247929,-0.304503,-0.760091,0.003773,0.536921,-0.254269,0.435521,-0.216754,-0.605593,-0.045767,-0.110095,-0.102955
openstack/kolla,I1e334b47c6ab16eb032458141faae55cf39e3eb4,1,1,0.8317,2.3979,0.5,2,3.0,152,0,Bug Fix,0,0,0,101,0.071429,0.6,0,0.499,2,2,0,0.6265,0.7219,2.0,-7.71,17.87,0,0,0.0,1,13.8182,0,6,0,15,0,"mariadb: pin to 10.11.13

Closes-Bug: #2119954
[SEP]
FILES CHANGED:
docker/base/mariadb.repo (+1, -1)
kolla/template/repos.yaml (+4, -4)
",2.797499,-0.240847,0.010571,-1.874046,-1.020747,0.662731,-0.551275,0.631036,-0.013566,0.82034,0.191064,0.178459,-0.599029,0.454495,0.256387
openstack/openstack-ansible,I8402672d0496e0c4b2c4c641597dda7596390cba,1,0,0.9612,3.4657,0.0968,4,4.33,165,0,Doc,0,0,0,232,0.054307,1.0,0,0.9612,4,3,0,0.9406,1.4231,3.0,-51.36,20.19,1,1,0.0,1,5.1562,0,0,0,0,0,"[doc] Add documentation around EL 10 support
[SEP]
FILES CHANGED:
doc/source/user/aio/quickstart.rst (+2, -1)
releasenotes/notes/el10_support-18871f4618d0c7f0.yaml (+8, -0)
doc/source/admin/upgrades/os-compatibility-matrix.html (+17, -2)
deploy-guide/source/supported-platforms.html (+1, -0)
",2.32588,1.347648,1.524082,0.209872,-0.050229,0.855478,-0.060536,0.0232,-0.013866,1.184289,-0.245335,-0.018802,0.596041,-1.136285,-1.038704
openstack/octavia,I91b6907c3e3e456860f7274153e0ecf030e0519e,1,1,0,3.989,0.1132,3,11.2,1173,0,Bug Fix,0,0,0,0,0.0,0.52,0,0.0,7,2,0,0.6139,1.1855,4.67,33.82,15.19,1,0,0.6792,1,21.7222,0,6,0,15,0,"Reduce tune.ssl.cachesize for HTTPS terminating listeners

454cff5 introduced haproxy's `tune.ssl.cachesize` for TERMINATED_HTTPS
listeners. During a reload of haproxy the old worker process stays
running until the new worker process is ready. This means that two TLS
session caches are allocated/held simultaneously during a reload of the
service.

For small Amphorae, this works fine. The default connection limit is
50000, which takes enough of a chunk out of the 50% allocation that
there is enough wiggle room for the new haproxy worker to allocate its
cache and coexist with the old worker for some time.

However, for larger amphorae, the memory calculated for the session
cache approaches 50%.

haproxy allocates an additional 48 bytes for each 200 byte chunk, so
the total memory allocated exceeds 50% of the available memory,
triggering the OOM-killer on haproxy reload.

Out of an abundance of caution this also reduces the proportion of
memory Octavia considers ""available"" for the TLS session cache from 1/2
to 2/5.

Closes-Bug: #2119987
[SEP]
FILES CHANGED:
octavia/common/jinja/haproxy/combined_listeners/jinja_cfg.py (+6, -6)
octavia/tests/unit/common/jinja/haproxy/combined_listeners/test_jinja_cfg.py (+36, -0)
releasenotes/notes/fix-haproxy-ssl-cache-size-5d5842100a87de54.yaml (+5, -0)
",-2.912877,-0.679961,3.087792,-0.471513,-0.119634,0.376246,-0.288922,-0.057601,0.05005,-0.040222,-0.155075,0.307305,-0.132684,-0.285892,0.239498
openstack/ironic,Ic02ba87485a676e77563057427ab94953bea2cc2,1,1,0.9773,5.2883,0.0355,13,15.6,520,0,Bug Fix,0,0,0,44,0.013763,1.0,0,0.9773,6,2,0,0.9592,3.3629,3.69,45.66,12.91,0,0,0.7208,1,2.6263,0,6,0,4,0,"Fix the ability to escape service fail

Back when we developed service, we expected operators to
iterate to fix their issues, but we also put in abort code.

We just never wired in the abort code to the abort verb.

It really seems like we really should have done that, and
this change changes API and Conductor code path to make this
happen.

Closes-Bug: 2119989

Assisted-By: Claude Clode - Claude Sonnet 4
[SEP]
FILES CHANGED:
ironic/tests/unit/conductor/test_manager.py (+31, -0)
releasenotes/notes/servicefail-abort-8ca7a7498321b67c.yaml (+7, -0)
ironic/tests/unit/api/controllers/v1/test_node.py (+21, -0)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+16, -0)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+10, -0)
ironic/conductor/manager.py (+18, -1)
ironic/conductor/servicing.py (+12, -0)
ironic/tests/unit/drivers/modules/drac/test_management.py (+3, -1)
ironic/drivers/modules/deploy_utils.py (+6, -0)
ironic/tests/unit/conductor/test_utils.py (+14, -5)
ironic/conductor/utils.py (+8, -0)
ironic/common/states.py (+3, -0)
ironic/tests/unit/conductor/test_servicing.py (+41, -0)
",-0.201394,-2.362082,0.316153,-0.548656,-1.253468,-0.07918,0.324478,-0.177127,-0.289105,0.334874,0.521204,-0.293082,0.313384,0.106024,0.134639
openstack/openstack-ansible,Ida47e3e64f6a2b9245e402fb10aa6bd59aeee71f,1,1,0.9614,1.6094,0.25,1,6.0,316,0,Bug Fix,0,0,0,233,0.054148,0.75,0,0.721,1,1,0,0.9412,0.0,1.0,-10.75,15.73,0,0,0.0,0,63.2,0,6,0,10,0,"Check if bash_completion.d exists during bootstrap

In case bash-completion is not installed, /etc/bash_completion.d
is not present, which results in bootstrap script failure

Closes-Bug: #2103364
[SEP]
FILES CHANGED:
scripts/bootstrap-ansible.sh (+3, -1)
",-0.358845,0.385844,-0.996809,0.619418,0.199664,0.31612,-0.103283,-0.347864,-0.210409,-0.318246,0.432474,-0.220394,-0.055142,0.42552,0.346475
openstack/kolla-ansible,I2064f822bda1c2618605ecfb9bf26ad820ccbbf2,1,1,0.5385,2.9957,0.1053,3,15.8,665,1,Bug Fix,0,0,0,13,0.036932,0.0,0,0.0,2,2,0,0.6399,1.2155,1.67,10.89,19.99,0,0,0.1579,1,33.25,0,10,0,16,0,"security: hide sensitive auth_password in kolla_container module logs

Added no_log=True to the 'common_options' argument in generate_module()
to prevent the auth_password and other sensitive data from being printed
in Ansible logs during container operations. This improves security by
hiding credentials from logs.

This change addresses the issue where auth_password was visible in logs
despite already having no_log=True on the auth_password parameter itself,
because it was nested inside common_options dict without no_log protection.

Closes-Bug: #2120302
[SEP]
FILES CHANGED:
tests/test_kolla_container.py (+2, -1)
ansible/library/kolla_container.py (+2, -1)
releasenotes/notes/bug-2120302-824ede145936a6eb.yaml (+13, -0)
",-1.552401,-1.15195,0.301068,0.416387,0.546956,-0.046723,-0.44836,-0.343751,0.178552,-0.105081,0.259546,-0.667128,-0.044276,-0.174951,0.070726
openstack/kolla-ansible,I2349d566e38c03b60c87e390cf03166c65bc94b7,1,1,0.5114,1.0986,0.5,1,3.3,459,0,Bug Fix,0,0,0,352,0.014626,0.5,0,0.2557,4,1,0,0.6403,0.0,4.0,-73.39,14.65,0,0,0.0,0,153.0,0,6,0,12,0,"mariabackup: Grant ALTER on mysql.mariadb_backup_history

Also adapt our perms as per docs in [1].

This should fix 10.11.14 according to [2].

[1]: https://mariadb.com/docs/server/server-usage/backup-and-restore/mariadb-backup/mariadb-backup-overview#authentication-and-privileges
[2]: https://jira.mariadb.org/browse/MDEV-37406

Closes-Bug: #2120409
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/register.yml (+1, -1)
",-2.254412,2.375349,-0.644056,0.11982,-0.435833,-0.338614,0.214924,0.229687,0.121583,0.150951,0.367992,-0.105591,-0.140648,0.050549,-0.250587
openstack/kolla,Ib694d3be0d2a199469690a01ba17a3349f3802b1,0,0,0.5127,2.3979,0.5,2,3.14,317,0,Bug Fix,0,1,0,353,0.014666,0.6667,0,0.3418,2,2,0,0.6275,0.7219,2.0,-57.85,17.62,0,0,0.0,1,28.8182,0,0,0,0,0,"Revert ""mariadb: pin to 10.11.13""

This reverts commit e478adcbe63d81faa44bc09f72461fd6a7fcdf94.

Reason for revert: mariabackup fixed

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/957087
[SEP]
FILES CHANGED:
docker/base/mariadb.repo (+1, -1)
kolla/template/repos.yaml (+4, -4)
",-0.517157,1.459798,-1.78036,-1.421736,-0.097761,0.114358,1.049158,0.1114,0.363248,-0.074026,0.160764,-0.020286,-0.121476,0.0168,-0.071774
openstack/kolla-ansible,I10e800aede5966e030ed8e661e2eb45b126ff678,1,1,0.7857,3.8067,0.2727,3,7.4,664,0,Bug Fix,0,0,0,14,0.037838,0.3431,0,0.2696,3,3,0,0.6407,1.1188,2.33,11.83,12.69,1,0,0.0,1,14.7556,0,6,0,7,0,"Set default external Let's Encrypt cert server

Currently, unless users set either external or internal cert server by
themselves, enabling Let's Encrypt with ``enable_letsencrypt`` does
nothing.

This change makes the external certificate get managed by Let's Encrypt
by default when Let's Encrypt is enabled.
The server address is default Let's Encrypt ACME server [1]
which was the former default before change [2].

[1] https://acme-v02.api.letsencrypt.org/directory
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/925971

Closes-bug: #2120451
[SEP]
FILES CHANGED:
doc/source/admin/tls.rst (+18, -11)
ansible/group_vars/all.yml (+1, -1)
releasenotes/notes/set-default-letsencrypt-external-cert-server-d34f9d783082d7d7.yaml (+13, -0)
",-1.778299,0.811854,0.490321,-0.069516,-0.444444,0.054829,0.229488,0.394362,-0.127837,-0.231841,0.394266,-0.203167,-0.308389,-0.153221,-0.297335
openstack/ironic,I17412efce680ea7e96923239a0e4e1be00002fba,1,0,0,3.2189,0.0,1,4.0,142,0,Feature,0,0,0,0,0.0,1.0,0,0.0,2,1,0,0.9595,0.0,2.0,-43.97,18.27,1,0,0.0,0,5.68,0,0,0,0,0,"Add RELEASE_MAPPING entry for 30.0 release
[SEP]
FILES CHANGED:
ironic/common/release_mappings.py (+24, -0)
",1.980693,0.715369,1.336777,0.400059,0.844437,0.92398,-0.465006,1.242192,0.760475,0.821672,-1.117944,-0.495377,-0.681597,0.206558,0.392916
openstack/ironic,I8e7a197414e2e1933714d9e8255c8b9b61b34d24,1,0,1.0,3.2189,0.0,1,2.8,209,0,Feature,0,0,0,1,0.04,1.0,0,1.0,2,1,0,0.9597,0.0,2.0,-73.98,21.12,1,0,0.0,0,8.36,0,0,0,0,0,"Add RELEASE_MAPPING entry for 31.0 release

Depends-On: https://review.opendev.org/c/openstack/ironic/+/957164
[SEP]
FILES CHANGED:
ironic/common/release_mappings.py (+24, -0)
",0.194905,3.063995,-1.33938,-0.292575,-1.13631,0.506729,-0.150377,-0.013922,0.188627,-0.430521,-1.017087,-0.173124,-0.314945,-0.357092,0.125591
openstack/kolla-ansible,I04d3b93aa15fb18fb8beefd49c0ba8a0c0dfca08,1,0,1.0,2.4849,0.0,2,11.33,335,0,Bug Fix,0,0,0,1,0.1,0.25,0,0.25,4,2,0,0.6412,0.994,3.0,-11.19,19.83,0,0,0.0,1,27.9167,0,0,0,0,0,"Fix etcd backend certificates not being templated

etcd backend certificates won't be templated due to
`etcd_enable_tls_backend` not being defined, which results in the
`kolla_copy_backend_tls_files` variable evaluating to false.
[SEP]
FILES CHANGED:
ansible/roles/etcd/defaults/main.yml (+5, -0)
releasenotes/notes/bugfix-etcd-backend-certificates-c163bc60e5cbcd2c.yaml (+6, -0)
",-0.89287,0.362554,-0.42543,1.09618,1.274553,-0.136227,-0.72115,-0.359722,0.273355,-0.436038,-0.236579,-0.872747,-0.74304,-0.418268,0.050556
openstack/kolla-ansible,Ia1a1a247c72b0edb13a26f3f73259abe4f92b762,0,0,0.5113,2.9957,0.8947,3,6.8,378,1,CI,0,1,0,354,0.014702,1.0,0,0.5113,2,2,0,0.6416,1.2155,1.67,-24.01,19.19,0,0,0.1579,1,18.9,0,0,0,0,0,"Revert ""security: hide sensitive auth_password in kolla_container module logs""

This reverts commit 9e8b2c4661416e7812afa70bad144201ea410fe9.

Reason for revert: no_log=True on common_options over-redacts,
including parsed stdout, breaking CI. Different approach needed.
[SEP]
FILES CHANGED:
tests/test_kolla_container.py (+1, -2)
ansible/library/kolla_container.py (+1, -2)
releasenotes/notes/bug-2120302-824ede145936a6eb.yaml (+0, -13)
",0.010218,-1.384812,-1.204972,-1.128602,0.456512,-0.064626,0.443029,-0.251524,0.157797,-0.207209,-0.06526,-0.291103,-0.072731,-0.024374,-0.278227
openstack/openstack-ansible-os_cinder,Ie74931133b7e2bf4262bb48134e80a64c9779d04,1,0,0.9615,1.6094,0.5,2,13.25,476,0,CI,0,0,0,234,0.05433,1.0,0,0.9615,1,2,0,1.0,1.0,1.0,-2.95,21.15,0,0,0.0,0,95.2,0,0,0,0,0,"Provision backup configuration for cinder-backup group

While cinder-backup has it's own service and group, we still use
cinder-volume for conditioning some configuration, which makes
it untrivial to separate cinder-volume from cinder-backup in deployments

This improves some crucial conditions to work for cinder-backup
in case it's deployed separately.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -1)
templates/cinder.conf.j2 (+1, -1)
",-1.021581,-0.580123,-0.358983,0.913256,0.696923,-0.630502,0.206988,-0.248763,-0.894489,-0.099583,-0.101333,0.036458,0.150615,-0.11228,0.363569
openstack/kolla-ansible,I1c732ceae024238e64c9b64babd88f174dac7712,0,0,0.5099,1.7918,0.0,3,17.0,418,0,CI,0,0,0,355,0.014732,0.5,0,0.2549,4,2,0,0.6408,1.5219,3.33,17.06,17.0,0,0,0.2,0,69.6667,0,0,0,0,0,"loadbalancer: Allow to override proxysql restart_policy

in CI we're running with restart_policy: ""no"" to catch issues with services
getting crashed/exited without an action from Kolla-Ansible side

With ProxySQL it's counter productive - because if it crashes due to
resource constraints - it won't come back.
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/handlers/main.yml (+2, -0)
tests/templates/globals-default.j2 (+1, -0)
ansible/roles/loadbalancer/defaults/main.yml (+2, -0)
",0.167624,-1.691097,-0.32527,-0.022401,-0.48069,-0.278147,0.216006,-0.507121,-0.612685,-0.310037,0.173386,-0.29028,0.420521,0.049542,-0.008717
openstack/kolla,Ib738325603173157b4c482f9de6d5d9cea0b758a,1,1,0.8,2.8332,0.1875,2,5.12,362,0,Bug Fix,0,0,0,10,0.02,0.3333,0,0.2667,2,2,0,0.6259,0.9544,2.0,51.0,11.81,1,0,0.0,1,21.2941,0,6,0,13,0,"Bump libvirt exporter

Bumps libvirt exporter source from v1.6.0 to v2.2.0. This fixes some
metrics that were lost when the exporter was changed from the old
""tinkoff"" source to ""inovex"".

See also Icc8a3651d601ab45d448c9d252ca6155219d21cf

Closes-Bug: #2120639
[SEP]
FILES CHANGED:
kolla/common/sources.py (+3, -3)
releasenotes/notes/bug-2120639-74c180bd812ddcf7.yaml (+10, -0)
",-1.196464,-0.647078,-1.204685,-0.870815,0.351477,-0.020758,0.575057,0.571762,0.098505,0.621249,0.170686,-0.07611,0.068598,0.244204,0.292622
openstack/magnum-ui,If36ea24d4ba5f235dac9e95c2231efb21c2dea63,1,1,0,3.7842,0.1395,1,8.0,730,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,6,1,0,1.0,0.0,6.0,22.79,13.2,1,0,0.0,0,16.5909,0,12,0,7,0,"Fix external network list for new Neutron API response

The network list in the Cluster Template workflow was always empty
because the code only checked `router:external` field and assumed
`subnets` contained full objects. In newer Neutron / openstacksdk
responses, the field is called `is_router_external` and subnets
may be provided as `subnet_ids` instead of full objects.

This patch updates onGetNetworks() to:
- Accept both `router:external` and `is_router_external`.
- Handle both `subnets` (objects) and `subnet_ids` (IDs).
- Work with either `response.data.items` or `response.data.networks`.

Closes-Bug: #2106094
[SEP]
FILES CHANGED:
magnum_ui/static/dashboard/container-infra/cluster-templates/workflow/workflow.service.js (+37, -6)
",-2.703718,0.864259,0.813587,0.490062,0.90529,0.125476,-0.653645,-0.044231,0.075872,-0.396643,-0.194557,-0.416409,0.020907,0.108951,-0.418642
openstack/kolla-ansible,I200edd03aaafa19ad52eb8ed3019ad7fdccb9693,1,0,0.5084,1.7918,0.6,1,8.33,278,0,CI,1,1,0,356,0.01477,0.5366,0,0.2728,1,1,0,0.64,0.0,1.0,-8.05,16.13,0,0,1.0,1,46.3333,0,0,0,0,0,"Revert ""CI: Mark debian-upgrade non-voting""

This reverts commit 6fa05b7cbce5417cc6e1291aa700fcd532feaff8.

Reason for revert: Working fine since switch to smaller flavor
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+2, -3)
",0.519833,-0.122803,-2.07818,-1.469303,0.949978,0.562554,0.659272,-0.40358,0.177607,-0.206609,-0.024565,0.455243,-0.084429,0.061893,-0.225707
openstack/kolla-ansible,Ie225474520a2720439bd8014dc3179ddc8dfefed,1,0,0.6316,3.6109,0.2778,2,7.75,252,0,CI,1,0,0,19,0.071161,0.6364,0,0.4019,1,1,0,0.6405,0.9911,1.0,40.68,10.84,0,0,1.0,1,6.8108,0,0,0,0,0,"CI: Use 16GB nodes for debian-bookworm nodes

We have seen OOM issues in particular for debian jobs, let's see whether
using larger nodes helps.
[SEP]
FILES CHANGED:
zuul.d/nodesets.yaml (+16, -0)
zuul.d/jobs.yaml (+10, -10)
",1.184885,-1.000634,-0.276708,0.125353,-0.242084,0.173693,-0.090446,-0.723832,-0.839287,0.079668,-0.077945,-0.007764,0.536633,-0.46402,-0.094589
openstack/kolla,Iabf606848a6160eaf9e2494a2564f37c6db09882,1,0,0.6792,0.6931,1.0,1,5.67,187,0,Feature,0,0,0,53,0.070013,0.75,0,0.5094,2,1,0,0.6268,0.0,2.0,2.02,21.09,0,0,0.0,0,93.5,0,0,0,0,0,"Enable Prometheus mtail build for ARM64

arm64 binaries are available currently.
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+0, -1)
",2.684754,-0.315095,1.287986,-0.26004,0.039133,-0.207727,-0.285234,0.881787,-0.163441,0.289242,-0.596741,0.221876,0.055246,-0.174363,-0.014893
openstack/kolla,I400e9a9a3bf03053589835f933023eedee504f08,1,0,0.6852,0.6931,1.0,1,8.5,279,0,CI,0,0,0,54,0.07124,0.7778,0,0.5329,2,1,0,0.6277,0.0,2.0,26.52,16.34,0,0,0.0,0,139.5,0,0,0,0,0,"Enable Barbican build on Ubuntu ARM64

Re-enable the Ubuntu arm64 build. The previous exclusion was due to
uWSGI issue [1], which is no longer reproducible on Ubuntu Noble.
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+0, -1)
",1.081312,-0.677402,-0.197922,0.33492,-0.529053,0.625453,0.110835,0.538375,-0.166851,0.237886,0.250332,0.75594,-0.281338,-0.584926,0.12977
openstack/kolla,Ie4f6f15404f6965df51f3214506ae9f8bb9b61e7,1,0,0.6909,1.9459,0.6667,2,5.14,316,0,Feature,0,0,0,55,0.072464,0.8,0,0.5527,2,2,0,0.6286,0.65,2.0,41.82,10.95,0,0,0.0,0,45.1429,0,0,0,0,0,"Influxdb: use stable RHEL repo

Switch the RHEL repo to the stable channel as per [1]. Use new GPG.
Telegraf arm64 builds are enabled again, as binaries exists.

[1] https://repos.influxdata.com/stable/x86_64/
[SEP]
FILES CHANGED:
kolla/image/unbuildable.py (+0, -1)
docker/base/influxdb.repo (+2, -3)
",-0.440763,-0.067967,-0.535546,0.24259,-0.755763,-0.187843,-0.128263,0.935268,-0.299709,0.36749,-0.319568,-0.226073,-0.040446,0.084839,-0.745888
openstack/kolla,If6101d99c216a9b1142bfdf194f7a053730e28da,0,0,0.5098,1.6094,0.5,1,9.0,217,0,CI,1,0,0,357,0.014808,0.75,0,0.3824,1,1,0,0.6295,0.0,1.0,25.37,16.93,0,0,1.0,0,43.4,0,0,0,0,0,"CI: Switch centos 10 nodeset to centos 10

9 was used as an interim solution when OpenDev did not support it.
[SEP]
FILES CHANGED:
.zuul.d/base.yaml (+2, -2)
",1.16287,-0.439818,-0.460468,0.199793,0.030851,0.718391,-0.114922,-0.251529,-1.029702,0.592771,0.240924,0.277316,-0.097383,-0.583154,0.352232
openstack/octavia,I1e2f28281debf07cea27cd585f3e85282b684c8d,1,1,0.512,2.6391,0.0,2,13.2,476,0,Bug Fix,0,0,0,125,0.004346,1.0,0,0.512,6,2,0,0.615,0.7793,4.0,42.18,13.76,0,0,0.0,1,34.0,0,6,0,15,0,"Resolve a UDP rebalance issue on backend failure

In some scenarios, UDP load balancers may not immediately rebalance the
backend member servers if a member server fails. This is due to
connection caching of the flows.
This change sets the ""expire_nodest_conn"" sysctl to 1, causing the flows
to be flushed on a real server removal due to failure.

Closes-Bug: #2114264
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/templates/amphora-netns.systemd.j2 (+3, -0)
releasenotes/notes/Fix-UDP-member-server-rebalance-74c67cb09c7c529a.yaml (+10, -0)
",-0.67374,-1.392017,-0.067122,0.649459,-0.045588,0.195088,0.315629,0.069178,0.809391,-0.027855,0.242289,0.070443,0.028226,-0.4046,0.316896
openstack/kolla-ansible,I8a4f6c6bee01e0e12da2c15836135bc890c72cde,1,0,0.6964,2.5649,0.5833,1,4.0,241,0,Doc,0,0,0,56,0.073203,0.4444,1,0.3095,3,1,0,0.6409,0.0,3.0,-29.87,13.6,0,0,0.0,0,18.5385,0,0,0,0,0,"update development docs after cli move to python

Follow up to [1].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/923110
[SEP]
FILES CHANGED:
doc/source/user/quickstart-development.rst (+5, -7)
",0.62538,2.506478,-1.072828,-0.139539,-1.357971,0.046867,0.430922,0.069525,0.027063,-0.139712,-0.638824,-0.096128,-0.384319,-0.128423,-0.358779
openstack/kolla-ansible,I4007be957f0f5ed7d0eab839517a54e5e1f8f5ef,0,0,0.8333,2.5649,0.0,2,8.0,222,0,CI,1,0,0,102,0.071629,0.5476,0,0.4563,2,1,0,0.6414,0.4138,1.5,18.94,16.53,0,0,1.0,1,17.0769,0,0,0,0,0,"CI: Add non-voting Kayobe jobs

This adds Kayobe CI jobs to catch any regression triggered by
kolla-ansible changes.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+1, -0)
zuul.d/scenarios/kayobe.yaml (+11, -0)
",1.593454,-0.142287,-0.256158,0.37366,0.087732,0.125445,0.278587,0.184341,-0.288619,-0.5422,0.133849,0.550046,0.310069,-0.378437,-0.2989
openstack/kolla,I710b2a95c840862f52d812df306d1fb26dd4340b,0,0,0.8,1.6094,0.5,1,2.56,213,0,Feature,0,0,0,15,0.036232,0.3333,1,0.2667,3,1,0,0.628,0.0,3.0,49.75,7.98,1,0,0.0,0,42.6,0,0,0,0,0,"Update information on RabbitMQ and Erlang version

RabbitMQ from 4.0.x to 4.1.x
Erlang from 26.2.x to 27.x
[SEP]
FILES CHANGED:
doc/source/contributor/versions.rst (+2, -2)
",-0.508192,2.01674,-1.256014,0.786816,0.621689,0.92203,-0.499563,0.668556,-0.926059,1.626344,-0.155568,0.222851,-0.726828,0.595792,0.423565
openstack/kolla-ansible,Ie0a9a6d26afbe6d6f68544b8a28d4718e64a3daf,0,0,0.5084,1.3863,0.3333,2,10.0,195,0,Feature,0,0,0,358,0.014847,0.5625,0,0.286,4,1,0,0.6406,0.9183,4.0,-19.04,22.0,0,0,0.0,0,48.75,0,0,0,0,0,"octavia: Switch to wsgi module

Octavia (like other services) has moved to WSGI modules
[SEP]
FILES CHANGED:
ansible/roles/octavia/defaults/main.yml (+1, -0)
ansible/roles/octavia/tasks/config.yml (+1, -1)
",0.894744,0.36356,-0.647155,0.437606,0.477231,0.107341,-0.238617,0.150103,-1.119057,0.052345,0.346378,0.166837,0.216782,-0.229854,-0.319301
openstack/kolla,I92f3095b2d51bd6ac7ff48b0c7d79852eccc9803,0,0,0.7018,1.6094,0.5,2,6.0,150,0,Feature,0,0,0,57,0.073359,0.75,0,0.5263,2,2,0,0.6265,1.0,2.0,-17.81,25.73,0,1,0.0,0,30.0,0,0,0,0,0,"[release] Use Flamingo Ubuntu Cloud Archive
[SEP]
FILES CHANGED:
docker/base/sources.list.ubuntu.aarch64 (+1, -1)
docker/base/sources.list.ubuntu (+1, -1)
",2.353614,2.132452,0.265542,0.583913,0.433441,1.002654,0.085979,1.186632,-0.673024,0.006037,0.944333,0.719532,0.320697,-0.415963,-1.518624
openstack/ironic,I2740035d2882aacddca9c541362d6e533140650f,1,1,0.8889,3.6889,0.0769,3,10.67,496,0,Bug Fix,0,0,0,9,0.017787,0.0,0,0.0,4,2,0,0.96,1.4785,2.67,36.06,14.27,1,0,0.4872,1,12.4,0,16,0,14,0,"Memoize calls to bcrypt.checkpw

This intentionally high CPU overhead function is called for every API
and JSON-RPC request when Basic HTTP authentication is enabled. With the
recent indirection enablement this is causing a performance regression
for Metal3 due to the extra JSON-RPC calls. This change would improve
the performance of all branches of Metal3 if backported.

Closes-Bug: #2121105
[SEP]
FILES CHANGED:
releasenotes/notes/bcrypt_cache-d78775ff02f2d970.yaml (+7, -0)
ironic/tests/unit/api/test_middleware.py (+17, -2)
ironic/common/auth_basic.py (+12, -1)
",-0.030591,-1.657795,0.295766,0.165194,-0.631181,0.409494,0.112414,0.447167,0.316708,0.187574,0.000691,0.117751,0.15011,-0.579148,0.320749
openstack/openstack-ansible,Ib1be56b6e7bf35b2e38ec97a06aeeb37ca618011,1,0,0.9617,3.2581,0.04,4,7.5,270,0,Doc,0,0,0,235,0.054512,1.0,0,0.9617,4,3,0,0.9417,1.4337,3.0,13.1,12.33,0,1,0.0,1,10.3846,0,0,0,0,0,"[doc] Add CentOS 10 Stream support

While Rocky 10 is still being blocked by missing systemd-networkd,
we already can claim CentOS 10 Stream support.
[SEP]
FILES CHANGED:
doc/source/user/aio/quickstart.rst (+1, -1)
doc/source/admin/upgrades/os-compatibility-matrix.html (+15, -0)
deploy-guide/source/supported-platforms.html (+1, -0)
releasenotes/notes/centos_10_stream_support-2216bfd28328debd.yaml (+7, -0)
",1.45152,-0.518018,0.255351,0.310332,-0.275693,0.259775,-0.133063,-0.025207,-0.379094,0.33924,-0.146869,0.656371,0.175427,-0.57746,-0.252101
openstack/kolla-ansible,Ia0f7d349ce66482cc6063d6002453746ed8854a1,1,0,0.507,4.9053,0.4627,2,11.33,314,0,CI,1,0,0,359,0.014887,0.6667,0,0.338,1,1,0,0.6398,0.9998,1.0,8.71,16.3,0,0,1.0,1,2.3259,0,0,0,0,0,"CI: Rename nodesets to reflect 8GB/16GB split

Switch some Ubuntu jobs to 16GB because they hit OOM with proxysql
and running instances in QEMU/KVM.

Rename kolla-ansible-noble to kolla-ansible-ubuntu-noble
[SEP]
FILES CHANGED:
zuul.d/nodesets.yaml (+39, -29)
zuul.d/jobs.yaml (+33, -33)
",-0.9064,-0.23915,-1.301023,0.246946,0.688934,-0.698018,-0.021712,0.31399,-0.903354,-0.200415,0.045274,-0.129098,0.387739,-0.032284,0.011026
openstack/kolla-ansible,I1c2e48a2a7de150697d11b8e0de2bd5a5a88c40f,1,0,0.5083,2.8332,0.0,2,4.0,142,0,CI,1,0,0,360,0.014846,0.7647,0,0.3887,1,2,0,0.6402,0.9544,1.0,-29.87,18.27,0,0,1.0,0,8.3529,0,0,0,0,0,"CI: Check for OOM in check-logs.sh
[SEP]
FILES CHANGED:
tests/post.yml (+6, -0)
tests/check-logs.sh (+10, -0)
",2.036554,2.41521,0.250194,0.430391,0.25052,-0.011225,-0.190884,-0.37158,-0.131034,-0.214829,0.497606,-0.404292,0.358558,0.666132,0.093904
openstack/kolla-ansible,I22910575d4d1f8d25740a178fc0529dbf35b768f,0,0,0.75,3.7842,0.2093,2,6.21,748,0,Feature,0,0,0,16,0.038278,0.6,0,0.45,4,2,0,0.6407,0.2714,4.0,22.58,15.36,1,0,0.0,0,17.0,0,0,0,0,0,"Adjust recovery method to support MariaDB>=11.2

This change brings modified method of overcloud database recovery.

On database recovery, we've been setting primary database dynamically
by comparing ``seqno`` of each MariaDB host and setting
``pc.bootstrap=yes`` to the host with largest ``seqno``.
From MariaDB 11.2, ``pc.bootstrap`` cannot be dynamically set with
MariaDB command anymore [1].

Modified method keeps dynamic primary assignment by setting
``pc.bootstrap=yes`` in ``galera.cnf`` of primary host before
restarting MariaDB then unset it after whole recovery process is
finished.

[1] https://jira.mariadb.org/browse/MDEV-32800
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+1, -1)
ansible/roles/mariadb/tasks/recover_cluster.yml (+33, -8)
",-2.334729,0.215469,1.277406,0.274513,0.230444,0.42303,-0.186799,0.367624,0.126501,0.042662,-0.039252,-0.137984,-0.558545,-0.026545,-0.114437
openstack/openstack-ansible-rabbitmq_server,I372421e0347687a1d861b548fd20ee92b150c301,1,0,0.9619,3.4657,0.0,2,13.9,1047,0,CI,0,0,0,236,0.054428,1.0,0,0.9619,2,2,0,0.875,0.7706,1.5,26.57,15.63,0,0,0.0,1,32.7188,0,0,0,0,0,"Ensure no CQ mirroring policies applied

During migration to Quorum queues we have renamed vhosts
to not contain leading slash for them. However, some services
at the same time were configured not to have RPC messaging,
but only notifications whenever needed - like keystone, glance, etc.

This left such vhosts still containing HA policy on them, leading
to RabbitMQ upgrade failures with:
```
rabbitmq-server[2934794]: Application rabbit exited with reason:
{{failed_to_deny_deprecated_features,[classic_queue_mirroring]},{rabbit,start,[normal,[]]}}
```

This patch implements a check of deprecated feature flags and
disables all HA policies across the board before upgrade happens.

As we don't want to force removal when running RabbitMQ 3.13,
the removal is enforced only during upgrade to 4.0.
Conditions are maintained on a task level rather then a block
to make it extendable with other deprecated flags in the future.
[SEP]
FILES CHANGED:
releasenotes/notes/rabbitmq_ensure_no_queue_mirroring-c032f6e169f09c2d.yaml (+7, -0)
tasks/rabbitmq_feature_flags.yml (+24, -0)
",-2.508672,-1.245034,2.733048,-0.536206,-0.115611,-0.134069,-0.04052,0.257318,0.012835,0.009635,-0.110731,-0.091929,-0.178146,-0.377934,0.003102
openstack/kolla-ansible,I037e00b98fafa254b7141db53d1e8bbf06cf975e,1,1,0.6897,1.6094,0.5,1,4.0,343,0,Bug Fix,0,0,0,58,0.074264,0.0,0,0.0,4,1,0,0.6399,0.0,4.0,-20.81,14.46,0,0,0.0,0,68.6,0,6,0,7,0,"letsencrypt: pass EAB and Key Type flags in cron

it was omitted in [1] and [2].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/935656
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/934683


Closes-Bug: #2121432
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/templates/crontab.j2 (+2, -2)
",-1.486854,3.921277,-1.24167,0.443718,-0.827846,0.274869,0.315383,-0.201375,-0.086852,0.410621,0.229849,-0.305226,0.386903,0.050652,-0.12404
openstack/oslo.messaging,Idc4f6a8a1ee73d917495a5ad2f853bdaeec5be83,0,1,0.962,1.6094,0.0,1,5.08,509,0,Bug Fix,0,0,0,237,0.054271,1.0,0,0.962,2,1,0,0.6,0.0,2.0,18.61,12.53,0,0,0.0,0,101.8,0,6,0,3,0,"Ensure self.pg is a non-zero value

In a specific occurances, where command execution could be
escalated from the host to container, os.getpgrp can return
a zero value.

A regression to oslo.messaging was brought by [1], which assumed
that os.getpgrp > 0, as there can not be PID 0 in Linux systems.

[1] https://review.opendev.org/c/openstack/oslo.messaging/+/928034

Closes-Bug: #2121444
[SEP]
FILES CHANGED:
oslo_messaging/_drivers/amqpdriver.py (+4, -0)
",-1.601559,0.230562,0.285887,0.012142,-0.667544,0.163249,-0.040568,-0.015963,0.186326,0.423848,0.270705,-0.173547,-0.192107,0.015812,-0.220287
openstack/kayobe,I8b0da4bd85aef7792ea41ef93ebf3085103c18d4,1,0,0.8252,1.0986,0.5,1,4.5,123,0,Bug Fix,0,0,0,103,0.071727,1.0,1,0.8252,3,1,0,0.9007,0.0,3.0,-32.73,19.58,0,0,0.0,0,41.0,0,0,0,0,0,"Fix markup syntax
[SEP]
FILES CHANGED:
doc/source/administration/seed.rst (+1, -1)
",4.163318,2.737,2.849444,0.601891,0.622423,1.24166,0.516866,-0.525872,0.891204,-0.028609,0.102381,-0.535552,0.92881,0.054274,0.36827
openstack/kolla,I80569b6fe9e4d779a5448015b8ad9caf09e5abf6,1,0,0.5097,3.6636,1.0,3,6.75,248,0,CI,0,0,0,361,0.014877,0.0,0,0.0,3,2,0,0.625,1.2155,2.0,5.72,19.0,0,0,0.1579,0,6.359,0,0,0,0,0,"CI: Drop dump_info.sh

It should not be required anymore, all these information are dumped
by different means (generic zuul playbooks, etc).
[SEP]
FILES CHANGED:
roles/kolla-build-deps/tasks/main.yml (+0, -6)
tests/playbooks/post.yml (+0, -6)
tools/dump_info.sh (+0, -26)
",1.410682,-0.55733,-0.07317,0.161275,-0.27124,0.425361,-0.004619,-0.973898,-0.688611,-0.194921,-0.073297,-0.036445,-0.233655,0.288703,-0.452893
openstack/kayobe,I5ab71d6c3968b852be17c02f27bbc04a400a7aaf,1,0,0.8269,3.1355,0.5,2,7.0,452,0,CI,1,0,0,104,0.072323,0.5349,0,0.4423,1,1,0,0.9013,0.7732,1.0,45.64,9.94,0,0,1.0,1,19.6522,0,0,0,0,0,"CI: Rename seed-vm-efi jobs to seed-vm-q35

The default seed VM boot firmware was switched to efi in 2024.2 [1], but
CI jobs were not renamed to match.

Move q35 jobs to the experimental queue, we don't need to run them on
every change. Also add missing kayobe-seed-vm-centos9s-q35 job.

[1] https://review.opendev.org/c/openstack/kayobe/+/927015
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+3, -2)
zuul.d/jobs.yaml (+8, -9)
",-0.881762,1.159188,-0.237334,0.221388,-0.651159,-0.352288,0.882749,0.315438,-0.31289,0.049435,0.459178,-0.257256,0.169747,0.349312,0.034692
openstack/kayobe,I834259e7eeb6443cb0689997909d093e85decee6,1,0,0.8286,3.434,0.0333,3,9.62,530,0,CI,0,0,0,105,0.071918,1.0,0,0.8286,2,2,0,0.902,1.0137,1.33,46.54,14.76,0,0,0.8667,1,17.0968,0,0,0,0,0,"CI: Test seed VM with distribution cloud images

Seed VM deployment testing was limited to the use of cirros images.

Introduce jobs using distribution cloud images (e.g. GenericCloud) to
test more realistic seed VM deployment scenarios. These jobs are in the
experimental queue to avoid downloading large images on every change.

Note that the Ubuntu Noble job is failing: the VM boots but is not able
to get an IP address.
[SEP]
FILES CHANGED:
playbooks/kayobe-seed-vm-base/overrides.yml.j2 (+3, -1)
zuul.d/project.yaml (+3, -0)
zuul.d/jobs.yaml (+23, -0)
",-0.350453,-1.618365,0.162805,0.739806,-0.248042,-0.206175,0.471175,0.413348,0.006898,0.017737,-0.015118,-0.027883,0.48069,0.054081,-0.220086
openstack/kolla,Ib9805fb6a93a0da887918174d9994caa5f1306d3,0,0,0.5714,4.3175,0.3784,2,2.23,796,1,Bug Fix,0,0,0,14,0.037736,0.3636,0,0.2078,2,2,0,0.6259,0.8004,2.0,17.32,12.58,0,0,0.0,1,10.6133,0,0,0,0,0,"Prometheus and core components update

Updates a range of monitoring and core infrastructure components
to their latest stable upstream versions to leverage new
features and bug fixes.

etcd: 3.5.16 -> 3.6.4
letsencrypt-lego: 4.20.4 -> 4.25.2
prometheus-blackbox-exporter: 0.25.0 -> 0.27.0
prometheus-cadvisor: 0.49.2 -> 0.53.0
prometheus-elasticsearch-exporter: 1.8.0 -> 1.9.0
prometheus-memcached-exporter: 0.15.0 -> 0.15.3
prometheus-mysqld-exporter: 0.16.0 -> 0.17.2
prometheus-node-exporter: 1.8.2 -> 1.9.1
prometheus-server: 3.2.1 -> 3.5.0

The Prometheus-server package has also been switched to
a Long-Term Support (LTS) version, which ensures extended
stability and security support.
[SEP]
FILES CHANGED:
kolla/common/sources.py (+28, -28)
releasenotes/notes/update-packages-071d1863639fe3e3.yaml (+18, -0)
",-4.56604,3.254014,1.40293,0.087755,0.704637,-0.00047,-0.410529,0.542293,-0.217321,0.858446,-0.144283,0.44117,-0.072771,0.885972,0.563842
openstack/kayobe,Ibd2c68103e73b1ecedd1aade780f96af3d9e9ab3,1,1,0.8302,2.3979,0.2,2,8.88,598,0,Bug Fix,0,0,0,106,0.071141,1.0,0,0.8302,4,2,0,0.9026,0.971,3.0,26.24,11.44,0,0,0.0,1,54.3636,0,6,0,9,0,"Switch to EFI-compatible CentOS Stream cloud image

As explained in a recent centos-devel message [1], which is in the
context of CentOS Stream 10 but also applies to 9:

   Q: What is the difference between the two x86_64 qcow2 images?
   The original (without the extra x86_64) is our original Bios only image.
   The one with the extra x86_64 boots using EFI

[1] https://lists.centos.org/hyperkitty/list/devel@lists.centos.org/thread/PQSMX2QQCOJRKMNLQSXDOFIKRGJF4QDM/

Closes-Bug: #2121588
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2121588-ad6d8b33e3fcaff9.yaml (+6, -0)
ansible/inventory/group_vars/all/seed-vm (+2, -2)
",-1.884814,0.200499,0.744062,-0.778734,-0.147425,0.187917,0.380308,0.584459,-0.277395,-0.213145,0.491371,-0.181055,-0.127425,-0.182841,-0.217769
openstack/kolla,Iddcaa8723b364fe4e8619f8fc2b03c93b685db86,1,0,0.6949,3.8712,0.2128,1,9.33,265,0,Doc,0,0,0,59,0.075159,0.6,1,0.4169,3,1,0,0.6244,0.0,3.0,10.03,16.59,0,0,0.0,0,5.5208,0,0,0,0,0,"docs: update main contributor guide page

The goal is to unify common contributor information across
all kolla projects (communication, launchpad links, etc).
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+37, -10)
",0.898414,-1.164262,-0.148246,0.244464,0.359183,-0.018678,0.059332,-0.141503,-0.238882,-0.6086,-0.451231,0.306935,0.004931,-0.262456,-0.699555
openstack/kolla-ansible,I6c6202daa3e29ed41c859e34cbbe91adc6660e36,1,1,0.511,1.6094,0.5,1,11.67,324,0,Bug Fix,0,0,0,362,0.014895,0.5,0,0.2555,4,1,0,0.6403,0.0,4.0,6.46,16.1,0,0,0.0,0,64.8,0,26,0,9,0,"ceilometer: Disable healthchecks for compute and central

ceilometer-polling is not connecting to RMQ on empty deployments, let's
disable healthchecks for now until we find a better healthcheck.

Closes-Bug: #1992515
[SEP]
FILES CHANGED:
ansible/roles/ceilometer/defaults/main.yml (+2, -2)
",0.512321,-0.96402,-0.638459,0.053663,-0.36869,-0.009992,-0.135718,-0.336279,-0.390537,-0.273134,0.105535,-0.203032,0.370375,-0.419032,0.339011
openstack/kolla-ansible,I447212df92c0da4248e44f652fc66c7381a404bb,1,1,0.5,1.9459,0.0,2,11.0,310,0,Bug Fix,0,0,0,4,0.029851,1.0,0,0.5,5,2,0,0.6408,0.65,3.5,18.78,16.52,1,0,0.0,1,44.2857,0,6,0,13,0,"Deny access to `server-status` via `single frontend`

This change denies access to `server-status` when the using `single
frontend` configuration for public API services with `HAProxy`.

Closes-Bug: #2121626
[SEP]
FILES CHANGED:
releasenotes/notes/deny-server-status-via-single-frontend-33bbf3b9688a9ae4.yaml (+5, -0)
ansible/roles/loadbalancer/templates/haproxy/haproxy_external_frontend.cfg.j2 (+1, -0)
",-0.351899,0.402976,-0.663348,0.549286,0.449583,0.229814,-1.231187,0.214441,0.483776,-0.278077,-0.436582,-0.18807,0.324263,-0.254586,-0.204458
openstack/kolla,Ie7e607c5a9c6f8c2e36aea5d52dc2ffbe97dddb3,0,0,0.5124,4.3567,0.9221,8,2.5,204,0,Feature,0,0,0,363,0.014934,0.3478,0,0.1782,3,6,0,0.6253,1.7839,2.25,-193.32,33.0,1,0,0.0,1,2.6154,0,0,0,0,0,"Drop ironic-inspector

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/951864
[SEP]
FILES CHANGED:
kolla/common/users.py (+1, -1)
docker/bifrost/bifrost-base/Dockerfile.j2 (+0, -1)
docker/ironic-inspector/extend_start.sh (+0, -17)
docker/ironic-inspector/ironic_inspector_sudoers (+0, -1)
kolla/common/sources.py (+0, -4)
releasenotes/notes/drop-ironic-inspector-093cc36e06787168.yaml (+5, -0)
docker/ironic-inspector/Dockerfile.j2 (+0, -46)
roles/kolla-build-config/defaults/main.yml (+0, -1)
",0.495083,4.624482,-1.758432,0.043917,-1.544198,0.232078,0.459515,-0.533992,0.095954,-1.049663,-0.546566,0.272532,0.062375,-0.370221,0.093161
openstack/octavia,I1c8520745bf1bb59d483cc7761929794c58e5021,1,1,0.5159,3.4012,0.2414,4,13.6,515,0,Bug Fix,0,0,0,126,0.004379,0.4,0,0.2063,7,2,0,0.616,1.9498,4.0,31.3,16.62,0,0,0.2759,1,17.1667,0,12,0,14,0,"Fix Amphora controller IP list update

Updating the Amphora agent configuration was not triggering the health
manager sender to reload it's configuration file. This meant that it
would not adopt the updated controller IP and port list.
This patch fixes this by signalling the health manager sender process
via a multiprocessing manager queue that it needs to reload it's
configuration.

Closes-Bug: #2121691
[SEP]
FILES CHANGED:
octavia/amphorae/backends/agent/api_server/server.py (+4, -1)
octavia/cmd/agent.py (+7, -3)
releasenotes/notes/Fix-Amphora-Config-Update-06b649883c7a4f44.yaml (+6, -0)
octavia/tests/functional/amphorae/backend/agent/api_server/test_server.py (+5, -3)
",-0.034549,-1.837308,0.145656,0.594886,-0.285,0.009606,0.420098,0.241647,0.297023,-0.318442,0.213213,0.100759,0.222737,0.213121,0.176755
openstack/kolla-ansible,Ie80330a71878b38e693c83e675db52a14624c962,1,0,0.511,2.6391,0.0,1,15.75,550,0,Bug Fix,1,0,0,364,0.014928,0.7,0,0.3577,1,1,0,0.6412,0.0,1.0,32.39,16.46,0,0,1.0,0,39.2857,0,0,0,0,0,"CI: Wait for dns_assignment and handle errors correctly

That should fix OVN jobs:

++ openstack port show my-port -f json -c dns_assignment
+ DNS_ASSIGNMENT='{
  ""dns_assignment"": []
}'
++ python -c 'import json,sys;obj=json.load(sys.stdin);print(obj[""dns_assignment""][0][""fqdn""]);'
++ echo '{' '""dns_assignment"":' '[]' '}'
Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
IndexError: list index out of range
+ FQDN=
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+13, -0)
",-2.289932,0.049266,0.750489,-0.504011,0.230716,-0.121646,-0.637953,-0.277811,0.06591,-0.30877,0.235374,-0.972608,0.053156,0.589839,-0.204815
openstack/kolla-ansible,I19fa22784417fb5ae56847d74513a1735bdb957a,0,0,0.5123,4.0254,0.4364,1,3.67,134,0,Bug Fix,1,0,0,365,0.014961,0.25,0,0.1281,1,1,0,0.6416,0.0,1.0,-12.23,19.65,0,0,1.0,0,2.3929,0,0,0,0,0,"CI: Fix get_logs.sh on pre
[SEP]
FILES CHANGED:
tests/get_logs.sh (+31, -24)
",2.733083,1.732452,0.766645,-0.037029,-0.109965,-0.106943,-0.195017,-0.326079,-0.227932,-0.141178,0.229138,-1.390837,-0.628897,0.506166,0.200018
openstack/kolla,I3ff95aa75f1f1cccfa40f3ab7f216cb221a6af29,1,0,0.7,2.4849,0.2727,3,8.67,233,0,Feature,0,0,0,60,0.072115,0.75,0,0.525,3,3,0,0.6238,1.4949,2.33,22.33,12.7,0,0,0.0,1,19.4167,0,0,0,0,0,"Use versioned Erlang 27 repo on aarch64

Fedora COPR build system cannot handle storing multiple package
versions in one repo.
[SEP]
FILES CHANGED:
releasenotes/notes/erlang-aarch64-repo-change-7fbc8696990b5677.yaml (+5, -0)
doc/source/contributor/versions.rst (+1, -1)
docker/base/copr-rabbitmq-erlang.repo (+2, -2)
",1.7619,-1.11329,0.415423,-0.117122,0.246275,-0.121156,-0.141601,0.824918,-0.556981,-0.173524,-0.291606,0.313991,-0.41099,-0.311547,-0.146593
openstack/kolla,Ibd4450d14691aca627d99c321b313420ce6dd6f2,1,0,0.7049,4.0254,0.0,3,3.08,491,0,Doc,1,0,0,61,0.072361,0.7647,0,0.5391,2,2,0,0.6247,1.5236,1.33,-47.81,10.96,0,0,1.0,0,8.7679,0,0,0,0,0,"CI: add weekly COPR RPM build Erlang job

Updating Erlang RPMs for aarch64 in Fedora COPR build system [1] [2].
Using COPR webhooks feature [3].

[1] https://copr.fedorainfracloud.org/coprs/g/openstack-kolla/rabbitmq-erlang-26
[2] https://copr.fedorainfracloud.org/coprs/g/openstack-kolla/rabbitmq-erlang-27
[3] https://docs.pagure.org/copr.copr/user_documentation.html#custom-webhook
[SEP]
FILES CHANGED:
tests/playbooks/copr-erlang-update.yml (+18, -0)
.zuul.d/base.yaml (+25, -0)
.zuul.d/ubuntu.yaml (+12, -0)
",-2.484699,3.527674,-0.253459,0.277355,-0.267483,-0.718975,0.823646,0.766316,-0.163446,-0.116801,0.266374,0.129138,-0.379986,-0.158995,-0.224507
openstack/kolla-ansible,Iff11ae1e75907790780e41059d94c873e93ec32f,1,0,0.5109,1.3863,0.0,1,6.33,186,0,CI,1,0,0,366,0.014968,0.7778,0,0.3974,1,1,0,0.6409,0.0,1.0,17.85,15.16,0,0,1.0,0,46.5,0,0,0,0,0,"CI: Add exception for venus to check-logs.sh

We're not handling it in fluentd
[SEP]
FILES CHANGED:
tests/check-logs.sh (+3, -0)
",2.792986,-1.174918,0.131085,-0.689808,-1.010236,-0.325983,0.052204,-0.434377,-0.826796,0.064932,-0.10194,-0.264664,-0.086025,0.121381,0.073238
openstack/kolla-ansible,I7db9a2274600d94894bc1da390e4f70132fe3965,1,0,0.5123,0.6931,1.0,1,5.0,357,0,CI,1,0,0,367,0.015007,0.5556,0,0.2846,1,1,0,0.6413,0.0,1.0,-40.76,18.0,0,0,1.0,1,178.5,0,0,0,0,0,"CI: Remove zun from project.yaml

It's been failing with:
ImportError: cannot import name 'transactional' from 'pyroute2.ipdb' (/var/lib/kolla/venv/lib/python3.12/site-packages/pyroute2/ipdb/__init__.py)

ipdb has been removed after long deprecation
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+0, -1)
",-0.352514,0.848225,-1.084338,-0.036336,-0.347373,-0.499527,0.434702,0.225815,-0.29336,-0.033675,-0.293715,-0.765143,-0.537461,0.352595,-0.075226
openstack/kayobe,I0698babb1eaa21b33385d96c5beee3c022d45424,1,0,0.8318,2.1972,0.5,3,5.6,277,0,Feature,0,0,0,107,0.071333,1.0,0,0.8318,4,2,0,0.9032,1.5,2.67,19.87,10.81,0,0,0.0,0,30.7778,0,0,0,0,0,"Switch infra VMs to EFI-compatible CentOS image

This was only applied to the seed VM in a previous change [1].

[1] https://review.opendev.org/c/openstack/kayobe/+/958641
[SEP]
FILES CHANGED:
etc/kayobe/infra-vms.yml (+1, -1)
ansible/inventory/group_vars/all/infra-vms (+2, -2)
etc/kayobe/seed-vm.yml (+1, -1)
",0.295383,1.51066,-0.622499,0.034963,-1.302586,0.442702,0.506373,0.463598,0.200604,0.205217,-0.355451,0.01608,-0.13458,-0.135369,-0.444329
openstack/openstack-ansible-lxc_hosts,I78ad4290a95f5e80d24c39f6927f9638eab1bbc6,1,0,0.958,4.3041,1.0,1,4.78,375,0,Bug Fix,0,0,0,238,0.05445,1.0,0,0.958,1,1,0,1.0,0.0,1.0,24.92,10.28,0,0,0.0,0,5.0676,0,0,0,0,0,"Remove COPR repo for python3-lxc

Python bindings for LXC have been published to EPEL [1] and we no
longer need to carry COPR.

We don't worry about cleaning-up old COPR as this was never
released.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=2387072
[SEP]
FILES CHANGED:
vars/redhat-10-host.yml (+0, -73)
",-0.008865,0.525371,-0.282313,0.063909,-1.049063,0.112183,0.472345,-0.264836,-0.530455,0.401613,0.145701,-0.40647,0.109,-0.00459,-0.031755
openstack/networking-generic-switch,Ieb01a5b8910b7d3e24ccf2561524f36bbd24b2c5,1,1,0.2727,2.3979,0.1,2,14.2,572,0,Bug Fix,0,0,0,11,0.066265,0.0,0,0.0,3,2,0,1.0,0.7219,2.5,30.37,14.13,1,0,0.0,1,52.0,0,6,0,7,0,"Fix incorrect command when unplugging bond subports

When unplugging a bond from a network with trunk subports,
the code was incorrectly using ADD_NETWORK_TO_BOND_TRUNK
instead of DELETE_NETWORK_ON_BOND_TRUNK for removing
subports from the bond trunk. This caused subports to be
added instead of removed during bond cleanup.

Fixes the logic to use the correct command for removing
subports from bond trunks during network unplug operations.

Closes-Bug: #2122025
[SEP]
FILES CHANGED:
networking_generic_switch/devices/netmiko_devices/__init__.py (+1, -1)
releasenotes/notes/fix-unplugging-trunk-subports-66d8496b43c55130.yaml (+8, -0)
",-1.965629,-0.261467,-0.081928,0.958848,0.902851,0.335671,-0.536423,-0.017946,0.115844,-0.209484,0.342763,-0.219816,0.003735,0.039648,0.331179
openstack/kolla-ansible,I31eab7c55a954f9096dae8a1b058eecc0624ea84,1,1,0.5136,1.0986,0.5,1,7.0,163,0,Bug Fix,0,0,0,368,0.015047,0.0,0,0.0,4,1,0,0.6417,0.0,4.0,-23.86,22.8,0,0,0.0,0,54.3333,0,6,0,3,0,"skyline: Switch to use to pymysql

Closes-Bug: #2124203
[SEP]
FILES CHANGED:
ansible/roles/skyline/templates/skyline.yaml.j2 (+1, -1)
",2.74487,0.02379,-0.035895,-1.016382,-0.76167,0.621329,-0.094765,0.475273,-0.159638,-0.086409,0.642758,-0.13462,-0.181271,0.003714,0.482747
openstack/kolla-ansible,Ifcc6ec6e943c20867d969b0bdb0e4cbac53eea1e,1,0,0.3333,6.8265,0.3887,72,6.71,473,0,Feature,0,0,0,12,0.068182,1.0,0,0.3333,6,6,0,0.6422,5.0149,3.4,-8.78,17.15,1,0,0.0619,1,0.513,0,0,0,0,0,"Replace Redis with Valkey

This change replaces Redis with Valkey, which is non-existent
on Rocky Linux 10 / CentOS Stream 10 due to licensing issues.

Co-Authored-By: Bartosz Bezak <bartosz@stackhpc.com>
Co-Authored-By: Michal Nasiadka <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
ansible/roles/redis/tasks/upgrade.yml (+0, -7)
zuul.d/scenarios/nfv.yaml (+3, -3)
ansible/roles/valkey/tasks/reconfigure.yml (+0, -0)
ansible/roles/valkey/tasks/main.yml (+0, -0)
ansible/roles/redis/templates/redis-sentinel.json.j2 (+0, -22)
README.rst (+1, -1)
ansible/site.yml (+7, -7)
ansible/roles/valkey/tasks/config.yml (+26, -0)
ansible/roles/masakari/templates/masakari.conf.j2 (+2, -2)
ansible/roles/designate/templates/designate.conf.j2 (+2, -2)
ansible/roles/valkey/tasks/check.yml (+13, -0)
ansible/roles/valkey/tasks/precheck.yml (+45, -0)
ansible/roles/valkey/tasks/stop.yml (+1, -1)
ansible/roles/redis/templates/redis-sentinel.conf.j2 (+0, -12)
ansible/roles/redis/vars/main.yml (+0, -2)
ansible/roles/valkey/tasks/check-containers.yml (+0, -0)
ansible/roles/redis/defaults/main.yml (+0, -78)
ansible/roles/redis/tasks/check.yml (+0, -11)
etc/kolla/globals.yml (+10, -10)
releasenotes/notes/replace-redis-with-valkey-8f60e01c2460a301.yaml (+12, -0)
zuul.d/scenarios/octavia.yaml (+3, -3)
ansible/group_vars/all/common.yml (+1, -1)
zuul.d/scenarios/telemetry.yaml (+3, -2)
tests/templates/globals-default.j2 (+19, -4)
ansible/roles/valkey/templates/valkey-sentinel.json.j2 (+22, -0)
zuul.d/scenarios/cephadm.yaml (+3, -3)
doc/source/reference/networking/designate-guide.rst (+3, -3)
ansible/roles/octavia/tasks/precheck.yml (+3, -3)
ansible/roles/octavia/templates/octavia.conf.j2 (+4, -5)
ansible/roles/valkey/tasks/config_validate.yml (+0, -0)
ansible/roles/gnocchi/templates/gnocchi.conf.j2 (+4, -4)
tests/templates/inventory.j2 (+4, -0)
ansible/inventory/multinode (+1, -1)
ansible/roles/cron/templates/cron-logrotate-redis.conf.j2 (+0, -3)
ansible/group_vars/all/gnocchi.yml (+2, -2)
ansible/roles/fluentd/templates/conf/input/14-valkey.conf.j2 (+16, -0)
ansible/roles/valkey/tasks/upgrade.yml (+134, -0)
tests/check-logs.sh (+1, -0)
ansible/group_vars/all/ironic.yml (+1, -1)
ansible/roles/valkey/tasks/deploy-containers.yml (+0, -0)
ansible/roles/cinder/templates/cinder.conf.j2 (+2, -2)
ansible/inventory/all-in-one (+1, -1)
ansible/roles/fluentd/tasks/config.yml (+2, -0)
ansible/roles/redis/templates/redis.json.j2 (+0, -18)
ansible/group_vars/all/redis.yml (+0, -11)
ansible/roles/redis/tasks/config.yml (+0, -26)
doc/source/admin/password-rotation.rst (+1, -1)
ansible/roles/cinder/tasks/precheck.yml (+1, -1)
ansible/roles/valkey/templates/valkey-sentinel.conf.j2 (+12, -0)
ansible/roles/mistral/templates/mistral.conf.j2 (+1, -1)
ansible/roles/cron/tasks/config.yml (+1, -1)
ansible/roles/prometheus/defaults/main.yml (+2, -2)
ansible/roles/redis/tasks/precheck.yml (+0, -29)
ansible/roles/valkey/templates/valkey-server.conf.j2 (+29, -0)
ansible/roles/redis/templates/redis.conf.j2 (+0, -55)
ansible/roles/valkey/vars/main.yml (+2, -0)
ansible/roles/valkey/handlers/main.yml (+6, -6)
ansible/roles/valkey/tasks/deploy.yml (+0, -0)
ansible/roles/telegraf/templates/telegraf.conf.j2 (+2, -2)
etc/kolla/passwords.yml (+3, -1)
ansible/roles/valkey/tasks/pull.yml (+0, -0)
zuul.d/scenarios/ovn.yaml (+0, -1)
ansible/group_vars/all/cinder.yml (+2, -2)
ansible/roles/masakari/tasks/precheck.yml (+8, -0)
zuul.d/scenarios/masakari.yaml (+3, -2)
ansible/group_vars/all/designate.yml (+2, -2)
ansible/roles/valkey/defaults/main.yml (+78, -0)
ansible/roles/cron/templates/cron-logrotate-valkey.conf.j2 (+3, -0)
ansible/roles/prechecks/tasks/service_checks.yml (+7, -0)
ansible/roles/valkey/templates/valkey-server.json.j2 (+18, -0)
ansible/group_vars/all/masakari.yml (+1, -1)
ansible/group_vars/all/valkey.yml (+30, -0)
",-1.847655,1.884518,-1.576213,0.494272,-0.021825,0.628677,-0.154017,-0.000387,-0.461349,-0.073003,1.07269,0.562851,0.399459,0.040719,-0.672089
openstack/kolla,I6033521fc1fefe55f685914f823d58c96f68611a,1,0,0.5149,1.0986,1.0,1,3.25,199,0,CI,1,0,0,369,0.015087,0.7778,0,0.4005,1,1,0,0.6256,0.0,1.0,-76.29,22.84,0,0,1.0,0,66.3333,0,0,0,0,0,"CI: Drop zun jobs

Similar to https://review.opendev.org/c/openstack/kolla-ansible/+/959307
[SEP]
FILES CHANGED:
.zuul.d/ubuntu.yaml (+0, -2)
",-0.156819,4.038966,-1.920868,-0.228486,-1.2225,0.354198,-0.070053,-0.568416,-0.08712,-0.668322,-0.622938,0.105197,-0.167002,-0.212404,-0.212135
openstack/ironic,I8ee7ed7167362438da396aed6980a027ceaaaa72,1,0,0.9778,2.4849,0.4545,2,15.33,321,0,Bug Fix,0,0,0,45,0.013259,0.0,0,0.0,2,2,0,0.9603,0.994,2.0,42.3,13.09,0,0,0.0,1,26.75,0,0,0,0,0,"fix: remove wait logic in pxe filter

Ironic has an issue, we don't run pxe filter in its CI so when
we removed the wait for start logic which is available and possible
with eventlet, we broke the pxe filter.
[SEP]
FILES CHANGED:
ironic/command/pxe_filter.py (+0, -5)
releasenotes/notes/fix-pxe-filter-post-eventlet-1d12665dbfe11564.yaml (+6, -0)
",0.893193,-1.990007,0.111431,0.03711,-0.450059,-0.307377,0.29211,-0.744472,-0.89432,-0.276384,0.069705,-0.273268,0.088029,-0.013561,0.340958
openstack/ironic,I5190cf2bb68f62448cce3659ee7f42951a304558,1,0,0.6667,2.1972,0.125,1,6.43,351,0,CI,0,0,0,3,0.023622,0.0,0,0.0,2,1,0,0.9605,0.0,2.0,38.63,11.46,1,0,0.0,0,39.0,0,0,0,0,0,"Avoid the wsgi application to start with eventlet

When starting the wsgi application (e.g. using uWSGI), the app will
start using oslo_service eventlet backend.

We explicitely need to force the threading backing until it will be set
the default.
[SEP]
FILES CHANGED:
ironic/wsgi/__init__.py (+7, -1)
",0.299041,-1.767073,-0.201399,0.560776,-0.184268,-0.39807,0.258656,-0.126241,-0.247025,-0.069325,-0.296886,0.134326,-0.153873,-0.158493,-0.087079
openstack/kolla,I9394e5ecf913385870396fa51401748ca0de5e22,0,0,0.7097,3.7612,0.5,2,6.67,188,0,Bug Fix,1,0,0,62,0.069042,1.0,0,0.7097,2,2,0,0.6265,0.2762,1.5,13.95,14.67,0,0,1.0,0,4.3721,0,0,0,0,0,"CI: fix secrets for erlang COPR periodic job

It was created with extra newlines.
[SEP]
FILES CHANGED:
tests/playbooks/copr-erlang-update.yml (+1, -1)
.zuul.d/base.yaml (+20, -20)
",3.181412,-1.25492,1.026677,-0.833956,-0.700437,0.424383,0.352126,-0.104691,-0.354968,-0.138992,0.191116,-0.482759,0.018387,0.185269,-0.147919
openstack/kayobe,Ib92ae8807a5f22090d3025ff93d279004e686870,1,1,1.0,2.3026,0.1111,2,3.5,412,0,Bug Fix,0,0,0,7,0.065421,0.8824,0,0.8824,2,2,0,0.9038,0.7642,1.0,-7.01,11.69,0,0,0.0,1,41.2,0,6,0,9,0,"Move nvidia.nvue to 1.2.9 for cumulus 5.13

Changed switch config started creating errors on cumulus 5.13
onwards. Bumping the collection version to bring in this fix:

https://gitlab.com/nvidia-networking/systems-engineering/nvue/-/commit/adfc6829ee0fadbcd5273a7635f26d6a79b44eab

Closes-Bug: #2131677
[SEP]
FILES CHANGED:
releasenotes/notes/fixes-cumulus-5.13-74e0d08675404f46.yaml (+7, -0)
requirements.yml (+1, -1)
",-1.473689,0.898023,-1.117955,-0.932474,-0.061201,-0.287175,0.649209,0.456278,0.027984,0.584992,-0.158681,-0.407731,0.339223,-0.044793,0.525973
openstack/charm-nova-compute,Ie267ca873e1f814267faed6939d047641b20e680,1,1,0,4.4998,0.0337,4,11.57,656,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,2,3,0,1.0,1.4913,1.0,12.31,16.97,1,0,0.5056,1,7.2889,0,112,0,24,0,"Add Workaround to Disable Live Migration Pre-check

Add two workaround section parameters: skip_cpu_compare_at_startup and
skip_cpu_compare_on_dest which disable the Nova pre-migration hypervisor
compatibility checks at startup and on the destination. Libvirt
maintains authority in this case and still validates the migration
before performing it.  Leave the Nova checks enabled by default. The
intention is for this to be a stop-gap until a proper fix to the Nova
checks is developed and backported as applicable.

Closes-Bug: #2039803
[SEP]
FILES CHANGED:
templates/yoga/nova.conf (+6, -0)
hooks/nova_compute_context.py (+4, -0)
config.yaml (+34, -0)
unit_tests/test_nova_compute_contexts.py (+42, -3)
",-1.12016,-0.636147,0.22068,0.449006,0.11032,0.136722,0.085398,0.135381,0.374857,-0.186097,0.571414,0.164464,-0.085398,-0.272289,0.369345
openstack/ironic,I2aabe72f4d28ec55727e06788d3a9d2976dda4bb,1,0,0.75,3.7377,0.2683,3,5.89,459,0,Doc,0,0,0,4,0.02963,0.0,0,0.0,4,3,0,0.9608,1.5121,2.67,2.93,12.17,1,0,0.0,1,10.9286,0,0,0,0,0,"Deprecate usage of ironic.api.wsgi:initialize_wsgi_app

Using ironic.api.wsgi:initialize_wsgi_app to provide custom config file
to ironic will prevent the oslo_backend to be set to threading and will
bypass the RLock on threading leading to race condition during threads
starts.

Instead, document a way to give config dir/file from environment
variables.
[SEP]
FILES CHANGED:
ironic/common/config.py (+14, -1)
releasenotes/notes/deprecate-wsgi-args-31112fb7db5499d1.yaml (+8, -0)
doc/source/install/include/configure-ironic-api-wsgi.inc (+8, -10)
",-0.703101,-0.575976,-0.014511,0.692372,0.247748,-0.630133,0.02155,0.085529,0.053384,-0.055262,-0.193397,-0.494397,-0.295347,-0.230972,0.154554
openstack/openstack-ansible-os_cinder,I40d7fffd77ce4c6bff58279ba6bc0c5858b7452c,1,0,0.9582,0.6931,0.0,1,11.43,609,0,CI,0,0,0,239,0.05378,0.973,0,0.9323,1,1,0,1.0,0.0,1.0,24.98,14.57,0,0,0.0,0,304.5,0,0,0,0,0,"Generate certificates only for API hosts

Right now PKI role is included based of `cinder_backend_ssl`
variable, which might be globally overridable with
`openstack_service_backend_ssl`.

At the same time these certificates are used only for uWSGI, as
a backend web server, and not used anywhere else. But they will
be issued for cinder-volume and cinder-backup without any need.

Extended condition will check if we are running against a group which
also need certificates to be present.
[SEP]
FILES CHANGED:
tasks/main.yml (+1, -0)
",-0.742807,-1.380877,0.418424,0.442096,0.240198,-0.387625,0.244754,0.100547,0.126113,-0.246536,-0.072209,-0.288982,-0.357857,-0.344315,-0.239195
openstack/kolla-ansible,I043b404f65b3faf22f73ca04c8d2417d99bae854,1,0,0.6984,1.6094,0.0,1,2.88,358,0,Feature,0,0,0,63,0.067021,0.2273,0,0.1587,1,1,0,0.6426,0.0,1.0,-86.67,20.28,0,0,0.0,0,71.6,0,0,0,0,0,"letsencrypt: add max_fail_percentage to site.yml

Missed as letsencrypt landed just before max_fail_percentage [1][2].

[1] https://review.opendev.org/c/openstack/kolla-ansible/+/805598
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/741340
[SEP]
FILES CHANGED:
ansible/site.yml (+4, -0)
",-1.743968,4.393704,-1.229324,0.768337,-0.269605,0.048502,0.719889,-0.52407,-0.066842,0.130565,0.354343,-0.530846,0.05748,-0.068233,0.072826
openstack/ironic,Iba84bbe5da541700d20a445818a4a0d584f1eca8,1,0,0.9756,6.1137,0.3149,6,8.9,1265,0,Bug Fix,0,0,0,41,0.011298,1.0,0,0.9756,4,2,0,0.961,1.7464,2.67,37.64,11.26,1,0,0.2151,1,2.7987,0,0,0,0,0,"Fix OCI artifacts pointing to a single manifest

When using ORAS to upload a file to Quay, the tag points directly to
the manifest, not to the index of manifests. Currently, Ironic is not
capable of handling the former.

First, GET API to a manifest does not accept
application/vnd.oci.image.index.v1+json, only
application/vnd.oci.image.manifest.v1+json, so indicate that we
understand both.

Second, the logic in the OCI image service needs to be adjusted to this
case. If the index is a manifest, it is now treated the same as an index
with only that manifest.

Third, the manifest's body does not contain its own digest. Instead, it
can be fetched from the docker-content-digest header, so get it and
store as a virtual field dockerContentDigest.

As part of the change, I had to refactor identify_specific_image since
it exceeded the allowed complexity with my changes.

Also fix get_blob_url to work with image URLs without oci://. This is
not possible to trigger through the API but ensures internal
consistency.

Also provide more specific error messages instead of piling everything
under the very generic ImageNotFound and provide more logging.
[SEP]
FILES CHANGED:
ironic/common/exception.py (+5, -0)
ironic/tests/unit/common/test_image_service.py (+41, -1)
ironic/tests/unit/common/test_oci_registry.py (+49, -6)
ironic/common/oci_registry.py (+67, -18)
ironic/common/image_service.py (+142, -117)
releasenotes/notes/oci-fixes-bbbcc633394252f6.yaml (+5, -0)
",-2.761746,-0.210828,3.439757,-0.360627,-0.48432,0.136928,-0.065324,-0.3454,0.062168,-0.160081,-0.337306,0.37527,-0.212874,0.136979,-0.088063
openstack/ironic,I08e6bef63478df7c69a3f1f9864859a95c2e755e,1,0,1.0,1.0986,0.5,1,5.0,136,0,Bug Fix,0,0,0,8,0.009174,1.0,0,1.0,4,1,0,0.9613,0.0,4.0,-68.96,26.0,1,0,0.0,0,45.3333,0,0,0,0,0,"api: Fix off-by-one error
[SEP]
FILES CHANGED:
ironic/api/controllers/v1/allocation.py (+1, -1)
",3.038536,1.143035,2.011675,-0.374086,-0.678635,0.534182,-0.441378,-0.533972,0.216725,0.424018,-0.214007,0.283543,0.435508,0.267305,0.429911
openstack/kolla,I37f4515587cb040296612e35d4c643f0c2bea6f6,0,0,0.5162,2.1972,0.375,3,4.67,151,0,Feature,0,0,1,370,0.015127,0.6154,0,0.3177,3,2,0,0.625,1.5,1.67,8.73,19.01,1,0,0.5,0,16.7778,0,0,0,0,0,"Bump Ansible to 12 and ansible-core to 2.19
[SEP]
FILES CHANGED:
docker/bifrost/bifrost-base/Dockerfile.j2 (+1, -1)
test-requirements.txt (+3, -1)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",0.268893,2.567094,-0.667971,0.696832,1.420463,0.281195,-0.688437,0.147484,-1.060836,1.418995,0.231455,0.587985,-0.130637,0.629957,0.520795
openstack/kolla-ansible,If8a29052d8a43ffc0fef11514adabb5e4ab9d977,0,0,0.5148,5.793,0.3639,50,2.23,431,0,Feature,0,0,1,371,0.015163,1.0,0,0.5148,4,4,0,0.643,4.3345,3.22,-95.91,18.82,1,0,0.4954,1,1.314,0,0,0,0,0,"Bump ansible-core to 2.18/2.19

Bumped collections in requirements-core.yml to Ansible 12 major versions,
see [1].

[1]: https://github.com/ansible-community/ansible-build-data/blob/main/12/ansible-12.1.0.yaml

Depends-On: https://review.opendev.org/c/openstack/kolla/+/960307

Co-authored-by: Doug Szumski doug@stackhpc.com
[SEP]
FILES CHANGED:
ansible/module_utils/kolla_docker_worker.py (+5, -2)
ansible/roles/ceilometer/tasks/config.yml (+1, -1)
test-requirements.txt (+28, -0)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+1, -1)
ansible/roles/horizon/tasks/policy_item.yml (+1, -1)
ansible/roles/cloudkitty/tasks/config.yml (+1, -1)
ansible/roles/barbican/tasks/config.yml (+1, -1)
ansible/roles/prechecks/vars/main.yml (+2, -2)
ansible/roles/ovn-db/tasks/bootstrap-initial.yml (+4, -4)
ansible/roles/magnum/tasks/config.yml (+1, -1)
ansible/roles/keystone/tasks/config.yml (+1, -1)
requirements-core.yml (+5, -5)
ansible/action_plugins/merge_configs.py (+12, -1)
ansible/roles/ironic/tasks/config.yml (+1, -1)
ansible/group_vars/all/common.yml (+1, -1)
ansible/roles/octavia/tasks/config.yml (+1, -1)
ansible/action_plugins/merge_yaml.py (+11, -1)
ansible/roles/watcher/tasks/config.yml (+1, -1)
ansible/roles/placement/tasks/config.yml (+1, -1)
ansible/roles/tacker/tasks/config.yml (+1, -1)
ansible/roles/designate/tasks/config.yml (+1, -1)
ansible/roles/venus/tasks/config.yml (+1, -1)
ansible/roles/gnocchi/tasks/config.yml (+1, -1)
tests/test_kolla_toolbox.py (+52, -47)
ansible/roles/mistral/tasks/config.yml (+1, -1)
ansible/roles/nova/tasks/map_cell0.yml (+1, -1)
ansible/roles/neutron/defaults/main.yml (+6, -6)
ansible/roles/kuryr/tasks/config.yml (+1, -1)
ansible/roles/trove/tasks/config.yml (+1, -1)
requirements.txt (+1, -1)
ansible/roles/cyborg/tasks/config.yml (+1, -1)
ansible/module_utils/kolla_podman_worker.py (+9, -5)
ansible/roles/heat/tasks/config.yml (+1, -1)
ansible/roles/manila/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/tasks/create_cells.yml (+2, -2)
ansible/module_utils/kolla_container_worker.py (+1, -1)
ansible/roles/aodh/tasks/config.yml (+1, -1)
ansible/roles/neutron/tasks/config.yml (+1, -1)
doc/source/conf.py (+4, -4)
zuul.d/base.yaml (+5, -5)
ansible/roles/nova/tasks/config.yml (+1, -1)
ansible/roles/cinder/tasks/config.yml (+1, -1)
ansible/roles/nova-cell/tasks/config.yml (+1, -1)
ansible/roles/glance/tasks/config.yml (+1, -1)
releasenotes/notes/ansible-2.19-986e55799b72dbf5.yaml (+5, -0)
zuul.d/project.yaml (+1, -1)
zuul.d/python3-jobs.yaml (+23, -0)
ansible/roles/masakari/tasks/config.yml (+1, -1)
ansible/roles/blazar/tasks/config.yml (+1, -1)
ansible/roles/zun/tasks/config.yml (+1, -1)
",-2.125754,2.654496,-1.007088,-0.042254,-0.973277,-0.469826,-0.049687,0.438153,-0.07905,0.266948,-0.07061,-0.017794,-0.05246,0.498287,-0.212545
openstack/kolla-ansible,Iaab9e1838575853237d661f7f7e72e714577d800,1,0,0.6667,0.6931,0.0,1,8.4,355,0,Feature,0,0,0,3,0.272727,0.8333,0,0.5556,4,1,0,0.6423,0.0,4.0,35.15,14.79,0,0,0.0,0,177.5,0,0,0,0,0,"rabbitmq: mark new version-check as unchanged

The task to get the new RabbitMQ version now sets changed_when: false to avoid reporting changes during deployments.
This ensures cleaner playbook output and prevents false positives in change reporting.
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+1, -0)
",0.885607,-1.536036,-0.094266,0.454289,-0.075911,0.018623,0.435781,-0.144119,0.164709,0.020428,-0.110955,-0.013321,-0.077648,-0.370281,-0.045367
openstack/kolla,If1a078d2704fbd0b119d6c1ffc5a10aeff0a150a,0,0,0.5134,1.9459,0.1667,2,4.25,171,0,Feature,0,0,0,372,0.015003,0.3333,0,0.1711,2,2,0,0.6235,0.9183,2.0,3.46,15.82,1,0,0.0,1,24.4286,0,0,0,0,0,"gnocchi: Bump to 4.7.0

This is required for uwsgi module usage
[SEP]
FILES CHANGED:
kolla/common/sources.py (+1, -1)
releasenotes/notes/gnocchi-4_7_0-fdb7f76d367ee435.yaml (+4, -0)
",2.314338,-0.396706,-0.159668,-0.473979,-0.428532,0.542905,-0.21804,0.301659,-0.284649,0.516376,-0.13737,0.318153,-0.954313,0.193148,0.305721
openstack/kolla-ansible,I52ea761bd5375a94339f25ce0e77df6f78f6d9eb,0,0,0.5121,3.8067,0.1136,5,5.0,129,0,Feature,0,0,0,373,0.01504,0.4,0,0.2048,4,3,0,0.6427,1.9156,3.6,-35.12,22.0,1,0,0.0,1,2.8667,0,0,0,0,0,"aodh: Switch to uWSGI
[SEP]
FILES CHANGED:
ansible/roles/aodh/templates/aodh-api.json.j2 (+11, -4)
ansible/roles/aodh/defaults/main.yml (+6, -0)
ansible/roles/aodh/tasks/config.yml (+17, -1)
ansible/roles/aodh/templates/aodh.conf.j2 (+3, -0)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
",2.94551,0.897228,1.077912,-0.835661,0.002369,0.56088,-0.12995,-0.080906,-0.395781,0.170719,0.240399,-0.270156,-0.158989,0.067335,0.441252
openstack/ansible-role-zookeeper,I489c5507d94b48ef3a75dbefde21433dce4b392a,1,0,1.0,1.0986,0.5,1,7.33,236,0,Feature,0,0,0,2,0.027027,0.9048,0,0.9048,1,1,0,1.0,0.0,1.0,-31.34,19.3,0,0,0.0,0,78.6667,0,0,0,0,0,"Update Java package for RHEL

In RHEL 10 unavailable java-11-openjdk-headless package, we update it until java-21-openjdk-headless.
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -1)
",-0.091592,1.53242,-1.246568,0.547518,1.046954,-0.86625,-0.557817,0.278226,-0.651228,-0.12621,-0.243844,1.16296,-0.013877,0.430328,0.676759
openstack/ironic,I62095c2b61d14688d2dcbcdcfd29e9391af2c0ba,1,0,1.0,4.7005,0.0183,3,14.67,377,0,Feature,0,0,0,5,0.012887,1.0,0,1.0,6,2,0,0.9615,0.9523,4.0,13.13,18.59,1,0,0.7798,1,3.4273,0,0,0,0,0,"Make cache_firmware_components more resilient during upgrades

There have been reports of firmware upgrades failing on Gen11 iLO
machines with GET NetworkAdepters returning 400s responses. This change
attempts to resolve this by catching the exception relevant to the fault
[SEP]
FILES CHANGED:
releasenotes/notes/networkadapters-fix-ilo-gen11-2f43f4fbdb995231.yaml (+7, -0)
ironic/tests/unit/drivers/modules/redfish/test_firmware.py (+85, -0)
ironic/drivers/modules/redfish/firmware.py (+15, -2)
",-0.236984,-1.27867,-0.465602,0.408217,-0.018731,0.193231,-0.173156,-0.122117,0.028034,-0.046854,-0.174257,-0.074978,-0.099319,-0.905691,0.0615
openstack/kolla,Ia47af98ff723ebe8ea8461d05a2bc3b58af845f9,0,0,0,3.3322,0.0,3,10.2,487,0,Feature,0,0,0,0,0.0,0.0,0,0.0,3,3,0,0.6221,1.173,2.67,-12.53,18.98,1,0,0.0,1,17.3929,0,0,0,0,0,"neutron-metadata-agent: copy wrapper script for haproxy processes

In ml2/ovn setups, the neutron-metadata-agent spawns haproxy processes
to serve metadata requests. To run these haproxy instances inside their
own containers, the wrapper script must be available in the
metadata-agent container.
This is a follow up on I679ac66186d457ae53f89469fe22c5662089019a
[SEP]
FILES CHANGED:
releasenotes/notes/neutron-metadata-agent-wrapper-scripts-d6163080d169ea14.yaml (+7, -0)
docker/neutron/neutron-metadata-agent/Dockerfile.j2 (+2, -0)
docker/neutron/neutron-metadata-agent/extend_start.sh (+18, -0)
",-1.540708,-0.172234,-1.045147,0.061107,0.74405,-0.331993,0.700323,0.190642,0.224492,-0.249899,0.225625,0.3397,0.5383,0.118394,0.068641
openstack/kayobe,Ia91e5539f4338c8209fbe92739bce916c10b2b7a,1,1,0.8,3.2581,0.44,3,12.25,417,0,Bug Fix,0,0,0,10,0.039841,1.0,0,0.8,3,2,0,0.9045,1.5166,2.0,16.57,17.14,1,0,0.28,1,16.0385,0,6,0,9,0,"Explicity set --check and --diff in kolla-ansible

Kolla Ansible no longer supports appending the content of the EXTRA_OPTS
environment variable to the ansible-playbook command. Kolla Ansible now
supports --check and --diff as explicit CLI arguments, so explicitly
pass them into kolla-ansible.

Closes-Bug: #2123834
[SEP]
FILES CHANGED:
kayobe/tests/unit/test_kolla_ansible.py (+4, -3)
kayobe/kolla_ansible.py (+4, -8)
releasenotes/notes/kolla-check-diff--extra-opts-03bc183075f59ada.yaml (+6, -0)
",-1.01804,-0.181529,-0.782899,0.546671,0.305128,-0.519037,-0.70185,-0.171086,-0.224751,-0.088118,0.286359,-0.025171,0.300237,0.03124,0.298105
openstack/kolla-ansible,Ibaf8af1de66f76772a617b05467ba611d0bbd20d,1,1,0.8182,2.0794,0.4286,2,11.33,318,0,Bug Fix,0,0,0,11,0.039855,0.7333,0,0.6,3,2,0,0.6419,0.9852,2.5,-8.7,21.0,1,0,0.0,1,39.75,0,6,0,9,0,"Remove reference to EXTRA_OPTS in documentation

Passing the contents of EXTRA_OPTS into
ansible-playbook is no longer supported, so remove
reference to this functionality from the documentation.

Closes-Bug: #2123837
[SEP]
FILES CHANGED:
releasenotes/notes/docs-remove-extra-opts-9f68a9b3dd9f14c1.yaml (+4, -0)
doc/source/user/operating-kolla.rst (+0, -3)
",-0.553859,-0.084612,-0.928365,0.574553,-0.011819,0.39656,-1.133351,-0.3264,0.098669,-0.117859,0.272332,-0.045965,0.089684,0.065656,0.308316
openstack/octavia,I4a6e4830d0e916b1af1a11dd10097980a57d97ea,1,1,0,3.1781,0.2609,3,17.5,567,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,5,2,0,0.6171,1.3709,4.0,13.83,19.0,0,0,0.0,1,23.625,1,12,0,22,0,"Fix race condition in cascade delete

update_vip was called multiple times concurrently when cascade deleting
a load balancer with many listeners, it may trigger a race condition
when fetching, computing and updating the SGs.
Calling update_vip for each listener is not necessary, it's now called
only once, that fixes the race condition and optimize the delete flow.

Closes-Bug: #2038529
(cherry picked from commit 5c802aad949e4abd878f326c53123ddf8a299be0)
[SEP]
FILES CHANGED:
releasenotes/notes/fix-potential-race-conditions-in-cascade-delete-1e100213445a17ec.yaml (+7, -0)
octavia/controller/worker/v2/flows/load_balancer_flows.py (+10, -3)
octavia/controller/worker/v2/flows/listener_flows.py (+0, -3)
",-1.210132,-1.389753,0.180581,-0.885855,0.358795,0.014321,0.71049,-0.216187,0.362354,0.084102,0.217238,-0.182245,0.058429,-0.151527,0.289816
openstack/openstack-ansible-openstack_hosts,Ibea7eceecf1db4bc767f0c55b5c5585a05e37cb1,1,0,1.0,3.4012,0.6207,1,13.75,434,0,Bug Fix,0,0,0,3,0.039474,1.0,0,1.0,1,1,0,0.8571,0.0,1.0,25.22,15.68,0,0,0.0,0,14.4667,1,0,0,0,0,"Fix configuration fastestmirror for DNF

Remove task ""Check to see if yum's fastestmirror plugin is present"" - this not need for RHEL9/10

Task ""Configure dnf fastestmirror"" - complete updated for correct enable fastestmirror in RHEL9/10.

And update rule for task ""Enable CodeReadyBuilder repository"" - this need for RHEL10 too.
[SEP]
FILES CHANGED:
tasks/openstack_hosts_configure_dnf.yml (+11, -18)
",-0.722502,-0.559907,-0.229694,0.189671,0.573273,-0.045353,-0.709292,0.404412,-0.424581,0.240563,-0.222603,-0.101806,0.351936,0.069225,0.216464
openstack/openstack-ansible-os_keystone,I0e4585e85426e57d3a2d6fc86ac2d6df00c09c79,1,1,1.0,1.6094,0.25,1,3.85,492,0,Bug Fix,0,0,0,4,0.038095,0.9091,0,0.9091,1,1,0,1.0,0.0,1.0,1.58,14.34,0,0,0.0,0,98.4,1,24,0,5,0,"Fix for fails to reload httpd due to unsupported OIDCXForwardedHeaders

In Rocky Linux 9, maximum available version package is
mod_auth_openidc-2.4.10-1.el9_6.2.x86_64

In Rocky Linux 10 is mod_auth_openidc-2.4.15-4.el10_0.1.x86_64

It is necessary to check the value of:
_keystone_sp_apache_mod_auth_openidc_gte_2_4_11

according to the version of operating system.

Closes-Bug: #2123161
[SEP]
FILES CHANGED:
vars/redhat.yml (+3, -1)
",-2.194504,-0.015483,0.108306,-0.827897,0.546871,-0.194023,-0.698895,0.84684,0.143449,0.229509,0.151161,-0.209918,-0.744422,0.228241,0.26611
openstack/kolla-ansible,I1f08f9b9064d9f7e95b07944db0e7ebac3120c57,0,0,0.5107,7.669,0.5136,31,9.38,535,0,CI,0,0,0,374,0.015053,1.0,0,0.5107,3,4,0,0.6423,3.8662,1.81,41.66,14.42,1,0,0.9972,1,0.2499,0,0,0,0,0,"CI: Reorganise scenarios into project templates

This patch moves into using project templates, which is easier
to organise.

base_distro and upgrade variables are derived from base.yaml
and respective job name - so don't need to be specified in each
job anymore.

All jobs will now also have an OS release specified, so it's easier
to add different OS release jobs (e.g. when backporting new release
support to stable branch).
[SEP]
FILES CHANGED:
zuul.d/scenarios/nfv.yaml (+37, -0)
zuul.d/scenarios/skyline.yaml (+51, -0)
zuul.d/scenarios/prometheus-opensearch.yaml (+55, -0)
zuul.d/scenarios/ironic.yaml (+53, -0)
zuul.d/scenarios/kvm.yaml (+29, -0)
zuul.d/scenarios/bifrost.yaml (+31, -0)
zuul.d/scenarios/mariadb.yaml (+41, -0)
tests/test-hashicorp-vault-passwords.sh (+2, -2)
zuul.d/nodesets.yaml (+24, -40)
zuul.d/scenarios/magnum.yaml (+36, -0)
tests/upgrade.sh (+1, -1)
zuul.d/scenarios/container-engine-migration.yaml (+42, -0)
zuul.d/scenarios/octavia.yaml (+34, -0)
tests/run.yml (+2, -2)
zuul.d/scenarios/venus.yaml (+42, -0)
zuul.d/scenarios/cells.yaml (+34, -0)
zuul.d/scenarios/telemetry.yaml (+33, -0)
tests/templates/globals-default.j2 (+1, -1)
zuul.d/scenarios/ovn.yaml (+49, -0)
zuul.d/base.yaml (+9, -365)
zuul.d/scenarios/cephadm.yaml (+59, -0)
zuul.d/scenarios/lets-encrypt.yaml (+37, -0)
roles/openstack-clients/defaults/main.yml (+3, -3)
zuul.d/scenarios/ipv6.yaml (+38, -0)
zuul.d/scenarios/masakari.yaml (+36, -0)
zuul.d/project.yaml (+24, -59)
zuul.d/scenarios/aio.yaml (+130, -0)
zuul.d/scenarios/hashi-vault.yaml (+35, -0)
zuul.d/scenarios/zun.yaml (+39, -0)
zuul.d/jobs.yaml (+0, -626)
zuul.d/scenarios/haproxy-fqdn.yaml (+34, -0)
",-0.299089,-2.054283,0.579585,0.351723,-0.142688,-0.540695,0.183541,-0.132903,-0.437534,0.32669,-0.350336,-0.384559,0.02149,0.369213,-0.249868
openstack/ansible-collection-kolla,If69d55ff124f4ce1807f97c180dd5ba20ca8ba42,0,0,0.5093,2.3026,0.4444,2,17.5,311,0,Doc,0,0,0,375,0.013897,0.6,0,0.3056,3,1,0,0.4167,0.5033,3.0,12.62,20.71,1,0,0.0,0,31.1,0,0,0,0,0,"docker/podman_sdk: Remove dbus-glib-devel since it's missing in EL10

EL10 doesn't package it anymore and glib2-devel is the replacement

Sync the list of installed packages in both docker and podman_sdk
[SEP]
FILES CHANGED:
roles/docker_sdk/defaults/main.yml (+0, -1)
roles/podman_sdk/defaults/main.yml (+5, -3)
",-0.05002,0.438282,-0.929676,0.555758,0.567458,-0.74566,0.137478,-0.088882,-0.850998,-0.51666,0.064845,-0.282124,-0.262643,0.086948,0.199564
openstack/kolla-ansible,Ie08bdb264a750c8c264b6cfb3b75b1aea674a617,0,0,0.6364,1.0986,0.5,1,5.55,644,0,Bug Fix,0,0,0,22,0.009946,0.0,0,0.0,4,1,0,0.6416,0.0,4.0,-22.08,14.68,1,0,0.0,0,214.6667,0,0,0,0,0,"Fix IPA callback URL for unmanaged inspection

The builtin inspector uses the continue_inspection endpoint[1], whilst
the standalone inspector uses continue[2].

The symptom is that you get an 401 status code when posting back the
inspection data. This doesn't affect managed inspection since ironic
will generate a per node ipxe script.

[1] https://docs.openstack.org/ironic/latest/install/configure-pxe.html#configure-unmanaged-inspection
[2] https://docs.openstack.org/ironic-inspector/latest/install/index.html#configuration

TrivialFix
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ipa.ipxe.j2 (+1, -1)
",-2.780014,1.539377,-0.076087,0.581982,-0.048282,-0.061923,-0.256288,0.08548,0.050298,0.166781,0.096835,0.055217,0.077842,0.047988,-0.152831
openstack/ironic-python-agent-builder,I8f32124769b62cbfca0dc54149b3620f342fc78a,1,0,0.9783,2.7081,0.0714,1,24.0,546,0,Feature,0,0,0,46,0.01351,0.0,0,0.0,3,1,0,1.0,0.0,3.0,12.1,21.27,0,0,0.0,0,36.4,0,0,0,0,0,"Add additional firmware images which are not needed

Recently it appears that some newer hardware greatly restricts
the overall amount of memory available to boot the kernel, and
as an intermediate solution we aggressively prune out wireless,
bluetooth, and other non-ethernet firmware images from the
list of firmware to exclude, in order to maximize savings
and reduce the overall memory footprint required before
the kernel boots.
[SEP]
FILES CHANGED:
dib/ironic-python-agent-ramdisk/environment.d/10-defaults.bash (+13, -1)
",-1.496764,-1.660754,-0.232019,1.394151,0.497276,-0.094787,-0.14471,-0.480742,0.21069,0.348384,-0.61076,0.670026,0.504959,-0.268739,0.058002
openstack/openstack-ansible-os_neutron,I25d517d7590a358ee15ddaa2d89b42f54207b518,1,1,0.9583,2.7081,0.5,1,11.33,517,0,Bug Fix,0,0,0,240,0.053993,0.9429,0,0.9036,1,1,0,0.9231,0.0,1.0,27.38,13.95,0,0,0.0,0,34.4667,0,10,0,29,0,"Ensure neutron_use_uwsgi is treated a bool

In case the value is passed as an extra arg, it may be treated as
a string, leading to an unexpected behavior.  For instnace.
`""{{ neutron_use_uwsgi | ternary('started', 'stopped') }}""` will result
in `started` if playbook is run with `-e neutron_use_uwsgi=false`

However, if value will be defined in a file, it will be respected.

Closes-Bug: #2096937
[SEP]
FILES CHANGED:
vars/main.yml (+7, -7)
",-1.376133,-1.17368,0.105718,-0.071039,0.190415,0.012961,-0.466985,-0.571762,0.291413,0.065312,0.362159,-0.492843,-0.139788,-0.136719,-0.227425
openstack/kolla,I80070b3c3658948c7157564fb8a79e6dd427f1d1,1,0,0.508,0.6931,0.0,1,6.0,137,0,CI,1,0,0,376,0.013929,0.5625,0,0.2857,2,1,0,0.6206,0.0,2.0,-10.75,22.4,1,0,1.0,0,68.5,0,0,0,0,0,"CI: Use UCA mirror for Ubuntu
[SEP]
FILES CHANGED:
tests/templates/template_overrides.j2 (+1, -0)
",3.248774,1.180017,1.158851,0.132681,0.350474,0.819995,-0.110574,0.820553,-0.498298,0.367796,0.346463,0.128716,0.633188,-0.15808,-0.209216
openstack/kolla-ansible,Ie3b38876933a234dc7e9782377f4b0128395827f,1,1,0.5093,3.3673,0.1429,1,10.5,214,0,Bug Fix,0,0,0,377,0.013966,0.4,0,0.2037,4,1,0,0.6408,0.0,4.0,22.95,17.53,0,0,0.0,0,7.3793,0,6,0,12,0,"ovn: Add retries to set-connection commands

Break down long commands to YAML blocks

Closes-Bug: #2124397
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+24, -4)
",1.902898,-1.452049,-0.044587,-0.954885,-0.89122,0.210558,-0.687285,0.258764,0.146797,-0.279333,-0.051139,-0.309524,0.017681,0.187696,-0.036269
openstack/ironic-python-agent,I38768b9ba3dc1bb5160e5841865450a8d7df5466,1,0,1.0,2.4849,0.1818,2,6.0,399,0,Bug Fix,0,0,0,1,0.023256,1.0,0,1.0,2,2,0,0.9375,0.994,1.5,19.21,16.57,1,0,0.0,1,33.25,0,0,0,0,0,"Fix erasable devices check

There is a conditional which is supposed to check whether there are
any erasable devices. However, in the current state, the conditional
is wrong as the call is missing the node as a parameter.
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+3, -2)
releasenotes/notes/fix-erasable-devices-check-151da773bcb2be50.yaml (+6, -0)
",0.692772,-1.822271,0.001609,0.920438,-0.523613,0.51374,0.516859,-1.085543,0.200279,0.362136,0.125045,0.501936,-0.265189,0.014217,-0.105504
openstack/kolla,I2eb93bbd7de108d6d7f3f61c932642fdf7017fd7,0,0,0.5106,6.6771,0.4376,24,4.5,273,0,CI,0,0,0,378,0.013988,1.0,0,0.5106,2,2,0,0.6215,4.0839,1.38,-56.23,21.8,1,0,0.9975,1,0.3438,0,0,0,0,0,"CI: Rename jobs according to changes in K-A

See I1f08f9b9064d9f7e95b07944db0e7ebac3120c57

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/961226
[SEP]
FILES CHANGED:
zuul.d/tox.yaml (+23, -0)
zuul.d/scenarios/ironic.yaml (+11, -0)
zuul.d/scenarios/bifrost.yaml (+11, -0)
.zuul.d/debian.yaml (+0, -82)
zuul.d/scenarios/mariadb.yaml (+11, -0)
.zuul.d/project.yaml (+0, -16)
zuul.d/nodesets.yaml (+36, -0)
zuul.d/scenarios/octavia.yaml (+11, -0)
zuul.d/debian.yaml (+78, -0)
zuul.d/secrets.yaml (+0, -97)
.zuul.d/centos.yaml (+0, -36)
.zuul.d/tox.yaml (+0, -12)
zuul.d/scenarios/cells.yaml (+11, -0)
zuul.d/ubuntu.yaml (+65, -0)
zuul.d/scenarios/ovn.yaml (+11, -0)
zuul.d/base.yaml (+48, -0)
zuul.d/periodics/copr.yaml (+17, -0)
zuul.d/scenarios/cephadm.yaml (+15, -0)
.ansible-lint (+1, -1)
zuul.d/scenarios/masakari.yaml (+11, -0)
zuul.d/centos.yaml (+37, -0)
.zuul.d/ubuntu.yaml (+0, -103)
zuul.d/project.yaml (+27, -0)
zuul.d/scenarios/aio.yaml (+22, -0)
",-0.335638,1.881362,-2.222841,-1.293227,0.125237,0.146564,1.001905,-0.202313,0.420182,-0.114483,-0.571957,0.012647,0.164433,-0.177988,-0.088628
openstack/kolla-ansible,If42aa11735bee963afc33d2e06541e1d9aab0515,0,0,0.0,3.2189,0.0833,4,6.14,557,0,Feature,0,0,0,1,0.035714,0.4286,0,0.0,4,3,0,0.6412,1.8956,3.5,-76.81,23.85,1,0,0.0,1,22.28,0,0,0,0,0,"Run neutron-ovn-metadata-agent haproxy processes in separate containers

Follow up on Iaa1e687152db8351bc0e9b10e66f412860ac13a5
This patch implements the same experimental feature of running
processes in seperated containers to the neutron-ovn-metadata-agent

Co-Authored-By: Bartosz Bezak <bartosz@stackhpc.com>

Depends-On: https://review.opendev.org/c/openstack/kolla/+/960726
[SEP]
FILES CHANGED:
ansible/roles/neutron/handlers/main.yml (+3, -0)
ansible/roles/neutron/defaults/main.yml (+9, -0)
releasenotes/notes/neutron-ovn-metadata-agent-haproxy-container-2935ea0b03c41900.yaml (+7, -0)
doc/source/reference/networking/neutron.rst (+3, -2)
",-1.515761,1.84446,-0.916984,-0.532711,-0.116869,-0.045806,0.856072,0.165624,0.055658,-0.485338,0.533244,0.482793,0.192411,0.076647,-0.264364
openstack/charm-keystone,I584b7d2ea03d824c229cf5b21723d3645ffc2056,1,1,0.8333,1.0986,0.5,1,18.25,556,0,Bug Fix,0,0,0,24,0.020391,0.9434,0,0.7862,0,1,0,1.0,0.0,0.0,29.54,14.97,1,0,0.0,1,185.3333,0,32,0,12,0,"Enable global cache by default

The commit d2e42f1 introduced the config option enable-cache set to
False by default to cache inconsistency when keystone was deployed in
HA, since then a new change by made to disable token caching (563b453),
it has tested that this option alleviates the performance regression
seen when disabling the cache, whitout leaving the system exposed to
expired token reuse.

Related-Bug: #2113772
Related-Bug: #2089616
[SEP]
FILES CHANGED:
config.yaml (+1, -1)
",-0.407567,-1.585705,0.117389,-0.201021,-0.695698,0.005663,0.048082,0.250832,0.305061,0.295749,0.159279,-0.022339,0.208333,-0.20435,0.316568
openstack/kolla,I69ec97fe8480d27942cc923c170ec3cd669caf06,0,0,0.5092,1.7918,0.8,1,8.0,207,0,CI,0,0,0,379,0.013625,0.5,0,0.2546,3,1,0,0.62,0.0,3.0,-18.07,20.7,1,0,0.0,0,34.5,0,0,0,0,0,"cinder: Remove wsgi script handling

Cinder removed it in I28666e63896fed0f1661b5964ec46952074f4b23
[SEP]
FILES CHANGED:
docker/cinder/cinder-api/Dockerfile.j2 (+1, -4)
",0.549776,0.415201,-1.638754,-2.094529,1.658358,0.672147,-0.067066,-0.606071,0.105377,-0.18643,-0.603568,0.298623,-0.244472,-0.321493,0.120866
openstack/kolla,Ib73e2c47faf66ddee79d07259e75f1b1d721f0aa,0,0,0.5079,1.0986,0.5,1,3.33,132,0,Feature,0,0,0,380,0.013659,0.3243,0,0.1647,2,1,0,0.6186,0.0,2.0,-33.43,21.33,1,0,0.0,0,44.0,0,0,0,0,0,"Switch to 2025.2 release
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",2.886781,2.237715,1.395291,0.227727,-0.280999,1.455648,0.765744,0.91488,0.220513,1.716722,0.036241,0.520131,-0.739212,1.182449,0.554205
openstack/kolla-ansible,Ia6b719847033f7861e814b4e1d8da810dafcc2aa,0,0,0.5066,3.8918,0.0625,6,8.67,458,0,Feature,0,0,0,381,0.013694,0.2632,0,0.1333,4,3,0,0.6405,2.141,3.17,12.57,15.77,1,0,0.0,1,9.3469,0,0,0,0,0,"horizon: Add support for using uWSGI

Switching the default to uWSGI due to the changes that are happening
in OpenStack - with projects dropping wsgi_file(s) and moving
to modules.

Separate Apache/mod_wsgi container that will serve for OIDC/SAML cases
will be posted as a follow-up.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/961676
[SEP]
FILES CHANGED:
ansible/roles/horizon/templates/horizon.json.j2 (+10, -1)
releasenotes/notes/horizon-port-584efee771a14fd9.yaml (+6, -0)
ansible/roles/horizon/defaults/main.yml (+6, -0)
ansible/roles/horizon/tasks/config.yml (+20, -1)
releasenotes/notes/uwsgi-flamingo-5144740f1a2bb4fb.yaml (+2, -0)
ansible/group_vars/all/horizon.yml (+1, -1)
",-0.746863,0.052305,0.119,-0.045523,-0.909381,-0.389497,0.358784,0.364934,-0.077232,-0.195699,-0.170067,-0.497302,0.236321,-0.11295,0.171887
openstack/kolla-ansible,Ibe43380c16a223e5870baff5c74844aa0f5f87d7,0,0,0.5052,1.0986,0.5,1,8.0,259,0,Bug Fix,0,0,0,382,0.013706,0.3043,0,0.1538,4,1,0,0.6397,0.0,4.0,-12.78,19.87,0,0,0.0,0,86.3333,0,0,0,0,0,"ironic: Fix log files without suffix

This is a follow-up after I2b72712479a05a73b82d8e30235333db2c92ebfd
which introduced the logfiles lacking suffix.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic.conf.j2 (+1, -1)
",0.478677,-0.513357,-1.631926,-1.442983,1.114256,0.56045,0.629948,-0.631691,-0.054528,0.115796,-0.297105,0.540308,-0.359601,0.036847,0.195647
openstack/kolla,Iaf3c4de859986629f9768563a319fe0385acff6a,0,0,0.5333,3.2958,0.4231,4,12.0,479,0,Feature,0,0,0,15,0.033708,0.561,0,0.2992,3,3,0,0.6172,1.5466,2.25,53.66,12.02,0,0,0.0,1,17.7407,0,0,0,0,0,"Update Fluentd from v5 LTS to v6 LTS

Fluent Package v5 LTS will reach end of support at
the end of 2025.
Fluent Package v6 LTS will be supported until at least
the end of 2027.

This change updates the apt repository configuration and package version
to use Fluent Package v6 LTS for Ubuntu, Debian and RHEL.

No changes to existing Fluentd configuration files are required.
[SEP]
FILES CHANGED:
doc/source/contributor/versions.rst (+2, -2)
docker/base/Dockerfile.j2 (+1, -1)
releasenotes/notes/fluentd-update-8db10e760b2dc4d5.yaml (+4, -0)
kolla/template/repos.yaml (+8, -8)
",-1.576975,-0.367421,-0.067781,1.088556,0.502453,0.194166,-0.271935,0.808572,-0.086495,0.780699,0.020998,0.475883,0.238706,0.102937,-0.061507
openstack/kolla,I9011f9a6d065b85ff76852950e4537070a12b437,1,0,0.5039,1.6094,0.0,1,3.25,233,0,Feature,0,0,0,383,0.013741,0.375,0,0.189,2,1,0,0.6157,0.0,2.0,-147.88,32.07,1,0,0.0,0,46.6,0,0,0,0,0,"horizon: Ensure horizon owns /var/log/kolla/horizon

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/961614
[SEP]
FILES CHANGED:
docker/horizon/extend_start.sh (+4, -0)
",0.015767,4.120954,-1.998152,0.385938,-0.863872,0.129841,0.434527,-0.460442,0.060816,-0.846829,-0.503625,-0.158351,-0.115763,-0.293437,0.034888
openstack/sushy,I22c198af55c5b0394d680c435e511c9d74729658,1,0,0.9787,4.9904,0.0205,3,15.0,454,0,CI,0,0,0,47,0.013747,0.0,0,0.0,5,2,0,1.0,1.047,3.33,25.23,17.33,0,0,0.7466,1,3.0884,0,0,0,0,0,"Improve Dell Asynchronous task handling

Dell hardware, specifically with iDRAC10 BMCs, have been observed
in the wild returning a URL which does not yet exist for a job location
reference.

The result is we need to retry the interaction separately to obtain
a reference location before proceeding.

Assisted-By: Claude Code - Claude Sonnet 4
[SEP]
FILES CHANGED:
releasenotes/notes/fix-dell-bmc-404-race-condition-6000e47436cd4d6e.yaml (+12, -0)
sushy/tests/oem/dell/unit/test_asynchronous.py (+109, -0)
sushy/oem/dell/asynchronous.py (+22, -3)
",-0.338371,-2.159353,-0.372153,0.111728,-0.606805,0.198111,-0.292002,0.187783,0.306866,0.068479,-0.094623,0.211797,0.293692,0.046305,-0.261868
openstack/ironic,Ia046124ede28991be6e1fe43b29819f2f28c8c9a,1,0,1.0,3.0445,0.0,2,6.67,305,0,Feature,0,0,0,7,0.012963,0.0,0,0.0,2,2,0,0.9618,0.8113,2.0,41.44,10.67,0,0,0.0,1,14.5238,0,0,0,0,0,"Add WSGI alias under ironic.wsgi.api

This is the OpenStack standard place for it, apparently. Even though
Ironic only has one WSGI server, we still need to add the extra module
layer.

Assisted-by: Claude code
[SEP]
FILES CHANGED:
ironic/wsgi/api.py (+15, -0)
releasenotes/notes/ironic-wsgi-api-alias-a8c75cfbf5c69da4.yaml (+5, -0)
",1.030563,-1.409865,-0.517773,0.041563,-1.12998,-0.01837,0.084263,0.191441,-0.411898,-0.213588,0.045678,0.126634,-0.088479,-0.029974,-0.021524
openstack/kolla-ansible,I760f63eda27d6f88e87149f0dc042ed3d3019ab5,0,0,0.5052,1.9459,0.3333,2,8.0,229,0,Feature,0,0,0,384,0.013775,0.4667,0,0.2358,4,2,0,0.639,0.65,2.5,4.84,16.53,0,0,0.1667,1,32.7143,0,0,0,0,0,"service-uwsgi-config: Switch to use shared-socket

This will allow to bind low ports and then switch to unprivileged uid.
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+3, -2)
",1.893284,-0.687967,0.057737,0.263345,-0.270364,-0.754681,0.68296,0.072125,0.046995,-0.513435,-0.202001,0.203897,-0.13424,0.011928,-0.133546
openstack/kolla-ansible,Ib8a93336e41f7fa326d3a4be53f757fee3923643,1,0,0.5039,2.8332,0.0,1,4.33,160,0,CI,1,0,0,385,0.013808,0.8,0,0.4031,1,1,0,0.6382,0.0,1.0,-31.84,23.27,0,0,1.0,0,9.4118,0,0,0,0,0,"CI: check-logs.sh add wait for OpenSearch connection
[SEP]
FILES CHANGED:
tests/check-logs.sh (+16, -0)
",2.194918,1.072676,0.358514,0.060485,-0.106962,-0.62632,-0.106963,0.254285,0.003393,-0.111042,-0.020013,-0.568099,0.199709,0.488838,-0.003315
openstack/kolla-ansible,Ic6c487ad6b0c94edb89e3b8feecd6cfac39e1f5d,0,0,0.8235,3.7136,0.75,10,4.5,234,0,Feature,0,0,0,17,0.063433,1.0,0,0.8235,4,1,0,0.6386,3.3219,4.0,1.73,15.13,1,0,0.0,0,5.7073,1,0,0,0,0,"Remove option for apache < 2.4

apache 2.4 was released long time ago and is now available in recent
operating systems.
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-api-wsgi.conf.j2 (+1, -3)
ansible/roles/nova/templates/nova-metadata-wsgi.conf.j2 (+1, -3)
ansible/roles/octavia/templates/octavia-wsgi.conf.j2 (+1, -3)
ansible/roles/heat/templates/wsgi-heat-api-cfn.conf.j2 (+1, -3)
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+1, -3)
ansible/roles/placement/templates/placement-api-wsgi.conf.j2 (+1, -3)
ansible/roles/nova/templates/nova-api-wsgi.conf.j2 (+1, -3)
ansible/roles/heat/templates/wsgi-heat-api.conf.j2 (+1, -3)
ansible/roles/trove/templates/trove-wsgi.conf.j2 (+1, -3)
ansible/roles/cinder/templates/cinder-wsgi.conf.j2 (+1, -3)
",0.552805,-0.596917,-0.111487,0.236452,-0.019902,0.547579,-0.390195,-0.086791,-0.742343,0.860571,-0.513384,0.568231,-0.64653,-0.071604,0.523389
openstack/kolla,I35548a02f652c035c17aabe149752322ffc869c4,0,0,0.5052,0.6931,0.0,1,10.75,398,0,Bug Fix,0,0,0,386,0.013836,0.4286,0,0.2165,2,1,0,0.6166,0.0,2.0,7.05,16.39,0,0,0.0,0,199.0,0,0,0,0,0,"openstack-base: Fix psycopg2 install on EL

pg_config has been moved to postgresql-server, postgresql-devel
only installs a link to pg_config which is unresolvable without
-server package.

Installing postgresql-server-devel to include headers which are
also required for building psycopg2.
[SEP]
FILES CHANGED:
docker/openstack-base/Dockerfile.j2 (+1, -0)
",-0.697143,-0.542763,-0.507975,0.381935,0.590418,-1.091396,-0.248536,0.353615,-0.432268,-0.187247,0.018462,0.08319,-0.252118,0.41907,0.348037
openstack/charm-octavia,I3c12cdee79c0644535179ae62faa8b95fee33bea,1,1,0.84,3.091,0.0952,2,10.8,452,0,Bug Fix,0,0,0,25,0.021204,0.0,0,0.0,4,1,0,1.0,0.7919,2.5,-3.09,19.13,1,0,0.7619,0,20.5455,0,10,0,14,0,"Only check management interface when amphora is enabled

Only perform the management interface address check when the
enable-amphora configuration option is enabled. This prevents
unnecessary blocking status when amphora is not being used, such as when
the environment is configured to exclusively use the OVN provider.

Closes-Bug: #2121592
[SEP]
FILES CHANGED:
src/lib/charm/openstack/octavia.py (+3, -2)
unit_tests/test_lib_charm_openstack_octavia.py (+16, -0)
",-0.153648,-1.440901,-0.315752,0.859051,-0.168894,-0.04384,0.009028,0.244257,0.426135,-0.135526,0.042375,0.387663,0.183684,-0.299159,0.073238
openstack/ironic,Ia21beb5675d2c4383a734a5a434d623aa628db6c,1,0,1.0,2.8904,0.2941,3,4.8,268,0,Bug Fix,0,0,0,8,0.070796,0.8,0,0.8,4,2,0,0.962,1.4021,2.67,-9.54,15.25,1,0,0.4706,1,14.8889,0,0,0,0,0,"Fix incorrect arg while getting ports by portgroup

get_ports_by_portgroup_id accepts id instead of uuid.
[SEP]
FILES CHANGED:
ironic/conductor/manager.py (+1, -1)
ironic/tests/unit/conductor/test_manager.py (+4, -4)
releasenotes/notes/fix-portgroup-update-logic-156ebe0ef9bc2d58.yaml (+7, -0)
",0.311452,1.102864,-0.239641,0.821177,1.258788,0.325675,-0.757018,-0.772222,0.514588,-0.677052,-0.195423,-0.705068,-0.746723,-0.025235,-0.051443
openstack/ansible-role-systemd_networkd,I9216faf96ba5f0502056b6c2677b581a10557424,1,0,0.9585,2.8332,0.9375,2,4.83,329,0,Feature,0,0,0,241,0.054048,1.0,0,0.9585,1,1,0,1.0,0.3373,1.0,-25.62,15.73,1,0,0.0,0,19.3529,0,0,0,0,0,"Drop hyperscale SIG repo

With systemd-extras being branched to EPEL 10 [1]
we no longer need to have hyperscale SIG.

[1]

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/962081
[SEP]
FILES CHANGED:
vars/redhat-10.yml (+1, -14)
defaults/main.yml (+0, -1)
",-0.853329,0.961495,-0.948158,-0.111006,-0.87519,-0.331529,-0.222111,0.196088,-0.266911,0.071263,-0.300927,-0.141237,0.220948,-0.104355,-0.183955
openstack/kolla-ansible,I66dae0f64e0a80e5f35ff6176956a44341411200,0,0,0.5039,1.3863,0.6667,1,11.67,324,0,Feature,0,0,0,387,0.013871,0.2917,0,0.147,4,1,0,0.6379,0.0,4.0,4.04,17.24,0,0,0.0,0,81.0,0,0,0,0,0,"neutron: Always run neutron-rpc-server

There's a million combinations of agents and mechanism drivers
that require neutron-rpc-server - let's run it always instead
of breaking deployments on current enabled: clause.
[SEP]
FILES CHANGED:
ansible/roles/neutron/defaults/main.yml (+1, -2)
",0.600933,0.071298,-0.224538,0.802054,0.070511,-0.538473,0.27814,-0.459533,-0.771079,-0.263328,-0.17113,0.361238,0.018043,0.001496,0.433595
openstack/openstack-ansible-plugins,I3050a4e56f84b82d1c86d3484de7bbbff971ad74,1,0,0.9587,4.8598,0.1562,5,5.57,429,0,CI,0,0,0,242,0.054078,1.0,0,0.9587,4,2,0,1.0,1.9969,3.4,-22.25,17.61,1,0,0.0,0,3.3256,0,0,0,0,0,"Add EPEL for glusterfs role

COPR packages have some EPEL dependencies,
like gperftools-libs.

Previously they were installed due to the issue
in systemd-networkd, where EPEL was not added
without defined `includepkgs`.

Needed-By: https://review.opendev.org/c/openstack/ansible-role-systemd_networkd/+/962044
[SEP]
FILES CHANGED:
roles/glusterfs/tasks/main.yml (+32, -18)
roles/glusterfs/vars/redhat-10.yml (+26, -2)
roles/glusterfs/defaults/main.yml (+2, -0)
roles/glusterfs/files/gpg/7D0CC81C (+19, -0)
roles/glusterfs/files/gpg/E37ED158 (+29, -0)
",-1.217675,0.241174,-0.473421,-0.102783,-0.529262,-0.771422,-0.150098,0.444474,-0.125089,-0.316626,-0.124804,-0.3566,0.228403,-0.019198,0.036145
openstack/kolla-ansible,I1f519b3ce8b7f2ceee2eaef88e4afc8ca8fa2f6e,0,0,0.5026,5.8406,0.0758,10,4.0,231,0,Feature,0,0,0,388,0.013905,0.5556,0,0.2792,4,3,0,0.6371,2.454,3.3,-82.75,24.1,1,0,0.1224,1,0.6715,0,0,0,0,0,"keystone: Add support for deploying httpd for federation

Depends-On: https://review.opendev.org/c/openstack/kolla/+/954707
[SEP]
FILES CHANGED:
ansible/roles/keystone/templates/httpd-keystone.conf.j2 (+113, -0)
zuul.d/scenarios/keystone-federation.yaml (+37, -0)
ansible/roles/keystone/handlers/main.yml (+14, -0)
ansible/roles/service-uwsgi-config/defaults/main.yml (+1, -0)
tests/templates/globals-default.j2 (+4, -0)
ansible/roles/keystone/tasks/config.yml (+22, -1)
zuul.d/project.yaml (+1, -0)
ansible/roles/keystone/defaults/main.yml (+59, -25)
ansible/roles/keystone/templates/keystone-httpd.json.j2 (+63, -0)
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+3, -0)
",0.13635,2.997886,-1.452421,-0.338972,-1.45501,0.362694,-0.160976,-0.256385,-0.093847,-0.742608,-0.791531,0.014326,0.031101,-0.554356,-0.056221
openstack/kolla-ansible,Ia0647484ea9e868f7ff41f152cffb1c72c941284,0,0,0.7031,1.6094,0.5,1,7.0,154,0,CI,1,0,0,64,0.067797,0.25,0,0.1758,1,1,0,0.6364,0.0,1.0,18.44,17.09,1,0,1.0,0,30.8,0,0,0,0,0,"CI: run kolla-ansible check in upgrade jobs too
[SEP]
FILES CHANGED:
tests/deploy.sh (+2, -2)
",2.45911,0.706588,0.496277,-0.072159,0.663842,-0.704374,0.271795,-0.358338,-0.739387,-0.332412,0.495241,-0.160312,0.159941,-0.185066,0.068436
openstack/kolla-ansible,I6086059cac3da03336998870632c18ddd4eb7442,0,0,0.6923,3.434,1.0,1,8.0,167,0,CI,1,0,0,65,0.068565,0.4286,0,0.2967,1,1,0,0.6356,0.0,1.0,18.94,15.7,1,0,1.0,0,5.3871,0,0,0,0,0,"CI: drop rabbitmq migration to durable queues in upgrade job
[SEP]
FILES CHANGED:
tests/upgrade.sh (+0, -30)
",2.372169,-0.020382,0.950901,0.206331,1.322182,-0.220022,0.523434,0.600962,-0.415937,0.121973,0.13082,-0.285644,-0.031889,-0.344523,0.222149
openstack/kolla-ansible,I3f17adf655d2d0c1fc2969153dddb0c72b11397a,0,0,0.5013,7.9851,0.4871,67,8.2,326,0,Feature,0,0,0,389,0.013772,1.0,0,0.5013,4,4,0,0.6349,3.5337,2.97,37.57,12.06,0,0,0.0007,1,0.111,0,0,0,0,0,"group_vars: Reorganize huge all.yml into smaller files

This will help us to trigger scenario jobs on changes in given
group_vars files.

Changes to Zuul config to trigger given scenarios will be posted
as a follow-up.
[SEP]
FILES CHANGED:
ansible/group_vars/all/ceph-rgw.yml (+10, -0)
ansible/group_vars/all/neutron.yml (+75, -0)
doc/source/reference/orchestration-and-nfv/tacker-guide.rst (+1, -1)
ansible/group_vars/all/nova.yml (+69, -0)
ansible/group_vars/all/haproxy.yml (+48, -0)
ansible/group_vars/all/kuryr.yml (+4, -0)
ansible/group_vars/all/keepalived.yml (+8, -0)
etc/kolla/globals.yml (+1, -1)
ansible/group_vars/all/letsencrypt.yml (+13, -0)
doc/source/user/multinode.rst (+1, -1)
ansible/group_vars/all/common.yml (+366, -0)
ansible/group_vars/all/opensearch.yml (+33, -0)
doc/source/user/troubleshooting.rst (+8, -8)
ansible/group_vars/all/watcher.yml (+10, -0)
ansible/group_vars/all/trove.yml (+11, -0)
ansible/group_vars/all/grafana.yml (+11, -0)
ansible/group_vars/all/ovn.yml (+16, -0)
ansible/group_vars/all/glance.yml (+28, -0)
ansible/group_vars/all/octavia.yml (+33, -0)
ansible/group_vars/all/placement.yml (+13, -0)
ansible/group_vars/all/iscsi.yml (+4, -0)
ansible/group_vars/all/aodh.yml (+11, -0)
ansible/group_vars/all/gnocchi.yml (+21, -0)
ansible/group_vars/all/bifrost.yml (+3, -0)
ansible/group_vars/all/ironic.yml (+33, -0)
ansible/group_vars/all/s3.yml (+7, -0)
ansible/group_vars/all/mariadb.yml (+37, -0)
doc/source/reference/containers/kuryr-guide.rst (+2, -1)
ansible/group_vars/all/collectd.yml (+4, -0)
ansible/group_vars/all/barbican.yml (+17, -0)
ansible/group_vars/all/fluentd.yml (+6, -0)
ansible/group_vars/all/keystone.yml (+86, -0)
ansible/group_vars/all/blazar.yml (+11, -0)
ansible/group_vars/all/mistral.yml (+10, -0)
ansible/group_vars/all/redis.yml (+11, -0)
ansible/group_vars/all/skyline.yml (+18, -0)
ansible/group_vars/all/manila.yml (+18, -0)
ansible/group_vars/all/database.yml (+11, -0)
ansible/group_vars/all/etcd.yml (+7, -0)
ansible/group_vars/all/ceilometer.yml (+4, -0)
ansible/module_utils/kolla_podman_worker.py (+1, -1)
ansible/group_vars/all/heat.yml (+17, -0)
ansible/group_vars/all/multipathd.yml (+2, -0)
ansible/group_vars/all/telegraf.yml (+9, -0)
ansible/group_vars/all/zun.yml (+31, -0)
ansible/group_vars/all/influxdb.yml (+12, -0)
ansible/group_vars/all/loadbalancer.yml (+2, -0)
ansible/group_vars/all/rabbitmq.yml (+19, -0)
zuul.d/base.yaml (+1, -1)
doc/source/reference/databases/mariadb-guide.rst (+3, -3)
ansible/group_vars/all/proxysql.yml (+4, -0)
ansible/group_vars/all/ceph.yml (+21, -0)
ansible/group_vars/all/cinder.yml (+40, -0)
ansible/group_vars/all/cyborg.yml (+8, -0)
ansible/group_vars/all/venus.yml (+10, -0)
ansible/group_vars/all/horizon.yml (+49, -0)
ansible/group_vars/all/magnum.yml (+10, -0)
ansible/group_vars/baremetal/ansible-python-interpreter.yml (+0, -0)
ansible/group_vars/all/memcached.yml (+10, -0)
ansible/group_vars/all/hacluster.yml (+9, -0)
ansible/group_vars/all/openvswitch.yml (+14, -0)
ansible/group_vars/all.yml (+0, -1413)
ansible/group_vars/all/designate.yml (+33, -0)
ansible/group_vars/all/prometheus.yml (+78, -0)
ansible/group_vars/all/tacker.yml (+10, -0)
ansible/group_vars/all/cloudkitty.yml (+20, -0)
ansible/group_vars/all/masakari.yml (+13, -0)
",0.238599,-1.501584,-0.38764,0.607736,0.067864,-0.460212,-0.255057,-0.181944,-0.065028,-0.192426,-0.487611,-0.294461,-0.40457,0.399673,-0.128321
openstack/kolla-ansible,Iaa2d8654367edb08d0b35d8fe6ffc27602264931,0,0,0.5,2.8332,1.0,1,7.5,160,0,CI,1,0,0,390,0.012507,0.3333,0,0.1667,2,1,0,0.6341,0.0,2.0,1.82,19.0,0,0,1.0,1,9.4118,0,0,0,0,0,"CI: Remove legacy centos10 job after Kolla CI switch
[SEP]
FILES CHANGED:
zuul.d/scenarios/aio.yaml (+0, -16)
",2.545958,-0.077978,0.922635,-0.577877,0.329874,0.209488,-0.188492,1.257298,-0.845625,0.073568,0.375058,0.085513,0.145895,-0.579652,0.073349
openstack/kolla-ansible,I56b4e1218092ffcca074fef3ceac8e9d99054b21,0,0,0.4987,5.3279,0.4634,24,24.5,370,0,CI,1,0,0,391,0.012533,0.6667,0,0.3325,2,1,0,0.6334,3.4006,1.92,14.49,21.23,0,0,1.0,1,1.7961,0,0,0,0,0,"Update Zuul triggers after group_vars split

The basic approach is:
- we test majority in aio and cephadm scenarios
- additional scenario jobs are only triggered on roles
  that are not covered by aio/cephadm (and the ones
  that are relevant for given scenario)
[SEP]
FILES CHANGED:
zuul.d/scenarios/nfv.yaml (+2, -2)
zuul.d/scenarios/skyline.yaml (+2, -1)
zuul.d/scenarios/prometheus-opensearch.yaml (+2, -2)
zuul.d/scenarios/ironic.yaml (+3, -2)
zuul.d/scenarios/kvm.yaml (+2, -2)
zuul.d/scenarios/bifrost.yaml (+2, -1)
zuul.d/scenarios/mariadb.yaml (+3, -2)
zuul.d/scenarios/magnum.yaml (+2, -1)
zuul.d/scenarios/container-engine-migration.yaml (+1, -1)
zuul.d/scenarios/octavia.yaml (+2, -2)
zuul.d/scenarios/venus.yaml (+3, -2)
zuul.d/scenarios/cells.yaml (+2, -3)
zuul.d/scenarios/telemetry.yaml (+2, -1)
zuul.d/scenarios/ovn.yaml (+2, -3)
zuul.d/base.yaml (+42, -46)
zuul.d/scenarios/cephadm.yaml (+5, -0)
zuul.d/scenarios/lets-encrypt.yaml (+4, -3)
zuul.d/scenarios/ipv6.yaml (+1, -1)
zuul.d/scenarios/masakari.yaml (+3, -4)
zuul.d/project.yaml (+1, -0)
zuul.d/scenarios/aio.yaml (+14, -6)
zuul.d/scenarios/hashi-vault.yaml (+5, -6)
zuul.d/scenarios/zun.yaml (+2, -1)
zuul.d/scenarios/haproxy-fqdn.yaml (+3, -3)
",0.618776,-1.728353,-0.006321,0.299515,0.239366,-0.401604,0.762457,-0.025904,-0.160253,-0.430237,-0.444619,0.266521,0.291715,0.179237,-0.108148
openstack/kayobe,I3ab49d28804733733474565d33cc7b564b203ba6,0,0,0.6087,5.6204,0.2036,20,3.0,286,0,Feature,0,0,1,23,0.010388,1.0,0,0.6087,4,5,0,0.9051,3.5608,2.2,47.41,13.32,0,0,0.2836,1,1.0362,0,0,0,0,0,"Bump up Ansible supported versions to 11.x/12.x

This change bumps up the maximum supported version of Ansible to 12.x
(ansible-core 2.19.x) and minimum to 11.x (ansible-core 2.18.x).
[SEP]
FILES CHANGED:
kayobe/tests/unit/test_utils.py (+11, -3)
kayobe/plugins/action/merge_configs.py (+12, -1)
releasenotes/notes/bump-ansible-12-536bc4a3ff55dc3b.yaml (+6, -0)
ansible/kolla-ansible.yml (+2, -2)
kayobe/plugins/action/template_content.py (+47, -0)
ansible/roles/kolla-ansible/tasks/install.yml (+1, -1)
ansible/roles/kolla-ansible/tests/test-defaults.yml (+1, -1)
kayobe/plugins/action/kolla_ansible_host_vars.py (+29, -14)
ansible/action_plugins/template_content.py (+19, -0)
ansible/roles/kolla-ansible/defaults/main.yml (+1, -1)
ansible/roles/kolla-openstack/tasks/config.yml (+2, -2)
requirements.txt (+1, -1)
kayobe/ansible.py (+12, -2)
kayobe/tests/unit/test_ansible.py (+40, -16)
playbooks/kayobe-base/post.yml (+9, -5)
kayobe/plugins/action/merge_yaml.py (+11, -1)
requirements.yml (+6, -5)
zuul.d/project.yaml (+6, -0)
kayobe/utils.py (+2, -1)
tox.ini (+1, -0)
",-0.964965,1.813576,-1.331703,1.051361,0.922878,0.197724,-0.213694,0.41369,-0.874831,1.289329,-0.17368,0.663353,-0.118028,0.282056,0.152881
openstack/kolla-ansible,I40aaa939f092387eaf5ef65332747224314636c2,1,0,0.4974,0.6931,0.0,1,11.5,213,0,Feature,0,0,0,392,0.012483,0.0,0,0.0,4,1,0,0.6326,0.0,4.0,7.57,18.51,0,0,0.0,0,106.5,0,0,0,0,0,"service-uwsgi-config: Bump socket-timeout to 30

Default is 4 - adapting to the same value as in Devstack
[SEP]
FILES CHANGED:
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+1, -0)
",1.850839,-0.27663,-0.105601,0.111609,-0.222849,-0.206333,0.259634,0.040102,0.249294,-0.199752,-0.208912,0.240983,0.010576,0.296316,0.224853
openstack/kolla-ansible,I79d896d7dea299641bc5a7f0f2a0735c9719a16d,1,0,0.7778,5.1417,0.9412,12,2.8,364,0,Feature,0,0,0,18,0.058442,0.5,0,0.3889,4,3,0,0.6331,2.8068,3.5,-49.81,16.83,0,0,0.0,1,2.1287,0,0,0,0,0,"neutron: Remove support for linux bridge mechanism driver

... because it was removed from neutron during 2025.1 cycle[1].

[1] https://review.opendev.org/c/openstack/neutron/+/927216

Depends-On: https://review.opendev.org/c/openstack/kolla/+/962279
[SEP]
FILES CHANGED:
releasenotes/notes/remove-neutron-linuxbridge-b1a2457e848709f7.yaml (+5, -0)
ansible/group_vars/all/neutron.yml (+1, -3)
ansible/roles/manila/templates/manila-share.conf.j2 (+0, -2)
ansible/roles/neutron/defaults/main.yml (+0, -47)
ansible/roles/neutron/templates/linuxbridge_agent.ini.j2 (+0, -24)
ansible/roles/neutron/tasks/config.yml (+0, -16)
ansible/roles/neutron/templates/neutron.conf.j2 (+0, -2)
ansible/roles/neutron/handlers/main.yml (+0, -16)
ansible/roles/neutron/templates/neutron-linuxbridge-agent.json.j2 (+0, -44)
ansible/group_vars/all/openvswitch.yml (+1, -1)
ansible/roles/neutron/tasks/config-host.yml (+1, -1)
etc/kolla/globals.yml (+2, -4)
",-0.86032,3.085384,-1.077346,0.225122,-1.226885,0.27704,0.29788,0.16336,-0.188088,0.200756,-0.155211,-0.281118,0.051957,-0.023872,-0.076977
openstack/kolla,I2cf22b874fcb885752bf3800c8ad8fa7a5eacff7,1,0,0.7895,3.2958,0.8077,2,4.25,378,0,Feature,0,0,0,19,0.039749,0.0,0,0.0,3,2,0,0.6152,0.7063,2.5,-43.81,19.35,0,0,0.0,1,14.0,0,0,0,0,0,"Remove container image of neutron-linuxbridge-agent

The agent was removed from neutron during 2025.1 cycle. The remaining
implementation to deploy it is being removed from kolla-anible now.

Needed-By: https://review.opendev.org/c/openstack/kolla-ansible/+/962278
[SEP]
FILES CHANGED:
releasenotes/notes/drop-neutron-linuxbridge-agent-5c4596f148c143ed.yaml (+5, -0)
docker/neutron/neutron-linuxbridge-agent/Dockerfile.j2 (+0, -21)
",-0.10072,1.049807,-1.060704,0.076665,-1.307889,-0.23049,0.759709,0.336607,0.042027,-0.464746,-0.145176,0.039145,-0.085933,0.32569,0.139881
openstack/kolla,I11926e764909ec53bdd2a38d815a31253abd6868,1,0,0.8333,1.0986,0.5,1,3.71,296,0,Bug Fix,0,0,0,108,0.071618,1.0,0,0.8333,2,1,0,0.6161,0.0,2.0,-34.47,16.87,0,0,0.0,0,98.6667,0,0,0,0,0,"doc: Fix Ubuntu Ceph version

Ubuntu Noble is using Ceph Squid, not Reef [1].

[1] https://packages.ubuntu.com/noble-updates/ceph

Co-authored-by: Chema Perib√°√±ez <epgboe2.tid@telefonica.com>
[SEP]
FILES CHANGED:
doc/source/ceph_versions.csv (+1, -1)
",-0.426373,1.136473,-1.332622,-0.498933,-1.131513,-0.053912,0.23219,0.814625,-0.232587,-0.047557,0.502466,0.026184,-0.21175,0.450986,-0.64354
openstack/charm-octavia,I59b83e3477f2a9f8dba4edb2106dab4296c52647,1,1,0.8462,1.6094,0.0,2,7.4,375,0,Bug Fix,0,0,0,26,0.021667,1.0,0,0.8462,3,1,0,1.0,1.0,3.0,-27.04,18.1,1,0,0.0,1,75.0,0,6,0,13,0,"Set default_provider_driver

The configuration option [api_settings].default_provider_driver is
consumed by Rally and the dashboard, when deploying an OVN only
environment, this option is set to amphora producing inconsistencies and
failures.

Closes-Bug: #2125620
[SEP]
FILES CHANGED:
src/templates/bobcat/octavia.conf (+2, -0)
src/templates/xena/octavia.conf (+2, -0)
",0.205797,-0.858362,-0.534306,0.32902,-0.0103,0.040059,-0.339543,0.456444,0.631904,-0.402108,0.001516,-0.035305,-0.354867,-0.072009,-0.026415
openstack/kolla-ansible,Ib655eae79ba73f4582b29fef82c2d882a474329b,0,0,0.7059,5.037,0.5882,14,8.67,687,0,Doc,0,0,0,17,0.036876,0.8095,0,0.5714,4,4,0,0.6335,3.0169,3.5,16.91,16.29,1,0,0.0196,1,4.461,0,0,0,0,0,"Drop support for DB Loadbalancing with HAProxy + clustercheck

MariaDB Clustercheck has not been updated for a long time and ProxySQL
has been working well as the default.

Dropped DB Loadbalancing with HAProxy and MariaDB clustercheck support and
ProxySQL now gets enabled automatically when MariaDB is enabled.

Replaced MariaDB container healthcheck method with healthcheck.sh from
official MariaDB docker images.

Performing service upgrade with this patch will remove remaining
mariadb_clustercheck container.

Depends-on: https://review.opendev.org/c/openstack/kolla/+/962657
[SEP]
FILES CHANGED:
tests/check-logs.sh (+0, -3)
ansible/group_vars/all/mariadb.yml (+3, -4)
ansible/roles/mariadb/tasks/loadbalancer.yml (+1, -1)
ansible/roles/mariadb/tasks/upgrade.yml (+11, -0)
ansible/roles/mariadb/templates/mariadb.json.j2 (+7, -0)
ansible/roles/prometheus/tasks/bootstrap.yml (+1, -1)
ansible/group_vars/all/proxysql.yml (+1, -1)
ansible/roles/mariadb/tasks/register.yml (+1, -1)
ansible/roles/mariadb/handlers/main.yml (+0, -16)
ansible/roles/mariadb/templates/mariadb-clustercheck.json.j2 (+0, -11)
ansible/roles/mariadb/templates/healthcheck.cnf.j2 (+3, -0)
releasenotes/notes/drop-clustercheck-and-haproxy-support-for-mariadb-4cbd7c8590a34981.yaml (+13, -0)
ansible/roles/mariadb/defaults/main.yml (+6, -52)
ansible/roles/mariadb/tasks/config.yml (+16, -0)
",-1.960152,-0.24494,0.431983,0.011383,-0.124944,-0.015641,-0.332471,0.71473,-0.230755,-0.208817,0.152311,-0.02006,-0.130687,-0.312057,0.017272
openstack/kolla-ansible,Iab4dbffc796ebf5bdf32b6eda33f3204a70d1392,1,0,0.4987,1.9459,0.1667,1,4.67,157,0,Feature,0,0,0,393,0.012514,0.0,0,0.0,5,1,0,0.6327,0.0,5.0,-9.4,21.87,0,0,0.0,0,22.4286,0,0,0,0,0,"haproxy: Fail when a step in haproxy_run.sh fails
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/haproxy/haproxy_run.sh.j2 (+5, -1)
",0.694967,1.355793,-0.252229,0.616567,1.042268,0.264773,-0.607925,-0.854107,-0.317015,0.050941,0.679926,-0.475012,-0.577431,0.096207,0.496255
openstack/kolla-ansible,I57a51fb46cb7c58074044bac76b1160620086cb8,1,1,0.8333,2.8904,0.4118,3,12.75,473,0,Bug Fix,0,0,0,12,0.042403,0.5,0,0.4167,4,2,0,0.6332,1.5486,3.33,1.47,17.65,1,0,0.0,1,26.2778,0,12,0,4,0,"Only notify handlers in service-check-containers

Notification of handlers on service config change is now
mostly delegated to the service-check-containers role,
but handlers that restart nova_libvirt and ovn_sb_db_relays
still remain.

Remove these remaining handlers to ensure that all service
containers are restarted by service-check-containers.

Partial-Bug: #2123946
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/tasks/config-relay.yml (+0, -4)
ansible/roles/nova-cell/tasks/external_ceph.yml (+3, -3)
releasenotes/notes/bug-2123946-notify-handlers-3d0a6a0788d5dcce.yaml (+7, -0)
",-0.985602,-0.466907,-0.333646,0.652292,0.173464,-0.838425,-0.031657,0.00292,-0.125246,-0.464018,-0.034818,-0.042203,0.568054,0.58312,0.261041
openstack/ansible-collection-kolla,I132a5cb255be21a603bf92a50810450ff35a52cb,0,0,1.0,4.4188,0.0,4,8.0,401,0,Doc,0,0,0,3,0.061224,0.3333,0,0.3333,3,3,0,0.4054,1.8611,2.75,-14.9,18.2,1,0,0.0,1,4.8313,0,0,0,0,0,"Add abbility to configure podman containers.d

Added default config for podman containers.d and also
`podman_custom_config` similiar to `docker_custom_config`
to make able to customize podman config.
Added new variables:
- `podman_healthcheck_events: false`
- `podman_log_max_size: 52428800`
[SEP]
FILES CHANGED:
roles/podman/templates/kolla.conf.j2 (+28, -0)
roles/podman/tasks/config.yml (+7, -0)
roles/podman/defaults/main.yml (+21, -0)
releasenotes/notes/podman-containers-config-154f36cbd6fd3f3a.yaml (+26, -0)
",-1.563142,0.423827,-0.858925,0.911415,1.232066,-0.381359,-0.605987,-0.089573,0.288492,-0.296699,-0.196046,-0.752201,-0.115776,0.224516,-0.217745
openstack/kolla,Ic8bfaedb1e94dd8b64fa8a63d9cd3b76a2b73ffb,0,0,0.5,5.4765,0.979,2,3.67,144,0,Feature,0,0,0,394,0.012544,0.5476,0,0.2738,2,2,0,0.617,0.0976,2.0,-58.38,26.92,1,0,0.0,1,0.6025,0,0,0,0,0,"Stop duplicating repos in repos.yaml
[SEP]
FILES CHANGED:
kolla/template/methods.py (+2, -1)
kolla/template/repos.yaml (+3, -232)
",1.618262,2.807274,0.487856,1.50739,1.074212,0.091338,0.704748,-0.568095,-0.912088,-0.210225,0.250445,-0.762612,-0.642405,0.709156,0.262183
openstack/kolla,I5479c5c935760f00fe4cd307366f261deee3199f,0,0,0.4987,4.7536,0.3217,26,11.67,498,0,CI,0,0,0,395,0.012481,0.8,0,0.399,3,1,0,0.6156,4.6325,2.81,37.88,14.95,1,0,0.0,0,4.2931,0,0,0,0,0,"Move repo enablement to respective rpm blocks

Currently we are enabling repos irrespective of rpm/deb
statement blocks and not failing in the method used
if a repository is missing.

Downside is - we might be producing one more layer,
but it probably is a more logical approach.

This is required for adding rpm support in repos.yaml
that will also include failing on missing repositories.
[SEP]
FILES CHANGED:
docker/hacluster/hacluster-base/Dockerfile.j2 (+4, -0)
docker/nova/nova-libvirt/Dockerfile.j2 (+2, -2)
docker/masakari/masakari-monitors/Dockerfile.j2 (+2, -2)
docker/glance/glance-base/Dockerfile.j2 (+2, -1)
docker/bifrost/bifrost-base/Dockerfile.j2 (+4, -3)
docker/openstack-base/Dockerfile.j2 (+2, -1)
docker/openvswitch/openvswitch-base/Dockerfile.j2 (+3, -2)
docker/cinder/cinder-base/Dockerfile.j2 (+2, -1)
docker/neutron/neutron-base/Dockerfile.j2 (+3, -1)
docker/zun/zun-compute/Dockerfile.j2 (+4, -0)
docker/manila/manila-share/Dockerfile.j2 (+2, -1)
docker/tacker/tacker-base/Dockerfile.j2 (+6, -1)
docker/manila/manila-base/Dockerfile.j2 (+2, -1)
docker/mariadb/mariadb-server/Dockerfile.j2 (+4, -2)
docker/nova/nova-base/Dockerfile.j2 (+2, -1)
docker/octavia/octavia-base/Dockerfile.j2 (+2, -1)
docker/heat/heat-base/Dockerfile.j2 (+6, -1)
docker/collectd/Dockerfile.j2 (+3, -2)
docker/rabbitmq/Dockerfile.j2 (+3, -1)
docker/kolla-toolbox/Dockerfile.j2 (+4, -1)
docker/telegraf/Dockerfile.j2 (+4, -2)
docker/zun/zun-base/Dockerfile.j2 (+2, -1)
docker/keystone/keystone-base/Dockerfile.j2 (+4, -3)
docker/nova/nova-compute/Dockerfile.j2 (+2, -2)
docker/kuryr/kuryr-libnetwork/Dockerfile.j2 (+2, -2)
docker/gnocchi/gnocchi-base/Dockerfile.j2 (+2, -2)
",0.034138,-2.452627,0.385681,0.393124,-0.701324,-0.557576,0.503047,-0.237498,-0.264792,0.409618,-0.332363,-0.200358,0.190335,-0.015117,0.131564
openstack/kolla,I7816edb6ebd8c95412a6833ea20b32193c2d1415,0,0,0.6667,2.9957,0.0,3,7.0,736,0,Doc,0,0,0,18,0.029316,0.6667,0,0.4444,3,3,0,0.6142,1.5574,2.33,-9.35,10.23,1,0,0.0,1,36.8,0,0,0,0,0,"Add MariaDB healthcheck.sh

MariaDB clustercheck has not been updated for a long time.
Since the script uses ``mysql*`` commands but MariaDB 11.4 (next LTS version)
does not support them, it will not work once MariaDB gets upgraded.

Added alternative MariaDB container health check script ``healthcheck.sh``
from official MariaDB docker images. [1]
This script uses ``mariadb*`` commands, so it's prone to MariaDB
upgrade.

[1] https://mariadb.com/docs/server/server-management/install-and-upgrade-mariadb/installing-mariadb/binary-packages/automated-mariadb-deployment-and-administration/docker-and-mariadb/using-healthcheck-sh
[SEP]
FILES CHANGED:
docker/mariadb/mariadb-base/Dockerfile.j2 (+6, -0)
kolla/common/sources.py (+5, -0)
releasenotes/notes/add-mariadb-healthcheck-script-916e5ad7a216e05e.yaml (+8, -0)
",-3.16364,2.308691,0.837314,0.330667,0.127366,-0.531405,0.386218,0.277255,-0.451377,-0.371853,-0.107684,0.726213,-0.077012,-0.078639,-0.074266
openstack/ironic-python-agent-builder,I185f0955d86767784ea6b68c01ffc484c83c61ae,1,0,0,3.3673,0.25,3,4.6,271,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,6,3,0,1.0,0.9464,4.67,-7.49,10.54,1,0,0.0,1,9.3448,0,0,0,0,0,"Wait up to 30 seconds for config drive

Handle Virtual Media ISO (sr0) appearing later

Issue: https://bugs.launchpad.net/ironic-python-agent-builder/+bug/2126068
[SEP]
FILES CHANGED:
releasenotes/notes/wait-config-drive-30s-3c51adba5fddc8a2.yaml (+4, -0)
dib/ironic-python-agent-ramdisk/static/etc/systemd/system/ironic-agent-resolve-config-drive.service (+2, -0)
dib/ironic-python-agent-ramdisk/static/usr/local/bin/ironic-python-agent-resolve-configdrive.sh (+15, -7)
",-0.538448,1.786594,-1.246082,-0.283242,-0.782885,0.178315,-0.513102,-0.174263,0.043903,-0.257935,-0.634082,0.012189,0.388514,-0.187572,0.239217
openstack/ironic,I985b3587984ba78570c3a163c08af58cf8a5d0c1,1,1,0,4.2047,0.0303,3,9.17,503,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,4,2,0,0.9623,1.0163,2.67,-16.28,16.03,0,0,0.7576,1,7.5075,0,6,0,10,0,"Allow multiple HTTP redirects for image source

Added multiple redirection response for HttpImageService.validate_href()
function inside ironic/common/image_service.py:
- 301: MOVED_PERMANENTLY
- 302: FOUND
- 307: TEMPORARY_REDIRECT
- 308: PERMANENT_REDIRECT

For all the response, the HTTP server should generate a Location header field
containing a URI as new reference.

Closes-Bug: #2126069
[SEP]
FILES CHANGED:
releasenotes/notes/handle-http-multiple-redirection-cfa2b4693e1db82f.yaml (+11, -0)
ironic/tests/unit/common/test_image_service.py (+49, -1)
ironic/common/image_service.py (+4, -1)
",-1.415067,-1.03703,-0.304381,-0.211681,0.00421,0.063035,-0.598988,0.538849,0.531787,-0.019669,-0.046685,-0.275812,0.347799,0.277862,-0.121801
openstack/kolla,I1ddb4e9ead170f22b231b8595d4dbf7cb0d4fb78,0,0,0.4975,1.7918,0.0,1,12.0,210,0,Bug Fix,1,0,0,396,0.012467,1.0,0,0.4975,1,1,0,0.6128,0.0,1.0,21.93,16.47,0,0,1.0,1,35.0,0,0,0,0,0,"CI: Fix rocky publish jobs - version missing

podman jobs have also been omitted in the original patch
[SEP]
FILES CHANGED:
zuul.d/rocky.yaml (+5, -0)
",2.922824,-1.150952,0.904096,-0.274304,-0.405855,0.180462,-0.140896,0.142995,-0.09291,0.012039,-0.053195,0.174436,0.064229,0.031815,0.165444
openstack/kolla,I8e4470185321fad1be3e2307c7578ca54d197718,0,0,0.4962,1.0986,0.5,1,4.6,201,0,CI,1,0,0,397,0.012497,0.4375,0,0.2171,1,1,0,0.6114,0.0,1.0,25.61,15.75,0,0,1.0,1,67.0,0,0,0,0,0,"CI: Add zuul.d to irrelevant files

It was ommitted in the patch that renamed it from .zuul.d
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",0.585738,0.634806,-1.049823,0.473184,0.197648,0.662318,-0.01389,-0.865941,-1.186916,0.043199,0.745679,-0.130777,-0.442549,0.589533,0.203268
openstack/kolla-ansible,I7d23b9b57deb6d421a8953fe78774bd0155db625,0,0,0.6818,1.6094,0.5,1,5.5,243,0,Doc,0,0,0,66,0.067485,0.0,1,0.0,3,1,0,0.6336,0.0,3.0,8.98,11.29,0,0,0.0,0,48.6,0,0,0,0,0,"docs: change docs after fluentd move to its own role

follow up to [1]
[1] https://review.opendev.org/c/openstack/kolla-ansible/+/954619
[SEP]
FILES CHANGED:
doc/source/contributor/adding-a-new-service.rst (+2, -2)
",0.327497,1.752088,-0.871227,-0.373791,-1.284874,-0.125093,0.033108,-0.099302,-0.139908,0.082526,-0.868307,-0.146143,-0.284537,-0.289879,-0.340793
openstack/kolla,I2f8367ae81d0972517b8712e1cb6ead1044accc4,0,0,0.495,4.5643,0.6842,6,15.5,286,0,CI,1,0,0,398,0.012528,0.6,0,0.297,1,1,0,0.61,2.3921,1.0,2.8,16.52,0,0,1.0,1,2.9792,0,0,0,0,0,"CI: Improve aarch64 and vars config

Rename aarch64 to arm64 to sync with OpenDev nodeset naming
Remove base_arch/base_distro/base_distro_version and derive it
from zuul job name
[SEP]
FILES CHANGED:
zuul.d/debian.yaml (+8, -18)
zuul.d/centos.yaml (+5, -11)
zuul.d/rocky.yaml (+5, -16)
zuul.d/ubuntu.yaml (+5, -15)
zuul.d/base.yaml (+3, -1)
zuul.d/nodesets.yaml (+4, -4)
",0.632103,0.004774,-0.579599,0.180685,0.928525,-0.291378,0.060242,0.23429,-0.497382,-0.655871,-0.445061,-0.355393,-0.424839,0.102602,-0.077693
openstack/kolla-ansible,Ia6b8b879082d746f9ed1aec142f9fcbcb9d688bc,0,0,0.8095,1.6094,0.5,1,9.5,307,0,CI,1,0,0,21,0.005613,0.3333,0,0.2698,2,1,0,0.6329,0.0,2.0,48.03,14.33,0,0,1.0,1,61.4,0,0,0,0,0,"Trigger CI scenario when Fluentd is updated

The Fluentd service is tested by the prometheus-opensearch scenario.
This change will ensure the scenario runs when the Fluentd role
or group vars are updated.
[SEP]
FILES CHANGED:
zuul.d/scenarios/prometheus-opensearch.yaml (+2, -2)
",0.991936,-0.89142,-0.188333,0.803373,0.111439,-0.068486,0.694129,0.563626,0.20628,-0.534847,0.044769,0.642375,-0.498015,-0.196178,-0.051571
openstack/kolla-ansible,I6f724de6ec46e0691639f0a64de5af9e248a27ff,1,1,0,2.7726,0.1333,2,8.71,465,0,Bug Fix,0,0,0,0,0.0,0.1667,0,0.0,4,2,0,0.6321,0.8366,3.0,30.18,13.32,1,0,0.0,1,29.0625,0,6,0,3,0,"Make generation of prometheus.yml idempotent when using custom override files

As the result from the find is not always sorted the same way, consecutive deployments would have a configuration file change, while it actually is not.

Also, diffs are really hard to interpret, when some config parts have been moved up or down.

Resolves-bug: #2126635
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2126635-794d6e351dc6fc2c.yaml (+11, -0)
ansible/roles/prometheus/tasks/config.yml (+2, -2)
",-0.395662,-2.170765,0.000301,0.244676,-0.598046,0.000727,0.178648,-0.449432,-0.097584,0.47487,-0.024905,-0.578615,0.013587,0.00713,-0.164568
openstack/kolla-ansible,If1a1bd0adbd1d0a41d9432d4474e8e74ca8b6873,0,0,0.7727,2.0794,0.1429,2,6.75,548,0,CI,0,0,0,22,0.005874,1.0,0,0.7727,4,2,0,0.6326,0.8631,3.0,-2.12,16.77,0,0,0.0,1,68.5,0,0,0,0,0,"Connect OpenSearch Dashboards directly

OpenSearch Dashboards accepts a list of OpenSearch hosts [1]. This
patch switches to using that mechanism for load balancing,
rather than HAProxy.

One benefit is that if HAProxy goes down, OpenSearch Dashboards will
remain functional.

Connection to the OpenSearch frontend remains unchanged.

[1] https://github.com/opensearch-project/OpenSearch-Dashboards/blob/main/config/opensearch_dashboards.yml#L26
[SEP]
FILES CHANGED:
releasenotes/notes/opensearch-dashboards-direct-to-opensearch-0d9e94c4b6a608c0.yaml (+5, -0)
ansible/roles/opensearch/templates/opensearch_dashboards.yml.j2 (+1, -1)
",-2.225257,1.085116,-0.345011,0.72926,-0.23829,0.072193,-0.318547,0.343024,-0.196496,0.183504,0.242941,-0.252043,-0.042564,-0.235709,-0.394878
openstack/kolla-ansible,Icb8fc54d658937cc806e0441b452b6f4320b292a,0,0,0.4937,2.0794,0.1429,1,10.33,237,0,CI,1,0,0,399,0.012522,0.25,0,0.1234,2,1,0,0.6318,0.0,2.0,54.44,10.58,0,0,1.0,1,29.625,0,0,0,0,0,"CI: Switch ovn jobs to voting and add to gate

Since Debian is often failing (cirros boot crashes) - let's mark
it as non voting.
[SEP]
FILES CHANGED:
zuul.d/scenarios/ovn.yaml (+6, -1)
",0.864511,-0.594515,-0.782986,0.010485,-0.188697,0.314044,0.045548,-1.077695,-1.065872,-0.023639,0.55705,0.207018,0.328719,-0.146235,-0.452688
openstack/kolla-ansible,I4641683420e813e2a8fb5dd2d26c1e07aa486403,0,0,0.4925,1.0986,0.5,1,6.5,146,0,CI,1,0,0,400,0.01255,0.2,0,0.0985,2,1,0,0.6311,0.0,2.0,-14.52,21.06,0,0,1.0,1,48.6667,0,0,0,0,0,"CI: Add nova-cell role to aio triggers
[SEP]
FILES CHANGED:
zuul.d/scenarios/aio.yaml (+1, -1)
",2.628054,0.262733,0.931546,0.089741,0.606896,-0.594388,0.161925,0.716944,0.029467,0.086485,0.006937,0.067613,0.427351,0.251298,-0.600829
openstack/kolla-ansible,Ide74d1a4ca4d0a9a65f8ce4fff2563c4f08708a7,1,0,0.4913,1.9459,0.1667,1,7.0,156,0,CI,1,0,0,401,0.012581,0.3913,0,0.1922,2,1,0,0.6304,0.0,2.0,-17.81,17.09,0,0,1.0,0,22.2857,0,0,0,0,0,"CI: Fine tune proxysql connect and ping timeouts
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+5, -1)
",1.219125,0.219782,0.493306,0.606945,1.597021,-0.049414,-0.460873,-0.08131,-0.411735,0.336266,0.098659,-0.443644,0.782271,-0.555783,0.205973
openstack/kolla-ansible,Id979cc7e4f88994a051a4037224c2c1af479dcfd,1,0,0.4925,1.3863,0.3333,2,3.0,140,0,CI,0,0,0,402,0.01261,1.0,0,0.4925,2,2,0,0.6308,0.9183,1.5,-7.71,17.87,0,0,0.3333,1,35.0,0,0,0,0,0,"CI: Bump cirros version to 0.6.3
[SEP]
FILES CHANGED:
tools/init-runonce (+1, -1)
zuul.d/scenarios/aio.yaml (+1, -0)
",1.61142,1.393155,0.346833,-0.091432,0.552569,0.84772,-0.370204,0.461641,-0.462845,1.493173,-0.071661,0.262233,-0.761992,0.411554,0.541139
openstack/kolla,Iae913ff1b917104fdbb3257c24386f22f6764a03,0,0,0.4938,3.2189,0.5,2,7.0,155,0,Bug Fix,1,0,0,403,0.01264,0.5714,0,0.2822,2,2,0,0.6086,0.4138,1.5,-17.81,17.09,0,0,1.0,1,6.2,0,0,0,0,0,"CI: Update API token for fixing repo visibility
[SEP]
FILES CHANGED:
zuul.d/secrets.yaml (+11, -11)
tests/playbooks/publish.yml (+1, -1)
",3.753892,0.50205,1.942632,0.566405,0.026311,0.498287,0.246355,0.714337,0.782615,0.288914,-0.146089,-0.505319,0.526434,-0.314091,-0.293603
openstack/kolla-ansible,I43d0a65ae796b080dd977f5c227f7360746e7c9b,0,0,0.4926,1.0986,0.5,1,5.5,135,0,Bug Fix,1,0,0,404,0.012662,0.2857,0,0.1407,2,1,0,0.6312,0.0,2.0,-14.09,20.38,0,0,1.0,1,45.0,0,0,0,0,0,"CI: Fix Rocky10 jobs parent
[SEP]
FILES CHANGED:
zuul.d/scenarios/aio.yaml (+1, -1)
",3.697162,0.531145,1.494535,-1.069188,-0.002564,0.906426,-0.381333,0.639141,0.010465,0.233662,0.597872,-0.716619,0.519814,0.209075,-0.08013
openstack/kolla,I142257d6537ceeff23cb2cb34e64d93de9f19d2e,0,0,0.4914,2.0794,0.8571,1,2.86,233,0,Feature,0,0,0,405,0.012692,0.8571,0,0.4212,3,1,0,0.6072,0.0,3.0,-24.48,21.14,0,0,0.0,0,29.125,0,0,0,0,0,"ironic: Remove ipxe.efi handling for EL10

RHEL removed ipxe.efi - see [1].

[1]: https://issues.redhat.com/browse/RHEL-37610
[SEP]
FILES CHANGED:
docker/ironic/ironic-pxe/extend_start.sh (+1, -6)
",-0.752269,2.249146,-1.32058,0.21617,-0.411206,0.368252,-1.025772,-0.051378,-0.166335,0.473115,-0.150223,-0.350677,-0.020679,-0.234618,-0.061807
openstack/kolla-ansible,Ic9ddafb9ad5dcd27bb5efec1e94e64db886ee954,0,0,0.4901,1.9459,0.0,1,3.5,203,0,CI,1,0,0,406,0.012721,0.0,0,0.0,2,1,0,0.6305,0.0,2.0,-86.77,24.26,0,0,1.0,1,29.0,0,0,0,0,0,"CI: Add rocky 10 ironic jobs

Depends-On: https://review.opendev.org/c/openstack/kolla/+/963192
[SEP]
FILES CHANGED:
zuul.d/scenarios/ironic.yaml (+6, -0)
",0.906612,3.505786,-1.303853,-0.377219,-1.487868,0.583503,0.186817,-0.391929,-0.200318,-0.826919,-0.835541,-0.102655,0.145971,-0.3299,-0.095235
openstack/ironic-python-agent,If195b8f2c471cd7cf3f690664c7f13b6cef10ce2,0,0,1.0,6.0845,0.0023,4,8.82,782,0,Doc,0,0,0,2,0.037037,1.0,0,1.0,3,2,0,0.9394,0.653,1.75,22.58,13.84,1,0,0.8744,1,1.7813,0,0,0,0,0,"Implement functionality for the is_root_volume RAID config

The is_root_volume config option has been listed in the documentation
for a while, but has not been supported by the IPA.
With this patch, if there is a logical disk
in the target_raid_config with the setting is_root_volume: True,
it will be picked up as the root device (root_device hints
will not even be checked). Additionally, if is_root_volume: False,
for a volume then it will be excluded from the list of
possible root devices used by the root_device hints.

Depends-On: https://review.opendev.org/c/openstack/ironic-python-agent/+/965797
[SEP]
FILES CHANGED:
ironic_python_agent/hardware.py (+43, -1)
releasenotes/notes/add-is_root_volume-functionality-02340c3887b882e8.yaml (+9, -0)
ironic_python_agent/raid_utils.py (+2, -0)
ironic_python_agent/tests/unit/test_hardware.py (+383, -0)
",-2.198895,0.637552,0.666058,0.527474,-0.155342,0.160904,0.191579,-0.453643,0.531875,-0.20747,0.217426,0.324663,-0.34352,0.023534,-0.04411
openstack/kolla-ansible,I2be9d112e1a4580fd1864d34b8d2c71f47d087c3,0,0,0.4889,1.7918,0.2,3,6.2,270,0,CI,1,0,0,407,0.01275,0.42,0,0.2054,2,1,0,0.6298,1.371,1.67,36.8,14.09,0,0,1.0,1,45.0,0,0,0,0,0,"CI: Add more file triggers to aio and cells

Move test-core-openstack.sh and test-dashboard.sh from
base - also test-proxysql is only being run in cells
scenario.
[SEP]
FILES CHANGED:
zuul.d/scenarios/cells.yaml (+1, -0)
zuul.d/base.yaml (+0, -1)
zuul.d/scenarios/aio.yaml (+3, -0)
",0.223305,-0.401519,-0.890002,0.042723,0.1398,-1.236193,-0.052007,0.332509,-0.766276,-0.634027,-0.369319,-0.088585,-0.079894,0.768535,0.110493
openstack/kolla-ansible,If8873eaec35c4d2e5b13cdb8bcefb96230c59b51,1,1,0.5794,2.1972,0.0,2,11.14,609,0,Bug Fix,0,0,0,107,0.018775,0.2,0,0.1159,4,2,0,0.629,0.5436,3.0,20.9,14.71,0,0,0.0,1,67.6667,0,10,0,11,0,"Fix Horizon crash on Memcached node failure

Horizon uses Django's PyMemcacheCache backend
to store session data.

When one of the Memcached nodes becomes unavailable,
Django raises an exception during session access,
causing Horizon to return HTTP 500 errors.

This patch adds 'ignore_exc': True to the cache OPTIONS
to make Django treat such errors as cache misses
instead of crashing.

This improves Horizon stability in high-availability
setups with multiple Memcached nodes.

Closes-Bug: #2106557
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2106557-6adff0f76b17500e.yaml (+7, -0)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+1, -0)
",-1.476187,-1.829145,0.340256,0.093448,-0.153335,-0.00947,-0.417237,0.263741,0.135105,0.13676,0.193427,-0.165882,0.236753,-0.331149,-0.072666
openstack/ansible-collection-kolla,I82ddd0b9248d529805e8fc1e79a2ed5d305e2bca,0,0,0.4877,3.6376,0.2703,1,8.0,238,0,CI,1,0,0,408,0.012779,0.5,0,0.2439,1,1,0,0.3947,0.0,1.0,-19.84,16.53,0,0,1.0,1,6.2632,0,0,0,0,0,"CI: Update k-a job names, add Rocky Linux 10

Override files trigger from Kolla-Ansible to include
ansible-collection-kolla roles.
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+27, -10)
",1.348085,-0.759511,-1.008689,-0.376315,0.01286,-0.993035,-0.35055,0.760017,-0.553858,-0.560825,-0.333497,0.399734,0.220898,0.376717,-0.46154
openstack/ansible-collection-kolla,Iaf5819eb51a76fbd1ebd814c5511bf87b2ec48d9,0,0,0.4866,1.9459,0.5,1,6.0,155,0,CI,1,0,1,409,0.012796,0.597,1,0.2905,0,1,0,0.3846,0.0,0.0,-53.05,25.73,0,0,1.0,0,22.1429,0,0,0,0,0,"CI: Bump ansible-core, ansible-lint and hacking
[SEP]
FILES CHANGED:
test-requirements.txt (+3, -3)
",0.579312,2.681805,-0.413048,0.631739,1.546182,-1.013184,-0.789585,-0.17394,-1.003642,0.122955,0.171441,0.395104,0.257921,-0.280873,0.180646
openstack/kolla-ansible,Iecb212c38732d38f704f1a7d43036f8bbade496a,0,0,0.4854,5.3083,0.4527,8,4.33,147,0,CI,0,0,0,410,0.012825,0.5556,0,0.2696,3,3,0,0.6295,2.1141,2.0,-5.81,17.12,1,0,0.4776,1,0.7277,0,0,0,0,0,"CI: Rework deploy.sh to an Ansible role
[SEP]
FILES CHANGED:
tests/deploy.sh (+0, -80)
roles/kolla-ansible-deploy/tasks/deploy.yml (+55, -0)
tests/run.yml (+2, -10)
roles/kolla-ansible-deploy/tasks/main.yml (+11, -0)
tests/pre.yml (+1, -0)
zuul.d/scenarios/aio.yaml (+1, -0)
roles/kolla-ansible-deploy/tasks/certificates.yml (+39, -0)
zuul.d/scenarios/lets-encrypt.yaml (+1, -1)
",2.155746,0.590212,0.722602,0.181568,0.564096,0.110361,-0.3748,0.552906,-0.287064,0.188026,0.119229,-0.008677,-0.267847,0.409393,-0.67761
openstack/ironic,I63197791b4b54072310dfd8525b40044e514ff7f,1,1,1.0,3.7842,0.0465,3,12.2,516,0,Bug Fix,0,0,0,8,0.014286,1.0,0,1.0,5,2,0,0.9625,1.3652,3.33,28.03,14.06,0,0,0.5814,1,11.7273,0,6,0,7,0,"Check _by_arch values with redfish vmedia

Prior to this change, as reported in bug 2126991, a generated vmedia ISO
would not be created properly using information in the
[conductor]/*_kernel_by_arch and [conductor]/*_ramdisk_by_arch.

This change restores the documented behavior of checking driver_info
first, then checking *_by_arch, then checking the global default.

Assisted-by: Claude Code 2.0
Closes-Bug: #2126991
Signed-Off-By: Jay Faulkner <jay@jvf.cc>
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/test_image_utils.py (+25, -0)
ironic/drivers/modules/image_utils.py (+4, -2)
releasenotes/notes/fix-vmedia-arch-params-aa792a26c5399fea.yaml (+12, -0)
",-2.422598,0.323514,0.027251,0.056595,0.101498,0.217144,-0.557299,-0.011583,0.112185,-0.029734,0.604822,0.006646,-0.102104,0.09125,-0.292406
openstack/ironic,Idcc03e6ce377ecf6b9db511e3283fb6f2496b037,1,1,1.0,1.9459,0.5,2,5.45,498,0,Bug Fix,0,0,0,9,0.010297,0.1111,0,0.1111,4,2,0,0.9627,0.9183,3.0,27.87,13.52,1,0,0.0,1,71.1429,0,6,0,10,0,"api: Allow bios values to be None

Despite what the api-ref says [1], the 'bios.[*].value' field included
in responses to 'GET /v1/nodes/{node_ident}/bios' can be null. The
BIOSSetting database model in 'ironic.db.sqlalchemy.models' confirms as
much. Update the schema and api-ref to reflect this. This leaves only
the 'name' and 'created_at' fields as non-nullable.

Closes-bug: #2127079
[SEP]
FILES CHANGED:
api-ref/source/parameters.yaml (+1, -1)
ironic/api/schemas/v1/bios.py (+2, -2)
",-1.300566,0.114621,-0.036988,0.315442,-0.180328,-0.297341,-0.144657,-0.053434,0.348731,0.039627,0.080698,-0.239453,-0.076257,0.215192,-0.43461
openstack/kolla-ansible,I1a8ebc171da8990b21f03e6d5c3da296eef92e28,0,0,0.4842,5.4337,0.5044,6,6.5,152,0,CI,1,0,0,411,0.012775,0.4906,0,0.2375,2,3,0,0.6287,2.1799,1.33,-47.05,24.14,0,0,1.0,1,0.6638,0,0,0,0,0,"CI: Rework Hashicorp Vault jobs into OpenBao
[SEP]
FILES CHANGED:
tests/run-openbao.yml (+5, -5)
tests/test-hashicorp-vault-passwords.sh (+0, -69)
zuul.d/scenarios/openbao.yaml (+40, -0)
zuul.d/project.yaml (+1, -1)
zuul.d/scenarios/hashi-vault.yaml (+0, -40)
tests/test-openbao-passwords.sh (+67, -0)
",1.79606,0.281621,0.482148,-0.378035,0.519276,0.238969,-0.714993,1.4565,-0.664914,-0.33522,0.331209,0.168504,-0.165697,-0.520953,-0.487358
openstack/kolla-ansible,I55ea22002ea81085a43dc053f619bb61cd497c69,0,0,0.483,5.118,0.6205,8,4.0,168,0,CI,0,0,0,412,0.012716,0.3429,0,0.1656,3,3,0,0.628,2.7082,1.88,-65.12,21.6,1,0,0.8976,1,1.006,0,0,0,0,0,"CI: Rework test/deploy/upgrade-bifrost.sh into Ansible roles
[SEP]
FILES CHANGED:
roles/kolla-ansible-test-bifrost/tasks/main.yml (+35, -0)
tests/deploy-bifrost.sh (+0, -23)
tests/run.yml (+10, -24)
roles/kolla-ansible-upgrade-bifrost/tasks/main.yml (+8, -0)
tests/test-bifrost.sh (+0, -31)
tests/upgrade-bifrost.sh (+0, -24)
roles/kolla-ansible-deploy-bifrost/tasks/main.yml (+9, -0)
zuul.d/scenarios/bifrost.yaml (+1, -1)
",0.933042,1.677742,-0.662724,-0.234361,0.755898,-0.698756,-0.497367,0.307378,-0.576137,-0.388375,-0.166705,-0.051778,-0.512555,0.184376,0.032535
openstack/kolla-ansible,Iaeb6786625c8c0c71c7b4e0ab9450c67bc13ed1c,0,0,0.4818,4.7185,0.7748,3,4.0,152,0,CI,1,0,0,413,0.012682,0.3333,0,0.1606,3,2,0,0.6273,1.3503,1.67,-15.78,21.6,1,0,1.0,0,1.3571,0,0,0,0,0,"CI: Rework test-dashboard.sh to Ansible role
[SEP]
FILES CHANGED:
roles/kolla-ansible-test-dashboard/tasks/main.yml (+21, -0)
tests/run.yml (+4, -18)
tests/test-dashboard.sh (+0, -68)
",1.79263,0.675099,-0.028101,-0.023856,0.765935,-0.418265,-0.621784,0.712865,-0.537458,-0.076054,0.095667,-0.112484,-0.280274,0.582151,-0.405957
openstack/ironic,I200d631e166075ceab80dcd4b0ff596d1860aa3b,1,1,0.9762,5.8111,0.6937,8,13.0,616,0,Bug Fix,0,0,0,42,0.010294,1.0,0,0.9762,5,2,0,0.963,2.4657,3.0,51.4,12.23,1,0,0.5105,1,1.8443,0,6,0,7,0,"Remove bespoke logic for handling redirects while validating URLs

This logic is broken in a few places when dealing with real world
redirect cases, such as Debian Cloud images redirecting to mirrors.

It seems that the code was written with an incorrect assumption that
requests does not limit redirects by default. It does, the default
max_redirects seems to be 30. We can change it on Session if we need.

The anaconda case is now handled by checking the url field of the
response.

Closes-Bug: #2127154
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_images.py (+1, -16)
ironic/common/exception.py (+0, -15)
ironic/drivers/modules/deploy_utils.py (+37, -59)
ironic/tests/unit/common/test_image_service.py (+32, -80)
ironic/common/images.py (+4, -15)
releasenotes/notes/redirect-f2f1bc4079763e7e.yaml (+5, -0)
ironic/common/image_service.py (+1, -27)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+22, -19)
",-1.228865,-1.8801,0.305736,0.175146,-0.588604,0.10462,0.241846,-0.092601,-0.053192,0.439284,0.495153,-0.340067,0.160086,-0.433464,0.244483
openstack/kolla,I85ae37250ac4ef629b77ade04826a363e8047a91,1,1,0.4807,1.0986,0.5,1,12.33,331,0,Bug Fix,0,0,0,414,0.01267,0.0,0,0.0,3,1,0,0.6059,0.0,3.0,4.54,18.99,0,0,0.0,0,110.3333,0,6,0,7,0,"neutron: keepalived wrapper script does not rm containers

keepalived wrapper script as the only one didn't have --rm
in docker/podman invocation - so these didn't get deleted
when stopped/crashed/etc.

Closes-Bug: #2127170
[SEP]
FILES CHANGED:
docker/neutron/neutron-base/keepalived (+1, -1)
",0.223094,-1.685769,-0.277021,-0.588465,-0.556157,-0.318381,-0.304384,-0.534045,-0.851547,-0.476949,0.189115,-0.474543,0.418807,0.472059,0.223061
openstack/kolla,Ifc351d5d612e6c6cc82be282aed179c656ae252c,0,0,0.4819,5.7746,0.648,2,9.0,430,0,Feature,0,0,0,415,0.0127,0.5349,0,0.2578,2,2,0,0.6067,0.1158,2.0,-5.34,18.71,0,0,0.0,1,1.3354,0,0,0,0,0,"repos: Deduplicate repos.yaml

Introduce rpm/deb entry in repos.yaml, create a structure

[base_package_type]:
  [base_distro]:
    [base_distro-$arch]

Allow any of these to be undefined, defaulting to empty dict

This allows to deduplicate entries between distros of the same
base_package_type (rpm/deb)

Sort repos.yaml
[SEP]
FILES CHANGED:
kolla/template/methods.py (+3, -2)
kolla/template/repos.yaml (+110, -206)
",-1.145652,-0.443502,0.164367,0.245919,0.857205,-0.426924,-0.140763,0.042805,-0.282309,-0.120272,0.22035,-0.701864,-0.045888,0.601875,-0.515844
openstack/kolla-ansible,I73ca974aa6eef071e53dcbb9b66af2713ac655a8,0,0,0.4808,4.7005,0.3761,4,4.0,145,0,CI,0,0,0,416,0.012606,0.4,0,0.1923,3,2,0,0.6266,1.3859,2.0,-43.97,21.6,0,0,0.3853,0,1.3182,0,0,0,0,0,"CI: rework upgrade.sh to Ansible role
[SEP]
FILES CHANGED:
roles/kolla-ansible-upgrade/tasks/main.yml (+65, -0)
roles/kolla-ansible-deploy/tasks/deploy.yml (+1, -1)
tests/run.yml (+2, -8)
tests/upgrade.sh (+0, -32)
",2.198672,0.884628,0.241604,0.199545,1.003759,-0.061082,-0.386085,0.432453,-0.660282,0.065427,0.264092,-0.352862,-0.155228,0.420296,-0.411468
openstack/kolla-ansible,Ic1e0a6643e67467a22e91d277a9947c027935f09,0,0,0.4796,4.9127,0.4148,9,7.75,295,0,CI,0,0,0,417,0.012595,0.6667,0,0.3197,3,3,0,0.6259,2.3393,1.56,2.48,16.0,0,0,0.5556,1,2.1691,0,0,0,0,0,"CI: Switch test-core-openstack.sh to Tempest run

Unfortunately that will lead to dropping DNS integration
tests for internal DNS, because neutron-tempest-plugin
does not have such tests.
[SEP]
FILES CHANGED:
tests/post.yml (+4, -0)
tests/get_logs.sh (+1, -1)
roles/kolla-ansible-tempest/tasks/main.yml (+49, -0)
tests/run.yml (+6, -26)
roles/kolla-ansible-tempest/defaults/main.yml (+11, -0)
tests/pre.yml (+6, -0)
zuul.d/base.yaml (+1, -0)
tests/setup_disks.sh (+0, -29)
zuul.d/scenarios/cephadm.yaml (+1, -0)
",1.30357,-0.812105,-0.33026,-0.034895,-0.415025,-0.652573,-0.065693,0.021512,-0.613031,-0.36929,-0.367657,0.035511,0.111832,0.163858,0.214962
openstack/kolla,I01278f76ee82b018a854b5862f3caaa8c78a9a30,0,0,0.6316,4.8122,0.8279,15,8.46,858,0,Doc,0,0,0,19,0.030016,0.5,0,0.3158,3,6,0,0.6054,2.6806,2.27,42.12,11.75,1,0,0.0984,1,6.9756,0,0,0,0,0,"Drop support for building MariaDB clustercheck

MariaDB clustercheck script has not been maintained and it will not work
with MariaDB 11.4 (the next LTS version).
This is because clustercheck.sh uses ``mysql*`` commands but from
MariaDB 11.4, those commands are not supported.

The health check of MariaDB server containers will be done by new script
which comes with change [1].

Without MariaDB clustercheck, MariaDB server becomes only container image in
the family, so mariadb-base and mariadb-server dockerfiles are merged.
To avoid breaking changes, the name 'mariadb-server' is retained.
Follow-up to rename references in Kolla and K-A from 'mariadb-server' to
'mariadb' would be nice.

[1] https://review.opendev.org/c/openstack/kolla/+/962657
[SEP]
FILES CHANGED:
docker/mariadb-server/extend_start.sh (+0, -0)
docker/mariadb-server/security_reset.expect (+0, -0)
docker/mariadb/mariadb-base/Dockerfile.j2 (+0, -44)
docker/mariadb/mariadb-clustercheck/Dockerfile.j2 (+0, -19)
docker/mariadb/mariadb-clustercheck/extend_start.sh (+0, -11)
kolla/common/sources.py (+1, -1)
docker/mariadb-server/backup_replica.sh (+0, -0)
releasenotes/notes/remove-mariadb-clustercheck-427a6cfb3f39c508.yaml (+5, -0)
docker/mariadb-server/backup.sh (+0, -0)
zuul.d/scenarios/cephadm.yaml (+4, -4)
docker/mariadb-server/Dockerfile.j2 (+9, -1)
zuul.d/scenarios/mariadb.yaml (+2, -2)
docker/mariadb-server/healthcheck_mariadb (+0, -0)
docker/mariadb-server/mariadb_sudoers (+0, -0)
docker/mariadb/mariadb-clustercheck/socat_wrapper.sh (+0, -19)
",-2.736948,0.560905,1.839802,-0.227062,-0.241744,0.001341,0.246927,0.401534,-0.402081,-0.121189,0.241307,0.18443,-0.267158,0.073116,-0.075972
openstack/kolla-ansible,Ibe21c342ae4c4d79c16d4058f90f5763e94d231c,0,0,0.4785,4.6151,0.35,3,4.0,149,0,CI,0,0,0,418,0.012574,0.3077,0,0.1472,3,2,0,0.6251,1.2755,1.67,-29.87,21.6,0,0,0.37,0,1.4752,0,0,0,0,0,"CI: Rework reconfigure.sh to Ansible role
[SEP]
FILES CHANGED:
tests/reconfigure.sh (+0, -26)
tests/run.yml (+2, -9)
roles/kolla-ansible-reconfigure/tasks/main.yml (+63, -0)
",1.658338,1.283099,0.250515,0.556734,1.165988,0.373974,-0.57362,0.382323,-0.674826,0.172347,0.427636,-0.253322,-0.346848,0.246437,-0.255981
openstack/kolla-ansible,Icd8648399a7d0a74419c80d573792397f971ff3c,0,0,0.4773,4.2485,0.0725,5,4.0,151,0,CI,0,0,0,419,0.012566,0.3,0,0.1432,3,3,0,0.6244,1.5942,2.0,-15.78,21.6,0,0,0.1739,1,2.1571,0,0,0,0,0,"CI: Rework setup_disks.sh into Ansible role
[SEP]
FILES CHANGED:
roles/kolla-ansible-setup-disks/README.rst (+15, -0)
roles/kolla-ansible-setup-disks/tasks/main.yml (+42, -0)
tests/run.yml (+2, -5)
zuul.d/scenarios/zun.yaml (+2, -0)
zuul.d/scenarios/cephadm.yaml (+3, -0)
",1.37962,1.172639,0.123049,0.208857,1.047026,-0.151058,-0.709455,0.205229,-0.611516,-0.214972,0.498936,-0.610865,-0.54314,0.044709,-0.182299
openstack/kolla-ansible,I6762b691b927de31fa1abd83c4c14e87226fe5e2,0,0,0.4762,7.2123,0.5262,68,23.0,347,0,Bug Fix,0,0,1,420,0.01257,1.0,0,0.4762,6,5,0,0.6237,4.9041,3.99,19.81,17.9,1,0,0.1107,1,0.2559,0,0,0,0,0,"Switch to pypi version of j2lint and fix linting errors

Since ipwrap filter is getting moved another time
inside ansible code - let's switch to j2lint that is
actively maintained and it's rules will help in
readability of jinja2 templates
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/haproxy/haproxy_external_frontend.cfg.j2 (+1, -1)
ansible/roles/keystone/templates/keystone.conf.j2 (+2, -2)
ansible/roles/manila/templates/manila-share.conf.j2 (+29, -23)
ansible/roles/masakari/templates/masakari.conf.j2 (+3, -3)
ansible/roles/cron/templates/cron-logrotate-global.conf.j2 (+1, -1)
ansible/roles/ironic/templates/ironic-dnsmasq.conf.j2 (+7, -7)
ansible/roles/glance/templates/glance-api.conf.j2 (+3, -2)
ansible/roles/keystone/templates/fernet-push.sh.j2 (+8, -8)
ansible/roles/rabbitmq/templates/advanced.config.j2 (+1, -0)
ansible/roles/designate/templates/pools.yaml.j2 (+29, -29)
ansible/roles/ceilometer/templates/pipeline.yaml.j2 (+2, -1)
ansible/roles/cinder/templates/cinder-wsgi.conf.j2 (+3, -3)
ansible/roles/loadbalancer/templates/proxysql/proxysql.yaml.j2 (+20, -20)
ansible/roles/skyline/templates/skyline-console.json.j2 (+1, -1)
ansible/roles/proxysql-config/templates/rules.yaml.j2 (+7, -7)
ansible/roles/grafana/templates/grafana.json.j2 (+5, -5)
ansible/roles/heat/templates/wsgi-heat-api-cfn.conf.j2 (+3, -3)
ansible/roles/neutron/templates/neutron-l3-agent-wrapper.sh.j2 (+4, -4)
tests/templates/globals-default.j2 (+16, -16)
ansible/roles/cinder/templates/cinder-volume.json.j2 (+1, -1)
tests/templates/nova-compute-overrides.j2 (+2, -2)
ansible/roles/nova-cell/templates/nova.conf.j2 (+14, -14)
ansible/roles/fluentd/templates/conf/input/10-openvswitch.conf.j2 (+10, -10)
ansible/roles/mariadb/templates/galera.cnf.j2 (+1, -1)
ansible/roles/neutron/templates/neutron-openvswitch-agent.json.j2 (+4, -2)
ansible/roles/octavia/templates/octavia.conf.j2 (+8, -8)
ansible/roles/masakari/templates/masakari-monitors.conf.j2 (+3, -3)
ansible/roles/placement/templates/placement-api-wsgi.conf.j2 (+3, -3)
tests/templates/inventory.j2 (+13, -13)
tox.ini (+1, -2)
ansible/roles/fluentd/templates/conf/output/03-opensearch.conf.j2 (+7, -7)
ansible/roles/letsencrypt/templates/letsencrypt-lego-run.sh.j2 (+10, -8)
ansible/roles/neutron/templates/l3_agent.ini.j2 (+4, -4)
releasenotes/notes/lightbits-jwt-84fba12dd05108c0.yaml (+4, -0)
ansible/roles/haproxy-config/templates/haproxy_single_service_split.cfg.j2 (+124, -124)
tests/j2lint.py (+0, -88)
ansible/roles/ironic/templates/ironic-api-wsgi.conf.j2 (+3, -3)
ansible/roles/ironic/templates/ironic.conf.j2 (+6, -6)
ansible/roles/neutron/templates/openvswitch_agent.ini.j2 (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+14, -14)
lint-requirements.txt (+1, -0)
ansible/roles/heat/templates/wsgi-heat-api.conf.j2 (+3, -3)
ansible/roles/trove/templates/trove-wsgi.conf.j2 (+3, -3)
ansible/roles/keystone/templates/httpd-keystone.conf.j2 (+22, -22)
ansible/roles/nova/templates/nova-metadata-wsgi.conf.j2 (+3, -3)
ansible/roles/horizon/templates/horizon.json.j2 (+1, -1)
ansible/roles/loadbalancer/templates/haproxy/haproxy_main.cfg.j2 (+2, -2)
ansible/roles/fluentd/templates/conf/input/00-global.conf.j2 (+2, -2)
ansible/roles/fluentd/templates/conf/output/00-local.conf.j2 (+19, -19)
ansible/roles/loadbalancer/templates/keepalived/keepalived.conf.j2 (+7, -7)
ansible/roles/nova/templates/nova-api-wsgi.conf.j2 (+3, -3)
ansible/roles/loadbalancer/templates/haproxy/haproxy_run.sh.j2 (+4, -4)
ansible/roles/horizon/templates/horizon.conf.j2 (+3, -3)
ansible/roles/valkey/templates/valkey-server.conf.j2 (+8, -8)
ansible/roles/octavia/templates/octavia-wsgi.conf.j2 (+3, -3)
ansible/roles/keystone/templates/wsgi-keystone.conf.j2 (+22, -22)
ansible/roles/rabbitmq/templates/rabbitmq.conf.j2 (+2, -2)
ansible/roles/telegraf/templates/telegraf.conf.j2 (+2, -2)
ansible/roles/fluentd/templates/conf/output/01-es.conf.j2 (+13, -13)
ansible/roles/fluentd/templates/conf/input/13-uwsgi.conf.j2 (+2, -2)
ansible/roles/prometheus/templates/prometheus.yml.j2 (+76, -76)
ansible/roles/skyline/templates/skyline.yaml.j2 (+4, -4)
ansible/roles/neutron/templates/neutron.conf.j2 (+1, -1)
ansible/roles/proxysql-config/templates/users.yaml.j2 (+6, -6)
ansible/roles/cloudkitty/templates/cloudkitty.conf.j2 (+16, -16)
ansible/roles/nova-cell/templates/nova.conf.d/libvirt.conf.j2 (+2, -2)
ansible/roles/horizon/templates/_9998-kolla-settings.py.j2 (+10, -10)
ansible/roles/fluentd/templates/fluentd.conf.j2 (+24, -24)
",0.135929,-1.64325,-0.143045,0.05309,-0.111974,-1.07061,0.271256,-0.432427,-0.676651,0.021631,-0.17715,-0.2514,-0.165644,-0.389333,0.479854
openstack/kolla-ansible,I3a8f40a06d64ac5ebd321c4da7fe577c1c4c380a,1,1,0.6,2.3026,0.2222,2,16.0,531,0,Bug Fix,0,0,0,5,0.035714,0.0,0,0.0,3,2,0,0.623,0.9911,2.5,20.07,18.28,1,0,0.0,1,53.1,0,0,0,0,0,"fix: use `FQDN` for `horizon` endpoints

The `public` and `internal` endpoints for `Horizon` have been set
explicitly to `kolla_external_fqdn` and `kolla_internal_fqdn` this
setup does not work if using `HAProxy` single frontend configuration and
can lead to `CORS` blocked when attempting to upload images via the
`Horizon` dashboard. This change brings `Horizon` configuration inline
with other services.

Closes-Bug: 2111125
[SEP]
FILES CHANGED:
releasenotes/notes/fix-horizon-glance-cors-55e2e83902662c99.yaml (+5, -0)
ansible/group_vars/all/horizon.yml (+2, -2)
",-1.553402,-0.276231,-0.29726,0.412866,0.83926,-0.073993,-0.650474,0.252314,0.031187,-0.236831,-0.181754,-0.544773,0.026119,-0.328231,-0.413316
openstack/kolla-ansible,Iaedad0e13f81b546af3a8e0c1e6ae7ca9da994a4,0,0,0.6667,2.7081,0.0714,4,5.5,264,0,CI,0,0,0,3,0.073171,0.75,0,0.5,4,4,0,0.6234,1.8352,3.5,-64.08,24.02,1,0,0.0,1,17.6,0,0,0,0,0,"Add RabbitMQ management interface SSL

This change implements RabbitMQ management interface SSL configuration
 when ``rabbitmq_enable_tls`` is enabled.
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/templates/rabbitmq.conf.j2 (+5, -0)
releasenotes/notes/add_rabbitmq_mgm_tls-86706572b96aacfa.yaml (+4, -0)
doc/source/reference/message-queues/rabbitmq.rst (+0, -1)
ansible/roles/rabbitmq/defaults/main.yml (+4, -0)
",-0.111167,0.955543,-0.642437,1.418097,1.234869,0.485186,-0.637201,0.756147,0.550699,-0.083755,0.118359,-0.052959,-0.920917,-0.894316,0.246987
openstack/kayobe,I9ac26db07f68ecd3859412d3d33a964342be4cd0,0,0,0.5833,4.7449,0.4737,17,8.86,551,0,Feature,0,0,0,24,0.009642,1.0,0,0.5833,5,1,0,0.8994,3.8282,2.06,19.09,13.87,0,0,0.0,0,4.7913,0,0,0,0,0,"Replace local_action with delegate to localhost

In preparation for the ansible bump:

  [DEPRECATION WARNING]: Using a mapping for `action` is deprecated. This feature will be removed from ansible-core version 2.23.
  Origin: /home/ubuntu/kayobe/ansible/roles/ssh-known-host/tasks/main.yml:31:5

  29 - name: Ensure SSH keys are in known hosts
  30   local_action:
  31     module: known_hosts
       ^ column 5

  Use a string value for `action`.
[SEP]
FILES CHANGED:
ansible/roles/ip-allocation/tasks/main.yml (+2, -2)
ansible/overcloud-provision.yml (+2, -2)
ansible/roles/kolla-openstack/molecule/enable-everything/prepare.yml (+8, -8)
ansible/roles/ssh-known-host/tasks/main.yml (+4, -4)
ansible/seed-manage-containers.yml (+2, -2)
ansible/overcloud-inventory-discover.yml (+2, -2)
ansible/baremetal-compute-introspection-data-save.yml (+4, -4)
ansible/docker-registry.yml (+1, -1)
ansible/opensm.yml (+1, -1)
ansible/roles/junos-switch/tasks/main.yml (+2, -2)
ansible/drac-facts.yml (+4, -4)
ansible/seed-vm-provision.yml (+2, -2)
ansible/roles/console-allocation/tasks/main.yml (+2, -2)
ansible/roles/dell-switch/tasks/main.yml (+6, -6)
requirements.yml (+6, -0)
ansible/overcloud-introspection-data-save.yml (+4, -4)
ansible/dump-config.yml (+8, -8)
",-0.80067,0.921395,0.397312,-0.026458,-0.377783,0.018222,0.410273,0.450981,0.518853,0.092388,0.351429,-0.479403,0.083039,0.185493,-0.193883
openstack/openstack-ansible-os_neutron,I105be68c529efb438b1beb642284dac6734d94ed,1,0,0.9588,2.7081,0.1429,3,11.67,351,0,Bug Fix,0,0,0,243,0.052792,0.9467,0,0.9077,2,2,0,0.9259,1.1488,1.33,-5.63,14.95,0,0,0.0,1,23.4,0,0,0,0,0,"Rename  OVN BGP Agent SHA pinning var

This aims to fix installation of ovn-bgp-agent on stable branches, as
SHA pinning is using networking_ovn_bgp_git_install_branch variable
while role is using networking_ovn_bgp_install_branch
[SEP]
FILES CHANGED:
defaults/main.yml (+1, -1)
vars/main.yml (+1, -1)
releasenotes/notes/ovn_bgp_git_track-51f2f484516aad31.yaml (+10, -0)
",-1.334807,-0.313675,-0.956861,0.854903,1.29799,-0.791989,-0.982735,0.615736,0.031089,-0.368477,0.060882,-0.577316,-0.554368,-0.218034,0.462256
openstack/kolla-ansible,I814413fdb1a74675846a4ee2d5fbada9592fceef,0,0,0.4751,5.3083,0.01,4,6.0,141,0,CI,1,0,0,421,0.012109,0.5,0,0.2375,3,3,0,0.6227,1.4139,2.0,-38.95,25.73,0,0,1.0,1,0.698,0,0,0,0,0,"CI: Use selenium in Horizon tests
[SEP]
FILES CHANGED:
roles/kolla-ansible-test-dashboard/tasks/main.yml (+59, -0)
tests/post.yml (+20, -0)
zuul.d/scenarios/aio.yaml (+2, -2)
tests/testinfra/test_horizon.py (+118, -0)
",2.809505,2.168033,1.096446,0.661909,0.950444,0.430831,-0.268281,-0.122056,-0.77095,0.107409,0.405587,-0.196736,0.540679,-0.497763,0.021613
openstack/kolla-ansible,I74340a9b279d5c12542cdf54ae92d814e7a8bf38,1,0,0.4739,2.3026,0.1111,3,11.0,261,0,Feature,0,0,0,422,0.012068,0.2,0,0.0948,4,2,0,0.622,1.5305,2.67,29.03,14.1,1,0,0.2222,1,26.1,0,0,0,0,0,"uwsgi: Add configuration for http chunked input

This is mainly required for Glance, but other services use that
as well - so let's enable it by default.
[SEP]
FILES CHANGED:
releasenotes/notes/uwsgi-chunked-input-8b15b1c77f093332.yaml (+4, -0)
zuul.d/scenarios/aio.yaml (+1, -1)
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+3, -0)
",1.367256,-1.193969,-0.155222,0.371142,-0.71016,-0.043419,0.305931,-0.7943,-0.730579,0.305356,-0.115419,-0.17239,0.021121,-0.496238,-0.026408
openstack/kolla-ansible,Iccc51c4dc57d0309bbca7aef655286bf8e6e49c5,0,0,0.4752,0.6931,0.0,1,6.5,146,0,CI,1,0,0,423,0.012094,0.2,0,0.095,2,1,0,0.6224,0.0,2.0,-14.52,21.06,0,0,1.0,1,73.0,0,0,0,0,0,"CI: Add rocky to mariadb scenario gate
[SEP]
FILES CHANGED:
zuul.d/scenarios/mariadb.yaml (+1, -0)
",2.679381,0.6112,0.710017,-0.433882,0.899549,0.110506,0.13469,0.424552,-0.434596,-0.21557,0.427902,0.045187,-0.084123,-0.336351,-0.207167
openstack/kayobe,Ia2d2c824c64fce4779d4e38eec155dc020a4ad7e,1,1,0,2.4849,0.0909,2,12.67,303,0,Bug Fix,0,0,0,0,0.0,0.6667,0,0.0,2,2,0,0.8938,0.9457,1.5,31.46,14.54,0,0,0.0,1,25.25,0,6,0,5,0,"Account for encoding in _get_direct_url

Modifies the method to strip out url-encoding of the file name as
well as a better way to gather the path that avoids double
slashes

Closes-Bug: #2129687
[SEP]
FILES CHANGED:
kayobe/utils.py (+3, -1)
releasenotes/notes/fix-working-dir-url-encoding-5f50d66547858e37.yaml (+7, -0)
",1.366337,-1.051035,0.116179,-0.125398,-0.321925,0.345683,0.122589,-0.42369,0.525594,-0.43153,-0.280536,-0.342294,-0.110986,-0.099008,0.347206
openstack/charm-nova-compute,I38ef52a789a2cb523e639b6b4fa61b1deeea586e,1,1,1.0,4.2767,0.0563,5,8.0,323,0,Bug Fix,0,0,0,1,0.142857,1.0,0,1.0,1,3,0,1.0,2.1775,0.8,-15.43,14.45,1,0,0.2958,1,4.4861,0,10,0,15,0,"Support configuring dbus max_replies_per_connection

Hosts running large numbers of vms will need to
set this to a higher value to allow
resume-guests-state-on-host-boot to work.

Closes-Bug: #2118397
[SEP]
FILES CHANGED:
templates/org.libvirt.conf (+9, -0)
hooks/nova_compute_context.py (+8, -0)
hooks/nova_compute_utils.py (+20, -3)
unit_tests/test_nova_compute_utils.py (+20, -1)
config.yaml (+10, -0)
",-0.641834,-0.311051,-0.985716,0.266249,0.037763,-0.140111,-0.838178,-0.650706,0.336265,-0.328314,-0.307391,-0.049934,0.16331,-0.062798,0.506965
openstack/openstack-ansible,I19c95e48eafbecbb8a6bc8bc7b2bf2e7d6b09333,1,1,0.959,2.5649,0.0,2,7.21,836,0,Bug Fix,0,0,0,244,0.052848,1.0,0,0.959,2,2,0,0.9423,1.0,2.0,18.59,11.2,0,0,0.0,1,64.3077,0,12,0,67,0,"Ensure that gluster mount is started after service

At the moment there is a race condition possible on
repo container startup, when glusterd.service is
started later then var-www-repo.mount attempts to.

This leads to a mount failure and requires a manual intervention after
each controller restart.

We use BindsTo together with After to ensure that mount will be started
only when glusterd.service
reaches Active state.

A related fix [1] was proposed a while ago, stating that
glusterd.service is started before network-online.target,
which is not a case, as glusterd also starts after network-online.target

[1] https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/845987

Related-Bug: #2104382
[SEP]
FILES CHANGED:
inventory/group_vars/repo_all.yml (+6, -0)
releasenotes/notes/gluster_mount_wait_service-9d7f6f8850cce6d2.yaml (+6, -0)
",-1.997425,0.165548,1.356976,-0.327237,-0.603467,-0.211229,0.362681,0.027078,0.040582,-0.1934,0.132971,0.071997,-0.213186,0.072729,0.122883
openstack/kolla-ansible,I38853def2efdeaa196628fd4caed8f0b287b344e,0,0,0.4741,3.2958,0.1538,2,14.0,239,0,Bug Fix,0,0,0,424,0.012122,0.1667,0,0.079,4,2,0,0.6217,0.8905,3.0,23.43,15.6,0,0,0.6923,1,8.8519,0,0,0,0,0,"mariadb: Fix wsrep sst setting on upgrade

It seems we merged a nice multiline failure

Adding upgrade jobs to catch similar errors
[SEP]
FILES CHANGED:
zuul.d/scenarios/mariadb.yaml (+18, -0)
ansible/roles/mariadb/tasks/upgrade.yml (+4, -4)
",2.119928,-2.239972,0.405207,-0.95988,-0.684182,-0.202664,0.049143,-0.214769,-0.55114,-0.163987,0.073007,-0.181918,-0.360085,-0.156213,0.075387
openstack/kolla-ansible,Ic2b9c8cbb431435c7622b0ec03e21a2d246f066c,0,0,0.4729,3.0445,0.6,4,4.5,145,0,Feature,0,0,0,425,0.012141,0.5,0,0.2365,4,2,0,0.621,1.9037,3.25,-98.53,28.47,0,0,0.0,1,6.9048,0,0,0,0,0,"neutron: Drop neutron_legacy_iptables
[SEP]
FILES CHANGED:
ansible/group_vars/all/neutron.yml (+0, -3)
ansible/roles/neutron/handlers/main.yml (+4, -4)
ansible/roles/neutron/defaults/main.yml (+0, -5)
releasenotes/notes/drop-legacy-iptables-1979f67a924d4da1.yaml (+4, -0)
",0.417764,1.311097,-0.438146,0.206316,1.607428,-0.101973,-1.520098,0.323689,-0.155317,-0.448155,0.311583,-0.29988,-1.058016,-0.224761,0.172424
openstack/kolla-ansible,I581478f557d489dc9c738077bd197ae4ff40ccbc,0,0,0.4718,6.3026,1.0,1,4.25,179,0,CI,1,0,0,426,0.012163,0.7273,0,0.3431,1,1,0,0.6203,0.0,1.0,13.42,13.46,0,0,1.0,0,0.3278,0,0,0,0,0,"CI: Drop test-core-openstack.sh

We stopped using it - let's delete it.
[SEP]
FILES CHANGED:
tests/test-core-openstack.sh (+0, -545)
",3.080284,0.573048,-0.166784,-0.312075,-1.38199,0.294007,0.435302,-0.76923,-0.980986,-0.218172,0.495314,-0.052658,-0.157239,0.860677,0.116426
openstack/kolla-ansible,I9686da42a5f59fa36811c4500f8c67c0d32b92b5,0,0,0.4707,2.4849,1.0,1,5.5,141,0,CI,1,0,0,427,0.012005,0.2927,0,0.1378,1,1,0,0.6196,0.0,1.0,-29.47,20.38,0,0,1.0,0,11.75,0,0,0,0,0,"CI: Remove Rocky9 Python handling
[SEP]
FILES CHANGED:
tests/run.yml (+0, -11)
",2.96108,1.100594,1.499789,-0.409929,0.12257,1.369461,-1.142775,0.880151,0.008631,0.451306,0.452359,-0.363308,0.476033,-0.250272,0.231343
openstack/openstack-ansible,Id4d39f3c2e0a97a86525ad48da713b5972268550,1,0,0.9592,2.0794,0.1429,2,5.64,533,0,Bug Fix,0,0,0,245,0.052927,1.0,0,0.9592,2,2,0,0.9429,0.8631,1.0,15.54,13.22,0,0,0.0,1,66.625,0,0,0,0,0,"Upgrade setuptools to version 75.8.2

With current version of setuptools `pkg_resources` are not able to
resolve requirements for keystonemiddleware, as they
will fail to find oslo.cache (as it's named as oslo_cache).

This results in pkg_resources.DistributionNotFound exception.

Upgrading setuptools fixes this issue.

This problem is currently a root cause for Magnum to fail loading
Vexxhost CAPI driver.
[SEP]
FILES CHANGED:
global-requirement-pins.txt (+1, -1)
releasenotes/notes/fix_oslo_resolution-6c34d8d94c1f2698.yaml (+5, -0)
",-1.186587,-1.302194,0.42012,0.147427,-0.017355,-0.323828,-0.210512,0.158532,-0.180802,0.111901,0.023505,-0.349278,-0.29533,-0.192034,-0.095744
openstack/kayobe,If77366a0f8bb5f6ac3c9951533a2d75c9b0780a9,1,0,0.6716,2.3026,0.2222,3,3.57,337,0,Feature,0,0,0,67,0.068228,0.6667,0,0.4478,5,3,0,0.8944,1.4355,3.67,-50.59,15.83,0,0,0.0,1,33.7,0,0,0,0,0,"neutron: Remove support for linux bridge mechanism driver

Neutron and kolla already removed it [1][2].

[1] https://review.opendev.org/c/openstack/neutron/+/927216
[2] https://review.opendev.org/c/openstack/kolla-ansible/+/962278
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+1, -1)
releasenotes/notes/remove-linuxbridge-0112ace7c0bff24b.yaml (+5, -0)
ansible/inventory/group_vars/all/kolla (+1, -1)
",-1.037657,4.081589,-1.426046,0.669233,-0.766746,0.256856,0.568361,-0.038983,-0.191859,0.122017,-0.009356,-0.147781,0.019218,-0.125669,-0.188913
openstack/charm-nova-compute,Ib659814fc95f643fc1cc720699e9d1d84a7ae083,1,0,0.8519,2.1972,0.125,2,4.75,192,0,Feature,0,0,0,27,0.022425,0.931,0,0.7931,0,2,0,1.0,0.8113,0.0,19.46,10.32,1,0,0.0,1,21.3333,0,0,0,0,0,"Add charmbuild

Gate on charmbuild zuul job to prevent broken builds get merged.
[SEP]
FILES CHANGED:
osci.yaml (+1, -1)
.zuul.yaml (+6, -0)
",1.983818,-0.550541,0.029037,-0.226558,0.525707,-0.28713,0.120612,0.079784,-0.357536,-0.670823,0.05442,0.077913,-0.347464,0.00965,-0.008737
openstack/kolla,Ib7f551d4a7c6ffe95786853d6899e704de4747b8,0,0,0.4696,4.852,0.4803,14,5.0,131,0,Feature,0,0,0,428,0.012029,1.0,0,0.4696,3,6,0,0.604,3.1389,2.0,-26.66,22.0,1,0,0.4961,1,1.0234,0,0,0,0,0,"Switch to Debian Trixie
[SEP]
FILES CHANGED:
zuul.d/debian.yaml (+21, -21)
doc/source/support_matrix.rst (+1, -1)
docker/valkey/valkey-server/Dockerfile.j2 (+3, -7)
docker/httpd/Dockerfile.j2 (+1, -2)
kolla/template/repos.yaml (+10, -9)
kolla/common/config.py (+4, -5)
kolla/tests/test_methods.py (+4, -4)
docker/openstack-base/Dockerfile.j2 (+1, -1)
kolla/image/unbuildable.py (+0, -2)
docker/base/apt_preferences.debian (+1, -1)
docker/base/debian.sources (+2, -2)
docker/valkey/valkey-sentinel/Dockerfile.j2 (+1, -5)
zuul.d/nodesets.yaml (+12, -1)
releasenotes/notes/debian-trixie-23987480043dc662.yaml (+5, -0)
",2.993201,2.571045,1.59282,0.805657,0.60841,1.109618,0.593517,1.104447,-0.345383,0.143285,0.849175,0.201647,-0.103305,0.000654,0.136435
openstack/kolla-ansible,I78cf7a33bf1025f5c8e4b76ecfeef7d8a3126d61,0,0,0.4685,6.6039,0.9932,44,7.67,211,0,Feature,0,0,0,429,0.012014,1.0,0,0.4685,6,6,0,0.6189,4.2017,3.2,11.46,15.24,1,0,0.2239,1,0.2859,0,0,0,0,0,"Drop venus

It has been marked as inactive and venus dashboard plugin is breaking
Horizon Kolla builds.
[SEP]
FILES CHANGED:
ansible/inventory/multinode (+0, -9)
ansible/roles/venus/tasks/main.yml (+0, -2)
tests/check-logs.sh (+0, -3)
ansible/roles/horizon/defaults/main.yml (+0, -1)
README.rst (+0, -1)
ansible/roles/venus/handlers/main.yml (+0, -28)
ansible/site.yml (+0, -21)
ansible/roles/venus/tasks/check-containers.yml (+0, -3)
ansible/roles/venus/vars/main.yml (+0, -2)
releasenotes/notes/drop-venus-b929071fb79b8026.yaml (+4, -0)
ansible/inventory/all-in-one (+0, -9)
ansible/roles/venus/tasks/register.yml (+0, -7)
ansible/roles/venus/tasks/config_validate.yml (+0, -7)
ansible/roles/venus/tasks/deploy.yml (+0, -14)
ansible/roles/venus/tasks/pull.yml (+0, -3)
ansible/roles/venus/tasks/upgrade.yml (+0, -7)
ansible/roles/venus/tasks/bootstrap.yml (+0, -38)
ansible/roles/venus/tasks/deploy-containers.yml (+0, -2)
ansible/roles/cron/tasks/config.yml (+0, -1)
ansible/roles/prometheus/defaults/main.yml (+0, -4)
ansible/roles/venus/tasks/reconfigure.yml (+0, -2)
etc/kolla/globals.yml (+0, -2)
ansible/roles/venus/tasks/copy-certs.yml (+0, -6)
ansible/roles/venus/templates/venus-manager.json.j2 (+0, -25)
etc/kolla/passwords.yml (+0, -3)
tests/run.yml (+1, -8)
zuul.d/scenarios/venus.yaml (+0, -43)
tests/templates/globals-default.j2 (+0, -6)
ansible/group_vars/all/venus.yml (+0, -10)
ansible/roles/venus/tasks/loadbalancer.yml (+0, -7)
ansible/group_vars/all/horizon.yml (+0, -1)
ansible/roles/cron/templates/cron-logrotate-venus.conf.j2 (+0, -3)
ansible/roles/venus/templates/venus-api.json.j2 (+0, -25)
ansible/roles/venus/defaults/main.yml (+0, -172)
ansible/roles/venus/tasks/clone.yml (+0, -8)
ansible/roles/venus/tasks/config.yml (+0, -65)
ansible/roles/venus/tasks/precheck.yml (+0, -27)
zuul.d/project.yaml (+0, -1)
ansible/roles/venus/tasks/stop.yml (+0, -6)
ansible/roles/fluentd/templates/conf/filter/01-rewrite.conf.j2 (+0, -5)
ansible/roles/venus/tasks/check.yml (+0, -4)
tests/templates/inventory.j2 (+0, -9)
ansible/roles/venus/templates/venus.conf.j2 (+0, -38)
tests/test-venus.sh (+0, -94)
",2.038115,-1.795999,-0.373425,-0.315766,-0.389324,0.337962,-0.079678,0.4131,-0.519952,-0.454211,0.192581,0.597705,-0.420655,0.269231,-0.310667
openstack/kolla,I3a04487a75c04ba989fa70f2025db33308671dfb,1,0,0.4674,4.6821,0.9439,11,5.2,293,0,Feature,0,0,0,430,0.011799,1.0,0,0.4674,3,6,0,0.6027,3.0041,2.36,-26.21,17.46,1,0,0.0,1,2.713,0,0,0,0,0,"Drop Venus images

It has been marked as inactive and venus dashboard plugin is breaking
Horizon Kolla builds.

Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/964860
[SEP]
FILES CHANGED:
kolla/common/users.py (+1, -1)
docker/venus/venus-manager/Dockerfile.j2 (+0, -15)
docker/venus/venus-api/Dockerfile.j2 (+0, -18)
docker/venus/venus-api/extend_start.sh (+0, -8)
kolla/common/sources.py (+0, -8)
README.rst (+0, -1)
docker/horizon/extend_start.sh (+0, -9)
docker/venus/venus-base/Dockerfile.j2 (+0, -29)
docker/venus/venus-base/extend_start.sh (+0, -10)
releasenotes/notes/drop-venus-435234b3bff7f209.yaml (+5, -0)
roles/kolla-build-config/defaults/main.yml (+0, -2)
",-0.163226,1.509221,-1.420835,-0.184277,-1.361389,0.050642,0.057663,0.059263,-0.035296,-0.597866,-0.477965,-0.007626,0.127509,-0.048823,-0.06551
openstack/kolla,Ib1b40a65cb2667b53c72f00d16bfe280bcf24bfe,1,1,0.4687,1.0986,0.5,1,4.33,155,0,Bug Fix,0,0,0,431,0.011792,0.375,0,0.1758,2,1,0,0.6036,0.0,2.0,0.7,23.27,0,0,0.0,0,51.6667,0,8,0,12,0,"horizon: pin pip to <25.3

Closes-Bug: #2129916
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+1, -1)
",2.738892,0.366505,-0.157993,-1.322643,-0.830549,1.035656,-0.458537,0.245854,0.040452,0.338034,0.281872,0.061508,-0.072659,0.165754,0.451658
openstack/kolla,I444304139dfbe451b5449a181de1129f073b7535,0,0,0.4699,0.6931,1.0,1,10.5,194,0,Feature,0,0,0,432,0.011818,0.4444,0,0.2088,2,1,0,0.6044,0.0,2.0,6.83,21.34,0,0,0.0,0,97.0,0,0,0,0,0,"horizon: unpin pip and setuptools

Since Venus is removed - that is not needed anymore
[SEP]
FILES CHANGED:
docker/horizon/Dockerfile.j2 (+0, -1)
",1.655763,-1.21157,0.015832,-0.584276,-0.513313,0.183511,-0.103853,-0.618573,-1.349554,-0.143113,0.348866,0.2259,-0.313492,-0.072021,0.093594
openstack/ironic,I1e90cbb08d5268e54132e4c3dba510d211e11007,1,0,1.0,3.8286,0.0,2,9.75,347,0,CI,0,0,0,8,0.005337,0.0,0,0.0,2,2,0,0.9632,0.4328,2.0,-11.31,18.26,1,0,0.0,1,7.5435,0,0,0,0,0,"Add upgrade check for iLO/iLO5 driver deprecation

Adds an upgrade check that warns operators if they have nodes using
the ilo or ilo5 hardware types or any ilo-specific interfaces
(ilo-pxe, ilo-ipxe, ilo-virtual-media, ilo-uefi-https, etc.).
[SEP]
FILES CHANGED:
releasenotes/notes/ilo-driver-is-retired-2501a03802d1d751.yaml (+4, -0)
ironic/command/status.py (+41, -0)
",-1.473762,0.808512,-1.401054,1.276007,0.966517,-0.804448,-0.266822,0.137004,-0.173664,0.152696,0.056139,0.454227,0.789925,-0.10883,-0.009563
openstack/ironic,I890d551122489e5a0b3162f08dbc10270968fb00,1,0,0.9792,1.0986,0.5,1,16.33,625,0,CI,1,0,0,48,0.013464,0.0,0,0.0,1,1,0,0.9634,0.0,1.0,56.45,11.84,0,0,1.0,1,208.3333,0,0,0,0,0,"CI: make multinode runtime check sane

Its complicated, but basically because we run full size VMs which
take a while to boot, the multinode tests need a bit more than 600
seconds to deploy a node. They can get there in just about that time
and even sometimes beat the time window, but sometimes the job
times out internally and kills the test run.

This changes the time to be 2000 seconds, which is more consistent
across other jobs. Independently, the defaults in the tempest plugin
will need to be made sane.
[SEP]
FILES CHANGED:
zuul.d/ironic-jobs.yaml (+1, -1)
",-0.696582,-2.50915,0.829104,-0.157984,-0.810508,-0.129843,0.823514,-0.732986,-0.593668,0.467514,0.45311,-0.063176,0.138194,0.162419,0.159836
openstack/kolla-ansible,I9b1ee456dbe36f48bf78448c5b12d1a849b61167,0,0,0,0.6931,0.0,1,8.0,189,0,Bug Fix,0,0,0,0,0.0,0.3333,0,0.0,4,1,0,0.6182,0.0,4.0,-49.8,25.7,0,0,0.0,0,94.5,0,0,0,0,0,"service-uwsgi-config: Add static-map configuration

That will fix missing Horizon images
[SEP]
FILES CHANGED:
ansible/roles/service-uwsgi-config/templates/uwsgi.ini.j2 (+1, -0)
",3.12358,-0.350361,0.102251,-0.259077,-0.523561,-0.769015,0.250265,0.35159,0.470161,-0.550291,-0.55749,0.047599,0.063301,0.430513,-0.158097
openstack/kolla-ansible,I5c27614fb46b62e2d9fc3ecc07379b1e899ed89b,0,0,0.4688,1.7918,0.8,1,7.5,158,0,Feature,1,0,0,433,0.011845,0.2,0,0.0938,2,1,0,0.6175,0.0,2.0,-9.46,24.33,0,0,1.0,1,26.3333,0,0,0,0,0,"ovn: Mark as non-voting due to db related failures
[SEP]
FILES CHANGED:
zuul.d/scenarios/ovn.yaml (+1, -4)
",2.049919,0.584693,0.614761,0.666721,0.401322,0.310854,0.249869,-0.75731,0.184614,0.180014,0.162584,0.37246,0.466156,-0.40188,-0.363117
openstack/kolla-ansible,Ie28d0e2a89e3eb9d3123954f3a58496e7348d33e,0,0,0.4677,1.0986,0.5,1,7.0,155,0,CI,1,0,0,434,0.011871,0.25,0,0.1169,2,1,0,0.6169,0.0,2.0,-29.9,22.8,0,0,1.0,1,51.6667,0,0,0,0,0,"CI: Add service-* roles to AIO scenario trigger
[SEP]
FILES CHANGED:
zuul.d/scenarios/aio.yaml (+1, -1)
",2.971967,-0.245594,1.019826,0.370693,0.59606,-0.330637,-0.036704,0.818672,0.262541,0.089251,-0.363979,-0.271781,0.504914,-0.022445,-0.444272
openstack/kolla-ansible,I5b27663e8c539715e6aeb18b179a4f0b98103f7f,0,0,0.4667,3.5264,0.4242,4,10.0,205,0,CI,1,0,0,435,0.011898,0.4038,0,0.1885,3,3,0,0.6162,1.1793,1.75,-2.12,22.0,0,0,1.0,1,6.0294,0,0,0,0,0,"CI: test-dashboard: Use http/https where configured

Also move zuul_return to run only on primary
[SEP]
FILES CHANGED:
roles/kolla-ansible-test-dashboard/tasks/main.yml (+2, -0)
tests/post.yml (+12, -12)
zuul.d/base.yaml (+1, -0)
tests/testinfra/test_horizon.py (+4, -2)
",1.713871,-0.48467,-0.003938,-0.4228,-0.202417,-0.18971,-0.241435,-0.192093,-0.603946,-0.647421,0.185357,-0.392073,-0.051114,-0.110209,-0.109616
openstack/kolla-ansible,I4750ea03c8e7885707150c9d2722ed4ee36fbf46,0,0,0.4656,1.7918,0.2,1,6.67,230,0,Feature,1,1,0,436,0.011915,0.1667,0,0.0776,2,1,0,0.6155,0.0,2.0,-2.97,20.67,0,0,1.0,1,38.3333,0,0,0,0,0,"Revert ""ovn: Mark as non-voting due to db related failures""

This reverts commit 011034a141b385ed4c86fd832425e800484efdb6.
[SEP]
FILES CHANGED:
zuul.d/scenarios/ovn.yaml (+4, -1)
",0.5045,-0.075874,-2.092614,-1.634881,1.046614,0.634134,0.69008,-0.50642,0.652194,-0.029076,-0.204451,0.353709,-0.238617,-0.172034,-0.262326
openstack/kolla-ansible,I7409c3f955faa6281fb19c85bbb4a9aa03f9f219,0,0,0.4645,1.0986,0.5,1,6.0,136,0,Bug Fix,0,0,0,437,0.01194,0.0,0,0.0,3,1,0,0.6148,0.0,3.0,3.34,19.07,0,0,0.0,0,45.3333,0,0,0,0,0,"CI: Fix task name in upgrade
[SEP]
FILES CHANGED:
roles/kolla-ansible-upgrade/tasks/main.yml (+1, -1)
",4.081768,1.799046,2.186864,0.321943,0.339341,0.874483,0.457208,-0.414038,0.121883,0.184568,0.435226,-0.525148,0.399204,0.253196,-0.118237
openstack/openstack-ansible-os_keystone,I57f9423e69e7353f89b5571e7eb540a31c9bce6e,1,0,0.9593,2.1972,0.25,2,6.29,412,0,Bug Fix,0,0,0,246,0.053063,0.9474,0,0.9089,2,2,0,1.0,1.0,1.5,-3.35,13.42,0,0,0.0,1,45.7778,0,0,0,0,0,"Fix URI for Shibboleth on EL

We use Rocky repos, as modern Shibboleth is available
for Rocky 8/9/10 only. It should be compatible with other
EL-based distros as well though.

This is alternative patch to [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible-os_keystone/+/963474
[SEP]
FILES CHANGED:
releasenotes/notes/shibboleth_mirror_el-89e41075a1ee8fbf.yaml (+4, -0)
defaults/main.yml (+2, -2)
",-0.97129,0.63595,-0.452017,-0.047582,-0.929011,-0.422005,0.336409,0.508267,-0.385277,0.24898,-0.080608,-0.215154,0.226661,-0.260393,-0.178571
openstack/kolla-ansible,I755e3dfcd326f7c1c05c1e9275dda93753db5873,0,0,0.6765,2.7726,0.1333,4,9.5,497,0,Feature,0,0,0,68,0.068618,0.375,0,0.2537,4,3,0,0.6141,1.7232,3.0,19.09,15.03,0,0,0.0,1,31.0625,0,0,0,0,0,"Enable Neutron agent wrappers by default

Neutron agent wrappers are now enabled by default. Wrapper containers
restart DHCP, L3, and related agents without having to respawn the main
service containers, which reduces dataplane disruptions during upgrades
and restarts. Operators who need the previous behaviour can set
``neutron_agents_wrappers`` to ``""no""`` in ``/etc/kolla/globals.yml``.
[SEP]
FILES CHANGED:
releasenotes/notes/neutron-agent-wrappers-by-default-c48bc7c00fcca011.yaml (+8, -0)
ansible/roles/neutron/defaults/main.yml (+1, -1)
etc/kolla/globals.yml (+3, -0)
doc/source/reference/networking/neutron.rst (+1, -1)
",-1.426565,0.35411,-0.208594,1.283338,0.737084,-0.215299,0.065257,0.340641,0.010028,-0.02344,0.08433,-0.461131,-0.018377,-0.310885,0.002359
openstack/kolla-ansible,If27163c55375338d9347afff0d2b9c19419fe06a,0,0,0.6667,2.9444,0.5,3,9.4,413,0,CI,1,0,0,69,0.068588,0.2791,0,0.186,2,3,0,0.6134,1.5305,1.67,20.89,12.27,0,0,1.0,1,21.7368,0,0,0,0,0,"CI: ironic - stop using tinyipa

Tinyipa was dropped [1].

Increase the Tenks nodes to 3‚ÄØGiB ram and force `cpu_mode: maximum` so
the CentOS Stream IPA no longer errors with ""Fatal glibc error: CPU does
not support x86-64-v2""

[1] https://review.opendev.org/c/openstack/ironic-python-agent-builder/+/962490
[SEP]
FILES CHANGED:
tests/run.yml (+3, -3)
zuul.d/scenarios/ironic.yaml (+2, -2)
tests/templates/tenks-deploy-config.yml.j2 (+4, -4)
",-0.672878,0.427169,-0.413169,-0.348233,-0.935238,-0.364595,0.425554,0.415457,0.140888,0.096929,0.352967,-0.28633,0.203237,0.134798,-0.213268
openstack/kolla-ansible,I85c8a2b833b8b4e46bb33124deb594fb2a2b9f78,0,0,0.4635,1.6094,0.5,2,6.0,140,0,CI,0,0,0,438,0.011967,0.2308,0,0.107,3,2,0,0.6127,1.0,2.5,-10.75,19.07,0,0,0.5,1,28.0,0,0,0,0,0,"CI: Bump tempest timeout to 3600
[SEP]
FILES CHANGED:
roles/kolla-ansible-tempest/tasks/main.yml (+1, -1)
zuul.d/scenarios/aio.yaml (+1, -1)
",1.598225,0.751861,0.678481,0.216123,1.180041,0.823128,-0.334656,0.100332,0.039229,0.657697,0.510821,-0.112273,-0.012843,0.096714,-0.075823
openstack/kolla-ansible,If71589a666c4a3a8003a3419518fd7e4182c5e2b,1,1,1.0,4.9127,0.1111,2,11.0,480,0,Bug Fix,0,0,0,1,0.1,0.4167,0,0.4167,2,1,0,0.612,0.971,2.0,4.94,17.49,0,0,0.6,0,3.5294,0,6,0,5,0,"Fix podman idempotence on comparing container dimensions

Podman containers are created with default ulimites for RLIMIT_NOFILE
and RLIMIT_NPROC that are breaking idempotence for kolla_container in
check_container mode. We forbid users from setting them, so we should
also ignore them when checking dimensions to make the module idempotent.

Closes-bug: #2131038
[SEP]
FILES CHANGED:
tests/kolla_container_tests/test_podman_worker.py (+74, -7)
ansible/module_utils/kolla_podman_worker.py (+46, -8)
",-0.850076,-1.163928,-0.295571,0.460367,0.488179,0.026533,-0.539523,-0.426053,0.016726,-0.199135,0.057598,-0.477218,0.284963,-0.622687,0.080218
openstack/kolla,Ie76463977d2e9e4358bcd37b62cc8172813cf7b4,0,0,0.4624,1.9459,0.5,3,6.5,148,0,Bug Fix,1,0,0,439,0.011993,0.3333,0,0.1541,1,1,0,0.6031,1.585,1.0,5.01,17.98,0,0,1.0,1,21.1429,0,0,0,0,0,"CI: Fix missing variable in publish jobs
[SEP]
FILES CHANGED:
zuul.d/debian.yaml (+1, -1)
zuul.d/rocky.yaml (+1, -1)
zuul.d/ubuntu.yaml (+1, -1)
",3.154559,0.82485,1.73228,0.294275,0.453624,0.52587,-0.038249,-0.299247,0.424095,0.480731,0.242647,-0.850298,0.862781,0.021273,-0.218784
openstack/kolla-ansible,I173bcb2b1f8c5b81f8395924dfccf73b060100b9,1,1,1.0,5.4681,0.1907,2,13.5,609,0,Bug Fix,0,0,0,2,0.013793,0.4615,0,0.4615,2,1,0,0.6125,0.9647,2.0,31.24,13.8,0,0,0.6102,0,2.5696,0,6,0,5,0,"Fix idempotence on podman volume comparison

Due to podman returning all mount option flags in Binds list,
The compare_volumes function could not be idempotent because some
flags would be skipped everytime, or analyzed when they shouldn't.
This new version fixes it by filtering out all default flags from podman
for both the requested and current volumes, making comparison
accurate. It also takes into account special privileged paths that have
the noexec flag added.

Closes-bug: #2131039
[SEP]
FILES CHANGED:
tests/kolla_container_tests/test_podman_worker.py (+137, -7)
ansible/module_utils/kolla_podman_worker.py (+54, -38)
",-0.277877,-1.635685,0.615436,0.284144,-0.192964,-0.102364,0.518756,-0.305516,0.095459,-0.050032,0.056352,-0.454982,0.349864,-0.293568,0.02036
openstack/kolla,Ifd0b4d511aa5481ff9066c81289457383932079b,0,0,0.4614,1.0986,0.5,1,6.0,140,0,Bug Fix,1,0,0,440,0.012018,0.0,0,0.0,1,1,0,0.6018,0.0,1.0,10.4,15.73,0,0,1.0,1,46.6667,0,0,0,0,0,"CI: Fix publish secret for arm64
[SEP]
FILES CHANGED:
zuul.d/debian.yaml (+1, -1)
",3.199696,1.043602,1.295011,-0.392601,0.476462,0.327662,0.051116,0.355124,-0.002723,0.202428,0.149879,-0.502285,0.602153,-0.232518,-0.139421
openstack/kolla,I395cfdf22cd87a43294dbae561a8872cb0b48e1b,0,0,0.4603,3.1781,0.4783,2,4.0,147,0,Feature,0,0,0,441,0.012045,0.3214,0,0.148,2,2,0,0.6004,0.7554,2.0,-29.87,24.93,0,0,0.0,1,6.125,0,0,0,0,0,"Bump versions of packages in sources.py
[SEP]
FILES CHANGED:
kolla/common/sources.py (+9, -9)
releasenotes/notes/update-packages-071d1863639fe3e3.yaml (+3, -2)
",2.191496,2.074304,0.908179,0.908785,0.849291,-0.152312,0.737714,0.183031,-0.243478,0.218855,-0.156152,-0.410251,-0.452115,0.836967,0.118236
openstack/openstack-ansible-plugins,I1064d099203a2b930d5ef1cae6cd37871ce4b691,1,0,0.9595,0.6931,0.0,1,6.86,460,0,Bug Fix,0,0,0,247,0.053187,1.0,0,0.9595,3,1,0,1.0,0.0,3.0,-8.1,17.74,1,0,0.0,0,230.0,0,0,0,0,0,"Install setuptools for EL10

distutils is deprecated under pep-632, but can be provided via
installing python3-setuptools. distutils is imported by modules
in the glusterfs collection, so we need this to be available.

It was fixed for deb-based systems in [1]

[1] https://review.opendev.org/c/openstack/openstack-ansible-plugins/+/924692
[SEP]
FILES CHANGED:
roles/glusterfs/vars/redhat-10.yml (+1, -0)
",-0.925543,0.333417,-0.286814,-0.111185,-0.844795,-0.702139,0.443319,0.506531,-0.366369,0.321105,0.022158,-0.179979,-0.07213,-0.097116,-0.049127
openstack/kolla-ansible,Ibd7748b99124fa11d14f4075e4e95836e6860451,0,0,0.4593,1.6094,0.5,1,22.0,530,0,Bug Fix,0,0,0,442,0.012065,0.0,0,0.0,4,1,0,0.6129,0.0,4.0,28.12,19.1,0,0,0.0,0,106.0,0,0,0,0,0,"ironic: Fix upgrades

It seems that due to unnoticed publish job failures,
which resulted in no new images in about a month
and after I1b5329d814432604640990b0ecc28906845e29d6
the Ironic upgrades are broken, due to a missing
bootstrap step when using unpinned upgrade (the default).

The failures were only visible when we fixed the publish
jobs, that's why upgrade jobs passed in
I1b5329d814432604640990b0ecc28906845e29d6
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/rolling_upgrade.yml (+2, -2)
",-2.502678,-1.329694,-0.063454,-0.672166,1.103652,0.121076,-0.327876,-0.202901,-0.199917,0.566936,0.163861,-0.03633,0.205653,0.251053,0.400346
openstack/kolla,I846e4f19696ca28758cb9c0400be96c01b079daa,0,0,0.6571,2.5649,0.1667,2,6.25,456,0,Bug Fix,0,0,0,70,0.068359,0.5,0,0.3286,3,1,0,0.5991,1.0,3.0,22.83,12.1,0,0,0.0,0,35.0769,0,0,0,0,0,"debian: use valkey from bookworm-backports

To fix arm64 valkey build.
The virtual `valkey` resolves to `valkey-server` in bookworm-backports,
but our global -1000 pin blocks it. Amd64 worked only because extrepo
shipped it. Use valkey directly from the backports packages instead.

follow up to https://review.opendev.org/c/openstack/kolla/+/932174
[SEP]
FILES CHANGED:
docker/valkey/valkey-server/Dockerfile.j2 (+5, -1)
docker/valkey/valkey-sentinel/Dockerfile.j2 (+5, -1)
",-0.70245,0.891358,-0.266542,-0.088878,-0.568413,-0.492296,0.580248,-0.197941,-0.465044,-0.39109,0.218382,-0.582441,0.255665,0.071312,0.001634
openstack/kolla-ansible,I061cdcf10e22beabe658687b3e67f8071f20df1a,0,1,0,2.8904,0.0,3,5.0,169,0,Bug Fix,0,0,0,0,0.0,0.5,0,0.0,4,3,0,0.6122,1.221,3.33,-18.2,18.0,1,0,0.0,1,9.3889,0,18,0,2,0,"Add DNS server config for Ironic DHCP

Closes-Bug: #2061131
[SEP]
FILES CHANGED:
ansible/roles/ironic/templates/ironic-dnsmasq.conf.j2 (+1, -0)
releasenotes/notes/dns-config-via-ironic-dhcp-6727d8c93acf654c.yaml (+6, -0)
doc/source/reference/bare-metal/ironic-guide.rst (+10, -0)
",2.682531,-0.058299,0.160423,-1.016802,-0.75443,1.040492,-0.660064,1.06238,0.373337,-0.10797,0.198479,-0.240397,0.410011,-0.187696,0.24685
openstack/ansible-collection-kolla,Ie50bb941720528d7d909ff1fa516200b9a31457c,0,0,0.4582,3.1355,0.6364,1,5.5,150,0,Feature,0,0,0,443,0.012091,0.0,0,0.0,3,1,0,0.375,0.0,3.0,-52.55,27.65,0,0,0.0,0,6.5217,0,0,0,0,0,"baremetal: Stop running with ignore_errors
[SEP]
FILES CHANGED:
roles/baremetal/tasks/install.yml (+8, -14)
",2.261284,0.273918,0.462258,0.17609,0.56718,0.332952,-0.959649,-0.448228,-0.250074,0.201913,0.155503,-0.441938,-0.13859,-0.201957,-0.138364
openstack/kolla-ansible,I62f40d48a7f2d58b3a3b9ac6d5827a721e02c545,0,1,0.5,3.0445,0.6,2,12.0,541,0,Bug Fix,0,0,0,16,0.03397,0.5,0,0.25,4,2,0,0.6115,0.971,3.0,-16.84,26.13,0,0,0.0,1,25.7619,0,6,0,4,0,"haproxy: skip redundant backend configuration for memcached

Previously, Kolla-Ansible generated unnecessary HAProxy backend
configuration entries for the memcached service. These backend entries
were redundant since memcached is not accessed through HAProxy by any
OpenStack service. This patch removes the redundant configuration,
keeping the HAProxy configuration minimal and consistent with actual
service usage.

Closes-Bug: #2130641
[SEP]
FILES CHANGED:
releasenotes/notes/bug-2130641-fc70f69f2d09140f.yaml (+8, -0)
ansible/roles/memcached/defaults/main.yml (+0, -12)
",-0.392027,-1.12733,-0.275057,0.656857,0.052443,0.148355,0.00596,0.56065,0.245682,-0.381105,0.166876,0.200864,0.258514,-0.367822,0.309621
openstack/kayobe,I39eec23d9ca3f8fe9b8d7e9693082ef5841dcffa,1,1,0.0,2.6391,0.2308,4,5.67,186,0,Bug Fix,0,0,0,1,0.055556,0.0,0,0.0,2,2,0,0.8951,1.922,1.25,-22.86,16.38,1,0,0.0,1,13.2857,0,6,0,5,0,"Always call virtualenv as a Python module during setup

Closes-Bug: #2130643
[SEP]
FILES CHANGED:
ansible/baremetal-compute-rename.yml (+2, -1)
ansible/baremetal-compute-introspection-data-save.yml (+1, -1)
ansible/baremetal-compute-serial-console.yml (+2, -1)
releasenotes/notes/fix-baremetal-serial-venv-946b4b7dd191662b.yaml (+5, -0)
",2.671517,-0.309485,0.598704,-0.81658,-0.507439,0.723595,-0.059238,0.281384,0.254054,-0.202887,0.363123,0.040361,-0.115256,-0.079273,0.421972
openstack/ansible-collection-kolla,If3c891babcbc5cb7a9be6c9787326fa5b78d96e0,1,0,0.8349,2.3979,0.4,1,7.0,147,0,CI,1,0,0,109,0.072185,0.4727,0,0.3947,1,1,0,0.3659,0.0,1.0,12.4,14.23,0,0,1.0,1,13.3636,0,0,0,0,0,"CI: Update Kayobe jobs for Rocky Linux 10
[SEP]
FILES CHANGED:
zuul.d/project.yaml (+6, -4)
",2.469529,0.728848,1.117482,-0.41216,0.475267,0.629362,-0.308823,1.336904,-0.358599,0.196443,0.258561,-0.040942,0.321146,-0.187348,-0.462777
openstack/ironic,I1d13fb227e6c3ba713dac58c6e02a199f589209f,1,1,0.6667,2.9957,0.2105,3,6.75,234,0,Bug Fix,0,0,0,3,0.006098,1.0,0,0.6667,5,2,0,0.9636,1.5683,3.33,21.38,13.07,1,0,0.3684,1,11.7,0,6,0,8,0,"Fix storing inventory and plugin data in Swift

The data has not been stored as JSON which caused issues.

Closes-bug: #2130790
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/test_inspect_utils.py (+5, -2)
ironic/drivers/modules/inspect_utils.py (+3, -2)
releasenotes/notes/fix-swift-for-inventory-c371da65dd20fc74.yaml (+7, -0)
",1.57778,-1.582356,-0.151285,-0.57688,-0.734626,0.530614,-0.369481,0.176362,-0.193893,-0.134009,-0.133691,-0.043608,0.095177,-0.082514,0.131224
openstack/kolla-ansible,Iaff207e741c5acd56c8c3f29b19666b2599fb7c0,0,0,0.4572,1.9459,0.0,1,5.5,133,0,CI,1,0,0,444,0.012111,0.4545,0,0.2078,1,1,0,0.6109,0.0,1.0,-6.4,20.38,0,0,1.0,0,19.0,0,0,0,0,0,"CI: Use main Rocky mirror
[SEP]
FILES CHANGED:
tests/pre.yml (+6, -0)
",3.63776,1.455604,1.814871,-0.016708,0.037128,1.12183,-0.192344,0.659117,0.215556,0.161738,0.531842,-0.321352,0.55156,0.309987,-0.434568
openstack/ironic,I04dfa09ada7e6a9d22ba16051cb5737daf3bc668,1,0,1.0,2.7726,0.2,3,20.0,442,0,Bug Fix,0,0,0,1,0.016129,0.0,0,0.0,7,2,0,0.9639,1.5219,4.67,37.08,16.0,0,0,0.2,1,27.625,0,0,0,0,0,"fix: local_link_connection inspection hook does not fail on missing port

The code intended to not fail when a Port object was missing but to
instead skip the handling of that node but instead there is an unhandled
exception because the get_by_address() method throws PortNotFound
instead of returning None when a port couldn't be found.
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/inspector/hooks/test_local_link_connection.py (+2, -1)
releasenotes/notes/inspect-hook-local-link-connection-crash-394edb1c35354968.yaml (+6, -0)
ironic/drivers/modules/inspector/hooks/local_link_connection.py (+4, -2)
",-0.259713,-1.905514,-0.052207,0.464804,-0.216042,-0.000667,0.078127,-0.868254,0.324195,0.133218,0.103958,-0.477004,-0.16743,-0.307682,0.094514
openstack/kolla-ansible,Ic4dfba427e6874556bb70c8b808d5f7069dc0f53,0,0,0.4562,2.1972,0.0,1,5.5,142,0,CI,1,0,0,445,0.012136,0.0,0,0.0,3,1,0,0.6102,0.0,3.0,-29.47,27.65,0,0,1.0,0,15.7778,0,0,0,0,0,"CI: Retry Selenium container pulls
[SEP]
FILES CHANGED:
roles/kolla-ansible-test-dashboard/tasks/main.yml (+8, -0)
",3.980502,1.084884,1.386475,0.131925,0.28859,0.680219,-0.132835,0.654576,-0.266506,-0.284175,0.503016,-0.142089,0.7651,-0.012098,-0.246438
openstack/kolla,I10f47d3454fd81a36aa7a724050869ef680e88b4,0,0,0.6479,4.3041,0.3562,11,6.5,149,0,Feature,0,0,0,71,0.068533,1.0,0,0.6479,2,1,0,0.5978,2.9486,2.0,-21.02,17.98,0,0,0.0,1,2.0135,0,0,0,0,0,"Tidy up release notes for Flamingo release
[SEP]
FILES CHANGED:
releasenotes/notes/opensearch-upgrade-9e263a65f015a376.yaml (+1, -1)
releasenotes/notes/deprecate-collectd-8ba94052bdc9424b.yaml (+0, -4)
releasenotes/notes/remove-prometheus-ovn-exporter-c5f5005b4d1a4b12.yaml (+3, -3)
releasenotes/notes/fluentd-update-8db10e760b2dc4d5.yaml (+1, -1)
releasenotes/notes/mariadb-11.4-b66b5baf9f5e6cd0.yaml (+3, -3)
releasenotes/notes/rocky-10-4111fa0160be14ab.yaml (+6, -6)
releasenotes/notes/drop-venus-435234b3bff7f209.yaml (+2, -2)
releasenotes/notes/update-packages-071d1863639fe3e3.yaml (+5, -4)
releasenotes/notes/deprecate-telegraf-db2b0b9f30591552.yaml (+1, -1)
releasenotes/notes/rabbitmq-41-d881d0b6bbf46446.yaml (+1, -1)
releasenotes/notes/flamingo-prelude-b72f2599ed9d25d5.yaml (+24, -0)
",3.141265,1.313537,1.884941,0.515011,0.686343,0.602789,0.911496,0.479068,-0.120577,-0.649753,0.150281,0.096227,-0.026203,-0.113565,0.303886
openstack/charm-keystone,I54e628884683b5804d55fb06ac8e89ce269c92e5,1,1,1.0,3.6636,0.0,5,6.33,356,0,Bug Fix,0,0,0,2,0.005495,0.0,0,0.0,2,1,0,1.0,2.2126,2.0,-6.64,13.06,1,0,0.0,1,9.1282,0,58,0,102,0,"Add cadf audit middleware logging

Enables audit logging for keystone in cadf format. This feature
is enabled with the 'enable-notifications' config option and the
audit results are written to /var/log/keystone/keystone.log.

Closes-bug: 1856555
[SEP]
FILES CHANGED:
templates/queens/keystone.conf (+6, -0)
templates/ocata/logging.conf (+14, -0)
templates/rocky/keystone.conf (+6, -0)
templates/caracal/keystone.conf (+6, -0)
templates/epoxy/keystone.conf (+6, -0)
",-0.399619,0.082235,-1.163136,0.785548,-0.077404,-0.522597,-0.027576,0.364251,0.422429,-0.290371,-0.105543,-0.148653,0.180909,-0.035726,-0.171238
openstack/kolla-ansible,Ic7a042aa8a15ee7469a77749054596669a0593f4,0,0,0.6389,4.8903,0.4242,12,6.5,149,0,Feature,0,0,0,72,0.064923,1.0,0,0.6389,2,1,0,0.6095,3.2633,2.0,-27.53,17.98,0,0,0.0,1,1.1203,0,0,0,0,0,"Tidy up release notes for Flamingo release
[SEP]
FILES CHANGED:
releasenotes/notes/cron-break-out-role-fa72289cc100ef53.yaml (+2, -2)
releasenotes/notes/drop-ironic-inspector-38fc91c64517ffc1.yaml (+7, -8)
releasenotes/notes/drop-vmware-support-6303715d3fb80946.yaml (+3, -3)
releasenotes/notes/fluentd-break-out-role-1e5306dac1c41583.yaml (+2, -2)
releasenotes/notes/custom_modOIDC_error_page-0fe3dd7414310536.yaml (+8, -12)
releasenotes/notes/bug-2112339-3f67eefc7f0062cc.yaml (+5, -6)
releasenotes/notes/nova-metadata-split-d1c9ff2010390352.yaml (+2, -2)
releasenotes/notes/bug-2111916-6b2ca611df41dceb.yaml (+2, -2)
releasenotes/notes/bug-2097452-6b635e49606ebe26.yaml (+3, -3)
releasenotes/notes/flamingo-prelude-57a2c0e9d578fd57.yaml (+29, -0)
releasenotes/notes/drop-clustercheck-and-haproxy-support-for-mariadb-4cbd7c8590a34981.yaml (+6, -7)
releasenotes/notes/neutron-uwsgi-5ac29b1403c02554.yaml (+7, -9)
",3.141265,1.313537,1.884941,0.515011,0.686343,0.602789,0.911496,0.479068,-0.120577,-0.649753,0.150281,0.096227,-0.026203,-0.113565,0.303886
openstack/kayobe,Ie5ea55953eb1c0cc04a2d387bf99bd542da396eb,1,1,0.5,3.3673,0.0714,6,3.4,260,0,Bug Fix,0,0,0,2,0.064516,1.0,0,0.5,5,4,0,0.8957,2.3323,3.17,-105.16,24.89,1,0,0.0,1,8.9655,1,6,0,3,0,"Add configuration for Ironic introspection DNS servers

Closes-Bug: #2130947
Depends-On: https://review.opendev.org/c/openstack/kolla-ansible/+/966023
[SEP]
FILES CHANGED:
ansible/roles/kolla-ansible/templates/kolla/globals.yml (+3, -0)
releasenotes/notes/dns-config-ironic-dhcp-967a99a01005a6bc.yaml (+5, -0)
ansible/kolla-ansible.yml (+1, -0)
kayobe/plugins/filter/networks.py (+7, -0)
ansible/roles/kolla-ansible/defaults/main.yml (+3, -0)
doc/source/configuration/reference/network.rst (+7, -2)
",0.062039,2.399344,-1.619627,-0.405575,-1.313887,0.278627,-0.176929,0.31686,0.286925,-0.65085,-0.514392,-0.03558,0.250171,-0.473151,0.203248
openstack/openstack-ansible-openstack_hosts,Iee2293615109c4d66aaffe206d4f721784a87ef7,1,0,0.9597,2.3026,0.2222,1,5.2,243,0,Feature,0,0,0,248,0.053391,1.0,0,0.9597,1,1,0,0.8667,0.0,1.0,-0.18,14.39,0,0,0.0,0,24.3,0,0,0,0,0,"Install master RDO deps

We need to install liberasurecode for swift EC capabilities.
It is present in RDO deps libraries.
[SEP]
FILES CHANGED:
vars/redhat-10.yml (+7, -2)
",1.427346,-1.051797,-0.268414,0.363864,-0.203583,-0.012247,0.015473,0.662425,-0.663973,-0.357306,-0.211425,0.014909,-0.208512,-0.09437,-0.408035
openstack/ironic,Ic2efaa0d53b6923908112c937957a60aa4f1ad9d,1,1,1.0,4.2047,0.0,3,9.33,275,0,Bug Fix,0,0,0,9,0.005829,1.0,0,1.0,6,2,0,0.9641,0.6312,4.0,7.01,16.59,1,0,0.8788,1,4.1045,0,6,0,6,0,"Filter null NIC firmware versions from cache

Treat absent firmware package version as non-cacheable to avoid NOT NULL
database constraint violation.

Closes-Bug: #2130990
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/redfish/test_firmware.py (+58, -0)
releasenotes/notes/filter-null-nic-firmware-versions-in-cache-82a68b4df96591f7.yaml (+6, -0)
ironic/drivers/modules/redfish/firmware.py (+2, -0)
",0.792728,-1.674963,-0.336867,-0.319185,-0.056177,0.081905,-1.018249,0.397003,0.608236,-0.079983,-0.434183,0.250959,0.395232,-0.120509,-0.071883
openstack/ansible-collection-kolla,I504fcbd95de9edd8d52655a0bdce55f592e7df89,1,0,0.1875,2.0794,0.0,2,6.12,511,0,Doc,0,0,0,32,0.205128,0.1429,1,0.0268,2,1,0,0.381,0.5917,2.0,-25.56,11.43,1,0,0.0,0,63.875,0,0,0,0,0,"Update master for stable/2025.2

Add file to the reno documentation build to show release notes for
stable/2025.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.2.

Sem-Ver: feature
Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/add_release_note_page.sh
[SEP]
FILES CHANGED:
releasenotes/source/2025.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-1.451839,0.63559,0.000721,0.072663,-0.10857,-0.78895,-0.194732,0.669507,0.249651,0.333582,-0.406554,-0.154836,0.08225,0.918754,0.294227
openstack/kolla-ansible,Ib7a148a4eed0bcea52e405bf417ed089461dc8fd,1,0,0.2121,2.0794,0.0,2,6.12,511,0,Doc,0,0,0,33,0.202454,1.0,1,0.2121,2,1,0,0.6088,0.5917,2.0,-27.28,11.43,1,0,0.0,0,63.875,0,0,0,0,0,"Update master for stable/2025.2

Add file to the reno documentation build to show release notes for
stable/2025.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.2.

Sem-Ver: feature
Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/add_release_note_page.sh
[SEP]
FILES CHANGED:
releasenotes/source/2025.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-1.451839,0.63559,0.000721,0.072663,-0.10857,-0.78895,-0.194732,0.669507,0.249651,0.333582,-0.406554,-0.154836,0.08225,0.918754,0.294227
openstack/kolla,If6d5a967a12cb6143a5bb1f321d8cc0231552275,1,0,0.2353,2.0794,0.0,2,6.12,511,0,Doc,0,0,0,34,0.2,1.0,1,0.2353,2,1,0,0.5965,0.5917,2.0,-22.1,11.43,1,0,0.0,0,63.875,0,0,0,0,0,"Update master for stable/2025.2

Add file to the reno documentation build to show release notes for
stable/2025.2.

Use pbr instruction to increment the minor version number
automatically so that master versions are higher than the versions on
stable/2025.2.

Sem-Ver: feature
Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/add_release_note_page.sh
[SEP]
FILES CHANGED:
releasenotes/source/2025.2.rst (+6, -0)
releasenotes/source/index.rst (+1, -0)
",-1.451839,0.63559,0.000721,0.072663,-0.10857,-0.78895,-0.194732,0.669507,0.249651,0.333582,-0.406554,-0.154836,0.08225,0.918754,0.294227
openstack/kolla-ansible,I77cce57f3f2b05455e8bd4e7093081ef4ed25d59,0,0,0.4552,5.9558,0.5299,29,5.0,152,0,Feature,0,0,0,446,0.012161,1.0,0,0.4552,4,2,0,0.6093,4.4689,3.76,-94.34,30.0,1,0,0.0,0,0.3938,0,0,0,0,0,"ansible-lint: Remove key-order[task] exclude
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+9, -11)
ansible/roles/nova-cell/tasks/rabbitmq.yml (+4, -5)
ansible/roles/bifrost/tasks/stop.yml (+6, -8)
ansible/roles/valkey/tasks/upgrade.yml (+1, -2)
ansible/roles/nova/tasks/map_cell0.yml (+3, -3)
ansible/site.yml (+4, -4)
ansible/roles/service-image-info/tasks/main.yml (+6, -6)
ansible/roles/nova-cell/tasks/version-check.yml (+6, -7)
ansible/roles/nova-cell/tasks/libvirt-cleanup.yml (+5, -5)
ansible/roles/ovn-db/tasks/bootstrap-initial.yml (+1, -3)
ansible/roles/prechecks/tasks/timesync_checks.yml (+2, -2)
ansible/roles/prometheus/tasks/config.yml (+5, -5)
ansible/roles/nova-cell/tasks/external_ceph.yml (+19, -19)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+6, -7)
ansible/roles/rabbitmq/tasks/remove-ha-all-policy.yml (+8, -9)
ansible/roles/loadbalancer/tasks/precheck.yml (+12, -12)
ansible/roles/ovn-db/tasks/lookup_cluster.yml (+4, -8)
ansible/roles/destroy/tasks/cleanup_host.yml (+6, -6)
ansible/roles/nova-cell/tasks/discover_computes.yml (+5, -6)
ansible/roles/octavia-certificates/tasks/main.yml (+2, -3)
ansible/roles/octavia/tasks/config.yml (+8, -10)
ansible/roles/mariadb/tasks/recover_cluster.yml (+3, -3)
ansible/roles/prechecks/tasks/datetime_checks.yml (+2, -2)
.ansible-lint (+0, -1)
ansible/roles/container-engine-migration/tasks/migrate-volumes.yml (+2, -2)
ansible/roles/nova-cell/tasks/wait_discover_computes.yml (+17, -17)
ansible/roles/certificates/tasks/generate.yml (+23, -24)
ansible/roles/service-rabbitmq/tasks/main.yml (+7, -8)
ansible/roles/rabbitmq/tasks/precheck.yml (+5, -6)
",2.837862,0.983981,0.864801,-0.291747,-0.052812,-1.546113,-1.082824,-0.22222,0.76337,0.681233,-0.313601,0.058922,-0.014967,0.04702,-0.8719
openstack/kolla-ansible,I58d00089e01953a1b8e2d2ba20c5a7e300ca30b9,0,0,0.4541,2.9957,0.4211,3,5.5,155,0,Feature,0,0,0,447,0.012061,1.0,0,0.4541,4,2,0,0.6086,0.9133,2.67,-91.0,31.29,1,0,0.0,0,7.75,0,0,0,0,0,"ansible-lint: Remove no-free-form from excludes
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/precheck.yml (+2, -1)
ansible/roles/prechecks/tasks/port_checks.yml (+9, -6)
.ansible-lint (+0, -1)
",2.679014,1.687611,0.549523,0.104598,-0.080373,-1.332159,-0.81535,-0.658353,0.585234,0.398465,-0.237023,0.411155,0.391683,0.20211,-0.39731
openstack/kolla-ansible,I87a5b312de28c37c21cd73920a681b7e9e603b30,0,0,0.4531,0.6931,1.0,1,5.5,156,0,Feature,0,0,0,448,0.012082,0.0,0,0.0,0,1,0,0.6079,0.0,0.0,-91.0,31.29,1,0,0.0,0,78.0,0,0,0,0,0,"ansible-lint: Remove ignore-errors from excludes
[SEP]
FILES CHANGED:
.ansible-lint (+0, -1)
",2.813242,1.361863,0.592703,0.020306,-0.225029,-1.62503,-0.668033,-0.630339,0.704246,0.623036,-0.195108,0.096408,0.425737,-0.02944,-0.463426
openstack/kolla-ansible,Icae3b3b6935ad6837831e43dc5ce847fcc1c374c,0,0,0.4521,2.3979,0.5,3,6.0,151,0,Bug Fix,0,0,0,449,0.012109,0.0,0,0.0,4,1,0,0.6073,1.5219,4.0,-31.9,25.73,1,0,0.0,0,13.7273,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in aodh role
[SEP]
FILES CHANGED:
ansible/roles/aodh/tasks/config.yml (+1, -1)
ansible/roles/aodh/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/aodh/tasks/bootstrap.yml (+2, -2)
",2.352497,0.576713,0.579263,-0.650338,0.144975,-1.584758,-0.560832,-0.564202,0.192504,0.73077,0.245979,0.013618,-0.528359,-0.393689,-0.491615
openstack/kolla-ansible,Ifc27430369166f13bbbdb005b04194c6c6f8ec98,0,0,0.4511,2.5649,0.5,3,6.0,155,0,Bug Fix,0,0,0,450,0.012132,0.0,0,0.0,4,1,0,0.6066,1.585,4.0,-24.85,25.73,1,0,0.0,0,11.9231,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in barbican role
[SEP]
FILES CHANGED:
ansible/roles/barbican/tasks/bootstrap.yml (+2, -2)
ansible/roles/barbican/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/barbican/tasks/config.yml (+2, -2)
",2.259628,0.659262,0.581782,-0.705031,0.086343,-1.642418,-0.597076,-0.438845,0.207494,0.796316,0.470183,-0.073473,-0.33532,-0.304678,-0.75138
openstack/kolla-ansible,Ifa650dbd3368b4b6e3f7ff8ba220c2ae7c6dae88,0,0,0.4501,1.0986,0.5,1,6.0,154,0,Bug Fix,0,0,0,451,0.012155,0.0,0,0.0,4,1,0,0.6059,0.0,4.0,-46.0,25.73,1,0,0.0,0,51.3333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in bifrost role
[SEP]
FILES CHANGED:
ansible/roles/bifrost/tasks/start.yml (+1, -1)
",2.110944,0.794076,0.470842,-0.628215,0.257093,-1.575144,-0.543078,-0.57057,0.145942,0.624511,0.467907,-0.01524,-0.336136,-0.34295,-0.61304
openstack/kolla-ansible,Idb396265e6090d6f106375a28b93b72faff7d585,0,0,0.4491,2.5649,0.5,3,6.0,153,0,Bug Fix,0,0,0,452,0.012182,0.0,0,0.0,4,1,0,0.6053,1.4591,4.0,-31.9,25.73,1,0,0.0,0,11.7692,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in blazar role
[SEP]
FILES CHANGED:
ansible/roles/blazar/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/blazar/tasks/bootstrap.yml (+3, -3)
ansible/roles/blazar/tasks/config.yml (+1, -1)
",2.138058,0.701479,0.469752,-0.567458,0.258454,-1.726391,-0.730203,-0.46596,0.12647,0.792313,0.35196,0.060891,-0.414451,-0.381503,-0.691758
openstack/kolla-ansible,I719be4c046c0bb5153a616621259909bce6964c3,0,0,0.4481,3.3673,0.5,4,6.0,157,0,Bug Fix,0,0,0,453,0.012205,0.5714,0,0.2561,4,1,0,0.6046,1.6894,4.0,-46.0,29.07,1,0,0.0,0,5.4138,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in ceilometer role
[SEP]
FILES CHANGED:
ansible/roles/ceilometer/defaults/main.yml (+4, -4)
ansible/roles/ceilometer/tasks/config.yml (+7, -7)
ansible/roles/ceilometer/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/ceilometer/tasks/precheck.yml (+1, -1)
",2.305046,0.509141,0.684097,-0.638023,0.318806,-1.536584,-0.641101,-0.420578,0.292906,0.813982,0.266441,-0.024155,-0.422244,-0.397546,-0.600908
openstack/kolla-ansible,I360c570ba9dc1a7c8324dc53145e3da8c818c738,0,0,0.4471,1.0986,0.5,1,6.0,159,0,Bug Fix,0,0,0,454,0.012222,0.2,0,0.0894,4,1,0,0.6039,0.0,4.0,-60.11,29.07,1,0,0.0,0,53.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in certificates role
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/generate.yml (+1, -1)
",2.469812,0.806939,0.733902,-0.522305,0.18721,-1.705345,-0.747757,-0.473388,0.351238,0.903857,0.217145,-0.267798,-0.273646,-0.255827,-0.759308
openstack/kolla-ansible,Id3e2e72698ad5c1ee547789524de816f879d142e,0,0,0.4462,3.4657,0.5161,8,6.0,153,0,Bug Fix,0,0,0,455,0.012249,0.3667,0,0.1636,4,2,0,0.6033,2.9181,4.0,-46.0,25.73,1,0,0.0,0,4.7812,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in cinder role
[SEP]
FILES CHANGED:
ansible/roles/cinder/defaults/main.yml (+3, -3)
ansible/roles/cinder/tasks/bootstrap.yml (+2, -2)
ansible/roles/cinder/tasks/upgrade.yml (+2, -2)
ansible/roles/cinder/tasks/precheck.yml (+2, -2)
ansible/roles/cinder/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/cinder/tasks/external_ceph.yml (+1, -1)
ansible/roles/cinder/templates/cinder.conf.j2 (+1, -1)
ansible/roles/cinder/tasks/config.yml (+2, -3)
",2.51348,0.699978,0.736752,-0.661756,0.095096,-1.80436,-0.700117,-0.388364,0.192952,0.785616,0.23744,-0.194042,-0.380428,-0.341799,-0.71388
openstack/kolla-ansible,I215731b5cccf8354e69e6552472a9781f29a78d9,0,0,0.4452,3.2958,0.5,4,6.0,157,0,Bug Fix,0,0,0,456,0.012265,0.3333,0,0.1484,4,1,0,0.6026,1.5466,4.0,-46.0,29.07,1,0,0.0,0,5.8148,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in cloudkitty role
[SEP]
FILES CHANGED:
ansible/roles/cloudkitty/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/cloudkitty/tasks/bootstrap.yml (+8, -8)
ansible/roles/cloudkitty/defaults/main.yml (+2, -2)
ansible/roles/cloudkitty/tasks/config.yml (+1, -1)
",2.257896,0.507208,0.556001,-0.802054,0.02528,-1.858764,-0.528818,-0.332237,0.016325,0.582278,0.348306,-0.149241,-0.323376,-0.361843,-0.519851
openstack/kolla-ansible,Iffbe3a34365dcc77456d90400d69206714c31471,0,0,0.4442,1.0986,0.5,1,6.0,155,0,Bug Fix,0,0,0,457,0.012284,0.5,0,0.2221,4,1,0,0.602,0.0,4.0,-24.85,25.73,1,0,0.0,0,51.6667,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in collectd role
[SEP]
FILES CHANGED:
ansible/roles/collectd/defaults/main.yml (+1, -1)
",2.546481,0.779773,0.648499,-0.676714,0.059892,-1.793951,-0.53741,-0.479418,0.14852,0.657365,0.296106,-0.170237,-0.351461,-0.28057,-0.657205
openstack/kolla-ansible,Idbb9c4ba57429ad391ce0b8e67ab00feb0a90a78,0,0,0.4432,1.0986,0.5,1,6.0,151,0,Bug Fix,0,0,0,458,0.01231,0.0,0,0.0,4,1,0,0.6013,0.0,4.0,-60.11,25.73,1,0,0.0,0,50.3333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in cron role
[SEP]
FILES CHANGED:
ansible/roles/cron/defaults/main.yml (+1, -1)
",2.448754,0.549827,0.722934,-0.654012,0.207436,-1.771627,-0.511892,-0.456033,0.157133,0.612505,0.405893,-0.188358,-0.413287,-0.124142,-0.639105
openstack/kolla-ansible,I2ef947abd611a0a9f1f6c4b3cb345abb106f4d7e,0,0,0.4423,2.3979,0.5,3,6.0,153,0,Bug Fix,0,0,0,459,0.012336,1.0,0,0.4423,4,1,0,0.6007,1.5219,4.0,-46.0,25.73,1,0,0.0,0,13.9091,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in cyborg role
[SEP]
FILES CHANGED:
ansible/roles/cyborg/tasks/config.yml (+1, -1)
ansible/roles/cyborg/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/cyborg/tasks/bootstrap.yml (+2, -2)
",2.218536,0.784998,0.680784,-0.565268,0.184525,-1.555476,-0.594166,-0.408187,0.252163,0.760335,0.323398,-0.038372,-0.379961,-0.256048,-0.679218
openstack/kolla-ansible,I056a0803f90bba78e779bdbbe4e6791e637a8974,0,0,0.4413,2.5649,0.5,4,6.0,156,0,Bug Fix,0,0,0,460,0.01236,0.0,0,0.0,4,1,0,0.6,1.9183,4.0,-67.15,29.07,1,0,0.0,0,12.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in designate role
[SEP]
FILES CHANGED:
ansible/roles/designate/tasks/bootstrap.yml (+2, -2)
ansible/roles/designate/tasks/config.yml (+1, -1)
ansible/roles/designate/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/designate/tasks/update_pools.yml (+1, -1)
",2.377044,0.938134,0.640898,-0.43123,0.255866,-1.611618,-0.708982,-0.518069,0.371889,0.843247,0.232147,-0.144896,-0.327563,-0.229003,-0.823331
openstack/kolla-ansible,I3d914a24e047a337cea82d7ebdf544e780363b98,0,0,0.4403,1.0986,0.5,1,6.0,154,0,Bug Fix,0,0,0,461,0.012382,0.4,0,0.1761,4,1,0,0.5993,0.0,4.0,-53.05,25.73,1,0,0.0,0,51.3333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in destroy role
[SEP]
FILES CHANGED:
ansible/roles/destroy/tasks/cleanup_host.yml (+1, -1)
",2.506972,0.76853,0.746758,-0.553998,0.091254,-1.626953,-0.686336,-0.592431,0.23429,0.815539,0.288695,-0.158998,-0.292448,-0.192784,-0.699212
openstack/kolla-ansible,Ia31d049e4290bee04764b91dfbec2159de4461bf,0,0,0.4394,2.1972,0.5,1,6.0,154,0,Bug Fix,0,0,0,462,0.012409,0.6667,0,0.2929,4,1,0,0.5987,0.0,4.0,-31.9,25.73,1,0,0.0,0,17.1111,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in fluentd role
[SEP]
FILES CHANGED:
ansible/roles/fluentd/tasks/config.yml (+4, -4)
",2.411601,0.8395,0.598108,-0.635764,0.155938,-1.756053,-0.524629,-0.380167,0.159606,0.698979,0.274233,-0.018618,-0.348443,-0.344365,-0.638186
openstack/kolla-ansible,I241b6b9f84db7b174cd521b5b5ebb7c37b182f0a,0,0,0.4384,3.6109,0.5,5,6.0,153,0,Bug Fix,0,0,0,463,0.012433,0.3333,0,0.1461,4,1,0,0.598,1.7689,4.0,-17.81,25.73,1,0,0.0,0,4.1351,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in glance role
[SEP]
FILES CHANGED:
ansible/roles/glance/tasks/bootstrap_service.yml (+4, -4)
ansible/roles/glance/tasks/config.yml (+1, -1)
ansible/roles/glance/tasks/external_ceph.yml (+1, -1)
ansible/roles/glance/tasks/rolling_upgrade.yml (+10, -10)
ansible/roles/glance/tasks/bootstrap.yml (+2, -2)
",2.484132,0.844447,0.61813,-0.60082,0.060199,-1.745527,-0.605114,-0.473299,0.295052,0.751716,0.246264,-0.128208,-0.273915,-0.236401,-0.681557
openstack/kolla-ansible,I75f53151e06dc1af7f1fb109c50ce046bdfd7ec5,0,0,0.4375,2.5649,0.5,4,6.0,154,0,Bug Fix,0,0,0,464,0.012448,0.5,0,0.2188,4,1,0,0.5974,1.9183,4.0,-38.95,25.73,1,0,0.0,0,11.8462,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in gnocchi role
[SEP]
FILES CHANGED:
ansible/roles/gnocchi/tasks/external_ceph.yml (+1, -1)
ansible/roles/gnocchi/tasks/config.yml (+1, -1)
ansible/roles/gnocchi/tasks/bootstrap.yml (+2, -2)
ansible/roles/gnocchi/tasks/bootstrap_service.yml (+2, -2)
",2.332425,0.60238,0.540627,-0.621046,0.105054,-1.743868,-0.586793,-0.353054,0.09596,0.67466,0.450269,-0.08896,-0.486739,-0.344295,-0.650924
openstack/kolla-ansible,Ifa86a134c5c0dc3d0a39f30330ddb30dd3b8f3c2,0,0,0.4366,3.1355,0.5455,4,6.0,154,0,Bug Fix,0,0,0,465,0.01247,0.4,0,0.1746,4,1,0,0.5968,1.8779,4.0,-38.95,29.07,1,0,0.0,0,6.6957,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in grafana role
[SEP]
FILES CHANGED:
ansible/roles/grafana/tasks/bootstrap.yml (+2, -2)
ansible/roles/grafana/tasks/post_config.yml (+4, -5)
ansible/roles/grafana/defaults/main.yml (+1, -2)
ansible/roles/grafana/tasks/config.yml (+3, -3)
",2.245211,0.806007,0.525708,-0.695026,0.19931,-1.728567,-0.564859,-0.343781,0.154038,0.601679,0.389444,0.124295,-0.367468,-0.382654,-0.614393
openstack/kolla-ansible,Ifd89ad139899a9f97ee56b8821237a33122c8620,0,0,0.4356,3.1355,0.5,1,6.0,156,0,Bug Fix,0,0,0,466,0.01249,0.0,0,0.0,4,1,0,0.5961,0.0,4.0,-46.0,29.07,1,0,0.0,0,6.7826,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in hacluster role
[SEP]
FILES CHANGED:
ansible/roles/hacluster/tasks/bootstrap.yml (+11, -11)
",2.052275,0.892517,0.551972,-0.547416,0.283073,-1.774939,-0.551318,-0.273511,0.111158,0.566812,0.354619,0.019122,-0.43237,-0.483077,-0.551652
openstack/kolla-ansible,Ie83e990414aa19973b26185b47e1a575f52db288,0,0,0.4347,1.0986,0.5,1,6.0,161,0,Bug Fix,0,0,0,467,0.012509,0.3333,0,0.1449,4,1,0,0.5955,0.0,4.0,-60.11,29.07,1,0,0.0,0,53.6667,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in haproxy-config role
[SEP]
FILES CHANGED:
ansible/roles/haproxy-config/tasks/main.yml (+1, -1)
",2.233856,0.77204,0.607235,-0.514793,0.158307,-2.067924,-0.41566,-0.22244,0.195169,0.493767,0.121585,-0.10585,-0.416336,-0.390617,-0.428899
openstack/kolla-ansible,Ic18b7c25a13955da572f98b2dbca7d673a35746f,0,0,0.4338,2.3979,0.5,3,6.0,151,0,Bug Fix,0,0,0,468,0.012535,1.0,0,0.4338,4,1,0,0.5948,1.5219,4.0,-31.9,25.73,1,0,0.0,0,13.7273,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in heat role
[SEP]
FILES CHANGED:
ansible/roles/heat/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/heat/tasks/bootstrap.yml (+2, -2)
ansible/roles/heat/tasks/config.yml (+1, -1)
",2.482784,0.757893,0.625486,-0.61031,0.010747,-1.709949,-0.686483,-0.472775,0.294426,0.817976,0.262767,-0.190267,-0.276522,-0.194415,-0.772691
openstack/kolla-ansible,Ia3177178a177cd0c8fe434ba75b9af11bc998f8a,0,0,0.4328,2.4849,0.5455,3,6.0,154,0,Bug Fix,0,0,0,469,0.012559,0.5,0,0.2164,4,1,0,0.5942,1.5726,4.0,-53.05,29.07,1,0,0.0,0,12.8333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in horizon role
[SEP]
FILES CHANGED:
ansible/roles/horizon/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/horizon/tasks/policy_item.yml (+1, -2)
ansible/roles/horizon/tasks/bootstrap.yml (+2, -2)
",2.464475,0.79083,0.634402,-0.499593,0.175866,-1.653419,-0.680552,-0.480286,0.356659,0.860823,0.225192,-0.122284,-0.358099,-0.248256,-0.641694
openstack/kolla-ansible,I1ad2a1371de9d0e1f36675871ac9e500888a2e82,0,0,0.4319,1.0986,0.5,1,6.0,155,0,Bug Fix,0,0,0,470,0.012582,0.5,0,0.216,4,1,0,0.5935,0.0,4.0,-67.15,25.73,1,0,0.0,0,51.6667,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in influxdb role
[SEP]
FILES CHANGED:
ansible/roles/influxdb/defaults/main.yml (+1, -1)
",2.422668,0.680001,0.774287,-0.696122,0.13176,-1.747903,-0.558222,-0.239142,0.309804,0.730359,0.143644,-0.117687,-0.407219,-0.348344,-0.612963
openstack/kolla-ansible,I8213b6fe13dac146ded0db903dd0b00123e22e43,0,0,0.431,3.0445,0.5,6,6.0,153,0,Bug Fix,0,0,0,471,0.012608,0.44,0,0.1896,4,1,0,0.5929,2.4464,4.0,-53.05,29.07,1,0,0.0,0,7.2857,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in ironic role
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/bootstrap_service.yml (+3, -3)
ansible/roles/ironic/tasks/bootstrap.yml (+2, -2)
ansible/roles/ironic/defaults/main.yml (+1, -1)
ansible/roles/ironic/tasks/precheck.yml (+1, -1)
ansible/roles/ironic/tasks/rolling_upgrade.yml (+2, -2)
ansible/roles/ironic/tasks/config.yml (+1, -1)
",2.257886,0.883745,0.485224,-0.500774,0.068218,-1.613792,-0.613456,-0.523561,0.112024,0.885738,0.383078,-0.076521,-0.219717,-0.384321,-0.64574
openstack/kolla-ansible,I18c29512f250494adae32de77ff44b9d46fa5a64,0,0,0.4301,1.6094,0.5,1,6.0,152,0,Bug Fix,0,0,0,472,0.012628,0.75,0,0.3226,4,1,0,0.5923,0.0,4.0,-46.0,25.73,1,0,0.0,0,30.4,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in iscsi role
[SEP]
FILES CHANGED:
ansible/roles/iscsi/defaults/main.yml (+2, -2)
",1.9043,0.769797,0.374122,-0.50775,0.297699,-1.745623,-0.733551,-0.438861,0.057799,0.756389,0.369715,-0.066905,-0.37602,-0.489773,-0.510626
openstack/kolla-ansible,I0a2c6c4cbeacf1719db34cd5b8282fba13de04d1,0,0,0.4292,4.2627,0.5,8,6.0,155,0,Bug Fix,0,0,0,473,0.012653,0.75,0,0.3219,4,1,0,0.5916,2.519,4.0,-38.95,25.73,1,0,0.0,0,2.1831,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in keystone role
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/upgrade.yml (+2, -2)
ansible/roles/keystone/tasks/distribute_fernet.yml (+1, -1)
ansible/roles/keystone/handlers/main.yml (+4, -4)
ansible/roles/keystone/tasks/register.yml (+3, -3)
ansible/roles/keystone/tasks/config.yml (+4, -4)
ansible/roles/keystone/tasks/bootstrap_service.yml (+4, -4)
ansible/roles/keystone/tasks/register_identity_providers.yml (+15, -15)
ansible/roles/keystone/tasks/bootstrap.yml (+2, -2)
",2.462062,0.745424,0.6983,-0.698213,0.023353,-1.741533,-0.625484,-0.401705,0.220082,0.665383,0.301676,-0.142706,-0.314959,-0.38715,-0.621906
openstack/kolla-ansible,I1ceeba74f13dc26d112d65d98bb1b3c2f2cabd1c,0,0,0.4283,2.0794,0.5714,2,6.0,152,0,Bug Fix,0,0,0,474,0.012657,0.4,0,0.1713,4,1,0,0.591,0.8631,4.0,-31.9,25.73,1,0,0.0,0,19.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in kuryr role
[SEP]
FILES CHANGED:
ansible/roles/kuryr/defaults/main.yml (+2, -3)
ansible/roles/kuryr/tasks/config.yml (+1, -1)
",2.289466,0.731847,0.520317,-0.760235,0.133392,-1.775884,-0.649975,-0.413628,-0.047064,0.65087,0.3901,-0.085576,-0.440228,-0.440819,-0.661225
openstack/kolla-ansible,Ia3d5ddd102dfb4e34237bda0016b93e329fd1a86,0,0,0.4274,2.3979,0.5,1,6.0,159,0,Bug Fix,0,0,0,475,0.012681,0.375,0,0.1603,4,1,0,0.5904,0.0,4.0,-53.05,29.07,1,0,0.0,0,14.4545,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in loadbalancer role
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/defaults/main.yml (+5, -5)
",2.444526,0.407767,0.759728,-0.533369,0.196977,-1.840955,-0.434901,-0.165517,0.383705,0.612726,0.144667,-0.104239,-0.426729,-0.416505,-0.670358
openstack/kolla-ansible,I86dc2ff6de71034451f01bd2260226416b93c2ba,0,0,0.4265,2.9444,0.5,4,6.0,153,0,Bug Fix,0,0,0,476,0.012704,0.6667,0,0.2843,4,1,0,0.5897,1.9749,4.0,-24.85,25.73,1,0,0.0,0,8.0526,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in magnum role
[SEP]
FILES CHANGED:
ansible/roles/magnum/tasks/register.yml (+3, -3)
ansible/roles/magnum/tasks/bootstrap.yml (+2, -2)
ansible/roles/magnum/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/magnum/tasks/config.yml (+2, -2)
",2.278603,0.839636,0.485887,-0.555726,0.255429,-1.618361,-0.59202,-0.515837,0.284856,0.820812,0.430982,-0.018988,-0.363316,-0.278421,-0.697334
openstack/kolla-ansible,I4e8a88d69654ca1f5665ed2db74279e82dbbf6b4,0,0,0.4256,3.2189,0.5,5,6.0,153,0,Bug Fix,0,0,0,477,0.012725,0.4667,0,0.1986,4,1,0,0.5891,1.9591,4.0,-53.05,29.07,1,0,0.0,0,6.12,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in manila role
[SEP]
FILES CHANGED:
ansible/roles/manila/defaults/main.yml (+6, -6)
ansible/roles/manila/tasks/external_ceph.yml (+1, -1)
ansible/roles/manila/tasks/config.yml (+1, -1)
ansible/roles/manila/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/manila/tasks/bootstrap.yml (+2, -2)
",2.243926,0.653695,0.49484,-0.673825,0.138796,-1.606038,-0.623555,-0.538524,0.154995,0.81683,0.455399,0.090977,-0.417146,-0.333823,-0.637928
openstack/kolla-ansible,Iebf507ea4c970bbde896bd8fde344f433b6e6366,0,0,0.4247,3.5553,0.5,8,6.0,154,0,Bug Fix,0,0,0,478,0.012743,0.5,0,0.2123,4,1,0,0.5885,2.7719,4.0,-38.95,25.73,1,0,0.0,0,4.4,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in mariadb role
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/backup.yml (+2, -2)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+3, -3)
ansible/roles/mariadb/tasks/loadbalancer.yml (+2, -2)
ansible/roles/mariadb/tasks/recover_cluster.yml (+5, -5)
ansible/roles/mariadb/tasks/post-upgrade.yml (+1, -1)
ansible/roles/mariadb/tasks/check.yml (+1, -1)
ansible/roles/mariadb/tasks/bootstrap_cluster.yml (+1, -1)
ansible/roles/mariadb/tasks/register.yml (+2, -2)
",1.999727,0.761926,0.295355,-0.617422,0.320521,-1.794312,-0.502839,-0.28751,-0.032781,0.627491,0.455156,0.055008,-0.50313,-0.465862,-0.702078
openstack/kolla-ansible,I9c3da9d4e99f30947d3bdf4bca72c3e3f836a9a8,0,0,0.4238,2.7081,0.5,5,6.0,155,0,Bug Fix,0,0,0,479,0.012758,0.4545,0,0.1926,4,1,0,0.5879,2.2359,4.0,-67.15,29.07,1,0,0.0,0,10.3333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in masakari role
[SEP]
FILES CHANGED:
ansible/roles/masakari/tasks/bootstrap.yml (+2, -2)
ansible/roles/masakari/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/masakari/tasks/config.yml (+1, -1)
ansible/roles/masakari/tasks/precheck.yml (+1, -1)
ansible/roles/masakari/defaults/main.yml (+1, -1)
",2.193917,0.699771,0.512396,-0.64192,0.189064,-1.682109,-0.557644,-0.327365,0.080105,0.763228,0.412924,0.161875,-0.477321,-0.459423,-0.688785
openstack/kolla-ansible,Ifcd30459b610bf37098eae0e2960b2e27715d5ab,0,0,0.4229,2.3979,0.5,3,6.0,154,0,Bug Fix,0,0,0,480,0.01278,0.0,0,0.0,4,1,0,0.5872,1.5219,4.0,-38.95,25.73,1,0,0.0,0,14.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in mistral role
[SEP]
FILES CHANGED:
ansible/roles/mistral/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/mistral/tasks/config.yml (+1, -1)
ansible/roles/mistral/tasks/bootstrap.yml (+2, -2)
",2.283788,0.737629,0.584171,-0.635992,0.189843,-1.659216,-0.589127,-0.427055,0.21054,0.658748,0.298342,0.021455,-0.443252,-0.3611,-0.691354
openstack/kolla-ansible,I69ec0f94e21a53f5c5f42a4c60a851c15f083aac,0,0,0.422,1.0986,0.5,1,6.0,157,0,Bug Fix,0,0,0,481,0.012803,0.75,0,0.3165,4,1,0,0.5866,0.0,4.0,-60.11,29.07,1,0,0.0,0,52.3333,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in multipathd role
[SEP]
FILES CHANGED:
ansible/roles/multipathd/defaults/main.yml (+1, -1)
",2.270183,0.537922,0.68021,-0.691432,0.137776,-1.857164,-0.569143,-0.210869,0.111125,0.626174,0.243654,-0.047161,-0.408954,-0.335328,-0.59845
openstack/kolla-ansible,I93214d97b9d7911a4f8e6d947a04fd8cb7ebde21,0,0,0.4212,4.0431,0.5,7,6.0,154,0,Bug Fix,0,0,0,482,0.012829,0.2857,0,0.1203,4,1,0,0.586,2.4797,4.0,-46.0,25.73,1,0,0.0,0,2.7018,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in neutron role
[SEP]
FILES CHANGED:
ansible/roles/neutron/tasks/precheck.yml (+3, -3)
ansible/roles/neutron/tasks/rolling_upgrade.yml (+5, -5)
ansible/roles/neutron/defaults/main.yml (+11, -11)
ansible/roles/neutron/tasks/bootstrap.yml (+2, -2)
ansible/roles/neutron/tasks/config.yml (+3, -3)
ansible/roles/neutron/tasks/config-neutron-fake.yml (+2, -2)
ansible/roles/neutron/tasks/bootstrap_service.yml (+2, -2)
",2.248606,0.827686,0.654216,-0.499704,0.093843,-1.595278,-0.700503,-0.442298,0.242288,0.861692,0.285864,-0.037656,-0.283144,-0.19271,-0.697161
openstack/kolla-ansible,Ia653bfbbf04e25f5bd002526247645dffef95b2b,0,0,0.4203,4.1431,0.5,16,6.0,151,0,Bug Fix,0,0,0,483,0.012837,0.5556,0,0.2335,4,1,0,0.5854,3.7568,4.0,-24.85,25.73,1,0,0.0,0,2.3968,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in nova role
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/defaults/main.yml (+5, -5)
ansible/roles/nova-cell/tasks/bootstrap_service.yml (+1, -1)
ansible/roles/nova-cell/tasks/config_bootstrap.yml (+1, -1)
ansible/roles/nova/tasks/bootstrap.yml (+2, -2)
ansible/roles/nova-cell/handlers/main.yml (+2, -2)
ansible/roles/nova-cell/tasks/online_data_migrations.yml (+1, -1)
ansible/roles/nova/tasks/bootstrap_service.yml (+1, -1)
ansible/roles/nova/tasks/config.yml (+3, -3)
ansible/roles/nova/tasks/upgrade.yml (+2, -2)
ansible/roles/nova-cell/tasks/get_cell_settings.yml (+1, -1)
ansible/roles/nova-cell/tasks/config.yml (+3, -3)
ansible/roles/nova/tasks/config_bootstrap.yml (+1, -1)
ansible/roles/nova-cell/tasks/config-nova-fake.yml (+2, -2)
ansible/roles/nova/defaults/main.yml (+4, -4)
ansible/roles/service-rabbitmq/tasks/main.yml (+1, -1)
ansible/roles/nova/tasks/online_data_migrations.yml (+1, -1)
",2.170323,0.694602,0.351111,-0.569081,0.190658,-1.689892,-0.700514,-0.521179,0.138271,0.882197,0.38703,0.057501,-0.359147,-0.329926,-0.654936
openstack/kolla-ansible,Ib22ea26475cb0d23a8ac164da7887e041930a24a,0,0,0.4194,4.2627,0.5,8,6.0,154,0,Bug Fix,0,0,0,484,0.012842,0.5,0,0.2097,4,1,0,0.5847,2.684,4.0,-67.15,29.07,1,0,0.0,0,2.169,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in octavia role
[SEP]
FILES CHANGED:
ansible/roles/octavia/tasks/register.yml (+1, -1)
ansible/roles/octavia/tasks/get_resources_info.yml (+5, -5)
ansible/roles/octavia/tasks/precheck.yml (+3, -3)
ansible/roles/octavia/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/octavia/tasks/prepare.yml (+10, -10)
ansible/roles/octavia/tasks/config.yml (+2, -2)
ansible/roles/octavia/tasks/hm-interface.yml (+8, -8)
ansible/roles/octavia/tasks/bootstrap.yml (+4, -4)
",2.163242,0.797386,0.48564,-0.705265,0.048074,-1.687493,-0.650957,-0.403882,0.176286,0.811588,0.47794,0.14743,-0.31886,-0.48084,-0.547283
openstack/kolla-ansible,Ia1422d985ce53697b4020642fa5e131be6260b46,0,0,0.4186,2.3026,0.6667,4,6.0,167,0,Bug Fix,0,0,0,485,0.012845,0.0,0,0.0,4,1,0,0.5841,1.6577,4.0,-81.25,29.07,1,0,0.0,0,16.7,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in octavia-certificates role
[SEP]
FILES CHANGED:
ansible/roles/octavia-certificates/tasks/check_expiry.yml (+1, -1)
ansible/roles/octavia-certificates/tasks/server_ca.yml (+0, -1)
ansible/roles/octavia-certificates/tasks/client_ca.yml (+2, -3)
ansible/roles/octavia-certificates/tasks/client_cert.yml (+0, -1)
",1.976115,0.61234,0.320912,-0.721137,0.252581,-1.77696,-0.523608,-0.160024,0.178037,0.480105,0.23512,0.1119,-0.399146,-0.456713,-0.426692
openstack/kolla-ansible,I12857ee0d5f66b9c9eaa8ff9e3a4655d665eb8a8,0,0,0.4177,2.5649,0.5,2,6.0,157,0,Bug Fix,0,0,0,486,0.012868,1.0,0,0.4177,4,1,0,0.5835,1.0,4.0,-60.11,29.07,1,0,0.0,0,12.0769,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in opensearch role
[SEP]
FILES CHANGED:
ansible/roles/opensearch/tasks/post-config.yml (+3, -3)
ansible/roles/opensearch/handlers/main.yml (+3, -3)
",2.114639,1.006006,0.379672,-0.562045,0.29599,-1.677298,-0.603172,-0.443116,0.012847,0.550906,0.388082,0.051146,-0.502322,-0.523003,-0.568917
openstack/kolla-ansible,Iaaac66afa529d060cb64b3d97dd53fb93f37e4d9,0,0,0.4168,1.6094,0.5,2,6.0,158,0,Bug Fix,0,0,0,487,0.012891,0.7143,0,0.2977,4,1,0,0.5829,1.0,4.0,-38.95,29.07,1,0,0.0,0,31.6,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in openvswitch role
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/handlers/main.yml (+1, -1)
ansible/roles/openvswitch/defaults/main.yml (+1, -1)
",2.435061,0.533862,0.72888,-0.707849,-0.032995,-1.853986,-0.616684,-0.225319,0.294571,0.710939,0.181306,-0.164096,-0.416307,-0.397369,-0.548373
openstack/kolla-ansible,Ibe411b7e3b7f99f1f723e5cebb33e9ad586074ae,0,0,0.416,2.1972,0.5,2,6.0,153,0,Bug Fix,0,0,0,488,0.012916,0.5,0,0.208,4,1,0,0.5823,1.0,4.0,-46.0,25.73,1,0,0.0,0,17.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in ovn-db role
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/tasks/lookup_cluster.yml (+2, -2)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+2, -2)
",2.132258,0.978684,0.398565,-0.563311,0.120922,-1.882426,-0.497545,-0.308304,0.047146,0.452647,0.218558,-0.034588,-0.435263,-0.22705,-0.501115
openstack/kolla-ansible,I2cec7cdf67e2e7446f2f60dfb2a67621c79ee702,0,0,0.4151,2.5649,0.5,3,6.0,155,0,Bug Fix,0,0,0,489,0.01294,0.6667,0,0.2768,4,1,0,0.5817,1.4591,4.0,-38.95,25.73,1,0,0.0,0,11.9231,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in ovs-dpdk role
[SEP]
FILES CHANGED:
ansible/roles/ovs-dpdk/tasks/config.yml (+3, -3)
ansible/roles/ovs-dpdk/defaults/main.yml (+1, -1)
ansible/roles/ovs-dpdk/handlers/main.yml (+2, -2)
",2.053832,0.992145,0.180197,-0.621201,0.22697,-1.951833,-0.520295,-0.175848,-0.035793,0.462732,0.196488,0.059967,-0.471239,-0.409466,-0.377261
openstack/kolla-ansible,I6c2e59b798804e62f09effc7875c8f25fe930158,0,0,0.4143,2.8332,0.5,5,6.0,156,0,Bug Fix,0,0,0,490,0.012962,0.3333,0,0.1381,4,1,0,0.5811,2.25,4.0,-46.0,29.07,1,0,0.0,0,9.1765,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in placement role
[SEP]
FILES CHANGED:
ansible/roles/placement/tasks/bootstrap.yml (+2, -2)
ansible/roles/placement/defaults/main.yml (+1, -1)
ansible/roles/placement/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/placement/tasks/upgrade.yml (+2, -2)
ansible/roles/placement/tasks/config.yml (+1, -1)
",2.509375,0.700999,0.774946,-0.481574,0.170929,-1.659176,-0.645647,-0.443561,0.478339,0.836734,0.298011,-0.173895,-0.325455,-0.189648,-0.790479
openstack/kolla-ansible,I376d9b09dff64a49c1961ff4aa7e3db8bf8b285d,0,0,0.4134,2.7081,0.5,2,6.0,156,0,Bug Fix,0,0,0,491,0.012983,0.25,0,0.1034,4,1,0,0.5804,0.8631,4.0,-31.9,25.73,1,0,0.0,0,10.4,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in prechecks role
[SEP]
FILES CHANGED:
ansible/roles/prechecks/tasks/user_checks.yml (+2, -2)
ansible/roles/prechecks/tasks/service_checks.yml (+5, -5)
",2.510406,0.643056,0.773331,-0.624401,0.126885,-1.702892,-0.703178,-0.461425,0.225646,0.794615,0.188768,-0.245557,-0.369689,-0.269749,-0.626685
openstack/kolla-ansible,I9af1f767782904ce3eddd997a225b01f82bda3af,0,0,0.4126,1.9459,0.5,2,6.0,157,0,Bug Fix,0,0,0,492,0.013005,0.3333,0,0.1375,4,1,0,0.5798,0.9183,4.0,-60.11,29.07,1,0,0.0,0,22.4286,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in prometheus role
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/config.yml (+2, -2)
ansible/roles/prometheus/tasks/bootstrap.yml (+1, -1)
",2.453378,0.729773,0.642129,-0.565196,0.118894,-1.756187,-0.740691,-0.268335,0.271188,0.774575,0.213407,-0.154998,-0.418466,-0.420623,-0.598369
openstack/kolla-ansible,I9b4d3aa66e9e42d6d7816e3a1aeb619368ac3041,0,0,0.4118,1.0986,0.5,1,6.0,159,0,Bug Fix,0,0,0,493,0.013029,0.0,0,0.0,4,1,0,0.5792,0.0,4.0,-81.25,29.07,1,0,0.0,0,53.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in prune-images role
[SEP]
FILES CHANGED:
ansible/roles/prune-images/tasks/prune_images.yml (+1, -1)
",1.991948,1.188348,0.318375,-0.294312,0.365303,-1.799422,-0.616903,-0.531217,0.0282,0.436997,0.280027,0.003604,-0.104304,-0.046162,-0.493807
openstack/kolla-ansible,I4d4bfd90124e61bdd3fc68be0b6211d8d8f64849,0,0,0.4109,2.1972,0.5,3,6.0,155,0,Bug Fix,0,0,0,494,0.013055,0.5,0,0.2055,4,1,0,0.5786,1.5,4.0,-24.85,25.73,1,0,0.0,0,17.2222,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in rabbitmq role
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/bootstrap.yml (+1, -1)
ansible/roles/rabbitmq/tasks/restart_services.yml (+1, -1)
ansible/roles/rabbitmq/defaults/main.yml (+2, -2)
",2.516641,0.417604,0.808472,-0.956198,-0.000118,-1.791021,-0.574201,-0.260348,0.030429,0.736871,0.296056,-0.183176,-0.457534,-0.417934,-0.495257
openstack/kolla-ansible,Iab3ecd94083434f47e4589f72424cf283b4803fb,0,0,0.4101,1.0986,0.5,1,6.0,164,0,Bug Fix,0,0,0,495,0.013078,0.0,0,0.0,4,1,0,0.578,0.0,4.0,-53.05,29.07,1,0,0.0,0,54.6667,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in service-cert-copy role
[SEP]
FILES CHANGED:
ansible/roles/service-cert-copy/defaults/main.yml (+1, -1)
",2.20073,0.671756,0.566756,-0.702907,-0.090641,-2.130842,-0.601625,-0.443964,0.302186,0.613013,0.053612,-0.171255,-0.12717,0.053648,-0.340525
openstack/kolla-ansible,I8285a0518e66f5f0b679ae69a985a78dba7d4b68,0,0,0.4093,2.3979,0.5,1,6.0,170,0,Bug Fix,0,0,0,496,0.013104,0.0,0,0.0,4,1,0,0.5774,0.0,4.0,-95.35,29.07,1,0,0.0,0,15.4545,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in service-config-validate role
[SEP]
FILES CHANGED:
ansible/roles/service-config-validate/tasks/validate.yml (+5, -5)
",2.288187,0.696021,0.426782,-0.376846,0.165584,-2.262578,-0.452221,-0.376406,0.278229,0.431413,-0.016989,-0.148635,-0.224564,-0.00596,-0.424365
openstack/kolla-ansible,I91f20053ddc40e6b08d1d80bf84ecdb215e69496,0,0,0.4085,2.1972,0.5,2,6.0,154,0,Bug Fix,0,0,0,497,0.013127,0.0,0,0.0,4,1,0,0.5768,1.0,4.0,-31.9,25.73,1,0,0.0,0,17.1111,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in skyline role
[SEP]
FILES CHANGED:
ansible/roles/skyline/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/skyline/tasks/bootstrap.yml (+2, -2)
",2.491797,0.781469,0.722496,-0.629547,0.069594,-1.655654,-0.741505,-0.491519,0.324559,0.837907,0.25319,-0.159894,-0.28308,-0.251457,-0.680874
openstack/kolla-ansible,Ie04247f7db1eb9fd66d2fc9e6058b76e0296db20,0,0,0.4076,2.3979,0.5,3,6.0,153,0,Bug Fix,0,0,0,498,0.013151,0.0,0,0.0,4,1,0,0.5762,1.5219,4.0,-31.9,25.73,1,0,0.0,0,13.9091,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in tacker role
[SEP]
FILES CHANGED:
ansible/roles/tacker/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/tacker/tasks/bootstrap.yml (+2, -2)
ansible/roles/tacker/tasks/config.yml (+1, -1)
",2.356508,0.794324,0.540896,-0.547897,0.190217,-1.749782,-0.571137,-0.505005,0.192264,0.78342,0.395898,-0.151117,-0.302289,-0.395685,-0.707504
openstack/kolla-ansible,Ica1a6a89d42b5fec8e4f07f28f24176442e01b15,0,0,0.4068,2.3979,0.5,3,6.0,152,0,Bug Fix,0,0,0,499,0.013174,0.0,0,0.0,4,1,0,0.5756,1.5219,4.0,-46.0,25.73,1,0,0.0,0,13.8182,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in trove role
[SEP]
FILES CHANGED:
ansible/roles/trove/tasks/bootstrap.yml (+2, -2)
ansible/roles/trove/tasks/config.yml (+1, -1)
ansible/roles/trove/tasks/bootstrap_service.yml (+2, -2)
",2.436868,0.921032,0.575658,-0.563755,0.122587,-1.695282,-0.644941,-0.458375,0.252813,0.809088,0.293946,-0.203484,-0.287752,-0.27688,-0.700939
openstack/kolla-ansible,Ib1cf619c742f2d37b5cc22134a7d68e53e70e573,0,0,0.406,2.3979,0.5,3,6.0,154,0,Bug Fix,0,0,0,500,0.013196,0.0,0,0.0,4,1,0,0.575,1.5219,4.0,-38.95,25.73,1,0,0.0,0,14.0,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in watcher role
[SEP]
FILES CHANGED:
ansible/roles/watcher/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/watcher/tasks/bootstrap.yml (+2, -2)
ansible/roles/watcher/tasks/config.yml (+1, -1)
",2.510042,0.583342,0.738634,-0.565246,0.146079,-1.781966,-0.634235,-0.410776,0.400939,0.793044,0.268712,-0.263192,-0.364622,-0.227941,-0.622275
openstack/kolla-ansible,I53d4e293ab946bbef7ae9ee70869411a9e2e20cc,0,0,0.4052,2.9444,0.5,6,6.0,150,0,Bug Fix,0,0,0,501,0.013219,0.5,0,0.2026,4,1,0,0.5744,2.5033,4.0,-60.11,25.73,1,0,0.0,0,7.8947,0,0,0,0,0,"ansible-lint: Fix yaml[truthy] in zun role
[SEP]
FILES CHANGED:
ansible/roles/zun/tasks/bootstrap.yml (+2, -2)
ansible/roles/zun/tasks/external_ceph.yml (+1, -1)
ansible/roles/zun/tasks/bootstrap_service.yml (+2, -2)
ansible/roles/zun/tasks/precheck.yml (+1, -1)
ansible/roles/zun/defaults/main.yml (+2, -2)
ansible/roles/zun/tasks/config.yml (+1, -1)
",2.280192,0.80204,0.472999,-0.595052,0.265,-1.652258,-0.67505,-0.562149,0.162235,0.723064,0.312864,-0.064955,-0.374904,-0.21496,-0.707888
openstack/kolla-ansible,I7dee3866191cef84cd12b1816cdab0a02380ec7f,0,0,0.4044,6.8459,0.5261,74,6.14,387,0,Bug Fix,0,0,0,502,0.013239,1.0,0,0.4044,4,2,0,0.5738,4.0578,2.8,9.76,15.48,1,0,0.0,0,0.4117,0,0,0,0,0,"ansible-lint: Remove yaml[truthy] from excludes

Normalize quotes and some other easy fixes done by
ansible-lint --fix

Also drop etc from excludes and ignore comment check in
etc/kolla/globals.yml

Pinning to ansible-lint<25.11.0 because 25.11.1 is breaking
without any messages
[SEP]
FILES CHANGED:
ansible/group_vars/all/ceph-rgw.yml (+1, -1)
ansible/group_vars/all/neutron.yml (+19, -20)
ansible/roles/horizon/defaults/main.yml (+1, -1)
ansible/site.yml (+93, -142)
ansible/group_vars/all/nova.yml (+6, -6)
ansible/roles/ironic/tasks/precheck.yml (+1, -1)
ansible/roles/cinder/defaults/main.yml (+1, -1)
ansible/group_vars/all/haproxy.yml (+18, -17)
ansible/group_vars/all/kuryr.yml (+1, -1)
ansible/roles/nova-cell/tasks/external_ceph.yml (+1, -1)
etc/kolla/globals.yml (+130, -130)
ansible/group_vars/all/letsencrypt.yml (+1, -1)
ansible/mariadb.yml (+5, -5)
ansible/mariadb_recovery.yml (+3, -3)
ansible/group_vars/all/common.yml (+14, -18)
ansible/roles/nova-cell/tasks/discover_computes.yml (+1, -1)
ansible/group_vars/all/watcher.yml (+1, -1)
.ansible-lint (+4, -3)
ansible/group_vars/all/trove.yml (+2, -2)
ansible/group_vars/all/grafana.yml (+1, -1)
ansible/roles/letsencrypt/defaults/main.yml (+0, -1)
ansible/group_vars/all/glance.yml (+6, -6)
ansible/group_vars/all/octavia.yml (+1, -1)
ansible/kolla-host.yml (+2, -2)
ansible/gather-facts.yml (+1, -1)
ansible/roles/magnum/defaults/main.yml (+1, -1)
.gitignore (+1, -0)
ansible/group_vars/all/aodh.yml (+1, -1)
ansible/group_vars/all/gnocchi.yml (+2, -2)
ansible/roles/valkey/tasks/upgrade.yml (+0, -2)
ansible/roles/nova/tasks/map_cell0.yml (+3, -3)
ansible/group_vars/all/ironic.yml (+3, -3)
ansible/group_vars/all/mariadb.yml (+5, -5)
ansible/mariadb_backup.yml (+3, -3)
ansible/group_vars/all/collectd.yml (+1, -1)
tools/setup-compute-libvirt.yml (+1, -1)
ansible/group_vars/all/barbican.yml (+1, -1)
ansible/group_vars/all/fluentd.yml (+1, -1)
ansible/group_vars/all/keystone.yml (+0, -1)
ansible/group_vars/all/blazar.yml (+1, -1)
ansible/group_vars/all/mistral.yml (+1, -1)
ansible/group_vars/all/skyline.yml (+1, -1)
ansible/group_vars/all/manila.yml (+7, -7)
ansible/group_vars/all/etcd.yml (+1, -1)
ansible/post-deploy.yml (+1, -1)
.ansible-lint-ignore (+1, -0)
ansible/group_vars/all/ceilometer.yml (+3, -3)
ansible/rabbitmq.yml (+15, -15)
ansible/roles/keystone/defaults/main.yml (+2, -2)
ansible/nova.yml (+10, -10)
ansible/group_vars/all/multipathd.yml (+1, -1)
ansible/group_vars/all/telegraf.yml (+2, -2)
ansible/group_vars/all/zun.yml (+4, -5)
ansible/roles/ovn-controller/tasks/setup-ovs.yml (+10, -4)
ansible/group_vars/all/rabbitmq.yml (+1, -1)
ansible/roles/nova-cell/tasks/create_cells.yml (+2, -2)
ansible/roles/common/defaults/main.yml (+3, -3)
ansible/roles/etcd/handlers/main.yml (+7, -7)
ansible/group_vars/all/ceph.yml (+1, -1)
ansible/group_vars/all/cinder.yml (+12, -12)
ansible/group_vars/all/cyborg.yml (+1, -1)
ansible/group_vars/all/magnum.yml (+1, -1)
ansible/bifrost.yml (+2, -2)
ansible/roles/octavia/defaults/main.yml (+3, -3)
ansible/group_vars/all/memcached.yml (+2, -2)
ansible/group_vars/all/openvswitch.yml (+1, -1)
ansible/group_vars/all/designate.yml (+3, -3)
ansible/roles/openvswitch/tasks/config-host.yml (+1, -1)
ansible/group_vars/all/prometheus.yml (+3, -3)
ansible/group_vars/all/tacker.yml (+1, -1)
ansible/roles/opensearch/defaults/main.yml (+1, -1)
ansible/group_vars/all/cloudkitty.yml (+1, -1)
ansible/group_vars/all/masakari.yml (+1, -1)
ansible/group_vars/all/valkey.yml (+1, -1)
",-0.774841,-0.297407,-0.324601,-0.177516,0.093938,-1.021498,-0.681854,-0.298423,-0.49228,0.655825,-0.208283,-0.707608,0.059484,0.392981,-0.04784
openstack/kolla-ansible,I5fb29efc9bff4560528a98824399126eb13873c7,1,0,0.4036,1.0986,0.0,1,5.5,129,0,Doc,1,0,0,503,0.012945,0.3878,0,0.1565,2,1,0,0.5732,0.0,2.0,-6.4,20.38,0,0,1.0,0,43.0,0,0,0,0,0,"CI: Pin docker to <29
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+2, -0)
",3.148633,0.911243,1.507251,-0.687559,0.04691,0.764681,-0.824322,0.225502,-0.18869,0.731028,-0.197203,-0.387491,0.65393,0.465215,-0.325467
openstack/ironic,I49351a35971d3970faaea62b36d49e4ee883db1f,1,0,0.75,1.0986,0.5,1,4.33,156,0,Bug Fix,0,0,0,4,0.007828,1.0,1,0.75,4,1,0,0.9643,0.0,4.0,-44.86,23.27,1,0,0.0,0,52.0,0,0,0,0,0,"Nit: Fix typo in Migrating from ironic-inspector
[SEP]
FILES CHANGED:
doc/source/admin/inspection/migration.rst (+1, -1)
",2.126038,0.211235,0.622656,-0.274896,-0.002469,-0.217269,-0.19166,0.329194,-0.617927,0.117957,0.456982,-0.006375,0.261318,-0.270261,0.190653
openstack/kolla-ansible,I0189391dede5b325941d32ff54ac7032d1d20e5b,1,0,0.4048,1.0986,0.5,1,7.0,254,0,CI,1,0,0,504,0.01297,0.2727,0,0.1104,1,1,0,0.5737,0.0,1.0,9.38,17.09,0,0,1.0,0,84.6667,0,0,0,0,0,"CI: Switch IPA images source location

It should be ironic-python-agent, not builder.
It seems Ironic has switched upload locations long time ago.
[SEP]
FILES CHANGED:
tests/run.yml (+1, -1)
",1.389336,-1.031003,-0.468427,-0.061693,-0.942757,-0.157406,0.325272,-0.03355,-0.990392,-0.230181,0.484377,0.126887,0.018369,0.446539,-0.280708
openstack/ironic-python-agent,I3e97b10f2c7f3c454f0db2a3c3c8efb61ffeda5a,1,0,0.8571,4.382,0.038,3,10.8,414,0,Bug Fix,0,0,0,7,0.047945,1.0,0,0.8571,3,2,0,0.9118,0.9528,2.0,36.07,13.21,1,0,0.7848,1,5.175,0,0,0,0,0,"Fix RuntimeError when stopping heartbeater in rescue mode

In rescue mode, the agent attempts to stop the heartbeater thread
even though it was never started, causing a RuntimeError. This fix
adds checks to ensure the heartbeater thread is alive before
attempting to stop it.

Assisted-By: Claude Sonnet 4.5
[SEP]
FILES CHANGED:
releasenotes/notes/fix-rescue-mode-heartbeater-stop-8f3a2b1c4d5e6f7g.yaml (+6, -0)
ironic_python_agent/agent.py (+8, -3)
ironic_python_agent/tests/unit/test_agent.py (+62, -0)
",-1.051299,-0.516758,-0.520427,0.907078,-0.187831,0.667853,-0.196622,-0.788181,0.04512,0.192828,0.56237,0.305741,0.251065,0.186492,-0.08156
openstack/openstack-ansible-os_keystone,I2d21a297631cd70373280f460abfca6e250eb590,1,1,0.9598,0.6931,0.0,1,5.67,329,0,Bug Fix,0,0,0,249,0.053502,1.0,0,0.9598,1,1,0,1.0,0.0,1.0,-5.44,18.74,1,0,0.0,0,164.5,0,6,0,5,0,"Ensure shibboleth utils are installed

On Ubuntu 24.04 and 22.04 shibboleth-sp-utils is not installed by
default, which results in absent /etc/shibboleth directory as well
as shib-keygen.

Closes-Bug: #2118275
[SEP]
FILES CHANGED:
vars/debian.yml (+1, -0)
",-0.258805,0.235627,-0.910579,0.37132,0.062943,-0.204042,0.138388,0.287346,-0.459013,-0.203405,0.30845,0.025953,-0.166736,0.048085,0.587471
openstack/kolla-ansible,I9a3d8d3dd268b7bb098b8e87d22b11e4ef0c72e9,1,0,0.4059,2.0794,1.0,1,7.5,244,0,Doc,1,0,0,505,0.012995,0.4,0,0.1624,2,1,0,0.5741,0.0,2.0,32.84,12.33,0,0,1.0,0,30.5,0,0,0,0,0,"CI: Stop using infra cache servers as registry

It stopped working with docker-ce >= 29.0.0 and has proven
to be problematic in the past
[SEP]
FILES CHANGED:
tests/templates/globals-default.j2 (+0, -7)
",1.142786,-0.613195,-0.269061,-0.086977,-0.304458,0.470279,-0.356647,-0.102321,-0.941956,0.640072,-0.197854,0.339322,-0.295442,-0.083768,0.444619
openstack/kolla-ansible,Ied6ce15ce0e987cd1794351d2139a75edd5f52bc,1,0,0.4071,2.3026,0.4444,2,8.0,287,0,Doc,0,0,0,506,0.013019,0.375,0,0.1527,4,2,0,0.5745,0.9911,4.0,5.72,16.95,0,0,0.0,0,28.7,0,0,0,0,0,"MariaDB: Improve recovery

We're only checking if master MariaDB node is listening,
we should check also slaves.

Apply InnoDB variables from Galera docs for improved performance.
[SEP]
FILES CHANGED:
ansible/roles/mariadb/templates/galera.cnf.j2 (+4, -0)
ansible/roles/mariadb/tasks/recover_cluster.yml (+1, -4)
",1.20383,-1.470076,-0.315566,0.205657,-0.600937,0.467428,-0.00182,-0.214965,-0.545895,-0.293022,-0.122818,0.118331,-0.062468,0.005307,-0.638433
openstack/kolla-ansible,Iddc5b14bf6fec937030ac75a3fce1774d46460cb,0,0,0.4083,1.7918,0.8,1,8.0,255,0,Feature,1,1,0,507,0.013041,0.1429,0,0.0583,2,1,0,0.575,0.0,2.0,8.37,16.53,0,0,1.0,1,42.5,0,0,0,0,0,"Revert^2 ""ovn: Mark as non-voting due to db related failures""

This reverts commit 809e5b2e341fefd655c12532d61a588bc2ce4091.

Reason for revert: It's failing again

Signed-Off-By: <mnasiadka@gmail.com>
[SEP]
FILES CHANGED:
zuul.d/scenarios/ovn.yaml (+1, -4)
",-0.47708,-0.124294,-1.678618,-1.304761,0.064168,0.440953,0.592428,-0.30665,0.299679,0.02575,0.474366,0.063882,0.039752,0.258287,-0.472809
openstack/kolla-ansible,I9e0e4b07af16463064e709896b83b6c86a799340,1,1,0,1.6094,0.5,1,16.0,421,0,Bug Fix,0,0,0,0,0.0,0.75,0,0.0,4,1,0,0.5744,0.0,4.0,0.25,18.9,0,0,0.0,0,84.2,1,26,0,8,0,"Add two unused variables to haproxy-config template file

To add extra configuration lines to the backend section of the haproxy
config files (tcp and http) for each service, the
'haproxy_backend_http_extra' and 'haproxy_backend_tcp_extra' variables
were added to its jinja2 template file.


Closes-Bug: #1914393
[SEP]
FILES CHANGED:
ansible/roles/haproxy-config/templates/haproxy_single_service_split.cfg.j2 (+2, -2)
",-1.263277,-0.044347,-1.079594,1.184033,0.757659,-0.448806,-0.5214,0.023545,0.363807,0.026692,-0.291249,-0.34318,-0.186539,0.444125,0.11152
openstack/oslo.messaging,Ia315fc3e91c2f129025b74bc18b5a93c1d40b498,1,1,0.8,4.9836,0.2621,3,10.5,693,0,Bug Fix,0,0,0,20,0.039683,0.65,0,0.52,3,2,0,0.5833,1.1914,2.33,16.91,15.15,1,0,0.4069,1,4.7466,0,6,0,7,0,"rabbit: Fix ignored PreconditionFailed error

The change 1fd461647f7f727dad9d4603abf0defe339d320f introduced
additional fallback logic to conflicting durable flag within a single
cluster, but it accidentally made the driver ignore the other errors
classified as PreconditionFailed error.

One example of PreconditionFailed is cluster exchange limit which was
introduced in 4.1.4, and this error is now silently ignored due to
this ignorance.

Make sure that PreconditionFailed is raised unless we know it may be
possible caused by conflicting durable field.

Closes-Bug: #2131652
[SEP]
FILES CHANGED:
oslo_messaging/tests/drivers/test_impl_rabbit.py (+58, -1)
releasenotes/notes/bug-2131652-70af38c59a65886e.yaml (+6, -0)
oslo_messaging/_drivers/impl_rabbit.py (+43, -37)
",-1.152496,-1.44746,0.569806,-0.764967,0.040844,0.355584,0.402012,-0.153572,0.469876,0.103757,0.526654,0.187015,-0.216795,-0.244244,0.347297
openstack/kolla-ansible,I4f174d4425a1a6a9ac74ce987690bca263cea51f,0,0,0.4075,1.3863,0.6667,1,2.1,253,0,Feature,0,0,0,508,0.013066,0.1633,0,0.0665,0,1,0,0.5748,0.0,0.0,-28.95,14.17,0,0,0.0,0,63.25,0,0,0,0,0,"Drop python3.10 from setup.cfg

ansible-core 2.18 lowest python version support is 3.11 [1].

[1]: https://pypi.org/project/ansible-core/2.18.11/
[SEP]
FILES CHANGED:
setup.cfg (+1, -2)
",-0.016904,2.25972,-1.056411,0.457967,-0.331855,-0.226472,-0.145921,0.473227,-0.386281,0.960407,-0.66243,-0.048349,-0.549752,0.432155,0.172105
openstack/kolla,I6ef0ed9cc40be42a0d98c6a4c83c5c5c26d9cdbf,1,1,0.3333,3.091,0.3333,4,7.17,412,0,Bug Fix,0,0,0,3,0.011858,0.5111,0,0.1704,2,3,0,0.5974,1.8375,2.0,10.69,14.03,1,0,0.1905,1,18.7273,0,10,0,15,0,"Transition to the new rabbitmq Debian package archives.

RabbitMQ announced some time ago that the package archives were moving:
https://www.rabbitmq.com/blog/2025/07/16/debian-apt-repositories-are-moving

The old location is no longer working, so this patch transitions to
the new one.

Closes-Bug: #2131736
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+1, -1)
releasenotes/notes/handle-deprecated-rabbitmq-package-archive-47548e7a41baa68b.yaml (+7, -0)
kolla/template/repos.yaml (+4, -4)
kolla/tests/test_methods.py (+2, -2)
",-1.564082,1.225262,-1.289499,0.416561,-0.817454,0.166814,0.177027,0.011076,-0.211386,-0.042533,-0.026722,0.101785,0.263793,0.636984,0.328276
openstack/kolla-ansible,I9bd8c46b084ff0ffce6c3abce972508fd9d59d69,1,0,0.5,2.3979,0.3,1,5.25,220,0,Feature,0,0,0,4,0.014599,0.6667,1,0.3333,3,1,0,0.5742,0.0,3.0,4.11,19.24,1,0,0.0,0,20.0,0,0,0,0,0,"Drop requirement for blueprints.

Update contributor guide per conversation with Micha≈Ç Nasiadka
(mnasiadka) on IRC.
[SEP]
FILES CHANGED:
doc/source/contributor/contributing.rst (+7, -3)
",1.313903,-0.364652,-0.992794,-0.048572,0.510649,0.453968,0.131236,0.197526,-0.366801,-0.64449,0.250388,0.688467,-0.239645,-0.037174,-1.027276
openstack/kolla-ansible,I810fa1818bb9a0a11f200da2b782c2fde72f3b3a,1,0,1.0,5.1533,0.0058,2,10.0,379,0,Bug Fix,0,0,0,3,0.007874,0.2143,0,0.2143,3,2,0,0.5747,0.0914,2.5,37.64,11.2,0,0,0.0116,1,2.1908,0,0,0,0,0,"Test idempotence of reconfigure command in CI

Idempotence isn't tested in CI and seems to have led to bugs,
especially in podman, where it would just break, and reconfiguring
would restart the entire cluster. Let's test it in CI to ensure
this doesn't happen.
[SEP]
FILES CHANGED:
roles/kolla-ansible-reconfigure/tasks/main.yml (+170, -0)
zuul.d/scenarios/aio.yaml (+1, -1)
",-0.691096,-1.190157,-0.2416,0.684575,0.14884,0.438442,-0.154528,-1.495044,-0.743744,0.247576,0.095644,-0.000914,0.251049,-0.09027,0.363424
openstack/ironic,I1d533b942144680c2622fec63caa092f96e481f5,1,1,1.0,3.7136,0.05,4,11.67,287,0,Bug Fix,0,0,0,10,0.006211,1.0,0,1.0,6,2,0,0.9645,1.8463,4.25,35.46,14.95,0,0,0.725,1,7.0,0,6,0,11,0,"Fail flat driver rebind when no VIFs are bound

Add validation check that raises NetworkError if the bound port list
is empty after attempting to bind all ports.

Closes-Bug: #2131962
[SEP]
FILES CHANGED:
ironic/tests/unit/drivers/modules/network/test_flat.py (+15, -0)
releasenotes/notes/flat-driver-rebind-no-vifs-192c9be8e6962d46.yaml (+6, -0)
ironic/drivers/modules/network/flat.py (+5, -0)
ironic/tests/unit/drivers/modules/test_deploy_utils.py (+12, -2)
",0.445709,-1.829251,-0.626504,-0.080253,-0.284921,0.236561,-0.793677,-0.154627,0.431996,0.051354,-0.073359,-0.026637,0.18375,0.013433,-0.026784
openstack/ansible-collection-kolla,I5a7fde32755018770cc3d2975328a2ca3d0b2c12,1,0,0.4067,3.9318,0.0,4,10.17,523,0,Doc,0,0,0,509,0.01309,0.3333,0,0.1356,3,3,0,0.3953,1.577,2.75,7.9,19.15,0,0,0.0,1,10.2549,0,0,0,0,0,"docker: Configure path in containerd config.toml

In Docker 29 the default storage engine for images is containerd.
In production cases we usually have a separate /var/lib/docker filesystem,
the same happens in Kolla CI when building images.

Let's default to /var/lib/docker

disabled_plugins = ['cri'] is in default configuration for all supported
distributions
[SEP]
FILES CHANGED:
roles/docker/templates/containerd_config.toml.j2 (+7, -0)
roles/docker/defaults/main.yml (+3, -0)
roles/docker/tasks/config.yml (+29, -0)
releasenotes/notes/containerd-path-eb67bbb5aa035be1.yaml (+11, -0)
",-0.390214,-1.430182,-0.158414,0.22242,-0.264325,-0.780005,0.234805,0.310055,-0.444082,-0.007523,-0.307247,-0.709789,0.230038,0.092675,-0.480556
openstack/ironic,Iea150a5c3f147b7e4f8a778510bfc061a14f289a,1,0,0.875,3.1355,0.2727,2,5.36,587,0,Bug Fix,0,0,0,8,0.035556,0.0,0,0.0,2,2,0,0.9647,0.976,2.0,-12.26,16.38,1,0,0.0,1,25.5217,0,0,0,0,0,"Fix singleprocess launcher compatibility with oslo.service 4.4+

The combined Ironic service was passing the no_fork parameter
to ServiceLauncher, which was wrongly mapped to ProcessLauncher [1]

Switch to ProcessLauncher which properly supports no_fork since
oslo.service 4.2.0. This ensures VNC signal handling works correctly
and matches the pattern used by other Ironic services.

[1] https://opendev.org/openstack/oslo.service/commit/0dfdf810acdf9aec6dc4fb8339a171535fe8bbc1
[SEP]
FILES CHANGED:
releasenotes/notes/oslo-service-no-fork-compatibility-d5e45f9adeefa7b4.yaml (+13, -0)
ironic/command/singleprocess.py (+3, -6)
",-1.618221,0.65745,0.319774,-0.421768,0.133098,-0.162979,0.67655,0.594211,0.115623,0.295048,0.321362,-0.032212,-0.279971,-0.161503,0.024121
openstack/oslo.db,I566845addbe8818f993ef57b093d86d2eda6e39e,0,0,1.0,4.0775,0.7414,5,7.0,306,0,Feature,0,0,1,10,0.011364,0.3623,0,0.3623,3,2,0,0.5,2.0475,2.2,44.63,11.37,1,0,0.569,0,5.1864,0,0,0,0,0,"Bump SQLAlchemy minimum

SQLAlchemy 2.x has been out for long enough now that it is reasonable to
bump our min version and remove all of the compat logic we were having
to carry to support 1.4.x.
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
oslo_db/tests/sqlalchemy/test_sqlalchemy.py (+4, -10)
oslo_db/sqlalchemy/exc_filters.py (+2, -4)
oslo_db/tests/sqlalchemy/test_exc_filters.py (+8, -11)
oslo_db/sqlalchemy/compat/__init__.py (+0, -17)
",0.34491,-1.324532,0.135874,0.222481,-0.1684,0.198269,0.141249,-0.189675,-0.915843,1.13433,-0.412614,0.370701,-0.766627,-0.316714,0.854631
openstack/kolla-ansible,Id71c82a557745f9b47ea92a5eeecf1d859719821,1,0,0.4078,1.0986,0.0,2,5.67,184,0,CI,0,0,0,510,0.013099,0.0,0,0.0,3,1,0,0.5751,1.0,3.0,-2.95,16.38,0,0,0.0,0,61.3333,0,0,0,0,0,"CI: Bump tempest compute.build_timeout to 900s

It's often failing with 300s
[SEP]
FILES CHANGED:
roles/kolla-ansible-tempest/tasks/main.yml (+1, -0)
roles/kolla-ansible-tempest/defaults/main.yml (+1, -0)
",1.106424,-0.188419,-1.005137,0.009151,-0.060847,0.60661,-0.418293,-0.786383,-0.534741,0.227017,0.556948,-0.361272,-0.283682,0.168325,-0.057152
openstack/ansible-collection-kolla,I92c53b1c3f2695430e8f66b4add2ab7c070c7895,0,0,0.409,4.2767,0.5211,11,4.5,141,0,Bug Fix,0,0,0,511,0.013124,0.6667,0,0.2727,3,2,0,0.4091,3.1494,2.45,-79.73,32.91,0,0,0.0,0,1.9583,0,0,0,0,0,"ansible-lint: Fix key-order[task]
[SEP]
FILES CHANGED:
roles/podman/tasks/install.yml (+5, -5)
.gitignore (+3, -0)
roles/docker/tasks/install.yml (+7, -7)
roles/podman_sdk/tasks/main.yml (+1, -2)
roles/docker_sdk/tasks/main.yml (+1, -2)
roles/baremetal/tasks/install.yml (+2, -2)
roles/docker_sdk/tasks/install.yml (+4, -4)
roles/podman_sdk/tasks/install.yml (+5, -5)
roles/etc_hosts/tasks/etc-hosts.yml (+1, -1)
roles/baremetal/tasks/configure-ceph-for-zun.yml (+5, -7)
.ansible-lint (+0, -2)
",2.828804,1.41229,0.863295,-0.29908,-0.346874,-1.412216,-0.967238,-0.366121,0.759989,0.810165,-0.116113,0.040521,-0.144031,0.117045,-0.638297
openstack/kolla-ansible,Ia143504d523e1593543a1214f8cc955c3f2a9a10,1,1,0.5,2.1972,0.0,2,6.2,344,0,Bug Fix,0,0,0,4,0.072727,0.0,0,0.0,4,2,0,0.5755,0.8113,3.0,-34.15,17.96,1,0,0.0,1,38.2222,0,6,0,3,0,"Fixed kolla_externally_managed_cert behaviour

With ``kolla_externally_managed_cert`` enabled, certificates and keys
shouldn't be managed by kolla, but ProxySQL is copied over currently.
This change fixes that.

Closes-Bug: #2131993
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/copy-certs.yml (+2, -0)
releasenotes/notes/bug-2131993-d67c68845ddf5556.yaml (+6, -0)
",-0.410741,0.149298,-0.818169,0.465264,0.289123,0.637639,-0.794722,-0.513878,-0.117429,-0.236622,0.467973,-0.614632,-0.293458,-0.331759,0.386216
openstack/ansible-collection-kolla,Idfbcfa8e9fc157c691ea30ebc5b6235ac4c3b436,0,0,0.4082,6.1092,0.49,31,4.5,150,0,Bug Fix,0,0,0,512,0.013126,0.5,0,0.2041,3,2,0,0.4,4.4176,2.9,-117.33,32.91,0,0,0.0,0,0.3333,0,0,0,0,0,"ansible-lint: Fix fqcn[action/action-core]
[SEP]
FILES CHANGED:
roles/podman/tasks/install.yml (+10, -7)
roles/docker/tasks/install.yml (+16, -15)
roles/podman/tasks/config.yml (+8, -8)
roles/baremetal/tasks/pre-install.yml (+1, -1)
roles/podman_sdk/tasks/uninstall.yml (+1, -1)
roles/baremetal/tasks/configure-ceph-for-zun.yml (+10, -10)
roles/baremetal/tasks/post-install.yml (+13, -13)
roles/podman/tasks/main.yml (+2, -2)
roles/docker/tasks/repo-RedHat.yml (+6, -6)
roles/etc_hosts/tasks/main.yml (+1, -1)
roles/docker_sdk/tasks/main.yml (+2, -2)
roles/apparmor_libvirt/tasks/remove-profile.yml (+6, -5)
roles/baremetal/tasks/install.yml (+6, -5)
roles/docker/tasks/config.yml (+32, -31)
roles/kolla_user/tasks/main.yml (+8, -8)
roles/podman/tasks/uninstall.yml (+9, -7)
roles/docker/tasks/uninstall.yml (+12, -10)
.ansible-lint (+0, -3)
roles/docker/tasks/repo-Debian.yml (+15, -16)
roles/docker/tasks/configure-containerd-for-zun.yml (+10, -10)
roles/packages/tasks/main.yml (+4, -4)
roles/podman/handlers/main.yml (+2, -1)
roles/podman_sdk/tasks/main.yml (+2, -2)
roles/apparmor_libvirt/tasks/main.yml (+1, -1)
roles/docker/handlers/main.yml (+5, -5)
roles/docker/tasks/main.yml (+1, -1)
roles/docker_sdk/tasks/install.yml (+18, -19)
roles/docker_sdk/tasks/uninstall.yml (+1, -1)
roles/podman_sdk/tasks/install.yml (+14, -12)
roles/etc_hosts/tasks/etc-hosts.yml (+8, -8)
roles/baremetal/tasks/main.yml (+5, -5)
",2.116076,1.481799,0.275009,-0.54454,0.186746,-1.775929,-0.834677,-0.269314,0.207947,0.433474,-0.058191,0.082289,0.037547,-0.169105,-0.620357
openstack/ansible-role-systemd_networkd,I675b1fa82bbeba49cac718d9b5e2c0b87c9b1560,1,0,0.96,3.1781,0.0,1,3.33,142,0,Feature,0,0,0,250,0.053706,0.0,0,0.0,1,1,0,1.0,0.0,1.0,-84.19,21.33,1,0,0.0,0,5.9167,0,0,0,0,0,"Add Debian 13 support
[SEP]
FILES CHANGED:
vars/debian-13.yml (+23, -0)
",4.363761,2.247166,2.631154,0.137448,0.129711,1.517226,0.85613,0.807252,0.003427,0.523252,-0.353469,0.159156,0.898838,-0.27956,0.464017
openstack/charm-keystone,Id5c8df46429d009f19518ac78db576f9fdd6ed27,1,1,1.0,4.0431,0.0357,7,6.29,388,0,Bug Fix,0,0,0,3,0.007463,1.0,0,1.0,2,3,0,1.0,2.6786,1.57,12.03,12.51,1,0,0.0,1,6.807,0,58,0,102,0,"Add cadf audit middleware logging

Enables audit logging for keystone in cadf format. This feature
is enabled with the 'audit-middleware' config option and the
audit results are written to /var/log/keystone/keystone.log.
This option is disabled by default.

Closes-bug: 1856555
[SEP]
FILES CHANGED:
templates/queens/keystone.conf (+7, -0)
templates/ocata/logging.conf (+17, -0)
templates/rocky/keystone.conf (+7, -0)
hooks/keystone_utils.py (+4, -2)
config.yaml (+5, -0)
templates/caracal/keystone.conf (+7, -0)
templates/epoxy/keystone.conf (+7, -0)
",-0.712279,0.140947,-0.97877,1.043657,-0.030333,-0.337263,-0.068189,0.312926,0.485491,-0.113413,0.026017,-0.151104,0.170885,-0.078023,-0.143469
openstack/ironic,Ib803c066ca28d1c05a345b7a982a0daabbd7d52e,1,1,1.0,3.4965,0.0625,5,14.4,498,0,Bug Fix,0,0,0,2,0.025974,1.0,0,1.0,4,2,0,0.9649,2.2503,3.0,37.12,15.2,0,0,0.3438,1,15.0909,0,16,0,28,0,"fix: glance image member lookup resulted in an empty list always

The code did not initialize a client so it resulted in an exception
always occurring. It also used the image attribute on the client
attribute of the service but the client attribute of the service is
already the image attribute. Create a wrapper method to use the API
correctly and prevent similar issues.

Closes-Bug: #2099276
[SEP]
FILES CHANGED:
ironic/tests/unit/stubs.py (+5, -0)
releasenotes/notes/glance-image-members-ce4cca3e764d60fd.yaml (+7, -0)
ironic/common/glance_service/image_service.py (+10, -0)
ironic/common/glance_service/service_utils.py (+2, -2)
ironic/tests/unit/common/test_glance_service.py (+6, -0)
",0.34854,-2.294473,0.483229,0.144977,-0.753049,0.199444,0.708084,-0.287527,0.453908,0.154607,0.101422,-0.195149,0.120024,0.011158,0.216045
openstack/kolla-ansible,If202d1a6c848515236e44664af8407dda8441328,1,1,0.4074,1.0986,0.0,1,11.0,357,0,Bug Fix,0,0,0,513,0.013002,0.2308,0,0.094,1,1,0,0.576,0.0,1.0,36.08,14.4,0,0,0.0,0,119.0,0,8,0,5,0,"fluentd: Fix running with enable_fluentd: no

Since we broken out fluentd to it's own role - we removed the when
guards that checked for enable_fluentd inside the role.
That has effectively broken running with fluentd disabled.

Closes-Bug: #2132288
[SEP]
FILES CHANGED:
ansible/site.yml (+2, -0)
",0.052037,-1.018135,-0.471604,-0.042668,-0.221081,0.277764,-0.268344,-0.507169,-0.464921,-0.112029,0.352737,-0.300432,0.107023,-0.169684,0.600098
openstack/kolla-ansible,I20e8571464e20ea0e0981a52db3182402ff8f01c,1,0,0.4086,0.6931,0.0,1,4.33,144,0,CI,1,0,0,514,0.013027,0.3962,0,0.1619,1,1,0,0.5764,0.0,1.0,-12.32,20.19,0,0,1.0,1,72.0,0,0,0,0,0,"CI: Add site.yml to all jobs trigger
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -0)
",3.065756,1.333461,1.300794,0.600865,0.77864,-0.088207,0.19041,-0.096317,0.013333,0.161818,-0.196475,-0.924176,-0.177805,0.672456,-0.277221
openstack/openstack-ansible-rabbitmq_server,I826fec7febe3bda5748a0e90fa80fdb8586d63ac,1,0,0.9602,1.6094,0.5,1,7.8,358,0,Feature,0,0,0,251,0.053655,1.0,0,0.9602,1,1,0,0.8824,0.0,1.0,-11.5,16.45,0,0,0.0,0,71.6,0,0,0,0,0,"Use correct variable for erlang repo defenition

Current code de-facto ignores rabbitmq_erlang_install_method variable
value for debian-based distros.
We need to use it for erlang repo installation, otherwise it may lead
to role failure.
[SEP]
FILES CHANGED:
vars/debian.yml (+2, -2)
",0.87868,-1.155752,-0.382926,0.393695,0.085943,-0.271256,0.21386,-0.255141,-0.135814,-0.634463,-0.079587,-0.21053,-0.236828,-0.408805,-0.124804
openstack/ansible-collection-kolla,I61937e1fae870d126b27e15a75a47a4643fb5b8c,1,1,0.6301,2.1972,0.25,1,8.0,174,0,Bug Fix,0,0,0,73,0.058824,0.4,0,0.2521,3,1,0,0.3913,0.0,3.0,-2.21,15.7,0,0,0.0,0,19.3333,0,6,0,9,0,"Handle empty docker system info in check mode

Closes-Bug: #2132335
[SEP]
FILES CHANGED:
roles/docker/tasks/config.yml (+6, -2)
",2.256043,-0.452196,-0.49599,-0.996729,-0.79466,0.807916,-0.512881,0.276302,0.183277,-0.541746,0.650874,-0.299009,0.404515,-0.075613,0.05284
openstack/ansible-collection-kolla,I88eb0c80e7c7a7d0f75e44a04f0241499a78bf58,0,0,0.2571,1.0986,0.5,1,3.43,374,0,Feature,0,0,0,35,0.19774,0.0,1,0.0,2,1,0,0.4043,0.0,2.0,-131.52,18.04,1,0,0.0,0,124.6667,0,0,0,0,0,"reno: Update master for unmaintained/2024.1

Update the 2024.1 release notes configuration to build from
unmaintained/2024.1.

Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/change_reno_branch_to_unmaintained.sh
[SEP]
FILES CHANGED:
releasenotes/source/2024.1.rst (+1, -1)
",-1.489926,2.22097,-1.359425,0.737517,0.273237,-0.612246,-0.0094,0.490164,0.186155,-0.116048,-0.259022,-0.009303,0.007721,0.821426,0.367786
openstack/kayobe,I0fa9799895a3721e41da724fb495d44bf19aa476,0,0,0.25,1.0986,0.5,1,3.43,374,0,Feature,0,0,0,36,0.201117,0.0,1,0.0,2,1,0,0.8963,0.0,2.0,-127.99,18.04,1,0,0.0,0,124.6667,0,0,0,0,0,"reno: Update master for unmaintained/2024.1

Update the 2024.1 release notes configuration to build from
unmaintained/2024.1.

Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/change_reno_branch_to_unmaintained.sh
[SEP]
FILES CHANGED:
releasenotes/source/2024.1.rst (+1, -1)
",-1.489926,2.22097,-1.359425,0.737517,0.273237,-0.612246,-0.0094,0.490164,0.186155,-0.116048,-0.259022,-0.009303,0.007721,0.821426,0.367786
openstack/kolla-ansible,I221e2882a763103a56a995c81c8acf91c6326666,0,0,0.2432,1.0986,0.5,1,3.43,374,0,Feature,0,0,0,37,0.20442,0.0,1,0.0,2,1,0,0.5768,0.0,2.0,-127.99,18.04,1,0,0.0,0,124.6667,0,0,0,0,0,"reno: Update master for unmaintained/2024.1

Update the 2024.1 release notes configuration to build from
unmaintained/2024.1.

Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/change_reno_branch_to_unmaintained.sh
[SEP]
FILES CHANGED:
releasenotes/source/2024.1.rst (+1, -1)
",-1.489926,2.22097,-1.359427,0.737518,0.273237,-0.612246,-0.009401,0.490164,0.186155,-0.116047,-0.259023,-0.009303,0.007722,0.821426,0.367787
openstack/kolla,Id395efcfe0381340318c3bf27090a8f8fc2e9bfe,0,0,0.2368,1.0986,0.5,1,3.43,374,0,Feature,0,0,0,38,0.20765,0.0,1,0.0,2,1,0,0.5983,0.0,2.0,-124.47,18.04,1,0,0.0,0,124.6667,0,0,0,0,0,"reno: Update master for unmaintained/2024.1

Update the 2024.1 release notes configuration to build from
unmaintained/2024.1.

Generated-By: openstack/project-config:roles/copy-release-tools-scripts/files/release-tools/change_reno_branch_to_unmaintained.sh
[SEP]
FILES CHANGED:
releasenotes/source/2024.1.rst (+1, -1)
",-1.489926,2.22097,-1.359427,0.737518,0.273237,-0.612246,-0.009401,0.490164,0.186155,-0.116047,-0.259023,-0.009303,0.007722,0.821426,0.367787
openstack/ironic,Ibaf1486da9510fdad479523159797815e783e5f6,1,0,1.0,2.9444,0.2778,3,20.33,404,0,Bug Fix,0,0,0,3,0.027523,1.0,0,1.0,4,2,0,0.9651,1.542,2.67,43.35,16.0,0,0,0.2222,1,21.2632,0,0,0,0,0,"fix: use the correct path to the image when deep image inspection is off

When deep image inspection is disabled, the incorrect path was used to
determine the image format of the file resulting in a no such file or
directory exception which bubbled up and made it appear as if the cache
was missing.
[SEP]
FILES CHANGED:
ironic/tests/unit/common/test_images.py (+2, -2)
ironic/common/images.py (+4, -3)
releasenotes/notes/bug-disable-deep-image-inspection-bfd44bb8307dea1a.yaml (+7, -0)
",0.114235,-2.076044,0.276353,0.796194,-0.062519,0.046209,0.612878,-0.796636,0.112203,0.081042,-0.186336,-0.065369,0.136083,0.161759,0.046729
openstack/kolla-ansible,I4099b338b0d16bedf5731a3a63eeaad27a321d9b,0,0,0.4097,2.3979,0.6,4,4.5,157,0,Bug Fix,0,0,0,515,0.013052,1.0,0,0.4097,4,2,0,0.5763,1.9219,3.0,-145.53,32.91,1,0,0.0,0,14.2727,0,0,0,0,0,"ansible-lint: Fix command-instead-of-module/shell
[SEP]
FILES CHANGED:
ansible/roles/valkey/tasks/upgrade.yml (+2, -2)
ansible/roles/loadbalancer/tasks/config_validate.yml (+1, -1)
ansible/roles/valkey/tasks/check.yml (+1, -1)
.ansible-lint (+0, -2)
",2.02824,2.140011,0.745526,-0.238589,-0.459728,-1.895787,-0.734235,-0.700354,0.368364,0.149297,-0.62424,0.746088,0.360574,0.447652,0.483764
openstack/kolla-ansible,I3914252b2d884349b9744d229406cf49d691ebec,0,0,0.4089,2.7081,0.2857,7,4.5,133,0,Bug Fix,0,0,0,516,0.013074,0.4444,0,0.1817,4,2,0,0.5757,2.4138,3.0,-51.53,28.47,1,0,0.0,0,8.8667,0,0,0,0,0,"ansible-lint: Fix risky-*
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/generate-backend.yml (+4, -2)
ansible/roles/octavia-certificates/tasks/main.yml (+2, -0)
ansible/roles/mariadb/tasks/recover_cluster.yml (+1, -0)
ansible/roles/octavia/tasks/hm-interface.yml (+1, -0)
tools/setup-compute-libvirt.yml (+1, -0)
.ansible-lint (+0, -2)
ansible/roles/hacluster/tasks/bootstrap.yml (+1, -0)
",3.439643,1.427978,1.067786,-0.849855,-1.265502,-1.500012,-1.068814,-0.389064,0.742227,0.972604,0.254922,0.161868,0.53213,-0.044601,0.077809
openstack/kolla-ansible,I4f021289faa790b733d95532f6d837c3f724cf0b,0,0,0.4081,1.0986,1.0,1,5.0,148,0,Feature,0,0,0,517,0.013094,0.0,0,0.0,0,1,0,0.5751,0.0,0.0,-60.5,30.0,1,0,0.0,0,49.3333,0,0,0,0,0,"ansible-lint: Remove role-name exception
[SEP]
FILES CHANGED:
.ansible-lint (+0, -2)
",3.373614,1.385046,1.073022,-0.04066,-0.461431,-1.539666,-0.393904,-0.268848,1.18351,0.427489,-0.155401,0.540479,0.05416,0.363136,-0.231974
openstack/ironic,I877a7da4ed41bceb9f6f4ee229e8e9dc938d9e5b,1,0,1.0,4.2767,0.5634,3,12.0,268,0,Bug Fix,0,0,0,4,0.031496,1.0,0,1.0,4,2,0,0.9653,1.2875,2.67,37.21,11.47,0,0,0.6056,1,3.7222,0,0,0,0,0,"fix: do not allow nested paths in loader_file_paths

The intention was not to allow nested paths here but instead to only use
base paths to files we will serve up.
[SEP]
FILES CHANGED:
releasenotes/notes/bootloader-file-path-f452a580f2d11e1b.yaml (+7, -0)
ironic/common/pxe_utils.py (+10, -11)
ironic/tests/unit/common/test_pxe_utils.py (+14, -29)
",1.121993,-1.41677,-0.071308,0.844766,0.190172,-0.212045,0.202797,-1.136848,-0.573277,0.026825,-0.437583,-0.49913,-0.137057,-0.30464,-0.193806
openstack/ironic,Iaf756f634832310431020abd758b59c749aecb21,1,0,1.0,4.8203,0.4472,3,10.89,668,0,Bug Fix,0,0,0,5,0.025253,1.0,0,1.0,4,2,0,0.9655,1.1392,2.67,56.8,10.89,0,0,0.626,1,5.3871,0,0,0,0,0,"fix: ensure that the bootloader path exists

Ensure that the path where we are copying the bootloader into exists
before we copy the file in. Unfortunately the existing code wouldn't
work in the intended case because os.path.split(""snponly.efi"") returns
("""", ""snponly.efi"") so we would never pass the first check so we would
not create the path. This keeps the same behavior of allowing a nested
path structure to not change the behavior so that this can be
backportable while fixing the issue and switching the pathlib to provide
a safer interface going forward.
[SEP]
FILES CHANGED:
releasenotes/notes/bootloader-paths-creation-b5097003f25a18ad.yaml (+5, -0)
ironic/common/pxe_utils.py (+20, -21)
ironic/tests/unit/common/test_pxe_utils.py (+43, -34)
",-1.346962,-1.754113,0.852133,0.256902,-0.099996,-0.158853,0.58417,-0.724059,-0.182739,0.387098,0.155023,-0.164239,-0.215267,0.142494,0.260227
openstack/kolla,I60de8ef452adad4a9b0d974a2678264b91eb6e3b,1,0,0.4073,1.7918,1.0,1,4.67,145,0,Feature,0,0,0,518,0.013119,0.5,0,0.2037,2,1,0,0.5969,0.0,2.0,-21.49,16.15,0,0,0.0,0,24.1667,0,0,0,0,0,"rocky: Remove EPEL hack - 10.1 is out
[SEP]
FILES CHANGED:
docker/base/Dockerfile.j2 (+0, -5)
",2.601035,0.592673,0.432678,-0.716595,-0.698574,0.485108,-0.456057,0.238739,-0.751317,1.005148,0.373728,0.020454,-0.104588,0.039087,0.231453
openstack/kolla-ansible,Id190c6e61c203a5e600fcd05760dea698ec4c5cf,1,1,1.0,3.1355,0.0,2,6.5,163,0,Bug Fix,0,0,0,6,0.086957,0.6667,0,0.6667,4,2,0,0.5745,0.9024,3.0,-34.04,24.14,1,0,0.0,1,7.087,0,0,0,0,0,"Fix for opensearch plugin timeout

Closes-Bug: #2049209
[SEP]
FILES CHANGED:
ansible/roles/opensearch/tasks/post-config.yml (+15, -0)
releasenotes/notes/bug-2049209-opensearch_plugin_timeout-d79d03769de093bd.yaml (+7, -0)
",2.47749,0.600675,0.252329,-1.349303,-0.703142,1.033866,-0.629455,0.313094,0.290553,-0.438656,0.64365,-0.233069,0.246902,-0.47945,0.735685
openstack/openstack-ansible-haproxy_server,I72101fed2919014bbebbaf4323f72decbea8a638,1,0,0.878,1.0986,0.0,1,6.33,301,0,Feature,0,0,0,41,0.174468,1.0,0,0.878,1,1,0,0.9286,0.0,1.0,26.75,10.95,0,0,0.0,0,100.3333,0,0,0,0,0,"Reload haproxy when static files are changed

If the content of any static files are changed, haproxy must be
reloaded in order for them to be served rather than the previous
versions.
[SEP]
FILES CHANGED:
tasks/haproxy_pre_install.yml (+2, -0)
",0.030034,-0.679125,-0.245882,1.304174,0.339871,0.065702,-0.227935,-0.731889,0.01272,0.188153,-0.703781,0.174629,-0.046639,0.05343,-0.257287
openstack/kolla-ansible,I4f153a619eb57a75ebdb1aba4b71e422b30d74fe,1,0,0.4085,2.3026,0.3333,1,9.25,315,0,Doc,0,0,0,519,0.013143,0.0,1,0.0,3,1,0,0.5749,0.0,3.0,16.81,14.51,0,0,0.0,0,31.5,0,0,0,0,0,"docs: when reno is required

In Zed PTG we decided to limit the amount of release notes
this change adds the criteria when reno is required to the docs

[1]: https://etherpad.opendev.org/p/kolla-zed-ptg#L149
[SEP]
FILES CHANGED:
doc/source/contributor/release-notes.rst (+6, -3)
",-0.761608,1.502038,-1.052561,0.509756,-0.887417,0.332596,-0.081425,-0.384309,0.249593,0.063586,-0.20313,-0.070093,-0.044107,-0.018668,-0.252989
openstack/kolla-ansible,I0a7f27fb3a6239890aa1b4d8d1a149113d8ee203,0,0,0.4096,4.0943,0.0678,5,7.0,219,0,Feature,0,0,0,520,0.013165,0.5,0,0.2048,4,3,0,0.5754,1.9086,3.6,-1.7,16.13,1,0,0.0,1,3.65,0,0,0,0,0,"magnum: Switch to use uWSGI and add support for backend TLS
[SEP]
FILES CHANGED:
ansible/roles/magnum/templates/magnum-api.json.j2 (+20, -2)
ansible/roles/magnum/tasks/config.yml (+18, -0)
ansible/roles/magnum/defaults/main.yml (+12, -2)
releasenotes/notes/uwsgi-magnum-6702c72f30286978.yaml (+4, -0)
ansible/roles/magnum/templates/magnum.conf.j2 (+1, -0)
",2.057574,0.12079,1.0832,0.133765,0.128985,-0.129864,0.035888,0.328595,-0.336608,0.741771,-0.199631,0.155698,-0.079152,-0.804445,0.620937
openstack/kolla-ansible,I61fc50654fb06e041776fd394f6b1cab2f9903ba,1,1,1.0,4.654,0.0577,2,13.17,634,0,Bug Fix,0,0,0,4,0.007233,0.5,0,0.5,2,1,0,0.5748,0.9306,2.0,12.49,16.91,0,0,0.6538,0,6.0381,1,6,0,5,0,"Fix idempotence on comparing capabilities for podman

Currently, we add the AUDIT_WRITE capability for all unprivileged
podman containers. This causes a diff because the cap is popped from
params before comparing with the running container's actual values.
This patch fixes it by overriding compare_cap_add() to normalize
capability formats and account for auto-added AUDIT_WRITE, while
working around a bug in older Podman versions where AUDIT_WRITE
doesn't appear in the inspect API response.

Closes-bug: #2133434
[SEP]
FILES CHANGED:
tests/kolla_container_tests/test_podman_worker.py (+62, -6)
ansible/module_utils/kolla_podman_worker.py (+36, -0)
",-1.372998,-1.05311,0.265237,0.382162,0.24263,-0.03579,-0.193789,-0.169522,0.162931,0.033182,0.217979,-0.228571,0.354662,-0.423488,0.156889
openstack/kolla-ansible,I128f7cab52818d369ee7d3252d81383cf49eca97,1,1,1.0,1.6094,0.5,2,9.8,480,0,Bug Fix,0,0,0,5,0.00761,0.6667,0,0.6667,5,2,0,0.5752,1.0,4.5,-8.57,16.16,0,0,0.0,0,96.0,1,6,0,6,0,"Fix variable name typo in haproxy single external frontend

The loadbalancer role used haproxy_external_single_frontend_public_port
(hardcoded to 443) instead of haproxy_single_external_frontend_public_port
(smart default based on TLS setting). This broke HTTP-only deployments where
services expected port 80 but haproxy bound to port 443.

Closes-bug: #2133456
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/templates/haproxy/haproxy_external_frontend.cfg.j2 (+1, -1)
ansible/roles/loadbalancer/defaults/main.yml (+1, -1)
",-0.621944,-0.462777,-0.531077,0.341794,0.743257,-0.058894,-0.184738,0.243959,0.008989,-0.425343,0.474333,-0.515813,-0.054083,-0.238271,0.184681
openstack/ironic,I177740dd3a8558ed357af22c581e5cbf1c3e862a,1,1,1.0,4.3567,0.1169,3,9.33,266,0,Bug Fix,0,0,0,11,0.006667,1.0,0,1.0,4,2,0,0.9657,1.3679,3.0,13.05,18.02,1,0,0.5455,1,3.4103,1,6,0,3,0,"`is-empty` inspection rule to handle missing field

Pass the ``is-empty`` rule check when checking fields that don't
exist in the inventory.

Closes-Bug: #2132346
[SEP]
FILES CHANGED:
releasenotes/notes/is-empty-inspection-rule-missing-field-3c489a9b71c47538.yaml (+9, -0)
ironic/common/inspection_rules/base.py (+17, -9)
ironic/tests/unit/common/test_inspection_rule.py (+42, -0)
",0.437578,-0.203429,-0.622772,0.264509,0.06714,0.379749,-0.563486,-0.703136,0.486331,-0.101975,-0.01736,-0.127104,0.40865,-0.085822,0.257787
openstack/kolla-ansible,Ia5ad5a92c2f1f3a9197e2f6f078c97ccbe95b445,0,0,0.4088,1.6094,0.5,1,4.0,152,0,Bug Fix,0,0,0,521,0.013171,0.0,0,0.0,4,1,0,0.5756,0.0,4.0,-58.08,24.93,0,0,0.0,0,30.4,0,0,0,0,0,"designate: Fix config.yml after truthy fixes
[SEP]
FILES CHANGED:
ansible/roles/designate/tasks/config.yml (+2, -2)
",2.111438,1.566659,0.999541,0.65063,0.600948,0.07233,-0.291698,-0.527927,-0.276474,0.600362,0.009677,-0.614554,-0.308449,0.056977,-0.05082
openstack/kolla,I395fcae7fd39ea7488191690f994ad98a8184f65,1,0,0.408,1.6094,1.0,1,11.0,289,0,Feature,0,0,0,522,0.013194,0.3333,0,0.136,3,1,0,0.5978,0.0,3.0,5.96,21.37,0,0,0.0,0,57.8,0,0,0,0,0,"manila: Stop enabling kolla_el10 COPR repo

This repo enablement is here by mistake, the glusterfs-fuse
package installation has been removed in the original
CentOS Stream 10 patch.
[SEP]
FILES CHANGED:
docker/manila/manila-share/Dockerfile.j2 (+0, -4)
",0.790785,-1.973632,-0.481743,-0.616882,-0.488939,-0.151141,-0.435448,0.380972,-0.698653,-0.489578,0.167341,0.382205,-0.383032,-0.10466,0.351417
openstack/kolla,I8fa363e7e9bc87195adaf218c46d6e9fb4575419,1,0,0.4092,1.7918,0.8,1,6.5,152,0,Feature,0,0,0,523,0.013218,0.0,0,0.0,2,1,0,0.5987,0.0,2.0,-27.53,17.98,0,0,0.0,0,25.3333,0,0,0,0,0,"mariadb: Switch EL to mariadb upstream repos
[SEP]
FILES CHANGED:
docker/mariadb-server/Dockerfile.j2 (+1, -4)
",0.842018,2.063315,-0.247823,0.623125,1.793354,-0.147422,-0.052524,0.238255,-1.268824,-0.151181,0.452419,0.122759,-0.431512,-0.638391,-0.153391
openstack/octavia-dashboard,I9a7f72fa8f95fe56a95216b72f7c1d7542cfcbcc,1,0,1.0,1.0986,0.0,1,12.33,292,0,Feature,0,0,0,1,0.012821,0.2857,0,0.2857,3,1,0,0.3889,0.0,3.0,31.98,14.66,0,0,0.0,0,97.3333,0,0,0,0,0,"Optimize empty loadbalancer page

do not ask for list of floating IPs if there's no LBs,
no need for (potentially costly) API calls
when the result will be thrown out anyway.
[SEP]
FILES CHANGED:
octavia_dashboard/api/rest/lbaasv2.py (+2, -0)
",0.952187,-2.121888,0.535844,0.298261,-0.206174,-0.080097,0.142345,-1.011776,-0.368387,-0.060768,-0.641713,-0.212046,0.083354,-0.182891,-0.251566
openstack/kolla,Ic40fecb87dd3eaf67eb1d3088978d462ff5b4320,0,0,0.4103,4.8203,0.9187,12,8.0,174,0,Feature,0,0,0,524,0.013242,0.75,0,0.3077,3,6,0,0.5996,2.8919,2.25,-18.07,20.7,0,0,0.0,1,1.4032,0,0,0,0,0,"redis: Drop redis and redis-sentinel images

We switched to Valkey
[SEP]
FILES CHANGED:
README.rst (+1, -1)
releasenotes/notes/drop-redis-d286ca1237747c48.yaml (+4, -0)
docker/redis/redis-sentinel/extend_start.sh (+0, -32)
kolla/common/config.py (+2, -2)
kolla/common/users.py (+1, -1)
doc/source/matrix_x86.csv (+1, -1)
docker/redis/redis-sentinel/Dockerfile.j2 (+0, -25)
docker/redis/redis-base/Dockerfile.j2 (+0, -17)
kolla/image/unbuildable.py (+0, -2)
doc/source/matrix_aarch64.csv (+1, -1)
docker/redis/redis/Dockerfile.j2 (+0, -22)
docker/redis/redis-base/extend_start.sh (+0, -9)
",2.184955,-0.522064,-0.494516,0.039534,0.090979,0.07743,0.03092,0.106205,-0.911406,-0.249911,0.347104,0.080669,0.034711,0.331932,-0.513965
openstack/kolla-ansible,I676f8d3c4cc446d7dd65239c0363e4d362662b0d,0,0,0.4095,4.1744,0.0469,32,4.5,141,0,Bug Fix,0,0,0,525,0.013226,1.0,0,0.4095,4,2,0,0.5751,4.6812,3.88,-60.93,28.47,0,0,0.0,0,2.1692,0,0,0,0,0,"ansible-lint: Fix no-changed-when
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/upgrade.yml (+2, -0)
ansible/roles/prometheus/tasks/config_validate.yml (+1, -0)
ansible/roles/bifrost/tasks/stop.yml (+1, -0)
ansible/roles/valkey/tasks/upgrade.yml (+5, -0)
ansible/roles/keystone/tasks/distribute_fernet.yml (+1, -0)
ansible/roles/etcd/tasks/remove_deleted_members.yml (+1, -0)
ansible/roles/nova-cell/handlers/main.yml (+1, -0)
ansible/roles/ovn-db/tasks/bootstrap-db.yml (+2, -0)
ansible/roles/mariadb/tasks/upgrade.yml (+2, -0)
ansible/roles/keystone/tasks/register_identity_providers.yml (+9, -0)
ansible/roles/prune-images/tasks/prune_images.yml (+1, -0)
ansible/roles/nova-cell/tasks/libvirt-cleanup.yml (+1, -0)
ansible/roles/nova/tasks/refresh_scheduler_cell_cache.yml (+1, -0)
ansible/roles/ovs-dpdk/tasks/config.yml (+2, -0)
ansible/roles/ovn-db/tasks/bootstrap-initial.yml (+2, -0)
ansible/roles/loadbalancer/tasks/config_validate.yml (+1, -0)
ansible/roles/neutron/tasks/rolling_upgrade.yml (+1, -0)
ansible/roles/bifrost/tasks/bootstrap.yml (+3, -0)
ansible/roles/container-engine-migration/tasks/ovs-cleanup.yml (+2, -0)
ansible/roles/rabbitmq/tasks/remove-ha-all-policy.yml (+1, -0)
ansible/roles/zun/handlers/main.yml (+1, -0)
ansible/roles/rabbitmq/tasks/reset-state.yml (+4, -0)
ansible/roles/etcd/tasks/bootstrap_services.yml (+1, -0)
ansible/roles/designate/tasks/update_pools.yml (+1, -0)
ansible/roles/rabbitmq/tasks/restart_services.yml (+2, -0)
ansible/roles/mariadb/tasks/recover_cluster.yml (+2, -0)
ansible/roles/hacluster/tasks/bootstrap_service.yml (+2, -0)
ansible/roles/ironic/tasks/upgrade.yml (+3, -0)
.ansible-lint (+0, -3)
ansible/roles/container-engine-migration/tasks/migrate-volumes.yml (+1, -0)
ansible/roles/bifrost/tasks/deploy-servers.yml (+2, -0)
ansible/roles/octavia/tasks/hm-interface.yml (+2, -0)
",1.817466,3.394154,0.36822,0.03894,-0.805825,-1.403178,-1.27165,-1.13922,0.965483,1.012337,0.172938,0.797597,0.617498,0.20088,0.334131
openstack/kolla-ansible,Ifc788b1f3f4fee23745e4a88bba208ff21366263,0,0,0.4087,2.7081,0.5714,5,6.5,164,0,Feature,0,0,0,526,0.01323,0.2,0,0.0817,4,2,0,0.5745,2.1281,3.2,-53.56,30.29,0,0,0.0,0,10.9333,0,0,0,0,0,"ansible-lint: Add noqa to existing no-handler violations
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/bootstrap.yml (+1, -1)
ansible/roles/nova/tasks/map_cell0.yml (+1, -1)
ansible/roles/bifrost/tasks/reconfigure.yml (+1, -1)
ansible/roles/octavia/tasks/hm-interface.yml (+3, -3)
.ansible-lint (+0, -2)
",2.515839,-0.072575,0.967744,-0.195912,-0.315998,-1.432029,-0.658446,-0.168513,0.979141,0.686542,-0.201316,0.513038,0.201512,-0.364475,0.006377
openstack/kolla-ansible,I7b9ddcd7116de41b6d968365736bcd9301aa9fb9,0,0,0.408,1.0986,1.0,1,6.0,151,0,Feature,0,0,0,527,0.013251,0.0,0,0.0,0,1,0,0.5739,0.0,0.0,-17.81,22.4,0,0,0.0,0,50.3333,0,0,0,0,0,"ansible-lint: Remove no-tabs from skip list
[SEP]
FILES CHANGED:
.ansible-lint (+0, -2)
",2.531393,1.353634,0.345514,0.175127,0.051885,-1.434257,-0.405204,-0.641694,0.46891,0.447292,-0.116993,0.192368,0.456512,0.191714,-0.382037
openstack/kolla-ansible,I56d389467ffc24f554b421a18df52310d2978f10,1,0,0.4072,2.6391,0.0769,1,5.0,135,0,CI,1,0,0,528,0.013275,0.5714,0,0.2327,1,1,0,0.5733,0.0,1.0,-18.2,22.0,0,0,1.0,0,9.6429,0,0,0,0,0,"CI: Retry unhealthies check
[SEP]
FILES CHANGED:
tests/check-failure.sh (+12, -1)
",3.16555,1.039596,1.061835,0.218093,0.857675,0.590423,0.036993,-0.221995,0.229068,-0.264353,0.409693,-0.432424,0.579013,-0.249619,0.129193
openstack/charm-keystone,Ib7a90d6d5e413dfe874acdfc3ef7a43a22424afe,1,0,1.0,3.6889,0.0513,6,7.1,702,0,Doc,0,0,0,4,0.008734,1.0,0,1.0,2,3,0,1.0,2.4302,1.5,-32.72,15.8,1,0,0.0,1,17.55,0,0,0,0,0,"Add default-notification-opt-out configuration option

This boolean configuration option will preserve the default
keystone notification filtering when True, filtering out
successful authentication notifications, and allow all
notifications through when False. This can be useful when
capturing cadf logging events for user authentication. This
option is True by default to reduce log file bloat.

These default notifications are described in the upstream
configuration documentation under 'notification_opt_out.'
https://docs.openstack.org/keystone/latest/configuration/config-options.html
[SEP]
FILES CHANGED:
templates/queens/keystone.conf (+5, -0)
templates/rocky/keystone.conf (+5, -0)
config.yaml (+12, -2)
templates/caracal/keystone.conf (+5, -0)
templates/epoxy/keystone.conf (+5, -0)
hooks/keystone_context.py (+5, -0)
",-1.473338,-0.054825,0.392362,0.813856,-0.120112,-0.204016,0.236227,0.081771,0.527249,-0.167404,-0.077391,0.056401,0.121437,-0.003731,0.081197
openstack/kolla,I55c99ea29f20165b7853976f13312fca62e0be8f,0,0,0.4083,1.0986,0.5,1,3.75,204,0,Feature,0,1,0,529,0.013296,0.3,0,0.1225,2,1,0,0.5983,0.0,2.0,-11.29,20.17,0,0,0.0,0,68.0,0,0,0,0,0,"Revert ""Switch to 2025.2 release""

This reverts commit a28d2409c58c3192ed9c1b5dc1049ae466502577.
[SEP]
FILES CHANGED:
kolla/common/config.py (+1, -1)
",1.006191,0.295544,-2.265216,-2.241055,1.14174,1.084948,1.21044,-0.334993,0.307767,0.26377,-0.269846,0.782534,-0.587459,0.167407,-0.014291
openstack/ansible-collection-kolla,Idf1161a0194063765be0be186db434748a190db1,0,0,0.4075,4.4067,0.358,14,4.5,139,0,Bug Fix,0,0,0,530,0.01332,0.2857,0,0.1164,3,2,0,0.3958,3.5111,2.79,-89.13,32.91,1,0,0.0,0,1.6951,0,0,0,0,0,"ansible-lint: Fix name[missing]
[SEP]
FILES CHANGED:
roles/podman/tasks/install.yml (+4, -2)
roles/podman/tasks/uninstall.yml (+2, -1)
roles/docker/tasks/install.yml (+10, -5)
roles/docker/tasks/uninstall.yml (+2, -1)
roles/baremetal/tasks/configure-ceph-for-zun.yml (+4, -3)
roles/baremetal/tasks/post-install.yml (+6, -3)
roles/podman/tasks/main.yml (+2, -1)
.ansible-lint (+0, -2)
roles/podman_sdk/tasks/main.yml (+2, -1)
roles/apparmor_libvirt/tasks/main.yml (+2, -1)
roles/docker/tasks/main.yml (+2, -1)
roles/docker_sdk/tasks/main.yml (+2, -1)
roles/baremetal/tasks/install.yml (+6, -3)
roles/baremetal/tasks/main.yml (+8, -4)
",2.467997,2.140175,0.403439,-0.068184,-0.113215,-1.090621,-0.893322,-0.788561,0.55701,1.076186,0.477854,0.166252,0.082061,0.085622,-0.749252
openstack/kolla,Ifcee01f9415e9b9de8138b55cd676873a99c86aa,0,0,0.4068,0.6931,0.0,1,11.0,621,0,CI,0,0,0,531,0.013318,0.0,0,0.0,3,1,0,0.597,0.0,3.0,27.57,11.67,0,0,0.0,0,310.5,0,0,0,0,0,"neutron: Remove networking-generic-switch from u-c

networking-generic-switch was added to u-c [1] and it breaks our
install scheme.

Alternative is to remove networking-generic-switch from sources.py,
but that would be a user facing change and if we would pursue that
we would need to do the same for all neutron plugins.

using u-c removal macro to preserve previous approach of installing
n-g-s from a branch tarball compared to a pypi version

[1]: https://review.opendev.org/c/openstack/requirements/+/964059
[SEP]
FILES CHANGED:
docker/neutron/neutron-base/Dockerfile.j2 (+1, -0)
",-1.437962,-0.048105,0.566528,-0.082852,-0.534946,-0.437392,0.292632,-0.0188,-0.35671,0.048698,0.172981,0.124034,-0.113461,0.112004,0.089259
openstack/kolla-ansible,I7c693403b1768c6c97eea90c3dfe9326764c3230,0,0,0.406,3.3673,0.5714,10,5.5,163,0,Bug Fix,0,0,0,532,0.013343,0.4,0,0.1624,4,2,0,0.5737,3.2359,3.6,-83.31,31.29,1,0,0.0,0,5.6207,0,0,0,0,0,"ansible-lint: Fix name[template], remove package-latest
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/backup.yml (+1, -1)
ansible/roles/ceilometer/tasks/config.yml (+1, -1)
ansible/roles/octavia-certificates/tasks/check_expiry.yml (+1, -1)
ansible/roles/octavia/tasks/get_resources_info.yml (+1, -1)
ansible/roles/octavia-certificates/tasks/main.yml (+2, -2)
ansible/roles/octavia/tasks/prepare.yml (+1, -1)
ansible/roles/service-rabbitmq/tasks/main.yml (+2, -2)
ansible/roles/octavia/tasks/hm-interface.yml (+1, -1)
ansible/roles/cloudkitty/tasks/config.yml (+2, -2)
.ansible-lint (+0, -4)
",2.173362,1.046758,0.450575,-0.043281,0.429319,-1.438904,-1.023864,-0.170502,0.145751,0.502394,-0.268074,0.321696,0.278994,0.396529,-0.459212
openstack/kolla-ansible,I82310a2ebfa326a01424c7469d4eb9d440dc9b9c,0,0,0.4053,3.5835,0.3714,8,4.5,136,0,Bug Fix,0,0,0,533,0.013359,1.0,0,0.4053,1,2,0,0.5732,2.7206,0.88,-89.13,32.91,1,0,0.0,0,3.7778,0,0,0,0,0,"ansible-lint: Fix name[play]
[SEP]
FILES CHANGED:
ansible/prune-images.yml (+2, -1)
ansible/site.yml (+8, -4)
ansible/migrate-container-engine.yml (+2, -1)
ansible/kolla-host.yml (+2, -1)
ansible/nova-libvirt-cleanup.yml (+2, -1)
.ansible-lint (+0, -2)
ansible/certificates.yml (+2, -1)
ansible/rabbitmq-upgrade.yml (+4, -2)
",2.371173,2.297514,0.433873,-0.189423,-0.302732,-1.216798,-0.876934,-0.66447,0.604871,1.013391,0.406374,0.189453,-0.052283,0.138504,-0.910278
openstack/ansible-collection-kolla,I19d7fffadceaeae11336ca9a160f7c105e1191ce,1,1,0.8364,2.6391,0.7692,2,11.8,443,0,Bug Fix,0,0,0,110,0.072368,0.5,0,0.4182,3,1,0,0.3878,0.8905,3.0,35.7,10.14,0,0,0.0,0,31.6429,0,6,0,4,0,"Fix docker restart after systemd configuration change

The task run by the ""Reload docker service file"" handler does not
produce a change. As a result, the ""Restart docker"" handler is never
called and Docker proxy configuration is not applied.

Fix by merging the two handlers into one that also uses daemon_reload.

Closes-Bug: #2133464
[SEP]
FILES CHANGED:
roles/docker/handlers/main.yml (+1, -8)
roles/docker/tasks/config.yml (+2, -2)
",-0.484235,-1.459573,-0.222178,0.395779,-0.349209,0.201533,-0.11756,-0.160347,0.269593,0.097944,0.149426,-0.192219,0.13703,0.18988,0.110992
openstack/kolla,I2a74d906b5239b3896fcdca015a9b37641ade833,0,0,0.4045,2.0794,0.1429,2,3.67,148,0,Feature,0,0,0,534,0.013372,0.3704,0,0.1498,2,2,0,0.5957,0.8631,2.0,-58.38,26.92,1,0,0.0,1,18.5,0,0,0,0,0,"kolla-toolbox: Bump ansible-core to 2.20
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-core-2-20-bd912e1767d5f197.yaml (+5, -0)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",1.022055,2.367002,-0.338948,-0.01795,0.545957,-0.579058,-0.315745,0.13828,-0.642994,0.252583,0.122861,0.65213,-0.525382,-0.016362,0.668122
openstack/kolla-ansible,If1a289068093843184f0d7b495815db006f2d563,0,0,0.4037,6.0162,0.7262,77,5.2,291,0,Feature,0,0,0,535,0.013395,1.0,0,0.4037,4,3,0,0.5726,5.5994,3.36,-0.18,14.39,1,0,0.577,1,0.7098,0,0,0,0,0,"Add support for Debian Trixie (13)

Remove /etc/timezone bind mount since Debian does not provide
that file anymore.

Depends-On: https://review.opendev.org/c/openstack/kolla/+/964793
[SEP]
FILES CHANGED:
zuul.d/scenarios/nfv.yaml (+3, -3)
zuul.d/scenarios/skyline.yaml (+6, -6)
zuul.d/scenarios/prometheus-opensearch.yaml (+3, -8)
ansible/roles/nova-cell/defaults/main.yml (+0, -9)
ansible/roles/fluentd/defaults/main.yml (+0, -1)
ansible/roles/horizon/defaults/main.yml (+0, -1)
zuul.d/scenarios/openbao.yaml (+3, -3)
zuul.d/scenarios/ironic.yaml (+3, -8)
zuul.d/scenarios/kvm.yaml (+3, -3)
ansible/roles/heat/defaults/main.yml (+0, -3)
ansible/roles/prechecks/vars/main.yml (+2, -0)
ansible/roles/cinder/defaults/main.yml (+0, -4)
zuul.d/scenarios/mariadb.yaml (+4, -4)
ansible/roles/cloudkitty/defaults/main.yml (+0, -2)
ansible/roles/blazar/defaults/main.yml (+0, -2)
ansible/roles/kuryr/defaults/main.yml (+0, -1)
ansible/roles/hacluster/defaults/main.yml (+0, -3)
zuul.d/nodesets.yaml (+21, -21)
ansible/roles/mariadb/defaults/main.yml (+0, -1)
ansible/roles/loadbalancer/defaults/main.yml (+0, -4)
zuul.d/scenarios/octavia.yaml (+3, -3)
ansible/roles/multipathd/defaults/main.yml (+0, -1)
ansible/group_vars/all/common.yml (+1, -1)
zuul.d/scenarios/telemetry.yaml (+3, -3)
ansible/roles/etcd/defaults/main.yml (+0, -1)
ansible/roles/grafana/defaults/main.yml (+0, -1)
ansible/roles/barbican/defaults/main.yml (+0, -3)
ansible/roles/rabbitmq/defaults/main.yml (+0, -1)
zuul.d/scenarios/cephadm.yaml (+5, -15)
ansible/roles/trove/defaults/main.yml (+0, -3)
ansible/roles/prometheus-node-exporters/defaults/main.yml (+0, -2)
ansible/roles/memcached/defaults/main.yml (+0, -1)
ansible/roles/aodh/defaults/main.yml (+0, -4)
ansible/roles/nova/defaults/main.yml (+0, -5)
doc/source/user/support-matrix.rst (+1, -1)
ansible/roles/ironic/defaults/main.yml (+0, -7)
zuul.d/scenarios/aio.yaml (+17, -17)
ansible/roles/magnum/defaults/main.yml (+0, -2)
ansible/roles/zun/defaults/main.yml (+0, -4)
ansible/roles/watcher/defaults/main.yml (+0, -3)
ansible/roles/mistral/defaults/main.yml (+0, -4)
ansible/roles/skyline/defaults/main.yml (+0, -2)
ansible/roles/neutron/defaults/main.yml (+0, -16)
zuul.d/scenarios/bifrost.yaml (+3, -3)
ansible/roles/influxdb/defaults/main.yml (+0, -1)
ansible/roles/manila/defaults/main.yml (+0, -4)
ansible/roles/cyborg/defaults/main.yml (+0, -3)
zuul.d/scenarios/keystone-federation.yaml (+3, -3)
ansible/roles/iscsi/defaults/main.yml (+0, -2)
ansible/roles/placement/defaults/main.yml (+0, -1)
ansible/roles/openvswitch/defaults/main.yml (+0, -2)
ansible/roles/keystone/defaults/main.yml (+0, -4)
ansible/roles/prometheus/defaults/main.yml (+0, -8)
ansible/roles/glance/defaults/main.yml (+0, -1)
zuul.d/scenarios/magnum.yaml (+3, -3)
zuul.d/scenarios/container-engine-migration.yaml (+2, -2)
ansible/roles/common/defaults/main.yml (+0, -1)
ansible/roles/designate/defaults/main.yml (+0, -7)
zuul.d/scenarios/cells.yaml (+3, -3)
zuul.d/scenarios/ovn.yaml (+3, -3)
ansible/roles/cron/defaults/main.yml (+0, -1)
ansible/roles/ovs-dpdk/defaults/main.yml (+0, -2)
ansible/roles/tacker/defaults/main.yml (+0, -2)
zuul.d/scenarios/lets-encrypt.yaml (+3, -3)
ansible/roles/prechecks/tasks/datetime_checks.yml (+0, -15)
ansible/roles/gnocchi/defaults/main.yml (+0, -3)
ansible/roles/masakari/defaults/main.yml (+0, -4)
ansible/roles/octavia/defaults/main.yml (+0, -5)
zuul.d/scenarios/ipv6.yaml (+3, -3)
zuul.d/scenarios/masakari.yaml (+3, -3)
ansible/roles/telegraf/defaults/main.yml (+0, -1)
ansible/roles/ceilometer/defaults/main.yml (+0, -4)
ansible/roles/collectd/defaults/main.yml (+0, -1)
ansible/roles/valkey/defaults/main.yml (+0, -2)
ansible/roles/opensearch/defaults/main.yml (+0, -2)
zuul.d/scenarios/zun.yaml (+5, -5)
zuul.d/scenarios/haproxy-fqdn.yaml (+3, -3)
",0.4174,1.88436,-0.972782,-0.070052,-1.237487,0.419713,0.280564,-0.076664,-0.073,-0.439374,-0.488785,-0.397864,0.129752,-0.180921,-0.05297
openstack/kolla-ansible,Ib79cd622123d9b6727ab1d674f680b8e2d52ed68,1,1,0,1.9459,0.5,3,7.5,178,0,Bug Fix,0,0,0,0,0.0,0.75,0,0.0,4,2,0,0.572,1.585,3.33,-15.1,21.67,0,0,0.0,0,25.4286,0,12,0,7,0,"Fix incorrect mariadb-recovery task name in error message

Closes-Bug: #2133983
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/lookup_cluster.yml (+1, -1)
doc/source/admin/mariadb-backup-and-restore.rst (+1, -1)
doc/source/user/operating-kolla.rst (+1, -1)
",1.872636,-0.15814,-0.714647,-0.920155,-0.183583,0.299757,-0.323492,0.290595,0.414459,-0.626011,0.825135,0.107799,-0.238024,-0.115895,0.184685
openstack/openstack-ansible,I9d1b27eacf8a3c8cbd5e4fbdff53a3064604c496,1,0,1.0,2.1972,0.0,1,4.5,238,0,Bug Fix,0,0,0,53,0.062134,1.0,0,1.0,2,1,0,0.9434,0.0,2.0,26.8,13.65,1,0,0.0,0,26.4444,0,0,0,0,0,"aio: fix octavia/trove when used with ovs

If this is backported to 2024.2 or beyond, it additionally
requires handling for lxb.
[SEP]
FILES CHANGED:
etc/openstack_deploy/openstack_user_config.yml.aio.j2 (+8, -0)
",1.375974,-0.970577,-0.165121,-0.42601,-0.452668,-0.042423,-0.055895,-0.134173,-0.601412,0.327032,-0.236538,0.330696,-0.674801,-0.459821,0.34292
openstack/kolla-ansible,Ia0c55ed6137b0ccd16815f9f7a49b3b30a982154,0,0,0.403,6.1399,0.6328,11,6.0,283,0,Feature,0,0,0,536,0.013284,0.5,0,0.2015,4,3,0,0.5724,2.6906,3.55,-42.48,22.4,0,0,0.0065,1,0.6099,0,0,0,0,0,"certificates: rework to use Ansible modules

Add keyCertSign and digitalSignature key_usage required by Python 3.13 [1]

[1]: https://github.com/canonical/microk8s/issues/4864
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/generate-backend.yml (+33, -47)
ansible/roles/certificates/defaults/main.yml (+5, -5)
ansible/roles/certificates/tasks/generate-root.yml (+30, -28)
ansible/roles/certificates/templates/openssl-kolla-backend.cnf.j2 (+0, -18)
ansible/roles/certificates/tasks/generate-libvirt.yml (+35, -43)
ansible/roles/certificates/tasks/generate.yml (+65, -95)
ansible/roles/certificates/templates/openssl-kolla-libvirt.cnf.j2 (+0, -18)
ansible/roles/certificates/templates/openssl-kolla-internal.cnf.j2 (+0, -19)
zuul.d/base.yaml (+1, -0)
ansible/roles/certificates/templates/openssl-kolla.cnf.j2 (+0, -19)
zuul.d/scenarios/cephadm.yaml (+1, -1)
",-0.059453,0.810878,-0.824484,-0.052424,-0.312761,-0.190371,-0.622802,0.485303,-0.127193,0.517187,-0.585668,-0.592638,-0.066471,-0.377019,-0.167564
openstack/kolla-ansible,I3437010b61dd1874f60d60158494f83599a0ea8f,0,0,0.4022,4.1271,0.0656,5,5.5,148,0,Feature,0,0,0,537,0.013158,0.5,0,0.2011,4,3,0,0.5719,2.009,3.6,-60.24,27.65,1,0,0.0,1,2.3871,0,0,0,0,0,"designate: Switch designate-api to uWSGI
[SEP]
FILES CHANGED:
ansible/roles/designate/tasks/config.yml (+18, -0)
releasenotes/notes/uwsgi-designate-649599b4b9a1bdfd.yaml (+4, -0)
ansible/roles/designate/defaults/main.yml (+12, -2)
ansible/roles/designate/templates/designate.conf.j2 (+3, -0)
ansible/roles/designate/templates/designate-api.json.j2 (+20, -2)
",1.870948,2.014572,0.020095,0.779848,1.072866,0.141477,-0.53856,0.433084,-0.160887,0.127062,-0.1413,0.284763,0.180074,-0.009046,-0.022768
openstack/kolla-ansible,I725349bccca3779f886c2636086e1a76fa357bad,1,0,0.4015,1.0986,0.0,2,6.0,135,0,CI,0,0,0,538,0.013162,0.5,0,0.2007,3,1,0,0.5713,1.0,3.0,-10.75,19.07,0,0,0.0,0,45.0,0,0,0,0,0,"CI: Use u-c in tempest role
[SEP]
FILES CHANGED:
roles/kolla-ansible-tempest/tasks/main.yml (+1, -0)
roles/kolla-ansible-tempest/defaults/main.yml (+1, -0)
",2.697744,1.067737,0.973658,-0.050326,0.861941,0.072596,-0.021083,-0.006267,-0.382432,0.199104,0.232002,-0.124791,0.517382,0.32084,-0.223568
openstack/kolla,I672f625e445bd1a2db1c4994baa7c44c20723a62,1,1,1.0,2.5649,0.0833,2,6.5,176,0,Bug Fix,0,0,0,7,0.076923,0.5,0,0.5,3,2,0,0.5944,1.0,2.5,-73.09,27.22,1,0,0.0,1,13.5385,0,6,0,10,0,"Add genisoimage package to nova-compute-ironic

Closes-Bug: #2132960
[SEP]
FILES CHANGED:
docker/nova/nova-compute-ironic/Dockerfile.j2 (+5, -1)
releasenotes/notes/bug-2132960-genisoimage_package_nova-compute-ironic-28f4c262ec201f99.yaml (+6, -0)
",1.349704,0.165396,-1.263664,-0.955357,-0.471043,-0.295514,-0.579706,0.620923,0.046741,-0.700238,0.345712,0.535841,-0.016464,0.216498,0.16502
openstack/kolla-ansible,Iccd0270ac3c0adbea56fbe3c8b80e1bb644c20c5,0,0,0.8378,1.6094,0.5,1,7.0,586,0,Bug Fix,0,0,0,111,0.072407,0.0,0,0.0,4,1,0,0.5717,0.0,4.0,47.45,11.37,0,0,0.0,0,117.2,0,0,0,0,0,"Use mariadb command instead of mysql for upgrade

This fixes upgrades from 2025.2 to master, since 2025.2 images do not
include the mysql binary anymore [1].

SLURP upgrades should still work, since 2025.1 images include both
commands:

    $ ls -l /usr/bin/mariadb /usr/bin/mysql
    -rwxr-xr-x. 1 root root 5390512 Nov  3 13:25 /usr/bin/mariadb
    lrwxrwxrwx. 1 root root       7 Nov  3 13:25 /usr/bin/mysql -> mariadb

[1] https://review.opendev.org/c/openstack/kolla/+/926981
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/upgrade.yml (+2, -2)
",-2.920236,0.96006,1.109124,-0.832907,0.173922,-0.453367,0.318687,0.442674,-0.669199,0.247724,0.282211,-0.468292,0.119427,0.239025,0.040871
openstack/kolla-ansible,I95ee094ade6efa02a19f29a4d9bdf8d7fb97e84e,0,0,0.8304,1.0986,0.5,1,3.67,143,0,CI,1,0,0,112,0.072869,0.4,0,0.3321,1,1,0,0.5711,0.0,1.0,-35.3,19.65,0,0,1.0,1,47.6667,0,0,0,0,0,"CI: Switch previous_release to 2025.2
[SEP]
FILES CHANGED:
zuul.d/base.yaml (+1, -1)
",2.179689,1.383354,0.423196,-0.060632,0.152707,1.150741,-0.421971,0.406452,0.322337,1.215612,0.145036,-0.229064,-0.667588,0.789348,0.236835
openstack/openstack-ansible-rabbitmq_server,I49f43a84738c86c3e62fcfc45509edf7eba59a7a,1,0,0.9603,0.6931,0.0,1,6.0,587,0,Feature,0,0,0,252,0.053823,1.0,0,0.9603,1,1,0,0.8889,0.0,1.0,-21.72,14.25,0,0,0.0,0,293.5,0,0,0,0,0,"Do not run remove_classic_queue_mirroring for distro-isntalled RabbitMQ

This command has been implemented for RabbitMQ 3.13 [1]. With that
rabbitmq installed from distro path may be not yet compatible
and will fail to execute this command

Alternatively, we can disble this block for
`rabbitmq_install_method: distro`.

[1] https://github.com/rabbitmq/rabbitmq-server/pull/9869

Depends-On: https://review.opendev.org/c/openstack/openstack-ansible-lxc_hosts/+/970366
[SEP]
FILES CHANGED:
tasks/rabbitmq_feature_flags.yml (+1, -0)
",-1.50369,1.499207,0.263435,-0.245046,-0.500578,-0.353329,0.231443,0.211186,-0.114729,-0.393506,0.260003,-0.016791,-0.443182,-0.327799,-0.031688
openstack/kayobe,Ic72f2e3a262d6491da8bc39de19e23c3acbedf89,1,0,0.823,1.9459,0.0,1,6.0,307,0,CI,0,0,0,113,0.073424,0.0,0,0.0,2,1,0,0.8909,0.0,2.0,-7.94,17.07,0,0,0.0,0,43.8571,0,0,0,0,0,"CI: Ensure firewalld is unmasked

Recent nodepool images are masking the firewalld service [1], but we
need it for host configure jobs.

[1] https://review.opendev.org/c/opendev/zuul-providers/+/967962
[SEP]
FILES CHANGED:
playbooks/kayobe-overcloud-host-configure-base/pre.yml (+6, -0)
",-0.019968,1.570441,-1.001749,0.227809,-0.727236,-0.242051,0.332263,0.027032,-0.224324,-0.129715,-0.230857,-0.404071,0.083637,-0.372991,-0.141937
openstack/kolla-ansible,Ia9c5dc5809323755b72534c9767eb84ee73799a2,0,0,1.0,4.7707,0.3333,1,2.75,161,0,Bug Fix,0,0,0,6,0.009077,0.25,0,0.25,1,1,0,0.5706,0.0,1.0,-72.83,26.55,0,0,0.0,0,1.3644,0,0,0,0,0,"ansible-lint: fix unnamed-task in site.yml
[SEP]
FILES CHANGED:
ansible/site.yml (+78, -39)
",2.480275,2.457038,0.363762,0.089829,-0.316757,-1.640976,-0.276493,-0.800729,0.638621,0.24348,0.514572,0.285558,-0.250849,0.406596,0.120086
openstack/kolla-ansible,I0ea4b687b525a5090c5874ccceddd6f438ee3e0a,0,0,0.8571,2.5649,0.3333,1,2.75,164,0,Bug Fix,0,0,0,7,0.008997,0.0,0,0.0,1,1,0,0.57,0.0,1.0,-95.9,26.55,0,0,0.0,0,12.6154,0,0,0,0,0,"ansible-lint: fix unnamed-task in mariadb.yml
[SEP]
FILES CHANGED:
ansible/mariadb.yml (+8, -4)
",1.97905,2.637566,-0.109683,-0.003822,-0.114198,-1.717243,-0.096837,-0.531829,0.35386,0.046367,0.64036,0.505055,-0.648222,0.204562,0.162365
openstack/kolla-ansible,If54d78b070f0dcdad1437c694e02e6b892aadb27,0,0,0.75,2.9444,0.3333,1,2.75,161,0,Bug Fix,0,0,0,8,0.010127,0.5,0,0.375,1,1,0,0.5694,0.0,1.0,-80.52,26.55,0,0,0.0,0,8.4737,0,0,0,0,0,"ansible-lint: fix unnamed-task in nova.yml
[SEP]
FILES CHANGED:
ansible/nova.yml (+12, -6)
",2.137976,2.447706,0.004104,-0.046715,-0.290625,-1.697854,-0.362225,-0.803883,0.437043,0.238591,0.486768,0.405981,-0.305335,0.288237,0.225354
openstack/kolla-ansible,Icd689a152ba17065c81cfecc5c7da51d686465cd,0,0,0.6667,1.9459,0.3333,1,2.75,165,0,Bug Fix,0,0,0,9,0.011139,0.3333,0,0.2222,1,1,0,0.5689,0.0,1.0,-80.52,26.55,0,0,0.0,0,23.5714,0,0,0,0,0,"ansible-lint: fix unnamed-task in rabbitmq.yml
[SEP]
FILES CHANGED:
ansible/rabbitmq.yml (+4, -2)
",2.315268,2.199786,0.490788,-0.363772,-0.377718,-1.696067,-0.216292,-0.617222,0.338829,0.118849,0.434195,0.29037,-0.472558,0.158359,0.378785
openstack/kolla-ansible,Ia5ae6ffc11b99a2c93c9aba567ad28913b042fbb,0,0,0.6,1.3863,0.3333,1,2.75,168,0,Bug Fix,0,0,0,10,0.012285,0.75,0,0.45,1,1,0,0.5683,0.0,1.0,-95.9,26.55,0,0,0.0,0,42.0,0,0,0,0,0,"ansible-lint: fix unnamed-task in post-deploy.yml
[SEP]
FILES CHANGED:
ansible/post-deploy.yml (+2, -1)
",1.750937,3.05549,-0.057647,0.192085,-0.115988,-1.508467,-0.263796,-0.788001,0.469379,-0.159073,0.347096,0.438298,-0.329438,0.453404,0.448008
openstack/kolla-ansible,Ib0527af1fe92b2640564b4f26d0d8a3172bd910d,0,0,0.5455,1.3863,0.3333,1,3.0,190,0,Bug Fix,0,0,0,11,0.013464,0.0,0,0.0,1,1,0,0.5677,0.0,1.0,-99.36,27.87,0,0,0.0,0,47.5,0,0,0,0,0,"ansible-lint: nova-libvirt-cleanup.yml

fix unnamed-task rule violation
[SEP]
FILES CHANGED:
ansible/nova-libvirt-cleanup.yml (+2, -1)
",1.423839,1.219443,-0.677461,-0.52912,-0.606918,-1.53601,-0.41486,-0.190285,0.621194,-0.429576,0.144442,0.969342,-0.344329,0.864933,-0.099743
openstack/openstack-ansible-os_tempest,Ifa5266999296a1e146df66840b2f4ab6835ee7ca,1,0,0,1.7918,0.4,1,5.0,269,0,Bug Fix,0,0,0,0,0.0,0.0,0,0.0,1,1,0,0,0.0,1.0,-90.11,28.0,0,0,0.0,0,44.8333,0,0,0,0,0,"Fix(tempest): Register tempest_router_details to resolve undefined variable _add_router

Register tempest_router_details to resolve undefined variable _add_router
[SEP]
FILES CHANGED:
tasks/tempest_resources.yml (+3, -2)
",-0.725839,1.38058,-1.297842,1.182463,2.07168,0.411156,-1.66164,-0.839131,-0.144291,-0.591091,0.260582,-0.764445,-0.623317,-0.295359,0.021688
openstack/openstack-ansible-lxc_hosts,Iac983463104c84df0d9c289b76b6efade1ce167b,1,0,0.9605,0.6931,0.0,1,7.8,309,0,CI,0,0,0,253,0.054025,0.913,0,0.877,1,1,0,1.0,0.0,1.0,29.72,13.38,0,0,0.0,0,154.5,0,0,0,0,0,"Add systemd-udev to LXC cache for EL

systemd-udev is needed by networkd to load devices
on their change. While it's a built-in for DEB systems, it needs
to be explicitly installed for EL.
[SEP]
FILES CHANGED:
vars/redhat.yml (+1, -0)
",0.504464,-0.127264,-0.615971,1.0896,0.170439,-0.403192,0.260503,-0.239359,-0.418563,-0.067733,-0.261705,0.125916,0.079652,-0.064403,0.185923
openstack/openstack-ansible-os_nova,I380c1be177e2e417706201593813ee1632f51078,1,0,0.9606,1.0986,0.5,1,8.75,303,0,Bug Fix,0,0,0,254,0.054227,0.9459,0,0.9087,1,1,0,1.0,0.0,1.0,14.25,12.64,0,0,0.0,0,101.0,0,0,0,0,0,"Fix default value of nova_console_proxy_types

At the moment map is applied to the group name, rather then
instances in the group, which results in console
being disabled by default.
[SEP]
FILES CHANGED:
vars/main.yml (+1, -1)
",1.132592,-1.479683,-0.051583,0.761987,0.088174,0.258209,0.037709,-0.442041,0.222744,-0.329269,-0.38489,0.048432,-0.618727,-0.310966,-0.331332
openstack/kolla-ansible,If36b460b16924e56547c6df57fc0972188291910,1,0,0.4026,1.0986,0.5,1,3.67,140,0,Bug Fix,1,0,0,539,0.013186,0.625,0,0.2516,1,1,0,0.5672,0.0,1.0,-12.23,19.65,0,0,1.0,0,46.6667,0,0,0,0,0,"CI: Fix typo in check-failure.sh
[SEP]
FILES CHANGED:
tests/check-failure.sh (+1, -1)
",2.105824,2.268981,0.261089,-0.071596,-0.297216,0.336595,0.001193,-0.492259,0.172709,0.130228,0.858954,-0.24941,0.26408,0.671722,0.560227
openstack/kolla-ansible,I41370437ff83b08440502237ed2f9561798655db,0,0,0.5,1.0986,0.5,1,4.33,190,0,Bug Fix,0,0,0,12,0.014634,0.0,0,0.0,4,1,0,0.5676,0.0,4.0,-70.89,20.19,0,0,0.0,0,63.3333,0,0,0,0,0,"ansible-lint: fix unnamed-task in roles

role: service-check-containers
[SEP]
FILES CHANGED:
ansible/roles/service-check-containers/tasks/main.yml (+1, -1)
",2.465458,0.604948,-0.184519,-0.42845,-0.44228,-1.854157,-0.43087,-0.597451,0.679385,-0.483662,-0.037673,0.652832,0.496065,0.749807,-0.167252
openstack/kolla-ansible,Ic6c548217293b6ddd294973d100a11ac96dc464c,0,0,0.4615,4.1109,0.3333,13,3.67,156,0,Bug Fix,0,0,0,13,0.015815,0.0,0,0.0,4,1,0,0.567,3.4037,4.0,-50.69,23.28,0,0,0.0,0,2.5574,0,0,0,0,0,"ansible-lint: fix unnamed-task in zun
[SEP]
FILES CHANGED:
ansible/roles/zun/tasks/main.yml (+2, -1)
ansible/roles/zun/tasks/bootstrap.yml (+2, -1)
ansible/roles/zun/tasks/config_validate.yml (+2, -1)
ansible/roles/zun/tasks/register.yml (+2, -1)
ansible/roles/zun/tasks/upgrade.yml (+6, -3)
ansible/roles/zun/tasks/stop.yml (+2, -1)
ansible/roles/zun/tasks/deploy-containers.yml (+2, -1)
ansible/roles/zun/tasks/reconfigure.yml (+2, -1)
ansible/roles/zun/tasks/check-containers.yml (+2, -1)
ansible/roles/zun/tasks/pull.yml (+2, -1)
ansible/roles/zun/tasks/deploy.yml (+10, -5)
ansible/roles/zun/tasks/precheck.yml (+2, -1)
ansible/roles/zun/tasks/config.yml (+4, -2)
",3.14258,1.4429,0.803721,-0.514137,-0.387596,-1.598188,-0.379748,-0.854571,0.583744,0.094104,0.380522,0.545518,0.150662,0.202531,0.261399
openstack/kolla-ansible,I211ea80a5a3148aecaabc1975fb135e87a4024d4,0,0,0.4286,2.5649,0.3333,1,4.33,184,0,Bug Fix,0,0,0,14,0.015873,0.5,0,0.2143,4,1,0,0.5665,0.0,4.0,-116.44,23.27,0,0,0.0,0,14.1538,0,0,0,0,0,"ansible-lint: fix unnamed-task in roles

role: service-image-info
[SEP]
FILES CHANGED:
ansible/roles/service-image-info/tasks/main.yml (+8, -4)
",2.276116,0.976994,-0.331266,-0.294019,-0.256189,-1.761568,-0.565635,-0.720774,0.813937,-0.542005,0.104448,0.600461,0.39267,0.807452,-0.107804
openstack/kolla-ansible,I37d7de7b1aace74d7951dbbe1295bd3e0f6d940a,0,0,0.4,4.0604,0.3333,13,3.67,160,0,Bug Fix,0,0,0,15,0.016779,0.0,0,0.0,4,1,0,0.5659,3.3866,4.0,-89.14,23.28,0,0,0.0,0,2.7586,0,0,0,0,0,"ansible-lint: fix unnamed-task in watcher
[SEP]
FILES CHANGED:
ansible/roles/watcher/tasks/config_validate.yml (+2, -1)
ansible/roles/watcher/tasks/reconfigure.yml (+2, -1)
ansible/roles/watcher/tasks/deploy.yml (+10, -5)
ansible/roles/watcher/tasks/precheck.yml (+2, -1)
ansible/roles/watcher/tasks/upgrade.yml (+6, -3)
ansible/roles/watcher/tasks/bootstrap.yml (+2, -1)
ansible/roles/watcher/tasks/deploy-containers.yml (+2, -1)
ansible/roles/watcher/tasks/check-containers.yml (+2, -1)
ansible/roles/watcher/tasks/config.yml (+2, -1)
ansible/roles/watcher/tasks/pull.yml (+2, -1)
ansible/roles/watcher/tasks/register.yml (+2, -1)
ansible/roles/watcher/tasks/main.yml (+2, -1)
ansible/roles/watcher/tasks/stop.yml (+2, -1)
",3.164528,1.052289,0.935815,-0.424127,-0.510099,-1.993762,-0.263607,-0.724697,0.952356,0.281996,0.401695,0.502532,0.146722,0.131095,0.306498
openstack/kolla-ansible,Id78a061b1406a99444da01eb15f778661f309573,0,0,0.375,3.434,0.3333,9,3.67,159,0,Bug Fix,0,0,0,16,0.016824,1.0,0,0.375,4,1,0,0.5653,3.1219,4.0,-73.76,23.28,0,0,0.0,0,5.129,0,0,0,0,0,"ansible-lint: fix unnamed-task in valkey
[SEP]
FILES CHANGED:
ansible/roles/valkey/tasks/stop.yml (+2, -1)
ansible/roles/valkey/tasks/reconfigure.yml (+2, -1)
ansible/roles/valkey/tasks/main.yml (+2, -1)
ansible/roles/valkey/tasks/upgrade.yml (+2, -1)
ansible/roles/valkey/tasks/deploy.yml (+4, -2)
ansible/roles/valkey/tasks/deploy-containers.yml (+2, -1)
ansible/roles/valkey/tasks/pull.yml (+2, -1)
ansible/roles/valkey/tasks/check-containers.yml (+2, -1)
ansible/roles/valkey/tasks/precheck.yml (+2, -1)
",3.315498,0.767509,1.02956,-0.588614,-0.144571,-1.937851,-0.428304,-0.862705,0.93008,0.252221,0.15902,0.152496,0.125467,0.092301,0.146428
openstack/kolla-ansible,I5e4505c86dc419e486147c55d43f1f07a02478a9,0,0,0.3529,4.0604,0.3333,13,3.67,158,0,Bug Fix,0,0,0,17,0.017329,0.0,0,0.0,4,1,0,0.5648,3.3866,4.0,-66.07,23.28,0,0,0.0,0,2.7241,0,0,0,0,0,"ansible-lint: fix unnamed-task in trove
[SEP]
FILES CHANGED:
ansible/roles/trove/tasks/upgrade.yml (+6, -3)
ansible/roles/trove/tasks/deploy.yml (+10, -5)
ansible/roles/trove/tasks/reconfigure.yml (+2, -1)
ansible/roles/trove/tasks/precheck.yml (+2, -1)
ansible/roles/trove/tasks/pull.yml (+2, -1)
ansible/roles/trove/tasks/register.yml (+2, -1)
ansible/roles/trove/tasks/bootstrap.yml (+2, -1)
ansible/roles/trove/tasks/config.yml (+2, -1)
ansible/roles/trove/tasks/check-containers.yml (+2, -1)
ansible/roles/trove/tasks/config_validate.yml (+2, -1)
ansible/roles/trove/tasks/main.yml (+2, -1)
ansible/roles/trove/tasks/stop.yml (+2, -1)
ansible/roles/trove/tasks/deploy-containers.yml (+2, -1)
",3.015997,1.39518,0.836337,-0.478057,-0.412598,-1.788806,-0.388593,-0.637521,0.793837,0.265734,0.271471,0.579919,0.311234,0.013653,0.102692
openstack/kolla-ansible,I4c484347e8e377c54135c30f9b455e2b7e4d444d,0,0,0.3333,3.6109,0.3333,10,3.67,161,0,Bug Fix,0,0,0,18,0.017341,0.0,0,0.0,4,1,0,0.5642,3.2516,4.0,-81.45,26.92,0,0,0.0,0,4.3514,0,0,0,0,0,"ansible-lint: fix unnamed-task in telegraf
[SEP]
FILES CHANGED:
ansible/roles/telegraf/tasks/check-containers.yml (+2, -1)
ansible/roles/telegraf/tasks/deploy-containers.yml (+2, -1)
ansible/roles/telegraf/tasks/reconfigure.yml (+2, -1)
ansible/roles/telegraf/tasks/config.yml (+2, -1)
ansible/roles/telegraf/tasks/upgrade.yml (+4, -2)
ansible/roles/telegraf/tasks/precheck.yml (+2, -1)
ansible/roles/telegraf/tasks/pull.yml (+2, -1)
ansible/roles/telegraf/tasks/deploy.yml (+4, -2)
ansible/roles/telegraf/tasks/main.yml (+2, -1)
ansible/roles/telegraf/tasks/stop.yml (+2, -1)
",2.555686,1.61812,0.714669,-0.51077,-0.279506,-1.77054,-0.36733,-0.611188,0.465052,0.098247,0.387866,0.62809,-0.092649,-0.160826,0.244789
openstack/kolla-ansible,Ib7b0acfd625ab04509c5d8d1d41c9909891e37c6,0,0,0.3158,4.0604,0.3333,13,3.67,159,0,Bug Fix,0,0,0,19,0.017691,0.0,0,0.0,4,1,0,0.5637,3.3866,4.0,-66.07,23.28,0,0,0.0,0,2.7414,0,0,0,0,0,"ansible-lint: fix unnamed-task in tacker
[SEP]
FILES CHANGED:
ansible/roles/tacker/tasks/config_validate.yml (+2, -1)
ansible/roles/tacker/tasks/deploy-containers.yml (+2, -1)
ansible/roles/tacker/tasks/register.yml (+2, -1)
ansible/roles/tacker/tasks/deploy.yml (+10, -5)
ansible/roles/tacker/tasks/stop.yml (+2, -1)
ansible/roles/tacker/tasks/main.yml (+2, -1)
ansible/roles/tacker/tasks/reconfigure.yml (+2, -1)
ansible/roles/tacker/tasks/bootstrap.yml (+2, -1)
ansible/roles/tacker/tasks/config.yml (+2, -1)
ansible/roles/tacker/tasks/pull.yml (+2, -1)
ansible/roles/tacker/tasks/upgrade.yml (+6, -3)
ansible/roles/tacker/tasks/check-containers.yml (+2, -1)
ansible/roles/tacker/tasks/precheck.yml (+2, -1)
",2.940668,1.510876,0.657043,-0.405004,-0.402508,-1.91633,-0.346494,-0.762217,0.628924,0.250927,0.544691,0.546503,0.276949,-0.03101,0.198053
openstack/kolla-ansible,I13f46862f056a5056f92f1d762edbd61ef466b48,0,0,0.3,3.8918,0.3333,12,3.67,160,0,Bug Fix,0,0,0,20,0.017683,1.0,0,0.3,4,1,0,0.5631,3.375,4.0,-66.07,23.28,0,0,0.0,0,3.2653,0,0,0,0,0,"ansible-lint: fix unnamed-task in skyline
[SEP]
FILES CHANGED:
ansible/roles/skyline/tasks/upgrade.yml (+4, -2)
ansible/roles/skyline/tasks/main.yml (+2, -1)
ansible/roles/skyline/tasks/bootstrap.yml (+2, -1)
ansible/roles/skyline/tasks/deploy-containers.yml (+2, -1)
ansible/roles/skyline/tasks/precheck.yml (+2, -1)
ansible/roles/skyline/tasks/stop.yml (+2, -1)
ansible/roles/skyline/tasks/deploy.yml (+8, -4)
ansible/roles/skyline/tasks/pull.yml (+2, -1)
ansible/roles/skyline/tasks/config.yml (+2, -1)
ansible/roles/skyline/tasks/register.yml (+2, -1)
ansible/roles/skyline/tasks/check-containers.yml (+2, -1)
ansible/roles/skyline/tasks/reconfigure.yml (+2, -1)
",3.07578,1.255929,1.00582,-0.468353,-0.380279,-1.676027,-0.482087,-0.744603,0.906598,0.226413,0.308744,0.658921,0.33898,0.074134,0.201258
openstack/kolla-ansible,Ibc484e11d16cd51742c4845b91a1b39cfb473b65,0,0,0.2857,1.3863,0.3333,1,3.67,169,0,Bug Fix,0,0,0,21,0.017812,0.25,0,0.0714,4,1,0,0.5626,0.0,4.0,-81.45,26.92,0,0,0.0,0,42.25,0,0,0,0,0,"ansible-lint: fix unnamed-task in service-rabbitmq
[SEP]
FILES CHANGED:
ansible/roles/service-rabbitmq/tasks/main.yml (+2, -1)
",2.502541,1.184017,0.444146,-0.735868,-0.210754,-2.20343,-0.248436,-0.239019,0.306782,-0.050623,0.132648,0.656806,-0.162577,-0.214232,0.619746
openstack/kolla-ansible,I267662b8ecc0d8a833d92983f40de1f5c78d1bcd,0,0,0.2727,4.3694,0.3462,13,3.67,161,0,Bug Fix,0,0,0,22,0.018613,0.75,0,0.2045,4,1,0,0.562,3.3459,4.0,-66.07,23.28,0,0,0.0,0,2.038,0,0,0,0,0,"ansible-lint: fix unnamed-task in rabbitmq
[SEP]
FILES CHANGED:
ansible/roles/rabbitmq/tasks/version-check.yml (+7, -5)
ansible/roles/rabbitmq/tasks/upgrade.yml (+10, -5)
ansible/roles/rabbitmq/tasks/config.yml (+2, -1)
ansible/roles/rabbitmq/tasks/main.yml (+2, -1)
ansible/roles/rabbitmq/tasks/post-deploy.yml (+2, -1)
ansible/roles/rabbitmq/tasks/check-containers.yml (+2, -1)
ansible/roles/rabbitmq/tasks/reconfigure.yml (+2, -1)
ansible/roles/rabbitmq/tasks/pull.yml (+2, -1)
ansible/roles/rabbitmq/tasks/deploy.yml (+10, -5)
ansible/roles/rabbitmq/tasks/stop.yml (+2, -1)
ansible/roles/rabbitmq/tasks/remove-ha-all-policy.yml (+4, -2)
ansible/roles/rabbitmq/tasks/deploy-containers.yml (+2, -1)
ansible/roles/rabbitmq/tasks/precheck.yml (+4, -2)
",3.091788,1.192263,0.904923,-0.821483,-0.515195,-1.898976,-0.266581,-0.611825,0.394744,0.244137,0.35497,0.489388,0.013946,-0.206285,0.454342
openstack/kolla-ansible,I8eb147b18c826ad884279daae247d3e5092d0f2f,0,0,0.2609,3.8286,0.3333,9,3.67,164,0,Bug Fix,0,0,0,23,0.018254,0.0,0,0.0,4,1,0,0.5615,2.8402,4.0,-81.45,26.92,0,0,0.0,0,3.5652,0,0,0,0,0,"ansible-lint: fix unnamed-task in openvswitch
[SEP]
FILES CHANGED:
ansible/roles/openvswitch/tasks/pull.yml (+2, -1)
ansible/roles/openvswitch/tasks/stop.yml (+2, -1)
ansible/roles/openvswitch/tasks/main.yml (+2, -1)
ansible/roles/openvswitch/tasks/upgrade.yml (+8, -4)
ansible/roles/openvswitch/tasks/deploy.yml (+8, -4)
ansible/roles/openvswitch/tasks/deploy-containers.yml (+2, -1)
ansible/roles/openvswitch/tasks/precheck.yml (+2, -1)
ansible/roles/openvswitch/tasks/reconfigure.yml (+2, -1)
ansible/roles/openvswitch/tasks/check-containers.yml (+2, -1)
",2.932164,1.094755,1.080571,-0.57427,-0.495771,-1.968996,-0.343766,-0.423202,0.860382,0.083861,0.234602,0.562645,0.102831,-0.068559,0.329584
openstack/kolla-ansible,Ifff7eaaf8a3e34be3ffe6cdc7dcc93212be1dad1,0,0,0.25,1.9459,0.3333,1,3.67,165,0,Bug Fix,0,0,0,24,0.018391,0.0,0,0.0,4,1,0,0.5609,0.0,4.0,-119.9,26.92,0,0,0.0,0,23.5714,0,0,0,0,0,"ansible-lint: fix unnamed-task in prune-images
[SEP]
FILES CHANGED:
ansible/roles/prune-images/tasks/main.yml (+4, -2)
",2.23177,2.290061,0.297734,0.108597,0.020436,-1.78516,-0.465147,-1.001901,0.461309,-0.083272,0.314345,0.618805,0.45922,0.323957,0.41856
openstack/kolla-ansible,I7878d1894c80be01d9bf96786a6c94e2d0634a26,0,0,0.24,4.1589,0.3333,13,3.67,162,0,Bug Fix,0,0,0,25,0.019069,0.0,0,0.0,4,1,0,0.5604,3.2866,4.0,-81.45,26.92,0,0,0.0,0,2.5312,0,0,0,0,0,"ansible-lint: fix unnamed-task in placement
[SEP]
FILES CHANGED:
ansible/roles/placement/tasks/deploy-containers.yml (+2, -1)
ansible/roles/placement/tasks/pull.yml (+2, -1)
ansible/roles/placement/tasks/precheck.yml (+2, -1)
ansible/roles/placement/tasks/deploy.yml (+10, -5)
ansible/roles/placement/tasks/upgrade.yml (+10, -5)
ansible/roles/placement/tasks/config.yml (+2, -1)
ansible/roles/placement/tasks/config_validate.yml (+2, -1)
ansible/roles/placement/tasks/register.yml (+2, -1)
ansible/roles/placement/tasks/stop.yml (+2, -1)
ansible/roles/placement/tasks/bootstrap.yml (+2, -1)
ansible/roles/placement/tasks/main.yml (+2, -1)
ansible/roles/placement/tasks/check-containers.yml (+2, -1)
ansible/roles/placement/tasks/reconfigure.yml (+2, -1)
",3.230343,1.326353,1.142402,-0.281428,-0.372298,-1.732912,-0.364116,-0.741148,1.03261,0.288436,0.37985,0.704625,0.30706,0.126591,0.181623
openstack/kolla-ansible,I1294c23f6ec0cf1e24f07b0d989f6001c1a9c5e1,0,0,0.2308,3.6109,0.3333,10,4.33,191,0,Bug Fix,0,0,0,26,0.018923,0.0,0,0.0,4,1,0,0.5598,3.2516,4.0,-96.92,23.27,0,0,0.0,0,5.1622,0,0,0,0,0,"ansible-lint: fix unnamed-task in roles

role: prometheus-node-exporters
[SEP]
FILES CHANGED:
ansible/roles/prometheus-node-exporters/tasks/config.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/deploy-containers.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/pull.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/upgrade.yml (+4, -2)
ansible/roles/prometheus-node-exporters/tasks/main.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/reconfigure.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/check-containers.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/deploy.yml (+4, -2)
ansible/roles/prometheus-node-exporters/tasks/stop.yml (+2, -1)
ansible/roles/prometheus-node-exporters/tasks/precheck.yml (+2, -1)
",2.035695,0.943472,-0.40379,-0.464334,-0.049312,-2.049215,-0.795888,-0.479858,0.57863,-0.708616,-0.046524,0.593564,0.123037,0.403881,-0.158214
openstack/kolla-ansible,Ia56ef922013b55d4687da1f4ebbed599afcd76e0,0,0,0.2222,3.7612,0.3333,10,3.67,163,0,Bug Fix,0,0,0,27,0.019149,0.2222,0,0.0494,4,1,0,0.5593,3.182,4.0,-96.83,26.92,0,0,0.0,0,3.7907,0,0,0,0,0,"ansible-lint: fix unnamed-task in prometheus
[SEP]
FILES CHANGED:
ansible/roles/prometheus/tasks/upgrade.yml (+4, -2)
ansible/roles/prometheus/tasks/reconfigure.yml (+2, -1)
ansible/roles/prometheus/tasks/config.yml (+4, -2)
ansible/roles/prometheus/tasks/deploy-containers.yml (+2, -1)
ansible/roles/prometheus/tasks/pull.yml (+2, -1)
ansible/roles/prometheus/tasks/check-containers.yml (+2, -1)
ansible/roles/prometheus/tasks/deploy.yml (+6, -3)
ansible/roles/prometheus/tasks/stop.yml (+2, -1)
ansible/roles/prometheus/tasks/main.yml (+2, -1)
ansible/roles/prometheus/tasks/precheck.yml (+2, -1)
",2.986595,1.52646,0.785811,-0.442245,-0.466144,-1.874805,-0.385716,-0.70908,0.635354,0.286025,0.351874,0.56107,0.160035,-0.202381,0.426809
openstack/kolla-ansible,Iad657d075090d18615473db8b1fa2561253ee87d,0,0,0.2143,3.5264,0.3333,3,3.67,162,0,Bug Fix,0,0,0,28,0.019284,1.0,0,0.2143,4,1,0,0.5587,0.8659,4.0,-58.38,23.28,0,0,0.0,0,4.7647,0,0,0,0,0,"ansible-lint: fix unnamed-task in prechecks
[SEP]
FILES CHANGED:
ansible/roles/prechecks/tasks/main.yml (+18, -9)
ansible/roles/prechecks/tasks/timesync_checks.yml (+2, -1)
ansible/roles/prechecks/tasks/datetime_checks.yml (+2, -1)
",2.944241,1.308649,0.819008,-0.438429,-0.253391,-1.778183,-0.481889,-0.91013,0.70058,0.295934,0.306204,0.400778,0.305233,0.031199,0.349222
openstack/kolla-ansible,If93f36aa4b282dd86638f10d0895043532a3d6bd,0,0,0.2069,3.434,0.3333,9,3.67,161,0,Bug Fix,0,0,0,29,0.019529,0.0,0,0.0,4,1,0,0.5582,3.1219,4.0,-50.69,23.28,0,0,0.0,0,5.1935,0,0,0,0,0,"ansible-lint: fix unnamed-task in ovs-dpdk
[SEP]
FILES CHANGED:
ansible/roles/ovs-dpdk/tasks/deploy-containers.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/main.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/stop.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/pull.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/reconfigure.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/deploy.yml (+4, -2)
ansible/roles/ovs-dpdk/tasks/check-containers.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/upgrade.yml (+2, -1)
ansible/roles/ovs-dpdk/tasks/precheck.yml (+2, -1)
",1.989312,2.16928,0.116109,-0.419557,-0.050509,-2.032772,-0.455542,-0.46884,0.296117,0.021255,0.254504,0.832403,-0.05245,-0.194895,0.595336
openstack/kolla-ansible,I308edb8e04b1d752ebaecfcfda2a8e135228e0af,0,0,0.2,4.8903,0.3333,23,3.67,162,0,Bug Fix,0,0,0,30,0.019802,0.5,0,0.1,4,1,0,0.5576,4.2341,4.0,-119.9,26.92,0,0,0.0,0,1.218,0,0,0,0,0,"ansible-lint: fix unnamed-task in nova-cell
[SEP]
FILES CHANGED:
ansible/roles/nova-cell/tasks/check-containers.yml (+2, -1)
ansible/roles/nova-cell/tasks/config_validate.yml (+2, -1)
ansible/roles/nova-cell/tasks/precheck.yml (+2, -1)
ansible/roles/nova-cell/tasks/loadbalancer.yml (+6, -3)
ansible/roles/nova-cell/tasks/rabbitmq.yml (+6, -3)
ansible/roles/nova-cell/tasks/upgrade.yml (+4, -2)
ansible/roles/nova-cell/tasks/create_cells.yml (+2, -1)
ansible/roles/nova-cell/tasks/bootstrap.yml (+8, -4)
ansible/roles/nova-cell/tasks/bootstrap_upgrade.yml (+4, -2)
ansible/roles/nova-cell/tasks/discover_computes.yml (+4, -2)
ansible/roles/nova-cell/tasks/reconfigure.yml (+2, -1)
ansible/roles/nova-cell/tasks/deploy.yml (+14, -7)
ansible/roles/nova-cell/tasks/pull.yml (+2, -1)
ansible/roles/nova-cell/tasks/config.yml (+4, -2)
ansible/roles/nova-cell/tasks/cell_proxy_loadbalancer.yml (+2, -1)
ansible/roles/nova-cell/tasks/version-check.yml (+2, -1)
ansible/roles/nova-cell/tasks/libvirt-cleanup.yml (+4, -2)
ansible/roles/nova-cell/tasks/wait_discover_computes.yml (+2, -1)
ansible/roles/nova-cell/tasks/deploy-containers.yml (+2, -1)
ansible/roles/nova-cell/tasks/external_ceph.yml (+4, -2)
ansible/roles/nova-cell/tasks/rolling_upgrade.yml (+6, -3)
ansible/roles/nova-cell/tasks/main.yml (+2, -1)
ansible/roles/nova-cell/tasks/stop.yml (+2, -1)
",2.27387,1.554071,0.161393,-0.342427,-0.036864,-2.026695,-0.439633,-0.730362,0.471306,-0.048216,0.302862,0.780396,0.386371,0.168123,0.195574
openstack/kolla-ansible,If50b11469ea4f49919201296ae20f418525465cf,0,0,0.1935,3.8286,0.3333,9,3.67,159,0,Bug Fix,0,0,0,31,0.018822,0.0,0,0.0,4,1,0,0.5571,2.8159,4.0,-50.69,23.28,0,0,0.0,0,3.4565,0,0,0,0,0,"ansible-lint: fix unnamed-task in ovn-db
[SEP]
FILES CHANGED:
ansible/roles/ovn-db/tasks/bootstrap-initial.yml (+6, -3)
ansible/roles/ovn-db/tasks/deploy.yml (+10, -5)
ansible/roles/ovn-db/tasks/main.yml (+2, -1)
ansible/roles/ovn-db/tasks/reconfigure.yml (+2, -1)
ansible/roles/ovn-db/tasks/deploy-containers.yml (+2, -1)
ansible/roles/ovn-db/tasks/pull.yml (+2, -1)
ansible/roles/ovn-db/tasks/stop.yml (+2, -1)
ansible/roles/ovn-db/tasks/check-containers.yml (+2, -1)
ansible/roles/ovn-db/tasks/upgrade.yml (+2, -1)
",2.161944,2.102161,0.220322,-0.351207,-0.225544,-2.088665,-0.411878,-0.625096,0.327132,-0.069189,0.342004,0.756953,0.030591,0.061324,0.355643
openstack/kolla-ansible,Ic2219eedfaa303ef7de8c25f5679b1a8ea6cfc01,0,0,0.1875,3.434,0.3333,8,3.67,167,0,Bug Fix,0,0,0,32,0.018913,0.0,0,0.0,4,1,0,0.5565,2.8464,4.0,-104.52,26.92,0,0,0.0,0,5.3871,0,0,0,0,0,"ansible-lint: fix unnamed-task in ovn-controller
[SEP]
FILES CHANGED:
ansible/roles/ovn-controller/tasks/deploy.yml (+6, -3)
ansible/roles/ovn-controller/tasks/check-containers.yml (+2, -1)
ansible/roles/ovn-controller/tasks/pull.yml (+2, -1)
ansible/roles/ovn-controller/tasks/main.yml (+2, -1)
ansible/roles/ovn-controller/tasks/stop.yml (+2, -1)
ansible/roles/ovn-controller/tasks/upgrade.yml (+2, -1)
ansible/roles/ovn-controller/tasks/reconfigure.yml (+2, -1)
ansible/roles/ovn-controller/tasks/deploy-containers.yml (+2, -1)
",2.29868,1.859952,0.356992,-0.316684,-0.17453,-2.089208,-0.452623,-0.585093,0.461587,-0.080331,0.317907,0.830925,0.241211,0.082362,0.330363
openstack/kolla-ansible,I3f24d64d4c28e22d463a4c6028b021c59379d61c,0,0,0.1818,4.0604,0.3333,11,3.67,163,0,Bug Fix,0,0,0,33,0.019164,1.0,0,0.1818,4,1,0,0.556,3.0259,4.0,-66.07,26.92,0,0,0.0,0,2.8103,0,0,0,0,0,"ansible-lint: fix unnamed-task in opensearch
[SEP]
FILES CHANGED:
ansible/roles/opensearch/tasks/stop.yml (+2, -1)
ansible/roles/opensearch/tasks/main.yml (+2, -1)
ansible/roles/opensearch/tasks/check-containers.yml (+2, -1)
ansible/roles/opensearch/tasks/deploy-containers.yml (+2, -1)
ansible/roles/opensearch/tasks/precheck.yml (+2, -1)
ansible/roles/opensearch/tasks/deploy.yml (+10, -5)
ansible/roles/opensearch/tasks/pull.yml (+2, -1)
ansible/roles/opensearch/tasks/reconfigure.yml (+2, -1)
ansible/roles/opensearch/tasks/upgrade.yml (+10, -5)
ansible/roles/opensearch/tasks/config.yml (+2, -1)
ansible/roles/opensearch/tasks/register.yml (+2, -1)
",2.515437,1.784938,0.510557,-0.4469,-0.142912,-1.729017,-0.370317,-0.874646,0.333646,0.069459,0.506616,0.614441,0.019,-0.226876,0.435911
openstack/kolla-ansible,Id22503c5f2d9ea488477e98a84b4e1324afa522e,0,0,0.1765,2.5649,0.3333,1,4.33,186,0,Bug Fix,0,0,0,34,0.019112,0.0,0,0.0,4,1,0,0.5554,0.0,4.0,-109.93,23.27,0,0,0.0,0,14.3077,0,0,0,0,0,"ansible-lint: fix unnamed-task in roles

role: octavia-certificates
[SEP]
FILES CHANGED:
ansible/roles/octavia-certificates/tasks/main.yml (+8, -4)
",2.097978,0.592077,-0.429655,-0.459013,-0.000546,-1.602219,-0.53005,-0.41405,0.709863,-0.454773,0.19294,0.603585,0.090135,0.368362,-0.282045
openstack/kolla-ansible,I1bb91822c0f93dab9536b922210454cf45f5201d,0,0,0.1714,4.2905,0.3333,14,3.67,160,0,Bug Fix,0,0,0,35,0.019542,0.5,0,0.0857,4,1,0,0.5549,3.3699,4.0,-58.38,23.28,0,0,0.0,0,2.1918,0,0,0,0,0,"ansible-lint: fix unnamed-task in octavia
[SEP]
FILES CHANGED:
ansible/roles/octavia/tasks/config-host.yml (+2, -1)
ansible/roles/octavia/tasks/deploy.yml (+14, -7)
ansible/roles/octavia/tasks/register.yml (+2, -1)
ansible/roles/octavia/tasks/reconfigure.yml (+2, -1)
ansible/roles/octavia/tasks/pull.yml (+2, -1)
ansible/roles/octavia/tasks/config.yml (+6, -3)
ansible/roles/octavia/tasks/stop.yml (+2, -1)
ansible/roles/octavia/tasks/bootstrap.yml (+2, -1)
ansible/roles/octavia/tasks/check-containers.yml (+2, -1)
ansible/roles/octavia/tasks/main.yml (+2, -1)
ansible/roles/octavia/tasks/precheck.yml (+2, -1)
ansible/roles/octavia/tasks/upgrade.yml (+6, -3)
ansible/roles/octavia/tasks/deploy-containers.yml (+2, -1)
ansible/roles/octavia/tasks/config_validate.yml (+2, -1)
",2.664106,1.598854,0.558489,-0.671656,-0.501609,-1.754564,-0.391724,-0.770203,0.502752,0.198493,0.628752,0.804448,0.25339,-0.244911,0.386886
openstack/kolla-ansible,I48bab78377f875c62dee131aa247335b9f598c20,0,0,0.1667,4.2905,0.3333,15,3.67,157,0,Bug Fix,0,0,0,36,0.019324,1.0,0,0.1667,4,1,0,0.5544,3.6887,4.0,-66.07,23.28,0,0,0.0,0,2.1507,0,0,0,0,0,"ansible-lint: fix unnamed-task in nova
[SEP]
FILES CHANGED:
ansible/roles/nova/tasks/pull.yml (+2, -1)
ansible/roles/nova/tasks/precheck.yml (+2, -1)
ansible/roles/nova/tasks/map_cell0.yml (+6, -3)
ansible/roles/nova/tasks/deploy.yml (+6, -3)
ansible/roles/nova/tasks/bootstrap.yml (+8, -4)
ansible/roles/nova/tasks/config.yml (+2, -1)
ansible/roles/nova/tasks/reconfigure.yml (+2, -1)
ansible/roles/nova/tasks/upgrade.yml (+4, -2)
ansible/roles/nova/tasks/bootstrap_upgrade.yml (+4, -2)
ansible/roles/nova/tasks/config_validate.yml (+2, -1)
ansible/roles/nova/tasks/deploy-containers.yml (+2, -1)
ansible/roles/nova/tasks/check-containers.yml (+2, -1)
ansible/roles/nova/tasks/main.yml (+2, -1)
ansible/roles/nova/tasks/stop.yml (+2, -1)
ansible/roles/nova/tasks/register.yml (+2, -1)
",2.772616,1.185998,0.494075,-0.597379,-0.408345,-1.902692,-0.446116,-0.779739,0.382772,0.344224,0.376203,0.701058,0.233887,-0.07911,0.278559
openstack/kolla-ansible,I55df433eda5770cf7eb49fa0b5f6e478adb06a2f,0,0,0.1622,4.5747,0.3333,15,3.67,160,0,Bug Fix,0,0,0,37,0.019121,1.0,0,0.1622,4,1,0,0.5538,3.4261,4.0,-96.83,23.28,0,0,0.0,0,1.6495,0,0,0,0,0,"ansible-lint: fix unnamed-task in neutron
[SEP]
FILES CHANGED:
ansible/roles/neutron/tasks/pull.yml (+2, -1)
ansible/roles/neutron/tasks/upgrade.yml (+6, -3)
ansible/roles/neutron/tasks/bootstrap.yml (+2, -1)
ansible/roles/neutron/tasks/config.yml (+2, -1)
ansible/roles/neutron/tasks/stop.yml (+2, -1)
ansible/roles/neutron/tasks/config_validate.yml (+2, -1)
ansible/roles/neutron/tasks/main.yml (+2, -1)
ansible/roles/neutron/tasks/register.yml (+2, -1)
ansible/roles/neutron/tasks/check-containers.yml (+2, -1)
ansible/roles/neutron/tasks/deploy-containers.yml (+2, -1)
ansible/roles/neutron/tasks/deploy.yml (+16, -8)
ansible/roles/neutron/tasks/legacy_upgrade.yml (+10, -5)
ansible/roles/neutron/tasks/precheck.yml (+4, -2)
ansible/roles/neutron/tasks/rolling_upgrade.yml (+8, -4)
ansible/roles/neutron/tasks/reconfigure.yml (+2, -1)
",3.011379,1.406133,0.979706,-0.488407,-0.453723,-1.733729,-0.373628,-0.650002,0.76929,0.277026,0.310034,0.79326,0.326231,0.107949,0.298931
openstack/kolla-ansible,I69de36900594b5efca02b687234e4ae539928d93,0,0,0.1579,4.0604,0.3333,13,3.67,160,0,Bug Fix,0,0,0,38,0.01871,0.0,0,0.0,4,1,0,0.5533,3.3866,4.0,-81.45,23.28,0,0,0.0,0,2.7586,0,0,0,0,0,"ansible-lint: fix unnamed-task in mistral
[SEP]
FILES CHANGED:
ansible/roles/mistral/tasks/config.yml (+2, -1)
ansible/roles/mistral/tasks/reconfigure.yml (+2, -1)
ansible/roles/mistral/tasks/stop.yml (+2, -1)
ansible/roles/mistral/tasks/precheck.yml (+2, -1)
ansible/roles/mistral/tasks/main.yml (+2, -1)
ansible/roles/mistral/tasks/register.yml (+2, -1)
ansible/roles/mistral/tasks/deploy.yml (+10, -5)
ansible/roles/mistral/tasks/pull.yml (+2, -1)
ansible/roles/mistral/tasks/check-containers.yml (+2, -1)
ansible/roles/mistral/tasks/config_validate.yml (+2, -1)
ansible/roles/mistral/tasks/deploy-containers.yml (+2, -1)
ansible/roles/mistral/tasks/bootstrap.yml (+2, -1)
ansible/roles/mistral/tasks/upgrade.yml (+6, -3)
",2.946122,1.465399,0.716421,-0.673556,-0.339533,-1.60287,-0.337068,-0.782852,0.606011,0.061021,0.42651,0.845619,0.111858,-0.116315,0.3742
openstack/kolla-ansible,I3be19b30e1431cddfc1da1ba5efd57f006ec9a1e,0,0,0.1538,4.1589,0.3333,13,3.67,161,0,Bug Fix,0,0,0,39,0.018678,0.3333,0,0.0513,4,1,0,0.5528,3.2661,4.0,-96.83,23.28,0,0,0.0,0,2.5156,0,0,0,0,0,"ansible-lint: fix unnamed-task in keystone
[SEP]
FILES CHANGED:
ansible/roles/keystone/tasks/pull.yml (+2, -1)
ansible/roles/keystone/tasks/upgrade.yml (+4, -2)
ansible/roles/keystone/tasks/deploy.yml (+14, -7)
ansible/roles/keystone/tasks/stop.yml (+2, -1)
ansible/roles/keystone/tasks/main.yml (+2, -1)
ansible/roles/keystone/tasks/deploy-containers.yml (+2, -1)
ansible/roles/keystone/tasks/check-containers.yml (+2, -1)
ansible/roles/keystone/tasks/reconfigure.yml (+2, -1)
ansible/roles/keystone/tasks/register.yml (+2, -1)
ansible/roles/keystone/tasks/config_validate.yml (+2, -1)
ansible/roles/keystone/tasks/config.yml (+4, -2)
ansible/roles/keystone/tasks/precheck.yml (+2, -1)
ansible/roles/keystone/tasks/bootstrap.yml (+2, -1)
",3.028552,1.269739,0.862827,-0.70123,-0.605409,-1.851026,-0.387168,-0.592661,0.568946,0.127196,0.31674,0.658091,0.220533,-0.097575,0.304818
openstack/kolla-ansible,I9c5fb1849bc386e3b583e6293e09811f8efdd0a8,0,0,0.15,3.6889,0.3333,9,3.67,163,0,Bug Fix,0,0,0,40,0.018596,0.0,0,0.0,4,1,0,0.5522,2.9689,4.0,-89.14,26.92,0,0,0.0,0,4.075,0,0,0,0,0,"ansible-lint: fix unnamed-task in multipathd
[SEP]
FILES CHANGED:
ansible/roles/multipathd/tasks/reconfigure.yml (+2, -1)
ansible/roles/multipathd/tasks/main.yml (+2, -1)
ansible/roles/multipathd/tasks/stop.yml (+2, -1)
ansible/roles/multipathd/tasks/deploy-containers.yml (+2, -1)
ansible/roles/multipathd/tasks/check-containers.yml (+2, -1)
ansible/roles/multipathd/tasks/deploy.yml (+6, -3)
ansible/roles/multipathd/tasks/precheck.yml (+2, -1)
ansible/roles/multipathd/tasks/pull.yml (+2, -1)
ansible/roles/multipathd/tasks/upgrade.yml (+6, -3)
",2.990363,1.179294,0.979299,-0.694856,-0.396138,-1.987784,-0.282526,-0.543086,0.535165,0.145397,0.234292,0.503402,0.114044,0.03768,0.351354
openstack/kolla-ansible,If97ce1247d79714f5219f723d7c3c974c4947c57,0,0,0.1463,3.5264,0.3333,9,3.67,162,0,Bug Fix,0,0,0,41,0.018721,0.0,0,0.0,4,1,0,0.5517,3.0958,4.0,-58.38,23.28,0,0,0.0,0,4.7647,0,0,0,0,0,"ansible-lint: fix unnamed-task in memcached
[SEP]
FILES CHANGED:
ansible/roles/memcached/tasks/main.yml (+2, -1)
ansible/roles/memcached/tasks/reconfigure.yml (+2, -1)
ansible/roles/memcached/tasks/stop.yml (+2, -1)
ansible/roles/memcached/tasks/pull.yml (+2, -1)
ansible/roles/memcached/tasks/upgrade.yml (+4, -2)
ansible/roles/memcached/tasks/precheck.yml (+2, -1)
ansible/roles/memcached/tasks/check-containers.yml (+2, -1)
ansible/roles/memcached/tasks/deploy-containers.yml (+2, -1)
ansible/roles/memcached/tasks/deploy.yml (+4, -2)
",2.824588,0.898863,0.858143,-0.559268,-0.388923,-1.937508,-0.285629,-0.51707,0.645911,0.164317,0.269961,0.395987,-0.04216,-0.044582,0.182563
openstack/kolla-ansible,Iaaedd6aa69e7369e694ec07aeba97d8c7152d04e,0,0,0.1429,4.0604,0.3333,13,3.67,161,0,Bug Fix,0,0,0,42,0.018893,0.25,0,0.0357,4,1,0,0.5512,3.3866,4.0,-104.52,26.92,0,0,0.0,0,2.7759,0,0,0,0,0,"ansible-lint: fix unnamed-task in masakari
[SEP]
FILES CHANGED:
ansible/roles/masakari/tasks/bootstrap.yml (+2, -1)
ansible/roles/masakari/tasks/deploy-containers.yml (+2, -1)
ansible/roles/masakari/tasks/main.yml (+2, -1)
ansible/roles/masakari/tasks/upgrade.yml (+6, -3)
ansible/roles/masakari/tasks/reconfigure.yml (+2, -1)
ansible/roles/masakari/tasks/check-containers.yml (+2, -1)
ansible/roles/masakari/tasks/precheck.yml (+2, -1)
ansible/roles/masakari/tasks/register.yml (+2, -1)
ansible/roles/masakari/tasks/stop.yml (+2, -1)
ansible/roles/masakari/tasks/config_validate.yml (+2, -1)
ansible/roles/masakari/tasks/pull.yml (+2, -1)
ansible/roles/masakari/tasks/config.yml (+2, -1)
ansible/roles/masakari/tasks/deploy.yml (+10, -5)
",2.792332,1.578915,0.623832,-0.655993,-0.351357,-1.649283,-0.296299,-0.726603,0.363016,0.306629,0.586324,0.76097,0.041812,-0.170441,0.192435
openstack/kolla-ansible,Ie6b3330a9d7587c233fbeef600b9035ede5b081a,0,0,0.1395,4.2905,0.3333,14,3.67,160,0,Bug Fix,0,0,0,43,0.01886,0.5,0,0.0698,4,1,0,0.5506,3.6368,4.0,-81.45,23.28,0,0,0.0,0,2.1918,0,0,0,0,0,"ansible-lint: fix unnamed-task in mariadb
[SEP]
FILES CHANGED:
ansible/roles/mariadb/tasks/precheck.yml (+2, -1)
ansible/roles/mariadb/tasks/deploy-containers.yml (+4, -2)
ansible/roles/mariadb/tasks/recover_cluster.yml (+4, -2)
ansible/roles/mariadb/tasks/upgrade.yml (+4, -2)
ansible/roles/mariadb/tasks/check-containers.yml (+2, -1)
ansible/roles/mariadb/tasks/pull.yml (+2, -1)
ansible/roles/mariadb/tasks/lookup_cluster.yml (+4, -2)
ansible/roles/mariadb/tasks/bootstrap.yml (+6, -3)
ansible/roles/mariadb/tasks/reconfigure.yml (+2, -1)
ansible/roles/mariadb/tasks/deploy.yml (+8, -4)
ansible/roles/mariadb/tasks/post-deploy.yml (+4, -2)
ansible/roles/mariadb/tasks/config.yml (+2, -1)
ansible/roles/mariadb/tasks/stop.yml (+2, -1)
ansible/roles/mariadb/tasks/main.yml (+2, -1)
",2.488291,1.669735,0.267537,-0.511276,-0.172346,-1.852444,-0.332945,-0.487691,0.277567,0.123491,0.563035,0.754209,-0.164115,-0.160893,0.228245
openstack/kolla-ansible,I9a6a65f34a49e1e4bcd22f83e88d27e7c10c694e,0,0,0.1364,4.1109,0.3333,13,3.67,159,0,Bug Fix,0,0,0,44,0.018707,1.0,0,0.1364,4,1,0,0.5501,3.4037,4.0,-104.52,26.92,0,0,0.0,0,2.6066,0,0,0,0,0,"ansible-lint: fix unnamed-task in manila
[SEP]
FILES CHANGED:
ansible/roles/manila/tasks/stop.yml (+2, -1)
ansible/roles/manila/tasks/config.yml (+4, -2)
ansible/roles/manila/tasks/pull.yml (+2, -1)
ansible/roles/manila/tasks/reconfigure.yml (+2, -1)
ansible/roles/manila/tasks/check-containers.yml (+2, -1)
ansible/roles/manila/tasks/bootstrap.yml (+2, -1)
ansible/roles/manila/tasks/precheck.yml (+2, -1)
ansible/roles/manila/tasks/main.yml (+2, -1)
ansible/roles/manila/tasks/config_validate.yml (+2, -1)
ansible/roles/manila/tasks/deploy-containers.yml (+2, -1)
ansible/roles/manila/tasks/register.yml (+2, -1)
ansible/roles/manila/tasks/upgrade.yml (+6, -3)
ansible/roles/manila/tasks/deploy.yml (+10, -5)
",2.631114,1.590341,0.421509,-0.535249,-0.242223,-1.471286,-0.423497,-1.066568,0.521044,0.144146,0.713862,0.823277,0.152409,-0.054987,0.312883
openstack/kolla-ansible,I7edf18e35fadbe38585c9ad6d7afc8b28a1b4d74,0,0,0.1333,4.0604,0.3333,13,3.67,159,0,Bug Fix,0,0,0,45,0.018657,0.5,0,0.0667,4,1,0,0.5496,3.3866,4.0,-96.83,23.28,0,0,0.0,0,2.7414,0,0,0,0,0,"ansible-lint: fix unnamed-task in magnum
[SEP]
FILES CHANGED:
ansible/roles/magnum/tasks/main.yml (+2, -1)
ansible/roles/magnum/tasks/register.yml (+2, -1)
ansible/roles/magnum/tasks/bootstrap.yml (+2, -1)
ansible/roles/magnum/tasks/upgrade.yml (+6, -3)
ansible/roles/magnum/tasks/config_validate.yml (+2, -1)
ansible/roles/magnum/tasks/stop.yml (+2, -1)
ansible/roles/magnum/tasks/check-containers.yml (+2, -1)
ansible/roles/magnum/tasks/precheck.yml (+2, -1)
ansible/roles/magnum/tasks/deploy-containers.yml (+2, -1)
ansible/roles/magnum/tasks/config.yml (+2, -1)
ansible/roles/magnum/tasks/pull.yml (+2, -1)
ansible/roles/magnum/tasks/reconfigure.yml (+2, -1)
ansible/roles/magnum/tasks/deploy.yml (+10, -5)
",2.855773,1.638907,0.550427,-0.422112,-0.312421,-1.622767,-0.336336,-0.825748,0.69591,0.115151,0.576028,0.785987,0.224644,-0.02412,0.263587
openstack/kolla-ansible,I30d263e4ce21e02b654b3364a1b9f99fac78c553,0,0,0.1304,3.7612,0.3333,10,3.67,165,0,Bug Fix,0,0,0,46,0.018631,0.0625,0,0.0082,4,1,0,0.549,3.1281,4.0,-96.83,26.92,0,0,0.0,0,3.8372,0,0,0,0,0,"ansible-lint: fix unnamed-task in loadbalancer
[SEP]
FILES CHANGED:
ansible/roles/loadbalancer/tasks/check-containers.yml (+2, -1)
ansible/roles/loadbalancer/tasks/pull.yml (+2, -1)
ansible/roles/loadbalancer/tasks/precheck.yml (+6, -3)
ansible/roles/loadbalancer/tasks/reconfigure.yml (+2, -1)
ansible/roles/loadbalancer/tasks/config.yml (+2, -1)
ansible/roles/loadbalancer/tasks/main.yml (+2, -1)
ansible/roles/loadbalancer/tasks/stop.yml (+2, -1)
ansible/roles/loadbalancer/tasks/upgrade.yml (+2, -1)
ansible/roles/loadbalancer/tasks/deploy.yml (+6, -3)
ansible/roles/loadbalancer/tasks/deploy-containers.yml (+2, -1)
",2.764305,0.948797,0.858024,-0.312288,-0.155378,-2.038746,-0.187076,-0.345549,0.818138,0.090735,0.218215,0.724081,0.059382,-0.123287,0.22101
openstack/kolla-ansible,I1e1857c59feb36ec17d374f6186e9424b80f0341,0,0,0.1277,3.434,0.3333,9,3.67,164,0,Bug Fix,0,0,0,47,0.018718,0.0,0,0.0,4,1,0,0.5485,3.1219,4.0,-81.45,26.92,0,0,0.0,0,5.2903,0,0,0,0,0,"ansible-lint: fix unnamed-task in letsencrypt
[SEP]
FILES CHANGED:
ansible/roles/letsencrypt/tasks/deploy-containers.yml (+2, -1)
ansible/roles/letsencrypt/tasks/stop.yml (+2, -1)
ansible/roles/letsencrypt/tasks/check-containers.yml (+2, -1)
ansible/roles/letsencrypt/tasks/config.yml (+2, -1)
ansible/roles/letsencrypt/tasks/main.yml (+2, -1)
ansible/roles/letsencrypt/tasks/deploy.yml (+4, -2)
ansible/roles/letsencrypt/tasks/pull.yml (+2, -1)
ansible/roles/letsencrypt/tasks/upgrade.yml (+2, -1)
ansible/roles/letsencrypt/tasks/reconfigure.yml (+2, -1)
",2.772071,0.827823,0.823573,-0.719831,-0.288819,-1.996834,-0.542733,-0.926924,0.495146,0.347732,0.26446,0.420316,0.13892,-0.283326,0.46229
openstack/kolla-ansible,I92256409361b765d5f8f427cf4f5db5ef71730a4,0,0,0.125,3.8918,0.3333,12,3.67,158,0,Bug Fix,0,0,0,48,0.01889,0.0,0,0.0,4,1,0,0.548,3.375,4.0,-58.38,23.28,0,0,0.0,0,3.2245,0,0,0,0,0,"ansible-lint: fix unnamed-task in kuryr
[SEP]
FILES CHANGED:
ansible/roles/kuryr/tasks/register.yml (+2, -1)
ansible/roles/kuryr/tasks/deploy.yml (+8, -4)
ansible/roles/kuryr/tasks/stop.yml (+2, -1)
ansible/roles/kuryr/tasks/check-containers.yml (+2, -1)
ansible/roles/kuryr/tasks/pull.yml (+2, -1)
ansible/roles/kuryr/tasks/reconfigure.yml (+2, -1)
ansible/roles/kuryr/tasks/config.yml (+2, -1)
ansible/roles/kuryr/tasks/config_validate.yml (+2, -1)
ansible/roles/kuryr/tasks/deploy-containers.yml (+2, -1)
ansible/roles/kuryr/tasks/main.yml (+2, -1)
ansible/roles/kuryr/tasks/upgrade.yml (+4, -2)
ansible/roles/kuryr/tasks/precheck.yml (+2, -1)
",2.816218,1.675335,0.545673,-0.593215,-0.415126,-1.770294,-0.416965,-0.801148,0.321336,0.150723,0.446754,0.46409,0.008993,-0.224373,0.278808
openstack/kolla-ansible,I302eb6287ca86dd6119396b0b8e92dc54bd97da6,0,0,0.1224,3.5264,0.3333,9,3.67,158,0,Bug Fix,0,0,0,49,0.018926,0.0,0,0.0,4,1,0,0.5475,3.0272,4.0,-73.76,23.28,0,0,0.0,0,4.6471,0,0,0,0,0,"ansible-lint: fix unnamed-task in iscsi
[SEP]
FILES CHANGED:
ansible/roles/iscsi/tasks/upgrade.yml (+2, -1)
ansible/roles/iscsi/tasks/check-containers.yml (+2, -1)
ansible/roles/iscsi/tasks/precheck.yml (+2, -1)
ansible/roles/iscsi/tasks/pull.yml (+2, -1)
ansible/roles/iscsi/tasks/main.yml (+2, -1)
ansible/roles/iscsi/tasks/stop.yml (+2, -1)
ansible/roles/iscsi/tasks/reconfigure.yml (+2, -1)
ansible/roles/iscsi/tasks/deploy-containers.yml (+2, -1)
ansible/roles/iscsi/tasks/deploy.yml (+6, -3)
",2.514783,1.315908,0.573068,-0.553861,-0.3328,-1.808826,-0.608303,-0.662413,0.436539,0.264706,0.411996,0.50237,0.075372,-0.110873,0.372485
openstack/kolla-ansible,Ic38199c813702e3654f043024daaa0a84c66be1f,0,0,0.12,4.0073,0.3333,11,3.67,160,0,Bug Fix,0,0,0,50,0.019069,0.25,0,0.03,4,1,0,0.5469,3.1699,4.0,-81.45,26.92,0,0,0.0,0,2.9091,0,0,0,0,0,"ansible-lint: fix unnamed-task in horizon
[SEP]
FILES CHANGED:
ansible/roles/horizon/tasks/deploy-containers.yml (+2, -1)
ansible/roles/horizon/tasks/reconfigure.yml (+2, -1)
ansible/roles/horizon/tasks/stop.yml (+2, -1)
ansible/roles/horizon/tasks/pull.yml (+2, -1)
ansible/roles/horizon/tasks/config.yml (+4, -2)
ansible/roles/horizon/tasks/upgrade.yml (+8, -4)
ansible/roles/horizon/tasks/main.yml (+2, -1)
ansible/roles/horizon/tasks/check-containers.yml (+2, -1)
ansible/roles/horizon/tasks/precheck.yml (+2, -1)
ansible/roles/horizon/tasks/bootstrap.yml (+2, -1)
ansible/roles/horizon/tasks/deploy.yml (+8, -4)
",3.067701,1.230912,0.930621,-0.37595,-0.334678,-1.738413,-0.383527,-0.780215,0.894154,0.310135,0.269427,0.693091,0.282053,0.06332,0.258462
openstack/kolla-ansible,I3a3ea4658d7d78492987ad93f546f7d5aeba918a,0,0,0.1176,4.5109,0.3333,15,3.67,159,0,Bug Fix,0,0,0,51,0.019058,0.5,0,0.0588,4,1,0,0.5464,3.4015,4.0,-96.83,26.92,0,0,0.0,0,1.7473,0,0,0,0,0,"ansible-lint: fix unnamed-task in ironic
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/reconfigure.yml (+2, -1)
ansible/roles/ironic/tasks/stop.yml (+2, -1)
ansible/roles/ironic/tasks/precheck.yml (+2, -1)
ansible/roles/ironic/tasks/deploy-containers.yml (+2, -1)
ansible/roles/ironic/tasks/pull.yml (+2, -1)
ansible/roles/ironic/tasks/rolling_upgrade.yml (+14, -7)
ansible/roles/ironic/tasks/upgrade.yml (+4, -2)
ansible/roles/ironic/tasks/main.yml (+2, -1)
ansible/roles/ironic/tasks/bootstrap.yml (+2, -1)
ansible/roles/ironic/tasks/legacy_upgrade.yml (+8, -4)
ansible/roles/ironic/tasks/deploy.yml (+12, -6)
ansible/roles/ironic/tasks/register.yml (+2, -1)
ansible/roles/ironic/tasks/check-containers.yml (+2, -1)
ansible/roles/ironic/tasks/config.yml (+2, -1)
ansible/roles/ironic/tasks/config_validate.yml (+2, -1)
",2.98646,1.328087,0.738723,-0.563142,-0.543885,-1.701913,-0.453072,-0.84911,0.549264,0.405026,0.445004,0.620899,0.400122,-0.144231,0.300673
openstack/kolla-ansible,Id7eb7aa79b58cc74e2d87b5aa10541cb03246ef8,0,0,0.1154,3.5264,0.3333,9,3.67,161,0,Bug Fix,0,0,0,52,0.0188,0.0,0,0.0,4,1,0,0.5459,3.0958,4.0,-81.45,23.28,0,0,0.0,0,4.7353,0,0,0,0,0,"ansible-lint: fix unnamed-task in influxdb
[SEP]
FILES CHANGED:
ansible/roles/influxdb/tasks/deploy-containers.yml (+2, -1)
ansible/roles/influxdb/tasks/main.yml (+2, -1)
ansible/roles/influxdb/tasks/stop.yml (+2, -1)
ansible/roles/influxdb/tasks/deploy.yml (+4, -2)
ansible/roles/influxdb/tasks/pull.yml (+2, -1)
ansible/roles/influxdb/tasks/upgrade.yml (+4, -2)
ansible/roles/influxdb/tasks/check-containers.yml (+2, -1)
ansible/roles/influxdb/tasks/precheck.yml (+2, -1)
ansible/roles/influxdb/tasks/reconfigure.yml (+2, -1)
",2.977968,1.310836,1.012959,-0.559677,-0.425533,-1.840653,-0.210709,-0.545565,0.749439,0.215134,0.220255,0.593626,0.145449,-0.055251,0.217067
openstack/kolla-ansible,I0ca37f2b79423dc2403dc3cfb78479dd8f270e85,0,0,0.1132,4.0604,0.3333,13,3.67,157,0,Bug Fix,0,0,0,53,0.018935,0.0,0,0.0,4,1,0,0.5454,3.3866,4.0,-50.69,23.28,0,0,0.0,0,2.7069,0,0,0,0,0,"ansible-lint: fix unnamed-task in heat
[SEP]
FILES CHANGED:
ansible/roles/heat/tasks/main.yml (+2, -1)
ansible/roles/heat/tasks/upgrade.yml (+6, -3)
ansible/roles/heat/tasks/reconfigure.yml (+2, -1)
ansible/roles/heat/tasks/register.yml (+2, -1)
ansible/roles/heat/tasks/stop.yml (+2, -1)
ansible/roles/heat/tasks/deploy-containers.yml (+2, -1)
ansible/roles/heat/tasks/deploy.yml (+10, -5)
ansible/roles/heat/tasks/config_validate.yml (+2, -1)
ansible/roles/heat/tasks/precheck.yml (+2, -1)
ansible/roles/heat/tasks/bootstrap.yml (+2, -1)
ansible/roles/heat/tasks/pull.yml (+2, -1)
ansible/roles/heat/tasks/check-containers.yml (+2, -1)
ansible/roles/heat/tasks/config.yml (+2, -1)
",3.217211,1.313529,0.968461,-0.627497,-0.626078,-1.741156,-0.398859,-0.931535,0.698026,0.222864,0.367258,0.580091,0.348896,0.109359,0.177827
openstack/kolla-ansible,I02bed9c73239a74f47b73560adb29156b4686216,0,0,0.1111,3.5264,0.3333,8,3.67,162,0,Bug Fix,0,0,0,54,0.018908,0.0,0,0.0,4,1,0,0.5448,2.7322,4.0,-73.76,26.92,0,0,0.0,0,4.7647,0,0,0,0,0,"ansible-lint: fix unnamed-task in hacluster
[SEP]
FILES CHANGED:
ansible/roles/hacluster/tasks/main.yml (+2, -1)
ansible/roles/hacluster/tasks/upgrade.yml (+2, -1)
ansible/roles/hacluster/tasks/stop.yml (+2, -1)
ansible/roles/hacluster/tasks/check-containers.yml (+2, -1)
ansible/roles/hacluster/tasks/deploy.yml (+8, -4)
ansible/roles/hacluster/tasks/pull.yml (+2, -1)
ansible/roles/hacluster/tasks/deploy-containers.yml (+2, -1)
ansible/roles/hacluster/tasks/reconfigure.yml (+2, -1)
",2.492854,1.534707,0.650885,-0.370723,-0.177079,-1.875449,-0.266509,-0.484706,0.514703,0.044016,0.400419,0.712797,0.066184,-0.172497,0.312791
openstack/kolla-ansible,I4ee70120935a15e74a0c2de9bda1a73af0a921c8,0,0,0.1091,4.3694,0.3333,15,3.67,159,0,Bug Fix,0,0,0,55,0.019038,0.0,0,0.0,4,1,0,0.5443,3.6095,4.0,-104.52,23.28,0,0,0.0,0,2.0127,0,0,0,0,0,"ansible-lint: fix unnamed-task in glance
[SEP]
FILES CHANGED:
ansible/roles/glance/tasks/main.yml (+2, -1)
ansible/roles/glance/tasks/reconfigure.yml (+2, -1)
ansible/roles/glance/tasks/check-containers.yml (+2, -1)
ansible/roles/glance/tasks/precheck.yml (+2, -1)
ansible/roles/glance/tasks/deploy.yml (+10, -5)
ansible/roles/glance/tasks/bootstrap.yml (+2, -1)
ansible/roles/glance/tasks/upgrade.yml (+4, -2)
ansible/roles/glance/tasks/config.yml (+4, -2)
ansible/roles/glance/tasks/legacy_upgrade.yml (+6, -3)
ansible/roles/glance/tasks/stop.yml (+2, -1)
ansible/roles/glance/tasks/register.yml (+2, -1)
ansible/roles/glance/tasks/config_validate.yml (+2, -1)
ansible/roles/glance/tasks/deploy-containers.yml (+2, -1)
ansible/roles/glance/tasks/rolling_upgrade.yml (+8, -4)
ansible/roles/glance/tasks/pull.yml (+2, -1)
",3.057181,1.595398,0.81949,-0.517512,-0.448529,-1.775417,-0.370851,-0.843126,0.748128,0.211066,0.31047,0.738069,0.386162,0.037365,0.285207
openstack/kolla-ansible,Iedbd1bb52d6bfe7a8c115900afa6a3ee64259a93,0,0,0.1071,3.7612,0.3333,10,3.67,160,0,Bug Fix,0,0,0,56,0.018874,0.1667,0,0.0179,4,1,0,0.5438,3.0931,4.0,-104.52,26.92,0,0,0.0,0,3.7209,0,0,0,0,0,"ansible-lint: fix unnamed-task in grafana
[SEP]
FILES CHANGED:
ansible/roles/grafana/tasks/deploy-containers.yml (+2, -1)
ansible/roles/grafana/tasks/deploy.yml (+8, -4)
ansible/roles/grafana/tasks/check-containers.yml (+2, -1)
ansible/roles/grafana/tasks/pull.yml (+2, -1)
ansible/roles/grafana/tasks/stop.yml (+2, -1)
ansible/roles/grafana/tasks/main.yml (+2, -1)
ansible/roles/grafana/tasks/config.yml (+2, -1)
ansible/roles/grafana/tasks/reconfigure.yml (+2, -1)
ansible/roles/grafana/tasks/precheck.yml (+2, -1)
ansible/roles/grafana/tasks/upgrade.yml (+4, -2)
",2.47841,1.948093,0.41229,-0.415562,-0.156642,-1.66498,-0.349694,-0.789418,0.426686,0.126359,0.557879,0.781432,0.110206,-0.136334,0.375753
openstack/kolla-ansible,I463b31534f54db7a4d4b36760f353def5d1d367d,0,0,0.1053,4.0604,0.3333,13,3.67,160,0,Bug Fix,0,0,0,57,0.018943,0.0,0,0.0,4,1,0,0.5433,3.4714,4.0,-58.38,23.28,0,0,0.0,0,2.7586,0,0,0,0,0,"ansible-lint: fix unnamed-task in gnocchi
[SEP]
FILES CHANGED:
ansible/roles/gnocchi/tasks/pull.yml (+2, -1)
ansible/roles/gnocchi/tasks/precheck.yml (+2, -1)
ansible/roles/gnocchi/tasks/reconfigure.yml (+2, -1)
ansible/roles/gnocchi/tasks/deploy.yml (+8, -4)
ansible/roles/gnocchi/tasks/main.yml (+2, -1)
ansible/roles/gnocchi/tasks/stop.yml (+2, -1)
ansible/roles/gnocchi/tasks/config_validate.yml (+2, -1)
ansible/roles/gnocchi/tasks/config.yml (+4, -2)
ansible/roles/gnocchi/tasks/register.yml (+2, -1)
ansible/roles/gnocchi/tasks/deploy-containers.yml (+2, -1)
ansible/roles/gnocchi/tasks/bootstrap.yml (+2, -1)
ansible/roles/gnocchi/tasks/upgrade.yml (+6, -3)
ansible/roles/gnocchi/tasks/check-containers.yml (+2, -1)
",2.735851,1.392876,0.525431,-0.490893,-0.348399,-1.797778,-0.373493,-0.680929,0.422902,0.156738,0.618654,0.544436,0.011263,-0.030098,0.255798
openstack/kolla-ansible,I37daed66f2d58ad6b1415cd96d5253c37fd0d0f6,0,0,0.1034,3.6889,0.3333,10,3.67,160,0,Bug Fix,0,0,0,58,0.018917,0.5,0,0.0517,4,1,0,0.5428,3.1808,4.0,-50.69,23.28,0,0,0.0,0,4.0,0,0,0,0,0,"ansible-lint: fix unnamed-task in fluentd
[SEP]
FILES CHANGED:
ansible/roles/fluentd/tasks/deploy.yml (+6, -3)
ansible/roles/fluentd/tasks/precheck.yml (+2, -1)
ansible/roles/fluentd/tasks/stop.yml (+2, -1)
ansible/roles/fluentd/tasks/main.yml (+2, -1)
ansible/roles/fluentd/tasks/check-containers.yml (+2, -1)
ansible/roles/fluentd/tasks/reconfigure.yml (+2, -1)
ansible/roles/fluentd/tasks/pull.yml (+2, -1)
ansible/roles/fluentd/tasks/upgrade.yml (+4, -2)
ansible/roles/fluentd/tasks/deploy-containers.yml (+2, -1)
ansible/roles/fluentd/tasks/config.yml (+2, -1)
",3.180128,1.495942,0.86474,-0.643838,-0.478521,-1.800417,-0.256407,-0.799695,0.510451,0.245394,0.290302,0.679859,0.222778,-0.027114,0.315828
openstack/kolla-ansible,I6870c607e2564a5e73ec41ecc6bc3ee79fc34f0d,0,0,0.1017,3.7612,0.3333,11,3.67,157,0,Bug Fix,0,0,0,59,0.019002,0.0,0,0.0,4,1,0,0.5423,3.3249,4.0,-81.45,23.28,0,0,0.0,0,3.6512,0,0,0,0,0,"ansible-lint: fix unnamed-task in etcd
[SEP]
FILES CHANGED:
ansible/roles/etcd/tasks/check-containers.yml (+2, -1)
ansible/roles/etcd/tasks/main.yml (+2, -1)
ansible/roles/etcd/tasks/stop.yml (+2, -1)
ansible/roles/etcd/tasks/upgrade.yml (+4, -2)
ansible/roles/etcd/tasks/precheck.yml (+2, -1)
ansible/roles/etcd/tasks/reconfigure.yml (+2, -1)
ansible/roles/etcd/tasks/deploy-containers.yml (+2, -1)
ansible/roles/etcd/tasks/config.yml (+2, -1)
ansible/roles/etcd/tasks/pull.yml (+2, -1)
ansible/roles/etcd/tasks/bootstrap.yml (+2, -1)
ansible/roles/etcd/tasks/deploy.yml (+6, -3)
",2.970887,1.324563,0.783329,-0.532799,-0.428634,-1.868496,-0.175634,-0.645013,0.383652,0.192296,0.306225,0.596044,0.251388,-0.018887,0.292008
openstack/kolla-ansible,Ibb20b33db4e0a5ca91dbad311b34af1f031f83ed,0,0,0.1,3.6889,0.3333,10,3.67,159,0,Bug Fix,0,0,0,60,0.019066,0.3939,0,0.0394,4,1,0,0.5417,3.1808,4.0,-89.14,23.28,0,0,0.0,0,3.975,0,0,0,0,0,"ansible-lint: fix unnamed-task in common
[SEP]
FILES CHANGED:
ansible/roles/common/tasks/upgrade.yml (+4, -2)
ansible/roles/common/tasks/precheck.yml (+2, -1)
ansible/roles/common/tasks/main.yml (+2, -1)
ansible/roles/common/tasks/pull.yml (+2, -1)
ansible/roles/common/tasks/deploy-containers.yml (+2, -1)
ansible/roles/common/tasks/config.yml (+2, -1)
ansible/roles/common/tasks/reconfigure.yml (+2, -1)
ansible/roles/common/tasks/stop.yml (+2, -1)
ansible/roles/common/tasks/check-containers.yml (+2, -1)
ansible/roles/common/tasks/deploy.yml (+6, -3)
",3.09049,1.205677,0.986371,-0.344433,-0.353843,-1.858362,-0.392166,-0.795308,0.663928,0.47356,0.225755,0.623608,0.256136,0.019918,0.295103
openstack/kolla-ansible,Ic072a789014c8b1c42eef771b7c4740b95246257,0,0,0.0984,2.7726,0.3333,2,3.67,160,0,Bug Fix,0,0,0,61,0.019146,0.3333,0,0.0328,4,1,0,0.5412,0.7219,4.0,-58.38,23.28,0,0,0.0,0,10.0,0,0,0,0,0,"ansible-lint: fix unnamed-task in destroy
[SEP]
FILES CHANGED:
ansible/roles/destroy/tasks/cleanup_host.yml (+2, -1)
ansible/roles/destroy/tasks/main.yml (+8, -4)
",3.465213,1.467486,1.215788,-0.544076,-0.626054,-1.566631,-0.399634,-0.913682,0.795693,0.242565,0.357598,0.599852,0.244623,0.168595,0.305405
openstack/kolla-ansible,I7be0b0d12b3be90ced3693f8927bc732f4f514e2,0,0,0.0968,4.2047,0.3333,13,3.67,162,0,Bug Fix,0,0,0,62,0.019369,0.0,0,0.0,4,1,0,0.5407,3.2999,4.0,-81.45,26.92,0,0,0.0,0,2.4179,0,0,0,0,0,"ansible-lint: fix unnamed-task in designate
[SEP]
FILES CHANGED:
ansible/roles/designate/tasks/register.yml (+2, -1)
ansible/roles/designate/tasks/bootstrap.yml (+2, -1)
ansible/roles/designate/tasks/upgrade.yml (+8, -4)
ansible/roles/designate/tasks/stop.yml (+2, -1)
ansible/roles/designate/tasks/check-containers.yml (+2, -1)
ansible/roles/designate/tasks/main.yml (+2, -1)
ansible/roles/designate/tasks/reconfigure.yml (+2, -1)
ansible/roles/designate/tasks/deploy-containers.yml (+2, -1)
ansible/roles/designate/tasks/config.yml (+4, -2)
ansible/roles/designate/tasks/pull.yml (+2, -1)
ansible/roles/designate/tasks/deploy.yml (+12, -6)
ansible/roles/designate/tasks/precheck.yml (+2, -1)
ansible/roles/designate/tasks/config_validate.yml (+2, -1)
",3.005158,1.982934,0.839915,-0.19387,-0.218269,-1.546227,-0.464614,-0.998704,0.905515,0.317135,0.439158,0.646493,0.346826,0.012796,0.23392
openstack/kolla-ansible,I43f6dbd8b0139b933a54ad5dcf1e15ee74ea27d7,0,0,0.0952,4.0604,0.3333,13,3.67,159,0,Bug Fix,0,0,0,63,0.019284,1.0,0,0.0952,4,1,0,0.5402,3.3866,4.0,-81.45,23.28,0,0,0.0,0,2.7414,0,0,0,0,0,"ansible-lint: fix unnamed-task in cyborg
[SEP]
FILES CHANGED:
ansible/roles/cyborg/tasks/config_validate.yml (+2, -1)
ansible/roles/cyborg/tasks/register.yml (+2, -1)
ansible/roles/cyborg/tasks/reconfigure.yml (+2, -1)
ansible/roles/cyborg/tasks/deploy.yml (+10, -5)
ansible/roles/cyborg/tasks/main.yml (+2, -1)
ansible/roles/cyborg/tasks/precheck.yml (+2, -1)
ansible/roles/cyborg/tasks/stop.yml (+2, -1)
ansible/roles/cyborg/tasks/config.yml (+2, -1)
ansible/roles/cyborg/tasks/deploy-containers.yml (+2, -1)
ansible/roles/cyborg/tasks/bootstrap.yml (+2, -1)
ansible/roles/cyborg/tasks/check-containers.yml (+2, -1)
ansible/roles/cyborg/tasks/upgrade.yml (+6, -3)
ansible/roles/cyborg/tasks/pull.yml (+2, -1)
",2.799686,1.48985,0.877513,-0.464984,-0.360967,-1.668278,-0.259287,-0.808494,0.58994,0.263094,0.457938,0.725771,0.188117,-0.11688,0.29699
openstack/kolla-ansible,I2f0485ba73ee4af0e99cec806b3046dd8e3fab0f,0,0,0.0938,3.6889,0.3333,10,3.67,157,0,Bug Fix,0,0,0,64,0.019254,0.3333,0,0.0312,4,1,0,0.5397,3.1808,4.0,-89.14,23.28,0,0,0.0,0,3.925,0,0,0,0,0,"ansible-lint: fix unnamed-task in cron
[SEP]
FILES CHANGED:
ansible/roles/cron/tasks/main.yml (+2, -1)
ansible/roles/cron/tasks/upgrade.yml (+4, -2)
ansible/roles/cron/tasks/stop.yml (+2, -1)
ansible/roles/cron/tasks/deploy.yml (+6, -3)
ansible/roles/cron/tasks/pull.yml (+2, -1)
ansible/roles/cron/tasks/reconfigure.yml (+2, -1)
ansible/roles/cron/tasks/precheck.yml (+2, -1)
ansible/roles/cron/tasks/config.yml (+2, -1)
ansible/roles/cron/tasks/deploy-containers.yml (+2, -1)
ansible/roles/cron/tasks/check-containers.yml (+2, -1)
",2.929071,1.342025,0.848082,-0.418275,-0.21328,-1.791658,-0.259982,-0.91585,0.653773,0.127277,0.557084,0.534615,0.259179,0.279437,0.331049
openstack/kolla-ansible,I1a603c7d6fa3a4cbff2a67bd3f8b3c2cfe614733,0,0,0.0923,2.9444,0.3333,2,4.33,192,0,Bug Fix,0,0,0,65,0.019328,0.0,0,0.0,4,1,0,0.5392,0.9183,4.0,-109.93,23.27,0,0,0.0,0,10.1053,0,0,0,0,0,"ansible-lint: fix unnamed-task in roles

role: container-engine-migration
[SEP]
FILES CHANGED:
ansible/roles/container-engine-migration/tasks/migrate-volumes.yml (+4, -2)
ansible/roles/container-engine-migration/tasks/main.yml (+8, -4)
",2.739644,1.635346,0.07116,-0.156206,-0.146102,-1.637518,-0.228882,-0.534918,0.917323,-0.444101,0.033369,0.773082,0.194224,0.626241,0.016732
openstack/kolla-ansible,I3abac10bc37ded031ce543049b9a36526dd7a8da,0,0,0.0909,3.5264,0.3333,9,3.67,161,0,Bug Fix,0,0,0,66,0.019521,0.0,0,0.0,4,1,0,0.5387,3.0958,4.0,-96.83,23.28,0,0,0.0,0,4.7353,0,0,0,0,0,"ansible-lint: fix unnamed-task in collectd
[SEP]
FILES CHANGED:
ansible/roles/collectd/tasks/main.yml (+2, -1)
ansible/roles/collectd/tasks/upgrade.yml (+4, -2)
ansible/roles/collectd/tasks/precheck.yml (+2, -1)
ansible/roles/collectd/tasks/reconfigure.yml (+2, -1)
ansible/roles/collectd/tasks/deploy-containers.yml (+2, -1)
ansible/roles/collectd/tasks/deploy.yml (+4, -2)
ansible/roles/collectd/tasks/check-containers.yml (+2, -1)
ansible/roles/collectd/tasks/stop.yml (+2, -1)
ansible/roles/collectd/tasks/pull.yml (+2, -1)
",3.327866,1.268798,0.904166,-0.702756,-0.568777,-1.833503,-0.284061,-0.817375,0.5425,0.173984,0.335601,0.5035,0.198125,0.128339,0.372916
openstack/kolla-ansible,I25a950ce5de121726abad7ccb660a205e88f6086,0,0,0.0896,4.0604,0.3333,13,3.67,163,0,Bug Fix,0,0,0,67,0.019625,0.0,0,0.0,4,1,0,0.5382,3.3866,4.0,-104.52,26.92,0,0,0.0,0,2.8103,0,0,0,0,0,"ansible-lint: fix unnamed-task in cloudkitty
[SEP]
FILES CHANGED:
ansible/roles/cloudkitty/tasks/register.yml (+2, -1)
ansible/roles/cloudkitty/tasks/upgrade.yml (+6, -3)
ansible/roles/cloudkitty/tasks/reconfigure.yml (+2, -1)
ansible/roles/cloudkitty/tasks/config.yml (+2, -1)
ansible/roles/cloudkitty/tasks/pull.yml (+2, -1)
ansible/roles/cloudkitty/tasks/precheck.yml (+2, -1)
ansible/roles/cloudkitty/tasks/deploy.yml (+10, -5)
ansible/roles/cloudkitty/tasks/bootstrap.yml (+2, -1)
ansible/roles/cloudkitty/tasks/check-containers.yml (+2, -1)
ansible/roles/cloudkitty/tasks/config_validate.yml (+2, -1)
ansible/roles/cloudkitty/tasks/deploy-containers.yml (+2, -1)
ansible/roles/cloudkitty/tasks/main.yml (+2, -1)
ansible/roles/cloudkitty/tasks/stop.yml (+2, -1)
",2.583456,1.050942,0.601361,-0.729592,-0.449441,-1.997188,-0.266455,-0.620889,0.341588,0.073961,0.480788,0.612135,0.152902,-0.140654,0.402778
openstack/kolla-ansible,Ia2788b115dc28d842e6a4cd31eec098913d29805,0,0,0.0882,3.2189,0.3333,2,3.67,165,0,Bug Fix,0,0,0,68,0.019591,0.1429,0,0.0126,4,1,0,0.5377,1.0,4.0,-89.14,26.92,0,0,0.0,0,6.6,0,0,0,0,0,"ansible-lint: fix unnamed-task in certificates
[SEP]
FILES CHANGED:
ansible/roles/certificates/tasks/main.yml (+8, -4)
ansible/roles/certificates/tasks/generate.yml (+8, -4)
",3.144022,1.158083,1.090337,-0.398946,-0.399288,-1.843254,-0.465059,-0.691214,0.956898,0.392105,0.164455,0.491162,0.328375,0.025354,0.08173
openstack/kolla-ansible,Ia8b444b854c3c83a0ad2c18dd9fd12937d2bb06f,0,0,0.087,2.5649,0.3333,4,3.67,161,0,Bug Fix,0,0,0,69,0.019742,0.0,0,0.0,4,1,0,0.5372,2.0,4.0,-50.69,23.28,0,0,0.0,0,12.3846,0,0,0,0,0,"ansible-lint: fix unnamed-task in ceph-rgw
[SEP]
FILES CHANGED:
ansible/roles/ceph-rgw/tasks/deploy.yml (+2, -1)
ansible/roles/ceph-rgw/tasks/main.yml (+2, -1)
ansible/roles/ceph-rgw/tasks/register.yml (+2, -1)
ansible/roles/ceph-rgw/tasks/reconfigure.yml (+2, -1)
",2.132685,1.798386,0.137363,-0.66337,0.00758,-1.863589,-0.564782,-0.584079,0.306805,-0.039021,0.278795,0.427716,-0.021697,0.041606,0.527251
openstack/kolla-ansible,I6b5666b7887c5272e8a63fcbb8d3d4b9686237fb,0,0,0.0857,4.2485,0.3333,13,3.67,159,0,Bug Fix,0,0,0,70,0.01996,1.0,0,0.0857,4,1,0,0.5367,3.3073,4.0,-58.38,23.28,0,0,0.0,0,2.2714,0,0,0,0,0,"ansible-lint: fix unnamed-task in cinder
[SEP]
FILES CHANGED:
ansible/roles/cinder/tasks/reconfigure.yml (+2, -1)
ansible/roles/cinder/tasks/deploy.yml (+10, -5)
ansible/roles/cinder/tasks/config.yml (+6, -3)
ansible/roles/cinder/tasks/pull.yml (+2, -1)
ansible/roles/cinder/tasks/check-containers.yml (+2, -1)
ansible/roles/cinder/tasks/register.yml (+2, -1)
ansible/roles/cinder/tasks/deploy-containers.yml (+2, -1)
ansible/roles/cinder/tasks/bootstrap.yml (+2, -1)
ansible/roles/cinder/tasks/upgrade.yml (+10, -5)
ansible/roles/cinder/tasks/precheck.yml (+2, -1)
ansible/roles/cinder/tasks/config_validate.yml (+2, -1)
ansible/roles/cinder/tasks/main.yml (+2, -1)
ansible/roles/cinder/tasks/stop.yml (+2, -1)
",2.95901,1.479288,0.774194,-0.528653,-0.454093,-1.917462,-0.398124,-0.753082,0.606014,0.257985,0.427667,0.523893,0.149877,-0.022253,0.227824
openstack/kolla-ansible,Iba6f15faec8144072563f44ba2e4b6f86464785a,0,0,0.0845,4.0604,0.3333,13,3.67,163,0,Bug Fix,0,0,0,71,0.019855,0.125,0,0.0106,4,1,0,0.5362,3.3866,4.0,-96.83,26.92,0,0,0.0,0,2.8103,0,0,0,0,0,"ansible-lint: fix unnamed-task in ceilometer
[SEP]
FILES CHANGED:
ansible/roles/ceilometer/tasks/check-containers.yml (+2, -1)
ansible/roles/ceilometer/tasks/register.yml (+2, -1)
ansible/roles/ceilometer/tasks/config.yml (+2, -1)
ansible/roles/ceilometer/tasks/main.yml (+2, -1)
ansible/roles/ceilometer/tasks/pull.yml (+2, -1)
ansible/roles/ceilometer/tasks/upgrade.yml (+6, -3)
ansible/roles/ceilometer/tasks/deploy-containers.yml (+2, -1)
ansible/roles/ceilometer/tasks/bootstrap.yml (+2, -1)
ansible/roles/ceilometer/tasks/stop.yml (+2, -1)
ansible/roles/ceilometer/tasks/config_validate.yml (+2, -1)
ansible/roles/ceilometer/tasks/deploy.yml (+10, -5)
ansible/roles/ceilometer/tasks/reconfigure.yml (+2, -1)
ansible/roles/ceilometer/tasks/precheck.yml (+2, -1)
",2.881246,0.689613,0.977854,-0.563555,-0.334224,-1.791017,-0.354015,-0.44407,0.862259,0.206566,0.331291,0.635173,0.021477,-0.167015,0.266537
openstack/kolla-ansible,I4a76e7f13f55c06355508ebc9f5f9c6e5641ce22,0,0,0.0833,4.0604,0.3333,13,3.67,159,0,Bug Fix,0,0,0,72,0.019818,0.0,0,0.0,4,1,0,0.5356,3.3866,4.0,-81.45,23.28,0,0,0.0,0,2.7414,0,0,0,0,0,"ansible-lint: fix unnamed-task in blazar
[SEP]
FILES CHANGED:
ansible/roles/blazar/tasks/stop.yml (+2, -1)
ansible/roles/blazar/tasks/deploy.yml (+10, -5)
ansible/roles/blazar/tasks/precheck.yml (+2, -1)
ansible/roles/blazar/tasks/pull.yml (+2, -1)
ansible/roles/blazar/tasks/config_validate.yml (+2, -1)
ansible/roles/blazar/tasks/register.yml (+2, -1)
ansible/roles/blazar/tasks/upgrade.yml (+6, -3)
ansible/roles/blazar/tasks/bootstrap.yml (+2, -1)
ansible/roles/blazar/tasks/reconfigure.yml (+2, -1)
ansible/roles/blazar/tasks/main.yml (+2, -1)
ansible/roles/blazar/tasks/deploy-containers.yml (+2, -1)
ansible/roles/blazar/tasks/check-containers.yml (+2, -1)
ansible/roles/blazar/tasks/config.yml (+2, -1)
",2.746674,1.255946,0.570708,-0.614427,-0.418302,-1.867572,-0.534288,-0.753241,0.500118,0.244961,0.383963,0.799791,0.094647,-0.039276,0.274343
openstack/kolla-ansible,Ic5739b7d7c8d28d0db473ffe22c7c0cabe426ed0,0,0,0.0822,4.0604,0.3333,13,3.67,157,0,Bug Fix,0,0,0,73,0.019783,0.0,0,0.0,4,1,0,0.5351,3.3866,4.0,-66.07,23.28,0,0,0.0,0,2.7069,0,0,0,0,0,"ansible-lint: fix unnamed-task in aodh
[SEP]
FILES CHANGED:
ansible/roles/aodh/tasks/deploy-containers.yml (+2, -1)
ansible/roles/aodh/tasks/stop.yml (+2, -1)
ansible/roles/aodh/tasks/config_validate.yml (+2, -1)
ansible/roles/aodh/tasks/config.yml (+2, -1)
ansible/roles/aodh/tasks/pull.yml (+2, -1)
ansible/roles/aodh/tasks/bootstrap.yml (+2, -1)
ansible/roles/aodh/tasks/reconfigure.yml (+2, -1)
ansible/roles/aodh/tasks/deploy.yml (+10, -5)
ansible/roles/aodh/tasks/main.yml (+2, -1)
ansible/roles/aodh/tasks/precheck.yml (+2, -1)
ansible/roles/aodh/tasks/upgrade.yml (+6, -3)
ansible/roles/aodh/tasks/register.yml (+2, -1)
ansible/roles/aodh/tasks/check-containers.yml (+2, -1)
",3.130717,0.880207,0.953094,-0.817904,-0.443712,-1.700474,-0.236558,-0.751537,0.501603,0.204382,0.33869,0.618547,-0.020335,-0.17156,0.332179
openstack/kolla-ansible,I04285d1704e296c21f82708188ec91b967ac10cb,0,0,0.0811,3.434,0.3333,5,3.67,160,0,Bug Fix,0,0,0,74,0.019749,0.0,0,0.0,4,1,0,0.5346,2.2464,4.0,-66.07,23.28,0,0,0.0,0,5.1613,0,0,0,0,0,"ansible-lint: fix unnamed-task in bifrost
[SEP]
FILES CHANGED:
ansible/roles/bifrost/tasks/upgrade.yml (+4, -2)
ansible/roles/bifrost/tasks/stop.yml (+4, -2)
ansible/roles/bifrost/tasks/deploy.yml (+6, -3)
ansible/roles/bifrost/tasks/main.yml (+2, -1)
ansible/roles/bifrost/tasks/reconfigure.yml (+4, -2)
",2.53897,1.792336,0.580635,-0.544549,-0.287458,-1.551516,-0.397219,-0.919952,0.522837,0.049615,0.562402,0.649129,0.077387,-0.119964,0.414545
openstack/kolla-ansible,Ic2b09324a652b096c911e4377ef6ed113432351a,0,0,0.08,4.0604,0.3333,13,3.67,161,0,Bug Fix,0,0,0,75,0.019857,0.0,0,0.0,4,1,0,0.5341,3.3866,4.0,-89.14,26.92,0,0,0.0,0,2.7759,0,0,0,0,0,"ansible-lint: fix unnamed-task in barbican
[SEP]
FILES CHANGED:
ansible/roles/barbican/tasks/deploy-containers.yml (+2, -1)
ansible/roles/barbican/tasks/reconfigure.yml (+2, -1)
ansible/roles/barbican/tasks/pull.yml (+2, -1)
ansible/roles/barbican/tasks/precheck.yml (+2, -1)
ansible/roles/barbican/tasks/stop.yml (+2, -1)
ansible/roles/barbican/tasks/register.yml (+2, -1)
ansible/roles/barbican/tasks/config.yml (+2, -1)
ansible/roles/barbican/tasks/bootstrap.yml (+2, -1)
ansible/roles/barbican/tasks/deploy.yml (+10, -5)
ansible/roles/barbican/tasks/upgrade.yml (+6, -3)
ansible/roles/barbican/tasks/main.yml (+2, -1)
ansible/roles/barbican/tasks/check-containers.yml (+2, -1)
ansible/roles/barbican/tasks/config_validate.yml (+2, -1)
",2.773174,1.558309,0.575084,-0.564165,-0.354483,-1.738222,-0.358071,-0.843502,0.552726,0.225029,0.667406,0.619732,0.297427,-0.037701,0.157846
openstack/kolla-ansible,I481734d34919b6e723f4540165115ff7e8938694,0,0,0.0789,1.3863,1.0,1,3.67,167,0,Feature,0,0,0,76,0.019823,0.0,0,0.0,0,1,0,0.5336,0.0,0.0,-66.07,23.28,0,0,0.0,0,41.75,0,0,0,0,0,"ansible-lint: remove unnamed-task from skip_list
[SEP]
FILES CHANGED:
.ansible-lint (+0, -3)
",2.195635,1.650876,0.179422,0.129553,0.081879,-1.539364,-0.66953,-0.937511,0.732053,0.063331,-0.026537,0.366668,0.007136,0.240797,-0.074336
openstack/kolla-ansible,I7e67d029b0771d7b878dbf09cd058a6c03b33288,0,0,0.6351,3.7612,0.0,2,5.5,135,0,Doc,0,0,0,74,0.059247,0.0,0,0.0,3,2,0,0.5331,0.9852,3.0,1.29,20.38,0,0,0.0,0,3.1395,0,0,0,0,0,"docs: add CI coverage matrix
[SEP]
FILES CHANGED:
doc/source/contributor/ci-matrix.csv (+24, -0)
doc/source/contributor/ci.rst (+18, -0)
",4.202163,0.43694,2.075647,0.033822,-0.035139,0.32877,0.339572,0.35396,0.797353,0.030264,-0.633876,-0.184409,0.208061,0.137661,-0.379629
openstack/kolla-ansible,I0a0e694c594ef5f479bf0e0d12a6cdd011dab250,0,0,0.6267,3.3322,0.1111,5,5.0,129,0,CI,1,0,0,75,0.058095,0.4821,0,0.3021,2,2,0,0.5326,1.9238,1.8,-35.12,22.0,0,0,1.0,1,4.6071,0,0,0,0,0,"CI: Add SLURP scenario
[SEP]
FILES CHANGED:
zuul.d/scenarios/slurp.yaml (+10, -0)
tests/templates/globals-default.j2 (+4, -0)
zuul.d/project.yaml (+1, -0)
zuul.d/scenarios/aio.yaml (+8, -2)
zuul.d/scenarios/cephadm.yaml (+1, -1)
",2.696844,1.970699,0.894784,0.437013,0.758963,1.062544,-0.241707,0.716698,0.138257,0.198541,0.684363,0.039664,0.689005,0.100364,-0.182548
openstack/kolla-ansible,I6042cf9ebf1251e1f516201e3bc3068acc613471,1,0,0.6184,4.3438,0.2632,7,5.5,135,0,CI,1,0,0,76,0.057663,0.4038,0,0.2497,2,2,0,0.5322,2.7061,2.0,-6.4,16.75,0,0,1.0,1,1.7532,0,0,0,0,0,"CI: add rocky10 upgrade jobs
[SEP]
FILES CHANGED:
zuul.d/scenarios/mariadb.yaml (+7, -4)
zuul.d/scenarios/prometheus-opensearch.yaml (+6, -0)
zuul.d/scenarios/ironic.yaml (+6, -0)
tests/templates/globals-default.j2 (+0, -16)
zuul.d/scenarios/ovn.yaml (+13, -0)
zuul.d/scenarios/aio.yaml (+8, -0)
zuul.d/scenarios/cephadm.yaml (+16, -0)
",3.121048,0.715104,1.48408,-0.199228,0.859321,0.272556,0.006145,0.148426,-0.179782,0.36263,-0.369996,-0.172625,0.738105,0.015691,0.152244
openstack/kolla,I5607081701b59ac0ca58cb6c285769209a009355,1,0,0.6234,3.0445,0.0,8,5.5,142,0,CI,1,0,0,77,0.055237,0.3333,0,0.2078,2,1,0,0.5953,2.9219,2.0,-14.09,20.38,0,0,1.0,1,6.7619,0,0,0,0,0,"CI: add rocky-10 kolla-ansible jobs
[SEP]
FILES CHANGED:
zuul.d/scenarios/mariadb.yaml (+2, -0)
zuul.d/scenarios/masakari.yaml (+2, -0)
zuul.d/scenarios/cells.yaml (+2, -0)
zuul.d/scenarios/ironic.yaml (+2, -0)
zuul.d/scenarios/ovn.yaml (+2, -0)
zuul.d/scenarios/aio.yaml (+4, -0)
zuul.d/scenarios/cephadm.yaml (+4, -0)
zuul.d/scenarios/bifrost.yaml (+2, -0)
",1.753938,1.212752,0.046573,-0.512626,0.913773,-0.853154,-0.262031,0.092055,-0.611635,-0.066943,-0.208462,0.748058,0.937792,0.219402,-0.086695
openstack/kolla,I2125879365dbe9a1645c159d87777939dae824c4,0,0,0.4037,1.7918,0.6,1,2.18,276,0,Feature,0,0,0,540,0.01321,0.16,0,0.0646,0,1,0,0.5962,0.0,0.0,-13.93,14.21,0,0,0.0,0,46.0,0,0,0,0,0,"setup.cfg: Update Python versions according to Flamingo PTI

Add Python 3.13 and drop 3.8 & 3.9.

See https://governance.openstack.org/tc/reference/runtimes/2025.2.html
[SEP]
FILES CHANGED:
setup.cfg (+2, -3)
",-0.673539,1.690504,-1.346341,0.267256,-0.51486,0.292646,-0.223291,0.644845,-0.066811,0.738961,-0.969525,-0.161697,-0.360087,0.126052,0.033253
openstack/kolla,I8156e2c2a57d820afdee0b76cd5a050ad682fb38,0,0,0.403,4.9972,0.4082,9,5.0,132,0,Feature,0,0,0,541,0.013233,0.6667,0,0.2686,2,7,0,0.5949,3.0056,2.0,-43.58,22.0,0,0,0.2109,1,0.8919,0,0,0,0,0,"debian: Switch to deb822
[SEP]
FILES CHANGED:
docker/base/ubuntu.sources (+24, -0)
releasenotes/notes/deb822-3f0435dfce6da841.yaml (+6, -0)
docker/base/Dockerfile.j2 (+4, -4)
docker/base/debian.sources (+13, -0)
docker/base/ubuntu.sources.arm64 (+24, -0)
tests/templates/template_overrides.j2 (+16, -15)
docker/base/sources.list.debian (+0, -11)
docker/base/sources.list.ubuntu.aarch64 (+0, -15)
docker/base/sources.list.ubuntu (+0, -15)
",3.066243,1.726426,0.840043,-0.284939,0.669391,0.967687,0.313062,0.03028,-0.510439,0.509537,0.188572,0.046189,-0.029117,0.084456,0.242829
openstack/ironic,I69ceec12fc0beea586176a768d864a22261cdb93,1,1,1.0,3.0445,0.15,2,15.67,358,0,Bug Fix,0,0,0,6,0.018692,1.0,0,1.0,4,2,0,0.9659,0.9341,3.0,36.13,15.63,0,0,0.0,1,17.0476,0,6,0,9,0,"fix: agent inspection hooks failure does not clean up

When the using the agent inspector interface and an exception happens
during execution of the hook, the node is not cleaned up resulting in
stale Neutron ports and ramdisk files.

Closes-Bug: 2135265
[SEP]
FILES CHANGED:
ironic/drivers/modules/inspector/agent.py (+10, -3)
releasenotes/notes/agent-inspect-hooks-cleanup-error-c8901a7f8ad0dfd3.yaml (+7, -0)
",0.385966,-2.257773,-0.087639,-0.086145,-0.394168,-0.053674,-0.239802,-0.154759,0.11685,-0.456173,-0.215392,-0.018539,0.154505,0.120106,-0.099726
openstack/ironic,I375fbe27253d7965e458be7b147d5b72cffa4e89,1,1,1.0,2.5649,0.25,3,16.0,426,0,Bug Fix,0,0,0,7,0.020528,0.0,0,0.0,6,2,0,0.9661,1.4591,4.0,61.05,10.15,0,0,0.1667,1,32.7692,0,6,0,5,0,"fix redfish inspect system product name

The intention of this code is to read the system product name which is
stored in the model field per the Redfish spec and not in the name field
which will always store the name of the object we are working with. This
results in the value always being 'System'.

Closes-Bug: 2136233
[SEP]
FILES CHANGED:
releasenotes/notes/redfish-inspect-product-name-bd537f417d35b254.yaml (+6, -0)
ironic/tests/unit/drivers/modules/redfish/test_inspect.py (+1, -1)
ironic/drivers/modules/redfish/inspect.py (+2, -2)
",-0.298412,-1.530055,-0.313219,0.811027,-0.289801,0.450106,0.097902,-0.522178,0.21519,0.1213,-0.074039,0.010102,-0.046489,0.036326,-0.030521
openstack/ironic,I7721f917fb723e8a4cef69e0f7be1ece0238d7ed,1,0,0,2.9444,0.1667,3,15.0,1205,0,Bug Fix,0,0,0,0,0.0,1.0,0,0.0,3,2,0,0.9663,1.4807,2.33,6.05,18.53,0,0,0.0,1,63.4211,0,0,0,0,0,"fix: iPXE boot interface PXE capability detection

The neutron network interface's add_ports_to_network() function only
checked for 'pxe_boot' capability when determining PXE capability,
but iPXE is also a form of PXE booting and should be treated the
same way. This caused inconsistent behavior for boot interfaces like
'http-ipxe' that have 'ipxe_boot' capability but not 'pxe_boot'
capability.

Without this fix, iPXE boot interfaces were incorrectly treated as
non-PXE capable, causing the neutron interface to create ports for
all baremetal ports with local_link_connection info during cleaning
operations, regardless of their pxe_enabled setting.

This change adds 'pxe_boot' capability to both iPXEBoot and
iPXEHttpBoot classes, ensuring that iPXE boot interfaces are
correctly recognized as PXE-capable.

Additionally, this adds the missing pxe_boot capability check to
the remove_ports_from_network() function, which was previously
missing this logic entirely. This ensures consistent port creation
and deletion behavior, preventing orphaned neutron ports after
cleaning operations.
[SEP]
FILES CHANGED:
releasenotes/notes/neutron-pxe-boot-cc850e1e7e1170c3.yaml (+7, -0)
ironic/common/neutron.py (+2, -1)
ironic/drivers/modules/ipxe.py (+6, -2)
",-3.629367,-0.206542,2.727654,0.048475,0.868752,0.129948,-0.699981,-0.009467,-0.027115,-0.442724,-0.019205,0.218402,-0.054753,-0.306984,0.17233
openstack/kolla-ansible,I7505f8feeb85f606df92a20bf4a4700d5ea36a51,0,0,0.4022,2.7081,0.4286,4,6.0,139,0,Feature,0,0,0,542,0.01321,0.6667,0,0.2681,3,2,0,0.5326,1.9852,2.25,-24.85,19.07,0,0,0.4286,1,9.2667,0,0,0,0,0,"tempest: Rework regex to a list
[SEP]
FILES CHANGED:
roles/kolla-ansible-tempest/tasks/main.yml (+2, -2)
roles/kolla-ansible-tempest/defaults/main.yml (+2, -2)
zuul.d/base.yaml (+2, -1)
zuul.d/scenarios/cephadm.yaml (+2, -1)
",2.81991,0.88303,1.60876,0.478835,0.600805,0.664752,-0.315974,-0.602254,0.277764,0.439756,-0.601619,-0.366929,-0.236514,0.293943,-0.606196
openstack/ironic,I36c290c9f92189281e11633e9a587918b0699ae3,1,1,1.0,4.1271,0.2295,4,20.75,587,0,Bug Fix,0,0,0,8,0.022663,1.0,0,1.0,4,2,0,0.9665,1.7092,3.0,26.77,16.97,0,0,0.377,1,9.4677,0,6,0,6,0,"fix loading of built-in inspection rules

The built-in inspection rules cannot be loaded because the jsonschema
validates them against the expected API however the built-in rules had a
'built-in' key that is not part of the schema and included the 'scope'
key which was ultimately dropped before inspection rules support landed.
The built-in rules also did not validate that the data was a list of
rules before attempting to utilize it giving an incorrect error.

Closes-Bug: 2136776
[SEP]
FILES CHANGED:
ironic/common/inspection_rules/engine.py (+15, -11)
ironic/common/inspection_rules/validation.py (+4, -3)
releasenotes/notes/inspection-rules-built-in-load-00958e99e3ab7ecb.yaml (+5, -0)
ironic/tests/unit/common/test_inspection_rule.py (+23, -0)
",-1.129138,-1.001503,0.086385,0.907911,-0.005307,0.216812,0.269796,-0.346988,0.065477,0.060128,0.382795,0.331241,0.301316,-0.125448,0.203079
openstack/ironic,I65894191affd9171bf68dc9b15725ed34a9724f9,1,0,1.0,2.7726,0.2667,1,9.5,322,0,Bug Fix,0,0,0,9,0.021739,1.0,1,1.0,4,1,0,0.9667,0.0,4.0,23.54,16.43,0,0,0.0,0,20.125,0,0,0,0,0,"fix: inspection rules docs to match the code

These inspection rules actions are implemented but were not documented
so add some documentation for them. The redfish inspection interface
also supports inspection rules.
[SEP]
FILES CHANGED:
doc/source/admin/inspection/index.rst (+11, -4)
",0.849691,-2.161792,0.382034,0.485903,-0.512923,-0.155771,-0.498237,-0.31167,-0.212374,0.260521,-0.440984,0.160431,-0.106506,-0.247987,0.113483
openstack/ironic,Ic96c5a1993d20347968c23c60393a4cde2de9a0c,1,0,1.0,4.0431,0.4464,2,11.8,387,0,Bug Fix,0,0,0,10,0.02331,1.0,0,1.0,4,2,0,0.9669,0.4912,3.5,52.9,12.18,0,0,0.0,0,6.7895,0,0,0,0,0,"update inspection rules docs and code to the same order

Updated the docs and code to match the same order and to break out each
operation like it is in the code. Fixed incorrect indent of an example.
This is just mechanical to make visual inspection of the docs to the
code easier.
[SEP]
FILES CHANGED:
ironic/common/inspection_rules/actions.py (+3, -3)
doc/source/admin/inspection/index.rst (+28, -22)
",0.810086,-1.995009,0.390008,0.671611,-0.247758,0.324466,0.673577,-0.685646,-0.000602,0.099602,-0.386969,-0.063881,-0.072528,0.097216,-0.31458
openstack/ironic,Ica2e31783b18fc2306369b0ee0d467aca17d4975,1,1,1.0,5.323,0.0049,3,13.0,751,0,Bug Fix,0,0,0,12,0.006948,1.0,0,1.0,6,2,0,0.967,0.5383,4.0,2.13,18.83,0,0,0.9069,1,3.6634,0,10,0,3,0,"Omit `CapacityBytes` for Redfish RAID MAX size_gb

When size_gb='MAX' is specified, Ironic was calculating the maximum
volume size and including it in ``CapacityBytes``. This calculated size
doesn't account for controller metadata overhead, causing iLO and other
controllers to reject the request with UnsupportedOperation.

Fix by omitting ``CapacityBytes`` from the Redfish payload when
size_gb='MAX', allowing the controller to calculate the optimal size
automatically and the actual volume size is queried and stored after
creation via ``update_raid_config()``.

Unit tests generated by AI.

Closes-Bug: #2132936
Assisted-by: Claude Sonnet 4.5
[SEP]
FILES CHANGED:
ironic/drivers/modules/redfish/raid.py (+10, -1)
ironic/tests/unit/drivers/modules/redfish/test_raid.py (+185, -0)
releasenotes/notes/redfish-raid-max-size-fix-2e4c84945936dbe2.yaml (+8, -0)
",-2.064112,-0.390384,1.100543,0.157239,0.233653,0.457435,-0.653249,0.145119,0.402981,-0.346168,0.25589,-0.16862,-0.126225,-0.215621,-0.068747
openstack/ironic-python-agent-builder,Ifc2b2cbde939d9d9b9fec4e9a5f548e5420650a2,1,0,0.9796,1.0986,0.5,1,6.71,468,0,Bug Fix,0,0,0,49,0.013737,0.0,0,0.0,4,1,0,1.0,0.0,4.0,-17.78,13.75,0,0,0.0,0,156.0,0,0,0,0,0,"Fixed rescue ConditionPathExists flag

While looking at some logs, I discovered that systemd was now erroring about
the ConditionPathExists parameter. It appears that belongs in unit instead.

As such, moving.

Error: systemd[1]: /usr/lib/systemd/system/ironic-python-agent.service:6: Unknown key name 'ConditionPathExists' in section 'Service', ignoring.
[SEP]
FILES CHANGED:
dib/ironic-python-agent-ramdisk/install.d/ironic-python-agent-ramdisk-source-install/ironic-python-agent.service (+1, -1)
",-1.125724,-0.397471,-0.500549,0.315201,-0.611752,-0.036149,-0.510729,-0.186062,0.223262,0.464488,0.370486,-0.736579,0.234306,0.437505,-0.110491
openstack/kolla-ansible,If15a43733117ff48f107614589347b992ed1baa4,0,0,0.4015,3.2189,0.1667,1,7.43,404,0,Feature,0,0,0,543,0.01323,0.0,0,0.0,4,1,0,0.5321,0.0,4.0,38.23,14.51,0,0,0.0,0,16.16,0,0,0,0,0,"ironic: Make inspector related volume removal optional

Since we need to keep the upgrade steps for 2025.1->2026.1
and 2025.2->2026.1 upgrade currently fails on missing
inspector-related container volume - we need to adapt
the logic to check if that volume migration and removal
needs to be done.
[SEP]
FILES CHANGED:
ansible/roles/ironic/tasks/upgrade.yml (+20, -4)
",0.256671,-1.058086,-0.021073,0.426149,-0.035194,-0.26455,0.191366,0.022454,-0.176444,0.787172,-0.39623,0.088239,0.146882,0.191401,0.52558
openstack/openstack-ansible,If995d702ea58c4251b655ba2c3043dbf4f14e671,1,0,0.9608,1.3863,0.3333,1,4.86,313,0,Feature,0,0,0,255,0.054417,0.0,0,0.0,1,1,0,0.9439,0.0,1.0,20.26,13.71,0,0,0.0,0,78.25,0,0,0,0,0,"Ensure bash-completion also search for .yaml

Auto-complete ignores playbooks having .yaml
extension, which might be a good chunk of third-party playbooks.

Let's ensure we cover them as well.
[SEP]
FILES CHANGED:
scripts/bash-completion (+2, -1)
",0.878906,-0.712796,-0.431043,0.471501,-0.043875,-0.373991,0.625122,-0.667635,-0.756855,-0.122112,-0.054095,-0.033467,0.055045,0.073305,0.141497
openstack/kolla-ansible,I5782a5da30434cf5c5ae0fcb60b3c6f178351fb7,1,1,0,1.0986,0.5,1,7.0,333,0,Bug Fix,0,0,0,0,0.0,0.3636,0,0.0,4,1,0,0.5316,0.0,4.0,16.03,15.37,0,0,0.0,0,111.0,1,6,0,5,0,"Fix trove_api healthcheck with TLS backend

When trove_enable_tls_backend is enabled, the API healthcheck
must use https scheme instead of plain http.
This change updates the healthcheck command accordingly.

Closes-Bug: #2136977
[SEP]
FILES CHANGED:
ansible/roles/trove/defaults/main.yml (+1, -1)
",0.067623,-0.3956,-0.557781,0.442004,0.013708,0.366352,-0.666218,-0.026866,0.378574,-0.319615,0.036159,-0.239576,-0.10672,-0.380402,0.195474
openstack/kolla-ansible,Iaded12e9bcf7ed558b7e35ea526ef1355cbca61a,0,0,0.4007,3.5264,0.4242,8,4.67,307,0,Feature,0,0,1,544,0.013246,0.5882,0,0.2357,4,4,0,0.532,2.8287,1.62,-54.72,21.87,1,0,0.2424,1,9.0294,0,0,0,0,0,"Bump ansible-core to 2.19/2.20

wait_discover_computes.yml had to be updated to pass ansible-lint
checks for undefined variables (ansible_facts.hostname/nodename was
rendered as UndefinedMarker type)
[SEP]
FILES CHANGED:
requirements.txt (+1, -1)
ansible/roles/nova-cell/tasks/wait_discover_computes.yml (+2, -2)
test-requirements.txt (+1, -1)
releasenotes/notes/ansible-2.20-5dde80ced4385201.yaml (+5, -0)
lint-requirements.txt (+1, -1)
doc/source/conf.py (+4, -4)
zuul.d/base.yaml (+3, -3)
ansible/roles/prechecks/vars/main.yml (+2, -2)
",-0.256,-0.343911,-0.807205,-0.203325,0.139449,-0.732327,-0.294674,-0.104827,-0.186722,-0.284996,-0.173462,-0.428052,-0.622588,0.035547,-0.022068
openstack/kolla,I6fb70da636514b5c1057c16cc2df08b07820bc5f,0,0,0.4,3.8286,0.3333,1,15.0,231,0,Doc,1,0,0,545,0.01326,0.3158,0,0.1263,2,1,0,0.5936,0.0,2.0,56.25,11.33,0,0,1.0,1,5.0217,0,0,0,0,0,"CI: Add ^docker/ trigger for aio jobs

Without that - these are not run at all

Update Bookworm to Trixie while we're at it
[SEP]
FILES CHANGED:
zuul.d/scenarios/aio.yaml (+30, -15)
",1.498629,-1.463293,-0.042068,-0.187912,-0.765409,0.113119,-0.044583,-0.4476,-1.04383,-0.307304,-0.002906,-0.211713,0.109863,0.124632,-0.356088
openstack/kolla,Icb85112c66645d8df00eb0c40076a6bd822f6866,0,0,0.3993,2.0794,0.8571,2,4.2,262,0,Feature,0,1,0,546,0.01327,0.3571,0,0.1426,2,2,0,0.5924,0.8631,2.0,-10.94,18.82,1,0,0.0,1,32.75,0,0,0,0,0,"Revert ""kolla-toolbox: Bump ansible-core to 2.20""

This reverts commit ef12d96731bc82472941c81ac24e3a13736674d0.

Reason for revert: Broke community.mysql
[SEP]
FILES CHANGED:
releasenotes/notes/ansible-core-2-20-bd912e1767d5f197.yaml (+0, -5)
docker/kolla-toolbox/Dockerfile.j2 (+1, -1)
",0.354261,0.297612,-2.046117,-1.694832,0.714207,0.295966,0.568226,0.0917,0.229219,-0.136554,-0.109501,0.223413,-0.345308,0.23141,-0.043833
openstack/openstack-ansible-os_horizon,Ide45f6b31c0c4d86cbe563b343a45eb073aec6ab,1,0,1.0,2.4849,0.0,1,9.67,275,0,Doc,0,0,0,1,0.125,0.0,0,0.0,2,1,0,1.0,0.0,2.0,-13.02,21.8,0,0,0.0,1,22.9167,0,0,0,0,0,"Release note for Horizon session invalidation issue

Document a known Horizon issue that may cause unexpected session
invalidation and describe a temporary mitigation.
[SEP]
FILES CHANGED:
releasenotes/notes/horizon-session-invalidation-issue-c4a8f19e2d7b6a03.yaml (+11, -0)
",0.572875,-1.061674,-0.346648,1.080197,0.523054,0.697547,0.089518,-0.182615,0.939098,0.159897,0.060457,1.036395,0.102026,-0.540561,0.078221
openstack/kolla-ansible,Idaacd719846f7328bfcd77c4a271f417f7064c94,0,0,0.3985,2.9444,0.8889,3,9.5,196,0,Feature,0,0,0,547,0.013292,0.7391,0,0.2946,4,2,0,0.5315,0.9445,3.0,1.28,20.64,0,0,0.1667,0,10.3158,0,0,0,0,0,"Remove glance-tls-proxy remnants

It has been omitted in the original Glance uWSGI patch
[SEP]
FILES CHANGED:
ansible/roles/glance/handlers/main.yml (+0, -14)
tests/check-logs.sh (+2, -1)
ansible/roles/cron/tasks/config.yml (+0, -1)
",1.774135,0.130566,-0.569436,0.159392,-0.409779,0.172524,-0.07401,0.346607,-0.195407,-0.571633,0.631154,0.741868,-0.385242,0.013258,0.431617
openstack/ironic,I307848a9a1733ecff534ae37541e59465b4e96b7,1,0,1.0,2.3979,0.0,2,12.0,356,0,Bug Fix,0,0,0,11,0.02268,0.0,0,0.0,5,2,0,0.9672,1.0,3.5,27.22,13.13,0,0,0.0,1,32.3636,0,0,0,0,0,"fix: report a better error in validate-interfaces

When validate-interfaces runs if there is no interfaces key then we
would just have a KeyError exception that would be logged to the node.
This provides a clearer message back as to why this happened.
[SEP]
FILES CHANGED:
ironic/drivers/modules/inspector/hooks/validate_interfaces.py (+5, -0)
releasenotes/notes/validate-interfaces-hook-49d7d6c57929a8cd.yaml (+5, -0)
",0.433436,-0.967458,-0.307923,0.559525,-0.323153,0.47318,0.079856,-1.335135,0.150439,0.200358,0.059932,0.16771,0.048083,0.130028,-0.007327
openstack/ironic,I79ed016edd2ea6bfb94bf303f1e815b4d9b16dfd,1,1,1.0,2.7726,0.4667,2,14.33,639,0,Bug Fix,0,0,0,12,0.024242,0.0,0,0.0,2,2,0,0.9674,0.971,2.0,43.74,12.71,0,0,0.0,1,39.9375,0,6,0,5,0,"fix: bios fields could not be fetched via the API

In Ie86ec57e428e2bb2efd099a839105e51a94824ab this code was added but it
appears to have been targeting an earlier version of the spec index
Ib93e62076207e3e25960111bd0b46b83fe481c69. Up to version 8 of the spec
there is mention of a 'registry' DB field which would have been added
and then parsed in a get_registry_fields() helper method. But it was
ultimately dropped. This bit of code still contained those references
resulting in the endpoint returning errors.

Closes-Bug: 2137596
[SEP]
FILES CHANGED:
releasenotes/notes/fix-bios-settings-d6f8daed2b17c0b5.yaml (+6, -0)
ironic/objects/bios.py (+2, -7)
",-1.776226,-1.252608,0.14659,-1.409301,0.335978,0.388242,0.380221,-0.439769,0.178697,0.423646,0.030706,0.244031,-0.098711,-0.10131,0.25905
openstack/kolla,I77d38e713678ea653ded3b14fd0541d3ec0ebee6,1,1,0.6,2.3979,0.2,3,5.0,354,0,Bug Fix,0,0,0,5,0.017606,0.5217,0,0.313,2,2,0,0.5911,1.371,2.0,-13.37,15.71,1,0,0.0,1,32.1818,0,6,0,9,0,"Update repo GPG key for influxdata.

According to https://www.influxdata.com/blog/package-signing-key-rotation
the preferred signing key for influxdata package repositories
changed in early 2026. Update to the new preferred key.

Closes-Bug: #2138095
[SEP]
FILES CHANGED:
releasenotes/notes/influxdb-repo-gpg-key-04eb924f249e54a5.yaml (+6, -0)
docker/base/Dockerfile.j2 (+1, -1)
kolla/template/repos.yaml (+1, -1)
",-0.264932,0.25957,-0.769529,0.202609,-0.732573,-0.04732,-0.327401,0.384896,0.490475,-0.202258,-0.63006,0.106916,0.084229,0.213637,0.015306
openstack/kolla-ansible,I51c3c7b37f426e1471395b43b812e009bb6fe83b,0,0,0.8095,1.0986,0.5,1,1.6,230,0,Doc,1,0,0,21,0.032357,0.2,0,0.1619,1,1,0,0.531,0.0,1.0,-59.16,23.14,0,0,1.0,0,76.6667,0,0,0,0,0,"Replace assertEquals

It was removed in Python 3.12[1].

[1] https://docs.python.org/ja/3.13/whatsnew/3.12.html#id3
[SEP]
FILES CHANGED:
tests/test_kolla_container_facts.py (+1, -1)
",-0.065932,2.486312,-1.0724,0.04518,-1.118411,0.629576,-0.51267,-0.182463,-0.255674,1.208004,-0.869965,-0.262696,-0.801928,0.281946,-0.111457
openstack/kolla,Ic75619db8c4b4f02bc51f4bfa6ae067acd1ba7e8,1,0,0.6282,4.8675,0.4884,5,8.5,167,0,CI,1,0,0,78,0.055163,0.25,0,0.1571,2,1,0,0.592,0.8817,1.2,24.03,12.81,0,0,1.0,1,1.2846,0,0,0,0,0,"CI: rotate zuul secrets

and store COPR webhook URLs as list
[SEP]
FILES CHANGED:
zuul.d/debian.yaml (+4, -4)
zuul.d/secrets.yaml (+56, -54)
zuul.d/rocky.yaml (+2, -2)
zuul.d/ubuntu.yaml (+2, -2)
zuul.d/periodics/copr.yaml (+2, -1)
",2.286004,-0.953443,0.400751,-0.48314,0.013636,-0.05499,-0.107955,0.157311,-0.10556,-0.493681,-0.166622,-0.292428,0.067138,0.421992,-0.817135
